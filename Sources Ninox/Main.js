/*! For license information please see main.52a8c702440818b0df6d.js.LICENSE.txt */
var libs = function(e) {
    function t(t) {
        for (var o, a, r = t[0], l = t[1], c = t[2], h = 0, p = []; h < r.length; h++)
            a = r[h],
            Object.prototype.hasOwnProperty.call(n, a) && n[a] && p.push(n[a][0]),
            n[a] = 0;
        for (o in l)
            Object.prototype.hasOwnProperty.call(l, o) && (e[o] = l[o]);
        for (d && d(t); p.length;)
            p.shift()();
        return s.push.apply(s, c || []), i()
    }
    function i() {
        for (var e, t = 0; t < s.length; t++) {
            for (var i = s[t], o = !0, r = 1; r < i.length; r++) {
                var l = i[r];
                0 !== n[l] && (o = !1)
            }
            o && (s.splice(t--, 1), e = a(a.s = i[0]))
        }
        return e
    }
    var o = {},
        n = {
            main: 0
        },
        s = [];
    function a(t) { 
        if (o[t])
            return o[t].exports;
        var i = o[t] = {
            i: t,
            l: !1,
            exports: {}
        };
        return e[t].call(i.exports, i, i.exports, a), i.l = !0, i.exports
    }
    a.e = function(e) {
        var t = [],
            i = n[e];
        if (0 !== i)
            if (i)
                t.push(i[2]);
            else {
                var o = new Promise((function(t, o) {
                    i = n[e] = [t, o]
                }));
                t.push(i[2] = o);
                var s,
                    r = document.createElement("script");
                r.charset = "utf-8",
                r.timeout = 120,
                a.nc && r.setAttribute("nonce", a.nc),
                r.src = function(e) {
                    return a.p + "" + ({
                        "vendors~pdfjsWorker": "vendors~pdfjsWorker"
                    }[e] || e) + ".52a8c702440818b0df6d.js"
                }(e);
                var l = new Error;
                s = function(t) {
                    r.onerror = r.onload = null,
                    clearTimeout(c);
                    var i = n[e];
                    if (0 !== i) {
                        if (i) {
                            var o = t && ("load" === t.type ? "missing" : t.type),
                                s = t && t.target && t.target.src;
                            l.message = "Loading chunk " + e + " failed.\n(" + o + ": " + s + ")",
                            l.name = "ChunkLoadError",
                            l.type = o,
                            l.request = s,
                            i[1](l)
                        }
                        n[e] = void 0
                    }
                };
                var c = setTimeout((function() {
                    s({
                        type: "timeout",
                        target: r
                    })
                }), 12e4);
                r.onerror = r.onload = s,
                document.head.appendChild(r)
            }
        return Promise.all(t)
    },
    a.m = e,
    a.c = o,
    a.d = function(e, t, i) {
        a.o(e, t) || Object.defineProperty(e, t, {
            enumerable: !0,
            get: i
        })
    },
    a.r = function(e) {
        "undefined" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(e, Symbol.toStringTag, {
            value: "Module"
        }),
        Object.defineProperty(e, "__esModule", {
            value: !0
        })
    },
    a.t = function(e, t) {
        if (1 & t && (e = a(e)), 8 & t)
            return e;
        if (4 & t && "object" == typeof e && e && e.__esModule)
            return e;
        var i = Object.create(null);
        if (a.r(i), Object.defineProperty(i, "default", {
            enumerable: !0,
            value: e
        }), 2 & t && "string" != typeof e)
            for (var o in e)
                a.d(i, o, function(t) {
                    return e[t]
                }.bind(null, o));
        return i
    },
    a.n = function(e) {
        var t = e && e.__esModule ? function() {
            return e.default
        } : function() {
            return e
        };
        return a.d(t, "a", t), t
    },
    a.o = function(e, t) {
        return Object.prototype.hasOwnProperty.call(e, t)
    },
    a.p = "",
    a.oe = function(e) {
        throw console.error(e), e
    };
    var r = window.webpackJsonplibs = window.webpackJsonplibs || [],
        l = r.push.bind(r);
    r.push = t,
    r = r.slice();
    for (var c = 0; c < r.length; c++)
        t(r[c]);
    var d = l;
    return s.push([0, "defaultVendors~main", "css~main"]), i()
}({
    "./node_modules/moment/locale sync recursive ^\\.\\/.*$": function(e, t, i) {
        var o = {
            "./af": "./node_modules/moment/locale/af.js",
            "./af.js": "./node_modules/moment/locale/af.js",
            "./ar": "./node_modules/moment/locale/ar.js",
            "./ar-dz": "./node_modules/moment/locale/ar-dz.js",
            "./ar-dz.js": "./node_modules/moment/locale/ar-dz.js",
            "./ar-kw": "./node_modules/moment/locale/ar-kw.js",
            "./ar-kw.js": "./node_modules/moment/locale/ar-kw.js",
            "./ar-ly": "./node_modules/moment/locale/ar-ly.js",
            "./ar-ly.js": "./node_modules/moment/locale/ar-ly.js",
            "./ar-ma": "./node_modules/moment/locale/ar-ma.js",
            "./ar-ma.js": "./node_modules/moment/locale/ar-ma.js",
            "./ar-sa": "./node_modules/moment/locale/ar-sa.js",
            "./ar-sa.js": "./node_modules/moment/locale/ar-sa.js",
            "./ar-tn": "./node_modules/moment/locale/ar-tn.js",
            "./ar-tn.js": "./node_modules/moment/locale/ar-tn.js",
            "./ar.js": "./node_modules/moment/locale/ar.js",
            "./az": "./node_modules/moment/locale/az.js",
            "./az.js": "./node_modules/moment/locale/az.js",
            "./be": "./node_modules/moment/locale/be.js",
            "./be.js": "./node_modules/moment/locale/be.js",
            "./bg": "./node_modules/moment/locale/bg.js",
            "./bg.js": "./node_modules/moment/locale/bg.js",
            "./bm": "./node_modules/moment/locale/bm.js",
            "./bm.js": "./node_modules/moment/locale/bm.js",
            "./bn": "./node_modules/moment/locale/bn.js",
            "./bn.js": "./node_modules/moment/locale/bn.js",
            "./bo": "./node_modules/moment/locale/bo.js",
            "./bo.js": "./node_modules/moment/locale/bo.js",
            "./br": "./node_modules/moment/locale/br.js",
            "./br.js": "./node_modules/moment/locale/br.js",
            "./bs": "./node_modules/moment/locale/bs.js",
            "./bs.js": "./node_modules/moment/locale/bs.js",
            "./ca": "./node_modules/moment/locale/ca.js",
            "./ca.js": "./node_modules/moment/locale/ca.js",
            "./cs": "./node_modules/moment/locale/cs.js",
            "./cs.js": "./node_modules/moment/locale/cs.js",
            "./cv": "./node_modules/moment/locale/cv.js",
            "./cv.js": "./node_modules/moment/locale/cv.js",
            "./cy": "./node_modules/moment/locale/cy.js",
            "./cy.js": "./node_modules/moment/locale/cy.js",
            "./da": "./node_modules/moment/locale/da.js",
            "./da.js": "./node_modules/moment/locale/da.js",
            "./de": "./node_modules/moment/locale/de.js",
            "./de-at": "./node_modules/moment/locale/de-at.js",
            "./de-at.js": "./node_modules/moment/locale/de-at.js",
            "./de-ch": "./node_modules/moment/locale/de-ch.js",
            "./de-ch.js": "./node_modules/moment/locale/de-ch.js",
            "./de.js": "./node_modules/moment/locale/de.js",
            "./dv": "./node_modules/moment/locale/dv.js",
            "./dv.js": "./node_modules/moment/locale/dv.js",
            "./el": "./node_modules/moment/locale/el.js",
            "./el.js": "./node_modules/moment/locale/el.js",
            "./en-SG": "./node_modules/moment/locale/en-SG.js",
            "./en-SG.js": "./node_modules/moment/locale/en-SG.js",
            "./en-au": "./node_modules/moment/locale/en-au.js",
            "./en-au.js": "./node_modules/moment/locale/en-au.js",
            "./en-ca": "./node_modules/moment/locale/en-ca.js",
            "./en-ca.js": "./node_modules/moment/locale/en-ca.js",
            "./en-gb": "./node_modules/moment/locale/en-gb.js",
            "./en-gb.js": "./node_modules/moment/locale/en-gb.js",
            "./en-ie": "./node_modules/moment/locale/en-ie.js",
            "./en-ie.js": "./node_modules/moment/locale/en-ie.js",
            "./en-il": "./node_modules/moment/locale/en-il.js",
            "./en-il.js": "./node_modules/moment/locale/en-il.js",
            "./en-nz": "./node_modules/moment/locale/en-nz.js",
            "./en-nz.js": "./node_modules/moment/locale/en-nz.js",
            "./eo": "./node_modules/moment/locale/eo.js",
            "./eo.js": "./node_modules/moment/locale/eo.js",
            "./es": "./node_modules/moment/locale/es.js",
            "./es-do": "./node_modules/moment/locale/es-do.js",
            "./es-do.js": "./node_modules/moment/locale/es-do.js",
            "./es-us": "./node_modules/moment/locale/es-us.js",
            "./es-us.js": "./node_modules/moment/locale/es-us.js",
            "./es.js": "./node_modules/moment/locale/es.js",
            "./et": "./node_modules/moment/locale/et.js",
            "./et.js": "./node_modules/moment/locale/et.js",
            "./eu": "./node_modules/moment/locale/eu.js",
            "./eu.js": "./node_modules/moment/locale/eu.js",
            "./fa": "./node_modules/moment/locale/fa.js",
            "./fa.js": "./node_modules/moment/locale/fa.js",
            "./fi": "./node_modules/moment/locale/fi.js",
            "./fi.js": "./node_modules/moment/locale/fi.js",
            "./fo": "./node_modules/moment/locale/fo.js",
            "./fo.js": "./node_modules/moment/locale/fo.js",
            "./fr": "./node_modules/moment/locale/fr.js",
            "./fr-ca": "./node_modules/moment/locale/fr-ca.js",
            "./fr-ca.js": "./node_modules/moment/locale/fr-ca.js",
            "./fr-ch": "./node_modules/moment/locale/fr-ch.js",
            "./fr-ch.js": "./node_modules/moment/locale/fr-ch.js",
            "./fr.js": "./node_modules/moment/locale/fr.js",
            "./fy": "./node_modules/moment/locale/fy.js",
            "./fy.js": "./node_modules/moment/locale/fy.js",
            "./ga": "./node_modules/moment/locale/ga.js",
            "./ga.js": "./node_modules/moment/locale/ga.js",
            "./gd": "./node_modules/moment/locale/gd.js",
            "./gd.js": "./node_modules/moment/locale/gd.js",
            "./gl": "./node_modules/moment/locale/gl.js",
            "./gl.js": "./node_modules/moment/locale/gl.js",
            "./gom-latn": "./node_modules/moment/locale/gom-latn.js",
            "./gom-latn.js": "./node_modules/moment/locale/gom-latn.js",
            "./gu": "./node_modules/moment/locale/gu.js",
            "./gu.js": "./node_modules/moment/locale/gu.js",
            "./he": "./node_modules/moment/locale/he.js",
            "./he.js": "./node_modules/moment/locale/he.js",
            "./hi": "./node_modules/moment/locale/hi.js",
            "./hi.js": "./node_modules/moment/locale/hi.js",
            "./hr": "./node_modules/moment/locale/hr.js",
            "./hr.js": "./node_modules/moment/locale/hr.js",
            "./hu": "./node_modules/moment/locale/hu.js",
            "./hu.js": "./node_modules/moment/locale/hu.js",
            "./hy-am": "./node_modules/moment/locale/hy-am.js",
            "./hy-am.js": "./node_modules/moment/locale/hy-am.js",
            "./id": "./node_modules/moment/locale/id.js",
            "./id.js": "./node_modules/moment/locale/id.js",
            "./is": "./node_modules/moment/locale/is.js",
            "./is.js": "./node_modules/moment/locale/is.js",
            "./it": "./node_modules/moment/locale/it.js",
            "./it-ch": "./node_modules/moment/locale/it-ch.js",
            "./it-ch.js": "./node_modules/moment/locale/it-ch.js",
            "./it.js": "./node_modules/moment/locale/it.js",
            "./ja": "./node_modules/moment/locale/ja.js",
            "./ja.js": "./node_modules/moment/locale/ja.js",
            "./jv": "./node_modules/moment/locale/jv.js",
            "./jv.js": "./node_modules/moment/locale/jv.js",
            "./ka": "./node_modules/moment/locale/ka.js",
            "./ka.js": "./node_modules/moment/locale/ka.js",
            "./kk": "./node_modules/moment/locale/kk.js",
            "./kk.js": "./node_modules/moment/locale/kk.js",
            "./km": "./node_modules/moment/locale/km.js",
            "./km.js": "./node_modules/moment/locale/km.js",
            "./kn": "./node_modules/moment/locale/kn.js",
            "./kn.js": "./node_modules/moment/locale/kn.js",
            "./ko": "./node_modules/moment/locale/ko.js",
            "./ko.js": "./node_modules/moment/locale/ko.js",
            "./ku": "./node_modules/moment/locale/ku.js",
            "./ku.js": "./node_modules/moment/locale/ku.js",
            "./ky": "./node_modules/moment/locale/ky.js",
            "./ky.js": "./node_modules/moment/locale/ky.js",
            "./lb": "./node_modules/moment/locale/lb.js",
            "./lb.js": "./node_modules/moment/locale/lb.js",
            "./lo": "./node_modules/moment/locale/lo.js",
            "./lo.js": "./node_modules/moment/locale/lo.js",
            "./lt": "./node_modules/moment/locale/lt.js",
            "./lt.js": "./node_modules/moment/locale/lt.js",
            "./lv": "./node_modules/moment/locale/lv.js",
            "./lv.js": "./node_modules/moment/locale/lv.js",
            "./me": "./node_modules/moment/locale/me.js",
            "./me.js": "./node_modules/moment/locale/me.js",
            "./mi": "./node_modules/moment/locale/mi.js",
            "./mi.js": "./node_modules/moment/locale/mi.js",
            "./mk": "./node_modules/moment/locale/mk.js",
            "./mk.js": "./node_modules/moment/locale/mk.js",
            "./ml": "./node_modules/moment/locale/ml.js",
            "./ml.js": "./node_modules/moment/locale/ml.js",
            "./mn": "./node_modules/moment/locale/mn.js",
            "./mn.js": "./node_modules/moment/locale/mn.js",
            "./mr": "./node_modules/moment/locale/mr.js",
            "./mr.js": "./node_modules/moment/locale/mr.js",
            "./ms": "./node_modules/moment/locale/ms.js",
            "./ms-my": "./node_modules/moment/locale/ms-my.js",
            "./ms-my.js": "./node_modules/moment/locale/ms-my.js",
            "./ms.js": "./node_modules/moment/locale/ms.js",
            "./mt": "./node_modules/moment/locale/mt.js",
            "./mt.js": "./node_modules/moment/locale/mt.js",
            "./my": "./node_modules/moment/locale/my.js",
            "./my.js": "./node_modules/moment/locale/my.js",
            "./nb": "./node_modules/moment/locale/nb.js",
            "./nb.js": "./node_modules/moment/locale/nb.js",
            "./ne": "./node_modules/moment/locale/ne.js",
            "./ne.js": "./node_modules/moment/locale/ne.js",
            "./nl": "./node_modules/moment/locale/nl.js",
            "./nl-be": "./node_modules/moment/locale/nl-be.js",
            "./nl-be.js": "./node_modules/moment/locale/nl-be.js",
            "./nl.js": "./node_modules/moment/locale/nl.js",
            "./nn": "./node_modules/moment/locale/nn.js",
            "./nn.js": "./node_modules/moment/locale/nn.js",
            "./pa-in": "./node_modules/moment/locale/pa-in.js",
            "./pa-in.js": "./node_modules/moment/locale/pa-in.js",
            "./pl": "./node_modules/moment/locale/pl.js",
            "./pl.js": "./node_modules/moment/locale/pl.js",
            "./pt": "./node_modules/moment/locale/pt.js",
            "./pt-br": "./node_modules/moment/locale/pt-br.js",
            "./pt-br.js": "./node_modules/moment/locale/pt-br.js",
            "./pt.js": "./node_modules/moment/locale/pt.js",
            "./ro": "./node_modules/moment/locale/ro.js",
            "./ro.js": "./node_modules/moment/locale/ro.js",
            "./ru": "./node_modules/moment/locale/ru.js",
            "./ru.js": "./node_modules/moment/locale/ru.js",
            "./sd": "./node_modules/moment/locale/sd.js",
            "./sd.js": "./node_modules/moment/locale/sd.js",
            "./se": "./node_modules/moment/locale/se.js",
            "./se.js": "./node_modules/moment/locale/se.js",
            "./si": "./node_modules/moment/locale/si.js",
            "./si.js": "./node_modules/moment/locale/si.js",
            "./sk": "./node_modules/moment/locale/sk.js",
            "./sk.js": "./node_modules/moment/locale/sk.js",
            "./sl": "./node_modules/moment/locale/sl.js",
            "./sl.js": "./node_modules/moment/locale/sl.js",
            "./sq": "./node_modules/moment/locale/sq.js",
            "./sq.js": "./node_modules/moment/locale/sq.js",
            "./sr": "./node_modules/moment/locale/sr.js",
            "./sr-cyrl": "./node_modules/moment/locale/sr-cyrl.js",
            "./sr-cyrl.js": "./node_modules/moment/locale/sr-cyrl.js",
            "./sr.js": "./node_modules/moment/locale/sr.js",
            "./ss": "./node_modules/moment/locale/ss.js",
            "./ss.js": "./node_modules/moment/locale/ss.js",
            "./sv": "./node_modules/moment/locale/sv.js",
            "./sv.js": "./node_modules/moment/locale/sv.js",
            "./sw": "./node_modules/moment/locale/sw.js",
            "./sw.js": "./node_modules/moment/locale/sw.js",
            "./ta": "./node_modules/moment/locale/ta.js",
            "./ta.js": "./node_modules/moment/locale/ta.js",
            "./te": "./node_modules/moment/locale/te.js",
            "./te.js": "./node_modules/moment/locale/te.js",
            "./tet": "./node_modules/moment/locale/tet.js",
            "./tet.js": "./node_modules/moment/locale/tet.js",
            "./tg": "./node_modules/moment/locale/tg.js",
            "./tg.js": "./node_modules/moment/locale/tg.js",
            "./th": "./node_modules/moment/locale/th.js",
            "./th.js": "./node_modules/moment/locale/th.js",
            "./tl-ph": "./node_modules/moment/locale/tl-ph.js",
            "./tl-ph.js": "./node_modules/moment/locale/tl-ph.js",
            "./tlh": "./node_modules/moment/locale/tlh.js",
            "./tlh.js": "./node_modules/moment/locale/tlh.js",
            "./tr": "./node_modules/moment/locale/tr.js",
            "./tr.js": "./node_modules/moment/locale/tr.js",
            "./tzl": "./node_modules/moment/locale/tzl.js",
            "./tzl.js": "./node_modules/moment/locale/tzl.js",
            "./tzm": "./node_modules/moment/locale/tzm.js",
            "./tzm-latn": "./node_modules/moment/locale/tzm-latn.js",
            "./tzm-latn.js": "./node_modules/moment/locale/tzm-latn.js",
            "./tzm.js": "./node_modules/moment/locale/tzm.js",
            "./ug-cn": "./node_modules/moment/locale/ug-cn.js",
            "./ug-cn.js": "./node_modules/moment/locale/ug-cn.js",
            "./uk": "./node_modules/moment/locale/uk.js",
            "./uk.js": "./node_modules/moment/locale/uk.js",
            "./ur": "./node_modules/moment/locale/ur.js",
            "./ur.js": "./node_modules/moment/locale/ur.js",
            "./uz": "./node_modules/moment/locale/uz.js",
            "./uz-latn": "./node_modules/moment/locale/uz-latn.js",
            "./uz-latn.js": "./node_modules/moment/locale/uz-latn.js",
            "./uz.js": "./node_modules/moment/locale/uz.js",
            "./vi": "./node_modules/moment/locale/vi.js",
            "./vi.js": "./node_modules/moment/locale/vi.js",
            "./x-pseudo": "./node_modules/moment/locale/x-pseudo.js",
            "./x-pseudo.js": "./node_modules/moment/locale/x-pseudo.js",
            "./yo": "./node_modules/moment/locale/yo.js",
            "./yo.js": "./node_modules/moment/locale/yo.js",
            "./zh-cn": "./node_modules/moment/locale/zh-cn.js",
            "./zh-cn.js": "./node_modules/moment/locale/zh-cn.js",
            "./zh-hk": "./node_modules/moment/locale/zh-hk.js",
            "./zh-hk.js": "./node_modules/moment/locale/zh-hk.js",
            "./zh-tw": "./node_modules/moment/locale/zh-tw.js",
            "./zh-tw.js": "./node_modules/moment/locale/zh-tw.js"
        };
        function n(e) {
            var t = s(e);
            return i(t)
        }
        function s(e) {
            if (!i.o(o, e)) {
                var t = new Error("Cannot find module '" + e + "'");
                throw t.code = "MODULE_NOT_FOUND", t
            }
            return o[e]
        }
        n.keys = function() {
            return Object.keys(o)
        },
        n.resolve = s,
        e.exports = n,
        n.id = "./node_modules/moment/locale sync recursive ^\\.\\/.*$"
    },
    "./node_modules/raw-loader/index.js!./node_modules/babel-loader/lib/index.js?!./node_modules/ifdef-loader/ifdef-loader.js?!./src/lib/jqueryui/jquery-ui-i18n.js": function(e, t) {
        e.exports = "/*! jQuery UI - v1.10.4 - 2014-01-29\n* http://jqueryui.com\n* Includes: jquery.ui.datepicker-af.js, jquery.ui.datepicker-ar-DZ.js, jquery.ui.datepicker-ar.js, jquery.ui.datepicker-az.js, jquery.ui.datepicker-bg.js, jquery.ui.datepicker-bs.js, jquery.ui.datepicker-ca.js, jquery.ui.datepicker-cs.js, jquery.ui.datepicker-cy-GB.js, jquery.ui.datepicker-da.js, jquery.ui.datepicker-de.js, jquery.ui.datepicker-el.js, jquery.ui.datepicker-en-AU.js, jquery.ui.datepicker-en-GB.js, jquery.ui.datepicker-en-NZ.js, jquery.ui.datepicker-eo.js, jquery.ui.datepicker-es.js, jquery.ui.datepicker-et.js, jquery.ui.datepicker-eu.js, jquery.ui.datepicker-fa.js, jquery.ui.datepicker-fi.js, jquery.ui.datepicker-fo.js, jquery.ui.datepicker-fr-CH.js, jquery.ui.datepicker-fr.js, jquery.ui.datepicker-gl.js, jquery.ui.datepicker-he.js, jquery.ui.datepicker-hi.js, jquery.ui.datepicker-hr.js, jquery.ui.datepicker-hu.js, jquery.ui.datepicker-hy.js, jquery.ui.datepicker-id.js, jquery.ui.datepicker-is.js, jquery.ui.datepicker-it.js, jquery.ui.datepicker-ja.js, jquery.ui.datepicker-ka.js, jquery.ui.datepicker-kk.js, jquery.ui.datepicker-km.js, jquery.ui.datepicker-ko.js, jquery.ui.datepicker-lb.js, jquery.ui.datepicker-lt.js, jquery.ui.datepicker-lv.js, jquery.ui.datepicker-mk.js, jquery.ui.datepicker-ml.js, jquery.ui.datepicker-ms.js, jquery.ui.datepicker-nl-BE.js, jquery.ui.datepicker-nl.js, jquery.ui.datepicker-no.js, jquery.ui.datepicker-pl.js, jquery.ui.datepicker-pt-BR.js, jquery.ui.datepicker-pt.js, jquery.ui.datepicker-rm.js, jquery.ui.datepicker-ro.js, jquery.ui.datepicker-ru.js, jquery.ui.datepicker-sk.js, jquery.ui.datepicker-sl.js, jquery.ui.datepicker-sq.js, jquery.ui.datepicker-sr-SR.js, jquery.ui.datepicker-sr.js, jquery.ui.datepicker-sv.js, jquery.ui.datepicker-ta.js, jquery.ui.datepicker-th.js, jquery.ui.datepicker-tj.js, jquery.ui.datepicker-tr.js, jquery.ui.datepicker-uk.js, jquery.ui.datepicker-vi.js, jquery.ui.datepicker-zh-CN.js, jquery.ui.datepicker-zh-HK.js, jquery.ui.datepicker-zh-TW.js, jquery.ui.datepicker-be.js, jquery.ui.datepicker-fr-CA.js, jquery.ui.datepicker-ky.js, jquery.ui.datepicker-nb.js, jquery.ui.datepicker-nn.js\n* Copyright 2014 jQuery Foundation and other contributors; Licensed MIT */\n\n/* Written by Renier Pretorius. */\n(function ($) {\n  $.datepicker.regional['af'] = {\n    closeText: 'Selekteer',\n    prevText: 'Vorige',\n    nextText: 'Volgende',\n    currentText: 'Vandag',\n    monthNames: ['Januarie', 'Februarie', 'Maart', 'April', 'Mei', 'Junie', 'Julie', 'Augustus', 'September', 'Oktober', 'November', 'Desember'],\n    monthNamesShort: ['Jan', 'Feb', 'Mrt', 'Apr', 'Mei', 'Jun', 'Jul', 'Aug', 'Sep', 'Okt', 'Nov', 'Des'],\n    dayNames: ['Sondag', 'Maandag', 'Dinsdag', 'Woensdag', 'Donderdag', 'Vrydag', 'Saterdag'],\n    dayNamesShort: ['Son', 'Maa', 'Din', 'Woe', 'Don', 'Vry', 'Sat'],\n    dayNamesMin: ['So', 'Ma', 'Di', 'Wo', 'Do', 'Vr', 'Sa'],\n    weekHeader: 'Wk',\n    dateFormat: 'dd/mm/yy',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['af']);\n\n  /* Mohamed Cherif BOUCHELAGHEM -- cherifbouchelaghem@yahoo.fr */\n\n  $.datepicker.regional['ar-DZ'] = {\n    closeText: 'إغلاق',\n    prevText: '&#x3C;السابق',\n    nextText: 'التالي&#x3E;',\n    currentText: 'اليوم',\n    monthNames: ['جانفي', 'فيفري', 'مارس', 'أفريل', 'ماي', 'جوان', 'جويلية', 'أوت', 'سبتمبر', 'أكتوبر', 'نوفمبر', 'ديسمبر'],\n    monthNamesShort: ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12'],\n    dayNames: ['الأحد', 'الاثنين', 'الثلاثاء', 'الأربعاء', 'الخميس', 'الجمعة', 'السبت'],\n    dayNamesShort: ['الأحد', 'الاثنين', 'الثلاثاء', 'الأربعاء', 'الخميس', 'الجمعة', 'السبت'],\n    dayNamesMin: ['الأحد', 'الاثنين', 'الثلاثاء', 'الأربعاء', 'الخميس', 'الجمعة', 'السبت'],\n    weekHeader: 'أسبوع',\n    dateFormat: 'dd/mm/yy',\n    firstDay: 6,\n    isRTL: true,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['ar-DZ']);\n\n  /* Khaled Alhourani -- me@khaledalhourani.com */\n\n  /* NOTE: monthNames are the original months names and they are the Arabic names, not the new months name فبراير - يناير and there isn't any Arabic roots for these months */\n\n  $.datepicker.regional['ar'] = {\n    closeText: 'إغلاق',\n    prevText: '&#x3C;السابق',\n    nextText: 'التالي&#x3E;',\n    currentText: 'اليوم',\n    monthNames: ['كانون الثاني', 'شباط', 'آذار', 'نيسان', 'مايو', 'حزيران', 'تموز', 'آب', 'أيلول', 'تشرين الأول', 'تشرين الثاني', 'كانون الأول'],\n    monthNamesShort: ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12'],\n    dayNames: ['الأحد', 'الاثنين', 'الثلاثاء', 'الأربعاء', 'الخميس', 'الجمعة', 'السبت'],\n    dayNamesShort: ['الأحد', 'الاثنين', 'الثلاثاء', 'الأربعاء', 'الخميس', 'الجمعة', 'السبت'],\n    dayNamesMin: ['ح', 'ن', 'ث', 'ر', 'خ', 'ج', 'س'],\n    weekHeader: 'أسبوع',\n    dateFormat: 'dd/mm/yy',\n    firstDay: 6,\n    isRTL: true,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['ar']);\n\n  /* Written by Jamil Najafov (necefov33@gmail.com). */\n\n  $.datepicker.regional['az'] = {\n    closeText: 'Bağla',\n    prevText: '&#x3C;Geri',\n    nextText: 'İrəli&#x3E;',\n    currentText: 'Bugün',\n    monthNames: ['Yanvar', 'Fevral', 'Mart', 'Aprel', 'May', 'İyun', 'İyul', 'Avqust', 'Sentyabr', 'Oktyabr', 'Noyabr', 'Dekabr'],\n    monthNamesShort: ['Yan', 'Fev', 'Mar', 'Apr', 'May', 'İyun', 'İyul', 'Avq', 'Sen', 'Okt', 'Noy', 'Dek'],\n    dayNames: ['Bazar', 'Bazar ertəsi', 'Çərşənbə axşamı', 'Çərşənbə', 'Cümə axşamı', 'Cümə', 'Şənbə'],\n    dayNamesShort: ['B', 'Be', 'Ça', 'Ç', 'Ca', 'C', 'Ş'],\n    dayNamesMin: ['B', 'B', 'Ç', 'С', 'Ç', 'C', 'Ş'],\n    weekHeader: 'Hf',\n    dateFormat: 'dd.mm.yy',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['az']);\n\n  /* Written by Stoyan Kyosev (http://svest.org). */\n\n  $.datepicker.regional['bg'] = {\n    closeText: 'затвори',\n    prevText: '&#x3C;назад',\n    nextText: 'напред&#x3E;',\n    nextBigText: '&#x3E;&#x3E;',\n    currentText: 'днес',\n    monthNames: ['Януари', 'Февруари', 'Март', 'Април', 'Май', 'Юни', 'Юли', 'Август', 'Септември', 'Октомври', 'Ноември', 'Декември'],\n    monthNamesShort: ['Яну', 'Фев', 'Мар', 'Апр', 'Май', 'Юни', 'Юли', 'Авг', 'Сеп', 'Окт', 'Нов', 'Дек'],\n    dayNames: ['Неделя', 'Понеделник', 'Вторник', 'Сряда', 'Четвъртък', 'Петък', 'Събота'],\n    dayNamesShort: ['Нед', 'Пон', 'Вто', 'Сря', 'Чет', 'Пет', 'Съб'],\n    dayNamesMin: ['Не', 'По', 'Вт', 'Ср', 'Че', 'Пе', 'Съ'],\n    weekHeader: 'Wk',\n    dateFormat: 'dd.mm.yy',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['bg']);\n\n  /* Written by Kenan Konjo. */\n\n  $.datepicker.regional['bs'] = {\n    closeText: 'Zatvori',\n    prevText: '&#x3C;',\n    nextText: '&#x3E;',\n    currentText: 'Danas',\n    monthNames: ['Januar', 'Februar', 'Mart', 'April', 'Maj', 'Juni', 'Juli', 'August', 'Septembar', 'Oktobar', 'Novembar', 'Decembar'],\n    monthNamesShort: ['Jan', 'Feb', 'Mar', 'Apr', 'Maj', 'Jun', 'Jul', 'Aug', 'Sep', 'Okt', 'Nov', 'Dec'],\n    dayNames: ['Nedelja', 'Ponedeljak', 'Utorak', 'Srijeda', 'Četvrtak', 'Petak', 'Subota'],\n    dayNamesShort: ['Ned', 'Pon', 'Uto', 'Sri', 'Čet', 'Pet', 'Sub'],\n    dayNamesMin: ['Ne', 'Po', 'Ut', 'Sr', 'Če', 'Pe', 'Su'],\n    weekHeader: 'Wk',\n    dateFormat: 'dd.mm.yy',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['bs']);\n\n  /* Writers: (joan.leon@gmail.com). */\n\n  $.datepicker.regional['ca'] = {\n    closeText: 'Tanca',\n    prevText: 'Anterior',\n    nextText: 'Següent',\n    currentText: 'Avui',\n    monthNames: ['gener', 'febrer', 'març', 'abril', 'maig', 'juny', 'juliol', 'agost', 'setembre', 'octubre', 'novembre', 'desembre'],\n    monthNamesShort: ['gen', 'feb', 'març', 'abr', 'maig', 'juny', 'jul', 'ag', 'set', 'oct', 'nov', 'des'],\n    dayNames: ['diumenge', 'dilluns', 'dimarts', 'dimecres', 'dijous', 'divendres', 'dissabte'],\n    dayNamesShort: ['dg', 'dl', 'dt', 'dc', 'dj', 'dv', 'ds'],\n    dayNamesMin: ['dg', 'dl', 'dt', 'dc', 'dj', 'dv', 'ds'],\n    weekHeader: 'Set',\n    dateFormat: 'dd/mm/yy',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['ca']);\n\n  /* Written by Tomas Muller (tomas@tomas-muller.net). */\n\n  $.datepicker.regional['cs'] = {\n    closeText: 'Zavřít',\n    prevText: '&#x3C;Dříve',\n    nextText: 'Později&#x3E;',\n    currentText: 'Nyní',\n    monthNames: ['leden', 'únor', 'březen', 'duben', 'květen', 'červen', 'červenec', 'srpen', 'září', 'říjen', 'listopad', 'prosinec'],\n    monthNamesShort: ['led', 'úno', 'bře', 'dub', 'kvě', 'čer', 'čvc', 'srp', 'zář', 'říj', 'lis', 'pro'],\n    dayNames: ['neděle', 'pondělí', 'úterý', 'středa', 'čtvrtek', 'pátek', 'sobota'],\n    dayNamesShort: ['ne', 'po', 'út', 'st', 'čt', 'pá', 'so'],\n    dayNamesMin: ['ne', 'po', 'út', 'st', 'čt', 'pá', 'so'],\n    weekHeader: 'Týd',\n    dateFormat: 'dd.mm.yy',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['cs']);\n\n  /* Written by William Griffiths. */\n\n  $.datepicker.regional['cy-GB'] = {\n    closeText: 'Done',\n    prevText: 'Prev',\n    nextText: 'Next',\n    currentText: 'Today',\n    monthNames: ['Ionawr', 'Chwefror', 'Mawrth', 'Ebrill', 'Mai', 'Mehefin', 'Gorffennaf', 'Awst', 'Medi', 'Hydref', 'Tachwedd', 'Rhagfyr'],\n    monthNamesShort: ['Ion', 'Chw', 'Maw', 'Ebr', 'Mai', 'Meh', 'Gor', 'Aws', 'Med', 'Hyd', 'Tac', 'Rha'],\n    dayNames: ['Dydd Sul', 'Dydd Llun', 'Dydd Mawrth', 'Dydd Mercher', 'Dydd Iau', 'Dydd Gwener', 'Dydd Sadwrn'],\n    dayNamesShort: ['Sul', 'Llu', 'Maw', 'Mer', 'Iau', 'Gwe', 'Sad'],\n    dayNamesMin: ['Su', 'Ll', 'Ma', 'Me', 'Ia', 'Gw', 'Sa'],\n    weekHeader: 'Wy',\n    dateFormat: 'dd/mm/yy',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['cy-GB']);\n\n  /* Written by Jan Christensen ( deletestuff@gmail.com). */\n\n  $.datepicker.regional['da'] = {\n    closeText: 'Luk',\n    prevText: '&#x3C;Forrige',\n    nextText: 'Næste&#x3E;',\n    currentText: 'Idag',\n    monthNames: ['Januar', 'Februar', 'Marts', 'April', 'Maj', 'Juni', 'Juli', 'August', 'September', 'Oktober', 'November', 'December'],\n    monthNamesShort: ['Jan', 'Feb', 'Mar', 'Apr', 'Maj', 'Jun', 'Jul', 'Aug', 'Sep', 'Okt', 'Nov', 'Dec'],\n    dayNames: ['Søndag', 'Mandag', 'Tirsdag', 'Onsdag', 'Torsdag', 'Fredag', 'Lørdag'],\n    dayNamesShort: ['Søn', 'Man', 'Tir', 'Ons', 'Tor', 'Fre', 'Lør'],\n    dayNamesMin: ['Sø', 'Ma', 'Ti', 'On', 'To', 'Fr', 'Lø'],\n    weekHeader: 'Uge',\n    dateFormat: 'dd-mm-yy',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['da']);\n\n  /* Written by Milian Wolff (mail@milianw.de). */\n\n  $.datepicker.regional['de'] = {\n    closeText: 'Schließen',\n    prevText: '&#x3C;Zurück',\n    nextText: 'Vor&#x3E;',\n    currentText: 'Heute',\n    monthNames: ['Januar', 'Februar', 'März', 'April', 'Mai', 'Juni', 'Juli', 'August', 'September', 'Oktober', 'November', 'Dezember'],\n    monthNamesShort: ['Jan', 'Feb', 'Mär', 'Apr', 'Mai', 'Jun', 'Jul', 'Aug', 'Sep', 'Okt', 'Nov', 'Dez'],\n    dayNames: ['Sonntag', 'Montag', 'Dienstag', 'Mittwoch', 'Donnerstag', 'Freitag', 'Samstag'],\n    dayNamesShort: ['So', 'Mo', 'Di', 'Mi', 'Do', 'Fr', 'Sa'],\n    dayNamesMin: ['So', 'Mo', 'Di', 'Mi', 'Do', 'Fr', 'Sa'],\n    weekHeader: 'KW',\n    dateFormat: 'dd.mm.yy',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['de']);\n\n  /* Written by Alex Cicovic (http://www.alexcicovic.com) */\n\n  $.datepicker.regional['el'] = {\n    closeText: 'Κλείσιμο',\n    prevText: 'Προηγούμενος',\n    nextText: 'Επόμενος',\n    currentText: 'Τρέχων Μήνας',\n    monthNames: ['Ιανουάριος', 'Φεβρουάριος', 'Μάρτιος', 'Απρίλιος', 'Μάιος', 'Ιούνιος', 'Ιούλιος', 'Αύγουστος', 'Σεπτέμβριος', 'Οκτώβριος', 'Νοέμβριος', 'Δεκέμβριος'],\n    monthNamesShort: ['Ιαν', 'Φεβ', 'Μαρ', 'Απρ', 'Μαι', 'Ιουν', 'Ιουλ', 'Αυγ', 'Σεπ', 'Οκτ', 'Νοε', 'Δεκ'],\n    dayNames: ['Κυριακή', 'Δευτέρα', 'Τρίτη', 'Τετάρτη', 'Πέμπτη', 'Παρασκευή', 'Σάββατο'],\n    dayNamesShort: ['Κυρ', 'Δευ', 'Τρι', 'Τετ', 'Πεμ', 'Παρ', 'Σαβ'],\n    dayNamesMin: ['Κυ', 'Δε', 'Τρ', 'Τε', 'Πε', 'Πα', 'Σα'],\n    weekHeader: 'Εβδ',\n    dateFormat: 'dd/mm/yy',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['el']);\n\n  /* Based on the en-GB initialisation. */\n\n  $.datepicker.regional['en-AU'] = {\n    closeText: 'Done',\n    prevText: 'Prev',\n    nextText: 'Next',\n    currentText: 'Today',\n    monthNames: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'],\n    monthNamesShort: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],\n    dayNames: ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'],\n    dayNamesShort: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],\n    dayNamesMin: ['Su', 'Mo', 'Tu', 'We', 'Th', 'Fr', 'Sa'],\n    weekHeader: 'Wk',\n    dateFormat: 'dd/mm/yy',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['en-AU']);\n\n  /* Written by Stuart. */\n\n  $.datepicker.regional['en-GB'] = {\n    closeText: 'Done',\n    prevText: 'Prev',\n    nextText: 'Next',\n    currentText: 'Today',\n    monthNames: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'],\n    monthNamesShort: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],\n    dayNames: ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'],\n    dayNamesShort: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],\n    dayNamesMin: ['Su', 'Mo', 'Tu', 'We', 'Th', 'Fr', 'Sa'],\n    weekHeader: 'Wk',\n    dateFormat: 'dd/mm/yy',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['en-GB']);\n\n  /* Based on the en-GB initialisation. */\n\n  $.datepicker.regional['en-NZ'] = {\n    closeText: 'Done',\n    prevText: 'Prev',\n    nextText: 'Next',\n    currentText: 'Today',\n    monthNames: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'],\n    monthNamesShort: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],\n    dayNames: ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'],\n    dayNamesShort: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],\n    dayNamesMin: ['Su', 'Mo', 'Tu', 'We', 'Th', 'Fr', 'Sa'],\n    weekHeader: 'Wk',\n    dateFormat: 'dd/mm/yy',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['en-NZ']);\n\n  /* Written by Olivier M. (olivierweb@ifrance.com). */\n\n  $.datepicker.regional['eo'] = {\n    closeText: 'Fermi',\n    prevText: '&#x3C;Anta',\n    nextText: 'Sekv&#x3E;',\n    currentText: 'Nuna',\n    monthNames: ['Januaro', 'Februaro', 'Marto', 'Aprilo', 'Majo', 'Junio', 'Julio', 'Aŭgusto', 'Septembro', 'Oktobro', 'Novembro', 'Decembro'],\n    monthNamesShort: ['Jan', 'Feb', 'Mar', 'Apr', 'Maj', 'Jun', 'Jul', 'Aŭg', 'Sep', 'Okt', 'Nov', 'Dec'],\n    dayNames: ['Dimanĉo', 'Lundo', 'Mardo', 'Merkredo', 'Ĵaŭdo', 'Vendredo', 'Sabato'],\n    dayNamesShort: ['Dim', 'Lun', 'Mar', 'Mer', 'Ĵaŭ', 'Ven', 'Sab'],\n    dayNamesMin: ['Di', 'Lu', 'Ma', 'Me', 'Ĵa', 'Ve', 'Sa'],\n    weekHeader: 'Sb',\n    dateFormat: 'dd/mm/yy',\n    firstDay: 0,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['eo']);\n\n  /* Traducido por Vester (xvester@gmail.com). */\n\n  $.datepicker.regional['es'] = {\n    closeText: 'Cerrar',\n    prevText: '&#x3C;Ant',\n    nextText: 'Sig&#x3E;',\n    currentText: 'Hoy',\n    monthNames: ['enero', 'febrero', 'marzo', 'abril', 'mayo', 'junio', 'julio', 'agosto', 'septiembre', 'octubre', 'noviembre', 'diciembre'],\n    monthNamesShort: ['ene', 'feb', 'mar', 'abr', 'may', 'jun', 'jul', 'ogo', 'sep', 'oct', 'nov', 'dic'],\n    dayNames: ['domingo', 'lunes', 'martes', 'miércoles', 'jueves', 'viernes', 'sábado'],\n    dayNamesShort: ['dom', 'lun', 'mar', 'mié', 'juv', 'vie', 'sáb'],\n    dayNamesMin: ['D', 'L', 'M', 'X', 'J', 'V', 'S'],\n    weekHeader: 'Sm',\n    dateFormat: 'dd/mm/yy',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['es']);\n\n  /* Written by Mart Sõmermaa (mrts.pydev at gmail com). */\n\n  $.datepicker.regional['et'] = {\n    closeText: 'Sulge',\n    prevText: 'Eelnev',\n    nextText: 'Järgnev',\n    currentText: 'Täna',\n    monthNames: ['Jaanuar', 'Veebruar', 'Märts', 'Aprill', 'Mai', 'Juuni', 'Juuli', 'August', 'September', 'Oktoober', 'November', 'Detsember'],\n    monthNamesShort: ['Jaan', 'Veebr', 'Märts', 'Apr', 'Mai', 'Juuni', 'Juuli', 'Aug', 'Sept', 'Okt', 'Nov', 'Dets'],\n    dayNames: ['Pühapäev', 'Esmaspäev', 'Teisipäev', 'Kolmapäev', 'Neljapäev', 'Reede', 'Laupäev'],\n    dayNamesShort: ['Pühap', 'Esmasp', 'Teisip', 'Kolmap', 'Neljap', 'Reede', 'Laup'],\n    dayNamesMin: ['P', 'E', 'T', 'K', 'N', 'R', 'L'],\n    weekHeader: 'näd',\n    dateFormat: 'dd.mm.yy',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['et']);\n\n  /* Karrikas-ek itzulia (karrikas@karrikas.com) */\n\n  $.datepicker.regional['eu'] = {\n    closeText: 'Egina',\n    prevText: '&#x3C;Aur',\n    nextText: 'Hur&#x3E;',\n    currentText: 'Gaur',\n    monthNames: ['urtarrila', 'otsaila', 'martxoa', 'apirila', 'maiatza', 'ekaina', 'uztaila', 'abuztua', 'iraila', 'urria', 'azaroa', 'abendua'],\n    monthNamesShort: ['urt.', 'ots.', 'mar.', 'api.', 'mai.', 'eka.', 'uzt.', 'abu.', 'ira.', 'urr.', 'aza.', 'abe.'],\n    dayNames: ['igandea', 'astelehena', 'asteartea', 'asteazkena', 'osteguna', 'ostirala', 'larunbata'],\n    dayNamesShort: ['ig.', 'al.', 'ar.', 'az.', 'og.', 'ol.', 'lr.'],\n    dayNamesMin: ['ig', 'al', 'ar', 'az', 'og', 'ol', 'lr'],\n    weekHeader: 'As',\n    dateFormat: 'yy-mm-dd',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['eu']);\n\n  /* Javad Mowlanezhad -- jmowla@gmail.com */\n\n  /* Jalali calendar should supported soon! (Its implemented but I have to test it) */\n\n  $.datepicker.regional['fa'] = {\n    closeText: 'بستن',\n    prevText: '&#x3C;قبلی',\n    nextText: 'بعدی&#x3E;',\n    currentText: 'امروز',\n    monthNames: ['فروردين', 'ارديبهشت', 'خرداد', 'تير', 'مرداد', 'شهريور', 'مهر', 'آبان', 'آذر', 'دی', 'بهمن', 'اسفند'],\n    monthNamesShort: ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12'],\n    dayNames: ['يکشنبه', 'دوشنبه', 'سه‌شنبه', 'چهارشنبه', 'پنجشنبه', 'جمعه', 'شنبه'],\n    dayNamesShort: ['ی', 'د', 'س', 'چ', 'پ', 'ج', 'ش'],\n    dayNamesMin: ['ی', 'د', 'س', 'چ', 'پ', 'ج', 'ش'],\n    weekHeader: 'هف',\n    dateFormat: 'yy/mm/dd',\n    firstDay: 6,\n    isRTL: true,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['fa']);\n\n  /* Written by Harri Kilpiö (harrikilpio@gmail.com). */\n\n  $.datepicker.regional['fi'] = {\n    closeText: 'Sulje',\n    prevText: '&#xAB;Edellinen',\n    nextText: 'Seuraava&#xBB;',\n    currentText: 'Tänään',\n    monthNames: ['Tammikuu', 'Helmikuu', 'Maaliskuu', 'Huhtikuu', 'Toukokuu', 'Kesäkuu', 'Heinäkuu', 'Elokuu', 'Syyskuu', 'Lokakuu', 'Marraskuu', 'Joulukuu'],\n    monthNamesShort: ['Tammi', 'Helmi', 'Maalis', 'Huhti', 'Touko', 'Kesä', 'Heinä', 'Elo', 'Syys', 'Loka', 'Marras', 'Joulu'],\n    dayNamesShort: ['Su', 'Ma', 'Ti', 'Ke', 'To', 'Pe', 'La'],\n    dayNames: ['Sunnuntai', 'Maanantai', 'Tiistai', 'Keskiviikko', 'Torstai', 'Perjantai', 'Lauantai'],\n    dayNamesMin: ['Su', 'Ma', 'Ti', 'Ke', 'To', 'Pe', 'La'],\n    weekHeader: 'Vk',\n    dateFormat: 'd.m.yy',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['fi']);\n\n  /* Written by Sverri Mohr Olsen, sverrimo@gmail.com */\n\n  $.datepicker.regional['fo'] = {\n    closeText: 'Lat aftur',\n    prevText: '&#x3C;Fyrra',\n    nextText: 'Næsta&#x3E;',\n    currentText: 'Í dag',\n    monthNames: ['Januar', 'Februar', 'Mars', 'Apríl', 'Mei', 'Juni', 'Juli', 'August', 'September', 'Oktober', 'November', 'Desember'],\n    monthNamesShort: ['Jan', 'Feb', 'Mar', 'Apr', 'Mei', 'Jun', 'Jul', 'Aug', 'Sep', 'Okt', 'Nov', 'Des'],\n    dayNames: ['Sunnudagur', 'Mánadagur', 'Týsdagur', 'Mikudagur', 'Hósdagur', 'Fríggjadagur', 'Leyardagur'],\n    dayNamesShort: ['Sun', 'Mán', 'Týs', 'Mik', 'Hós', 'Frí', 'Ley'],\n    dayNamesMin: ['Su', 'Má', 'Tý', 'Mi', 'Hó', 'Fr', 'Le'],\n    weekHeader: 'Vk',\n    dateFormat: 'dd-mm-yy',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['fo']);\n\n  /* Written Martin Voelkle (martin.voelkle@e-tc.ch). */\n\n  $.datepicker.regional['fr-CH'] = {\n    closeText: 'Fermer',\n    prevText: '&#x3C;Préc',\n    nextText: 'Suiv&#x3E;',\n    currentText: 'Courant',\n    monthNames: ['janvier', 'février', 'mars', 'avril', 'mai', 'juin', 'juillet', 'août', 'septembre', 'octobre', 'novembre', 'décembre'],\n    monthNamesShort: ['janv.', 'févr.', 'mars', 'avril', 'mai', 'juin', 'juil.', 'août', 'sept.', 'oct.', 'nov.', 'déc.'],\n    dayNames: ['dimanche', 'lundi', 'mardi', 'mercredi', 'jeudi', 'vendredi', 'samedi'],\n    dayNamesShort: ['dim.', 'lun.', 'mar.', 'mer.', 'jeu.', 'ven.', 'sam.'],\n    dayNamesMin: ['D', 'L', 'M', 'M', 'J', 'V', 'S'],\n    weekHeader: 'Sm',\n    dateFormat: 'dd.mm.yy',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['fr-CH']);\n\n  /* Written by Keith Wood (kbwood{at}iinet.com.au),\n  \t\t\t  Stéphane Nahmani (sholby@sholby.net),\n  \t\t\t  Stéphane Raimbault <stephane.raimbault@gmail.com> */\n\n  $.datepicker.regional['fr'] = {\n    closeText: 'Fermer',\n    prevText: 'Précédent',\n    nextText: 'Suivant',\n    currentText: 'Aujourd\\'hui',\n    monthNames: ['janvier', 'février', 'mars', 'avril', 'mai', 'juin', 'juillet', 'août', 'septembre', 'octobre', 'novembre', 'décembre'],\n    monthNamesShort: ['janv.', 'févr.', 'mars', 'avril', 'mai', 'juin', 'juil.', 'août', 'sept.', 'oct.', 'nov.', 'déc.'],\n    dayNames: ['dimanche', 'lundi', 'mardi', 'mercredi', 'jeudi', 'vendredi', 'samedi'],\n    dayNamesShort: ['dim.', 'lun.', 'mar.', 'mer.', 'jeu.', 'ven.', 'sam.'],\n    dayNamesMin: ['D', 'L', 'M', 'M', 'J', 'V', 'S'],\n    weekHeader: 'Sem.',\n    dateFormat: 'dd/mm/yy',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['fr']);\n\n  /* Translated by Jorge Barreiro <yortx.barry@gmail.com>. */\n\n  $.datepicker.regional['gl'] = {\n    closeText: 'Pechar',\n    prevText: '&#x3C;Ant',\n    nextText: 'Seg&#x3E;',\n    currentText: 'Hoxe',\n    monthNames: ['Xaneiro', 'Febreiro', 'Marzo', 'Abril', 'Maio', 'Xuño', 'Xullo', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Decembro'],\n    monthNamesShort: ['Xan', 'Feb', 'Mar', 'Abr', 'Mai', 'Xuñ', 'Xul', 'Ago', 'Set', 'Out', 'Nov', 'Dec'],\n    dayNames: ['Domingo', 'Luns', 'Martes', 'Mércores', 'Xoves', 'Venres', 'Sábado'],\n    dayNamesShort: ['Dom', 'Lun', 'Mar', 'Mér', 'Xov', 'Ven', 'Sáb'],\n    dayNamesMin: ['Do', 'Lu', 'Ma', 'Mé', 'Xo', 'Ve', 'Sá'],\n    weekHeader: 'Sm',\n    dateFormat: 'dd/mm/yy',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['gl']);\n\n  /* Written by Amir Hardon (ahardon at gmail dot com). */\n\n  $.datepicker.regional['he'] = {\n    closeText: 'סגור',\n    prevText: '&#x3C;הקודם',\n    nextText: 'הבא&#x3E;',\n    currentText: 'היום',\n    monthNames: ['ינואר', 'פברואר', 'מרץ', 'אפריל', 'מאי', 'יוני', 'יולי', 'אוגוסט', 'ספטמבר', 'אוקטובר', 'נובמבר', 'דצמבר'],\n    monthNamesShort: ['ינו', 'פבר', 'מרץ', 'אפר', 'מאי', 'יוני', 'יולי', 'אוג', 'ספט', 'אוק', 'נוב', 'דצמ'],\n    dayNames: ['ראשון', 'שני', 'שלישי', 'רביעי', 'חמישי', 'שישי', 'שבת'],\n    dayNamesShort: ['א\\'', 'ב\\'', 'ג\\'', 'ד\\'', 'ה\\'', 'ו\\'', 'שבת'],\n    dayNamesMin: ['א\\'', 'ב\\'', 'ג\\'', 'ד\\'', 'ה\\'', 'ו\\'', 'שבת'],\n    weekHeader: 'Wk',\n    dateFormat: 'dd/mm/yy',\n    firstDay: 0,\n    isRTL: true,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['he']);\n\n  /* Written by Michael Dawart. */\n\n  $.datepicker.regional['hi'] = {\n    closeText: 'बंद',\n    prevText: 'पिछला',\n    nextText: 'अगला',\n    currentText: 'आज',\n    monthNames: ['जनवरी ', 'फरवरी', 'मार्च', 'अप्रेल', 'मई', 'जून', 'जूलाई', 'अगस्त ', 'सितम्बर', 'अक्टूबर', 'नवम्बर', 'दिसम्बर'],\n    monthNamesShort: ['जन', 'फर', 'मार्च', 'अप्रेल', 'मई', 'जून', 'जूलाई', 'अग', 'सित', 'अक्ट', 'नव', 'दि'],\n    dayNames: ['रविवार', 'सोमवार', 'मंगलवार', 'बुधवार', 'गुरुवार', 'शुक्रवार', 'शनिवार'],\n    dayNamesShort: ['रवि', 'सोम', 'मंगल', 'बुध', 'गुरु', 'शुक्र', 'शनि'],\n    dayNamesMin: ['रवि', 'सोम', 'मंगल', 'बुध', 'गुरु', 'शुक्र', 'शनि'],\n    weekHeader: 'हफ्ता',\n    dateFormat: 'dd/mm/yy',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['hi']);\n\n  /* Written by Vjekoslav Nesek. */\n\n  $.datepicker.regional['hr'] = {\n    closeText: 'Zatvori',\n    prevText: '&#x3C;',\n    nextText: '&#x3E;',\n    currentText: 'Danas',\n    monthNames: ['Siječanj', 'Veljača', 'Ožujak', 'Travanj', 'Svibanj', 'Lipanj', 'Srpanj', 'Kolovoz', 'Rujan', 'Listopad', 'Studeni', 'Prosinac'],\n    monthNamesShort: ['Sij', 'Velj', 'Ožu', 'Tra', 'Svi', 'Lip', 'Srp', 'Kol', 'Ruj', 'Lis', 'Stu', 'Pro'],\n    dayNames: ['Nedjelja', 'Ponedjeljak', 'Utorak', 'Srijeda', 'Četvrtak', 'Petak', 'Subota'],\n    dayNamesShort: ['Ned', 'Pon', 'Uto', 'Sri', 'Čet', 'Pet', 'Sub'],\n    dayNamesMin: ['Ne', 'Po', 'Ut', 'Sr', 'Če', 'Pe', 'Su'],\n    weekHeader: 'Tje',\n    dateFormat: 'dd.mm.yy.',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['hr']);\n\n  /* Written by Istvan Karaszi (jquery@spam.raszi.hu). */\n\n  $.datepicker.regional['hu'] = {\n    closeText: 'bezár',\n    prevText: 'vissza',\n    nextText: 'előre',\n    currentText: 'ma',\n    monthNames: ['Január', 'Február', 'Március', 'Április', 'Május', 'Június', 'Július', 'Augusztus', 'Szeptember', 'Október', 'November', 'December'],\n    monthNamesShort: ['Jan', 'Feb', 'Már', 'Ápr', 'Máj', 'Jún', 'Júl', 'Aug', 'Szep', 'Okt', 'Nov', 'Dec'],\n    dayNames: ['Vasárnap', 'Hétfő', 'Kedd', 'Szerda', 'Csütörtök', 'Péntek', 'Szombat'],\n    dayNamesShort: ['Vas', 'Hét', 'Ked', 'Sze', 'Csü', 'Pén', 'Szo'],\n    dayNamesMin: ['V', 'H', 'K', 'Sze', 'Cs', 'P', 'Szo'],\n    weekHeader: 'Hét',\n    dateFormat: 'yy.mm.dd.',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: true,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['hu']);\n\n  /* Written by Levon Zakaryan (levon.zakaryan@gmail.com)*/\n\n  $.datepicker.regional['hy'] = {\n    closeText: 'Փակել',\n    prevText: '&#x3C;Նախ.',\n    nextText: 'Հաջ.&#x3E;',\n    currentText: 'Այսօր',\n    monthNames: ['Հունվար', 'Փետրվար', 'Մարտ', 'Ապրիլ', 'Մայիս', 'Հունիս', 'Հուլիս', 'Օգոստոս', 'Սեպտեմբեր', 'Հոկտեմբեր', 'Նոյեմբեր', 'Դեկտեմբեր'],\n    monthNamesShort: ['Հունվ', 'Փետր', 'Մարտ', 'Ապր', 'Մայիս', 'Հունիս', 'Հուլ', 'Օգս', 'Սեպ', 'Հոկ', 'Նոյ', 'Դեկ'],\n    dayNames: ['կիրակի', 'եկուշաբթի', 'երեքշաբթի', 'չորեքշաբթի', 'հինգշաբթի', 'ուրբաթ', 'շաբաթ'],\n    dayNamesShort: ['կիր', 'երկ', 'երք', 'չրք', 'հնգ', 'ուրբ', 'շբթ'],\n    dayNamesMin: ['կիր', 'երկ', 'երք', 'չրք', 'հնգ', 'ուրբ', 'շբթ'],\n    weekHeader: 'ՇԲՏ',\n    dateFormat: 'dd.mm.yy',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['hy']);\n\n  /* Written by Deden Fathurahman (dedenf@gmail.com). */\n\n  $.datepicker.regional['id'] = {\n    closeText: 'Tutup',\n    prevText: '&#x3C;mundur',\n    nextText: 'maju&#x3E;',\n    currentText: 'hari ini',\n    monthNames: ['Januari', 'Februari', 'Maret', 'April', 'Mei', 'Juni', 'Juli', 'Agustus', 'September', 'Oktober', 'Nopember', 'Desember'],\n    monthNamesShort: ['Jan', 'Feb', 'Mar', 'Apr', 'Mei', 'Jun', 'Jul', 'Agus', 'Sep', 'Okt', 'Nop', 'Des'],\n    dayNames: ['Minggu', 'Senin', 'Selasa', 'Rabu', 'Kamis', 'Jumat', 'Sabtu'],\n    dayNamesShort: ['Min', 'Sen', 'Sel', 'Rab', 'kam', 'Jum', 'Sab'],\n    dayNamesMin: ['Mg', 'Sn', 'Sl', 'Rb', 'Km', 'jm', 'Sb'],\n    weekHeader: 'Mg',\n    dateFormat: 'dd/mm/yy',\n    firstDay: 0,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['id']);\n\n  /* Written by Haukur H. Thorsson (haukur@eskill.is). */\n\n  $.datepicker.regional['is'] = {\n    closeText: 'Loka',\n    prevText: '&#x3C; Fyrri',\n    nextText: 'Næsti &#x3E;',\n    currentText: 'Í dag',\n    monthNames: ['Janúar', 'Febrúar', 'Mars', 'Apríl', 'Maí', 'Júní', 'Júlí', 'Ágúst', 'September', 'Október', 'Nóvember', 'Desember'],\n    monthNamesShort: ['Jan', 'Feb', 'Mar', 'Apr', 'Maí', 'Jún', 'Júl', 'Ágú', 'Sep', 'Okt', 'Nóv', 'Des'],\n    dayNames: ['Sunnudagur', 'Mánudagur', 'Þriðjudagur', 'Miðvikudagur', 'Fimmtudagur', 'Föstudagur', 'Laugardagur'],\n    dayNamesShort: ['Sun', 'Mán', 'Þri', 'Mið', 'Fim', 'Fös', 'Lau'],\n    dayNamesMin: ['Su', 'Má', 'Þr', 'Mi', 'Fi', 'Fö', 'La'],\n    weekHeader: 'Vika',\n    dateFormat: 'dd.mm.yy',\n    firstDay: 0,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['is']);\n\n  /* Written by Antonello Pasella (antonello.pasella@gmail.com). */\n\n  $.datepicker.regional['it'] = {\n    closeText: 'Chiudi',\n    prevText: '&#x3C;Prec',\n    nextText: 'Succ&#x3E;',\n    currentText: 'Oggi',\n    monthNames: ['Gennaio', 'Febbraio', 'Marzo', 'Aprile', 'Maggio', 'Giugno', 'Luglio', 'Agosto', 'Settembre', 'Ottobre', 'Novembre', 'Dicembre'],\n    monthNamesShort: ['Gen', 'Feb', 'Mar', 'Apr', 'Mag', 'Giu', 'Lug', 'Ago', 'Set', 'Ott', 'Nov', 'Dic'],\n    dayNames: ['Domenica', 'Lunedì', 'Martedì', 'Mercoledì', 'Giovedì', 'Venerdì', 'Sabato'],\n    dayNamesShort: ['Dom', 'Lun', 'Mar', 'Mer', 'Gio', 'Ven', 'Sab'],\n    dayNamesMin: ['Do', 'Lu', 'Ma', 'Me', 'Gi', 'Ve', 'Sa'],\n    weekHeader: 'Sm',\n    dateFormat: 'dd/mm/yy',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['it']);\n\n  /* Written by Kentaro SATO (kentaro@ranvis.com). */\n\n  $.datepicker.regional['ja'] = {\n    closeText: '閉じる',\n    prevText: '&#x3C;前',\n    nextText: '次&#x3E;',\n    currentText: '今日',\n    monthNames: ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月'],\n    monthNamesShort: ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月'],\n    dayNames: ['日曜日', '月曜日', '火曜日', '水曜日', '木曜日', '金曜日', '土曜日'],\n    dayNamesShort: ['日', '月', '火', '水', '木', '金', '土'],\n    dayNamesMin: ['日', '月', '火', '水', '木', '金', '土'],\n    weekHeader: '週',\n    dateFormat: 'yy/mm/dd',\n    firstDay: 0,\n    isRTL: false,\n    showMonthAfterYear: true,\n    yearSuffix: '年'\n  }; //$.datepicker.setDefaults($.datepicker.regional['ja']);\n\n  /* Written by Lado Lomidze (lado.lomidze@gmail.com). */\n\n  $.datepicker.regional['ka'] = {\n    closeText: 'დახურვა',\n    prevText: '&#x3c; წინა',\n    nextText: 'შემდეგი &#x3e;',\n    currentText: 'დღეს',\n    monthNames: ['იანვარი', 'თებერვალი', 'მარტი', 'აპრილი', 'მაისი', 'ივნისი', 'ივლისი', 'აგვისტო', 'სექტემბერი', 'ოქტომბერი', 'ნოემბერი', 'დეკემბერი'],\n    monthNamesShort: ['იან', 'თებ', 'მარ', 'აპრ', 'მაი', 'ივნ', 'ივლ', 'აგვ', 'სექ', 'ოქტ', 'ნოე', 'დეკ'],\n    dayNames: ['კვირა', 'ორშაბათი', 'სამშაბათი', 'ოთხშაბათი', 'ხუთშაბათი', 'პარასკევი', 'შაბათი'],\n    dayNamesShort: ['კვ', 'ორშ', 'სამ', 'ოთხ', 'ხუთ', 'პარ', 'შაბ'],\n    dayNamesMin: ['კვ', 'ორშ', 'სამ', 'ოთხ', 'ხუთ', 'პარ', 'შაბ'],\n    weekHeader: 'კვირა',\n    dateFormat: 'dd-mm-yy',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['ka']);\n\n  /* Written by Dmitriy Karasyov (dmitriy.karasyov@gmail.com). */\n\n  $.datepicker.regional['kk'] = {\n    closeText: 'Жабу',\n    prevText: '&#x3C;Алдыңғы',\n    nextText: 'Келесі&#x3E;',\n    currentText: 'Бүгін',\n    monthNames: ['Қаңтар', 'Ақпан', 'Наурыз', 'Сәуір', 'Мамыр', 'Маусым', 'Шілде', 'Тамыз', 'Қыркүйек', 'Қазан', 'Қараша', 'Желтоқсан'],\n    monthNamesShort: ['Қаң', 'Ақп', 'Нау', 'Сәу', 'Мам', 'Мау', 'Шіл', 'Там', 'Қыр', 'Қаз', 'Қар', 'Жел'],\n    dayNames: ['Жексенбі', 'Дүйсенбі', 'Сейсенбі', 'Сәрсенбі', 'Бейсенбі', 'Жұма', 'Сенбі'],\n    dayNamesShort: ['жкс', 'дсн', 'ссн', 'срс', 'бсн', 'жма', 'снб'],\n    dayNamesMin: ['Жк', 'Дс', 'Сс', 'Ср', 'Бс', 'Жм', 'Сн'],\n    weekHeader: 'Не',\n    dateFormat: 'dd.mm.yy',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['kk']);\n\n  /* Written by Chandara Om (chandara.teacher@gmail.com). */\n\n  $.datepicker.regional['km'] = {\n    closeText: 'ធ្វើ​រួច',\n    prevText: 'មុន',\n    nextText: 'បន្ទាប់',\n    currentText: 'ថ្ងៃ​នេះ',\n    monthNames: ['មករា', 'កុម្ភៈ', 'មីនា', 'មេសា', 'ឧសភា', 'មិថុនា', 'កក្កដា', 'សីហា', 'កញ្ញា', 'តុលា', 'វិច្ឆិកា', 'ធ្នូ'],\n    monthNamesShort: ['មករា', 'កុម្ភៈ', 'មីនា', 'មេសា', 'ឧសភា', 'មិថុនា', 'កក្កដា', 'សីហា', 'កញ្ញា', 'តុលា', 'វិច្ឆិកា', 'ធ្នូ'],\n    dayNames: ['អាទិត្យ', 'ចន្ទ', 'អង្គារ', 'ពុធ', 'ព្រហស្បតិ៍', 'សុក្រ', 'សៅរ៍'],\n    dayNamesShort: ['អា', 'ច', 'អ', 'ពុ', 'ព្រហ', 'សុ', 'សៅ'],\n    dayNamesMin: ['អា', 'ច', 'អ', 'ពុ', 'ព្រហ', 'សុ', 'សៅ'],\n    weekHeader: 'សប្ដាហ៍',\n    dateFormat: 'dd-mm-yy',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['km']);\n\n  /* Written by DaeKwon Kang (ncrash.dk@gmail.com), Edited by Genie. */\n\n  $.datepicker.regional['ko'] = {\n    closeText: '닫기',\n    prevText: '이전달',\n    nextText: '다음달',\n    currentText: '오늘',\n    monthNames: ['1월', '2월', '3월', '4월', '5월', '6월', '7월', '8월', '9월', '10월', '11월', '12월'],\n    monthNamesShort: ['1월', '2월', '3월', '4월', '5월', '6월', '7월', '8월', '9월', '10월', '11월', '12월'],\n    dayNames: ['일요일', '월요일', '화요일', '수요일', '목요일', '금요일', '토요일'],\n    dayNamesShort: ['일', '월', '화', '수', '목', '금', '토'],\n    dayNamesMin: ['일', '월', '화', '수', '목', '금', '토'],\n    weekHeader: 'Wk',\n    dateFormat: 'yy-mm-dd',\n    firstDay: 0,\n    isRTL: false,\n    showMonthAfterYear: true,\n    yearSuffix: '년'\n  }; //$.datepicker.setDefaults($.datepicker.regional['ko']);\n\n  /* Written by Michel Weimerskirch <michel@weimerskirch.net> */\n\n  $.datepicker.regional['lb'] = {\n    closeText: 'Fäerdeg',\n    prevText: 'Zréck',\n    nextText: 'Weider',\n    currentText: 'Haut',\n    monthNames: ['Januar', 'Februar', 'Mäerz', 'Abrëll', 'Mee', 'Juni', 'Juli', 'August', 'September', 'Oktober', 'November', 'Dezember'],\n    monthNamesShort: ['Jan', 'Feb', 'Mäe', 'Abr', 'Mee', 'Jun', 'Jul', 'Aug', 'Sep', 'Okt', 'Nov', 'Dez'],\n    dayNames: ['Sonndeg', 'Méindeg', 'Dënschdeg', 'Mëttwoch', 'Donneschdeg', 'Freideg', 'Samschdeg'],\n    dayNamesShort: ['Son', 'Méi', 'Dën', 'Mët', 'Don', 'Fre', 'Sam'],\n    dayNamesMin: ['So', 'Mé', 'Dë', 'Më', 'Do', 'Fr', 'Sa'],\n    weekHeader: 'W',\n    dateFormat: 'dd.mm.yy',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['lb']);\n\n  /* @author Arturas Paleicikas <arturas@avalon.lt> */\n\n  $.datepicker.regional['lt'] = {\n    closeText: 'Uždaryti',\n    prevText: '&#x3C;Atgal',\n    nextText: 'Pirmyn&#x3E;',\n    currentText: 'Šiandien',\n    monthNames: ['Sausis', 'Vasaris', 'Kovas', 'Balandis', 'Gegužė', 'Birželis', 'Liepa', 'Rugpjūtis', 'Rugsėjis', 'Spalis', 'Lapkritis', 'Gruodis'],\n    monthNamesShort: ['Sau', 'Vas', 'Kov', 'Bal', 'Geg', 'Bir', 'Lie', 'Rugp', 'Rugs', 'Spa', 'Lap', 'Gru'],\n    dayNames: ['sekmadienis', 'pirmadienis', 'antradienis', 'trečiadienis', 'ketvirtadienis', 'penktadienis', 'šeštadienis'],\n    dayNamesShort: ['sek', 'pir', 'ant', 'tre', 'ket', 'pen', 'šeš'],\n    dayNamesMin: ['Se', 'Pr', 'An', 'Tr', 'Ke', 'Pe', 'Še'],\n    weekHeader: 'SAV',\n    dateFormat: 'yy-mm-dd',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: true,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['lt']);\n\n  /* @author Arturas Paleicikas <arturas.paleicikas@metasite.net> */\n\n  $.datepicker.regional['lv'] = {\n    closeText: 'Aizvērt',\n    prevText: 'Iepr.',\n    nextText: 'Nāk.',\n    currentText: 'Šodien',\n    monthNames: ['Janvāris', 'Februāris', 'Marts', 'Aprīlis', 'Maijs', 'Jūnijs', 'Jūlijs', 'Augusts', 'Septembris', 'Oktobris', 'Novembris', 'Decembris'],\n    monthNamesShort: ['Jan', 'Feb', 'Mar', 'Apr', 'Mai', 'Jūn', 'Jūl', 'Aug', 'Sep', 'Okt', 'Nov', 'Dec'],\n    dayNames: ['svētdiena', 'pirmdiena', 'otrdiena', 'trešdiena', 'ceturtdiena', 'piektdiena', 'sestdiena'],\n    dayNamesShort: ['svt', 'prm', 'otr', 'tre', 'ctr', 'pkt', 'sst'],\n    dayNamesMin: ['Sv', 'Pr', 'Ot', 'Tr', 'Ct', 'Pk', 'Ss'],\n    weekHeader: 'Ned.',\n    dateFormat: 'dd.mm.yy',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['lv']);\n\n  /* Written by Stojce Slavkovski. */\n\n  $.datepicker.regional['mk'] = {\n    closeText: 'Затвори',\n    prevText: '&#x3C;',\n    nextText: '&#x3E;',\n    currentText: 'Денес',\n    monthNames: ['Јануари', 'Февруари', 'Март', 'Април', 'Мај', 'Јуни', 'Јули', 'Август', 'Септември', 'Октомври', 'Ноември', 'Декември'],\n    monthNamesShort: ['Јан', 'Фев', 'Мар', 'Апр', 'Мај', 'Јун', 'Јул', 'Авг', 'Сеп', 'Окт', 'Ное', 'Дек'],\n    dayNames: ['Недела', 'Понеделник', 'Вторник', 'Среда', 'Четврток', 'Петок', 'Сабота'],\n    dayNamesShort: ['Нед', 'Пон', 'Вто', 'Сре', 'Чет', 'Пет', 'Саб'],\n    dayNamesMin: ['Не', 'По', 'Вт', 'Ср', 'Че', 'Пе', 'Са'],\n    weekHeader: 'Сед',\n    dateFormat: 'dd.mm.yy',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['mk']);\n\n  /* Written by Saji Nediyanchath (saji89@gmail.com). */\n\n  $.datepicker.regional['ml'] = {\n    closeText: 'ശരി',\n    prevText: 'മുന്നത്തെ',\n    nextText: 'അടുത്തത് ',\n    currentText: 'ഇന്ന്',\n    monthNames: ['ജനുവരി', 'ഫെബ്രുവരി', 'മാര്‍ച്ച്', 'ഏപ്രില്‍', 'മേയ്', 'ജൂണ്‍', 'ജൂലൈ', 'ആഗസ്റ്റ്', 'സെപ്റ്റംബര്‍', 'ഒക്ടോബര്‍', 'നവംബര്‍', 'ഡിസംബര്‍'],\n    monthNamesShort: ['ജനു', 'ഫെബ്', 'മാര്‍', 'ഏപ്രി', 'മേയ്', 'ജൂണ്‍', 'ജൂലാ', 'ആഗ', 'സെപ്', 'ഒക്ടോ', 'നവം', 'ഡിസ'],\n    dayNames: ['ഞായര്‍', 'തിങ്കള്‍', 'ചൊവ്വ', 'ബുധന്‍', 'വ്യാഴം', 'വെള്ളി', 'ശനി'],\n    dayNamesShort: ['ഞായ', 'തിങ്ക', 'ചൊവ്വ', 'ബുധ', 'വ്യാഴം', 'വെള്ളി', 'ശനി'],\n    dayNamesMin: ['ഞാ', 'തി', 'ചൊ', 'ബു', 'വ്യാ', 'വെ', 'ശ'],\n    weekHeader: 'ആ',\n    dateFormat: 'dd/mm/yy',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['ml']);\n\n  /* Written by Mohd Nawawi Mohamad Jamili (nawawi@ronggeng.net). */\n\n  $.datepicker.regional['ms'] = {\n    closeText: 'Tutup',\n    prevText: '&#x3C;Sebelum',\n    nextText: 'Selepas&#x3E;',\n    currentText: 'hari ini',\n    monthNames: ['Januari', 'Februari', 'Mac', 'April', 'Mei', 'Jun', 'Julai', 'Ogos', 'September', 'Oktober', 'November', 'Disember'],\n    monthNamesShort: ['Jan', 'Feb', 'Mac', 'Apr', 'Mei', 'Jun', 'Jul', 'Ogo', 'Sep', 'Okt', 'Nov', 'Dis'],\n    dayNames: ['Ahad', 'Isnin', 'Selasa', 'Rabu', 'Khamis', 'Jumaat', 'Sabtu'],\n    dayNamesShort: ['Aha', 'Isn', 'Sel', 'Rab', 'kha', 'Jum', 'Sab'],\n    dayNamesMin: ['Ah', 'Is', 'Se', 'Ra', 'Kh', 'Ju', 'Sa'],\n    weekHeader: 'Mg',\n    dateFormat: 'dd/mm/yy',\n    firstDay: 0,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['ms']);\n\n  /* David De Sloovere @DavidDeSloovere */\n\n  $.datepicker.regional['nl-BE'] = {\n    closeText: 'Sluiten',\n    prevText: '←',\n    nextText: '→',\n    currentText: 'Vandaag',\n    monthNames: ['januari', 'februari', 'maart', 'april', 'mei', 'juni', 'juli', 'augustus', 'september', 'oktober', 'november', 'december'],\n    monthNamesShort: ['jan', 'feb', 'mrt', 'apr', 'mei', 'jun', 'jul', 'aug', 'sep', 'okt', 'nov', 'dec'],\n    dayNames: ['zondag', 'maandag', 'dinsdag', 'woensdag', 'donderdag', 'vrijdag', 'zaterdag'],\n    dayNamesShort: ['zon', 'maa', 'din', 'woe', 'don', 'vri', 'zat'],\n    dayNamesMin: ['zo', 'ma', 'di', 'wo', 'do', 'vr', 'za'],\n    weekHeader: 'Wk',\n    dateFormat: 'dd/mm/yy',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['nl-BE']);\n\n  /* Written by Mathias Bynens <http://mathiasbynens.be/> */\n\n  $.datepicker.regional.nl = {\n    closeText: 'Sluiten',\n    prevText: '←',\n    nextText: '→',\n    currentText: 'Vandaag',\n    monthNames: ['januari', 'februari', 'maart', 'april', 'mei', 'juni', 'juli', 'augustus', 'september', 'oktober', 'november', 'december'],\n    monthNamesShort: ['jan', 'feb', 'mrt', 'apr', 'mei', 'jun', 'jul', 'aug', 'sep', 'okt', 'nov', 'dec'],\n    dayNames: ['zondag', 'maandag', 'dinsdag', 'woensdag', 'donderdag', 'vrijdag', 'zaterdag'],\n    dayNamesShort: ['zon', 'maa', 'din', 'woe', 'don', 'vri', 'zat'],\n    dayNamesMin: ['zo', 'ma', 'di', 'wo', 'do', 'vr', 'za'],\n    weekHeader: 'Wk',\n    dateFormat: 'dd-mm-yy',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional.nl);\n\n  /* Written by Naimdjon Takhirov (naimdjon@gmail.com). */\n\n  $.datepicker.regional['no'] = {\n    closeText: 'Lukk',\n    prevText: '&#xAB;Forrige',\n    nextText: 'Neste&#xBB;',\n    currentText: 'I dag',\n    monthNames: ['januar', 'februar', 'mars', 'april', 'mai', 'juni', 'juli', 'august', 'september', 'oktober', 'november', 'desember'],\n    monthNamesShort: ['jan', 'feb', 'mar', 'apr', 'mai', 'jun', 'jul', 'aug', 'sep', 'okt', 'nov', 'des'],\n    dayNamesShort: ['søn', 'man', 'tir', 'ons', 'tor', 'fre', 'lør'],\n    dayNames: ['søndag', 'mandag', 'tirsdag', 'onsdag', 'torsdag', 'fredag', 'lørdag'],\n    dayNamesMin: ['sø', 'ma', 'ti', 'on', 'to', 'fr', 'lø'],\n    weekHeader: 'Uke',\n    dateFormat: 'dd.mm.yy',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['no']);\n\n  /* Written by Jacek Wysocki (jacek.wysocki@gmail.com). */\n\n  $.datepicker.regional['pl'] = {\n    closeText: 'Zamknij',\n    prevText: '&#x3C;Poprzedni',\n    nextText: 'Następny&#x3E;',\n    currentText: 'Dziś',\n    monthNames: ['Styczeń', 'Luty', 'Marzec', 'Kwiecień', 'Maj', 'Czerwiec', 'Lipiec', 'Sierpień', 'Wrzesień', 'Październik', 'Listopad', 'Grudzień'],\n    monthNamesShort: ['Sty', 'Lu', 'Mar', 'Kw', 'Maj', 'Cze', 'Lip', 'Sie', 'Wrz', 'Pa', 'Lis', 'Gru'],\n    dayNames: ['Niedziela', 'Poniedziałek', 'Wtorek', 'Środa', 'Czwartek', 'Piątek', 'Sobota'],\n    dayNamesShort: ['Nie', 'Pn', 'Wt', 'Śr', 'Czw', 'Pt', 'So'],\n    dayNamesMin: ['N', 'Pn', 'Wt', 'Śr', 'Cz', 'Pt', 'So'],\n    weekHeader: 'Tydz',\n    dateFormat: 'dd.mm.yy',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['pl']);\n\n  /* Written by Leonildo Costa Silva (leocsilva@gmail.com). */\n\n  $.datepicker.regional['pt-BR'] = {\n    closeText: 'Fechar',\n    prevText: '&#x3C;Anterior',\n    nextText: 'Próximo&#x3E;',\n    currentText: 'Hoje',\n    monthNames: ['Janeiro', 'Fevereiro', 'Março', 'Abril', 'Maio', 'Junho', 'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'],\n    monthNamesShort: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov', 'Dez'],\n    dayNames: ['Domingo', 'Segunda-feira', 'Terça-feira', 'Quarta-feira', 'Quinta-feira', 'Sexta-feira', 'Sábado'],\n    dayNamesShort: ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb'],\n    dayNamesMin: ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb'],\n    weekHeader: 'Sm',\n    dateFormat: 'dd/mm/yy',\n    firstDay: 0,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['pt-BR']);\n\n  $.datepicker.regional['pt'] = {\n    closeText: 'Fechar',\n    prevText: 'Anterior',\n    nextText: 'Seguinte',\n    currentText: 'Hoje',\n    monthNames: ['Janeiro', 'Fevereiro', 'Março', 'Abril', 'Maio', 'Junho', 'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'],\n    monthNamesShort: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov', 'Dez'],\n    dayNames: ['Domingo', 'Segunda-feira', 'Terça-feira', 'Quarta-feira', 'Quinta-feira', 'Sexta-feira', 'Sábado'],\n    dayNamesShort: ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb'],\n    dayNamesMin: ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb'],\n    weekHeader: 'Sem',\n    dateFormat: 'dd/mm/yy',\n    firstDay: 0,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['pt']);\n\n  /* Written by Yvonne Gienal (yvonne.gienal@educa.ch). */\n\n  $.datepicker.regional['rm'] = {\n    closeText: 'Serrar',\n    prevText: '&#x3C;Suandant',\n    nextText: 'Precedent&#x3E;',\n    currentText: 'Actual',\n    monthNames: ['Schaner', 'Favrer', 'Mars', 'Avrigl', 'Matg', 'Zercladur', 'Fanadur', 'Avust', 'Settember', 'October', 'November', 'December'],\n    monthNamesShort: ['Scha', 'Fev', 'Mar', 'Avr', 'Matg', 'Zer', 'Fan', 'Avu', 'Sett', 'Oct', 'Nov', 'Dec'],\n    dayNames: ['Dumengia', 'Glindesdi', 'Mardi', 'Mesemna', 'Gievgia', 'Venderdi', 'Sonda'],\n    dayNamesShort: ['Dum', 'Gli', 'Mar', 'Mes', 'Gie', 'Ven', 'Som'],\n    dayNamesMin: ['Du', 'Gl', 'Ma', 'Me', 'Gi', 'Ve', 'So'],\n    weekHeader: 'emna',\n    dateFormat: 'dd/mm/yy',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['rm']);\n\n  $.datepicker.regional['ro'] = {\n    closeText: 'Închide',\n    prevText: '&#xAB; Luna precedentă',\n    nextText: 'Luna următoare &#xBB;',\n    currentText: 'Azi',\n    monthNames: ['Ianuarie', 'Februarie', 'Martie', 'Aprilie', 'Mai', 'Iunie', 'Iulie', 'August', 'Septembrie', 'Octombrie', 'Noiembrie', 'Decembrie'],\n    monthNamesShort: ['Ian', 'Feb', 'Mar', 'Apr', 'Mai', 'Iun', 'Iul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],\n    dayNames: ['Duminică', 'Luni', 'Marţi', 'Miercuri', 'Joi', 'Vineri', 'Sâmbătă'],\n    dayNamesShort: ['Dum', 'Lun', 'Mar', 'Mie', 'Joi', 'Vin', 'Sâm'],\n    dayNamesMin: ['Du', 'Lu', 'Ma', 'Mi', 'Jo', 'Vi', 'Sâ'],\n    weekHeader: 'Săpt',\n    dateFormat: 'dd.mm.yy',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['ro']);\n\n  /* Written by Andrew Stromnov (stromnov@gmail.com). */\n\n  $.datepicker.regional['ru'] = {\n    closeText: 'Закрыть',\n    prevText: '&#x3C;Пред',\n    nextText: 'След&#x3E;',\n    currentText: 'Сегодня',\n    monthNames: ['Январь', 'Февраль', 'Март', 'Апрель', 'Май', 'Июнь', 'Июль', 'Август', 'Сентябрь', 'Октябрь', 'Ноябрь', 'Декабрь'],\n    monthNamesShort: ['Янв', 'Фев', 'Мар', 'Апр', 'Май', 'Июн', 'Июл', 'Авг', 'Сен', 'Окт', 'Ноя', 'Дек'],\n    dayNames: ['воскресенье', 'понедельник', 'вторник', 'среда', 'четверг', 'пятница', 'суббота'],\n    dayNamesShort: ['вск', 'пнд', 'втр', 'срд', 'чтв', 'птн', 'сбт'],\n    dayNamesMin: ['Вс', 'Пн', 'Вт', 'Ср', 'Чт', 'Пт', 'Сб'],\n    weekHeader: 'Нед',\n    dateFormat: 'dd.mm.yy',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['ru']);\n\n  /* Written by Vojtech Rinik (vojto@hmm.sk). */\n\n  $.datepicker.regional['sk'] = {\n    closeText: 'Zavrieť',\n    prevText: '&#x3C;Predchádzajúci',\n    nextText: 'Nasledujúci&#x3E;',\n    currentText: 'Dnes',\n    monthNames: ['január', 'február', 'marec', 'apríl', 'máj', 'jún', 'júl', 'august', 'september', 'október', 'november', 'december'],\n    monthNamesShort: ['Jan', 'Feb', 'Mar', 'Apr', 'Máj', 'Jún', 'Júl', 'Aug', 'Sep', 'Okt', 'Nov', 'Dec'],\n    dayNames: ['nedeľa', 'pondelok', 'utorok', 'streda', 'štvrtok', 'piatok', 'sobota'],\n    dayNamesShort: ['Ned', 'Pon', 'Uto', 'Str', 'Štv', 'Pia', 'Sob'],\n    dayNamesMin: ['Ne', 'Po', 'Ut', 'St', 'Št', 'Pia', 'So'],\n    weekHeader: 'Ty',\n    dateFormat: 'dd.mm.yy',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['sk']);\n\n  /* Written by Jaka Jancar (jaka@kubje.org). */\n\n  /* c = č, s = š z = ž C = Č S = Š Z = Ž */\n\n  $.datepicker.regional['sl'] = {\n    closeText: 'Zapri',\n    prevText: '&#x3C;Prejšnji',\n    nextText: 'Naslednji&#x3E;',\n    currentText: 'Trenutni',\n    monthNames: ['Januar', 'Februar', 'Marec', 'April', 'Maj', 'Junij', 'Julij', 'Avgust', 'September', 'Oktober', 'November', 'December'],\n    monthNamesShort: ['Jan', 'Feb', 'Mar', 'Apr', 'Maj', 'Jun', 'Jul', 'Avg', 'Sep', 'Okt', 'Nov', 'Dec'],\n    dayNames: ['Nedelja', 'Ponedeljek', 'Torek', 'Sreda', 'Četrtek', 'Petek', 'Sobota'],\n    dayNamesShort: ['Ned', 'Pon', 'Tor', 'Sre', 'Čet', 'Pet', 'Sob'],\n    dayNamesMin: ['Ne', 'Po', 'To', 'Sr', 'Če', 'Pe', 'So'],\n    weekHeader: 'Teden',\n    dateFormat: 'dd.mm.yy',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['sl']);\n\n  /* Written by Flakron Bytyqi (flakron@gmail.com). */\n\n  $.datepicker.regional['sq'] = {\n    closeText: 'mbylle',\n    prevText: '&#x3C;mbrapa',\n    nextText: 'Përpara&#x3E;',\n    currentText: 'sot',\n    monthNames: ['Janar', 'Shkurt', 'Mars', 'Prill', 'Maj', 'Qershor', 'Korrik', 'Gusht', 'Shtator', 'Tetor', 'Nëntor', 'Dhjetor'],\n    monthNamesShort: ['Jan', 'Shk', 'Mar', 'Pri', 'Maj', 'Qer', 'Kor', 'Gus', 'Sht', 'Tet', 'Nën', 'Dhj'],\n    dayNames: ['E Diel', 'E Hënë', 'E Martë', 'E Mërkurë', 'E Enjte', 'E Premte', 'E Shtune'],\n    dayNamesShort: ['Di', 'Hë', 'Ma', 'Më', 'En', 'Pr', 'Sh'],\n    dayNamesMin: ['Di', 'Hë', 'Ma', 'Më', 'En', 'Pr', 'Sh'],\n    weekHeader: 'Ja',\n    dateFormat: 'dd.mm.yy',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['sq']);\n\n  /* Written by Dejan Dimić. */\n\n  $.datepicker.regional['sr-SR'] = {\n    closeText: 'Zatvori',\n    prevText: '&#x3C;',\n    nextText: '&#x3E;',\n    currentText: 'Danas',\n    monthNames: ['Januar', 'Februar', 'Mart', 'April', 'Maj', 'Jun', 'Jul', 'Avgust', 'Septembar', 'Oktobar', 'Novembar', 'Decembar'],\n    monthNamesShort: ['Jan', 'Feb', 'Mar', 'Apr', 'Maj', 'Jun', 'Jul', 'Avg', 'Sep', 'Okt', 'Nov', 'Dec'],\n    dayNames: ['Nedelja', 'Ponedeljak', 'Utorak', 'Sreda', 'Četvrtak', 'Petak', 'Subota'],\n    dayNamesShort: ['Ned', 'Pon', 'Uto', 'Sre', 'Čet', 'Pet', 'Sub'],\n    dayNamesMin: ['Ne', 'Po', 'Ut', 'Sr', 'Če', 'Pe', 'Su'],\n    weekHeader: 'Sed',\n    dateFormat: 'dd.mm.yy',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['sr-SR']);\n\n  /* Written by Dejan Dimić. */\n\n  $.datepicker.regional['sr'] = {\n    closeText: 'Затвори',\n    prevText: '&#x3C;',\n    nextText: '&#x3E;',\n    currentText: 'Данас',\n    monthNames: ['Јануар', 'Фебруар', 'Март', 'Април', 'Мај', 'Јун', 'Јул', 'Август', 'Септембар', 'Октобар', 'Новембар', 'Децембар'],\n    monthNamesShort: ['Јан', 'Феб', 'Мар', 'Апр', 'Мај', 'Јун', 'Јул', 'Авг', 'Сеп', 'Окт', 'Нов', 'Дец'],\n    dayNames: ['Недеља', 'Понедељак', 'Уторак', 'Среда', 'Четвртак', 'Петак', 'Субота'],\n    dayNamesShort: ['Нед', 'Пон', 'Уто', 'Сре', 'Чет', 'Пет', 'Суб'],\n    dayNamesMin: ['Не', 'По', 'Ут', 'Ср', 'Че', 'Пе', 'Су'],\n    weekHeader: 'Сед',\n    dateFormat: 'dd.mm.yy',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['sr']);\n\n  /* Written by Anders Ekdahl ( anders@nomadiz.se). */\n\n  $.datepicker.regional['sv'] = {\n    closeText: 'Stäng',\n    prevText: '&#xAB;Förra',\n    nextText: 'Nästa&#xBB;',\n    currentText: 'Idag',\n    monthNames: ['Januari', 'Februari', 'Mars', 'April', 'Maj', 'Juni', 'Juli', 'Augusti', 'September', 'Oktober', 'November', 'December'],\n    monthNamesShort: ['Jan', 'Feb', 'Mar', 'Apr', 'Maj', 'Jun', 'Jul', 'Aug', 'Sep', 'Okt', 'Nov', 'Dec'],\n    dayNamesShort: ['Sön', 'Mån', 'Tis', 'Ons', 'Tor', 'Fre', 'Lör'],\n    dayNames: ['Söndag', 'Måndag', 'Tisdag', 'Onsdag', 'Torsdag', 'Fredag', 'Lördag'],\n    dayNamesMin: ['Sö', 'Må', 'Ti', 'On', 'To', 'Fr', 'Lö'],\n    weekHeader: 'Ve',\n    dateFormat: 'yy-mm-dd',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['sv']);\n\n  /* Written by S A Sureshkumar (saskumar@live.com). */\n\n  $.datepicker.regional['ta'] = {\n    closeText: 'மூடு',\n    prevText: 'முன்னையது',\n    nextText: 'அடுத்தது',\n    currentText: 'இன்று',\n    monthNames: ['தை', 'மாசி', 'பங்குனி', 'சித்திரை', 'வைகாசி', 'ஆனி', 'ஆடி', 'ஆவணி', 'புரட்டாசி', 'ஐப்பசி', 'கார்த்திகை', 'மார்கழி'],\n    monthNamesShort: ['தை', 'மாசி', 'பங்', 'சித்', 'வைகா', 'ஆனி', 'ஆடி', 'ஆவ', 'புர', 'ஐப்', 'கார்', 'மார்'],\n    dayNames: ['ஞாயிற்றுக்கிழமை', 'திங்கட்கிழமை', 'செவ்வாய்க்கிழமை', 'புதன்கிழமை', 'வியாழக்கிழமை', 'வெள்ளிக்கிழமை', 'சனிக்கிழமை'],\n    dayNamesShort: ['ஞாயிறு', 'திங்கள்', 'செவ்வாய்', 'புதன்', 'வியாழன்', 'வெள்ளி', 'சனி'],\n    dayNamesMin: ['ஞா', 'தி', 'செ', 'பு', 'வி', 'வெ', 'ச'],\n    weekHeader: 'Не',\n    dateFormat: 'dd/mm/yy',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['ta']);\n\n  /* Written by pipo (pipo@sixhead.com). */\n\n  $.datepicker.regional['th'] = {\n    closeText: 'ปิด',\n    prevText: '&#xAB;&#xA0;ย้อน',\n    nextText: 'ถัดไป&#xA0;&#xBB;',\n    currentText: 'วันนี้',\n    monthNames: ['มกราคม', 'กุมภาพันธ์', 'มีนาคม', 'เมษายน', 'พฤษภาคม', 'มิถุนายน', 'กรกฎาคม', 'สิงหาคม', 'กันยายน', 'ตุลาคม', 'พฤศจิกายน', 'ธันวาคม'],\n    monthNamesShort: ['ม.ค.', 'ก.พ.', 'มี.ค.', 'เม.ย.', 'พ.ค.', 'มิ.ย.', 'ก.ค.', 'ส.ค.', 'ก.ย.', 'ต.ค.', 'พ.ย.', 'ธ.ค.'],\n    dayNames: ['อาทิตย์', 'จันทร์', 'อังคาร', 'พุธ', 'พฤหัสบดี', 'ศุกร์', 'เสาร์'],\n    dayNamesShort: ['อา.', 'จ.', 'อ.', 'พ.', 'พฤ.', 'ศ.', 'ส.'],\n    dayNamesMin: ['อา.', 'จ.', 'อ.', 'พ.', 'พฤ.', 'ศ.', 'ส.'],\n    weekHeader: 'Wk',\n    dateFormat: 'dd/mm/yy',\n    firstDay: 0,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['th']);\n\n  /* Written by Abdurahmon Saidov (saidovab@gmail.com). */\n\n  $.datepicker.regional['tj'] = {\n    closeText: 'Идома',\n    prevText: '&#x3c;Қафо',\n    nextText: 'Пеш&#x3e;',\n    currentText: 'Имрӯз',\n    monthNames: ['Январ', 'Феврал', 'Март', 'Апрел', 'Май', 'Июн', 'Июл', 'Август', 'Сентябр', 'Октябр', 'Ноябр', 'Декабр'],\n    monthNamesShort: ['Янв', 'Фев', 'Мар', 'Апр', 'Май', 'Июн', 'Июл', 'Авг', 'Сен', 'Окт', 'Ноя', 'Дек'],\n    dayNames: ['якшанбе', 'душанбе', 'сешанбе', 'чоршанбе', 'панҷшанбе', 'ҷумъа', 'шанбе'],\n    dayNamesShort: ['якш', 'душ', 'сеш', 'чор', 'пан', 'ҷум', 'шан'],\n    dayNamesMin: ['Як', 'Дш', 'Сш', 'Чш', 'Пш', 'Ҷм', 'Шн'],\n    weekHeader: 'Хф',\n    dateFormat: 'dd.mm.yy',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['tj']);\n\n  /* Written by Izzet Emre Erkan (kara@karalamalar.net). */\n\n  $.datepicker.regional['tr'] = {\n    closeText: 'kapat',\n    prevText: '&#x3C;geri',\n    nextText: 'ileri&#x3e',\n    currentText: 'bugün',\n    monthNames: ['Ocak', 'Şubat', 'Mart', 'Nisan', 'Mayıs', 'Haziran', 'Temmuz', 'Ağustos', 'Eylül', 'Ekim', 'Kasım', 'Aralık'],\n    monthNamesShort: ['Oca', 'Şub', 'Mar', 'Nis', 'May', 'Haz', 'Tem', 'Ağu', 'Eyl', 'Eki', 'Kas', 'Ara'],\n    dayNames: ['Pazar', 'Pazartesi', 'Salı', 'Çarşamba', 'Perşembe', 'Cuma', 'Cumartesi'],\n    dayNamesShort: ['Pz', 'Pt', 'Sa', 'Ça', 'Pe', 'Cu', 'Ct'],\n    dayNamesMin: ['Pz', 'Pt', 'Sa', 'Ça', 'Pe', 'Cu', 'Ct'],\n    weekHeader: 'Hf',\n    dateFormat: 'dd.mm.yy',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['tr']);\n\n  /* Written by Maxim Drogobitskiy (maxdao@gmail.com). */\n\n  /* Corrected by Igor Milla (igor.fsp.milla@gmail.com). */\n\n  $.datepicker.regional['uk'] = {\n    closeText: 'Закрити',\n    prevText: '&#x3C;',\n    nextText: '&#x3E;',\n    currentText: 'Сьогодні',\n    monthNames: ['Січень', 'Лютий', 'Березень', 'Квітень', 'Травень', 'Червень', 'Липень', 'Серпень', 'Вересень', 'Жовтень', 'Листопад', 'Грудень'],\n    monthNamesShort: ['Січ', 'Лют', 'Бер', 'Кві', 'Тра', 'Чер', 'Лип', 'Сер', 'Вер', 'Жов', 'Лис', 'Гру'],\n    dayNames: ['неділя', 'понеділок', 'вівторок', 'середа', 'четвер', 'п’ятниця', 'субота'],\n    dayNamesShort: ['нед', 'пнд', 'вів', 'срд', 'чтв', 'птн', 'сбт'],\n    dayNamesMin: ['Нд', 'Пн', 'Вт', 'Ср', 'Чт', 'Пт', 'Сб'],\n    weekHeader: 'Тиж',\n    dateFormat: 'dd/mm/yy',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['uk']);\n\n  /* Translated by Le Thanh Huy (lthanhhuy@cit.ctu.edu.vn). */\n\n  $.datepicker.regional['vi'] = {\n    closeText: 'Đóng',\n    prevText: '&#x3C;Trước',\n    nextText: 'Tiếp&#x3E;',\n    currentText: 'Hôm nay',\n    monthNames: ['Tháng Một', 'Tháng Hai', 'Tháng Ba', 'Tháng Tư', 'Tháng Năm', 'Tháng Sáu', 'Tháng Bảy', 'Tháng Tám', 'Tháng Chín', 'Tháng Mười', 'Tháng Mười Một', 'Tháng Mười Hai'],\n    monthNamesShort: ['Tháng 1', 'Tháng 2', 'Tháng 3', 'Tháng 4', 'Tháng 5', 'Tháng 6', 'Tháng 7', 'Tháng 8', 'Tháng 9', 'Tháng 10', 'Tháng 11', 'Tháng 12'],\n    dayNames: ['Chủ Nhật', 'Thứ Hai', 'Thứ Ba', 'Thứ Tư', 'Thứ Năm', 'Thứ Sáu', 'Thứ Bảy'],\n    dayNamesShort: ['CN', 'T2', 'T3', 'T4', 'T5', 'T6', 'T7'],\n    dayNamesMin: ['CN', 'T2', 'T3', 'T4', 'T5', 'T6', 'T7'],\n    weekHeader: 'Tu',\n    dateFormat: 'dd/mm/yy',\n    firstDay: 0,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['vi']);\n\n  /* Written by Cloudream (cloudream@gmail.com). */\n\n  $.datepicker.regional['zh-CN'] = {\n    closeText: '关闭',\n    prevText: '&#x3C;上月',\n    nextText: '下月&#x3E;',\n    currentText: '今天',\n    monthNames: ['一月', '二月', '三月', '四月', '五月', '六月', '七月', '八月', '九月', '十月', '十一月', '十二月'],\n    monthNamesShort: ['一月', '二月', '三月', '四月', '五月', '六月', '七月', '八月', '九月', '十月', '十一月', '十二月'],\n    dayNames: ['星期日', '星期一', '星期二', '星期三', '星期四', '星期五', '星期六'],\n    dayNamesShort: ['周日', '周一', '周二', '周三', '周四', '周五', '周六'],\n    dayNamesMin: ['日', '一', '二', '三', '四', '五', '六'],\n    weekHeader: '周',\n    dateFormat: 'yy-mm-dd',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: true,\n    yearSuffix: '年'\n  }; //$.datepicker.setDefaults($.datepicker.regional['zh-CN']);\n\n  /* Written by SCCY (samuelcychan@gmail.com). */\n\n  $.datepicker.regional['zh-HK'] = {\n    closeText: '關閉',\n    prevText: '&#x3C;上月',\n    nextText: '下月&#x3E;',\n    currentText: '今天',\n    monthNames: ['一月', '二月', '三月', '四月', '五月', '六月', '七月', '八月', '九月', '十月', '十一月', '十二月'],\n    monthNamesShort: ['一月', '二月', '三月', '四月', '五月', '六月', '七月', '八月', '九月', '十月', '十一月', '十二月'],\n    dayNames: ['星期日', '星期一', '星期二', '星期三', '星期四', '星期五', '星期六'],\n    dayNamesShort: ['周日', '周一', '周二', '周三', '周四', '周五', '周六'],\n    dayNamesMin: ['日', '一', '二', '三', '四', '五', '六'],\n    weekHeader: '周',\n    dateFormat: 'dd-mm-yy',\n    firstDay: 0,\n    isRTL: false,\n    showMonthAfterYear: true,\n    yearSuffix: '年'\n  }; //$.datepicker.setDefaults($.datepicker.regional['zh-HK']);\n\n  /* Written by Ressol (ressol@gmail.com). */\n\n  $.datepicker.regional['zh-TW'] = {\n    closeText: '關閉',\n    prevText: '&#x3C;上月',\n    nextText: '下月&#x3E;',\n    currentText: '今天',\n    monthNames: ['一月', '二月', '三月', '四月', '五月', '六月', '七月', '八月', '九月', '十月', '十一月', '十二月'],\n    monthNamesShort: ['一月', '二月', '三月', '四月', '五月', '六月', '七月', '八月', '九月', '十月', '十一月', '十二月'],\n    dayNames: ['星期日', '星期一', '星期二', '星期三', '星期四', '星期五', '星期六'],\n    dayNamesShort: ['周日', '周一', '周二', '周三', '周四', '周五', '周六'],\n    dayNamesMin: ['日', '一', '二', '三', '四', '五', '六'],\n    weekHeader: '周',\n    dateFormat: 'yy/mm/dd',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: true,\n    yearSuffix: '年'\n  }; //$.datepicker.setDefaults($.datepicker.regional['zh-TW']);\n\n  /* Written by Pavel Selitskas <p.selitskas@gmail.com> */\n\n  $.datepicker.regional['be'] = {\n    closeText: 'Зачыніць',\n    prevText: '&larr;Папяр.',\n    nextText: 'Наст.&rarr;',\n    currentText: 'Сёньня',\n    monthNames: ['Студзень', 'Люты', 'Сакавік', 'Красавік', 'Травень', 'Чэрвень', 'Ліпень', 'Жнівень', 'Верасень', 'Кастрычнік', 'Лістапад', 'Сьнежань'],\n    monthNamesShort: ['Сту', 'Лют', 'Сак', 'Кра', 'Тра', 'Чэр', 'Ліп', 'Жні', 'Вер', 'Кас', 'Ліс', 'Сьн'],\n    dayNames: ['нядзеля', 'панядзелак', 'аўторак', 'серада', 'чацьвер', 'пятніца', 'субота'],\n    dayNamesShort: ['ндз', 'пнд', 'аўт', 'срд', 'чцв', 'птн', 'сбт'],\n    dayNamesMin: ['Нд', 'Пн', 'Аў', 'Ср', 'Чц', 'Пт', 'Сб'],\n    weekHeader: 'Тд',\n    dateFormat: 'dd.mm.yy',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['be']);\n\n  $.datepicker.regional['fr-CA'] = {\n    closeText: 'Fermer',\n    prevText: 'Précédent',\n    nextText: 'Suivant',\n    currentText: 'Aujourd\\'hui',\n    monthNames: ['janvier', 'février', 'mars', 'avril', 'mai', 'juin', 'juillet', 'août', 'septembre', 'octobre', 'novembre', 'décembre'],\n    monthNamesShort: ['janv.', 'févr.', 'mars', 'avril', 'mai', 'juin', 'juil.', 'août', 'sept.', 'oct.', 'nov.', 'déc.'],\n    dayNames: ['dimanche', 'lundi', 'mardi', 'mercredi', 'jeudi', 'vendredi', 'samedi'],\n    dayNamesShort: ['dim.', 'lun.', 'mar.', 'mer.', 'jeu.', 'ven.', 'sam.'],\n    dayNamesMin: ['D', 'L', 'M', 'M', 'J', 'V', 'S'],\n    weekHeader: 'Sem.',\n    dateFormat: 'yy-mm-dd',\n    firstDay: 0,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['fr-CA']);\n\n  /* Written by Sergey Kartashov (ebishkek@yandex.ru). */\n\n  $.datepicker.regional['ky'] = {\n    closeText: 'Жабуу',\n    prevText: '&#x3c;Мур',\n    nextText: 'Кий&#x3e;',\n    currentText: 'Бүгүн',\n    monthNames: ['Январь', 'Февраль', 'Март', 'Апрель', 'Май', 'Июнь', 'Июль', 'Август', 'Сентябрь', 'Октябрь', 'Ноябрь', 'Декабрь'],\n    monthNamesShort: ['Янв', 'Фев', 'Мар', 'Апр', 'Май', 'Июн', 'Июл', 'Авг', 'Сен', 'Окт', 'Ноя', 'Дек'],\n    dayNames: ['жекшемби', 'дүйшөмбү', 'шейшемби', 'шаршемби', 'бейшемби', 'жума', 'ишемби'],\n    dayNamesShort: ['жек', 'дүй', 'шей', 'шар', 'бей', 'жум', 'ише'],\n    dayNamesMin: ['Жк', 'Дш', 'Шш', 'Шр', 'Бш', 'Жм', 'Иш'],\n    weekHeader: 'Жум',\n    dateFormat: 'dd.mm.yy',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['ky']);\n\n  /* Written by Bjørn Johansen (post@bjornjohansen.no). */\n\n  $.datepicker.regional['nb'] = {\n    closeText: 'Lukk',\n    prevText: '&#xAB;Forrige',\n    nextText: 'Neste&#xBB;',\n    currentText: 'I dag',\n    monthNames: ['januar', 'februar', 'mars', 'april', 'mai', 'juni', 'juli', 'august', 'september', 'oktober', 'november', 'desember'],\n    monthNamesShort: ['jan', 'feb', 'mar', 'apr', 'mai', 'jun', 'jul', 'aug', 'sep', 'okt', 'nov', 'des'],\n    dayNamesShort: ['søn', 'man', 'tir', 'ons', 'tor', 'fre', 'lør'],\n    dayNames: ['søndag', 'mandag', 'tirsdag', 'onsdag', 'torsdag', 'fredag', 'lørdag'],\n    dayNamesMin: ['sø', 'ma', 'ti', 'on', 'to', 'fr', 'lø'],\n    weekHeader: 'Uke',\n    dateFormat: 'dd.mm.yy',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['nb']);\n\n  /* Written by Bjørn Johansen (post@bjornjohansen.no). */\n\n  $.datepicker.regional['nn'] = {\n    closeText: 'Lukk',\n    prevText: '&#xAB;Førre',\n    nextText: 'Neste&#xBB;',\n    currentText: 'I dag',\n    monthNames: ['januar', 'februar', 'mars', 'april', 'mai', 'juni', 'juli', 'august', 'september', 'oktober', 'november', 'desember'],\n    monthNamesShort: ['jan', 'feb', 'mar', 'apr', 'mai', 'jun', 'jul', 'aug', 'sep', 'okt', 'nov', 'des'],\n    dayNamesShort: ['sun', 'mån', 'tys', 'ons', 'tor', 'fre', 'lau'],\n    dayNames: ['sundag', 'måndag', 'tysdag', 'onsdag', 'torsdag', 'fredag', 'laurdag'],\n    dayNamesMin: ['su', 'må', 'ty', 'on', 'to', 'fr', 'la'],\n    weekHeader: 'Veke',\n    dateFormat: 'dd.mm.yy',\n    firstDay: 1,\n    isRTL: false,\n    showMonthAfterYear: false,\n    yearSuffix: ''\n  }; //$.datepicker.setDefaults($.datepicker.regional['nn']);\n})(jQuery);"
    },
    "./node_modules/raw-loader/index.js!./node_modules/babel-loader/lib/index.js?!./node_modules/ifdef-loader/ifdef-loader.js?!./src/lib/jqueryui/jquery.ui.touch-punch.min.js": function(e, t) {
        e.exports = '/*\n * jQuery UI Touch Punch 0.2.2\n *\n * Copyright 2011, Dave Furfero\n * Dual licensed under the MIT or GPL Version 2 licenses.\n *\n * Depends:\n *  jquery.ui.widget.js\n *  jquery.ui.mouse.js\n */\n(function (b) {\n  b.support.touch = "ontouchend" in document;\n\n  if (!b.support.touch) {\n    return;\n  }\n\n  var c = b.ui.mouse.prototype,\n      e = c._mouseInit,\n      a;\n\n  function d(g, h) {\n    if (g.originalEvent.touches.length > 1) {\n      return;\n    }\n\n    g.preventDefault();\n    var i = g.originalEvent.changedTouches[0],\n        f = document.createEvent("MouseEvents");\n    f.initMouseEvent(h, true, true, window, 1, i.screenX, i.screenY, i.clientX, i.clientY, false, false, false, false, 0, null);\n    g.target.dispatchEvent(f);\n  }\n\n  c._touchStart = function (g) {\n    var f = this;\n\n    if (a || !f._mouseCapture(g.originalEvent.changedTouches[0])) {\n      return;\n    }\n\n    a = true;\n    f._touchMoved = false;\n    d(g, "mouseover");\n    d(g, "mousemove");\n    d(g, "mousedown");\n  };\n\n  c._touchMove = function (f) {\n    if (!a) {\n      return;\n    }\n\n    this._touchMoved = true;\n    d(f, "mousemove");\n  };\n\n  c._touchEnd = function (f) {\n    if (!a) {\n      return;\n    }\n\n    d(f, "mouseup");\n    d(f, "mouseout");\n\n    if (!this._touchMoved) {\n      d(f, "click");\n    }\n\n    a = false;\n  };\n\n  c._mouseInit = function () {\n    var f = this;\n    f.element.bind("touchstart", b.proxy(f, "_touchStart")).bind("touchmove", b.proxy(f, "_touchMove")).bind("touchend", b.proxy(f, "_touchEnd"));\n    e.call(f);\n  };\n})(jQuery);'
    },
    "./node_modules/script-loader/index.js!./src/lib/jqueryui/jquery-ui-i18n.js": function(e, t, i) {
        i("./node_modules/script-loader/addScript.js")(i("./node_modules/raw-loader/index.js!./node_modules/babel-loader/lib/index.js?!./node_modules/ifdef-loader/ifdef-loader.js?!./src/lib/jqueryui/jquery-ui-i18n.js"))
    },
    "./node_modules/script-loader/index.js!./src/lib/jqueryui/jquery.ui.touch-punch.min.js": function(e, t, i) {
        i("./node_modules/script-loader/addScript.js")(i("./node_modules/raw-loader/index.js!./node_modules/babel-loader/lib/index.js?!./node_modules/ifdef-loader/ifdef-loader.js?!./src/lib/jqueryui/jquery.ui.touch-punch.min.js"))
    },
    "./src/assets/allIcons/icons-facelift.css": function(e, t, i) {},
    "./src/css/browser-not-supported-view.scss": function(e, t, i) {},
    "./src/css/database-icons.css": function(e, t, i) {},
    "./src/init.js": function(e, t, o) {
        "use strict";
        o.r(t);
        var n = o("./node_modules/react-dom/index.js"),
            s = o.n(n),
            a = o("./node_modules/react/index.js"),
            r = o.n(a),
            l = o("./src/react/util/Track.ts"),
            c = o("./src/js/ui/ui-util.js");
        const d = /^nx_(mac|ipad|iphone)_(1m|1y)_([0-9]+)$/;
        function h(e) {
            var t,
                i = (e = e || {}).users || [],
                o = {};
            for (t = 0; t < i.length; t++) {
                var n = p(i[t]);
                n && (o[n.id] = n)
            }
            var s = e.teams || [],
                a = {};
            for (t = 0; t < s.length; t++) {
                var r = u(s[t], o);
                r && (a[r.id] = r)
            }
            this.token = e.token && e.token.token ? "USER-" + e.token.token : void 0,
            this.user = p(e.user) || {
                id: "#NO-USER-ID#",
                name: "Anonymous",
                displayName: "Anonymous",
                email: "user@example.com"
            },
            this.accounts = a,
            this.users = o
        }
        function p(e) {
            if (e && e.id)
                return {
                    id: e.id,
                    plan: e.plan,
                    name: e.profile && e.profile.displayName || e.email || "Anonymous",
                    displayName: e.profile && e.profile.displayName || e.email || "Anonymous",
                    firstName: e.profile && e.profile.firstName || e.firstName,
                    lastName: e.profile && e.profile.lastName || e.lastName,
                    email: e.email || "user@example.com",
                    verified: !!e.verified,
                    isRoot: !!e.isRoot,
                    language: e.profile && e.profile.language || "en",
                    accounts: {},
                    photo: e.profile && e.profile.photo || void 0,
                    active: !1 !== e.active,
                    experimentT: e.experimentT,
                    passwordExpired: e.passwordExpired,
                    journey: e.journey || {},
                    createdAt: e.createdAt
                }
        }
        function u(e, t) {
            if (e && e.id && !e.stoppedAt) {
                var i = {
                    id: e.id,
                    name: e.name || locale.unnamed,
                    owner: e.owner,
                    invitations: {},
                    host: e.host,
                    roles: {}
                };
                f(i.roles, ["admin", "editor"]),
                f(i.roles, e.roles);
                for (var o = e.users || [], n = {}, s = 0; s < o.length; s++) {
                    var a = o[s],
                        r = t[a.user];
                    if (r) {
                        var l = {
                            id: r.id,
                            name: r.name,
                            email: r.email,
                            firstName: r.firstName,
                            lastName: r.lastName,
                            verified: r.verified,
                            language: r.language,
                            roles: m(a.role),
                            photo: r.photo,
                            active: r.active
                        };
                        r.accounts[i.id] = i,
                        n[r.id] = l,
                        f(i.roles, a.roles || a.role ? g(a.role) : [])
                    }
                }
                i.users = n;
                var c = e.invitations;
                if (c)
                    for (var d = 0; d < c.length; d++) {
                        var h = c[d],
                            p = {
                                email: h.recipient,
                                roles: m(h.role),
                                createdAt: new Date(h.createdAt),
                                user: t[h.sender],
                                inviteCode: h.id
                            };
                        i.invitations[p.inviteCode] = p,
                        h.role && f(i.roles, g(h.role))
                    }
                return i
            }
        }
        function f(e, t) {
            if (t)
                for (var i = 0; i < t.length; i++) {
                    var o = t[i];
                    "string" == typeof o && o.length && (e[o] || (e[o] = {
                        id: o,
                        caption: o
                    }))
                }
        }
        function m(e) {
            if (!e)
                return {};
            var t = {};
            "string" == typeof e && (e = g(e));
            for (var i = 0; i < e.length; i++)
                t[e[i]] = !0;
            return t
        }
        function g(e) {
            if (!e)
                return [];
            for (var t = e.split(","), i = [], o = 0; o < t.length; o++) {
                var n = t[o].trim();
                n && i.push(n)
            }
            return i
        }
        function v(e) {
            var t = this;
            e = e || {},
            this.config = e,
            this.isVisible = !1,
            this.$backplane = $.backplane({
                close: !!e.dismiss && $.proxy(this.dismiss, this)
            }),
            this.$page = $('<div class="popup">').appendTo(this.$backplane),
            this.$viewport = $('<div class="popup-viewport">').appendTo(this.$page),
            this.$pane = $('<div class="popup-pane">').appendTo(this.$viewport),
            this.$error = null,
            this.$buttons = [];
            var i = e.caption;
            i && (this.$viewport.css("top", "48px"), this.$head = $('<div class="popup-head">').text(i).appendTo(this.$page));
            var o = e.message;
            o && this.$pane.append($("<p>").text(o));
            var n = e.buttons || [];
            if (e.dismiss && n.unshift({
                caption: locale.cancel,
                click: $.proxy(this.dismiss, this)
            }), e.okay && n.push({
                caption: "OK",
                cls: "blue",
                click: $.proxy(this.okay, this)
            }), n.length > 0) {
                this.$foot = $('<div class="popup-foot popup-foot-' + n.length + 'buttons">').appendTo(this.$page),
                this.$viewport.css("bttom", "48px");
                for (var s = 0; s < n.length; s++)
                    !function(e) {
                        var i = n[e],
                            o = $('<div class="popup-foot-button popup-foot-button' + e + '">').addClass(i.cls).text(i.caption).appendTo(t.$foot).click((function() {
                                if (i.click) {
                                    var e = i.click.apply(t, arguments);
                                    !1 !== e && t.destroy()
                                }
                            }));
                        t.$buttons[e] = o
                    }(s)
            }
            e.init && e.init.call(this),
            this.resize = $.proxy(this.resize, this),
            this.resize(),
            $(window).on("resize", this.resize)
        }
        h.prototype.getCurrentUser = function() {
            return this.user
        },
        h.prototype.getCurrentAccountUser = function(e) {
            var t = this.accounts[e];
            if (t) {
                var i = this.user;
                if (i)
                    return t.users[i.id]
            }
        },
        h.prototype.isAdmin = function(e) {
            var t = this.getCurrentAccountUser(e);
            return !(!t || !t.roles.admin)
        },
        h.prototype.getUser = function(e) {
            return this.users[e]
        },
        h.prototype.getUsers = function() {
            return this.users
        },
        h.prototype.getRoles = function(e) {
            var t = this.accounts[e];
            return t ? t.roles : {}
        },
        h.prototype.addRole = function(e, t) {
            var i = this.accounts[e];
            i && (i.roles[t.id] = t)
        },
        h.prototype.getAccountUser = function(e, t) {
            var i = this.accounts[e];
            if (i)
                return i.users[t]
        },
        h.prototype.getAccount = function(e) {
            return this.accounts[e]
        },
        h.prototype.getAccounts = function() {
            return this.accounts
        },
        h.prototype.listAccounts = function() {
            return util.localeSortBy(this.accounts, "name")
        },
        h.prototype.listAccountUsers = function(e) {
            var t = this.accounts[e];
            return t ? util.localeSortBy(t.users, "name") : []
        },
        h.prototype.listInvitations = function(e) {
            var t = this.accounts[e];
            return t ? util.localeSortBy(t.invitations, "email") : []
        },
        h.prototype.getInvitation = function(e, t) {
            var i = this.accounts[e];
            if (i)
                return i.invitations[t]
        },
        h.prototype.canCreateTestAccount = function() {
            return !0
        },
        h.prototype.canRemoveAccount = function(e) {
            var t = this.accounts[e];
            return !!t && t.owner === this.user.id
        },
        h.prototype.canInvite = function(e) {
            var t = this.getCurrentAccountUser(e);
            return !!t && (!!t.roles.admin && !!t.verified)
        },
        h.prototype.hasOtherAdmins = function(e, t) {
            var i = this.accounts[e];
            if (!i)
                return !1;
            var o = i.users;
            if (!o[t])
                return !1;
            var n = 0;
            for (var s in o) {
                if (o.hasOwnProperty(s))
                    if (s != t)
                        o[s].roles.admin && n++
            }
            return n > 0
        },
        h.prototype.getPlan = function() {
            var e = this.accounts,
                t = 0,
                i = 0,
                o = 0,
                n = 0,
                s = {};
            for (var a in e)
                if (e.hasOwnProperty(a)) {
                    var r = e[a];
                    if (r.owner === this.user.id) {
                        var l = r.users;
                        for (var c in n++, l)
                            if (l.hasOwnProperty(c)) {
                                var h = this.users[c];
                                h && !s[c] && (s[c] = h, o++, h.plan && "basic" === h.plan.name ? t++ : i++)
                            }
                    }
                }
            var p,
                u,
                f,
                m = this.user.plan || {},
                g = m.name || "none",
                v = m.provider || "none";
            if ("apple" === v) {
                var b = d.exec(m.product);
                b && (p = b[1], u = b[2], f = parseInt(b[3]))
            }
            return {
                name: g,
                provider: v,
                collaborators: m.collaborators,
                product: m.product,
                productDevice: p,
                productPeriod: u,
                productCount: f,
                expiresAt: m.expiresAt && new Date(m.expiresAt),
                ownAccountsCount: n,
                totalUserCount: o,
                accountableUserCount: i,
                freeUserCount: t,
                uniqueUsers: s
            }
        },
        h.prototype.hasPlan = function(e) {
            var t = this.accounts[e];
            if (!t)
                return !1;
            var i = this.users[t.owner];
            return i && i.plan && "none" !== i.plan.name || !1
        },
        h.prototype.getOwner = function(e) {
            var t = this.accounts[e];
            if (!t)
                return {
                    email: "unknown"
                };
            var i = this.users[t.owner];
            return i || {
                    email: "unknown"
                }
        },
        v.prototype.destroy = function() {
            $(window).off("resize", this.resize),
            this.$backplane.close()
        },
        v.prototype.dismiss = function() {
            this.destroy(),
            "function" == typeof this.config.dismiss && this.config.dismiss()
        },
        v.prototype.okay = function() {
            this.destroy(),
            "function" == typeof this.config.okay && this.config.okay()
        },
        v.prototype.resize = function() {
            var e = this.$pane.height() + (this.$foot ? this.$foot.height() : 0) + (this.$head ? this.$head.height() : 0),
                t = Math.max(0, window.innerHeight - e);
            this.$page.css({
                top: Math.round(t / 3),
                height: e
            })
        },
        v.prototype.error = function(e) {
            e ? (this.$error || (this.$error = $('<div class="error-pane">').prependTo(this.$pane)), this.$error.text(String(e)), this.resize()) : this.$error && (this.$error.remove(), this.$error = null)
        };
        var b = o("./node_modules/@ninox/ninox-core/dist/ninox-core.es5.js");
        const y = "https://ums.ninox.com";
        function w() {
            this.requestQueue = [],
            this.reloginCallbacks = [],
            this.reloginActive = !1;
            var e = NinoxDocumentInteraction.getUserDefault("nx.server");
            if (this.baseURL = e ? "https://" + e + "/ums" : y, !this.baseURL)
                throw new Error("Invalid configuration: prod");
            this.apiURL = this.baseURL + "/api",
            this.signupURL = this.apiURL + "/self/user",
            this.loginURL = this.apiURL + "/credentials/signin",
            this.logoutURL = this.apiURL + "/credentials/signout",
            this.refreshURL = this.apiURL + "/self/session/current",
            this.createAccountURL = this.apiURL + "/self/team",
            this.forgotPasswordURL = this.apiURL + "/credentials/requestResetPassword",
            this.resendVerificationMailURL = this.apiURL + "/user/requestEmailVerification",
            this.sessionKey = "nx.session";
            var t,
                i = NinoxDocumentInteraction.getUserDefault(this.sessionKey) || "";
            if (i)
                try {
                    t = JSON.parse(i)
                } catch (e) {
                    console.warn("Invalid session object", e)
                }
            this.session = t,
            this.sessionInfo = new h(t),
            this.session && location.hash.startsWith("/verification/callback?email=") && this.sessionInfo.user.email !== window.location.hash.substr(29) && this.logout(),
            this.device = "web:" + navigator.userAgent,
            this.isLoggedIn() && l.c(this.sessionInfo.user)
        }
        Object.assign(w.prototype, b.util.events),
        w.prototype.shouldLogRocket = function() {
            return !0
        },
        w.prototype.isLoggedIn = function() {
            return !!this.session
        },
        w.prototype.getToken = function() {
            return this.sessionInfo ? this.sessionInfo.token : void 0
        },
        w.prototype.ensureToken = function(e) {
            var t = this;
            if (t.sessionInfo && t.sessionInfo.token)
                return e(void 0, t.sessionInfo.token);
            t.login((function(i) {
                return i ? e(i) : t.sessionInfo && t.sessionInfo.token ? e(void 0, t.sessionInfo.token) : void e("Login failed.")
            }))
        },
        w.prototype.signup = function(e, t) {
            var i = this,
                o = this.signupURL,
                n = JSON.stringify({
                    email: e.email,
                    password: e.password,
                    newsletter: e.newsletter,
                    device: this.device,
                    uuid: void 0,
                    nxVersion: NINOX_VERSION,
                    language: locale.LOCALE,
                    iadAttributionDetails: e.iadAttributionDetails
                });
            $.ajax({
                type: "POST",
                url: o,
                data: n,
                contentType: "application/json",
                processData: !1,
                xhrFields: {
                    withCredentials: !0
                },
                headers: {},
                success: function(e, o, n) {
                    i.saveSession(e),
                    l.a(i.sessionInfo.user);
                    var s = i.getUserId();
                    if (s)
                        try {
                            ga("send", "event", "signup", s, "user_id", {
                                dimension4: s
                            })
                        } catch (e) {
                            console.log(e)
                        }
                    t(null, s)
                },
                error: function(e, i, o) {
                    console.warn(i, o),
                    t(locale.emailAlreadyRegistered)
                }
            })
        },
        w.prototype.login = function(e, t, i) {
            var o = this,
                n = this.loginURL,
                s = JSON.stringify({
                    email: e,
                    password: t,
                    device: this.device,
                    uuid: void 0,
                    nxVersion: NINOX_VERSION,
                    language: locale.LOCALE
                });
            $.ajax({
                type: "POST",
                url: n,
                data: s,
                contentType: "application/json",
                processData: !1,
                xhrFields: {
                    withCredentials: !0
                },
                headers: {},
                success: function(e, t, n) {
                    o.saveSession(e),
                    l.c(o.sessionInfo.user);
                    var s = o.getUserId();
                    if (s)
                        try {
                            ga("send", "event", "login", s, "user_id", {
                                dimension7: s
                            })
                        } catch (e) {
                            console.log(e)
                        }
                    i()
                },
                error: function(e, t, o) {
                    console.warn(t, o),
                    i(e.responseText)
                }
            })
        },
        w.prototype.refresh = function(e, t) {
            var i = this,
                o = this.refreshURL,
                n = this.session;
            if (t || n)
                if (this.reloginActive)
                    e && e();
                else {
                    var s = {};
                    i.sessionInfo && i.sessionInfo.token && (s.authorization = "Bearer " + i.sessionInfo.token),
                    $.ajax({
                        type: "GET",
                        url: o,
                        processData: !1,
                        xhrFields: {
                            withCredentials: !0
                        },
                        headers: s,
                        success: function(t, o, n) {
                            i.saveSession(t),
                            l.c(i.sessionInfo.user),
                            e && e()
                        },
                        error: function(o, n, s) {
                            console.warn("Cannot get session info.", n, s),
                            o.status >= 400 && o.status < 500 && !t ? i.relogin(e) : e && e()
                        }
                    })
                }
            else
                e && e()
        },
        w.prototype.logout = function(e) {
            var t = this.logoutURL;
            if (!this.session)
                return e();
            var i = this.sessionInfo.token;
            this.clearSession(),
            $.ajax({
                type: "POST",
                url: t,
                data: {
                    device: this.device
                },
                processData: !1,
                xhrFields: {
                    withCredentials: !0
                },
                headers: {
                    authorization: "Bearer " + i
                },
                success: function(t, i, o) {
                    e()
                },
                error: function(t, i, o) {
                    console.warn(i, o),
                    e()
                }
            })
        },
        w.prototype.forgotPassword = function(e, t) {
            var i = this.forgotPasswordURL,
                o = JSON.stringify({
                    email: e.email,
                    device: this.device,
                    uuid: void 0,
                    nxVersion: NINOX_VERSION,
                    language: locale.LOCALE
                });
            $.ajax({
                type: "POST",
                url: i,
                data: o,
                contentType: "application/json",
                processData: !1,
                xhrFields: {
                    withCredentials: !0
                },
                headers: {},
                success: function(e, i, o) {
                    t()
                },
                error: function(e, i, o) {
                    console.warn(i, o),
                    t(locale.emailNotRegistered)
                }
            })
        },
        w.prototype.changePassword = function(e, t) {
            if (!this.session)
                return t("Not logged in.");
            var i = this.apiURL + "/self/user/password",
                o = JSON.stringify({
                    oldPassword: e.oldPassword,
                    newPassword: e.newPassword,
                    device: this.device,
                    uuid: void 0,
                    nxVersion: NINOX_VERSION,
                    language: locale.LOCALE
                });
            $.loading(!0),
            $.ajax({
                type: "PUT",
                url: i,
                data: o,
                contentType: "application/json",
                processData: !1,
                xhrFields: {
                    withCredentials: !0
                },
                headers: {
                    authorization: "Bearer " + this.sessionInfo.token
                },
                success: function(e, i, o) {
                    $.loading(!1),
                    t(null, o.responseText)
                },
                error: function(e, i, o) {
                    $.loading(!1),
                    t(e.responseText)
                }
            })
        },
        w.prototype.changeExpiredPassword = function(e, t) {
            var i = this.apiURL + "/self/user/expired-password",
                o = JSON.stringify({
                    oldPassword: e.oldPassword,
                    newPassword: e.newPassword,
                    id: e.userId,
                    device: this.device,
                    uuid: void 0,
                    nxVersion: NINOX_VERSION,
                    language: locale.LOCALE
                });
            $.loading(!0),
            $.ajax({
                type: "PUT",
                url: i,
                data: o,
                contentType: "application/json",
                processData: !1,
                xhrFields: {
                    withCredentials: !0
                },
                success: function(e, i, o) {
                    $.loading(!1),
                    t(null, o.responseText)
                },
                error: function(e, i, o) {
                    $.loading(!1),
                    t(e.responseText)
                }
            })
        },
        w.prototype.resendVerificationMail = function(e, t) {
            var i = this.resendVerificationMailURL;
            if (!this.session)
                return t("Not logged in.");
            var o = this.getCurrentUser().email,
                n = JSON.stringify({
                    email: o,
                    device: this.device,
                    uuid: void 0,
                    nxVersion: NINOX_VERSION,
                    language: locale.LOCALE
                });
            $.ajax({
                type: "POST",
                url: i,
                data: n,
                contentType: "application/json",
                processData: !1,
                xhrFields: {
                    withCredentials: !0
                },
                headers: {
                    authorization: "Bearer " + this.sessionInfo.token
                },
                success: function(e, i, o) {
                    t()
                },
                error: function(e, i, o) {
                    console.warn("verification error -> ", i, o),
                    t(locale.wrongUserPassword)
                }
            })
        },
        w.prototype.createAccount = function(e, t) {
            var i = this;
            i.request("POST", this.createAccountURL, {
                name: e.name,
                device: this.device
            }, (function(e, o) {
                if (e)
                    return t(e);
                i.refresh((function(e) {
                    t(e, o && o.id)
                }))
            }))
        },
        w.prototype.sendReceipt = function(e, t) {
            var i = this;
            i.request("POST", this.apiURL + "/self/payment/apple", {
                receipt: e,
                device: this.device
            }, (function(e, o) {
                if (e)
                    return t(e);
                i.refresh(t)
            }))
        },
        w.prototype.checkReceipt = function(e, t) {
            this.request("POST", this.apiURL + "/self/payment/checkReceipt", {
                receipt: e,
                device: this.device
            }, (function(e, i) {
                if (e)
                    return t(e);
                t(void 0, i)
            }))
        },
        w.prototype.invite = function(e, t) {
            var i = this,
                o = e.email,
                n = e.accountId,
                s = e.roles && e.roles.join(", ") || "editor";
            i.request("POST", this.apiURL + "/self/invitation", {
                recipient: o,
                role: s,
                teamId: n,
                device: this.device
            }, (function(e) {
                if (e)
                    return t(e);
                i.refresh(t)
            }))
        },
        w.prototype.cancelInvitation = function(e, t, i) {
            var o = this;
            o.request("DELETE", this.apiURL + "/self/invitation/" + encodeURIComponent(t), void 0, (function(e) {
                if (e)
                    return i(e);
                o.refresh(i)
            }))
        },
        w.prototype.resendInvitation = function(e, t, i) {
            var o = this;
            o.request("PUT", this.apiURL + "/self/invitation/" + encodeURIComponent(t) + ":resend", {}, (function(e) {
                if (e)
                    return i(e);
                o.refresh(i)
            }))
        },
        w.prototype.removeAccountUser = function(e, t, i) {
            var o = this;
            o.request("DELETE", this.apiURL + "/self/team/" + encodeURIComponent(e) + "/member/" + encodeURIComponent(t), void 0, (function(e) {
                if (e)
                    return i(e);
                o.refresh(i)
            }))
        },
        w.prototype.updateAccountUser = function(e, t, i) {
            var o = this,
                n = t.roles && t.roles.join(", ") || "editor";
            o.request("PUT", this.apiURL + "/self/team/" + encodeURIComponent(e) + "/member/" + encodeURIComponent(t.id), {
                role: n
            }, (function(e) {
                if (e)
                    return i(e);
                o.refresh(i)
            }))
        },
        w.prototype.updateUserProfile = function(e, t) {
            var i = this;
            if (!i.getCurrentUser())
                return t("Not logged in");
            i.request("PUT", this.apiURL + "/self/user", e, (function(e) {
                if (e)
                    return t(e);
                i.refresh(t)
            }))
        },
        w.prototype.updateUserJourney = function(e, t) {
            var i = this;
            if (!i.getCurrentUser())
                return t("Not logged in");
            i.request("POST", this.apiURL + "/self/user/journey", e, (function(e) {
                if (e)
                    return t(e);
                i.refresh(t)
            }))
        },
        w.prototype.updateAccount = function(e, t) {
            var i = this;
            if (!i.getCurrentUser())
                return t("Not logged in");
            i.request("PUT", this.apiURL + "/self/team/" + encodeURIComponent(e.id), {
                name: e.name
            }, (function(e) {
                if (e)
                    return t(e);
                i.refresh(t)
            }))
        },
        w.prototype.changeEmail = function(e, t) {
            const i = this;
            if (!this.session)
                return t("Not logged in.");
            const o = this.apiURL + "/self/user/email",
                n = JSON.stringify({
                    email: e
                });
            $.loading(!0),
            $.ajax({
                type: "PUT",
                url: o,
                data: n,
                contentType: "application/json",
                processData: !1,
                xhrFields: {
                    withCredentials: !0
                },
                headers: {
                    authorization: "Bearer " + i.sessionInfo.token
                },
                success: function(e, o, n) {
                    $.loading(!1),
                    i.refresh(t)
                },
                error: function(e, i, o) {
                    $.loading(!1),
                    t(e.responseText)
                }
            })
        },
        w.prototype.canRemoveAccount = function(e) {
            return this.sessionInfo.canRemoveAccount(e)
        },
        w.prototype.removeAccount = function(e, t) {
            var i = this;
            i.request("DELETE", this.apiURL + "/self/team/" + encodeURIComponent(e), void 0, (function(e) {
                if (e)
                    return t(e);
                i.refresh(t)
            }))
        },
        w.prototype.saveSession = function(e) {
            b.util.equals(e, this.session) || (this.session = e, this.sessionInfo = new h(e), NinoxDocumentInteraction.setUserDefault(this.sessionKey, JSON.stringify(this.session)), this.trigger("change", e))
        },
        w.prototype.clearSession = function() {
            this.session && (this.session = void 0, this.sessionInfo = new h({}), NinoxDocumentInteraction.setUserDefault(this.sessionKey, ""), this.trigger("change", void 0))
        },
        w.prototype.getUserId = function() {
            if (this.session)
                return this.sessionInfo.user.id
        },
        w.prototype.getUserName = function() {
            return this.session ? this.sessionInfo.user.name || "Anonymous" : "Not Logged In"
        },
        w.prototype.getAccounts = function() {
            return this.sessionInfo.getAccounts()
        },
        w.prototype.listAccounts = function() {
            return this.sessionInfo.listAccounts()
        },
        w.prototype.getAccount = function(e) {
            return this.sessionInfo.getAccount(e)
        },
        w.prototype.getAccountName = function(e) {
            var t = this.sessionInfo.getAccount(e);
            return t && t.name || locale.unknown
        },
        w.prototype.getFirstAccount = function() {
            var e = this.sessionInfo.listAccounts();
            return e.length ? e[0] : void 0
        },
        w.prototype.getSessionInfo = function() {
            return this.sessionInfo
        },
        w.prototype.getUpgradeURL = function(e) {
            return this.apiURL + "/self/payment:link"
        },
        w.prototype.listAccountUsers = function(e) {
            return this.sessionInfo.listAccountUsers(e)
        },
        w.prototype.listInvitations = function(e) {
            return this.sessionInfo.listInvitations(e)
        },
        w.prototype.getAccountUser = function(e, t) {
            return this.sessionInfo.getAccountUser(e, t)
        },
        w.prototype.getCurrentUser = function() {
            return this.sessionInfo.getCurrentUser()
        },
        w.prototype.getCurrentAccountUser = function(e) {
            return this.sessionInfo.getAccountUser(e, this.sessionInfo.getCurrentUser().id)
        },
        w.prototype.getInvitation = function(e, t) {
            return this.sessionInfo.getInvitation(e, t)
        },
        w.prototype.isAdmin = function(e) {
            return this.sessionInfo.isAdmin(e)
        },
        w.prototype.canCreateTestAccount = function() {
            return this.isLoggedIn() && this.sessionInfo.canCreateTestAccount()
        },
        w.prototype.hasOtherAdmins = function(e, t) {
            return this.isLoggedIn() && this.sessionInfo.hasOtherAdmins(e, t)
        },
        w.prototype.canInvite = function(e) {
            return this.isLoggedIn() && this.sessionInfo.canInvite(e)
        },
        w.prototype.request = function(e, t, i, o) {
            var n = this,
                s = n.sessionInfo ? n.sessionInfo.token : void 0,
                a = s ? "Bearer " + s : void 0,
                r = {};
            a && (r.authorization = a);
            var l = i ? JSON.stringify(i) : void 0,
                c = l ? "application/json" : void 0;
            $.ajax({
                type: e,
                url: t,
                contentType: c,
                data: l,
                headers: r,
                xhrFields: {
                    withCredentials: !0
                },
                processData: !1,
                success: function(e, t, i) {
                    o(void 0, e)
                },
                error: function(s, a, r) {
                    console.warn(a, r),
                    401 === s.status ? (n.requestQueue.push([e, t, i, o]), n.relogin()) : o("Request error: " + e + " " + t + ": " + a + "\n - " + r + ":\n " + s.status + " " + s.statusText + "\n " + s.responseText)
                }
            })
        },
        w.prototype.reloginDialog = function(e) {
            this.reloginDialog_MAC(e)
        },
        w.prototype.reloginDialog_IPHONE = function(e) {
            const t = Object(c.g)(),
                i = e.login(t);
            t ? function(e) {
                new v({
                    caption: "Ninox Login",
                    dismiss: !0,
                    init: () => {
                        l.f("Relogin", "Open")
                    },
                    buttons: [{
                        caption: locale.ssoLogin,
                        cls: "blue",
                        click: e
                    }]
                })
            }(i) : function(t) {
                new v({
                    caption: locale.login + " relogin",
                    dismiss: !0,
                    init: function() {
                        l.f("Relogin", "Open");
                        var t = $("<div>").appendTo(this.$pane),
                            i = this.$loginEmail = $('<input type="email" class="no-barcode">').attr("placeholder", Object(c.f)() ? locale.emailOrUserName : locale.email).val(e.email || "");
                        $('<div class="editor-block no-label">').append(i).appendTo(t);
                        var o = this.$loginPassword = $('<input type="password" class="no-barcode">').attr("placeholder", locale.password);
                        $('<div class="editor-block no-label">').append(o).appendTo(t)
                    },
                    buttons: [{
                        caption: locale.login,
                        cls: "blue",
                        click: function() {
                            l.f("Relogin", "Click");
                            var e = this.$loginEmail.val(),
                                i = this.$loginPassword.val();
                            return e ? i ? (e = e.trim().toLocaleLowerCase(), Object(c.f)() || b.util.isValidEmail(e) ? (this.dismiss(), $.loading(!0), void t(e, i, (function(e) {
                                $.loading(!1),
                                l.f("Relogin", e ? "Error" : "Success"),
                                e && alert(e)
                            }))) : $.alert(locale.emailMissing)) : $.alert("Password missing") : $.alert("Email missing")
                        }
                    }]
                })
            }(i)
        },
        w.prototype.reloginDialog_MAC = function(e) {
            let t,
                i,
                o;
            function n() {
                t.close(),
                e.cancel()
            }
            function s(n=!1) {
                const s = e.login(n);
                if (n)
                    t.close(),
                    s();
                else {
                    var a = i.val(),
                        r = o.val();
                    if (!a)
                        return $.alert("Email missing");
                    if (!r)
                        return $.alert("Password missing");
                    if (a = a.trim().toLocaleLowerCase(), !b.util.isValidEmail(a))
                        return $.alert(locale.emailMissing);
                    t.close(),
                    $.loading(!0),
                    s(a, r, (function(e) {
                        $.loading(!1),
                        e && alert(e)
                    }))
                }
            }
            Object(c.g)() ? t = $.popdown({
                cls: "small relogin-popup",
                head: "Log in",
                closable: !1,
                buttons: [{
                    caption: locale.cancel,
                    click: n
                }, "-", {
                    caption: locale.ssoLogin || "SSO Login",
                    cls: "blue",
                    click: () => s(!0)
                }]
            }) : (t = $.popdown({
                cls: "small relogin-popup",
                head: "Log in",
                closable: !1,
                buttons: [{
                    caption: locale.cancel,
                    click: n
                }, "-", {
                    caption: locale.login,
                    cls: "blue",
                    click: () => s(!1)
                }]
            }), i = $.input({
                caption: Object(c.f)() ? locale.emailOrUserName : locale.email,
                type: "email",
                $container: t.$content,
                focus: !e.email,
                val: e.email,
                enter: function() {
                    o.focus()
                }
            }), o = $.input({
                caption: "Password",
                type: "password",
                $container: t.$content,
                focus: !!e.email,
                enter: function() {
                    s(!1)
                }
            }))
        },
        w.prototype.relogin = function(e) {
            var t = this;
            if (e && this.reloginCallbacks.push(e), !t.reloginActive) {
                t.reloginActive = !0;
                var i = t.sessionInfo && t.sessionInfo.getCurrentUser(),
                    o = i && i.email || "";
                t.reloginDialog({
                    email: o,
                    login: (e=!1) => e ? n : s,
                    cancel: function() {
                        t.clearSession(),
                        t.cancelRequests();
                        var e = t.reloginCallbacks;
                        t.reloginCallbacks = [],
                        setTimeout((function() {
                            for (var t = 0; t < e.length; t++)
                                e[t](!1)
                        }), 0)
                    }
                })
            }
            function n() {
                dbms.getRemoteConnection().samlLogin()
            }
            function s(e, i, o) {
                var n = t.loginURL,
                    s = JSON.stringify({
                        email: e,
                        password: i,
                        device: t.device,
                        uuid: void 0,
                        nxVersion: NINOX_VERSION,
                        language: locale.LOCALE
                    });
                $.ajax({
                    type: "POST",
                    url: n,
                    data: s,
                    contentType: "application/json",
                    processData: !1,
                    xhrFields: {
                        withCredentials: !0
                    },
                    headers: {},
                    success: function(e, i, n) {
                        o(),
                        t.saveSession(e),
                        t.reloginActive = !1;
                        var s = t.reloginCallbacks;
                        t.reloginCallbacks = [],
                        setTimeout((function() {
                            for (var e = 0; e < s.length; e++)
                                s[e](!0);
                            t.rerequest()
                        }), 0)
                    },
                    error: function(e, i, n) {
                        console.warn(i, n),
                        o(locale.wrongUserPassword),
                        t.reloginActive = !1,
                        setTimeout((function() {
                            t.relogin()
                        }), 0)
                    }
                })
            }
        },
        w.prototype.rerequest = function() {
            var e = this.requestQueue;
            this.requestQueue = [];
            for (var t = 0; t < e.length; t++) {
                var i = e[t];
                this.request.apply(this, i)
            }
        },
        w.prototype.cancelRequests = function() {
            var e = this.requestQueue;
            this.requestQueue = [];
            for (var t = 0; t < e.length; t++) {
                (0, e[t][3])("Logged out")
            }
        },
        w.prototype.uploadProfileImage = function(e, t) {
            var i = this,
                o = this.apiURL + "/self/user/photo",
                n = i.sessionInfo ? i.sessionInfo.token : void 0,
                s = n ? "Bearer " + n : void 0,
                a = {};
            s && (a.authorization = s);
            var r = new FormData;
            r.append("file", e.file);
            var l = $.progress({
                    caption: "Uploading image...",
                    cancel: function() {
                        c.abort()
                    }
                }),
                c = $.ajax({
                    url: o,
                    type: "POST",
                    headers: a,
                    processData: !1,
                    xhrFields: {
                        withCredentials: !0
                    },
                    xhr: function() {
                        var e = $.ajaxSettings.xhr();
                        return e.upload && e.upload.addEventListener("progress", d, !1), e
                    },
                    success: function(e, o, n) {
                        l.close(),
                        i.refresh(),
                        t()
                    },
                    error: function() {
                        l.close(),
                        t("Failed to upload image.")
                    },
                    data: r,
                    cache: !1,
                    contentType: !1
                });
            function d(e) {
                var t = e.loaded / e.total;
                l.update(t)
            }
        },
        w.prototype.fetchAPIKeys = function(e) {
            if (this.isLoggedIn()) {
                var t = this.getUserId();
                if (t) {
                    var i = this.apiURL + "/self/user/" + t + "/tokens";
                    this.request("GET", i, null, (function(t, i) {
                        if (t)
                            return e(t);
                        return e(null, i)
                    }))
                } else
                    console.warn("No user id")
            } else
                console.warn("User not logged in")
        },
        w.prototype.deleteAPIKey = function(e, t) {
            if (this.isLoggedIn()) {
                var i = this.getUserId();
                if (i) {
                    var o = this.apiURL + "/self/user/" + i + "/tokens/" + e;
                    this.request("DELETE", o, null, (function(e, i) {
                        if (e)
                            return t(e);
                        return t(null, i)
                    }))
                } else
                    console.warn("No user id")
            } else
                console.warn("User not logged in")
        },
        w.prototype.generateAPIKey = function(e) {
            if (this.isLoggedIn()) {
                var t = this.getUserId();
                if (t) {
                    var i = this.apiURL + "/self/user/" + t + "/tokens";
                    this.request("POST", i, null, (function(t, i) {
                        if (t)
                            return e(t);
                        return e(null, i)
                    }))
                } else
                    console.warn("No user id")
            } else
                console.warn("User not logged in")
        },
        w.prototype.getPlanInfo = function(e, t) {
            if (!this.isLoggedIn())
                return t();
            this.request("GET", this.baseURL + "/api/self/planinfo/" + encodeURIComponent(e), {}, t)
        },
        w.prototype.samlLogin = function() {
            window.location.href = this.baseURL + "/saml/login?RelayState=WEB"
        },
        w.prototype.googleLogin = async function() {
            const e = this,
                t = "de" === Object(b.getLocale)().LOCALE ? "de" : "en";
            let i = "https://ninox.com";
            ["qs", "alpha"].includes("prod") && (i = "https://q-www.ninox.com");
            const o = `${i}/api/auth/google/UA-46256641-1/${t}?source=WEB_APP`;
            {
                let t;
                try {
                    t = await (n = o, new Promise((e, t) => {
                        const i = window.open(n, "windowname1", "width=800, height=600"),
                            o = setInterval(() => {
                                if (!i)
                                    return console.warn("no window");
                                try {
                                    if (i.closed)
                                        return clearInterval(o), e(null);
                                    if (-1 !== i.document.URL.indexOf("userId")) {
                                        clearInterval(o);
                                        const n = i.document.URL.split(/[?&]/).slice(1);
                                        if (n.length) {
                                            const t = n.map(e => e.split("=")).reduce((e, t) => (e[t[0]] = decodeURIComponent(t[1]), e), {});
                                            e(t)
                                        } else
                                            t(new Error("Impossible case: no parameters in redirect"));
                                        i.close()
                                    }
                                } catch (e) {}
                            }, 100)
                    }))
                } catch (e) {
                    throw e
                }
                return await new Promise(t => e.refresh(t, !0)), t
            }
            var n
        },
        w.prototype.getServerConfig = function(e) {
            if (!NinoxDocumentInteraction.isOnline())
                return e(null, {});
            this.request("GET", this.baseURL + "/server-config", null, (t, i) => {
                if (t)
                    return e(t);
                e(null, i)
            })
        },
        w.prototype.fetchSession = function(e, t) {
            let i = this.refreshURL,
                o = {
                    authorization: `Bearer USER-${e}`
                };
            $.ajax({
                type: "GET",
                url: i,
                processData: !1,
                xhrFields: {
                    withCredentials: !0
                },
                headers: o,
                success: function(e, i, o) {
                    t && t(null, e)
                },
                error: function(e, i, o) {
                    console.warn("Cannot get session info.", i, o),
                    e.status >= 400 && e.status < 500 && t(o)
                }
            })
        };
        var x = o("./node_modules/socket.io-client/dist/socket.io.slim.js"),
            T = o("./node_modules/underscore/underscore.js");
        function C(e) {
            this.remoteChanged = $.proxy(this.remoteChanged, this),
            this.messageReceived = $.proxy(this.messageReceived, this),
            this.messagesRecieved = $.proxy(this.messagesRecieved, this),
            this.onMessageRead = $.proxy(this.onMessageRead, this),
            this.socketConnected = $.proxy(this.socketConnected, this),
            this.socketDisconnected = $.proxy(this.socketDisconnected, this),
            this.dbms = e,
            this.token = null,
            this.userId = null,
            this.isAuthenticated = !1,
            this.socket = null,
            this.capSize = 2,
            this.messages = [],
            this.conversations = [],
            this.msServices = {
                dev: "http://ms.ninoxdb.test",
                qs: "https://q-ms.ninox.com",
                prod: "https://ms.ninox.com"
            },
            e.getRemoteConnection().on("change", this.remoteChanged),
            this.remoteChanged()
        }
        Object.assign(C.prototype, util.events),
        C.prototype.connect = function() {
            this.socket || this.msServices.prod && (Object(c.f)() || this.dbms.getRemoteConnection().isLoggedIn() && (this.socket = x(this.msServices.prod, {
                transports: ["websocket"]
            }), this.socket.on("MESSAGE.PUSH", this.messageReceived), this.socket.on("MESSAGE.FETCH", this.messagesRecieved), this.socket.on("MESSAGE.READ", this.onMessageRead), this.socket.on("connect", this.socketConnected), this.socket.on("disconnect", this.socketDisconnected), this.remoteChanged()))
        },
        C.prototype.disconnect = function() {
            this.socket && (this.socket.disconnect(), this.socket = null, this.token = null, this.user = null, this.isAuthenticated = !1)
        },
        C.prototype.getSessionToken = function() {
            var e = dbms.getRemoteConnection().getSessionInfo(),
                t = e && e.token;
            return "USER-" === t.substr(0, 5) && (t = t.substr(5)), t
        },
        C.prototype.socketConnected = function() {
            this.remoteChanged()
        },
        C.prototype.socketDisconnected = function() {
            this.token = null,
            this.user = null,
            this.isAuthenticated = !1
        },
        C.prototype.remoteChanged = function() {
            this.dbms.getRemoteConnection().isLoggedIn() ? this.socket ? this.isAuthenticated && this.token == this.getSessionToken() || this.authenticate() : this.connect() : this.disconnect()
        },
        C.prototype.authenticate = function() {
            if (this.socket) {
                var e = this,
                    t = this.getSessionToken();
                e.isAuthenticated = !1,
                e.socket.emit("CLIENT.AUTHENTICATE", {
                    token: t
                }, (function(i) {
                    i ? console.log("MessageService.authenticate error", i) : (e.token = t, e.isAuthenticated = !0, e.user = e.dbms.getRemoteConnection().session.user.id, e.fetchMessages({
                        user: e.user
                    }))
                }))
            }
        },
        C.prototype.logout = function() {
            if (this.socket) {
                this.isAuthenticated = !1,
                this.token = null,
                this.user = null,
                this.trigger("logout"),
                this.socket.emit("CLIENT.LOGOUT", {}, (function(e) {
                    e && console.log("MessageService.logout err", e)
                }))
            }
        },
        C.prototype.getCappedMessages = function() {
            return this.messages.slice(0, this.capSize)
        },
        C.prototype.fetchMessages = function(e) {
            this.socket && (e.user ? (e = Object.assign({
                start: 0,
                limit: 5,
                sort: "createdAt",
                filter: {
                    readAt: null,
                    deletedAt: null
                }
            }, e), this.isAuthenticated && this.socket.emit("MESSAGE.FETCH", e)) : console.error("Not a valid criteria for fetching messages"))
        },
        C.prototype.messagesRecieved = function(e) {
            e.error ? console.warn("Could not fetch messages for user") : e.data.messages && e.data.messages.length && (this.messages = e.data.messages, this.trigger("messages", this.getCappedMessages()))
        },
        C.prototype.messageReceived = function(e) {
            this.messages.unshift(e),
            this.trigger("message", {
                message: e,
                latest: !0
            })
        },
        C.prototype.markMessageAsRead = function(e) {
            if (this.socket) {
                this.isAuthenticated && this.socket.emit("MESSAGE.READ", {
                    id: e
                })
            }
        },
        C.prototype.onMessageRead = function(e) {
            var t = this.getCappedMessages();
            if (this.isAuthenticated) {
                if (e.error)
                    return console.warn("Could not mark message " + i + " as read."), void this.trigger("removeMessageError");
                var i = e.data.messageId,
                    o = -1;
                if (T.each(this.messages, (function(e, t) {
                    e._id === i && (o = t)
                })), -1 !== o) {
                    this.messages.splice(o, 1);
                    var n = this.getCappedMessages(),
                        s = T.last(n),
                        a = T.last(t);
                    t.length === n.length && s._id !== a._id && this.trigger("message", {
                        message: s,
                        latest: !1
                    })
                }
            }
        },
        C.prototype.markMessageAsDeleted = function(e) {
            this.socket && this.isAuthenticated && this.socket.emit("MESSAGE.DELETE", {
                id: e
            })
        },
        C.prototype.sendMessage = function(e) {
            this.socket && this.isAuthenticated && this.socket.emit("MESSAGE.PUSH", e)
        },
        C.prototype.fetchConversations = function(e, t, i, o) {
            this.socket && this.isAuthenticated && this.socket.emit("CONVERSATION.FETCH", {
                user: e,
                start: t || 0,
                limit: i || 5,
                sort: o || "latestMessageAt"
            })
        },
        C.prototype.conversationsRecieved = function(e) {
            this.conversations = this.conversations.concat(e),
            this.trigger("conversations", e)
        };
        o("./node_modules/core-js/modules/es.string.replace.js");
        const k = schemas.RE_FILE_REF;
        function S(e) {
            this.connection = e;
            var t = NinoxDocumentInteraction.getUserDefault("nx.server");
            t ? this.baseURL = "https://" + t + e.path : e.host ? this.baseURL = (e.ssl ? "https://" : "http://") + e.host + (e.ssl ? 443 == e.port ? "" : ":" + e.port : 80 == e.port ? "" : ":" + e.port) + e.path : this.baseURL = e.path,
            /https?\:/.test(this.baseURL) ? this.absoluteBaseURL = this.baseURL : this.absoluteBaseURL = window.location.protocol + "//" + window.location.host + this.baseURL,
            this.dontShowErrors = !!e.dontShowErrors,
            this.reloginActive = !1,
            this.requestQueue = []
        }
        function E(e, t) {
            this.root = e,
            this.dbid = t,
            this.baseURL = e.baseURL + "/" + encodeURIComponent(t),
            this.fileModCount = Date.now()
        }
        S.prototype.getToken = function() {
            return dbms.getRemoteConnection().getToken()
        },
        S.prototype.getAuthorization = function() {
            var e = dbms.getRemoteConnection().getToken();
            return e ? "Bearer " + e : ""
        },
        S.prototype.getDBServer = function(e) {
            return new E(this, e)
        },
        S.prototype.loadDatabases = function(e) {
            this.GET(this.baseURL + "/root/databases/list", {}, e)
        },
        S.prototype.loadAccount = function(e) {
            this.GET(this.baseURL + "/root/account", {}, e)
        },
        S.prototype.createBackup = function(e, t) {
            this.POST(this.baseURL + "/" + encodeURIComponent(e.dbid) + "/createbackup", void 0, e, t)
        },
        S.prototype.listBackups = function(e) {
            this.GET(this.baseURL + "/root/backups/list", {}, e)
        },
        S.prototype.listSnapshots = function(e) {
            this.GET(this.baseURL + "/root/snapshots/list", {}, e)
        },
        S.prototype.restoreBackup = function(e, t) {
            this.POST(this.baseURL + "/root/backups/restore", void 0, {
                id: e
            }, t)
        },
        S.prototype.restoreSnapshot = function(e, t, i) {
            this.POST(this.baseURL + "/root/snapshots/restore", void 0, {
                dbid: e,
                timestamp: t
            }, i)
        },
        S.prototype.removeBackup = function(e, t) {
            this.POST(this.baseURL + "/root/backups/remove", void 0, {
                id: e
            }, t)
        },
        S.prototype.removeSnapshot = function(e, t, i) {
            this.POST(this.baseURL + "/root/snapshots/remove", void 0, {
                dbid: e,
                timestamp: t
            }, i)
        },
        S.prototype.downloadBackupURL = function(e, t) {
            return this.baseURL + "/root/backups/download/" + encodeURIComponent(t) + "?id=" + encodeURIComponent(e) + "&XT=" + encodeURIComponent(this.getToken())
        },
        S.prototype.createArchive = function(e, t) {
            this.POST(this.baseURL + "/" + encodeURIComponent(e.dbid) + "/createarchive", void 0, e, t)
        },
        S.prototype.listArchives = function(e) {
            this.GET(this.baseURL + "/root/databases/listarchives", {}, e)
        },
        S.prototype.removeArchive = function(e, t) {
            this.POST(this.baseURL + "/root/databases/removearchive", void 0, String(e), t)
        },
        S.prototype.downloadArchiveURL = function(e) {
            return this.baseURL + "/root/databases/downloadarchive/" + encodeURIComponent(e.name)
        },
        S.prototype.createDatabase = function(e, t) {
            this.POST(this.baseURL + "/root/databases/create", void 0, {
                dbname: e.dbname || e.name,
                icon: e.icon,
                color: e.color
            }, t)
        },
        S.prototype.exportArchiveURL = function(e) {
            return this.baseURL + "/" + encodeURIComponent(e) + "/exportarchive"
        },
        S.prototype.removeDatabase = function(e, t) {
            this.POST(this.baseURL + "/root/databases/remove", void 0, {
                dbid: e
            }, t)
        },
        S.prototype.loadArchive = function(e, t) {
            this.POST(this.baseURL + "/root/databases/loadarchive", void 0, e, t)
        },
        S.prototype.uploadArchive = function(e, t) {
            var i = this.baseURL + "/root/databases/uploadarchive",
                o = new FormData;
            o.append("name", e.name),
            o.append("file", e.file);
            var n = $.progress({
                    caption: "Uploading Archive File...",
                    cancel: function() {
                        s.abort()
                    }
                }),
                s = $.ajax({
                    url: i,
                    type: "POST",
                    headers: this.getHeaders(),
                    xhrFields: {
                        withCredentials: !0
                    },
                    xhr: function() {
                        var e = $.ajaxSettings.xhr();
                        return e.upload && e.upload.addEventListener("progress", a, !1), e
                    },
                    success: function(e) {
                        n.close();
                        try {
                            var i = JSON.parse(e);
                            t(void 0, i)
                        } catch (e) {
                            t(e)
                        }
                    },
                    error: function() {
                        n.close(),
                        t("Failed to upload archive.")
                    },
                    data: o,
                    cache: !1,
                    contentType: !1,
                    processData: !1
                });
            function a(e) {
                var t = e.loaded / e.total;
                n.update(t)
            }
        },
        S.prototype.updateSettings = function(e, t) {
            this.POST(this.baseURL + "/root/settings", void 0, e, t)
        },
        S.prototype.backgroundURL = function(e) {
            return this.baseURL + "/root/background.jpg?T=" + (e || 0)
        },
        S.prototype.deleteBackground = function(e) {
            this.DELETE(this.baseURL + "/root/clear-background", {}, e)
        },
        S.prototype.uploadBackground = function(e, t) {
            var i = this.baseURL + "/root/upload-background",
                o = new FormData;
            o.append("file", e.file);
            var n = $.progress({
                    caption: "Uploading Background Image...",
                    cancel: function() {
                        s.abort()
                    }
                }),
                s = $.ajax({
                    url: i,
                    type: "POST",
                    headers: this.getHeaders(),
                    xhrFields: {
                        withCredentials: !0
                    },
                    xhr: function() {
                        var e = $.ajaxSettings.xhr();
                        return e.upload && e.upload.addEventListener("progress", a, !1), e
                    },
                    success: function(e) {
                        n.close(),
                        t()
                    },
                    error: function() {
                        n.close(),
                        t("Failed to upload background image.")
                    },
                    data: o,
                    cache: !1,
                    contentType: !1,
                    processData: !1
                });
            function a(e) {
                var t = e.loaded / e.total;
                n.update(t)
            }
        },
        S.prototype.exportArchiveURL = function(e) {
            return this.baseURL + "/" + encodeURIComponent(e.dbid) + "/exportarchive?data=" + e.data + "&files=" + e.files + "&comments=" + e.comments + "&history=" + e.history + "&messages=" + e.messages
        },
        E.prototype.getHeaders = function() {
            return this.root.getHeaders()
        },
        E.prototype.uploadBackground = function(e, t) {
            var i = this.baseURL + "/files/background.jpg",
                o = new FormData;
            o.append("file", e.file);
            var n = $.progress({
                    caption: "Uploading Background File...",
                    cancel: function() {
                        s.abort()
                    }
                }),
                s = $.ajax({
                    url: i,
                    type: "POST",
                    headers: this.getHeaders(),
                    xhrFields: {
                        withCredentials: !0
                    },
                    xhr: function() {
                        var e = $.ajaxSettings.xhr();
                        return e.upload && e.upload.addEventListener("progress", a, !1), e
                    },
                    success: function(e) {
                        n.close();
                        try {
                            var i = JSON.parse(e);
                            t(void 0, i)
                        } catch (e) {
                            t(e)
                        }
                    },
                    error: function() {
                        n.close(),
                        t("Failed to upload image.")
                    },
                    data: o,
                    cache: !1,
                    contentType: !1,
                    processData: !1
                });
            function a(e) {
                var t = e.loaded / e.total;
                n.update(t)
            }
        },
        E.prototype.loadNodes = function(e, t, i) {
            this.root.POST(this.baseURL + "/json/nodes2", void 0, {
                nids: e,
                deps: t
            }, i)
        },
        E.prototype.sendCreate = function(e, t, i) {
            this.root.POST(this.baseURL + "/json/create2", void 0, {
                tid: e,
                values: t
            }, i)
        },
        E.prototype.sendRemove = function(e, t) {
            this.root.POST(this.baseURL + "/json/remove", void 0, [e], t)
        },
        E.prototype.sendRemoveAll = function(e, t) {
            this.root.POST(this.baseURL + "/json/remove", void 0, e, t)
        },
        E.prototype.sendUpdate = function(e, t, i, o) {
            this.root.POST(this.baseURL + "/json/update2", void 0, {
                nid: e,
                fid: t,
                val: i
            }, o)
        },
        E.prototype.sendUpdateNodes = function(e, t) {
            this.root.POST(this.baseURL + "/json/updatenodes", void 0, e, t)
        },
        E.prototype.sendDuplicate = function(e, t) {
            this.root.POST(this.baseURL + "/json/duplicate", void 0, {
                nid: e
            }, t)
        },
        E.prototype.sendFind = function(e, t, i) {
            this.root.POST(this.baseURL + "/json/find", void 0, {
                select: e,
                find: t
            }, i)
        },
        E.prototype.sendSelects = function(e, t) {
            this.root.POST(this.baseURL + "/json/selects", void 0, e, t)
        },
        E.prototype.loadCalendar = function(e, t, i) {
            this.root.POST(this.baseURL + "/json/calendar", void 0, {
                start: e,
                end: t
            }, i)
        },
        E.prototype.loadComments = function(e, t) {
            this.root.POST(this.baseURL + "/json/comments", void 0, {
                nid: e
            }, t)
        },
        E.prototype.postComment = function(e, t, i, o) {
            this.root.POST(this.baseURL + "/json/comment", void 0, {
                nid: e,
                cid: t,
                comment: i
            }, o)
        },
        E.prototype.removeComment = function(e, t, i) {
            this.root.POST(this.baseURL + "/json/removecomment", void 0, {
                nid: e,
                cid: t
            }, i)
        },
        E.prototype.loadFiles = function(e, t) {
            this.root.POST(this.baseURL + "/json/files", void 0, {
                nid: e
            }, t)
        },
        E.prototype.removeFile = function(e, t, i) {
            this.root.POST(this.baseURL + "/files/remove", void 0, {
                nid: e,
                file: t
            }, i)
        },
        E.prototype.previewURL = function(e, t) {
            if (t)
                return this.baseURL + "/files/preview/" + encodeURIComponent(e) + "/" + encodeURIComponent(t) + "?T=" + this.fileModCount + "&XT=" + encodeURIComponent(this.getToken())
        },
        E.prototype.thumbURL1 = function(e) {
            if (e) {
                var t = k.exec(e);
                if (t) {
                    var i = t[1],
                        o = t[2],
                        n = t[3];
                    return this.baseURL + "/files/preview/" + encodeURIComponent(i + o) + "/" + encodeURIComponent(n) + "?T=" + this.fileModCount + "&XT=" + encodeURIComponent(this.getToken())
                }
            }
        },
        E.prototype.thumbURL2 = function(e, t) {
            if (t)
                return this.baseURL + "/files/preview/" + encodeURIComponent(e) + "/" + encodeURIComponent(t) + "?T=" + this.fileModCount + "&XT=" + encodeURIComponent(this.getToken())
        },
        E.prototype.thumb2URL1 = function(e) {
            if (e) {
                var t = k.exec(e);
                if (t) {
                    var i = t[1],
                        o = t[2],
                        n = t[3];
                    return this.baseURL + "/files/preview/" + encodeURIComponent(i + o) + "/" + encodeURIComponent(n) + "?T=" + this.fileModCount + "&XT=" + encodeURIComponent(this.getToken())
                }
            }
        },
        E.prototype.thumb2URL2 = function(e, t) {
            if (t)
                return this.baseURL + "/files/preview/" + encodeURIComponent(e) + "/" + encodeURIComponent(t) + "?T=" + this.fileModCount + "&XT=" + encodeURIComponent(this.getToken())
        },
        E.prototype.fileURL1 = function(e) {
            if (e) {
                var t = k.exec(e);
                if (t) {
                    var i = t[1],
                        o = t[2],
                        n = t[3];
                    return this.baseURL + "/files/download/" + encodeURIComponent(i + o) + "/" + encodeURIComponent(n) + "?T=" + this.fileModCount + "&XT=" + encodeURIComponent(this.getToken())
                }
            }
        },
        E.prototype.fileURL2 = function(e, t) {
            if (t)
                return this.baseURL + "/files/download/" + encodeURIComponent(e) + "/" + encodeURIComponent(t) + "?T=" + this.fileModCount + "&XT=" + encodeURIComponent(this.getToken())
        },
        E.prototype.downloadURL = function(e, t) {
            if (t)
                return this.baseURL + "/files/download/" + encodeURIComponent(e) + "/" + encodeURIComponent(t) + "?T=" + this.fileModCount + "&XT=" + encodeURIComponent(this.getToken())
        },
        E.prototype.uploadURL = function(e) {
            return this.baseURL + "/files/upload?nid=" + encodeURIComponent(e)
        },
        E.prototype.loadHistory = function(e) {
            this.root.GET(this.baseURL + "/json/history", void 0, e)
        },
        E.prototype.loadNodeHistory = function(e, t) {
            this.root.POST(this.baseURL + "/json/history", void 0, {
                nid: e
            }, t)
        },
        E.prototype.loadViews = function(e) {
            this.root.GET(this.baseURL + "/json/views/list", void 0, e)
        },
        E.prototype.saveView = function(e, t) {
            this.root.POST(this.baseURL + "/json/views/update", void 0, e, t)
        },
        E.prototype.removeView = function(e, t) {
            this.root.POST(this.baseURL + "/json/views/remove", void 0, e, t)
        },
        E.prototype.loadBootstrap = function(e) {
            this.root.GET(this.baseURL + "/json/bootstrap", void 0, (function(t, i) {
                if (t)
                    return e(t);
                e(void 0, i)
            }))
        },
        E.prototype.loadChanges = function(e, t) {
            this.root.POST(this.baseURL + "/json/changes", {
                $timeout: 4e4
            }, {
                since: e || 0
            }, t)
        },
        E.prototype.sendUpdateSchema = function(e, t) {
            this.root.POST(this.baseURL + "/json/updateschema", void 0, e, t)
        },
        E.prototype.sendPatchSchema = function(e, t) {
            this.root.POST(this.baseURL + "/json/patchschema", void 0, e, t)
        },
        E.prototype.reindex = function(e) {
            this.root.POST(this.baseURL + "/json/reindex", void 0, void 0, e)
        },
        E.prototype.reIndexFiles = function(e) {
            this.root.POST(this.baseURL + "/json/reindex-files", void 0, void 0, e)
        },
        E.prototype.rebuildThumbs = function(e) {
            this.root.POST(this.baseURL + "/json/rebuild-thumbs", void 0, void 0, e)
        },
        E.prototype.clearHistory = function(e) {
            this.root.POST(this.baseURL + "/json/clearhistory", void 0, void 0, e)
        },
        E.prototype.setBackground = function(e, t) {
            this.root.POST(this.baseURL + "/settings/background-class", void 0, e, t)
        },
        E.prototype.backgroundURL = function(e) {
            return this.baseURL + "/files/background.jpg" + (e ? "?_refresh=" + Math.floor(1e6 * Math.random()) : "")
        },
        E.prototype.updateSettings = function(e, t) {
            this.root.POST(this.baseURL + "/settings/update", void 0, e, t)
        },
        E.prototype.listReports = function(e) {
            this.root.GET(this.baseURL + "/reports/list", void 0, e)
        },
        E.prototype.updateReport = function(e, t) {
            this.root.POST(this.baseURL + "/reports/update", void 0, e, t)
        },
        E.prototype.removeReport = function(e, t) {
            this.root.POST(this.baseURL + "/reports/remove", void 0, {
                reportId: e
            }, t)
        },
        E.prototype.removeReportFile = function(e, t, i) {
            this.root.POST(this.baseURL + "/reports/removeFile", void 0, {
                reportId: e,
                file: t
            }, i)
        },
        E.prototype.cleanReportFiles = function(e, t, i) {
            this.root.POST(this.baseURL + "/reports/cleanFiles", void 0, {
                reportId: e,
                retain: t
            }, i)
        },
        E.prototype.copyReportFiles = function(e, t, i) {
            this.root.POST(this.baseURL + "/reports/copyFiles", void 0, {
                sourceId: e,
                targetId: t
            }, i)
        },
        E.prototype.reportFileURL = function(e, t) {
            return this.baseURL + "/reports/file?report=" + encodeURIComponent(e) + "&file=" + encodeURIComponent(t) + "&XT=" + encodeURIComponent(this.getToken())
        },
        E.prototype.importReportFile = function(e, t, i) {
            var o = this,
                n = /\.([a-zA-Z0-9]+)$/.exec(t.name);
            if (!n)
                return i("Invalid file name: " + t.name);
            var s = n[1],
                a = util.createLowerUUID(12) + "." + s,
                r = new FormData;
            r.append("file", t);
            var l = $.progress({
                    caption: "Uploading File...",
                    cancel: function() {
                        c.abort()
                    }
                }),
                c = $.ajax({
                    url: this.baseURL + "/reports/uploadFile?report=" + encodeURIComponent(e) + "&file=" + encodeURIComponent(a),
                    type: "POST",
                    headers: this.getHeaders(),
                    xhrFields: {
                        withCredentials: !0
                    },
                    xhr: function() {
                        var e = $.ajaxSettings.xhr();
                        return e.upload && e.upload.addEventListener("progress", d, !1), e
                    },
                    success: function() {
                        o.fileModCount++,
                        l.close(),
                        i(void 0, a)
                    },
                    error: function() {
                        o.fileModCount++,
                        l.close(),
                        i("Failed to upload image")
                    },
                    data: r,
                    cache: !1,
                    contentType: !1,
                    processData: !1
                });
            function d(e) {
                var t = e.loaded / e.total;
                l.update(t)
            }
        },
        E.prototype.importFile = function(e, t, i, o) {
            "function" == typeof i && (o = i, i = void 0),
            null == i && (i = (t.renameTo ? t.renameTo : t.name) || "unnamed"),
            i = i.normalize("NFC");
            var n = this,
                s = new FormData;
            i ? s.append("file", t, i) : s.append("file", t);
            var a = $.progress({
                    caption: "Uploading File...",
                    cancel: function() {
                        r.abort()
                    }
                }),
                r = $.ajax({
                    url: this.baseURL + "/files/upload?nid=" + encodeURIComponent(e) + (t.renameTo ? "&renameTo=" + encodeURIComponent(t.renameTo) : ""),
                    type: "POST",
                    headers: this.getHeaders(),
                    xhrFields: {
                        withCredentials: !0
                    },
                    xhr: function() {
                        var e = $.ajaxSettings.xhr();
                        return e.upload && e.upload.addEventListener("progress", l, !1), e
                    },
                    success: function() {
                        n.fileModCount++,
                        a.close(),
                        o(void 0, i || t.renameTo || t.name)
                    },
                    error: function() {
                        n.fileModCount++,
                        a.close(),
                        o("Failed to upload file")
                    },
                    data: s,
                    cache: !1,
                    contentType: !1,
                    processData: !1
                });
            function l(e) {
                var t = e.loaded / e.total;
                a.update(t)
            }
        },
        E.prototype.importFileFromURL = function(e, t, i, o) {
            this.fileModCount++,
            this.root.POST(this.baseURL + "/files/import", void 0, {
                nid: e,
                url: t,
                name: i
            }, o)
        },
        E.prototype.renameFile = function(e, t, i, o) {
            this.fileModCount++,
            this.root.POST(this.baseURL + "/files/rename", void 0, {
                nid: e,
                name: t,
                name2: i
            }, o)
        },
        E.prototype.saveFileURL = function(e, t, i) {
            return this.root.baseURL + "/root/savefile?name=" + encodeURIComponent(e) + "&ct=" + encodeURIComponent(t) + (i ? "&isBase64=true" : "") + "&XT=" + encodeURIComponent(this.getToken())
        },
        E.prototype.loadFileURL = function(e, t, i, o) {
            return this.root.absoluteBaseURL + "/root/loadfile/" + encodeURIComponent(t) + "?id=" + encodeURIComponent(e) + "&ct=" + encodeURIComponent(i) + (o ? "&download=1" : "") + "&t=" + Date.now() + "&XT=" + encodeURIComponent(this.getToken())
        },
        E.prototype.printSimple = function(e, t) {
            this.root.POST(this.baseURL + "/print/print-simple", void 0, e, t)
        },
        E.prototype.printRich = function(e, t) {
            this.root.POST(this.baseURL + "/print/print-rich", void 0, e, t)
        },
        E.prototype.syncEvents = function(e, t) {
            this.root.GET(this.baseURL + "/sync/events/" + e, {}, t)
        },
        E.prototype.syncInit = function(e) {
            this.root.GET(this.baseURL + "/sync/init", {
                $showProgress: !0,
                $showProgressTitle: "Loading data..."
            }, e)
        },
        E.prototype.syncPull = function(e, t) {
            this.root.GET(this.baseURL + "/sync/pull2/" + e, {}, t)
        },
        E.prototype.syncPush = function(e, t, i) {
            this.root.POST(this.baseURL + "/sync/push/" + e, void 0, t, i)
        },
        E.prototype.getToken = function() {
            return this.root.getToken()
        },
        E.prototype.getAuthorization = function() {
            return this.root.getAuthorization()
        },
        E.prototype.evaluateOnServer = function(e, t, i) {
            this.root.POST(this.baseURL + "/json/evaluate", void 0, {
                nid: e,
                exp: t.toString()
            }, i)
        },
        E.prototype.sendEmail = function(e, t) {
            this.root.POST(this.baseURL + "/services/sendemail", void 0, e, t)
        },
        E.prototype.shareFile = function(e, t, i) {
            this.root.POST(this.baseURL + "/share/file", void 0, {
                nid: e,
                file: t
            }, i)
        },
        E.prototype.unshareFile = function(e, t, i) {
            this.root.DELETE(this.baseURL + "/share/file/" + encodeURIComponent(e) + "/" + encodeURIComponent(t), {}, i)
        },
        E.prototype.loadSharedFile = function(e, t, i) {
            this.root.GET(this.baseURL + "/share/file/" + encodeURIComponent(e) + "/" + encodeURIComponent(t), {}, i)
        },
        E.prototype.shareView = function(e, t, i) {
            this.root.POST(this.baseURL + "/share/view", void 0, {
                viewid: e,
                options: t
            }, i)
        },
        E.prototype.unshareView = function(e, t) {
            this.root.DELETE(this.baseURL + "/share/view/" + encodeURIComponent(e), {}, t)
        },
        E.prototype.loadSharedView = function(e, t) {
            this.root.GET(this.baseURL + "/share/view/" + encodeURIComponent(e), {}, t)
        },
        E.prototype.exportSchemaURL = function() {
            return this.baseURL + "/exportschema"
        },
        E.prototype.importSchema = function(e, t) {
            this.root.POST(this.baseURL + "/importschema", void 0, e, t)
        },
        S.prototype.request = function(e, t, i, o, n) {
            var s = this,
                a = !1,
                r = null;
            if (s.reloginActive)
                s.requestQueue.push([e, t, i, o, n]);
            else {
                var l = void 0;
                if (i) {
                    i.contentType && (l = i.contentType),
                    i.$showProgress && (a = !0);
                    var c = !0;
                    for (var d in i)
                        if (i.hasOwnProperty(d) && "contentType" !== d && "$" !== d[0]) {
                            var h = i[d];
                            null != h && (t += (c ? "?" : "&") + d + "=" + encodeURIComponent(String(h)), c = !1)
                        }
                }
                a && (r = $.progress({
                    caption: i.$showProgressTitle,
                    cancel: function() {
                        p.abort()
                    }
                }));
                var p = $.ajax({
                    type: e,
                    url: t,
                    headers: this.getHeaders(),
                    data: null == o ? void 0 : l ? o : JSON.stringify(o),
                    processData: !1,
                    contentType: null == o ? void 0 : l || "text/plain",
                    timeout: i ? i.$timeout : void 0,
                    xhrFields: {
                        withCredentials: !0
                    },
                    xhr: function() {
                        var e = $.ajaxSettings.xhr();
                        return a && e.upload && e.upload.addEventListener("progress", u, !1), e
                    },
                    success: function(e, t, i) {
                        if (r && r.close(), e) {
                            var o,
                                s = null;
                            try {
                                e = e.replace(/((?:\\\\)*(?:[^\\]))\\u0000/g, "$1"),
                                o = JSON.parse(e)
                            } catch (e) {
                                s = e
                            }
                            n(s, o)
                        } else
                            n(void 0, void 0)
                    },
                    error: function(a, l, c) {
                        if (r && r.close(), 401 === a.status)
                            s.requestQueue.push([e, t, i, o, n]),
                            s.relogin();
                        else {
                            var d = a.responseText || locale.errorServerNotResponding;
                            T.isArray(d) && (d = 0 === d.length ? locale.unknowError : d.join(", ")),
                            s.dontShowErrors || log(d),
                            n(d)
                        }
                    }
                })
            }
            function u(e) {
                var t = e.loaded / e.total;
                r.update(t)
            }
        },
        S.prototype.GET = function(e, t, i) {
            this.request("GET", e, t, void 0, i)
        },
        S.prototype.POST = function(e, t, i, o) {
            this.request("POST", e, t, i, o)
        },
        S.prototype.PUT = function(e, t, i, o) {
            this.request("PUT", e, t, i, o)
        },
        S.prototype.DELETE = function(e, t, i) {
            this.request("DELETE", e, t, void 0, i)
        },
        S.prototype.relogin = function() {
            var e = this;
            function t() {
                dbms.getRemoteConnection().relogin(i)
            }
            function i(i) {
                i ? (e.reloginActive = !1, setTimeout((function() {
                    e.rerequest()
                }), 0)) : setTimeout(t, 0)
            }
            e.reloginActive || (e.reloginActive = !0, setTimeout(t, 0))
        },
        S.prototype.rerequest = function() {
            var e = this.requestQueue;
            this.requestQueue = [];
            for (var t = 0; t < e.length; t++) {
                var i = e[t];
                this.request.apply(this, i)
            }
        },
        S.prototype.getHeaders = function() {
            var e = dbms.getRemoteConnection().getToken();
            return {
                authorization: e ? "Bearer " + e : void 0
            }
        };
        var _ = o("./src/js/client/RemoteDB.js");
        function D(e, t) {
            this.dbms = e,
            this.id = t.id,
            this.name = t.name,
            this.settings = {},
            this.databases = {},
            this.isSyncInProgress = !1,
            this._syncCallbacks = [],
            this.isCacheLoaded = !1;
            var i = dbms.getRemoteConnection().getAccount(this.id);
            if (i) {
                var o = i.host,
                    n = i.port,
                    s = !1 !== i.ssl,
                    a = "/" + this.id;
                n || (n = s ? 443 : 80),
                this.server = new S({
                    host: o,
                    port: n,
                    path: a,
                    ssl: s,
                    dontShowErrors: !0
                })
            }
        }
        Object.assign(D.prototype, util.events),
        D.prototype.base = "remote",
        D.prototype.drop = function() {},
        D.prototype.save = function() {},
        D.prototype.update = function(e) {
            this.name = e.name
        },
        D.prototype.listDatabases = function() {
            return T.filter(util.localeSortBy(this.databases, "name"), (function(e) {
                return e.isOpenable
            }))
        },
        D.prototype.getDatabaseNames = function() {
            var e = {},
                t = this.databases;
            for (var i in t) {
                if (t.hasOwnProperty(i))
                    e[t[i].name] = !0
            }
            return e
        },
        D.prototype.getDatabase = function(e) {
            return this.databases[e]
        },
        D.prototype.ensureDatabase = function(e, t) {
            var i = this,
                o = i.databases[e];
            if (o)
                return t(void 0, o);
            i.sync(!1, (function() {
                var o = i.databases[e];
                t(void 0, o)
            }))
        },
        D.prototype.resetSync = function(e) {},
        D.prototype.loadRemoteAccount = function(e) {
            return NinoxDocumentInteraction.isOnline() ? dbms.getRemoteConnection().getToken() ? void this.server.loadAccount(e) : e("NOT_SIGNED_ID") : e("OFFLINE")
        },
        D.prototype._callSyncCallbacks = function() {
            console.log("AccountRemote._callSyncCallbacks", this._syncCallbacks.length);
            var e = this._syncCallbacks;
            this._syncCallbacks = [];
            for (var t = 0; t < e.length; t++)
                setTimeout(e[t], 0)
        },
        D.prototype.sync = function(e, t) {
            var i = this;
            if (t && i._syncCallbacks.push(t), !i.isSyncInProgress) {
                i.isSyncInProgress = !0;
                var o = dbms.getRemoteConnection().getAccount(this.id);
                if (o && (i.name = o.name), !i.isCacheLoaded) {
                    i.isCacheLoaded = !0;
                    var n = null,
                        s = window.localStorage && window.localStorage["account." + i.id];
                    if (s)
                        try {
                            n = JSON.parse(s)
                        } catch (e) {
                            console.log("Failed to parse cached account", e)
                        }
                    if (n) {
                        i.settings = n.settings || {};
                        for (var a = n.databases || [], r = {}, l = 0; l < a.length; l++) {
                            var c = a[l],
                                d = c.id;
                            c.isOpenable = i.canOpenDatabase(c),
                            c.account = i.id,
                            c.isStored = !0,
                            r[d] = c
                        }
                        i.databases = r
                    } else
                        console.log("No cached account")
                }
                i.trigger("change"),
                i.loadRemoteAccount((function(e, t) {
                    if (e)
                        $.alert(e);
                    else if (t) {
                        window.localStorage && (window.localStorage["account." + i.id] = JSON.stringify(t)),
                        i.settings = t.settings || {};
                        for (var o = t.databases || [], n = {}, s = 0; s < o.length; s++) {
                            var a = o[s],
                                r = a.id;
                            a.isOpenable = i.canOpenDatabase(a),
                            a.account = i.id,
                            a.isStored = !0,
                            n[r] = a
                        }
                        i.databases = n
                    }
                    i.isSyncInProgress = !1,
                    i.trigger("change"),
                    i._callSyncCallbacks()
                }))
            }
        },
        D.prototype.removeStoredDatabase = function(e) {},
        D.prototype.canOpenDatabase = function(e) {
            var t = e.settings;
            if (!t)
                return !0;
            var i = t.rolesOpen;
            if (!i || !i.length)
                return !0;
            var o = dbms.getRemoteConnection().getCurrentAccountUser(this.id);
            if (o.roles.admin)
                return !0;
            for (var n = 0; n < i.length; n++) {
                var s = i[n];
                if (o.roles[s])
                    return !0
            }
            return !1
        },
        D.prototype.openDatabase = function(e, t) {
            if ("string" == typeof e) {
                var i = e;
                if (!(e = this.databases[i]))
                    return t("Database not found: " + i + " in account " + this.id)
            }
            if (!this.canOpenDatabase(e))
                return t("Not authorized.");
            var o = this.server.getDBServer(e.id),
                n = new _.a(e, this, o);
            n.openDatabase(!1, (function(e) {
                if (e)
                    return t(e);
                window.database = n,
                t(void 0, n)
            }))
        },
        D.prototype.openAnotherDatabase = function(e, t) {
            var i = this.databases[e];
            if (!i)
                return t("Database not found: " + e);
            if (!this.canOpenDatabase(i))
                return t("Not authorized.");
            var o = this.server.getDBServer(i.id),
                n = new _.a(i, this, o);
            n.openDatabase(!0, (function(e) {
                if (e)
                    return t(e);
                t(void 0, n)
            }))
        },
        D.prototype.createDatabase = function(e, t) {
            var i = this;
            i.server.createDatabase(e, (function(e, o) {
                i.sync(),
                t(e, o)
            }))
        },
        D.prototype.renameDatabase = function(e, t, i) {
            var o = this;
            o.server.getDBServer(e.id).updateSettings(t, (function(e, t) {
                o.sync(),
                i(e, t)
            }))
        },
        D.prototype.removeDatabase = function(e, t) {
            var i = this;
            i.server.removeDatabase(e.id, (function(o) {
                o || (delete i.databases[e.id], i.trigger("change")),
                t(o)
            }))
        },
        D.prototype.duplicateDatabase = function() {},
        D.prototype.isAdmin = function() {
            return dbms.getRemoteConnection().isAdmin(this.id)
        },
        D.prototype.loadArchive = function(e, t) {
            var i = this;
            i.server.loadArchive(e, (function(e, o) {
                i.sync(),
                t(e, o)
            }))
        },
        D.prototype.getRoles = function() {
            return dbms.getRemoteConnection().getSessionInfo().getRoles(this.id)
        },
        D.prototype.createBackup = function(e, t) {
            this.server.createBackup(e, t)
        },
        D.prototype.listBackups = function(e) {
            this.server.listBackups(e)
        },
        D.prototype.listSnapshots = function(e) {
            this.server.listSnapshots(e)
        },
        D.prototype.removeBackup = function(e, t) {
            this.server.removeBackup(e, t)
        },
        D.prototype.removeSnapshot = function(e, t, i) {
            this.server.removeSnapshot(e, t, i)
        },
        D.prototype.restoreBackup = function(e, t) {
            var i = this;
            i.server.restoreBackup(e, (function(e) {
                i.sync(),
                t(e)
            }))
        },
        D.prototype.restoreSnapshot = function(e, t, i) {
            var o = this;
            o.server.restoreSnapshot(e, t, (function(e) {
                o.sync(!0),
                i(e)
            }))
        },
        D.prototype.downloadBackupURL = function(e, t) {
            return this.server.downloadBackupURL(e, t)
        },
        D.prototype.backgroundURL = function() {
            return this.server ? this.server.backgroundURL(this.settings.backgroundTimestamp || 0) : void 0
        },
        D.prototype.isOwner = function() {
            var e = dbms.getRemoteConnection();
            return e.getAccount(this.id).owner === e.getUserId()
        },
        D.prototype.getPlan = function() {
            return dbms.getRemoteConnection().getSessionInfo().getPlan()
        },
        D.prototype.getInvitations = function() {
            return dbms.getRemoteConnection().listInvitations(this.id)
        },
        D.prototype.getMembers = function() {
            return dbms.getRemoteConnection().listAccountUsers(this.id)
        },
        D.prototype.getOwnerId = function() {
            return dbms.getRemoteConnection().getAccount(this.id).owner
        },
        D.prototype.getCurrentUser = function() {
            return dbms.getRemoteConnection().getCurrentUser()
        },
        D.prototype.getCurrentUserId = function() {
            const e = this.getCurrentUser();
            return e ? e.id : void 0
        },
        D.prototype.isRootUser = function() {
            return dbms.getRemoteConnection().getSessionInfo().user.isRoot
        };
        function M() {
            this.localAccount = null,
            this.remoteAccounts = {}
        }
        Object.assign(M.prototype, util.events),
        M.prototype.bootstrap = async function(e) {
            try {
                var t = this;
                this.remote = new w,
                this.messageService = new C(this),
                this.remoteAccounts = {}
            } catch (t) {
                return console.log(t), e(t)
            }
            dbms.getRemoteConnection().refresh((function(i) {
                t.syncAccounts((function() {
                    t.fasttrackOnboarding((function() {
                        t.remote.on("change", $.proxy(t.remoteChanged, t)),
                        e()
                    }))
                }))
            }), !0)
        },
        M.prototype.fasttrackOnboarding = function(e) {
            var t = this.listAccounts();
            if (1 !== t.length)
                return e();
            var i = t[0];
            console.log("fasttrack 0"),
            i.sync(!1, e)
        },
        M.prototype.getRemoteConnection = function() {
            return this.remote
        },
        M.prototype.listAccounts = function() {
            return util.localeSortBy(this.remoteAccounts, "name")
        },
        M.prototype.getRemoteAccounts = function() {
            return this.remoteAccounts
        },
        M.prototype.getLocalAccount = function() {
            return this.localAccount
        },
        M.prototype.getDefaultAccount = function() {
            return this.listAccounts()[0]
        },
        M.prototype.getDefaultAccountId = function() {
            var e = this.listAccounts()[0];
            return e ? e.id : void 0
        },
        M.prototype.getAccount = function(e) {
            return "local" === e ? this.localAccount : this.remoteAccounts[e]
        },
        M.prototype.getRemoteAccount = function(e) {
            return this.remoteAccounts[e]
        },
        M.prototype.syncAccounts = function(e) {
            var t,
                i = this.remoteAccounts,
                o = this.remote.getAccounts();
            if (o) {
                for (t in i) {
                    if (!o.hasOwnProperty(t))
                        i[t].drop(),
                        delete i[t]
                }
                for (t in o)
                    if (o.hasOwnProperty(t)) {
                        var n = i[t],
                            s = o[t];
                        n ? n.update(s) : ((n = new D(this, s)).save(), i[t] = n)
                    }
            }
            e && e()
        },
        M.prototype.remoteChanged = function() {
            var e = this;
            e.syncAccounts((function() {
                e.trigger("change")
            }))
        },
        M.prototype.closeDatabase = function(e) {
            window.database ? window.database.closeDatabase((function() {
                window.database = null,
                e()
            })) : e()
        },
        M.prototype.getAllDatabases = function() {
            var e = [],
                t = this.remoteAccounts;
            for (var i in t)
                if (t.hasOwnProperty(i)) {
                    var o = t[i];
                    e = e.concat(o.listDatabases())
                }
            return e
        },
        M.prototype.getLocalDatabases = function() {
            return []
        },
        M.prototype.openAnotherDatabase = function(e, t, i) {
            var o;
            if (!(o = "local" === e ? this.localAccount : this.remoteAccounts[e]))
                return i("Account not found: " + e);
            o.openAnotherDatabase(t, i)
        };
        var N = o("./src/js/printer/printNode.js"),
            I = o("./src/js/printer/printTable.js"),
            O = o("./src/js/printer/renderNodeHTML.js"),
            R = o("./src/js/printer/renderTableHTML.js");
        function j(e) {
            return ""
        }
        function L(e) {
            switch (e.base) {
            case "number":
            case "nid":
                return "right";
            case "date":
            case "datx":
            case "time":
            case "appointment":
            case "timeinterval":
            case "boolean":
                return "center";
            default:
                return "left"
            }
        }
        var F = o("./src/js/reports/ActionMenu.js"),
            A = o("./src/js/reports/Designer.jsx"),
            H = o("./src/js/reports/RDHTML.js"),
            P = o("./src/js/reports/RDImage.js"),
            U = o("./src/js/reports/RDImageField.js"),
            z = o("./src/js/reports/RDObject.js"),
            V = o("./src/js/reports/RDReverse.js"),
            W = o("./src/js/reports/RDText.js"),
            B = o("./src/js/reports/ColorMenu.js"),
            q = o("./src/js/reports/ObjectMenu.js"),
            Y = o("./src/js/reports/PaperMenu.js"),
            X = o("./src/js/reports/TextMenu.js");
        o("./src/react/views/BrowserNotSupportedView.scss");
        const G = () => {
            const e = Object(b.getLocale)();
            return a.createElement(a.Fragment, null, a.createElement("div", {
                className: "root"
            }, a.createElement("div", {
                className: "root-controls"
            }), a.createElement("div", {
                className: "root-body browser-support-page"
            }, a.createElement("div", {
                className: "caption"
            }, e.browserUnsupported), a.createElement("div", {
                className: "subheader"
            }, e.supportedBrowsers), a.createElement("div", {
                className: "browser-links"
            }, a.createElement("a", {
                href: "https://www.google.com/chrome/",
                className: "browser-link chrome"
            }, "Chrome"), a.createElement("a", {
                href: "https://support.apple.com/downloads/safari",
                className: "browser-link safari"
            }, "Safari"), a.createElement("a", {
                href: "https://www.microsoft.com/edge",
                className: "browser-link edge"
            }, "Edge"), a.createElement("a", {
                href: "https://www.mozilla.org/firefox/new/",
                className: "browser-link firefox"
            }, "Firefox")))))
        };
        o("./node_modules/core-js/modules/web.immediate.js");
        var J = o("./node_modules/@babel/runtime/helpers/defineProperty.js"),
            K = o.n(J),
            Q = (o("./node_modules/react-swipeable-views/lib/index.js"), o("./src/react/FeatureHighlightSlides.css"), o("./node_modules/assert-never/index.js")),
            Z = o.n(Q),
            ee = (o("./src/react/ToggleComponent.css"), o("./src/react/util/FastClickContainer.tsx"));
        function te(e, t) {
            var i = Object.keys(e);
            if (Object.getOwnPropertySymbols) {
                var o = Object.getOwnPropertySymbols(e);
                t && (o = o.filter((function(t) {
                    return Object.getOwnPropertyDescriptor(e, t).enumerable
                }))),
                i.push.apply(i, o)
            }
            return i
        }
        function ie(e) {
            for (var t = 1; t < arguments.length; t++) {
                var i = null != arguments[t] ? arguments[t] : {};
                t % 2 ? te(Object(i), !0).forEach((function(t) {
                    K()(e, t, i[t])
                })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(i)) : te(Object(i)).forEach((function(t) {
                    Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(i, t))
                }))
            }
            return e
        }
        let oe;
        oe || (oe = {});
        class ne extends a.Component {
            constructor(e)
            {
                super(e),
                this.state = {
                    isOn: this.props.defaultValue
                }
            }
            render()
            {
                switch (this.props.options.type) {
                case "CHECKBOX":
                case "SLIDING_TOGGLE":
                    return a.createElement(ee.a, {
                        onFastClick: () => this.setState(e => ie({}, e, {
                            isOn: !e.isOn
                        }), () => this.props.onChange(this.state.isOn)),
                        className: this.getRootClass()
                    }, this.getBody());
                default:
                    return Z()(this.props.options)
                }
            }
            getRootClass()
            {
                switch (this.props.options.type) {
                case "CHECKBOX":
                    return "ToggleComponent_checkbox";
                case "SLIDING_TOGGLE":
                    return "ToggleComponent_switch";
                default:
                    return Z()(this.props.options)
                }
            }
            getBody()
            {
                switch (this.props.options.type) {
                case "CHECKBOX":
                    return a.createElement(a.Fragment, null, a.createElement("div", {
                        className: "ToggleComponent_checkContainer"
                    }, a.createElement("div", {
                        className: "ToggleComponent_check " + (this.state.isOn ? "ToggleComponent_checkOn" : "")
                    }, this.state.isOn ? a.createElement(a.Fragment, null, a.createElement("div", {
                        className: "ToggleComponent_checkKick"
                    }), a.createElement("div", {
                        className: "ToggleComponent_checkStem"
                    })) : null), a.createElement("p", {
                        className: "ToggleComponent_label"
                    }, this.props.options.label)));
                case "SLIDING_TOGGLE":
                    return a.createElement("div", {
                        className: "ToggleComponent_slide " + (this.state.isOn ? "ToggleComponent_slideChecked" : "")
                    });
                default:
                    return Z()(this.props.options)
                }
            }
        }
        a.Component;
        function se(e) {
            this.messageService = e,
            this.renderers = {
                HTML: $.proxy(this.renderHTML, this)
            },
            this.capSize = 2,
            this.messageInDisplay = null,
            this.messageMaxHeight = 471,
            this.messagePreviewHeight = 90,
            this.$el = $('<div class="messages" style="display:none">').appendTo(document.body),
            this.$list = $('<div class="messages-list">').appendTo(this.$el),
            e.on("logout", $.proxy(this.hideMessageList, this, !0)),
            e.on("messages", $.proxy(this.onMessages, this)),
            e.on("message", $.proxy(this.onMessage, this)),
            e.on("removeMessageError", $.proxy(this.removeMessageError, this))
        }
        se.prototype.onMessages = function(e, t) {
            var i = this;
            t.length ? (i.$list.empty(), T.each(t, (function(e) {
                i.renderMessage(e)
            }))) : i.hideMessageList(!0)
        },
        se.prototype.onMessage = function(e, t) {
            var i,
                o = this,
                n = t.message,
                s = t.latest,
                a = o.$list.children().length === o.capSize;
            s && a && (i = o.$list.find(".messages-message-container").last(), o.messageInDisplay || i.removeClass("fadein").toggleClass("fadeout").toggle(100), setTimeout((function() {
                i.remove()
            }), 100)),
            o.renderMessage(n, s)
        },
        se.prototype.renderMessage = function(e, t) {
            t = t || !1;
            e.type ? this.renderers[e.type] ? this.renderers[e.type](e, t) : console.warn(e.type + " type messages cannot be rendered yet") : console.warn("Message data does not have a type attribute to proceed with")
        },
        se.prototype.show = function() {
            this.$el.css("display", "")
        },
        se.prototype.markMessageAsRead = function(e) {
            this.messageService.markMessageAsRead(e),
            this.removeMessage(e)
        },
        se.prototype.hideMessageList = function(e) {
            e && this.$list.empty(),
            this.$list.children().length || this.$el.css("display", "none")
        },
        se.prototype.messageContainer = function(e, t) {
            var i = e(),
                o = i.messageWrapper,
                n = i.controls,
                s = $('<span class="messages-message-container-utils-link">').text(locale.showMore),
                a = $('<div class="messages-message-container-utils">').append(s),
                r = $('<div class="messages-message-container-inner">').append(n).append(o).append(a),
                l = $('<div class="messages-message-container drawer-rev" id="' + t + '">').append(r);
            return s.touch($.proxy(this.toggleMessageState, this, t)), {
                messageContainer: l,
                utils: a
            }
        },
        se.prototype.renderHTML = function(e, t) {
            if ("string" == typeof e.message) {
                var i = $('<span class="messages-message-controls-control button icon-big-grey icon-big-close">'),
                    o = $('<div class="messages-message-controls">').append(i),
                    n = $('<div class="messages-message-wrapper">').html(e.message),
                    s = this.messageContainer((function() {
                        return {
                            controls: o,
                            messageWrapper: n
                        }
                    }), e._id),
                    a = s.messageContainer,
                    r = s.utils;
                i.touch($.proxy(this.markMessageAsRead, this, e._id)),
                this.show(),
                t ? this.$list.prepend(a) : this.$list.append(a),
                r.css({
                    display: n[0].scrollHeight < this.messagePreviewHeight ? "none" : "flex"
                }),
                a.css({
                    display: this.messageInDisplay ? "none" : "block"
                }),
                a.addClass("fadein")
            } else
                console.warn("Cannot display message! Wrong format detected", null)
        },
        se.prototype.toggleContainersOtherThan = function(e) {
            this.$list.find(".messages-message-container").each((function() {
                $(this).prop("id") !== e && $(this).removeClass("fadein").toggle(10)
            }))
        },
        se.prototype.toggleMessageState = function(e) {
            var t = this.$list.find("#" + e).find(".messages-message-container-inner"),
                i = t.find(".messages-message-wrapper"),
                o = (t.find(".messages-message-container-utils"), t.find(".messages-message-container-utils-link")),
                n = t[0].scrollHeight,
                s = n - 10 >= i[0].scrollHeight ? n - 10 : n;
            if (this.messageInDisplay === e)
                t.css({
                    overflow: "hidden"
                }),
                t.animate({
                    height: this.messagePreviewHeight,
                    scrollTop: 0
                }, 200),
                o.text(locale.showMore),
                this.toggleContainersOtherThan(e),
                this.messageInDisplay = null;
            else if (this.messageInDisplay) {
                var a = this.$list.find("#" + this.messageInDisplay).find(".messages-message-container-inner"),
                    r = (a.find(".messages-message-container-utils"), a.find(".messages-message-container-utils-link"));
                a.animate({
                    height: this.messagePreviewHeight,
                    scrollTop: 0
                }, 150),
                r.text(locale.showMore),
                this.toggleContainersOtherThan(e),
                this.messageInDisplay = e,
                t.animate({
                    height: s
                }),
                o.text(locale.showLess)
            } else
                t.css({
                    overflow: "auto",
                    paddingBottom: s > this.messageMaxHeight ? 32 : 20
                }),
                t.animate({
                    height: s
                }, 200),
                o.text(locale.showLess),
                this.toggleContainersOtherThan(e),
                this.messageInDisplay = e
        },
        se.prototype.removeMessage = function(e) {
            var t = this,
                i = t.$list.find("#" + e);
            t.messageInDisplay === e && (t.messageInDisplay = null, t.toggleContainersOtherThan(e)),
            t.messageInDisplay || i.toggle(10),
            setTimeout((function() {
                i.remove(),
                t.hideMessageList()
            }), 100)
        },
        se.prototype.removeMessageError = function(e) {
            $.notify("Sorry we couldn't take care of that. Please try again later.")
        };
        const ae = {};
        let re,
            le;
        const ce = {
                error: "",
                token: ""
            },
            de = /(?:\#)?\/saml\/callback(?:\?)?(.*)/;
        function he() {
            const e = de.exec(window.location.hash);
            e && function(e) {
                const t = e.split("&");
                for (const e of t) {
                    const [t, i] = e.split("=");
                    "token" === t ? ce.token = decodeURIComponent(i) : "error" === t && (ce.error = decodeURIComponent(i))
                }
            }(e[1]),
            le = function() {
                let e = null;
                const t = /template=(.*)/.exec(window.location.hash);
                t && (e = decodeURIComponent(t[1]));
                return e
            }(),
            re = me(function() {
                const e = window.location.hash;
                if (e && "#" !== e)
                    return me(fe(window.location.hash));
                {
                    let e;
                    const t = window.NinoxDocumentInteraction.getUserDefault("ui.navigation.state" + ("prod" === window.NINOX_ENV ? "" : "." + window.NINOX_ENV));
                    if (t && "{}" !== t)
                        try {
                            const i = JSON.parse(t);
                            null != i && "object" == typeof i && (e = i)
                        } catch (e) {
                            console.log("Invalid navigation state", e)
                        }
                    return e || {
                            teamId: "default"
                        }
                }
            }()),
            be(re),
            ye(void 0, re),
            window.addEventListener("popstate", pe)
        }
        function pe(e) {
            const t = fe(window.location.hash),
                i = re;
            we(t),
            ye(i, t)
        }
        const ue = {
            teams: "teamId",
            database: "dbId",
            module: "moduleId",
            view: "vid",
            node: "nid",
            tab: "tabId"
        };
        function fe(e) {
            const t = (e || "").split("/"),
                i = {};
            for (let e = 1; e < t.length; e += 2) {
                const o = ue[(t[e] || "").trim()],
                    n = (t[e + 1] || "").trim();
                o && n && (i[o] = decodeURIComponent(n))
            }
            return i
        }
        function me(e) {
            return void 0 !== e.dbId && (void 0 === e.moduleId && (e.moduleId = "default"), void 0 === e.vid && (e.vid = "default"), void 0 !== e.nid && void 0 === e.tabId && (e.tabId = "default")), e
        }
        function ge(e) {
            return (e.teamId ? "/teams/" + encodeURIComponent(e.teamId) : "") + (e.dbId ? "/database/" + encodeURIComponent(e.dbId) : "") + (e.moduleId ? "/module/" + encodeURIComponent(e.moduleId) : "") + (e.vid ? "/view/" + encodeURIComponent(e.vid) : "") + (e.nid ? "/node/" + encodeURIComponent(e.nid) : "") + (e.tabId ? "/tab/" + encodeURIComponent(e.tabId) : "")
        }
        function ve(e) {
            const t = re,
                i = me(e);
            we(i),
            window.location.assign(window.location.pathname + "#" + ge(i)),
            ye(t, i)
        }
        function be(e) {
            we(me(e)),
            window.location.replace(window.location.pathname + "#" + ge(e))
        }
        function ye(e, t) {
            e ? e.nid !== t.nid || e.tabId !== t.tabId ? Ce("tab", t) : e.dbId !== t.dbId || e.moduleId !== t.moduleId || e.vid !== t.vid ? Ce("view", t) : e.teamId !== t.teamId && Ce("team", t) : Ce("team", t)
        }
        function we(e) {
            window.NinoxDocumentInteraction.setUserDefault("ui.navigation.state" + ("prod" === window.NINOX_ENV ? "" : "." + window.NINOX_ENV), JSON.stringify(e) || ""),
            re = e
        }
        function xe() {
            if (!re)
                throw new Error("Router not initialized");
            return re
        }
        function Te(e, t, i) {
            const o = ae[e];
            ae[e] = o ? o.concat([{
                callback: t,
                context: i
            }]) : [{
                callback: t,
                context: i
            }]
        }
        function $e(e, t, i) {
            const o = ae[e];
            o && (ae[e] = o.filter(e => e.callback !== t && e.context !== i))
        }
        function Ce(e, t) {
            const i = ae[e];
            if (i)
                for (const e of i)
                    e.callback.apply(e.context, [t])
        }
        function ke() {
            return ce
        }
        o("./src/react/ResizeDragHandle.css");
        const Se = e => a.createElement("div", {
            className: "ResizeDragHandle_container"
        }, a.createElement("div", {
            className: "ResizeDragHandle_handleContainer" + (e.adminMode ? " ResizeDragHandle_handleContainerAdminMode" : "")
        }, a.createElement("div", {
            className: "i-24-24 i-lighter-grey i-resize-handle"
        })));
        function Ee() {
            this.nextUndoId = 1,
            this._undoOperations = {},
            this.undoImplementation = void 0 !== window.UNDO_IMPLEMENTATION ? window.UNDO_IMPLEMENTATION : new _e,
            this.undoImplementation.cancelUndo()
        }
        function _e() {
            this.isUndoing = !1,
            this.isRedoing = !1,
            this.undoStack = [],
            this.redoStack = []
        }
        Ee.prototype.cancel = function() {
            this._undoOperations = {},
            this.undoImplementation.cancelUndo()
        },
        Ee.prototype.push = function(e) {
            var t = String(this.nextUndoId++);
            this._undoOperations[t] = e,
            this.undoImplementation.pushUndoOperation({
                id: t,
                title: e.title
            })
        },
        Ee.prototype.performUndo = function(e, t=(() => {})) {
            var i = this._undoOperations[e];
            console.log(i),
            i && ($.loading(!0), i.exec((function(e) {
                $.loading(!1),
                e && $.alert(e),
                t()
            })))
        },
        Ee.prototype.canExecUndo = function(e) {
            this.undoImplementation.canExecUndo(e)
        },
        Ee.prototype.canExecRedo = function(e) {
            this.undoImplementation.canExecRedo(e)
        },
        Ee.prototype.execUndo = function() {
            this.undoImplementation.execUndo()
        },
        Ee.prototype.execRedo = function() {
            this.undoImplementation.execRedo()
        },
        _e.prototype.pushUndoOperation = function(e) {
            this.isUndoing ? this.redoStack.push(e) : this.undoStack.push(e),
            ui.recordNavigation && ui.recordNavigation.updateUndo()
        },
        _e.prototype.cancelUndo = function() {
            this.undoStack = [],
            this.redoStack = [],
            ui.recordNavigation && ui.recordNavigation.updateUndo()
        },
        _e.prototype.canExecUndo = function(e) {
            e(void 0, this.undoStack.length > 0)
        },
        _e.prototype.canExecRedo = function(e) {
            e(void 0, this.redoStack.length > 0)
        },
        _e.prototype.execUndo = function() {
            var e = this;
            if (e.undoStack.length) {
                var t = e.undoStack.pop();
                ui.undoManager && (e.isUndoing = !0, ui.undoManager.performUndo(t.id, (function(t) {
                    e.isUndoing = !1
                }))),
                ui.recordNavigation && ui.recordNavigation.updateUndo()
            }
        },
        _e.prototype.execRedo = function() {
            var e = this;
            if (e.redoStack.length) {
                var t = e.redoStack.pop();
                ui.undoManager && (e.isRedoing = !0, ui.undoManager.performUndo(t.id, (function(t) {
                    e.isRedoing = !1
                }))),
                ui.recordNavigation && ui.recordNavigation.updateUndo()
            }
        };
        o("./src/react/database/CondensedHudLeftHeader.css");
        class De extends a.Component {
            constructor(e)
            {
                super(e)
            }
            render()
            {
                return null === this.props.onBurgerMenuClicked ? null : a.createElement(ee.a, {
                    className: "hud-menu-group CondensedHudLeftHeader_leftHud",
                    onFastClick: this.props.onBurgerMenuClicked
                }, a.createElement("div", {
                    className: "i-32-24 i-white i-setting-side-menu-left"
                }))
            }
        }
        var Me = o("./node_modules/react-sortable-hoc/dist/react-sortable-hoc.umd.js");
        o("./src/react/database/Hud.css");
        const Ne = Object(Me.SortableHandle)(() => a.createElement("div", {
                className: "Hud_sortingHandleContainer"
            }, a.createElement("div", {
                className: "i-24-24 i-lighter-grey i-drag-handle"
            }))),
            Ie = Object(Me.SortableElement)(({value: e}) => a.createElement("div", {
                className: "Hud_sortableElement"
            }, e)),
            Oe = Object(Me.SortableContainer)(({children: e}) => a.createElement("div", null, e));
        class Re extends a.Component {
            constructor(e)
            {
                super(e),
                K()(this, "onSortEnd", (e, t, i) => {
                    Object(l.f)("Table", "Rearrange"),
                    e !== t && this.props.database.schema.updateTypeOrder(e, t, i),
                    this.setState({
                        isSorting: !1
                    })
                }),
                this.state = {
                    currentlyExpanded: [],
                    isSorting: !1
                }
            }
            render()
            {
                const e = [],
                    t = window.ui.getAvailableTypes();
                for (const i of t) {
                    const t = i.children.length > 0,
                        o = void 0 !== this.state.currentlyExpanded[i.id];
                    e.push(a.createElement("div", {
                        key: "container" + i.id,
                        className: "Hud_rowContainer"
                    }, this.renderType(i, t), o ? this.renderSortable(i.children.map(e => this.renderType(e, !1)), i) : null))
                }
                return this.renderSortable(e, null)
            }
            toggleExpand(e)
            {
                this.setState(t => (void 0 !== t.currentlyExpanded[e] ? t.currentlyExpanded[e] = void 0 : t.currentlyExpanded[e] = e, t))
            }
            renderType(e, t)
            {
                const i = e.id === this.props.selection,
                    o = this.state.currentlyExpanded[e.id],
                    n = e.icon ? "nav-item-icon ic ic-" + e.icon : "nav-item-icon i-32-24 i-white i-setting-table",
                    s = this.props.database.adminMode && this.props.database.isAdminEnabled(),
                    r = s && e.hasExpressionErrors();
                return a.createElement(ee.a, {
                    onFastClick: () => this.props.onTableClick(e.id),
                    key: e.id,
                    className: "nav-item" + (i ? " selected" : "") + (this.state.isSorting ? " Hud_sorting" : "") + (r ? " error" : ""),
                    style: {
                        width: "100%",
                        overflow: "hidden",
                        paddingLeft: e.master ? 32 : void 0
                    }
                }, i ? a.createElement("div", {
                    className: "nav-item-selected-indicator"
                }) : null, a.createElement("div", {
                    className: n,
                    style: {
                        opacity: i ? 1 : .7
                    }
                }), r ? a.createElement("div", {
                    className: "nav-item-icon-error i-red i-warning"
                }) : null, a.createElement("div", {
                    className: "nav-item-text"
                }, e.caption || Object(b.getLocale)().unnamed), this.ShouldShowActionContainer(e, t) ? a.createElement("span", {
                    className: "Hud_actionIconsContainer"
                }, t ? a.createElement(ee.a, {
                    className: "nav-item-expand i-32-12 i-white i-line-down-thick " + (void 0 !== o ? "expanded" : "collapsed"),
                    onFastClick: () => this.toggleExpand(e.id)
                }) : null, e.hidden ? this.hiddenTag() : "", s ? a.createElement(Ne, null) : null) : null)
            }
            ShouldShowActionContainer(e, t)
            {
                return t || e.hidden || this.props.database.adminMode && this.props.database.isAdminEnabled()
            }
            hiddenTag()
            {
                return a.createElement("span", {
                    className: "Hud_hiddenTag"
                }, Object(b.getLocale)().hidden)
            }
            renderSortable(e, t)
            {
                return a.createElement(Oe, {
                    onSortEnd: e => this.onSortEnd(e.oldIndex, e.newIndex, t),
                    useDragHandle: !0,
                    onSortStart: () => this.setState({
                        isSorting: !1
                    }),
                    helperClass: "Hud_helperClass"
                }, e.map((e, t) => a.createElement(Ie, {
                    key: `item-${t}`,
                    index: t,
                    value: e
                })))
            }
        }
        o("./src/react/database/HudContainer.css"),
        o("./src/react/database/HudLeftHeader.css");
        class je extends a.Component {
            constructor(e)
            {
                super(e)
            }
            render()
            {
                const e = this.props.stickySettings;
                return a.createElement("div", {
                    className: "HudLeftHeader_root"
                }, window.ui.fullWidth <= 640 || null === e ? null : a.createElement(ee.a, {
                    onFastClick: () => {
                        e.toggleSticky()
                    },
                    className: "HudLeftHeader_toggle"
                }, a.createElement("div", {
                    className: "i-40-24 i-white " + (e.isSticky ? "i-setting-pin-on" : "i-setting-pin-off")
                })), a.createElement("div", {
                    className: "HudLeftHeader_backContainer"
                }, a.createElement(ee.a, {
                    onFastClick: this.props.onCloseClick,
                    className: "nav-item head HudLeftHeader_backButton"
                }, a.createElement("div", {
                    className: "nav-item-icon i-24-24 i-white i-arrow-back"
                }), a.createElement("div", {
                    className: "nav-item-text head"
                }, window.database.account.name))), a.createElement(ee.a, {
                    onFastClick: () => this.props.onItemClick("home"),
                    className: "nav-item head" + ("home" === this.props.selection ? " selected" : ""),
                    title: this.props.database.name
                }, "home" === this.props.selection ? a.createElement("div", {
                    className: "nav-item-selected-indicator"
                }) : null, a.createElement("div", {
                    className: "nav-item-icon i-24-24 i-white i-home"
                }), a.createElement("div", {
                    className: "nav-item-text head"
                }, this.props.database.name), void 0 === this.props.cloudState ? null : a.createElement(ee.a, {
                    onFastClick: this.props.cloudState.onClick,
                    className: "HudLeftHeader_cloudContainer i-32-24 i-white i-cloud-" + this.props.cloudState.state,
                    title: "cloud" === this.props.cloudState.type ? Object(b.getLocale)().resyncCloudDatabases : Object(b.getLocale)().ninoxCloudSync
                })), a.createElement(ee.a, {
                    onFastClick: () => this.props.onItemClick("search"),
                    className: "nav-item head" + ("search" === this.props.selection ? " selected" : ""),
                    title: Object(b.getLocale)().search
                }, "search" === this.props.selection ? a.createElement("div", {
                    className: "nav-item-selected-indicator"
                }) : null, a.createElement("div", {
                    className: "nav-item-icon i-24-24 i-white i-search"
                }), a.createElement("div", {
                    className: "nav-item-text head"
                }, Object(b.getLocale)().search)), a.createElement(ee.a, {
                    onFastClick: () => this.props.onItemClick("calendar"),
                    className: "nav-item head" + ("calendar" === this.props.selection ? " selected" : ""),
                    title: Object(b.getLocale)().calendar
                }, "calendar" === this.props.selection ? a.createElement("div", {
                    className: "nav-item-selected-indicator"
                }) : null, a.createElement("div", {
                    className: "nav-item-icon i-24-24 i-white i-calendar",
                    title: Object(b.getLocale)().calendar
                }), a.createElement("div", {
                    className: "nav-item-text head"
                }, Object(b.getLocale)().calendar)), a.createElement("div", {
                    className: "HudLeftHeader_divider"
                }))
            }
        }
        class Le extends a.Component {
            constructor(e)
            {
                super(e),
                K()(this, "onHeaderClick", e => {
                    switch (e) {
                    case "search":
                        this.props.openSearch();
                        break;
                    case "home":
                        this.props.openHome();
                        break;
                    case "calendar":
                        this.props.openCalendar();
                        break;
                    default:
                        Z()(e)
                    }
                }),
                K()(this, "onTableClick", e => {
                    this.props.openTable(e)
                })
            }
            render()
            {
                return a.createElement("div", {
                    className: "HudContainer_root"
                }, a.createElement(je, {
                    cloudState: this.props.cloudState,
                    onItemClick: this.onHeaderClick,
                    onCloseClick: this.props.onCloseClick,
                    selection: this.props.selection,
                    database: this.props.database,
                    stickySettings: this.props.stickySettings
                }), a.createElement("div", {
                    className: "HudContainer_body"
                }, a.createElement(Re, {
                    selection: this.props.selection,
                    database: this.props.database,
                    onTableClick: this.onTableClick
                })), this.props.database.adminMode && this.props.database.isAdminEnabled() ? a.createElement(ee.a, {
                    rippleStyle: "LIGHT",
                    onFastClick: this.props.createTable,
                    className: "nav-item nav-item-add-table",
                    title: Object(b.getLocale)().addTable
                }, a.createElement("div", {
                    className: "nav-item-icon i-32-24 i-white i-plus"
                }), a.createElement("div", {
                    className: "nav-item-text",
                    style: {
                        color: "white"
                    }
                }, Object(b.getLocale)().addTable)) : null)
            }
        }
        var Fe = o("./node_modules/react-burger-menu/lib/BurgerMenu.js");
        function Ae(e) {
            this.$el = $('<div class="nav-container">').appendTo(ui.$left),
            this.$slidingHeader = $('<div id="react-root-sliding-header">').appendTo(ui.$overlays),
            this.attachCondensed(),
            this.selection = void 0,
            database.on("admin", void 0, $.proxy(this.updateUI, this)),
            database.on("schema", void 0, $.proxy(this.updateUI, this)),
            this.cloudState = "okay"
        }
        function He() {
            var e = this;
            this.controllers = [],
            this.$actions = $('<div class="hud-menu-group" style="margin:0 8px 0 0;display:none">'),
            this.$print = $('<div class="hud-menu-button i-32-24 i-light-grey i-setting-print disabled" title="' + htmlEscape(locale.print) + '" style="margin-right: 2px;">').touch($.proxy(this.print, this)).appendTo(this.$actions),
            this.$remove = $('<div class="hud-menu-button i-32-24 i-light-grey i-setting-trash disabled" title="' + htmlEscape(locale.removeRecord) + '" style="margin-right: 2px;">').touch($.proxy(this.remove, this)).appendTo(this.$actions),
            this.$duplicate = $('<div class="hud-menu-button i-32-24 i-light-grey i-setting-copy disabled" title="' + htmlEscape(locale.duplicateRecord) + '" style="margin-right: 2px;">').touch($.proxy(this.duplicate, this)).appendTo(this.$actions),
            this.$add = $('<div class="hud-menu-button i-32-24 i-light-grey i-setting-add disabled" title="' + htmlEscape(locale.createRecord) + '">').touch($.proxy(this.add, this)).appendTo(this.$actions),
            this.$navs = $('<div class="hud-menu-group" style="margin:0 0px 0 9px">').appendTo(ui.$menuRight),
            this.$first = $('<div class="hud-menu-button menu-nav i-32-24 i-light-grey i-arrow-solid-first disabled" title="' + htmlEscape(locale.gotoFirst) + '">').appendTo(this.$navs),
            this.$prev = $('<div class="hud-menu-button menu-nav i-32-24 i-light-grey i-arrow-solid-left disabled" title="' + htmlEscape(locale.gotoPrev) + '">').appendTo(this.$navs),
            this.$next = $('<div class="hud-menu-button menu-nav i-32-24 i-light-grey i-arrow-solid-right disabled" title="' + htmlEscape(locale.gotoNext) + '">').appendTo(this.$navs),
            this.$last = $('<div class="hud-menu-button menu-nav i-32-24 i-light-grey i-arrow-solid-last disabled" title="' + htmlEscape(locale.gotoLast) + '">').appendTo(this.$navs),
            this.$actionsSmall = $('<div class="hud-menu-group">'),
            this.$printSmall = $('<div class="hud-menu-button i-32-24 i-light-grey i-setting-print disabled" title="' + htmlEscape(locale.print) + '">').touch($.proxy(this.print, this)).appendTo(this.$actionsSmall),
            this.$removeSmall = $('<div class="hud-menu-button i-32-24 i-light-grey i-setting-trash disabled" title="' + htmlEscape(locale.removeRecord) + '">').touch($.proxy(this.remove, this)).appendTo(this.$actionsSmall),
            this.$duplicateSmall = $('<div class="hud-menu-button i-32-24 i-light-grey i-setting-copy disabled" title="' + htmlEscape(locale.duplicateRecord) + '">').touch($.proxy(this.duplicate, this)).appendTo(this.$actionsSmall),
            this.$addSmall = $('<div class="hud-menu-button i-32-24 i-light-grey i-setting-add disabled" title="' + htmlEscape(locale.createRecord) + '">').touch($.proxy(this.add, this)).appendTo(this.$actionsSmall),
            this.$navsSmall = $('<div class="hud-menu-group">').appendTo(ui.$foot),
            this.$firstSmall = $('<div class="hud-menu-button i-32-24 i-light-grey i-arrow-solid-first disabled" title="' + htmlEscape(locale.gotoFirst) + '">').appendTo(this.$navsSmall),
            this.$prevSmall = $('<div class="hud-menu-button i-32-24 i-light-grey i-arrow-solid-left disabled" title="' + htmlEscape(locale.gotoPrev) + '">').appendTo(this.$navsSmall),
            this.$nextSmall = $('<div class="hud-menu-button i-32-24 i-light-grey i-arrow-solid-right disabled" title="' + htmlEscape(locale.gotoNext) + '">').appendTo(this.$navsSmall),
            this.$lastSmall = $('<div class="hud-menu-button i-32-24 i-light-grey i-arrow-solid-last disabled" title="' + htmlEscape(locale.gotoLast) + '">').appendTo(this.$navsSmall),
            this.$first.on("contextmenu", (function(e) {
                e.preventDefault()
            })),
            this.$first.touch($.proxy(this.first, this)),
            this.$prev.on("contextmenu", (function(e) {
                e.preventDefault()
            })),
            this.$prev[0].addEventListener(TOUCH ? EVENT_touchstart : "mousedown", n),
            this.$next.on("contextmenu", (function(e) {
                e.preventDefault()
            })),
            this.$next[0].addEventListener(TOUCH ? EVENT_touchstart : "mousedown", o),
            this.$last.on("contextmenu", (function(e) {
                e.preventDefault()
            })),
            this.$last.touch($.proxy(this.last, this)),
            this.$firstSmall.on("contextmenu", (function(e) {
                e.preventDefault()
            })),
            this.$firstSmall.touch($.proxy(this.first, this)),
            this.$prevSmall.on("contextmenu", (function(e) {
                e.preventDefault()
            })),
            this.$prevSmall[0].addEventListener(TOUCH ? EVENT_touchstart : "mousedown", n),
            this.$nextSmall.on("contextmenu", (function(e) {
                e.preventDefault()
            })),
            this.$nextSmall[0].addEventListener(TOUCH ? EVENT_touchstart : "mousedown", o),
            this.$lastSmall.on("contextmenu", (function(e) {
                e.preventDefault()
            })),
            this.$lastSmall.touch($.proxy(this.last, this)),
            He.$actions = this.$actions,
            He.$navs = this.$navs,
            He.$actionsSmall = this.$actionsSmall,
            He.$navsSmall = this.$navsSmall,
            He.$actionsSmall.appendTo(ui.$foot),
            He.$navsSmall.appendTo(ui.$foot),
            He.$navs.prependTo(ui.$menuRight),
            He.$actions.prependTo(ui.$menuRight),
            this.updateUI();
            var t = null,
                i = null;
            function o(e) {
                return s("next", e), e.preventDefault(), !1
            }
            function n(e) {
                return s("prev", e), e.preventDefault(), !1
            }
            function s(o, n) {
                i || (i = o, TOUCH ? (EVENT_target(n).addEventListener(EVENT_touchend, a), EVENT_target(n).addEventListener("touchcancel", a)) : window.addEventListener("mouseup", a), "next" === i ? e.next() : e.prev(), t = setTimeout(r, 400), n.preventDefault())
            }
            function a(e) {
                i && (i = null, TOUCH ? (EVENT_target(e).removeEventListener(EVENT_touchend, a), EVENT_target(e).removeEventListener("touchcancel", a)) : window.removeEventListener("mouseup", a), t && (clearTimeout(t), t = null), e.preventDefault())
            }
            function r() {
                "next" === i ? (e.next(), t = setTimeout(r, 10)) : "prev" === i ? (e.prev(), t = setTimeout(r, 10)) : t = null
            }
        }
        Ae.prototype.attachCondensed = function() {
            this.$menu = $('<div id="react-root-condensed-hud-left-header">').appendTo(ui.$headerContainer)
        },
        Ae.prototype.initialResize = function() {
            ui.fullWidth <= 640 && ui.hideLeftPanel(),
            this.lastWidth = ui.fullWidth,
            this.lastLeftWidth = ui.leftWidth,
            this.updateUI()
        },
        Ae.prototype.resize = function() {
            this.lastWidth >= 640 && ui.fullWidth <= 640 && (ui.hideLeftPanel(), this.updateUI()),
            this.lastWidth <= 640 && ui.fullWidth > 640 && (ui.showLeftPanel({}), this.updateUI()),
            (!this.lastLeftWidth && ui.leftWidth || this.lastLeftWidth && !ui.leftWidth) && this.updateUI(),
            ui.leftWidth && ui.isLeftOpen && (n.unmountComponentAtNode(this.$menu[0]), n.unmountComponentAtNode(this.$slidingHeader[0])),
            this.lastWidth = ui.fullWidth,
            this.lastLeftWidth = ui.leftWidth
        },
        Ae.prototype.updateState = function(e) {
            if (e)
                switch (e.base) {
                case "table":
                    this.selection = e.tid;
                    break;
                case "calendar":
                    this.selection = "calendar";
                    break;
                case "search":
                    this.selection = "search";
                    break;
                case "home":
                    this.selection = "home"
                }
            else
                this.selection = void 0;
            this.updateUI()
        },
        Ae.prototype.isOpen = !1,
        Ae.prototype.handleBurgerMenuClickLarge = function() {
            ui.showLeftPanel({
                shouldResetWidth: !0
            })
        },
        Ae.prototype.handleBurgerMenuClickSmall = function() {
            this.isOpen = !this.isOpen,
            this.updateUI()
        },
        Ae.prototype.handleStateChange = function(e) {
            this.isOpen !== e.isOpen && (this.isOpen = e.isOpen, this.updateUI())
        },
        Ae.prototype.closeMenu = function() {
            this.isOpen = !1,
            this.updateUI()
        },
        Ae.prototype.toggleSticky = function() {
            ui.fullWidth > 640 && (ui.showLeftPanel({
                shouldResetWidth: !0
            }), this.isOpen = !1, this.updateUI())
        },
        Ae.prototype.renderCondensedHeader = function(e) {
            n.render(a.createElement(De, {
                onBurgerMenuClicked: () => e()
            }), this.$menu[0])
        },
        Ae.prototype.reloadDatabase = function() {
            dbms.closeDatabase((function() {
                window.location.reload()
            }))
        },
        Ae.prototype.setCloudSyncState = function(e) {
            this.cloudState = e,
            this.updateUI()
        },
        Ae.prototype.renderHudContainerLarge = function() {
            n.render(a.createElement(Le, {
                cloudState: this.getCloudState(),
                stickySettings: null,
                onCloseClick: () => ui.backToRoot(),
                selection: this.selection,
                database: database,
                openSearch: () => ui.openSearch(),
                openHome: () => ui.openHome(),
                openCalendar: () => ui.openCalendar(),
                openTable: e => ui.openTable(e),
                createTable: () => ui.createTable()
            }), this.$el[0])
        },
        Ae.prototype.getCloudState = function() {
            return database.cloud ? {
                onClick: () => this.reloadDatabase(),
                state: this.cloudState,
                type: "cloud"
            } : database.sql ? {
                onClick: () => this.popupSyncState(),
                state: this.cloudState,
                type: "sql"
            } : void 0
        },
        Ae.prototype.renderHudContainerSmall = function() {
            n.render(a.createElement(Fe.slide, {
                isOpen: this.isOpen,
                customBurgerIcon: !1,
                customCrossIcon: !1,
                styles: {
                    bmMenu: {
                        background: "white"
                    },
                    bmMenuWrap: {
                        transition: "all 0.3s ease 0s"
                    },
                    bmOverlay: {
                        transition: "opacity 0.3s ease 0s"
                    }
                },
                onStateChange: e => this.handleStateChange(e)
            }, a.createElement(Le, {
                cloudState: this.getCloudState(),
                stickySettings: {
                    isSticky: !1,
                    toggleSticky: () => this.toggleSticky()
                },
                selection: this.selection,
                database: database,
                onCloseClick: () => ui.backToRoot(),
                openSearch: () => {
                    this.closeMenu(),
                    ui.openSearch()
                },
                openHome: () => {
                    this.closeMenu(),
                    ui.openHome()
                },
                openCalendar: () => {
                    this.closeMenu(),
                    ui.openCalendar()
                },
                openTable: e => {
                    this.closeMenu(),
                    ui.openTable(e)
                },
                createTable: () => {
                    this.closeMenu(),
                    ui.createTable()
                }
            })), this.$slidingHeader[0])
        },
        Ae.prototype.updateUI = function() {
            ui.isLeftOpen && ui.leftWidth ? (this.renderHudContainerLarge(), this.isOpen = !1, n.unmountComponentAtNode(this.$slidingHeader[0])) : (this.renderCondensedHeader(() => {
                this.handleBurgerMenuClickSmall()
            }), n.unmountComponentAtNode(this.$el[0]), this.renderHudContainerSmall())
        },
        Ae.prototype.popupSyncState = function() {
            const e = this;
            if (database.sql) {
                var t = $.popdown({
                    head: locale.syncState,
                    close: function() {
                        i && clearInterval(i);
                        i = null
                    },
                    buttons: [{
                        caption: locale.syncProblemCheck,
                        click: function() {
                            t.close(),
                            $.loading(!0),
                            database.checkSynchornizationProblems((function(t, i) {
                                if ($.loading(!1), t)
                                    return $.alert(t);
                                e.popupSynchronizationProblems(i)
                            }))
                        }
                    }, " ", {
                        caption: locale.syncNow,
                        click: function() {
                            t.close(),
                            database.syncTrigger((function(e) {
                                e && $.alert(e)
                            }))
                        }
                    }, "-", "okay"]
                });
                o();
                var i = setInterval(o, 1e3)
            }
            async function o() {
                var e = await database.getSyncState().catch(e => ($.alert(e), {}));
                t.$content.html('<div style="padding:0 16px"><p>' + htmlEscape(locale.syncSeq) + " " + e.seq + "</p><p>" + htmlEscape(locale.syncFilesToDownload) + ": " + e.syncFilesDownload + (e.syncFilesDownloadError ? " (" + e.syncFilesDownloadError + " " + htmlEscape(locale.syncFilesFailed) + ")" : "") + "</p><p>" + htmlEscape(locale.syncFilesToUpload) + ": " + e.syncFilesUpload + (e.syncFilesUploadError ? " (" + e.syncFilesUploadError + " " + htmlEscape(locale.syncFilesFailed) + ")" : "") + "</p>" + (database.syncError ? '<p style="color:red">' + htmlEscape(String(database.syncError)) + "</p>" : "") + "</div>")
            }
        },
        Ae.prototype.popupSynchronizationProblems = function(e) {
            const t = {
                "file-download": "Save file as...",
                "file-delete": "Delete file",
                "file-rename": "Rename file...",
                "file-pull": "Download file",
                "file-push": "Upload file",
                "file-entry-add": "Synchronize",
                "file-entry-remove": "Remove from sync",
                "file-entry-pull": "Download again"
            };
            var i = database.schema.types,
                o = $.popdown({
                    head: locale.syncProblems,
                    buttons: ["-", "okay"]
                }),
                n = "";
            n += '<div class="syncproblems">';
            var s = e.files;
            if (s && s.length) {
                n += '<div class="syncproblems-files">';
                for (var a = 0; a < s.length; a++) {
                    var r = s[a],
                        l = i[r.tid];
                    n += '<div class="syncproblems-file" data-index="' + a + '"><div class="syncproblems-file-item"><div class="syncproblems-file-name">' + htmlEscape(l ? l.caption : r.tid) + htmlEscape(r.rid ? "/" + r.rid : "") + htmlEscape(r.name ? "/" + r.name : "") + '</div><div class="syncproblems-file-description">' + htmlEscape(r.size ? r.size + " byte " : "") + htmlEscape(r.err ? " - " + r.err : "") + "</div></div>",
                    n += '<div class="syncproblems-file-actions">';
                    var c = r.actions;
                    c && c.length && (n += '<div class="button i-32-24 i-grey i-setting-settings"></div>'),
                    n += "</div>",
                    n += "</div>"
                }
                n += "</div>"
            } else
                n += htmlEscape(locale.fileSync + ": " + locale.noProblems);
            n += "</div>",
            o.$content.html(n),
            o.$content.touch((function(i) {
                var o = $(i.target).closest(".syncproblems-file"),
                    n = o.attr("data-index");
                if (n) {
                    var s = e.files[n];
                    if (s) {
                        var a = s.actions;
                        if (a && a.length) {
                            var r = $.backplane({
                                    close: closed
                                }),
                                l = $('<div class="nx-menu-popup">').appendTo(r);
                            T.each(a, (function(e) {
                                $('<div class="nx-menu-item">').append($('<div class="nx-menu-label">').text(t[e] || e)).appendTo(l).touch((function() {
                                    r.close(),
                                    "file-rename" === e ? function(e, t) {
                                        var i = $.popdown({
                                                head: locale.rename,
                                                buttons: ["-", "cancel", " ", {
                                                    cls: "blue",
                                                    caption: locale.rename,
                                                    click: s
                                                }]
                                            }),
                                            o = $('<div class="component editor editor-string" style="width:100%">').appendTo(i.$content);
                                        $("<label>").text(locale.name).appendTo(o);
                                        var n = $('<input type="text">').val(e.name).appendTo($('<div class="stringeditor">').appendTo(o)).keydown((function(e) {
                                            13 === e.which && s(),
                                            27 === e.which && a(!1)
                                        }));
                                        function s() {
                                            var t = n.val();
                                            return e.name === t ? a(!1) : b.util.isValidFileName(t) ? ($.loading(!0), void database.renameFile(e.tid + e.rid, e.name, t, (function(i) {
                                                if (i)
                                                    return $.loading(!1), void $.alert(locale.couldntRenameFile);
                                                e.fid ? database.update(e.tid + e.rid, e.fid, t, (function(e) {
                                                    $.loading(!1),
                                                    e && $.alert(e),
                                                    a(!0)
                                                })) : ($.loading(!1), a(!0))
                                            }))) : $.alert(locale.invalidFileName)
                                        }
                                        function a(e) {
                                            i.close(),
                                            t(e)
                                        }
                                    }(s, (function(e) {
                                        e && o.hide("fast")
                                    })) : "file-download" === e ? function(e) {
                                        var t = database.downloadURL(e.tid + e.rid, e.name);
                                        NinoxDocumentInteraction.saveFile(e.name, "", (function(e, i) {
                                            if (e)
                                                return $.alert(e);
                                            i && localFileSystem.copyURL(t, i).catch(e => $.alert(e))
                                        }))
                                    }(s) : ($.loading(!0), database.repairSynchronizationProblem(s, e, (function(e, t) {
                                        $.loading(!1),
                                        e ? $.alert(e) : t && o.hide("fast")
                                    })))
                                }))
                            }));
                            var c = l.outerWidth(),
                                d = l.outerHeight(),
                                h = {
                                    left: i.clientX,
                                    top: i.clientY
                                };
                            h.left + c > window.getWidth() && (h.left = window.getWidth() - c),
                            h.top + d > window.getHeight() && (h.top = window.getHeight() - d),
                            l.offset(h)
                        }
                    }
                }
            }))
        },
        He.$actions = void 0,
        He.$navs = void 0,
        He.$actionsSmall = void 0,
        He.$navsSmall = void 0,
        He.prototype.pushController = function(e) {
            this.controllers.unshift(e),
            this.updateUI()
        },
        He.prototype.popController = function(e) {
            var t = this.controllers.indexOf(e);
            -1 !== t && this.controllers.splice(t, 1),
            this.updateUI()
        },
        He.prototype.updateUI = function() {
            var e = this.controllers[0];
            ui.fullWidth <= 640 ? (this.$navsSmall[0].style.display = e ? "" : "none", this.$actionsSmall[0].style.display = e ? "" : "none", this.$actions[0].style.display = "none", this.$navs[0].style.display = "none") : (this.$navs[0].style.display = ui.fullWidth - ui.leftWidth < 800 || !e ? "none" : "", this.$actions[0].style.display = e ? "" : "none", this.$navsSmall[0].style.display = "none", this.$actionsSmall[0].style.display = "none");
            var t = !(e && e.hasPrevRecord && e.hasPrevRecord()),
                i = !(e && e.hasNextRecord && e.hasNextRecord()),
                o = !(e && e.hasAddRecord && e.hasAddRecord()),
                n = !(e && e.hasDuplicateRecord && e.hasDuplicateRecord()),
                s = !(e && e.hasRemoveRecord && e.hasRemoveRecord()),
                a = !(e && e.hasPrintRecord && e.hasPrintRecord());
            this.$first.toggleClass("disabled", t),
            this.$prev.toggleClass("disabled", t),
            this.$next.toggleClass("disabled", i),
            this.$last.toggleClass("disabled", i),
            this.$add.toggleClass("disabled", o),
            this.$duplicate.toggleClass("disabled", n),
            this.$remove.toggleClass("disabled", s),
            this.$print.toggleClass("disabled", a),
            this.$firstSmall.toggleClass("disabled", t),
            this.$prevSmall.toggleClass("disabled", t),
            this.$nextSmall.toggleClass("disabled", i),
            this.$lastSmall.toggleClass("disabled", i),
            this.$addSmall.toggleClass("disabled", o),
            this.$duplicateSmall.toggleClass("disabled", n),
            this.$removeSmall.toggleClass("disabled", s),
            this.$printSmall.toggleClass("disabled", a),
            this.updateUndo()
        },
        He.prototype.updateUndo = function() {
            this.$undo && (this.$undo.toggleClass("disabled", !0), ui.undoManager.canExecUndo((e, t) => {
                e && console.log(e),
                this.$undo.toggleClass("disabled", !t)
            })),
            this.$redo && (this.$redo.toggleClass("disabled", !0), ui.undoManager.canExecRedo((e, t) => {
                e && console.log(e),
                this.$redo.toggleClass("disabled", !t)
            }))
        },
        He.prototype.first = function() {
            var e = this.controllers[0];
            e && e.firstRecord && (e.firstRecord(), Object(l.f)("Navigation", "GoToFirst"))
        },
        He.prototype.last = function() {
            var e = this.controllers[0];
            e && e.lastRecord && (e.lastRecord(), Object(l.f)("Navigation", "GoToLast"))
        },
        He.prototype.prev = function() {
            var e = this.controllers[0];
            e && e.hasPrevRecord && e.hasPrevRecord() && e.prevRecord && (e.prevRecord(), Object(l.f)("Navigation", "GoToPrev"))
        },
        He.prototype.next = function() {
            var e = this.controllers[0];
            e && e.hasNextRecord && e.hasNextRecord() && e.nextRecord && (e.nextRecord(), Object(l.f)("Navigation", "GoToNext"))
        },
        He.prototype.add = function() {
            Object(l.f)("Form", "CreateRecord");
            var e = this.controllers[0];
            e && e.hasAddRecord && e.hasAddRecord() && e.addRecord && e.addRecord()
        },
        He.prototype.duplicate = function() {
            Object(l.f)("Form", "DuplicateRecord");
            var e = this.controllers[0];
            e && e.hasDuplicateRecord && e.hasDuplicateRecord() && e.duplicateRecord && e.duplicateRecord()
        },
        He.prototype.remove = function() {
            Object(l.f)("Form", "DeleteRecord");
            var e = this.controllers[0];
            e && e.hasRemoveRecord && e.hasRemoveRecord() && e.removeRecord && e.removeRecord()
        },
        He.prototype.print = function() {
            Object(l.f)("Form", "Print");
            var e = this.controllers[0];
            e && e.hasPrintRecord && e.hasPrintRecord() && e.printRecord && e.printRecord()
        },
        He.prototype.resize = function() {
            this.updateUI()
        };
        var Pe = o("./src/react/SimpleTabSelectionRow.tsx"),
            Ue = o("./src/js/widgets/Field.js");
        const ze = {
            csvHeaderDefault: !0,
            csvFooterDefault: !1,
            csvSepHeaderDefault: !1,
            csvLinefeedDefault: "\r\n",
            csvQuoteDefault: '"',
            csvEncodingDefault: "utf8",
            csvDateFormatDefault: "locale",
            csvNumberFormatDefault: void 0,
            csvSeparatorDefault: void 0
        };
        function Ve(e, t) {
            return null != e ? e : t
        }
        function We(e) {
            void 0 === ze.csvNumberFormatDefault && (NinoxDocumentInteraction.defaultDecimalSymbolIsComma() ? (ze.csvNumberFormatDefault = "comma", ze.csvSeparatorDefault = ";") : (ze.csvNumberFormatDefault = "point", ze.csvSeparatorDefault = ","));
            var t = e.$container;
            function i() {
                e.onUpdate && e.onUpdate()
            }
            e.types && (this.csvType = new util.SimpleModel(new schemas.TChoice(void 0, void 0, {
                caption: locale.chooseTypeToExport,
                values: e.types,
                formWidth: 1
            })), this.csvType.onUpdate(i), this.csvTypeField = new Ue.a(void 0, this.csvType, t)),
            this.csvHeader = new util.SimpleModel(new schemas.TBoolean(void 0, void 0, {
                caption: locale.csvHeader,
                required: !0,
                formWidth: 1 / 3
            })),
            this.csvHeader.value = Ve(e.header, ze.csvHeaderDefault),
            this.csvHeader.onUpdate(i),
            this.csvHeaderField = new Ue.a(void 0, this.csvHeader, t),
            this.csvSepHeader = new util.SimpleModel(new schemas.TBoolean(void 0, void 0, {
                caption: locale.csvSepHeader,
                required: !0,
                formWidth: 1 / 3
            })),
            this.csvSepHeader.value = Ve(e.sepHeader, ze.csvSepHeaderDefault),
            this.csvSepHeader.onUpdate(i),
            this.csvSepHeaderField = new Ue.a(void 0, this.csvSepHeader, t),
            this.csvSeparator = new util.SimpleModel(new schemas.TChoice(void 0, void 0, {
                caption: locale.csvSeparator,
                required: !0,
                formWidth: 1 / 3,
                values: {
                    ",": {
                        caption: ",",
                        order: 1
                    },
                    ";": {
                        caption: ";",
                        order: 2
                    },
                    "|": {
                        caption: "|",
                        order: 3
                    },
                    "\t": {
                        caption: locale.csvSeparatorTab,
                        order: 4
                    }
                }
            })),
            this.csvSeparator.value = Ve(e.sep, ze.csvSeparatorDefault),
            this.csvSeparator.onUpdate(i),
            this.csvSeparatorField = new Ue.a(void 0, this.csvSeparator, t),
            this.csvQuote = new util.SimpleModel(new schemas.TChoice(void 0, void 0, {
                caption: locale.csvQuote,
                required: !0,
                formWidth: 1 / 3,
                values: {
                    '"': {
                        caption: '"'
                    },
                    "'": {
                        caption: "'"
                    }
                }
            })),
            this.csvQuote.value = Ve(e.qut, ze.csvQuoteDefault),
            this.csvQuote.onUpdate(i),
            this.csvQuoteField = new Ue.a(void 0, this.csvQuote, t),
            this.csvLinefeed = new util.SimpleModel(new schemas.TChoice(void 0, void 0, {
                caption: locale.csvLinefeed,
                required: !0,
                formWidth: 1 / 3,
                values: {
                    "\r\n": {
                        caption: "CRLF"
                    },
                    "\n": {
                        caption: "LF"
                    }
                }
            })),
            this.csvLinefeed.value = Ve(e.lf, ze.csvLinefeedDefault),
            this.csvLinefeed.onUpdate(i),
            this.csvLinefeedField = new Ue.a(void 0, this.csvLinefeed, t),
            this.csvNumberFormat = new util.SimpleModel(new schemas.TChoice(void 0, void 0, {
                caption: locale.csvNumberFormat,
                required: !0,
                formWidth: 1 / 3,
                values: {
                    point: {
                        caption: locale.csvNumberFormatPoint,
                        order: 1
                    },
                    comma: {
                        caption: locale.csvNumberFormatComma,
                        order: 2
                    },
                    field: {
                        caption: locale.csvNumberFormatField,
                        order: 3
                    }
                }
            })),
            this.csvNumberFormat.value = Ve(e.numberFormat, ze.csvNumberFormatDefault),
            this.csvNumberFormat.onUpdate(i),
            this.csvNumberFormatField = new Ue.a(void 0, this.csvNumberFormat, t),
            this.csvDateFormat = new util.SimpleModel(new schemas.TChoice(void 0, void 0, {
                caption: locale.csvDateFormat,
                required: !0,
                formWidth: 1 / 3,
                values: {
                    locale: {
                        caption: locale.csvDateFormatLocal,
                        order: 1
                    },
                    iso: {
                        caption: "ISO 8601",
                        order: 2
                    },
                    gmt: {
                        caption: "GMT",
                        order: 3
                    },
                    timestamp: {
                        caption: "UNIX Timestamp",
                        order: 4
                    }
                }
            })),
            this.csvDateFormat.value = Ve(e.dateFormat, ze.csvDateFormatDefault),
            this.csvDateFormat.onUpdate(i),
            this.csvDateFormatField = new Ue.a(void 0, this.csvDateFormat, t),
            this.csvEncoding = new util.SimpleModel(new schemas.TChoice(void 0, void 0, {
                caption: locale.csvEncoding,
                required: !0,
                formWidth: 2 / 3,
                values: {
                    utf8: {
                        caption: "UTF-8 (Unicode)",
                        order: 1
                    },
                    utf16: {
                        caption: "UTF-16 (Unicode)",
                        order: 13
                    },
                    ascii: {
                        caption: "ASCII",
                        order: 14
                    },
                    "mac-roman": {
                        caption: "Mac Roman",
                        order: 2
                    },
                    "windows-cp1252": {
                        caption: "Windows Latin 1 CP1252",
                        order: 3
                    },
                    "windows-cp1250": {
                        caption: "Windows Latin 2 CP1250",
                        order: 4
                    },
                    "windows-cp1251": {
                        caption: "Windows Cyrillic CP1251",
                        order: 5
                    },
                    "windows-cp1253": {
                        caption: "Windows Greek CP1253",
                        order: 6
                    },
                    "windows-cp1254": {
                        caption: "Windows Turkish CP1254",
                        order: 7
                    },
                    "iso-latin1": {
                        caption: "ISO Latin 1",
                        order: 8
                    },
                    "iso-latin2": {
                        caption: "ISO Latin 2",
                        order: 9
                    },
                    "japanese-euc": {
                        caption: "Japanese EUC",
                        order: 10
                    },
                    "japanese-shift": {
                        caption: "Japanese SHIFT",
                        order: 11
                    },
                    "japanese-iso": {
                        caption: "Japanese ISO",
                        order: 12
                    }
                }
            })),
            this.csvEncoding.value = Ve(e.encoding, ze.csvEncodingDefault),
            this.csvEncoding.onUpdate(i),
            this.csvEncodingField = new Ue.a(void 0, this.csvEncoding, t)
        }
        function Be(e) {
            if (!database.authorizationExport)
                return $.alert(locale.notAuthorized);
            var t = $.popdown({
                    close: x
                }),
                i = t.$pane;
            Object(l.f)("DatabaseHomeExportData", "Open"),
            $('<div class="nx-section-head">').text(locale.exportData).appendTo(i);
            var o = $('<div class="nx-switch-big">').appendTo(i),
                n = $('<div class="nx-switch-big-item selected">').text(locale.exportCSV).appendTo(o),
                s = $('<div class="nx-section-pane">').appendTo(i),
                a = {},
                r = database.schema.types;
            for (var c in r)
                if (r.hasOwnProperty(c)) {
                    var d = r[c];
                    database.canRead(d) && (a[c] = d)
                }
            var h = new We({
                    $container: s,
                    types: a
                }),
                p = $('<div class="nx-button-bar">').appendTo(s);
            p.append($('<div class="nx-button-text grey">').text(locale.cancel).touch(w)),
            p.append($('<div class="nx-hspace-flex">')),
            p.append($('<div class="nx-hspace-small">')),
            p.append($('<div class="nx-button-text blue">').text(locale.csvExportOpen).touch((async function() {
                try {
                    var e = h.getType();
                    if (!e)
                        return $.alert(locale.chooseTypeToExport);
                    var t = database.schema.types[e];
                    if (!t)
                        return $.alert(locale.chooseTypeToExport);
                    Object(l.f)("ExportData", "DatabaseHomeCSVOpen"),
                    h.saveCSVExportOptions();
                    var i,
                        o = h.getCSVExportOptions(),
                        n = await async function(e, t) {
                            var i,
                                o,
                                n,
                                s = e.sorted,
                                a = [],
                                r = t.sep || ",",
                                l = (new RegExp("\\" + r, "g"), t.lf || "\r\n"),
                                c = t.qut || '"',
                                d = new RegExp("\\" + c, "g"),
                                h = (t.encoding, t.numberFormat || "point"),
                                p = t.dateFormat || "locale",
                                u = t.header || !0,
                                f = t.sepHeader || !1,
                                m = "";
                            f && (m += "sep=" + r + l);
                            if (u) {
                                for (m += "Id", n = 0; n < s.length; n++)
                                    (i = s[n]).isField && "fn" !== i.base && database.canRead(i) && (a.push(i), m += r + x(i.caption));
                                m += l
                            }
                            var g = e.id,
                                v = await database.getRowIds(g);
                            if (v)
                                for (v.sort((function(e, t) {
                                    return e - t
                                })), o = 0; o < v.length; o++) {
                                    var b = v[o],
                                        y = database.loadNodeSync2(g, b);
                                    for (m += b, n = 0; n < a.length; n++) {
                                        i = a[n];
                                        var w = y[i.id];
                                        switch (i.base) {
                                        case "number":
                                            w = T(w);
                                            break;
                                        case "date":
                                            w = $(w);
                                            break;
                                        case "datx":
                                            w = C(w);
                                            break;
                                        case "timestamp":
                                            w = k(w);
                                            break;
                                        case "html":
                                            w = w ? String(w) : "";
                                            break;
                                        default:
                                            w = i.format(w)
                                        }
                                        null == w && (w = ""),
                                        m += r + x(w)
                                    }
                                    m += l
                                }
                            return m;
                            function x(e) {
                                return null == e ? "" : ("string" != typeof e && (e = String(e)), -1 !== e.indexOf(c) || -1 !== e.indexOf(r) || -1 !== e.indexOf("\n") ? c + e.replace(d, c + c) + c : e)
                            }
                            function T(e, t) {
                                if (null == e || "number" != typeof e || isNaN(e))
                                    return "";
                                switch (h) {
                                case "field":
                                    return t.format(e);
                                case "comma":
                                    return String(e).replace(".", ",");
                                default:
                                    return String(e)
                                }
                            }
                            function $(e) {
                                switch (p) {
                                case "iso":
                                    return util.formatISODate(e);
                                case "gmt":
                                    return null == e ? "" : new Date(e).toString();
                                case "timestamp":
                                    return null == e ? "" : String(e);
                                default:
                                    return util.formatLocaleDate(e)
                                }
                            }
                            function C(e) {
                                switch (p) {
                                case "iso":
                                    return util.formatISODatx(e);
                                case "gmt":
                                    return null == e ? "" : new Date(e).toString();
                                case "timestamp":
                                    return null == e ? "" : String(e);
                                default:
                                    return util.formatLocaleDatx(e)
                                }
                            }
                            function k(e) {
                                switch (p) {
                                case "iso":
                                    return util.formatISODateTime(e);
                                case "gmt":
                                    return null == e ? "" : new Date(e).toString();
                                case "timestamp":
                                    return null == e ? "" : String(e);
                                default:
                                    return util.formatLocaleDateTime(e)
                                }
                            }
                        }(t, o);
                    i = "data:text/csv;charset=utf-8," + n,
                    window.open(i)
                } catch (e) {
                    return $.alert(e)
                }
            })));
            var u,
                f = $('<div class="nx-switch-big-item">').text(locale.exportXLS).appendTo(o),
                m = $('<div class="nx-section-pane">').hide().appendTo(i),
                g = $('<div class="nx-list" style="padding:0 16px;height:204px;overflow-x:hidden;overflow-y:auto">').appendTo($('<div class="nx-list-container">').appendTo(m));
            if (tables.xlsExportTids) {
                u = {};
                for (var v = 0; v < tables.xlsExportTids.length; v++)
                    u[tables.xlsExportTids[v]] = !0
            }
            T.each(util.localeSortBy(a, "caption"), (function(e) {
                $('<div style="line-height:32px">').append($('<input type="checkbox"' + (void 0 === u || u[e.id] ? ' checked="checked"' : "") + ">").data("tid", e.id)).append($("<label>").text(e.caption)).appendTo(g)
            }));
            var b = $('<div class="nx-button-bar">').appendTo(m);
            function y() {
                var e,
                    t;
                tables.xlsExportTids = (e = [], t = g.find("input:checked"), T.each(t, (function(t) {
                    e.push($(t).data("tid"))
                })), e)
            }
            function w() {
                t.close(x)
            }
            function x() {
                h.destroy()
            }
            b.append($('<div class="nx-button-text grey">').text(locale.cancel).touch(w)),
            b.append($('<div class="nx-hspace-flex">')),
            b.append($('<div class="nx-hspace-small">')),
            b.append($('<div class="nx-button-text blue">').text(locale.xlsExportOpen).touch((async function() {
                try {
                    y();
                    var e,
                        t = await async function(e) {
                            for (var t = [], i = 0; i < e.length; i++) {
                                var o = e[i],
                                    n = database.schema.types[o];
                                n && database.canRead(n) && t.push(await s(n))
                            }
                            return xlsx({
                                worksheets: t
                            }).base64;
                            async function s(e) {
                                var t,
                                    i = e.sorted,
                                    o = [],
                                    n = [],
                                    s = [];
                                n.push(s),
                                s.push({
                                    value: "Id",
                                    autoWidth: !0
                                });
                                var a,
                                    r,
                                    l,
                                    c = {
                                        id: !0
                                    };
                                for (r = 0; r < i.length; r++)
                                    if (((t = i[r]).isField && "fn" !== t.base || t.isReference) && database.canRead(t)) {
                                        o.push(t);
                                        for (var d = util.escapeXLSColumnHead(t.caption, r), h = d, p = 2; c[h.toLocaleLowerCase()]; p++)
                                            h = d + p;
                                        c[h.toLocaleLowerCase()] = !0,
                                        s.push({
                                            value: h,
                                            autoWidth: !0
                                        })
                                    }
                                var u,
                                    f = e.id,
                                    m = await database.getRowIds(f);
                                if (m && m.length)
                                    for (m.sort((function(e, t) {
                                        return e - t
                                    })), await (u = m.map(e => f + e), new Promise((e, t) => {
                                        database.loadNodes(u, () => {
                                            e()
                                        })
                                    })), a = 0; a < m.length; a++) {
                                        var g = m[a],
                                            v = database.loadNodeSync2(f, g);
                                        for (s = [], n.push(s), s.push(g), r = 0; r < o.length; r++)
                                            if ((t = o[r]).isReference)
                                                l = null == (l = v[t.id]) || "" === l ? "" : parseInt(l),
                                                s.push(l);
                                            else {
                                                switch (l = v[t.id], t.base) {
                                                case "number":
                                                    break;
                                                case "date":
                                                case "timestamp":
                                                    null != l && (l = new Date(l));
                                                    break;
                                                case "datx":
                                                    null != l && (l = new Date(l), l = new Date(l.getUTCFullYear(), l.getUTCMonth(), l.getUTCDate()));
                                                    break;
                                                case "html":
                                                    l = l ? String(l) : "";
                                                    break;
                                                default:
                                                    l = t.format(l)
                                                }
                                                null == l && (l = ""),
                                                s.push(l)
                                            }
                                    }
                                else
                                    for (s = [], n.push(s), r = 0; r < i.length; r++)
                                        s[r] = "";
                                return {
                                    table: !0,
                                    name: util.escapeFileName(e.caption).substr(0, 30),
                                    data: n
                                }
                            }
                        }(tables.xlsExportTids);
                    e = "data:application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;base64," + t,
                    window.open(e)
                } catch (e) {
                    $.alert(e)
                }
            }))),
            n.touch((function() {
                n.addClass("selected"),
                f.removeClass("selected"),
                s.show(),
                m.hide()
            })),
            f.touch((function() {
                n.removeClass("selected"),
                f.addClass("selected"),
                s.hide(),
                m.show()
            }))
        }
        We.prototype.destroy = function() {
            this.csvTypeField && this.csvTypeField.destroy(),
            this.csvHeaderField.destroy(),
            this.csvSepHeaderField.destroy(),
            this.csvSeparatorField.destroy(),
            this.csvQuoteField.destroy(),
            this.csvLinefeedField.destroy(),
            this.csvNumberFormatField.destroy(),
            this.csvDateFormatField.destroy(),
            this.csvEncodingField.destroy()
        },
        We.prototype.getType = function() {
            return this.csvType ? this.csvType.value : void 0
        },
        We.prototype.getCSVExportOptions = function() {
            return {
                sep: this.csvSeparator.value,
                qut: this.csvQuote.value,
                lf: this.csvLinefeed.value,
                numberFormat: this.csvNumberFormat.value,
                dateFormat: this.csvDateFormat.value,
                header: this.csvHeader.value,
                sepHeader: this.csvSepHeader.value,
                encoding: this.csvEncoding.value
            }
        },
        We.prototype.saveCSVExportOptions = function() {
            ze.csvHeaderDefault = this.csvHeader.value,
            ze.csvSepHeaderDefault = this.csvSepHeader.value,
            ze.csvLinefeedDefault = this.csvLinefeed.value,
            ze.csvSeparatorDefault = this.csvSeparator.value,
            ze.csvQuoteDefault = this.csvQuote.value,
            ze.csvEncodingDefault = this.csvEncoding.value,
            ze.csvDateFormatDefault = this.csvDateFormat.value,
            ze.csvNumberFormatDefault = this.csvNumberFormat.value
        };
        o("./node_modules/core-js/modules/web.url.to-json.js");
        const qe = {
            importCSVEncodingDefault: "utf8",
            importCSVHeaderDefault: !0,
            importCSVQuoteDefault: '"',
            importCSVSeparatorDefault: void 0,
            importCSVNumberFormatDefault: void 0,
            importCSVDateFormatDefault: "auto",
            importTypeDefault: void 0,
            importModeDefault: "all",
            importAmbiguousDefault: "skip"
        };
        function Ye(e) {
            void 0 === qe.importCSVNumberFormatDefault && (NinoxDocumentInteraction.defaultDecimalSymbolIsComma() ? (qe.importCSVNumberFormatDefault = "comma", qe.importCSVSeparatorDefault = ";") : (qe.importCSVNumberFormatDefault = "point", qe.importCSVSeparatorDefault = ","));
            var t = null,
                i = null,
                o = "",
                n = [],
                s = [],
                a = [],
                r = !1,
                c = null,
                d = null,
                h = null;
            function p() {
                if (!database.authorizationImport)
                    return $.alert(locale.notAuthorized);
                if (e.url)
                    return i = e.url, void setTimeout(u, 0);
                var o = $.popdown(),
                    n = o.$pane;
                t = null,
                i = null,
                $('<div class="nx-section-head">').text(locale.importData).appendTo(n);
                var s = $.tabs({
                    $parent: n,
                    tabs: [{
                        caption: "CSV"
                    }]
                });
                {
                    var a = $('<div class="editor center" style="width:100%">').appendTo(s.tabs[0].$pane);
                    const e = $('<div class="import-choose-from">').text(locale.importChooseCSVFile).appendTo(a);
                    $('<input type="file" class="import-assistant-file">').appendTo(e).touch(() => Object(l.f)("ImportData", "ChooseCSV")).change((function(e) {
                        Object(l.f)("ImportData", "FileSelected");
                        var o = e.target.files;
                        if (!o)
                            return;
                        if (0 === o.length)
                            return;
                        if (o.length > 1)
                            return $.alert(locale.importTooManyFilesSelected);
                        t = o[0],
                        i = null,
                        r()
                    }))
                }
                function r() {
                    Object(l.f)("ImportData", "ChooseSourceConfirm"),
                    c(),
                    setTimeout(u, 0)
                }
                function c() {
                    o.close()
                }
                $('<div class="nx-button-bar">').appendTo(s.tabs[0].$pane).append($('<div class="nx-button-text grey">').text(locale.cancel).touch(c))
            }
            function u() {
                var h = $.popdown(),
                    u = h.$pane;
                $('<div class="nx-section-head">').text(locale.importSourceSettings).appendTo(u);
                var m = $('<div class="nx-section-pane">').appendTo(u),
                    v = new b.util.SimpleModel(new schemas.TChoice(void 0, void 0, {
                        caption: locale.csvEncoding,
                        required: !0,
                        formWidth: 2 / 3,
                        values: {
                            utf8: {
                                caption: "UTF-8 (Unicode)",
                                order: 1
                            },
                            utf16: {
                                caption: "UTF-16 (Unicode)",
                                order: 13
                            },
                            ascii: {
                                caption: "ASCII",
                                order: 14
                            },
                            "mac-roman": {
                                caption: "Mac Roman",
                                order: 2
                            },
                            "windows-cp1252": {
                                caption: "Windows Latin 1 CP1252",
                                order: 3
                            },
                            "windows-cp1250": {
                                caption: "Windows Latin 2 CP1250",
                                order: 4
                            },
                            "windows-cp1251": {
                                caption: "Windows Cyrillic CP1251",
                                order: 5
                            },
                            "windows-cp1253": {
                                caption: "Windows Greek CP1253",
                                order: 6
                            },
                            "windows-cp1254": {
                                caption: "Windows Turkish CP1254",
                                order: 7
                            },
                            "iso-latin1": {
                                caption: "ISO Latin 1",
                                order: 8
                            },
                            "iso-latin2": {
                                caption: "ISO Latin 2",
                                order: 9
                            },
                            "japanese-euc": {
                                caption: "Japanese EUC",
                                order: 10
                            },
                            "japanese-shift": {
                                caption: "Japanese SHIFT",
                                order: 11
                            },
                            "japanese-iso": {
                                caption: "Japanese ISO",
                                order: 12
                            }
                        }
                    }));
                v.value = qe.importCSVEncodingDefault;
                new Ue.a(void 0, v, m);
                var y = new b.util.SimpleModel(new schemas.TBoolean(void 0, void 0, {
                    caption: locale.importHeader,
                    booleanDefault: !0,
                    required: !0,
                    formWidth: 1 / 3
                }));
                y.value = qe.importCSVHeaderDefault;
                new Ue.a(void 0, y, m);
                var w = new b.util.SimpleModel(new schemas.TChoice(void 0, void 0, {
                    caption: locale.csvSeparator,
                    required: !0,
                    formWidth: 1 / 4,
                    values: {
                        ",": {
                            caption: ",",
                            order: 1
                        },
                        ";": {
                            caption: ";",
                            order: 2
                        },
                        "|": {
                            caption: "|",
                            order: 3
                        },
                        "\t": {
                            caption: locale.csvSeparatorTab,
                            order: 4
                        }
                    }
                }));
                w.value = qe.importCSVSeparatorDefault;
                new Ue.a(void 0, w, m);
                var x = new b.util.SimpleModel(new schemas.TChoice(void 0, void 0, {
                    caption: locale.csvQuote,
                    required: !0,
                    formWidth: 1 / 4,
                    values: {
                        '"': {
                            caption: '"'
                        },
                        "'": {
                            caption: "'"
                        }
                    }
                }));
                x.value = qe.importCSVQuoteDefault;
                new Ue.a(void 0, x, m);
                var C = new b.util.SimpleModel(new schemas.TChoice(void 0, void 0, {
                    caption: locale.csvNumberFormat,
                    required: !0,
                    formWidth: 1 / 4,
                    values: {
                        point: {
                            caption: locale.csvNumberFormatPoint,
                            order: 1
                        },
                        comma: {
                            caption: locale.csvNumberFormatComma,
                            order: 2
                        }
                    }
                }));
                C.value = qe.importCSVNumberFormatDefault;
                new Ue.a(void 0, C, m);
                var k = new b.util.SimpleModel(new schemas.TChoice(void 0, void 0, {
                    caption: locale.csvDateFormat,
                    required: !0,
                    formWidth: 1 / 4,
                    values: {
                        auto: {
                            caption: "auto",
                            order: 1
                        },
                        "YYYY-MM-DD": {
                            caption: "YYYY-MM-DD",
                            order: 2
                        },
                        "DD/MM/YY": {
                            caption: "DD/MM/YY",
                            order: 3
                        },
                        "DD/MM/YYYY": {
                            caption: "DD/MM/YYYY",
                            order: 4
                        },
                        "MM/DD/YY": {
                            caption: "MM/DD/YY",
                            order: 5
                        },
                        "MM/DD/YYYY": {
                            caption: "MM/DD/YYYY",
                            order: 6
                        },
                        "MMM, DD YYYY": {
                            caption: "MMM, DD YYYY",
                            order: 7
                        },
                        "DD.MM.YYYY": {
                            caption: "DD.MM.YYYY",
                            order: 8
                        }
                    }
                }));
                k.value = qe.importCSVDateFormatDefault;
                new Ue.a(void 0, k, m);
                $('<div class="nx-section-head">').text(locale.importTargetSettings).appendTo(u),
                m = $('<div class="nx-section-pane">').appendTo(u);
                var S = {};
                database.isAdminEnabled() && (S["#new#"] = {
                    id: "#new#",
                    caption: locale.importCreateTable,
                    order: -1
                }),
                T.each(b.util.localeSortBy(database.schema.types, "caption"), (function(e, t) {
                    S[e.id] = {
                        id: e.id,
                        caption: e.caption,
                        oder: t
                    }
                }));
                var E = new b.util.SimpleModel(new schemas.TChoice(void 0, void 0, {
                    caption: locale.importTable,
                    required: !0,
                    formWidth: 1,
                    values: S
                }));
                S[qe.importTypeDefault] || (qe.importTypeDefault = "#new#"),
                E.value = e.tid || qe.importTypeDefault,
                database.isAdminEnabled() || "#new#" !== E.value || (E.value = void 0);
                new Ue.a(void 0, E, m);
                var _ = new b.util.SimpleModel(new schemas.TChoice(void 0, void 0, {
                    caption: locale.importMode,
                    required: !0,
                    formWidth: 2 / 3,
                    values: {
                        all: {
                            id: "all",
                            caption: locale.importModeAll
                        },
                        new: {
                            id: "new",
                            caption: locale.importModeNew
                        },
                        update: {
                            id: "update",
                            caption: locale.importModeUpdate
                        }
                    }
                }));
                _.value = qe.importModeDefault;
                new Ue.a(void 0, _, m);
                var D = new b.util.SimpleModel(new schemas.TChoice(void 0, void 0, {
                    caption: locale.importAmbiguous,
                    required: !0,
                    formWidth: 1 / 3,
                    values: {
                        skip: {
                            id: "skip",
                            caption: locale.importAmbiguousSkip
                        },
                        updateAll: {
                            id: "updateAll",
                            caption: locale.importAmbiguousUpdateAll
                        }
                    }
                }));
                D.value = qe.importAmbiguousDefault;
                new Ue.a(void 0, D, m);
                var M = $('<div class="nx-button-bar">').appendTo(m);
                function N() {
                    qe.importCSVEncodingDefault = v.value,
                    qe.importCSVHeaderDefault = y.value,
                    qe.importCSVSeparatorDefault = w.value,
                    qe.importCSVQuoteDefault = x.value,
                    qe.importCSVNumberFormatDefault = C.value,
                    qe.importCSVDateFormatDefault = k.value,
                    qe.importTypeDefault = E.value,
                    qe.importModeDefault = _.value,
                    qe.importAmbiguousDefault = D.value
                }
                $('<div class="nx-button-text grey">').text(locale.cancel).appendTo(M).touch((function() {
                    h.close()
                })),
                $('<div class="nx-hspace-flex">').appendTo(M),
                $('<div class="nx-button-text grey">').text(locale.back).appendTo(M).touch((function() {
                    N(),
                    h.close(),
                    setTimeout(p, 0)
                })),
                $('<div class="nx-hspace-small">').appendTo(M),
                $('<div class="nx-button-text blue">').text(locale.next).appendTo(M).touch((function() {
                    if (Object(l.f)("Import CSV", "DataSource&ImportSettingsNext"), !S[E.value])
                        return $.alert(locale.importTable);
                    N(),
                    $.loading(!0),
                    setTimeout((function() {
                        !async function(e) {
                            if (i)
                                try {
                                    const t = await localFileSystem.readURL(i, qe.importCSVEncodingDefault);
                                    o = t,
                                    e()
                                } catch (t) {
                                    e(t)
                                }
                            else if (t) {
                                var n = {
                                    utf8: "utf-8",
                                    utf16: "UTF-16",
                                    ascii: "ASCII",
                                    "mac-roman": "mac",
                                    "windows-cp1252": "windows-1252",
                                    "windows-cp1250": "windows-1250",
                                    "windows-cp1251": "windows-1251",
                                    "windows-cp1253": "windows-1253",
                                    "windows-cp1254": "windows-1254",
                                    "iso-latin1": "iso-8859-1",
                                    "iso-latin2": "iso-8859-2",
                                    "japanese-euc": "euc-jp",
                                    "japanese-shift": "csshiftjis",
                                    "japanese-iso": "iso-2022-jp"
                                }[qe.importCSVEncodingDefault];
                                n || (n = "utf-8");
                                var s = new FileReader;
                                s.onerror = function() {
                                    e(s.error)
                                },
                                s.onloadend = function(t) {
                                    o = s.result,
                                    e()
                                },
                                s.readAsText(t, n)
                            } else
                                $.alert("Nothing to import.")
                        }((function(e) {
                            if (e)
                                return $.loading(!1), "InvalidEncoding" === e && (e = locale.invalidEncoding), $.alert(e);
                            !function(e) {
                                if (!(n = b.util.parseCSV(o, {
                                    sep: qe.importCSVSeparatorDefault,
                                    qut: qe.importCSVQuoteDefault
                                })) || n.length < 1)
                                    return e(locale.importNoDataFound);
                                qe.importCSVHeaderDefault ? (s = n[0], a = n.slice(1)) : (s = [], a = n);
                                for (var t = 0, i = 0; i < a.length; i++)
                                    t = Math.max(t, a[i].length);
                                for (i = 0; i < t; i++)
                                    s[i] || (s[i] = locale.column + (i + 1));
                                e()
                            }((function(e) {
                                if ($.loading(!1), e)
                                    return $.alert(e);
                                if (h.close(), "#new#" === E.value)
                                    setTimeout(g, 0);
                                else {
                                    if (r = !1, c = database.schema, !(d = c.types[E.value]))
                                        return $.alert(locale.errorTypeNotFound);
                                    setTimeout(f, 0)
                                }
                            }))
                        }))
                    }), 0)
                }))
            }
            function f() {
                for (var e = $('<div class="nx-backplane nx-backplane-dark">').appendTo($(document.body)), t = $('<div class="import2-pane">').appendTo(e), i = new schemas.TChoice(void 0, void 0, {
                        width: 1,
                        required: !0,
                        values: {
                            "key-exact": {
                                id: "key-exact",
                                caption: locale.importFieldModeKeyExact
                            },
                            "update-always": {
                                id: "update-always",
                                caption: locale.importFieldModeUpdateAlways
                            },
                            "update-empty": {
                                id: "update-empty",
                                caption: locale.importFieldModeUpdateEmpty
                            }
                        }
                    }), o = {}, n = [], a = [], r = [], c = m(!1), p = 0; p < s.length; p++) {
                    (r[p] = {
                        index: p,
                        caption: s[p],
                        base: c[p],
                        importFieldModeModel: new b.util.SimpleModel(i, "update-always")
                    }).importFieldModeModel.withoutLabel = !0
                }
                window.getHeight();
                var f = $('<div class="popupeditor panel centered width-768 fullheight">').appendTo(t).droppable({
                        accept: ".import-available-field",
                        drop: function(e, t) {
                            $(e.target);
                            var i = t.draggable.data("col");
                            if (!i)
                                return;
                            var s = n[i.index];
                            s && (delete n[i.index], delete a[i.index], delete o[s], setTimeout(S, 0))
                        }
                    }),
                    g = $('<div class="pane import-fields-pane">').appendTo(f);
                $("<h1>").text(locale.importFields).appendTo(g);
                var y = $('<div style="position:absolute;top:32px;left:0;right:0;bottom:0;overflow:auto">').appendTo(g),
                    w = $('<div class="pane import-availables-pane">').appendTo(f);
                $("<h1>").text(locale.importAvailableFields).appendTo(w);
                var x = $('<div class="import-availables" style="position:absolute;top:48px;left:0;right:0;bottom:0;overflow:auto">').appendTo(w),
                    C = $('<div class="nx-button-bar" style="position:absolute;left:16px;bottom:8px;right:16px;height:32px">').appendTo(f);
                function k(e, t) {
                    var i = $(e.target),
                        s = t.draggable,
                        r = i.closest(".import-col").data("col");
                    if (r) {
                        var l = s.data("field");
                        if (l) {
                            var c = s.data("refField"),
                                d = s.data("col");
                            if (d) {
                                n[d.index];
                                delete n[d.index],
                                delete a[d.index],
                                delete o[l.id]
                            }
                            var h = n[r.index];
                            h && (delete n[r.index], delete a[r.index], delete o[h]),
                            n[r.index] = l.id,
                            c && (a[r.index] = c.id),
                            o[l.id] = r.index,
                            "_id" !== l.id || c || r.importFieldModeModel.setValue("key-exact"),
                            setTimeout(S, 0)
                        }
                    }
                }
                function S() {
                    !function() {
                        y.empty();
                        var e = {
                                greedy: !0,
                                accept: ".import-available-field",
                                hoverClass: "hover",
                                drop: k
                            },
                            t = {
                                helper: "clone",
                                appendTo: $(document.body),
                                zIndex: 1e3
                            };
                        T.each(r, (function(i) {
                            var o = $('<div class="import-col">').data("col", i).appendTo(y);
                            $(`<div class="import-col-source-assign" title="${i.caption}">`).append($('<div class="t-columneditor-label type-symbol-grey">').addClass("type-symbol-" + (i.base || "string"))).append($('<div class="t-columneditor-label">').text(i.caption)).appendTo(o);
                            $('<div class="import-col-arrow">').appendTo(o);
                            var s = $('<div class="import-col-target-assign">').appendTo(o).droppable(e);
                            if (d) {
                                var r = n[i.index];
                                if (r) {
                                    var l = "_id" === r ? d.field_id : d.fields[r];
                                    if (l)
                                        if ("_id" === r)
                                            $('<div class="import-available-field t-columneditor-column">').data("field", l).data("col", i).appendTo(s).append($('<div class="t-columneditor-label type-symbol-grey">').addClass("type-symbol-" + l.base)).append($('<div class="t-columneditor-label">').text(l.caption)).draggable(t);
                                        else if (l.isField) {
                                            $('<div class="import-available-field t-columneditor-column">').data("field", l).data("col", i).appendTo(s).append($('<div class="t-columneditor-label type-symbol-grey">').addClass("type-symbol-" + l.base)).append($('<div class="t-columneditor-label">').text(l.caption)).draggable(t);
                                            new Ue.a(void 0, i.importFieldModeModel, o).el.css("width", 150)
                                        } else if (l.isReference) {
                                            var c = a[i.index],
                                                h = l.refType,
                                                p = "_id" === c ? h.field_id : h.fields[c];
                                            if (p) {
                                                $('<div class="import-available-field t-columneditor-column">').data("field", l).data("refField", p).data("col", i).appendTo(s).append($('<div class="t-columneditor-label type-symbol-grey">').addClass("type-symbol-" + l.base)).append($('<div class="t-columneditor-label">').text(l.caption + " (" + p.caption + ")")).draggable(t);
                                                new Ue.a(void 0, i.importFieldModeModel, o).el.css("width", 150)
                                            }
                                        }
                                }
                            }
                        }))
                    }(),
                    function() {
                        x.empty();
                        var e = {
                            helper: "clone",
                            appendTo: $(document.body),
                            zIndex: 1e3
                        };
                        void 0 === o._id && $('<div class="import-available-field t-columneditor-column">').data("field", d.field_id).appendTo(x).append($('<div class="t-columneditor-label type-symbol-grey">').addClass("type-symbol-" + d.field_id.base)).append($('<div class="t-columneditor-label">').text(d.field_id.caption)).draggable(e);
                        T.each(d.sorted, (function(t) {
                            if (t.isField && database.canWrite(t)) {
                                if (void 0 === o[t.id])
                                    var i = $('<div class="import-available-field t-columneditor-column">').data("field", t).appendTo(x).append($('<div class="t-columneditor-label type-symbol-grey">').addClass("type-symbol-" + t.base)).append($('<div class="t-columneditor-label">').text(t.caption)).draggable(e)
                            } else if (t.isReference && database.canWrite(t) && void 0 === o[t.id]) {
                                var n = t.refType,
                                    s = (i = $('<div class="import-available-field t-columneditor-column expandable">').data("field", t).appendTo(x), $('<div class="t-columneditor-label icon-big-black icon-big-expand">').appendTo(i));
                                $('<div class="t-columneditor-label">').text(t.caption).appendTo(i);
                                var a = $('<div style="padding-left:32px">').hide().appendTo(x);
                                $('<div class="import-available-field t-columneditor-column">').data("field", t).data("refField", n.field_id).appendTo(a).append($('<div class="t-columneditor-label type-symbol-grey">').addClass("type-symbol-" + t.base)).append($('<div class="t-columneditor-label">').text(n.field_id.caption)).draggable(e),
                                T.each(n.sorted, (function(i) {
                                    "number" !== i.base && "string" !== i.base || $('<div class="import-available-field t-columneditor-column">').data("field", t).data("refField", i).appendTo(a).append($('<div class="t-columneditor-label type-symbol-grey">').addClass("type-symbol-" + i.base)).append($('<div class="t-columneditor-label">').text(i.caption)).draggable(e)
                                })),
                                i.click((function() {
                                    a.toggle(),
                                    s.toggleClass("icon-big-expand icon-big-collapse")
                                }))
                            }
                        }))
                    }()
                }
                $('<div class="nx-button-text grey">').text(locale.cancel).appendTo(C).touch((function() {
                    e.remove()
                })),
                $('<div class="nx-hspace-flex">').appendTo(C),
                $('<div class="nx-button-text grey">').text(locale.back).appendTo(C).touch((function() {
                    e.remove(),
                    setTimeout(u, 0)
                })),
                $('<div class="nx-hspace-small">').appendTo(C),
                $('<div class="nx-button-text blue">').text(locale.next).appendTo(C).touch((function() {
                    Object(l.f)("ImportData", "FieldsNext"),
                    h = [];
                    for (var t = 0; t < r.length; t++) {
                        var i = r[t],
                            o = n[i.index];
                        if (o) {
                            var s = "_id" === o ? d.field_id : d.fields[o];
                            if ("_id" === o && h.push({
                                index: t,
                                field: s,
                                mode: "key-exact"
                            }), s.isField)
                                h.push({
                                    index: t,
                                    field: s,
                                    mode: i.importFieldModeModel.value
                                });
                            else if (s.isReference) {
                                var c = s.refType,
                                    p = a[i.index],
                                    u = "_id" === p ? c.field_id : c.fields[p];
                                u && h.push({
                                    index: t,
                                    field: s,
                                    refField: u,
                                    mode: i.importFieldModeModel.value
                                })
                            }
                        }
                    }
                    e.remove(),
                    setTimeout(v, 0)
                })),
                function() {
                    for (var e = d.sorted, t = 0; t < r.length; t++) {
                        var i = r[t];
                        if (!n[i.index])
                            for (var s = 0; s < e.length; s++) {
                                var a = e[s];
                                a.isField && database.canWrite(a) && void 0 === o[a.id] && (l = i.caption, c = a.caption, String(l).toLowerCase() == String(c).toLowerCase()) && (n[i.index] = a.id, o[a.id] = i.index)
                            }
                    }
                    var l,
                        c
                }(),
                S()
            }
            function m(e) {
                for (var t = [], i = 0; i < s.length; i++)
                    for (var o = t[i] = {
                            boolean: !0,
                            number: !0,
                            date: !0,
                            timestamp: !0,
                            multiline: !1
                        }, n = 0; n < a.length && n < 100; n++) {
                        var r = a[n][i];
                        "" !== r && null != r && (o.boolean && void 0 === Xe(r) && (o.boolean = !1), o.number && !Ge(r, qe.importCSVNumberFormatDefault) && (o.number = !1), o.date && !1 === tt(r) && (o.date = !1), o.timestamp && !1 === Ze(r) && (o.timestamp = !1), !o.multiline && /[\r\n]/.test(r) && (o.multiline = !0))
                    }
                var l = [];
                for (i = 0; i < t.length; i++) {
                    o = t[i];
                    l[i] = o.number ? "number" : o.boolean ? "boolean" : o.date ? "datx" : o.timestamp ? "timestamp" : e && o.multiline ? "string-multiline" : "string"
                }
                return l
            }
            function g() {
                r = !0,
                c = database.schema.clone(),
                d = null;
                var e = $('<div class="nx-backplane nx-backplane-dark">').appendTo($(document.body)),
                    o = $('<div class="import2-pane">').appendTo(e),
                    n = $('<div class="popupeditor pane centered width-3col fullheight">').appendTo(o),
                    a = $("<div>").appendTo(n),
                    p = new b.util.SimpleModel(new schemas.TString(void 0, void 0, {
                        caption: locale.enterTableName,
                        required: !0,
                        formWidth: 1
                    }));
                if (i) {
                    var f = /\/([^\/\?\.]+)(?:\.[^\?\/]*)?(?:\?.*)?$/.exec(i);
                    f && (p.value = decodeURIComponent(f[1]))
                } else
                    t && (p.value = t.name);
                new Ue.a(void 0, p, a);
                for (var g = $('<div style="position:absolute;left:24px;top:80px;right:0px;bottom:48px;overflow-y:auto;overflow-x:hidden">').appendTo(n), y = new schemas.TChoice(void 0, void 0, {
                        formWidth: 1,
                        required: !0,
                        values: {
                            string: {
                                id: "string",
                                caption: locale.types.string,
                                order: 1
                            },
                            "string-multiline": {
                                id: "string-multiline",
                                caption: locale.types.string_multiline,
                                order: 1.5
                            },
                            html: {
                                id: "html",
                                caption: locale.types.html,
                                order: 2
                            },
                            number: {
                                id: "number",
                                caption: locale.types.number,
                                order: 3
                            },
                            boolean: {
                                id: "boolean",
                                caption: locale.types.boolean,
                                order: 4
                            },
                            choice: {
                                id: "choice",
                                caption: locale.types.choice,
                                order: 5
                            },
                            date: {
                                id: "date",
                                caption: locale.types.date,
                                order: 6
                            },
                            time: {
                                id: "time",
                                caption: locale.types.time,
                                order: 8
                            },
                            timestamp: {
                                id: "timestamp",
                                caption: locale.types.timestamp,
                                order: 9
                            },
                            timeinterval: {
                                id: "timeinterval",
                                caption: locale.types.timeinterval,
                                order: 10
                            },
                            appointment: {
                                id: "appointment",
                                caption: locale.types.appointment,
                                order: 11
                            },
                            link: {
                                id: "link",
                                caption: locale.types.link,
                                order: 12
                            },
                            email: {
                                id: "email",
                                caption: locale.types.email,
                                order: 13
                            },
                            phone: {
                                id: "phone",
                                caption: locale.types.phone,
                                order: 14
                            },
                            location: {
                                id: "location",
                                caption: locale.types.location,
                                order: 15
                            },
                            color: {
                                id: "color",
                                caption: locale.types.color,
                                order: 16
                            },
                            icon: {
                                id: "icon",
                                caption: locale.types.icon,
                                order: 17
                            }
                        }
                    }), w = m(!0), x = [], T = 0; T < s.length; T++) {
                    var C = s[T],
                        k = x[T] = {},
                        S = $('<div class="import-col">').appendTo(g),
                        E = $('<div class="import-col-source-create">').appendTo(S),
                        _ = new b.util.SimpleModel(new schemas.TString(void 0, void 0, {
                            required: !0,
                            stringMinLength: 1,
                            caption: locale.fieldCaption,
                            formWidth: 1
                        }));
                    _.withoutLabel = !0,
                    _.value = C,
                    k.name = _;
                    new Ue.a(void 0, _, E);
                    $('<div class="import-col-arrow">').appendTo(S);
                    var D = $('<div class="import-col-target-create">').appendTo(S),
                        M = new b.util.SimpleModel(y);
                    M.withoutLabel = !0,
                    M.value = w[T],
                    k.type = M,
                    new Ue.a(void 0, M, D).el.css({
                        margin: 0,
                        width: 200
                    })
                }
                var N = $('<div class="nx-button-bar" style="position:absolute;left:16px;bottom:8px;right:16px;height:32px">').appendTo(n);
                $('<div class="nx-button-text grey">').text(locale.cancel).appendTo(N).touch((function() {
                    e.remove()
                })),
                $('<div class="nx-hspace-flex">').appendTo(N),
                $('<div class="nx-button-text grey">').text(locale.back).appendTo(N).touch((function() {
                    e.remove(),
                    setTimeout(u, 0)
                })),
                $('<div class="nx-hspace-small">').appendTo(N),
                $('<div class="nx-button-text blue">').text(locale.next).appendTo(N).touch((function() {
                    Object(l.f)("ImportData", "UpdateTableAndFieldsNext"),
                    d = c.createType(p.value),
                    h = [];
                    for (var t = 0; t < x.length; t++) {
                        var i = x[t],
                            o = c.createField2(d, {
                                base: "string-multiline" === i.type.value ? "string" : i.type.value,
                                caption: i.name.value,
                                order: t,
                                stringMultiline: "string-multiline" === i.type.value || void 0
                            });
                        h.push({
                            index: t,
                            field: o,
                            mode: "update-always"
                        })
                    }
                    e.remove(),
                    setTimeout(v, 0)
                }))
            }
            function v() {
                for (var t = qe.importModeDefault, i = qe.importAmbiguousDefault, o = h, n = {}, s = [], p = [], u = [], m = [], v = 0; v < o.length; v++) {
                    var b = o[v],
                        w = b.mode,
                        x = b.field;
                    if (x && w)
                        switch (w) {
                        case "key-exact":
                            p.push({
                                col: b,
                                field: x,
                                index: {}
                            });
                            break;
                        case "update-always":
                            if (!x.isNew && !database.canWrite(x))
                                return y(locale.errorNotAuthorized + ": " + x.caption);
                            u.push({
                                col: b,
                                field: x,
                                always: !0
                            }),
                            x.isReference && m.push(b);
                            break;
                        case "update-empty":
                            if (!x.isNew && !database.canWrite(x))
                                return y(locale.errorNotAuthorized + ": " + x.caption);
                            u.push({
                                col: b,
                                field: x,
                                always: !1
                            }),
                            x.isReference && m.push(b)
                        }
                }
                function C() {
                    for (var o = [], h = {}, m = 0; m < p.length; m++) {
                        var v = (R = p[m]).index,
                            b = R.field.id;
                        for (var y in n) {
                            if (n.hasOwnProperty(y))
                                null == (N = (E = n[y])[b]) && (N = ""),
                                "_id" === b && (N = schemas.ridOf(N)),
                                (C = v[N]) || (C = v[N] = []),
                                C.push(y)
                        }
                    }
                    for (var w = 0; w < a.length; w++) {
                        var x = a[w],
                            C = void 0;
                        for (m = 0; m < p.length; m++) {
                            null == (N = x[(R = p[m]).col.index]) && (N = ""),
                            N = "_id" === R.field.id ? N : ot(N, R.field);
                            var k = R.index[N];
                            C = k ? C ? T.intersection(C, k) : k : []
                        }
                        if (C && C.length > 0) {
                            if (C.length > 0 && (1 === C.length || "updateAll" === i))
                                for (var S = 0; S < C.length; S++) {
                                    y = C[S];
                                    var E = n[y],
                                        _ = h[y];
                                    _ || (_ = {
                                        _id: y
                                    });
                                    for (var D = 0, M = 0; M < u.length; M++) {
                                        if ("_id" !== (L = (j = u[M]).field).id) {
                                            var N = x[(F = j.col).index],
                                                I = E[L.id];
                                            if (L.isField)
                                                null != (A = ot(N, L)) && "" !== A || (A = null),
                                                j.always ? A !== I && (_[L.id] = A, D++) : null != I && "" !== I || (_[L.id] = A, D++);
                                            else if (L.isReference) {
                                                if (A = F.refIndex[N])
                                                    (H = database.ridOf(A)) && (j.always ? H !== I && (_[L.id] = H, D++) : I || (_[L.id] = H, D++));
                                                else
                                                    _[L.id] = null
                                            }
                                        }
                                    }
                                    D > 0 && (h[y] = _)
                                }
                        } else {
                            D = 0;
                            var O = {
                                _type: d.id
                            };
                            for (M = 0; M < p.length; M++) {
                                var R;
                                if ("_id" !== (L = (R = p[M]).field).id)
                                    null != (A = ot(N = x[(F = R.col).index], L)) && "" !== A && (O[L.id] = A, D++)
                            }
                            for (M = 0; M < u.length; M++) {
                                var j,
                                    L;
                                if ("_id" !== (L = (j = u[M]).field).id) {
                                    var F;
                                    N = x[(F = j.col).index];
                                    if (L.isField)
                                        null != (A = ot(N, L)) && "" !== A && (O[L.id] = A, D++);
                                    else if (L.isReference) {
                                        var A,
                                            H;
                                        if (A = F.refIndex[N])
                                            (H = database.ridOf(A)) && (O[L.id] = H, D++)
                                    }
                                }
                            }
                            D > 0 && o.push(O)
                        }
                    }
                    switch (t) {
                    case "all":
                        s = T.values(h).concat(o);
                        break;
                    case "new":
                        s = o;
                        break;
                    case "update":
                        s = T.values(h);
                        break;
                    default:
                        s = []
                    }
                    !function() {
                        var t = d.sorted,
                            i = $('<div class="nx-backplane nx-backplane-dark">').appendTo($(document.body)),
                            o = $('<div class="import-preview">').appendTo(i),
                            a = $('<div class="nx-button-bar" style="position:absolute;left:0;bottom:0;right:0">').appendTo(o);
                        $('<div class="nx-button-text grey">').text(locale.cancel).touch(x).appendTo(a),
                        $('<div class="nx-hspace-flex">').appendTo(a),
                        $('<div class="nx-button-text grey">').text(locale.back).touch((function() {
                            i.remove(),
                            r ? setTimeout(g, 0) : setTimeout(f, 0)
                        })).appendTo(a),
                        $('<div class="nx-hspace-small">').appendTo(a),
                        $('<div class="nx-button-text blue">').text(locale.importExecute).touch((function() {
                            Object(l.f)("ImportData", "ImportNow"),
                            $.loading(!0),
                            r ? database.updateSchema(c, (function(t) {
                                t ? ($.loading(!1), $.alert(locale.importFailed + ": " + t)) : database.updateNodes(s, (function(t) {
                                    t ? ($.loading(!1), $.alert(locale.importFailed + ": " + t)) : ($.loading(!1), $.alert(locale.importSuccessful), Object(l.f)("ImportData", "ImportSuccessful"), x(), e.success && e.success())
                                }))
                            })) : database.updateNodes(s, (function(t) {
                                t ? ($.loading(!1), $.alert(locale.importFailed + ": " + t)) : ($.loading(!1), $.alert(locale.importSuccessful), Object(l.f)("ImportData", "ImportSuccessful"), x(), e.success && e.success())
                            }))
                        })).appendTo(a);
                        var h = $('<div style="position:absolute;left:0;top:20px;width:100%;padding:8px 0 8px 8px;box-sizing:border-box;-moz-box-sizing:border-box;text-align:right">').appendTo(o);
                        $('<div style="float:left;height:32px;line-height:32px">').text(locale.importPreview).appendTo(h),
                        h.button("prev", void 0, void 0, (function() {
                            --b < 0 && (b = y - 1);
                            w()
                        }));
                        var p = $('<div style="display:inline-block;height:32px;line-height:32px">').appendTo(h);
                        h.button("next", void 0, void 0, (function() {
                            ++b >= y && (b = 0);
                            w()
                        }));
                        var u = $('<div style="position:absolute;left:0;top:68px;width:100%;bottom:48px;overflow:auto">').appendTo(o),
                            m = window.getHeight() - 128,
                            v = Math.max(1, Math.floor(m / 33) - 1),
                            b = 0,
                            y = Math.ceil(s.length / v);
                        function w() {
                            p.text(locale.page + " " + (b + 1) + " / " + y);
                            for (var e = "<table><thead><tr><th></th>", i = 0; i < t.length; i++) {
                                ((m = t[i]).isField && "fn" !== m.base || m.isReference) && (e += "<th>" + htmlEscape(m.caption) + "</th>")
                            }
                            e += "</tr></thead><tbody>";
                            for (var o = b * v, a = Math.min(o + v, s.length), r = o; r < a; r++) {
                                var l = s[r];
                                if (e += "<tr>", l._id) {
                                    var c = l._id,
                                        d = n[c];
                                    e += "<td>" + htmlEscape(schemas.ridOf(c)) + "</td>";
                                    for (i = 0; i < t.length; i++) {
                                        if ((m = t[i]).isField && "fn" !== m.base || m.isReference) {
                                            var h = l[m.id],
                                                f = d[m.id];
                                            e += '<td class="cell-' + m.base + '">',
                                            null != f && "" !== f && (e += '<div class="import-cell-old">' + htmlEscape(m.format(f)) + "</div>"),
                                            void 0 !== h && (e += '<div class="import-cell-update">' + htmlEscape(m.format(h)) + "</div>"),
                                            e += "</td>"
                                        }
                                    }
                                } else {
                                    e += "<td>" + htmlEscape(locale.new) + "</td>";
                                    for (i = 0; i < t.length; i++) {
                                        var m;
                                        if ((m = t[i]).isField && "fn" !== m.base || m.isReference) {
                                            e += '<td class="cell-' + m.base + '">';
                                            var g = l[m.id];
                                            void 0 !== g && (e += '<div class="import-cell-update">' + htmlEscape(m.format(g)) + "</div>"),
                                            e += "</td>"
                                        }
                                    }
                                }
                                e += "</tr>"
                            }
                            e += "</tbody></table>",
                            u.html(e)
                        }
                        function x() {
                            i.remove()
                        }
                        w()
                    }()
                }
                r ? C() : ($.loading(!0), function(e) {
                    setTimeout((function() {
                        var t = "select " + d.id;
                        database.select(t, (function(t, i) {
                            if (t)
                                return e(t);
                            database.loadNodes(i, (function(t) {
                                if (t)
                                    return e(t);
                                for (var o = 0; o < i.length; o++) {
                                    var s = i[o],
                                        a = database.loadNodeSync(s);
                                    a && (n[s] = a)
                                }
                                e()
                            }))
                        }))
                    }), 0)
                }((function(e) {
                    if (e)
                        return $.loading(!1), y(e);
                    !function(e) {
                        setTimeout((function t(i) {
                            if (i === m.length)
                                return e();
                            var o = m[i],
                                n = {};
                            o.refIndex = n;
                            var s = o.field,
                                a = o.refField,
                                r = "select " + s.refType.id;
                            database.select(r, (function(o, s) {
                                if (o)
                                    return e(o);
                                database.loadNodes(s, (function(o) {
                                    if (o)
                                        return e(o);
                                    for (var r = 0; r < s.length; r++) {
                                        var l = s[r],
                                            c = database.loadNodeSync(l);
                                        if (c) {
                                            var d = c[a.id];
                                            null != d && ("nid" === a.base && (d = schemas.ridOf(d)), void 0 === n[d] ? n[d] = c._id : n[d] = null)
                                        }
                                    }
                                    setTimeout(t, 0, i + 1)
                                }))
                            }))
                        }), 0, 0)
                    }((function(e) {
                        if (e)
                            return $.loading(!1), y(e);
                        $.loading(!1),
                        C()
                    }))
                })))
            }
            function y(e) {
                $.alert(e),
                r ? setTimeout(g, 0) : setTimeout(f, 0)
            }
            setTimeout((function() {
                if (database)
                    return p();
                return $.alert("Please open a database. Then try again to open a CSV file with Ninox to import it into that database.")
            }), 0),
            Object(l.f)("ImportData", "Open")
        }
        function Xe(e) {
            var t = locale.yes.toLowerCase(),
                i = locale.no.toLowerCase(),
                o = locale.true.toLowerCase(),
                n = locale.false.toLowerCase();
            if (null != e)
                return "1" === (e = e.trim().toLowerCase()) || "true" === e || "t" === e || e === t || e === o || "0" !== e && "false" !== e && "f" !== e && e !== i && e !== n && void 0
        }
        function Ge(e, t) {
            return "comma" === t ? /^\s*(\+|\-)?\s*([0-9]+\.?)+(\,[0-9]+)?[^0-9]*$/.test(e) : /^\s*(\+|\-)?\s*([0-9]+\,?)+(\.[0-9]+)?[^0-9]*$/.test(e)
        }
        var Je = /^\-?[0-9]+$/,
            Ke = /^([0-9]{4})\-([0-9]{1,2})\-([0-9]{1,2})((?:T|\s+)([0-9]{1,2})\:([0-9]{1,2})(\:([0-9]{1,2})(\.([0-9]+))?)?(Z?))?$/i,
            Qe = /^(mon|tue|wed|thu|fri|sat|sun) (jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec) ([0-9]{1,2}) ([0-9]{4})( ([0-9]{1,2})\:([0-9]{1,2})(\:([0-9]{1,2}))?)?( GMT([\+\-][0-9]{1,4})?( \(([a-z]{3})\))?)?/i;
        function Ze(e) {
            if (null != e && "" !== e)
                return Ke.test(e) || Qe.test(e) || b.util.isLocaleDateTime(e)
        }
        function et(e) {
            if (null != e) {
                e = e.trim();
                var t = Je.test(e),
                    i = Ke.exec(e),
                    o = Qe.test(e);
                if (t)
                    return parseInt(e);
                if (i) {
                    var n = new Date(0);
                    if (i[11])
                        n.setUTCFullYear(Number(i[1] || 0)),
                        n.setUTCMonth(Number(i[2] || 0) - 1),
                        n.setUTCDate(Number(i[3] || 0)),
                        n.setUTCHours(Number(i[5] || 0)),
                        n.setUTCMinutes(Number(i[6] || 0)),
                        n.setUTCSeconds(Number(i[8] || 0)),
                        n.setUTCMilliseconds(Number(i[10] || 0));
                    else
                        (n = new Date(0)).setFullYear(Number(i[1] || 0)),
                        n.setMonth(Number(i[2] || 0) - 1),
                        n.setDate(Number(i[3] || 0)),
                        n.setHours(Number(i[5] || 0)),
                        n.setMinutes(Number(i[6] || 0)),
                        n.setSeconds(Number(i[8] || 0)),
                        n.setMilliseconds(Number(i[10] || 0));
                    var s = n.getTime();
                    return isNaN(s) ? void 0 : s
                }
                if (o) {
                    s = (n = new Date(e)).getTime();
                    return isNaN(s) ? void 0 : s
                }
                return b.util.parseLocaleDateTime(e)
            }
        }
        function tt(e) {
            if (null != e && "" !== e) {
                var t = qe.importCSVDateFormatDefault;
                return "auto" === t ? Ke.test(e) || Qe.test(e) || b.util.isLocaleDate(e) : b.util.moment(e, t, !0).isValid()
            }
        }
        function it(e) {
            var t = qe.importCSVDateFormatDefault;
            if ("auto" !== t) {
                var i = b.util.moment(e, t);
                if (i.isValid())
                    return Date.UTC(i.year(), i.month(), i.date())
            } else {
                var o = function(e) {
                    if (null != e) {
                        e = e.trim();
                        var t = Je.test(e),
                            i = Ke.exec(e),
                            o = Qe.test(e);
                        if (t)
                            return parseInt(e);
                        if (i) {
                            var n = new Date(0);
                            if (i[11])
                                n.setUTCFullYear(Number(i[1] || 0)),
                                n.setUTCMonth(Number(i[2] || 0) - 1),
                                n.setUTCDate(Number(i[3] || 0)),
                                n.setUTCHours(Number(i[5] || 0)),
                                n.setUTCMinutes(Number(i[6] || 0)),
                                n.setUTCSeconds(Number(i[8] || 0)),
                                n.setUTCMilliseconds(Number(i[10] || 0));
                            else
                                (n = new Date(0)).setFullYear(Number(i[1] || 0)),
                                n.setMonth(Number(i[2] || 0) - 1),
                                n.setDate(Number(i[3] || 0)),
                                n.setHours(Number(i[5] || 0)),
                                n.setMinutes(Number(i[6] || 0)),
                                n.setSeconds(Number(i[8] || 0)),
                                n.setMilliseconds(Number(i[10] || 0));
                            var s = n.getTime();
                            return isNaN(s) ? void 0 : s
                        }
                        if (o) {
                            s = (n = new Date(e)).getTime();
                            return isNaN(s) ? void 0 : s
                        }
                        return b.util.parseLocaleDateTime(e)
                    }
                }(e);
                if (void 0 !== o) {
                    var n = new Date(o);
                    return Date.UTC(n.getFullYear(), n.getMonth(), n.getDate())
                }
            }
        }
        function ot(e, t) {
            switch (t.base) {
            case "number":
                return function(e, t) {
                    if (null != e && (e = e.trim(), "" !== (e = "comma" === t ? (e = e.replace(/[^0-9\,\-]/g, "")).replace(",", ".") : e.replace(/[^0-9\.\-]/g, "")) && (e = Number(e), !isNaN(e))))
                        return e
                }(e, qe.importCSVNumberFormatDefault);
            case "boolean":
                return Xe(e);
            case "date":
                return function(e) {
                    var t = qe.importCSVDateFormatDefault;
                    if ("auto" !== t) {
                        var i = b.util.moment(e, t);
                        if (i.isValid())
                            return i.valueOf()
                    } else {
                        var o = et(e);
                        if (void 0 !== o) {
                            var n = new Date(o);
                            return n.setHours(0), n.setMinutes(0), n.setSeconds(0), n.setMilliseconds(0), n.getTime()
                        }
                    }
                }(e);
            case "datx":
                return it(e);
            case "timestamp":
                return et(e);
            default:
                return t.parse(e)
            }
        }
        o("./src/react/LocalizationColumnSelector.css");
        var nt = o("./src/react/util/PositionedBackplane.tsx");
        class st extends a.Component {
            constructor(...e)
            {
                super(...e),
                K()(this, "locales", ["en", "de", "ca", "es", "fr", "it", "pl", "pt", "ru", "chs", "cht"]),
                K()(this, "options", [])
            }
            render()
            {
                return this.options = this.props.localizedOptions, a.createElement(nt.a, {
                    show: null !== this.props.target,
                    onClick: () => this.props.submitChanges(this.options),
                    clickTarget: this.props.target,
                    settings: {
                        style: "tooltip",
                        arrowColor: "white"
                    }
                }, a.createElement("div", {
                    className: "LocalizationColumnSelector_Container"
                }, a.createElement("div", null, this.locales.map((e, t) => a.createElement("div", {
                    key: t,
                    className: "LocalizationColumnSelector_Item"
                }, a.createElement(ne, {
                    defaultValue: -1 !== this.options.indexOf(e),
                    options: {
                        type: "CHECKBOX",
                        label: e
                    },
                    onChange: t => {
                        t ? this.options.push(e) : this.options.splice(this.options.indexOf(e), 1)
                    }
                }))))))
            }
        }
        o("./src/react/LocalizationTable.css");
        class at extends a.Component {
            shouldComponentUpdate(e, t, i)
            {
                return this.props.isSelected !== e.isSelected || this.props.caption !== e.caption
            }
            render()
            {
                return this.props.isSelected ? a.createElement("input", {
                    className: "Localization_cell",
                    type: "text",
                    onKeyDown: this.props.handleKeyDown,
                    defaultValue: void 0 === this.props.caption ? "" : this.props.caption,
                    onChange: this.props.handleCellUpdate,
                    autoFocus: !0,
                    onBlur: () => this.props.blurOrSubmitCell(null)
                }) : void 0 !== this.props.caption ? a.createElement(ee.a, {
                    className: "Localization_cell",
                    onFastClick: this.props.onClick,
                    title: this.props.caption
                }, a.createElement("span", {
                    className: "Localization_cell_text"
                }, this.props.caption)) : a.createElement(ee.a, {
                    className: "Localization_cell",
                    onFastClick: this.props.onClick
                })
            }
        }
        var rt = o("./src/react/util/commons.ts");
        function lt(e, t) {
            var i = Object.keys(e);
            if (Object.getOwnPropertySymbols) {
                var o = Object.getOwnPropertySymbols(e);
                t && (o = o.filter((function(t) {
                    return Object.getOwnPropertyDescriptor(e, t).enumerable
                }))),
                i.push.apply(i, o)
            }
            return i
        }
        function ct(e) {
            for (var t = 1; t < arguments.length; t++) {
                var i = null != arguments[t] ? arguments[t] : {};
                t % 2 ? lt(Object(i), !0).forEach((function(t) {
                    K()(e, t, i[t])
                })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(i)) : lt(Object(i)).forEach((function(t) {
                    Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(i, t))
                }))
            }
            return e
        }
        class dt extends a.Component {
            constructor(e)
            {
                super(e),
                K()(this, "numberOfRows", void 0),
                K()(this, "handleCellUpdate", e => {
                    const t = e.target.value;
                    this.setState(e => (Object(rt.a)(e.selectedElement), {
                        selectedElement: ct({}, e.selectedElement, {
                            val: t
                        })
                    }))
                }),
                K()(this, "handleLocalizationCellClick", (e, t, i) => {
                    this.setState({
                        selectedElement: {
                            col: t,
                            row: i,
                            val: this.props.locales[i].captions[t]
                        }
                    })
                }),
                K()(this, "handleKeyDown", e => {
                    switch (e.key) {
                    case "Escape":
                        this.setState({
                            selectedElement: null
                        });
                        break;
                    case "Enter":
                        this.blurOrSubmitCell(null);
                        break;
                    case "Tab":
                        e.preventDefault(),
                        Object(rt.a)(this.state.selectedElement);
                        let t = this.props.selectedLanguages.indexOf(this.state.selectedElement.col),
                            i = this.state.selectedElement.row;
                        e.shiftKey ? (t = (t - 1 + this.props.selectedLanguages.length) % this.props.selectedLanguages.length, t === this.props.selectedLanguages.length - 1 && (i = (i + this.numberOfRows - 1) % this.numberOfRows)) : (t = (t + 1) % this.props.selectedLanguages.length, 0 === t && (i = (i + 1) % this.numberOfRows));
                        const o = {
                            col: this.props.selectedLanguages[t],
                            row: i,
                            val: this.props.locales[i].captions[this.props.selectedLanguages[t]]
                        };
                        this.blurOrSubmitCell(o);
                        break;
                    case "ArrowUp":
                        e.preventDefault(),
                        Object(rt.a)(this.state.selectedElement);
                        const n = (this.state.selectedElement.row + this.numberOfRows - 1) % this.numberOfRows,
                            s = {
                                col: this.state.selectedElement.col,
                                row: n,
                                val: this.props.locales[n].captions[this.state.selectedElement.col]
                            };
                        this.blurOrSubmitCell(s);
                        break;
                    case "ArrowDown":
                        e.preventDefault(),
                        Object(rt.a)(this.state.selectedElement);
                        const a = (this.state.selectedElement.row + 1) % this.numberOfRows,
                            r = {
                                col: this.state.selectedElement.col,
                                row: a,
                                val: this.props.locales[a].captions[this.state.selectedElement.col]
                            };
                        this.blurOrSubmitCell(r)
                    }
                }),
                K()(this, "checkForChangesAndSubmit", () => {
                    Object(rt.a)(this.state.selectedElement),
                    this.props.locales[this.state.selectedElement.row].captions[this.state.selectedElement.col] !== this.state.selectedElement.val && this.props.onCellChange(this.state.selectedElement.row, this.state.selectedElement.col, this.state.selectedElement.val)
                }),
                K()(this, "blurOrSubmitCell", e => {
                    this.checkForChangesAndSubmit(),
                    this.setState({
                        selectedElement: e
                    })
                }),
                K()(this, "handleHeaderClick", e => {
                    this.setState({
                        editLocale: {
                            target: ee.b.getTarget(e),
                            options: this.props.selectedLanguages
                        }
                    })
                }),
                K()(this, "submitHeaderEdits", e => {
                    Object(l.f)(dt.trackingCategory, "Edit Locales", {
                        locales: e
                    }),
                    this.props.onHeaderUpdate(e),
                    this.setState({
                        editLocale: null
                    })
                }),
                this.numberOfRows = this.props.locales.length,
                this.state = {
                    selectedElement: null,
                    editLocale: null
                }
            }
            render()
            {
                return a.createElement("div", {
                    className: "Localization_root"
                }, a.createElement("div", {
                    className: "Localization-header-column"
                }, a.createElement("div", {
                    className: "Localization_corner_cell"
                }, Object(b.getLocale)().LocalizationModuleColumnHeader), a.createElement("div", {
                    className: "Localization_column_header_container"
                }, this.renderLocalizationColumnHeaders())), a.createElement("div", {
                    className: "Localization_content"
                }, this.renderTableContent()), a.createElement(st, {
                    localizedOptions: this.props.selectedLanguages,
                    target: null === this.state.editLocale ? null : this.state.editLocale.target,
                    submitChanges: this.submitHeaderEdits
                }))
            }
            renderTableContent()
            {
                return this.props.locales.map((e, t) => a.createElement("div", {
                    key: t,
                    className: "Localization_row_container"
                }, a.createElement("div", {
                    title: e.module,
                    className: "Localization_module"
                }, e.module), a.createElement("div", {
                    className: "Localization_row"
                }, a.createElement("div", {
                    title: e.caption,
                    className: "Localization_cell Localization_default"
                }, e.caption), this.renderLocalizedValuesAndEmptyCells(e.captions, t))))
            }
            renderLocalizedValuesAndEmptyCells(e, t)
            {
                return this.props.selectedLanguages.map((i, o) => a.createElement(at, {
                    caption: e[i],
                    key: o,
                    isSelected: null !== this.state.selectedElement && this.state.selectedElement.col === i && this.state.selectedElement.row === t,
                    handleKeyDown: this.handleKeyDown,
                    blurOrSubmitCell: this.blurOrSubmitCell,
                    onClick: e => this.handleLocalizationCellClick(e, i, t),
                    handleCellUpdate: this.handleCellUpdate
                }))
            }
            renderLocalizationColumnHeaders()
            {
                const e = [];
                e.push(a.createElement("div", {
                    key: Object(b.getLocale)().LocalizationDefaultColumnHeader,
                    className: "Localization_column_header"
                }, Object(b.getLocale)().LocalizationDefaultColumnHeader));
                for (const t of this.props.selectedLanguages)
                    e.push(a.createElement("div", {
                        key: t,
                        className: "Localization_column_header"
                    }, t));
                return this.props.locales.length > 0 && e.push(a.createElement(ee.a, {
                    key: Object(b.getLocale)().LocalizationAddLocaleColumnHeader,
                    className: "Localization_column_header",
                    onFastClick: e => this.handleHeaderClick(e)
                }, Object(b.getLocale)().LocalizationAddLocaleColumnHeader)), e
            }
        }
        let ht;
        K()(dt, "trackingCategory", "Localized Captions"),
        ht || (ht = {});
        class pt {
            constructor(e, t, i)
            {
                K()(this, "base", "localization"),
                K()(this, "container", void 0),
                K()(this, "visible", void 0),
                K()(this, "el", void 0),
                K()(this, "database", void 0),
                K()(this, "localizedFieldOptions", void 0),
                K()(this, "locales", []),
                K()(this, "handleCellChange", (e, t, i) => {
                    const o = b.util.clone(this.locales);
                    o[e].captions[t] = i,
                    this.saveData(o)
                }),
                K()(this, "updateColumnHeadings", e => {
                    this.localizedFieldOptions = e,
                    this.createEmptyValuesForSelectedColumns(e),
                    this.removeValuesInLocaleColumn(e)
                }),
                K()(this, "createEmptyValuesForSelectedColumns", e => {
                    const t = b.util.clone(this.locales),
                        i = t[0];
                    for (const t of e)
                        i.captions.hasOwnProperty(t) || (i.captions[t] = "");
                    this.saveData(t)
                }),
                K()(this, "removeValuesInLocaleColumn", e => {
                    const t = b.util.clone(this.locales);
                    for (const i of t)
                        for (const t in i.captions)
                            i.captions.hasOwnProperty(t) && -1 === e.indexOf(t) && delete i.captions[t];
                    this.saveData(t)
                }),
                K()(this, "setLocalizedHeaders", e => {
                    const t = [];
                    e.forEach(e => {
                        Object.keys(e.captions).forEach(e => {
                            -1 === t.indexOf(e) && t.push(e)
                        })
                    }),
                    this.localizedFieldOptions = t
                }),
                K()(this, "saveData", e => {
                    const t = this.database.schema,
                        i = t.types;
                    let o,
                        n,
                        s,
                        a,
                        r = !1;
                    for (const t of e)
                        switch (t.base) {
                        case "type.caption":
                            if (o = i[t.tid], !o)
                                continue;
                            o.caption !== t.caption && (o.caption = t.caption, r = !0),
                            b.util.equals(o.captions, t.captions) || (o.captions = b.util.clone(t.captions), r = !0);
                            break;
                        case "field.caption":
                            if (o = i[t.tid], !o)
                                continue;
                            if (n = o.fields[t.fid], !n)
                                continue;
                            n.caption !== t.caption && (n.caption = t.caption, r = !0),
                            b.util.equals(n.captions, t.captions) || (n.captions = b.util.clone(t.captions), r = !0);
                            break;
                        case "field.tooltip":
                            if (o = i[t.tid], !o)
                                continue;
                            if (n = o.fields[t.fid], !n)
                                continue;
                            n.tooltip !== t.caption && (n.tooltip = t.caption, r = !0),
                            b.util.equals(n.tooltips, t.captions) || (n.tooltips = b.util.clone(t.captions), r = !0);
                            break;
                        case "field.value.caption":
                            if (o = i[t.tid], !o)
                                continue;
                            if (n = o.fields[t.fid], !n)
                                continue;
                            if (s = n.values[t.vid], !s)
                                continue;
                            s.caption !== t.caption && (s.caption = t.caption, r = !0),
                            b.util.equals(s.captions, t.captions) || (s.captions = b.util.clone(t.captions), r = !0);
                            break;
                        case "ui.caption":
                            if (o = i[t.tid], !o)
                                continue;
                            if (a = o.uis[t.uid], !a)
                                continue;
                            a.caption !== t.caption && (a.caption = t.caption, r = !0),
                            b.util.equals(a.captions, t.captions) || (a.captions = b.util.clone(t.captions), r = !0);
                            break;
                        default:
                            Object(Q.assertNever)(t)
                        }
                    r && t.trigger("change")
                }),
                this.container = e,
                this.visible = !1,
                this.el = window.$('<div class="admin-options">'),
                this.database = i,
                this.localizedFieldOptions = null,
                i.on("schema", void 0, this.updateUI, this)
            }
            getNavigationState()
            {
                return {
                    base: "localization"
                }
            }
            destroy()
            {
                this.el.remove()
            }
            show()
            {
                this.visible || (this.visible = !0, this.el.appendTo(this.container.el), this.updateUI())
            }
            hide()
            {
                this.visible && (this.visible = !1, this.el.detach())
            }
            updateUI()
            {
                if (this.locales = this.getLocalizedCaptionData(), this.setLocalizedHeaders(this.locales), null === this.localizedFieldOptions)
                    throw new Error("impossible");
                n.render(a.createElement(dt, {
                    locales: this.locales,
                    selectedLanguages: this.localizedFieldOptions,
                    onCellChange: this.handleCellChange,
                    onHeaderUpdate: this.updateColumnHeadings
                }), this.el[0])
            }
            getLocalizedCaptionData()
            {
                const e = [],
                    t = this.database.schema.types;
                for (const i in t)
                    if (t.hasOwnProperty(i)) {
                        const o = t[i];
                        e.push({
                            base: "type.caption",
                            tid: i,
                            module: [o.caption].join(" / "),
                            caption: o.caption,
                            captions: b.util.clone(o.captions) || {}
                        });
                        const n = o.fields;
                        for (const t in n)
                            if (n.hasOwnProperty(t)) {
                                const s = n[t];
                                if (e.push({
                                    base: "field.caption",
                                    tid: i,
                                    fid: t,
                                    module: [o.caption, s.caption].join(" / "),
                                    caption: s.caption,
                                    captions: b.util.clone(s.captions) || {}
                                }), e.push({
                                    base: "field.tooltip",
                                    tid: i,
                                    fid: t,
                                    module: [o.caption, s.caption, "Tooltip"].join(" / "),
                                    caption: s.tooltip,
                                    captions: b.util.clone(s.tooltips) || {}
                                }), "choice" === s.base || "multi" === s.base) {
                                    const n = s.values;
                                    for (const a in n)
                                        if (n.hasOwnProperty(a)) {
                                            const r = n[a];
                                            e.push({
                                                base: "field.value.caption",
                                                tid: i,
                                                fid: t,
                                                vid: a,
                                                module: [o.caption, s.caption, "Value"].join(" / "),
                                                caption: r.caption,
                                                captions: b.util.clone(r.captions) || {}
                                            })
                                        }
                                }
                            }
                        const s = o.uis;
                        for (const t in s)
                            if (s.hasOwnProperty(t)) {
                                const n = s[t];
                                e.push({
                                    base: "ui.caption",
                                    tid: i,
                                    uid: t,
                                    module: [o.caption, n.caption, "UI"].join(" / "),
                                    caption: n.caption,
                                    captions: b.util.clone(n.captions) || {}
                                })
                            }
                    }
                return e
            }
        }
        function ut(e) {
            var t = e.$container,
                i = $("<div>").appendTo(t),
                o = new util.SimpleModel(new schemas.TChoice(void 0, void 0, {
                    caption: locale.background,
                    width: 4,
                    required: !0,
                    choiceRenderer: "switch",
                    values: {
                        solid: {
                            caption: locale.solid,
                            order: 1
                        },
                        gradient: {
                            caption: locale.gradient,
                            order: 2
                        },
                        image: {
                            caption: locale.image,
                            order: 3
                        },
                        default: {
                            caption: locale.defaultValue,
                            order: 0
                        }
                    }
                }), e.settings.bgType || ("background-file" === e.settings.backgroundClass ? "image" : "default"));
            o.on("update", (function() {
                "image" === o.value ? e.updateSettings({
                    bgType: "image",
                    backgroundClass: "background-file"
                }, (function() {})) : "default" === o.value ? e.updateSettings({
                    bgType: null,
                    backgroundClass: ""
                }, (function() {})) : e.updateSettings({
                    bgType: o.value
                }, (function() {})),
                g()
            })),
            new Ue.a(void 0, o, i);
            var n = $("<div>").appendTo(i),
                s = $("<div>").appendTo(i),
                a = $("<div>").appendTo(i),
                r = $('<div style="padding:8px 0">').appendTo(a),
                l = new util.SimpleModel(new schemas.TColor(void 0, void 0, {
                    caption: locale.backgroundColor,
                    required: !0
                }), e.settings.bgColor || "#ccc");
            l.on("update", (function() {
                e.updateSettings({
                    bgColor: l.value
                }, (function() {}))
            })),
            new Ue.a(void 0, l, r),
            $('<div class="nx-button-text blue" style="width:auto;display:inline-block;margin:8px 0">').text(locale.uploadBackgroundFile).appendTo(r).on("click", (function(t) {
                $.chooseFile(t, (function(t, i) {
                    e.setBackgroundFile(i, (function(e) {
                        if (e)
                            return $.alert(e)
                    }))
                }))
            }));
            var c = new util.SimpleModel(new schemas.TChoice(void 0, void 0, {
                caption: locale.horizontalPosition,
                width: 2,
                required: !0,
                choiceRenderer: "switch",
                values: {
                    left: {
                        caption: locale.left,
                        order: 1
                    },
                    center: {
                        caption: locale.center,
                        order: 2
                    },
                    right: {
                        caption: locale.right,
                        order: 3
                    }
                }
            }), e.settings.bgPosH || "center");
            c.on("update", (function() {
                e.updateSettings({
                    bgPosH: c.value
                }, (function() {}))
            }));
            var d = new util.SimpleModel(new schemas.TChoice(void 0, void 0, {
                caption: locale.verticalPosition,
                width: 2,
                required: !0,
                choiceRenderer: "switch",
                values: {
                    top: {
                        caption: locale.top,
                        order: 1
                    },
                    center: {
                        caption: locale.center,
                        order: 2
                    },
                    bottom: {
                        caption: locale.bottom,
                        order: 3
                    }
                }
            }), e.settings.bgPosV || "center");
            d.on("update", (function() {
                e.updateSettings({
                    bgPosV: d.value
                }, (function() {}))
            }));
            var h = new util.SimpleModel(new schemas.TChoice(void 0, void 0, {
                caption: locale.size,
                width: 3,
                required: !0,
                choiceRenderer: "switch",
                values: {
                    auto: {
                        caption: locale.original,
                        order: 1
                    },
                    cover: {
                        caption: locale.cover,
                        order: 2
                    },
                    contain: {
                        caption: locale.contain,
                        order: 3
                    },
                    "100% 100%": {
                        caption: locale.stretch,
                        order: 4
                    }
                }
            }), e.settings.bgSize || "cover");
            h.on("update", (function() {
                e.updateSettings({
                    bgSize: h.value
                }, (function() {}))
            }));
            var p = new util.SimpleModel(new schemas.TChoice(void 0, void 0, {
                caption: locale.repeat,
                width: 1,
                required: !0,
                choiceRenderer: "switch",
                values: {
                    "no-repeat": {
                        caption: locale.no,
                        order: 2
                    },
                    repeat: {
                        caption: locale.yes,
                        order: 1
                    }
                }
            }), e.settings.bgRepeat || "no-repeat");
            p.on("update", (function() {
                e.updateSettings({
                    bgRepeat: p.value
                }, (function() {}))
            })),
            new Ue.a(void 0, d, a),
            new Ue.a(void 0, c, a),
            $("<br>").appendTo(a),
            new Ue.a(void 0, h, a),
            new Ue.a(void 0, p, a);
            var u = new util.SimpleModel(new schemas.TColor(void 0, void 0, {
                caption: locale.startColor,
                required: !0
            }), e.settings.bgGradient0 || "#ccc");
            u.on("update", (function() {
                e.updateSettings({
                    bgGradient0: u.value
                }, (function() {}))
            }));
            var f = new util.SimpleModel(new schemas.TColor(void 0, void 0, {
                caption: locale.endColor,
                required: !0
            }), e.settings.bgGradient1 || "#aaa");
            f.on("update", (function() {
                e.updateSettings({
                    bgGradient1: f.value
                }, (function() {}))
            })),
            new Ue.a(void 0, u, s),
            new Ue.a(void 0, f, s);
            var m = new util.SimpleModel(new schemas.TColor(void 0, void 0, {
                caption: locale.color,
                required: !0
            }), e.settings.bgColor || "#ccc");
            function g() {
                n.css("display", "solid" === o.value ? "" : "none"),
                s.css("display", "gradient" === o.value ? "" : "none"),
                a.css("display", "image" === o.value ? "" : "none")
            }
            m.on("update", (function() {
                e.updateSettings({
                    bgColor: m.value
                }, (function() {}))
            })),
            new Ue.a(void 0, m, n),
            g()
        }
        var ft = o("./src/js/admin/FunctionEditor.js");
        function mt(e) {
            this.button = $('<div class="hud-menu-button i-32-24 i-grey i-setting-tool">').attr("title", locale.admin).appendTo(e || ui.$menuRight).touch($.proxy(this.toggle, this)),
            this.update(),
            database.on("admin", void 0, this.update, this),
            Object(ft.b)()
        }
        function gt(e, t) {
            this.container = e,
            this.visible = !1,
            this.el = $('<div class="admin-options">'),
            this.$globalCode = void 0,
            this.globalCodeField = void 0,
            this.afterOpenField = void 0
        }
        mt.prototype.destroy = function() {
            database.off("admin", void 0, this.update, this),
            this.button.remove()
        },
        mt.prototype.toggle = function(e) {
            Object(l.f)("Admin", database.adminMode ? "Activate" : "Deactivate"),
            database.schema.isProtected ? database.adminMode ? (database.schemaUnlocked = !1, database.schemaPassword = void 0, database.setAdminMode(!1)) : mt.popupProtectionPassword({
                mode: "unlock",
                okay: function(e) {
                    return database.schema.protectCheckPassword(e) ? (database.schemaUnlocked = !0, database.schemaPassword = e, database.setAdminMode(!0), !0) : ($.alert(locale.wrongPassword), !1)
                }
            }) : database.setAdminMode(!database.adminMode)
        },
        mt.popupProtectionPassword = function(e) {
            var t,
                i = $.popdown({
                    cls: "small",
                    head: "protect" === e.mode ? locale.protectDatabase : "unprotect" === e.mode ? locale.unprotectDatabase : "unlock" === e.mode ? locale.unlockDatabase : "Unknown",
                    buttons: ["cancel", "-", {
                        cls: "blue",
                        caption: locale.okay,
                        click: function() {
                            var n = o.val();
                            if (!n)
                                return;
                            if ("protect" === e.mode && n !== t.val())
                                return void $.alert(locale.passwordMismatch);
                            e.okay(n) && i.close()
                        }
                    }]
                }),
                o = ($('<div class="component editor editor-string" style="width:100%">').appendTo(i.$pane), $.input({
                    $container: i.$content,
                    type: "password",
                    caption: locale.password
                }));
            "protect" === e.mode && (t = $.input({
                $container: i.$content,
                type: "password",
                caption: locale.repeatPassword
            }))
        },
        mt.prototype.update = function() {
            database.adminMode ? this.button[0].className = "hud-menu-button red i-32-24 i-white i-setting-tool selected --ul-admin-button-active" : this.button[0].className = "hud-menu-button i-32-24 i-white i-setting-tool --ul-admin-button"
        },
        mt.prototype.mightyMode = function() {
            var e = $('<div class="nx-backplane nx-backplane-opaq">').appendTo($(document.body)),
                t = $('<textarea autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="border:none;background-color:#fff;font-family:monospace;font-size:12px;position:absolute;top:64px;left:16px;right:16px;bottom:16px">').val(database.customInitSRC || "").appendTo(e),
                i = $('<div class="nx-button-bar" style="position:absolute;left:8px;top:8px;right:8px">').appendTo(e);
            $('<div class="nx-hspace-flex">').appendTo(i);
            $('<div class="nx-button-text red">').text("Save and Reload").appendTo(i).touch((function() {
                var e = t.val();
                try {
                    new Function(e);
                    database.saveCustom(e, (function(e) {
                        if (e)
                            return $.alert(e);
                        window.location.reload()
                    }))
                } catch (e) {
                    $.alert(e)
                }
            }));
            $('<div class="nx-hspace-small">').appendTo(i);
            $('<div class="nx-button-text grey">').text("Cancel").appendTo(i).touch((function() {
                e.remove()
            }))
        },
        gt.prototype.base = "options",
        gt.prototype.getNavigationState = function() {
            return {
                base: "options"
            }
        },
        gt.prototype.destroy = function() {
            this.el.remove()
        },
        gt.prototype.show = function() {
            Object(l.f)("Options", "Open"),
            this.visible || (this.visible = !0, this.createUI(), this.el.appendTo(this.container.el), database.on("schema", void 0, this.schemaChanged, this))
        },
        gt.prototype.hide = function() {
            this.visible && (this.visible = !1, this.el.detach(), this.destroyUI(), database.off("schema", void 0, this.schemaChanged, this))
        },
        gt.prototype.setBackground = function(e) {
            database.setBackground(e, (function(e) {
                e && $.alert(e)
            }))
        },
        gt.prototype.getNavigationState = function() {
            return {
                base: "options"
            }
        },
        gt.prototype.schemaChanged = function() {
            this.createFields()
        },
        gt.prototype.destroyUI = function() {
            this.destroyFields(),
            this.el.empty(),
            this.$globalCode = void 0
        },
        gt.prototype.createUI = function() {
            var e = this;
            new ut({
                $container: $('<div class="admin-options-pane">').appendTo(this.el),
                settings: database.settings,
                updateSettings: function(e, t) {
                    database.updateSettings(e, t),
                    ui.updateBackground(!0)
                },
                setBackground: function(e, t) {
                    database.setBackground(e, t)
                },
                setBackgroundFile: function(e, t) {
                    database.setBackgroundFile(e, t)
                }
            });
            var t = $('<div class="admin-options-pane">').appendTo(this.el);
            $('<div style="text-align:center">').text(locale.printTableSettings).appendTo(t);
            var i = new util.SimpleModel(new schemas.TChoice(void 0, void 0, {
                caption: locale.printFontSize,
                width: 2,
                required: !0,
                values: {
                    6: {
                        caption: "6 pt",
                        order: 1
                    },
                    7: {
                        caption: "7 pt",
                        order: 2
                    },
                    8: {
                        caption: "8 pt",
                        order: 3
                    },
                    9: {
                        caption: "9 pt",
                        order: 4
                    },
                    10: {
                        caption: "10 pt",
                        order: 5
                    },
                    11: {
                        caption: "11 pt",
                        order: 6
                    },
                    12: {
                        caption: "12 pt",
                        order: 7
                    },
                    13: {
                        caption: "13 pt",
                        order: 8
                    },
                    14: {
                        caption: "14 pt",
                        order: 9
                    }
                }
            }), database.settings.printTableFontSize || "8");
            i.on("update", n);
            new Ue.a(void 0, i, t);
            var o = new util.SimpleModel(new schemas.TChoice(void 0, void 0, {
                caption: locale.printRendering,
                width: 2,
                required: !0,
                values: {
                    PDF: {
                        caption: "PDF",
                        order: 1
                    },
                    HTML: {
                        caption: "HTML",
                        order: 2
                    }
                }
            }), database.settings.printTableRendering || "PDF");
            o.on("update", n);
            new Ue.a(void 0, o, t);
            function n() {
                window.reports,
                database.updateSettings({
                    printTableFontSize: i.value,
                    printTableRendering: o.value
                })
            }
            if (this.$globalCode = $('<div class="admin-options-pane">').appendTo(this.el), $('<div class="buttons">').appendTo(this.el).button(void 0, database.schema.isProtected ? locale.unprotectDatabase : locale.protectDatabase, "grey", (function() {
                mt.popupProtectionPassword({
                    mode: database.schema.isProtected ? "unprotect" : "protect",
                    okay: function(t) {
                        return database.schema.isProtected ? database.schema.unprotect(t) ? (e.destroyUI(), e.createUI(), $.loading(!0), database.saveSchema((function(e) {
                            $.loading(!1),
                            e && $.alert(e)
                        })), !0) : ($.alert(locale.wrongPassword), !1) : (database.schema.protect(t), database.schemaUnlocked = !0, database.schemaPassword = t, database.setAdminMode(!1), $.loading(!0), database.saveSchema((function(e) {
                            $.loading(!1),
                            database.schemaUnlocked = !1,
                            database.schemaPassword = void 0,
                            e && $.alert(e)
                        })), !0)
                    }
                })
            })), database.supports.history || database.supports.reindex) {
                var s = $('<div class="buttons">').appendTo(this.el);
                database.supports.history && s.button(void 0, locale.clearHistory, "grey", (function() {
                    $.dialog({
                        closable: !0,
                        caption: locale.clearHistory,
                        message: locale.confirmClearHistory,
                        buttons: [{
                            color: "red",
                            caption: locale.clearHistory,
                            callback: function() {
                                database.clearHistory((function(e) {
                                    e && $.alert(e)
                                }))
                            }
                        }]
                    })
                })),
                database.supports.reindex && s.button(void 0, locale.reindex, "grey", (function() {
                    $.dialog({
                        closable: !0,
                        caption: locale.reindex,
                        message: locale.confirmReindex,
                        buttons: [{
                            color: "red",
                            caption: locale.reindex,
                            callback: function() {
                                database.reindex((function(e) {
                                    e && $.alert(e)
                                }))
                            }
                        }]
                    })
                })),
                database.supports.rebuildThumbs && s.button(void 0, locale.rebuildThumbnails, "grey", (function() {
                    $.dialog({
                        closable: !0,
                        caption: locale.rebuildThumbnails,
                        message: locale.rebuildThumbnailsConfirm,
                        buttons: [{
                            color: "red",
                            caption: locale.rebuildThumbnails,
                            callback: function() {
                                database.rebuildThumbs((function(e) {
                                    e && $.alert(e)
                                }))
                            }
                        }]
                    })
                })),
                database.supports.reIndexFiles && s.button(void 0, locale.reIndexFiles, "grey", (function() {
                    $.dialog({
                        closable: !0,
                        caption: locale.reIndexFiles,
                        message: locale.reIndexFilesConfirm,
                        buttons: [{
                            color: "red",
                            caption: locale.reIndexFiles,
                            callback: function() {
                                database.reIndexFiles(e => {
                                    e && $.alert(e)
                                })
                            }
                        }]
                    })
                }))
            }
            this.createFields()
        },
        gt.prototype.destroyFields = function() {
            this.globalCodeField && this.globalCodeField.destroy(),
            this.afterOpenField && this.afterOpenField.destroy()
        },
        gt.prototype.createFields = function() {
            this.destroyFields(),
            this.globalCodeField = new Ue.a(void 0, database.schema.getGlobalCodeModel(), this.$globalCode),
            this.afterOpenField = new Ue.a(void 0, database.schema.getAfterOpenModel(), this.$globalCode)
        };
        let vt = 1,
            bt = 1;
        function yt() {
            this.nodes = [],
            this.edges = [],
            this.incDistances = null,
            this.outDistances = null,
            this.symDistances = null
        }
        function wt(e, t, i, o) {
            this.graph = e,
            this.id = t,
            this.label = i || t,
            this.data = o || {},
            this.out = [],
            this.inc = [],
            this.rad = 1,
            this.mass = 1,
            this.color = 0
        }
        function xt(e, t, i, o, n, s) {
            this.graph = e,
            this.id = t,
            this.source = i,
            this.target = o,
            this.label = n || t,
            this.data = s || {}
        }
        function Tt(e, t) {
            var i = e.indexOf(t);
            if (-1 === i)
                throw new Error("Not a member");
            e.splice(i, 1)
        }
        yt.prototype.pathDirect = function() {
            this.calcDistances();
            for (var e = this.nodes, t = this.incDistances, i = this.partitions(), o = 0; o < i.length; o++)
                i[o];
            var n = [];
            for (var s in t)
                if (t.hasOwnProperty(s)) {
                    var a = t[s];
                    if (a >= 0) {
                        var r = s.split("-"),
                            l = parseInt(r[0]),
                            c = parseInt(r[1]);
                        e[l],
                        e[c];
                        0 === a ? n.push([l, c]) : n = [[l, c]]
                    }
                }
            if (0 !== n.length) {
                n.sort((function(t, i) {
                    var o = e[t[0]],
                        n = e[i[0]];
                    return o.inc.length + o.out.length - (n.inc.length + n.out.length)
                }));
                n[0]
            }
        },
        yt.prototype.powerDirectInit = function(e, t) {
            this.powerW = e,
            this.powerH = t;
            for (var i = this.nodes, o = 0; o < i.length; o++) {
                var n = i[o];
                n.x = Math.sin(2 * Math.PI * o / i.length) * i.length,
                n.y = Math.cos(2 * Math.PI * o / i.length) * i.length
            }
        },
        yt.prototype.powerDirectStep = function(e) {
            for (var t = 0, i = this.nodes, o = this.edges, n = 0; n < i.length; n++) {
                (y = i[n]).fx = 0,
                y.fy = 0
            }
            for (n = 0; n < o.length; n++) {
                var s,
                    a = o[n],
                    r = a.source,
                    l = a.target,
                    c = (v = r.x - l.x) * v + (b = r.y - l.y) * b,
                    d = v / (u = Math.sqrt(c)),
                    h = b / u;
                s = u < 1 ? 0 : u > 1 ? -4 * (1 - 1 / c) : 0,
                r.fx += s * d,
                r.fy += s * h,
                l.fx -= s * d,
                l.fy -= s * h
            }
            for (n = 0; n < i.length; n++) {
                r = i[n];
                for (var p = n + 1; p < i.length; p++) {
                    l = i[p],
                    c = (v = r.x - l.x) * v + (b = r.y - l.y) * b,
                    d = v / (u = Math.sqrt(c)),
                    h = b / u;
                    var u,
                        f = r.rad + l.rad;
                    u < f && (s = 16 * Math.sqrt(f * f - c) / f, r.fx += s * d, r.fy += s * h, l.fx -= s * d, l.fy -= s * h)
                }
            }
            var m = this.powerW,
                g = this.powerH;
            for (n = 0; n < i.length; n++) {
                var v = (y = i[n]).x / m,
                    b = y.y / g;
                y.fx -= y.mass * v,
                y.fy -= y.mass * b
            }
            for (n = 0; n < i.length; n++) {
                var y;
                (y = i[n]).x += y.fx * e,
                y.y += y.fy * e,
                t += Math.sqrt(y.fx * y.fx + y.fy * y.fy)
            }
            return t
        },
        yt.prototype.sub = function(e, t) {
            e || (e = this.nodes),
            t || (t = this.edges);
            for (var i = {}, o = {}, n = 0; n < e.length; n++)
                o[e[n].id] = !0;
            for (n = 0; n < t.length; n++)
                i[t[n].id] = !0;
            var s = new yt;
            for (n = 0; n < e.length; n++) {
                var a = e[n];
                s.nodes.push(new wt(s, a.id, a.label, a.data));
                for (var r = 0; r < a.out.length; r++) {
                    i[a.out[r].id]
                }
            }
        },
        yt.prototype.node = function(e, t) {
            var i = new wt(this, vt++, e, t);
            return this.nodes.push(i), i
        },
        yt.prototype.edge = function(e, t, i, o) {
            var n = new xt(this, bt++, e, t, i, o);
            return e.out.push(n), t.inc.push(n), this.edges.push(n), n
        },
        yt.prototype.removeNode = function(e) {
            for (var t = 0; t < e.inc.length; t++)
                this.removeEdge(e.inc[t]);
            for (t = 0; t < e.out.length; t++)
                this.removeEdge(e.out[t]);
            Tt(this.nodes, e)
        },
        yt.prototype.removeEdge = function(e) {
            Tt(e.source.out, e),
            Tt(e.target.inc, e),
            Tt(this.edges, e)
        },
        yt.prototype.calcDistances = function() {
            for (var e = this.nodes, t = {}, i = 0; i < e.length; i++)
                for (var o = (c = e[i]).inc, n = 1, s = {}; o.length > 0;) {
                    for (var a = [], r = 0; r < o.length; r++) {
                        s[(d = o[r].source).id] || (s[d.id] = !0, t[c.id + "-" + d.id] = n, a = a.concat(d.inc))
                    }
                    n++,
                    o = a
                }
            var l = {};
            for (i = 0; i < e.length; i++) {
                var c;
                for (o = (c = e[i]).out, n = 1, s = {}; o.length > 0;) {
                    for (a = [], r = 0; r < o.length; r++) {
                        var d;
                        s[(d = o[r].target).id] || (s[d.id] = !0, l[c.id + "-" + d.id] = n, a = a.concat(d.out))
                    }
                    n++,
                    o = a
                }
            }
            var h = {};
            for (var p in t)
                t.hasOwnProperty(p) && (h[p] = t[p]);
            for (var p in l)
                l.hasOwnProperty(p) && (void 0 === h[p] || h[p] > l[p]) && (h[p] = l[p]);
            this.incDistances = t,
            this.outDistances = l,
            this.symDistances = h
        },
        yt.prototype.partitions = function(e, t) {
            if ("function" != typeof e) {
                this.symDistances || this.calcDistances();
                var i = "inc" === e ? this.incDistances : "out" === e ? this.outDistances : this.symDistances;
                e = function(e, t) {
                    return void 0 !== i[e.id + "-" + t.id]
                }
            }
            t || (t = this.nodes);
            for (var o = [], n = 0; n < t.length; n++)
                o.push([t[n]]);
            for (; function() {
                for (var t = 0; t < o.length; t++)
                    for (var i = o[t], n = t + 1; n < o.length; n++)
                        for (var s = o[n], a = 0; a < i.length; a++)
                            for (var r = i[a], l = 0; l < s.length; l++) {
                                var c = s[l];
                                if (e(r, c))
                                    return o[t] = i.concat(s), o.splice(n, 1), !0
                            }
                return !1
            }();)
                ;
            return o
        },
        wt.prototype.toString = function() {
            return "(" + this.label + ")"
        },
        wt.prototype.remove = function() {
            this.graph.removeNode(this)
        },
        xt.prototype.toString = function() {
            return this.source.toString() + " - " + this.label + " - " + this.target.toString()
        },
        xt.prototype.remove = function() {
            this.graph.removeEdge(this)
        };
        class $t extends a.Component {
            constructor(e)
            {
                super(e)
            }
            render()
            {
                return a.createElement("div", {
                    className: "nx-switch-big"
                }, this.props.tabs.map((e, t) => a.createElement(ee.a, {
                    key: t,
                    onFastClick: e.onClick,
                    className: "nx-switch-big-item " + (e.isSelected ? "selected" : null)
                }, e.text)))
            }
        }
        var Ct = o("./src/js/admin/AdminField.js");
        function kt(e) {
            var t = e.type,
                i = $('<div class="nx-backplane nx-backplane-dark">');
            let o;
            o = window.getWidth() < 640 ? "100%" : "600px";
            var n = $('<div class="nx-menu-popup grey" style="width:' + o + ';padding:0">').appendTo(i);
            $('<div class="nx-section-head">').text("Duplicate Table: " + t.caption).appendTo(n);
            var s = $('<div class="nx-section-pane">').appendTo(n);
            $('<div style="padding:0 8px">').text("Select fields to copy:").appendTo(s);
            for (var a = $('<div style="max-height:400px;overflow:auto;padding:8px;background-color:#fff;border:solid 1px #ddd;margin:8px">').appendTo(s), r = [], l = t.sorted, c = 0; c < l.length; c++) {
                var d = l[c],
                    h = $('<div style="display:flex;display:-webkit-flex">').appendTo(a),
                    p = $('<input type="checkbox" style="margin:10px 4px 0 0">').appendTo(h);
                d.isReverse || p.attr("checked", "checked"),
                $('<div style="flex:1 1 auto;-webkit-flex:1 1 auto;display:flex;display:-webkit-flex">').append($('<div class="type-symbol i-32-24 i-grey i-field-' + d.base + '">')).append($('<div style="line-height:32px;white-space:nowrap;overflow:hidden">').text(d.caption)).appendTo(h),
                r.push({
                    field: d,
                    $duplicate: p
                })
            }
            var u = $('<div class="nx-button-bar">').appendTo(s);
            function f() {
                i.animFadeOut((function() {
                    i.remove(),
                    e.close && e.close()
                }))
            }
            $('<div class="nx-button-text grey">').text(locale.cancel).appendTo(u).touch(f),
            $('<div class="nx-hspace-flex">').appendTo(u),
            $('<div class="nx-button-text blue">').text(locale.duplicateTable).appendTo(u).touch((function() {
                var i = function(e, t) {
                    for (var i = e.schema, o = i.createType(function(e) {
                            var t = e.schema,
                                i = e.caption || locale.table,
                                o = 2,
                                n = St.exec(i);
                            n && (o = parseInt(n[1]), i = i.substr(0, n.index));
                            for (; t.findType(i + "" + o);)
                                o++;
                            return i + "" + o
                        }(e)), n = 0; n < t.length; n++) {
                        var s = t[n],
                            a = s.field;
                        if (s.$duplicate.is(":checked"))
                            if (a.isField)
                                (r = a.toJSON()).uuid = void 0,
                                i.createField2(o, r);
                            else if (a.isReference)
                                i.createReference(o, a.caption, a.refType, Et(a.refType, a.reverse.caption), a.cascade, void 0, void 0, void 0, void 0, a.order, void 0, !1);
                            else if (a.isReverse)
                                i.createReference(a.refType, Et(a.refType, a.reference.caption), o, a.caption, a.reference.cascade, void 0, void 0, void 0, void 0, void 0, a.order, !1);
                            else if (a.isUI) {
                                var r;
                                (r = a.toJSON()).uuid = void 0,
                                i.createUI2(o, r)
                            }
                    }
                    return o
                }(t, r);
                f(),
                e.okay && e.okay(i)
            })),
            i.appendTo($(document.body)).animFadeIn(),
            n.center()
        }
        var St = /([0-9]+)$/;
        function Et(e, t) {
            var i = t || locale.field,
                o = 2,
                n = St.exec(i);
            for (n && (o = parseInt(n[1]), i = i.substr(0, n.index)); e.findElement(i + "" + o);)
                o++;
            return i + "" + o
        }
        function _t(e) {
            var t,
                i = void 0,
                o = "EDIT_FIELDS",
                s = e.schema || database.schema.clone(),
                r = e.schemaDirty || !1,
                c = e.isNewType || !1,
                d = e.type;
            if (d) {
                if (!(t = s.types[d]))
                    return
            } else
                t = s.createType(),
                r = !0,
                c = !0;
            s.on("change", ie);
            var h = $.backplane({
                    closable: !1,
                    enter: function(e) {
                        r || (e.preventDefault(), oe())
                    },
                    escape: function(e) {
                        r || (e.preventDefault(), oe())
                    }
                }),
                p = $('<div class="typeeditor">').appendTo(h),
                u = $("<div>").appendTo(p),
                f = $('<div class="typeeditor-bottom">').appendTo(p),
                m = $('<div class="typeeditor-left">').appendTo(p),
                g = $('<div class="--ul-typeeditor-center-right-container" style="pointer-events: none;position: absolute;">').appendTo(p),
                v = $('<div class="typeeditor-center accordion">').appendTo(p),
                b = $('<div class="typeeditor-right accordion">').appendTo(p);
            if (!c) {
                var y = $('<div class="nx-button-text red">').appendTo(f).touch((function() {
                    Object(l.f)("Table", "Remove"),
                    $.dialog({
                        closable: !0,
                        caption: locale.removeTable,
                        message: locale.confirmRemoveTable,
                        buttons: [{
                            color: "red",
                            caption: locale.removeTable,
                            callback: function() {
                                Object(l.f)("Table", "RemoveConfirm"),
                                $.loading(!0),
                                t.schema.removeType(t),
                                database.updateSchema(s, (function(e) {
                                    if ($.loading(!1), e)
                                        return $.alert(e);
                                    oe()
                                }))
                            }
                        }]
                    })
                }));
                window.getWidth() < 640 ? y.append('<div class="i-32-24 i-red i-setting-trash"/>') : y.text(locale.removeTable),
                $('<div class="nx-hspace-small">').appendTo(f),
                $('<div class="nx-button-text grey">').text(locale.duplicateTable + "...").appendTo(f).touch((function() {
                    Object(l.f)("Table", "Duplicate"),
                    new kt({
                        type: t,
                        cancel: function() {},
                        okay: function(e) {
                            Object(l.f)("Table", "DuplicateConfirm"),
                            oe(),
                            new _t({
                                schema: s,
                                type: e.id,
                                isNewType: !0,
                                schemaDirty: !0
                            })
                        }
                    })
                }))
            }
            $('<div class="nx-hspace-flex">').appendTo(f);
            var w = $('<div class="nx-button-text grey">').text(locale.cancel).appendTo(f).touch(oe),
                x = $('<div class="nx-button-text blue --ul-type-editor-save-button" style="margin-left:8px">').text(locale.okay).appendTo(f).touch((function() {
                    if (!r)
                        return oe();
                    Object(l.f)("Table", "SaveChanges"),
                    e.beforeSaveType && e.beforeSaveType();
                    $.loading(!0),
                    database.updateSchema(s, (function(i) {
                        if ($.loading(!1), i)
                            return $.alert(i);
                        oe(),
                        e.afterSaveType && e.afterSaveType(t.id)
                    }))
                }));
            r ? window.getWidth() < 640 ? (x.text(""), x.append('<div class="i-32-24 i-white i-save"/>')) : x.text(locale.saveDataModelChanges) : w.hide();
            var C,
                k,
                S,
                E,
                _,
                D,
                M = $("<div>"),
                N = new Ue.a(this, t.getIconModel(), M, {
                    cls: "--ul-table-icon-button table-icon-button",
                    formWidth: .17
                }),
                I = new Ue.a(this, t.getCaptionModel(), M, {
                    cls: "--ul-table-name-input",
                    formWidth: .83
                }),
                O = $("<div>").appendTo(m),
                R = new Ue.a(this, t.getHiddenModel(), m, {
                    cls: "typeeditor-boolean"
                }),
                j = new Ue.a(this, t.getGlobalSearchModel(), m, {
                    cls: "typeeditor-boolean"
                }),
                L = new Ue.a(this, t.getHasFilesModel(), m, {
                    cls: "typeeditor-boolean"
                }),
                F = database.supports.comments ? new Ue.a(this, t.getHasCommentsModel(), m, {
                    cls: "typeeditor-boolean"
                }) : void 0,
                A = database.supports.history ? new Ue.a(this, t.getHasHistoryModel(), m, {
                    cls: "typeeditor-boolean"
                }) : void 0,
                H = new Ue.a(this, t.getAfterCreateModel(), m),
                P = new Ue.a(this, t.getAfterUpdateModel(), m);
            database.supports.authentication && (C = new Ue.a(this, t.getReadRolesModel(), m), k = new Ue.a(this, t.getWriteRolesModel(), m)),
            _ = new Ue.a(this, t.getCanReadModel(), m),
            D = new Ue.a(this, t.getCanWriteModel(), m),
            database.supports.authentication && (S = new Ue.a(this, t.getCreateRolesModel(), m), E = new Ue.a(this, t.getDeleteRolesModel(), m));
            $('<div class="accordion-head">').text(locale.fields).appendTo(v);
            var U = $('<div class="accordion-pane --ul-type-editor-center">').appendTo(v).css({
                    overflow: "auto"
                }),
                z = !1,
                V = !1,
                W = -1;
            U.sortable({
                start: function() {
                    V = !0
                },
                stop: function(e) {
                    V = !1
                },
                beforeStop: function() {},
                receive: function(e, i) {
                    z = !0;
                    var o = i.sender;
                    if (!o)
                        return;
                    var n,
                        s = W,
                        a = o.data("col");
                    if (!a)
                        return;
                    if (a.isCreateField) {
                        var r = t.createNewFieldName(a.field.base, a.field.caption);
                        n = t.schema.createField2(t, Object.assign({}, a.field, {
                            caption: r,
                            order: s - 1
                        })),
                        Object(l.f)("Table", "AddField", {
                            type: "Field",
                            fieldType: a.field.base
                        })
                    } else if (a.isCreateReference) {
                        var c = a.refType,
                            d = c.caption;
                        for (let e = 2; t.findElement(d); e++)
                            d = c.caption + e;
                        var h = t.caption;
                        for (let e = 2; c.findElement(h) || t === c && d === h; e++)
                            h = t.caption + e;
                        n = t.schema.createReference(t, d, c, h, !1),
                        Object(l.f)("Table", "AddField", {
                            type: "Table Reference",
                            fieldType: "reference"
                        })
                    } else
                        a.isCreateUI && (n = t.schema.createUI(t, a.field.caption, s - 1, a.field.base), Object(l.f)("Table", "AddField", {
                            type: "Layout Element",
                            fieldType: a.field.base
                        }));
                    setTimeout((function() {
                        ee(),
                        z = !1,
                        function(e) {
                            if (TOUCH) {
                                let t = e.data("field");
                                if (!t)
                                    return;
                                new Ct.a(void 0, t, !0)
                            } else {
                                if (!e)
                                    return;
                                let o = e.data("field");
                                if (!o)
                                    return;
                                var t = e.find(".t-columneditor-label"),
                                    i = $('<input class="t-columneditor-input" type="text">').val(o.caption);
                                t.before(i),
                                t.detach(),
                                i.keyup((function(e) {
                                    13 === e.which && i.blur()
                                })),
                                i.blur((function() {
                                    var e = i.val();
                                    o.caption = e,
                                    t.text(e),
                                    i.before(t),
                                    i.remove()
                                })),
                                i.focus().select()
                            }
                        }(function(e) {
                            for (var t = U.children(), i = 0; i < t.length; i++) {
                                var o = $(t[i]);
                                if (o.data("field") === e)
                                    return o
                            }
                        }(n))
                    }), 0)
                },
                sort: function(e, t) {
                    W = t.placeholder.index()
                },
                update: function() {
                    if (z)
                        return;
                    for (var e = U.children(), i = 0; i < e.length; i++) {
                        $(e[i]).data("field").order = i
                    }
                    t.resort(),
                    s.trigger("change")
                },
                handle: TOUCH ? ".t-columneditor-icon, .t-columneditor-label" : void 0
            });
            var B = $('<div class="accordion-head">').text(locale.createField).appendTo(b),
                q = $('<div class="accordion-pane">').appendTo(b).css({
                    overflow: "auto"
                }),
                Y = $('<div class="accordion-head">').text(locale.createUI).appendTo(b),
                X = $('<div class="accordion-pane">').appendTo(b).css({
                    overflow: "auto"
                }).hide(),
                G = $('<div class="accordion-head">').text(locale.createReference).appendTo(b),
                J = $('<div class="accordion-pane">').appendTo(b).css({
                    overflow: "auto"
                }).hide();
            B.touch((function() {
                Z(q)
            })),
            Y.touch((function() {
                Z(X)
            })),
            G.touch((function() {
                Z(J)
            }));
            var K = q;
            function Q() {
                var e = window.getWidth(),
                    t = window.getHeight(),
                    s = t - 56,
                    r = Math.min(348, Math.floor((e - 348) / 2)),
                    l = r,
                    c = 348 + r + l,
                    d = Math.max(0, Math.floor((e - c) / 2));
                p.css({
                    width: c,
                    left: d
                }),
                (void 0 === i || i >= 640) && e < 640 ? (p.prepend(M), function e() {
                    const t = [{
                        isSelected: "EDIT_FIELDS" === o,
                        text: locale.fields,
                        onClick: () => {
                            o = "EDIT_FIELDS",
                            e()
                        }
                    }, {
                        isSelected: "SECURITY_OPTIONS" === o,
                        text: locale.options,
                        onClick: () => {
                            o = "SECURITY_OPTIONS",
                            e()
                        }
                    }];
                    n.render(a.createElement($t, {
                        tabs: t
                    }), u[0]),
                    "SECURITY_OPTIONS" === o ? (m.css("display", ""), b.css("display", "none"), v.css("display", "none")) : (m.css("display", "none"), b.css("display", ""), v.css("display", ""))
                }()) : (void 0 === i || i <= 640) && e > 640 && (M.appendTo(O), n.unmountComponentAtNode(u[0])),
                e > 640 ? (m.css({
                    display: "",
                    top: 16,
                    bottom: 112,
                    left: 16,
                    width: 316
                }), b.css({
                    display: "",
                    top: 16,
                    bottom: 112,
                    left: 348 + r,
                    width: l - 16
                }), v.css({
                    display: "",
                    top: 16,
                    bottom: 112,
                    left: 348,
                    width: r - 16
                }), J.css({
                    height: s - 282
                }), U.css({
                    height: s - 196
                }), q.css({
                    height: s - 282
                }), X.css({
                    height: s - 282
                }), p.css({
                    top: 16,
                    bottom: 16,
                    height: t - 80
                }), g.css({
                    top: 16,
                    bottom: 112,
                    left: 348,
                    width: r + l - 16
                })) : (m.css({
                    left: 16,
                    width: "95%",
                    top: 128,
                    bottom: 136
                }), v.css({
                    left: "3%",
                    width: "45%",
                    top: 128,
                    bottom: 136
                }), b.css({
                    left: "52%",
                    width: "45%",
                    top: 128,
                    bottom: 136
                }), g.css({
                    left: "3%",
                    width: "94%",
                    top: 128,
                    bottom: 136
                }), p.css({
                    top: 0,
                    bottom: 0,
                    height: t
                }), U.css({
                    height: s - 252
                }), q.css({
                    height: s - 336
                }), X.css({
                    height: s - 336
                }), J.css({
                    height: s - 336
                })),
                i = e
            }
            function Z(e) {
                K !== e && (K.slideUp("fast"), e.slideDown("fast"), K = e)
            }
            function ee() {
                U.empty();
                var e = 0,
                    i = t.sorted;
                T.each(i, (function(i) {
                    e++;
                    var o = i.getExpressionErrors().length > 0,
                        n = "rev" === i.base && i.refType.master === t ? "list" : "signature" === i.fileHandling ? "signature" : i.base;
                    $('<div class="t-columneditor-column' + (o ? " error" : "") + '">').data("field", i).append($('<div class="t-columneditor-icon i-32-24 ' + (o ? "i-red" : "i-light-grey") + '">').addClass("i-field-" + n)).append($('<div class="t-columneditor-label">').text(i.caption)).appendTo(U).mouseup((function() {
                        V || new Ct.a(void 0, i)
                    }))
                })),
                0 === e && $('<div style="padding:16px;color:#555">').text(locale.dragFieldsHere).appendTo(U)
            }
            function te() {
                J.empty();
                var e = {
                    connectToSortable: U,
                    helper: "clone",
                    zIndex: 1e7,
                    appendTo: $(document.body),
                    handle: TOUCH ? ".t-columneditor-icon, .t-columneditor-label" : void 0
                };
                T.each(util.localeSortBy(t.schema.types, "caption"), (function(t) {
                    var i = {
                        refType: t,
                        isCreateReference: !0
                    };
                    $('<div class="t-columneditor-column">').data("col", i).append($('<div class="t-columneditor-icon i-32-24 i-light-grey">').addClass("i-field-ref")).append($('<div class="t-columneditor-label">').text(t.caption)).appendTo(J).draggable(e)
                }))
            }
            function ie() {
                ee(),
                te(),
                r || (r = !0, w.show(), window.getWidth() < 640 ? (x.text(""), x.append('<div class="i-32-24 i-white i-save"/>')) : x.text(locale.saveDataModelChanges))
            }
            function oe() {
                $(window).off("resize", Q),
                s.off("change", ie),
                h.close((function() {
                    I.destroy(),
                    N.destroy(),
                    R.destroy(),
                    j.destroy(),
                    L && L.destroy(),
                    F && F.destroy(),
                    A && A.destroy(),
                    C && C.destroy(),
                    k && k.destroy(),
                    S && S.destroy(),
                    E && E.destroy(),
                    _ && _.destroy(),
                    D && D.destroy(),
                    H && H.destroy(),
                    P && P.destroy(),
                    e.close && e.close(),
                    n.unmountComponentAtNode(u[0])
                }))
            }
            ee(),
            function() {
                q.empty();
                var e = {
                    connectToSortable: U,
                    helper: "clone",
                    zIndex: 1e7,
                    appendTo: $(document.body),
                    handle: TOUCH ? ".t-columneditor-icon, .t-columneditor-label" : void 0
                };
                t({
                    base: "fn",
                    caption: locale.types.fn
                }),
                t({
                    base: "string",
                    caption: locale.types.string
                }),
                t({
                    base: "string",
                    caption: locale.types.string_multiline,
                    stringMultiline: !0
                }),
                t({
                    base: "html",
                    caption: locale.types.html
                }),
                t({
                    base: "number",
                    caption: locale.types.number
                }),
                t({
                    base: "boolean",
                    caption: locale.types.boolean
                }),
                t({
                    base: "choice",
                    caption: locale.types.choice
                }),
                t({
                    base: "multi",
                    caption: locale.types.multi
                }),
                t({
                    base: "date",
                    caption: locale.types.date
                }),
                t({
                    base: "time",
                    caption: locale.types.time
                }),
                t({
                    base: "timestamp",
                    caption: locale.types.timestamp
                }),
                t({
                    base: "timeinterval",
                    caption: locale.types.timeinterval
                }),
                t({
                    base: "appointment",
                    caption: locale.types.appointment
                }),
                t({
                    base: "file",
                    caption: locale.types.file
                }),
                t({
                    base: "file",
                    caption: locale.signature,
                    fileHandling: "signature"
                }),
                t({
                    base: "link",
                    caption: locale.types.link
                }),
                t({
                    base: "email",
                    caption: locale.types.email
                }),
                t({
                    base: "phone",
                    caption: locale.types.phone
                }),
                t({
                    base: "location",
                    caption: locale.types.location
                }),
                t({
                    base: "color",
                    caption: locale.types.color
                }),
                t({
                    base: "icon",
                    caption: locale.types.icon
                }),
                database.supports.authentication && t({
                    base: "user",
                    caption: locale.types.user
                });
                function t(t) {
                    var i = {
                            field: t,
                            isCreateField: !0
                        },
                        o = "signature" === t.fileHandling ? "signature" : t.base;
                    $('<div class="t-columneditor-column --ul-type-editor-right-field">').data("col", i).append($('<div class="t-columneditor-icon i-32-24 i-light-grey">').addClass("i-field-" + o)).append($('<div class="t-columneditor-label">').text(t.caption)).appendTo(q).draggable(e)
                }
                t({
                    base: "dchoice",
                    caption: locale.choiceDynamic
                }),
                t({
                    base: "dmulti",
                    caption: locale.multipleChoiceDynamic
                })
            }(),
            function() {
                X.empty();
                var e = {
                    connectToSortable: U,
                    helper: "clone",
                    zIndex: 1e7,
                    appendTo: $(document.body),
                    handle: TOUCH ? ".t-columneditor-icon, .t-columneditor-label" : void 0
                };
                function t(t) {
                    var i = {
                        field: t,
                        isCreateUI: !0
                    };
                    $('<div class="t-columneditor-column">').data("col", i).append($('<div class="t-columneditor-icon i-32-24 i-light-grey">').addClass("i-field-" + t.base)).append($('<div class="t-columneditor-label">').text(t.caption)).appendTo(X).draggable(e)
                }
                t({
                    base: "tab",
                    caption: locale.types.tab
                }),
                t({
                    base: "head",
                    caption: locale.types.head
                }),
                t({
                    base: "text",
                    caption: locale.types.text
                }),
                t({
                    base: "br",
                    caption: locale.types.br
                }),
                t({
                    base: "space",
                    caption: locale.types.space
                }),
                t({
                    base: "button",
                    caption: locale.types.button
                }),
                t({
                    base: "view",
                    caption: locale.types.view
                }),
                t({
                    base: "chart",
                    caption: locale.types.chart
                })
            }(),
            te(),
            Q(),
            $(window).on("resize", Q),
            c && setTimeout((function() {
                p.find(".component").first().data("component").focus()
            }), 400)
        }
        function Dt(e, t) {
            this.container = e,
            this.visible = !1,
            this.el = $('<div class="schema">'),
            this.$controls = $('<div class="admin-schema-controls">'),
            this.$controls.button2({
                cls: "blue",
                caption: locale.addTable,
                click: function() {
                    Object(l.f)("DataModel", "CreateTable"),
                    new _t({})
                }
            }),
            this.resize = () => {
                this.render()
            },
            database.on("schema", void 0, this.schemaChanged, this)
        }
        function Mt(e, t) {
            this.container = e,
            this.visible = !1;
            var i = database.settings;
            this.el = $('<div class="admin-options">');
            var o = $('<div class="admin-options-pane">').appendTo(this.el),
                n = new util.SimpleModel(new schemas.TRoles(void 0, void 0, {
                    caption: locale.rolesOpen,
                    width: 4
                }));
            n.value = i.rolesOpen ? i.rolesOpen.slice() : [];
            new Ue.a(this, n, o);
            var s = new util.SimpleModel(new schemas.TRoles(void 0, void 0, {
                caption: locale.history,
                width: 4
            }));
            s.value = i.rolesHistory ? i.rolesHistory.slice() : [];
            new Ue.a(this, s, o);
            var a = new util.SimpleModel(new schemas.TRoles(void 0, void 0, {
                caption: locale.rolesExport,
                width: 4
            }));
            a.value = i.rolesExport ? i.rolesExport.slice() : [];
            new Ue.a(this, a, o);
            var r = new util.SimpleModel(new schemas.TRoles(void 0, void 0, {
                caption: locale.rolesImport,
                width: 4
            }));
            r.value = i.rolesImport ? i.rolesImport.slice() : [];
            new Ue.a(this, r, o);
            var l = new util.SimpleModel(new schemas.TRoles(void 0, void 0, {
                caption: locale.rolesPrint,
                width: 4
            }));
            l.value = i.rolesPrint ? i.rolesPrint.slice() : [];
            new Ue.a(this, l, o);
            var c = new util.SimpleModel(new schemas.TRoles(void 0, void 0, {
                caption: locale.rolesMassDataUpdate,
                width: 4
            }));
            c.value = i.rolesMassDataUpdate ? i.rolesMassDataUpdate.slice() : [];
            new Ue.a(this, c, o);
            $('<div style="padding:8px 0;text-align:right">').appendTo(o).button(void 0, locale.saveSchema, "blue", (function() {
                database.updateSettings({
                    rolesOpen: n.value,
                    rolesHistory: s.value,
                    rolesExport: a.value,
                    rolesImport: r.value,
                    rolesPrint: l.value,
                    rolesMassDataUpdate: c.value
                }, (function(e) {
                    if (e)
                        return $.alert(e);
                    $.alert(locale.okay)
                }))
            }))
        }
        Dt.prototype.base = "schema",
        Dt.prototype.getNavigationState = function() {
            return {
                base: "schema"
            }
        },
        Dt.prototype.destroy = function() {
            database.off("schema", void 0, this.schemaChanged, this),
            this.el.remove(),
            this.$controls.remove()
        },
        Dt.prototype.hide = function() {
            this.visible && (this.visible = !1, $(window).off("resize", this.resize), this.$controls.detach(), this.el.detach().empty())
        },
        Dt.prototype.show = function() {
            if (!this.visible) {
                Object(l.f)("DataModel", "Open"),
                this.visible = !0,
                this.el.appendTo(this.container.el),
                this.$controls.appendTo(ui.$body),
                $(window).on("resize", this.resize);
                var e = this;
                setTimeout((function() {
                    e.render()
                }), 0)
            }
        },
        Dt.prototype.schemaChanged = function(e, t, i) {
            this.visible && this.render()
        },
        Dt.prototype.render = function() {
            var e = this.el,
                t = database.schema.types;
            if (0 !== T.size(t)) {
                var i = new yt,
                    o = {},
                    n = {};
                T.each(t, (function(e) {
                    var t = {
                        children: [],
                        type: e
                    };
                    if (o[e.id] = t, !e.master) {
                        var s = i.node(e.caption, {
                            type: e,
                            group: t
                        });
                        s.rad = 1.5,
                        s.mass = 1,
                        s.color = 1,
                        t.node = s,
                        n[e.id] = s
                    }
                })),
                T.each(t, (function(e) {
                    var t = o[e.id];
                    if (e.master) {
                        var i = o[e.master.id];
                        i.children.push(t),
                        t.parent = i
                    }
                })),
                T.each(t, (function(e) {
                    o[e.id];
                    if (e.master) {
                        for (var t = o[e.master.id]; t.parent;)
                            t = t.parent;
                        t.node.rad += .4
                    }
                }));
                var s = [],
                    a = {};
                T.each(t, (function(e) {
                    for (var t = o[e.id], n = t; n.parent;)
                        n = n.parent;
                    var r = n.node;
                    T.each(e.fields, (function(n) {
                        if (n.isReference) {
                            var l = e.id + "-" + n.refType.id,
                                c = n.refType.id + "-" + e.id;
                            if (!a[l] && (a[l] = !0, !a[c])) {
                                a[l] = !0;
                                for (var d = o[n.refType.id], h = d; h.parent;)
                                    h = h.parent;
                                var p = h.node;
                                if (t !== d && (!t.type.master || t.type.master !== d.type)) {
                                    var u = i.node(n.caption, {
                                        source: r,
                                        target: p,
                                        sourceGroup: t,
                                        targetGroup: d
                                    });
                                    u.mass = 0,
                                    u.color = 2,
                                    u.rad = .2;
                                    i.edge(u, r, n.caption, {}),
                                    i.edge(u, p, n.caption, {});
                                    s.push(u)
                                }
                            }
                        }
                    }))
                }));
                var r = Math.max(800, ui.$body.width() - 20),
                    l = Math.max(600, ui.$body.height()),
                    c = 50;
                i.powerDirectInit(r / c, l / c);
                for (var d = 0; d < 2e3; d++) {
                    if (i.powerDirectStep(.05) < 1)
                        break
                }
                var h = 1 / 0,
                    p = 1 / 0,
                    u = -1 / 0,
                    f = -1 / 0;
                T.each(n, (function(e) {
                    h = Math.min(e.x - e.rad, h),
                    p = Math.min(e.y - e.rad, p),
                    u = Math.max(e.x + e.rad, u),
                    f = Math.max(e.y + e.rad, f)
                }));
                var m = u - h,
                    g = f - p,
                    v = Math.ceil(Math.max(l, c * g)),
                    b = Math.ceil(Math.max(r, c * m)),
                    y = Math.round((b - c * m) / 2),
                    w = Math.round((v - c * g) / 2);
                e.empty();
                var x = "http://www.w3.org/2000/svg",
                    $ = document.createElementNS(x, "svg");
                e[0].appendChild($),
                $.setAttributeNS(null, "viewBox", "0 0 " + b + " " + v),
                $.setAttributeNS(null, "width", b),
                $.setAttributeNS(null, "height", v);
                var C = e.width(),
                    k = e.height();
                r > C && e.scrollLeft((r - C) / 2),
                v > k && e.scrollTop((v - k) / 2);
                var S = document.createElementNS(x, "defs");
                $.appendChild(S);
                var E = document.createElementNS(x, "marker");
                E.id = "Triangle",
                E.setAttributeNS(null, "refX", "4"),
                E.setAttributeNS(null, "refY", "3"),
                E.setAttributeNS(null, "markerWidth", "6"),
                E.setAttributeNS(null, "markerHeight", "6"),
                E.setAttributeNS(null, "orient", "auto"),
                S.appendChild(E);
                var _ = document.createElementNS(x, "path");
                _.setAttributeNS(null, "d", "M0,0 L0,6 L4,3 L0,0"),
                _.setAttributeNS(null, "class", "schema-arrow"),
                E.appendChild(_);
                var D = document.createElementNS(x, "g");
                $.appendChild(D);
                var M = document.createElementNS(x, "g");
                $.appendChild(M),
                T.each(n, (function(e) {
                    var t = e.data.group;
                    !function e(t, i) {
                        var o = i.type,
                            n = document.createElementNS(x, "g");
                        t.appendChild(n);
                        var s = document.createElementNS(x, "clipPath");
                        s.id = "CLIP_" + Math.random(),
                        n.appendChild(s);
                        var a = document.createElementNS(x, "rect");
                        s.appendChild(a);
                        var r = document.createElementNS(x, "rect");
                        r.setAttributeNS(null, "class", "schema-type"),
                        n.appendChild(r);
                        var l = document.createElementNS(x, "text");
                        l.appendChild(document.createTextNode(o.caption)),
                        l.setAttributeNS(null, "class", "schema-type-text"),
                        l.setAttributeNS(null, "clip-path", "url(#" + s.id + ")"),
                        n.appendChild(l);
                        for (var c = 120, d = 30, h = [], p = 0; p < i.children.length; p++) {
                            var u = i.children[p];
                            e(n, u),
                            c = Math.max(c, u.w),
                            d += u.h + 10,
                            h.push(u)
                        }
                        h.length > 0 && (c += 20);
                        var f = -c / 2,
                            m = -d / 2;
                        r.setAttributeNS(null, "rx", 4),
                        r.setAttributeNS(null, "ry", 4),
                        r.setAttributeNS(null, "x", f),
                        r.setAttributeNS(null, "y", m),
                        r.setAttributeNS(null, "width", c),
                        r.setAttributeNS(null, "height", d),
                        a.setAttributeNS(null, "x", f),
                        a.setAttributeNS(null, "y", m),
                        a.setAttributeNS(null, "width", c),
                        a.setAttributeNS(null, "height", d);
                        var g,
                            v = l.getComputedTextLength();
                        g = v > c - 10 ? f + 5 : -v / 2;
                        l.setAttributeNS(null, "x", g),
                        l.setAttributeNS(null, "y", m + 20);
                        var b = m + 30;
                        for (p = 0; p < h.length; p++) {
                            (u = h[p]).x = 0,
                            u.y = b + u.h / 2,
                            u.shape.setAttributeNS(null, "transform", "translate(" + u.x + " " + u.y + ")"),
                            b += u.h + 10
                        }
                        i.w = c,
                        i.h = d,
                        i.shape = n,
                        l.onclick = r.onclick = function() {
                            new _t({
                                type: o.id
                            })
                        }
                    }(D, t);
                    var i = y + c * (e.x - h),
                        o = w + c * (e.y - p);
                    t.x = i,
                    t.y = o,
                    t.shape.setAttributeNS(null, "transform", "translate(" + i + " " + o + ")")
                })),
                T.each(s, (function(e) {
                    e.data.path && $.remove(e.data.path),
                    e.data.path = function(e, t) {
                        var i = t.data.sourceGroup,
                            o = t.data.targetGroup,
                            n = N(i),
                            s = N(o),
                            a = y + c * (t.x - h),
                            r = w + c * (t.y - p),
                            l = I(n, a, r),
                            d = I(s, a, r),
                            u = "M " + l[0] + "," + l[1] + " C " + a + "," + r + "," + a + "," + r + "," + d[0] + "," + d[1],
                            f = document.createElementNS(x, "path");
                        return f.setAttributeNS(null, "d", u), f.setAttributeNS(null, "class", "schema-link"), f.setAttributeNS(null, "style", "marker-end:url(#Triangle)"), e.appendChild(f), f
                    }(M, e)
                }))
            }
            function N(e) {
                for (var t = e.x, i = e.y, o = e.parent; o;)
                    t += o.x,
                    i += o.y,
                    o = o.parent;
                return {
                    x: t - e.w / 2,
                    y: i - e.h / 2,
                    width: e.w,
                    height: e.h
                }
            }
            function I(e, t, i) {
                var o = e.x,
                    n = e.y,
                    s = e.width,
                    a = e.height,
                    r = s / 2,
                    l = a / 2,
                    c = o + r,
                    d = n + l,
                    h = t - c,
                    p = i - d,
                    u = Math.abs(h * (l / p)),
                    f = Math.abs(p * (r / h));
                return u <= r ? p < 0 ? h > 0 ? [c + u, n] : [c - u, n] : h > 0 ? [c + u, n + a] : [c - u, n + a] : p < 0 ? h > 0 ? [o + s, d - f] : [o, d - f] : h > 0 ? [o + s, d + f] : [o, d + f]
            }
        },
        Mt.prototype.base = "security",
        Mt.prototype.getNavigationState = function() {
            return {
                base: "security"
            }
        },
        Mt.prototype.destroy = function() {
            this.el.remove()
        },
        Mt.prototype.show = function() {
            Object(l.f)("Security", "Open"),
            this.visible || (this.visible = !0, this.el.appendTo(this.container.el))
        },
        Mt.prototype.hide = function() {
            this.visible && (this.visible = !1, this.el.detach())
        };
        o("./src/react/Console.css");
        function Nt({navigationState: e, updateNavigationState: t, queries: i, database: o}) {
            const [n, s] = a.useState(e.consoleInput || ""),
                [r, c] = a.useState(e.consoleOutput || "");
            return a.createElement("div", {
                className: "Console_root"
            }, a.createElement("div", {
                className: "Console_header"
            }, a.createElement(ee.a, {
                className: "Console_runButton nx-button-text blue",
                onFastClick: function(e) {
                    Object(l.f)("Console", "Run"),
                    function(e, t) {
                        let n;
                        try {
                            n = i.parse(o.schema, void 0, e, {}, !0, !0, !0),
                            n.errors && n.errors.length ? c(n.errorMessage()) : n.evaluate(o, void 0, (e, s) => {
                                if (e)
                                    c(n.errorMessage());
                                else {
                                    let e = "";
                                    n.isMultiple() ? s && (e = s.reduce((e, t) => [...e, n.returnType.format(t)], []).join("\n")) : e = n.returnType.format(s),
                                    t && (e += "\n=== Internal Expression ===\n" + n.toString() + "\n=== Reparsed Expression ===\n" + i.parseSystem(o.schema, void 0, n.toString(), {}).toHumanString("") + "\n=== JS Sync Code ===\n" + n.getSyncJS() + "\n=== JS Async Code ===\n" + n.getAsyncJS()),
                                    c(e)
                                }
                            })
                        } catch (e) {
                            c(e + " / " + n.getAsyncJS())
                        }
                    }(n, e.event.metaKey && e.event.shiftKey),
                    t(n, r)
                }
            }, Object(b.getLocale)().runConsole), a.createElement("div", {
                className: "Console_error"
            }, function(e) {
                try {
                    const t = i.parse(o.schema, void 0, e, {}, !0, !0, !0);
                    if (t.errors && t.errors.length)
                        return t.errors[0].message
                } catch (e) {
                    return e.toString()
                }
            }(n))), a.createElement("textarea", {
                onChange: e => {
                    return i = e.target.value, s(i), void t(n, r);
                    var i
                },
                value: n,
                style: {
                    height: "30%"
                },
                className: "Console_input",
                autoCorrect: "off",
                autoCapitalize: "off",
                autoComplete: "off",
                spellCheck: !1
            }), a.createElement("textarea", {
                onChange: () => null,
                value: r,
                className: "Console_output",
                autoCorrect: "off",
                autoCapitalize: "off",
                autoComplete: "off",
                spellCheck: !1
            }))
        }
        class It {
            constructor(e, t)
            {
                K()(this, "container", void 0),
                K()(this, "navigationState", void 0),
                K()(this, "el", void 0),
                K()(this, "visible", void 0),
                K()(this, "base", void 0),
                this.container = e,
                this.navigationState = t,
                this.updateNavigationState = $.proxy(this.updateNavigationState, this),
                this.el = $('<div class="admin-options console-container">'),
                this.base = "console"
            }
            getNavigationState()
            {
                return this.navigationState
            }
            updateNavigationState(e, t)
            {
                this.navigationState.consoleInput = e,
                this.navigationState.consoleOutput = t
            }
            destroy()
            {
                n.unmountComponentAtNode(this.el[0]),
                this.el.remove()
            }
            hide()
            {
                this.visible && (this.visible = !1, this.el.detach())
            }
            show()
            {
                Object(l.f)("Console", "Open"),
                this.visible || (this.visible = !0, this.el.appendTo(this.container.el), this.updateUI())
            }
            updateUI()
            {
                this.visible && n.render(a.createElement(Nt, {
                    database: window.database,
                    queries: window.queries,
                    updateNavigationState: this.updateNavigationState,
                    navigationState: this.navigationState
                }), this.el[0])
            }
        }
        var Ot = o("./src/js/widgets/Component.js");
        function Rt(e, t, i) {
            this.container = e,
            this.field = i,
            this.visible = !0,
            this.el = $('<div class="component br">').data("component", this).attr("title", i.tooltip || "").appendTo(t.el)
        }
        function jt(e, t, i) {
            this.container = e,
            this.field = i,
            this.visible = !0,
            this.el = $('<div class="component editor button">').data("component", this).attr("title", i.tooltip || ""),
            this.updateElementWidth(),
            this.el.appendTo(t.el);
            var o = i.buttonColor || "blue";
            this.button = $('<div class="nx-button-text ' + o + '">').text(i.caption || locale.unnamed).appendTo(this.el).touch($.proxy(this.buttonClicked, this)),
            this.updateUIStyle()
        }
        Object.assign(Rt.prototype, Ot.a.prototype),
        Rt.prototype.isWidthAdjustable = function() {
            return !1
        },
        Rt.prototype.updateStructure = function() {
            var e = this.field;
            this.el.attr("title", e.tooltip || "")
        },
        Object.assign(jt.prototype, Ot.a.prototype),
        jt.prototype.isWidthAdjustable = function() {
            return !0
        },
        jt.prototype.updateStructure = function() {
            var e = this.field;
            this.button.text(e.caption || locale.unnamed),
            this.updateElementWidth(),
            this.el.attr("title", e.tooltip || "");
            var t = e.buttonColor || "blue";
            this.button[0].className = "nx-button-text " + t,
            this.updateUIStyle()
        },
        jt.prototype.setHeight = function(e) {},
        jt.prototype.updateUI = function() {},
        jt.prototype.updateUIStyle = function() {
            var e = this.field,
                t = e.style && JSON.parse(e.style) || void 0;
            if (t) {
                var i = t.backgroundColor;
                this.button.css({
                    "border-color": i,
                    "background-color": i,
                    color: t.color || util.contrastingTextColorTo(i) || "#FFF",
                    "font-weight": t.fontWeight || "",
                    "font-style": t.fontStyle || "",
                    "font-size": t.fontSize || "",
                    "text-align": t.textAlign || "",
                    "border-width": t.borderWidth || "",
                    "border-color": t.borderColor || "",
                    "border-left-style": (util.multiHasOne(t.borderSides, [1]) ? t.borderStyle : "none") || "",
                    "border-top-style": (util.multiHasOne(t.borderSides, [2]) ? t.borderStyle : "none") || "",
                    "border-bottom-style": (util.multiHasOne(t.borderSides, [3]) ? t.borderStyle : "none") || "",
                    "border-right-style": (util.multiHasOne(t.borderSides, [4]) ? t.borderStyle : "none") || ""
                })
            } else
                this.button.css({
                    "border-color": "",
                    "background-color": "",
                    color: "",
                    "font-weight": "",
                    "font-style": "",
                    "font-size": "",
                    "text-align": "",
                    "border-width": "",
                    "border-color": "",
                    "border-left-style": "",
                    "border-top-style": "",
                    "border-bottom-style": "",
                    "border-right-style": ""
                })
        },
        jt.prototype.buttonClicked = function() {
            this.button.addClass("clicked"),
            Object(c.c)(this.field.fn, this.container.nid, e => {
                this.button.removeClass("clicked"),
                e && $.alert(e)
            })
        };
        var Lt = o("./node_modules/chart.js/dist/Chart.js");
        function Ft(e) {
            var t = e.query,
                i = t.cols,
                o = t.models,
                n = t.rows,
                s = t.groups,
                a = null != t.cidxGroup,
                r = t.tid;
            if (!database.schema.types[r])
                throw new Error(locale.errorTypeNotFound);
            a && (n = t.groupsSorted);
            var l = e.chartType || "bar",
                c = e.chartDatasets || "rows",
                d = !!e.chartStacked,
                h = e.chartLineTension ? .25 : 0,
                p = void 0,
                u = [];
            function f(e) {
                var o = i[e];
                return a ? e === t.cidxGroup ? o.field : o.agg ? o.aggType : void 0 : o.field
            }
            if (i.length < 1)
                throw new Error(locale.chartNoData);
            if (1 === i.length) {
                if (k = i[0], !(w = f(0)))
                    throw new Error(locale.chartNoData);
                if ("number" !== w.base)
                    throw new Error(locale.chartNoData);
                !0,
                p = void 0,
                u = [0]
            } else {
                k = i[0],
                (w = f(0)) && "number" === w.base ? (!1, p = 0) : (!0, p = 0);
                for (var m = 1; m < i.length; m++)
                    k = i[m],
                    (w = f(m)) && "number" === w.base && u.push(m)
            }
            if (!u.length)
                throw new Error(locale.chartNoData);
            var g = {
                responsive: !1,
                responsiveAnimationDuration: 0,
                maintainAspectRatio: !1,
                onResize: null,
                devicePixelRatio: window.devicePixelRatio,
                tooltips: {
                    callbacks: {
                        label: function(e, t) {
                            const i = u[e["rows" === c ? "index" : "datasetIndex"]];
                            var o = void 0 === i ? void 0 : f(i),
                                n = "pie" === l || "doughnut" === l ? t.datasets[e.datasetIndex].data[e.index] : e.yLabel;
                            return o ? o.format(n) : String(n)
                        }
                    }
                },
                animation: {
                    duration: 0
                }
            };
            if ("none" === e.chartLegend && (g.legend = {
                display: !1
            }), "bubble" !== l) {
                var v = [],
                    b = [];
                if ("cols" === c) {
                    if (null != p)
                        for (var y = 0; y < n.length; y++) {
                            var w,
                                x = n[y],
                                T = (D = a ? s[x] : o[x]).values[p],
                                $ = (w = f(p)) ? w.format(T) : String(T);
                            v[y] = $ || String(y + 1)
                        }
                    else
                        for (y = 0; y < n.length; y++)
                            v[y] = String(y + 1);
                    for (m = 0; m < u.length; m++) {
                        var C = u[m],
                            k = i[C],
                            S = [];
                        for (y = 0; y < n.length; y++) {
                            x = n[y],
                            T = (D = a ? s[x] : o[x]).values[C];
                            S[y] = T || 0
                        }
                        var E = {
                            label: $ = k.caption || k.expression.caption,
                            data: S
                        };
                        switch (l) {
                        case "bar":
                            E.borderColor = At(m, u.length),
                            E.backgroundColor = At(m, u.length);
                            break;
                        case "line":
                        case "radar":
                            E.borderColor = Pt(m, u.length),
                            E.backgroundColor = Ht(m, u.length),
                            E.tension = h;
                            break;
                        case "pie":
                        case "doughnut":
                        case "polarArea":
                            E.borderColor = [],
                            E.backgroundColor = [];
                            for (var _ = 0; _ < n.length; _++)
                                E.borderColor[_] = "#fff",
                                E.backgroundColor[_] = At(_, n.length)
                        }
                        b.push(E)
                    }
                } else {
                    for (m = 0; m < u.length; m++) {
                        C = u[m],
                        k = i[C];
                        v[m] = k.caption || k.expression.caption
                    }
                    for (y = 0; y < n.length; y++) {
                        x = n[y];
                        var D = a ? s[x] : o[x];
                        for (S = [], m = 0; m < u.length; m++) {
                            C = u[m],
                            k = i[C],
                            T = D.values[C];
                            S[m] = T || 0
                        }
                        E = {
                            label: $ = null != p && (w = f(p)) && w.format(D.values[p]) || String(y + 1),
                            data: S
                        };
                        switch (l) {
                        case "bar":
                            E.borderColor = At(y, n.length),
                            E.backgroundColor = At(y, n.length);
                            break;
                        case "line":
                        case "radar":
                            E.borderColor = Pt(y, n.length),
                            E.backgroundColor = Ht(y, n.length),
                            E.tension = h;
                            break;
                        case "pie":
                        case "doughnut":
                        case "polarArea":
                            E.backgroundColor = [];
                            for (_ = 0; _ < u.length; _++)
                                E.backgroundColor[_] = Pt(_, u.length)
                        }
                        b.push(E)
                    }
                }
                var M = f(u[0]);
                return "bar" !== l && "line" !== l || Object.assign(g, {
                    scales: {
                        yAxes: [{
                            stacked: d,
                            ticks: {
                                beginAtZero: !0,
                                callback: function(e, t, i) {
                                    return M ? M.format(e) : String(e)
                                }
                            }
                        }],
                        xAxes: [{
                            stacked: d
                        }]
                    }
                }), new Lt(e.$canvas, {
                    type: l,
                    data: {
                        labels: v,
                        datasets: b
                    },
                    options: g
                })
            }
            if (u.length < 3)
                throw new Error(locale.chartBubbleRequiresColumns);
            for (b = [], y = 0; y < n.length; y++) {
                x = n[y],
                D = a ? s[x] : o[x];
                $ = null != p && (w = f(p)) && w.format(D.values[p]) || String(y + 1);
                var N = D.values[u[0]],
                    I = D.values[u[1]],
                    O = D.values[u[2]];
                null != N && null != I && null != O && b.push({
                    label: $,
                    borderColor: Pt(y, n.length),
                    borderWidth: 2,
                    backgroundColor: Ht(y, n.length),
                    data: [{
                        x: N,
                        y: I,
                        r: O
                    }]
                })
            }
            return new Lt(e.$canvas[0].getContext("2d"), {
                type: l,
                data: {
                    datasets: b
                },
                options: g
            })
        }
        function At(e, t) {
            return Ut(e, t, .6)
        }
        function Ht(e, t) {
            return Ut(e, t, .1)
        }
        function Pt(e, t) {
            return Ut(e, t, 1)
        }
        function Ut(e, t, i) {
            var o = 360 * e / t,
                n = util.hsv2rgb(o, .8, .8);
            return n[3] = i, util.formatColor(n)
        }
        function zt(e, t, i) {
            this.container = e,
            this.field = i,
            this.visible = !0,
            this.el = $('<div class="component editor chart">').data("component", this).attr("title", i.tooltip || "").css("height", 40 * i.height + 37 + "px"),
            this.updateElementWidth(),
            this.el.appendTo(t.el),
            this.label = $("<label>").text(i.caption || locale.unnamed).appendTo(this.el),
            this.$chart = $('<div class="chartview">').appendTo(this.el),
            this.$message = $('<div class="chartview-message">').appendTo(this.$chart),
            this.$canvas = $('<canvas class="chartview-canvas" style="display:block;width:100%;height:100%"></canvas>').appendTo(this.$chart),
            this.chart = void 0
        }
        function Vt(e, t) {
            const i = this;
            this.id = "comments",
            this.container = e,
            this.selectedIconClass = "tab-icon-container i-18 i-white i-chat",
            this.unselectedIconClass = "tab-icon-container i-18 i-light-grey i-chat",
            this.elTab = $('<div class="tab tab-icon">').attr("title", locale.comments).append($(`<div class="${this.unselectedIconClass}"></div>`)).touch($.proxy((function() {
                i.container.selectTab(i.id)
            }), this)),
            this.tabSelectedIndicator = $('<div class="tab-selected-indicator">'),
            this.el = $('<div class="comments">').hide().appendTo(e.containerEl || e.el);
            const o = $('<div class="component editor editor-string editor-4col">').appendTo(this.el);
            $("<label>").text(locale.postCommentLabel).appendTo(o),
            this.comment = $('<textarea style="height:96px">').appendTo($('<div class="stringeditor">').appendTo(o));
            const n = $('<div class="comments-post-btn">').appendTo(this.el);
            $('<div class="nx-hspace-flex">').appendTo(n),
            $('<div class="nx-button-text blue">').text(locale.postCommentButton).appendTo(n).touch($.proxy(this.post, this)),
            this.commentDiv = $('<div class="comment">').appendTo(this.el).touch($.proxy(this.commentClicked, this))
        }
        function Wt(e, t, i) {
            this.container = e,
            this.field = i,
            this.visible = !0,
            this.el = $('<div class="component editor custom">').data("component", this).appendTo(t.el),
            this.updateElementWidth(),
            this.label = $("<label>").text(i.caption || locale.unnamed).appendTo(this.el),
            this.content = $('<div style="padding:8px">').appendTo(this.el)
        }
        Object.assign(zt.prototype, Ot.a.prototype),
        zt.prototype.destroy = function() {
            this.chart && (this.chart.destroy(), this.chart = void 0),
            Ot.a.prototype.destroy.call(this)
        },
        zt.prototype.createQuery = function() {
            try {
                return new queries.QueryExpression(database, this.field, this.container.nid)
            } catch (e) {
                return
            }
        },
        zt.prototype.updateStructure = function() {
            var e = this.field;
            this.el.css("height", 40 * e.height + 37 + "px").attr("title", e.tooltip || ""),
            this.updateElementWidth(),
            this.label.text(e.caption || locale.unnamed)
        },
        zt.prototype.updateUI = function() {
            var e = this,
                t = this.createQuery();
            if (this.query = t, !t)
                return;
            let i = e._chartLoadingId = Math.random();
            t.load((function() {
                if (i === e._chartLoadingId) {
                    e.chart && (e.chart.destroy(), e.chart = void 0),
                    e.$message.text("");
                    try {
                        e.chart = Ft({
                            query: t,
                            chartType: e.field.chartType,
                            chartDatasets: e.field.chartDatasets,
                            chartStacked: e.field.chartStacked,
                            chartLineTension: e.field.chartLineTension,
                            chartLegend: e.field.chartLegend,
                            animationDuration: 0,
                            $canvas: e.$canvas
                        }),
                        e.resizeChart()
                    } catch (t) {
                        e.$message.text(t)
                    }
                }
            }))
        },
        zt.prototype.bind = function(e) {
            this.updateVisibility(),
            this.updateUI()
        },
        zt.prototype.nodeChanged = function() {
            this.updateVisibility(),
            this.updateUI()
        },
        zt.prototype.isHeightAdjustable = function() {
            return !0
        },
        zt.prototype.setHeight = function(e) {
            var t = Math.max(2, Math.round((e - 37) / 40));
            this.field.height = t,
            this.el.css("height", 40 * t + 37 + "px"),
            this.resize()
        },
        zt.prototype.widthChanged = function() {
            this.resize()
        },
        zt.prototype.resize = function() {
            this.resizeChart()
        },
        zt.prototype.resizeChart = function() {
            this.chart && this.chart.resize()
        },
        Vt.prototype.bind = function(e) {
            !database.sql && this.nid && database.offComment(this.nid, this.loadComments, this),
            this.nid = e ? e._id : void 0,
            !database.sql && this.nid && database.onComment(this.nid, this.loadComments, this),
            this.container.currentTab === this && this.loadComments()
        },
        Vt.prototype.destroy = function() {
            !database.sql && this.nid && database.offComment(this.nid, this.loadComments, this),
            this.elTab.remove(),
            this.el.remove()
        },
        Vt.prototype.hide = function(e) {
            this.container.currentTab === this && (this.container.currentTab = void 0, this.el.hide(), this.commentDiv.empty(), this.tabSelectedIndicator.detach(), this.elTab.removeClass("selected"), this.elTab[0].firstElementChild.className = this.unselectedIconClass, !database.sql && this.nid && database.offComment(this.nid, this.loadComments, this), e && e())
        },
        Vt.prototype.show = function() {
            this.container.currentTab !== this && (this.container.currentTab && this.container.currentTab.hide(), this.container.currentTab = this, this.el.show(), this.elTab.addClass("selected"), this.elTab[0].firstElementChild.className = this.selectedIconClass, this.tabSelectedIndicator.appendTo(this.elTab), this.loadComments(), !database.sql && this.nid && database.onComment(this.nid, this.loadComments, this))
        },
        Vt.prototype.focus = function() {},
        Vt.prototype.loadComments = function() {
            var e = this;
            e.container.nid && database.loadComments(e.container.nid, (function(t, i) {
                t || e.render(i)
            }))
        },
        Vt.prototype.render = function(e) {
            var t = this.commentDiv;
            t.empty();
            var i = void 0,
                o = void 0,
                n = void 0;
            T.each(e, (function(e) {
                var s = e[0],
                    a = new Date(s),
                    r = function(e) {
                        var t = e.getHours(),
                            i = e.getMinutes();
                        return (t < 10 ? "0" : "") + t + ":" + (i < 10 ? "0" : "") + i
                    }(a),
                    l = e[1],
                    c = e[2],
                    d = util.formatLocaleDate(a);
                if (d !== i && ($('<div class="comment-date">').text(d).appendTo(t), i = d, o = void 0), l !== o) {
                    const e = $('<div class="comment-head">').appendTo(t);
                    $('<div class="comment-user">').text(database.userName(l)).appendTo(e),
                    $('<div class="comment-time">').text(r).appendTo(e)
                } else if (r !== n) {
                    const e = $('<div class="comment-head">').appendTo(t);
                    $('<div class="comment-time">').text(r).appendTo(e)
                }
                o = l,
                n = r;
                $('<div class="comment-text" data-cid="' + s + '" data-user="' + l + '">').text(c).appendTo(t)
            }), this)
        },
        Vt.prototype.commentClicked = function(e) {
            var t = this,
                i = $(e.target).closest(".comment-text"),
                o = null,
                n = null,
                s = null,
                a = null;
            function r() {
                l(),
                t.removeComment(s)
            }
            function l() {
                l || (l = !0, n.remove(), o.remove(), i.show())
            }
            i.length && (s = i.attr("data-cid"), a = i.attr("data-user"), s && a && a == database.user.id && (i.hide(), n = $('<div class="comment-controls">').append($('<div class="comment-controls-buttons">').append($('<div class="button i-32-24 i-red i-setting-trash">').click(r))).insertBefore(i), o = $('<textarea class="comment-editor">').insertAfter(i).val(i.text()).blur((function() {
                var e = (o.val() || "").trim();
                e ? (l(), i.text(e), t.postComment(s, e)) : r()
            })).focus()))
        },
        Vt.prototype.post = function() {
            var e = this.comment.val() || "";
            this.comment.val(""),
            0 !== e.trim().length && this.postComment(void 0, e)
        },
        Vt.prototype.postComment = function(e, t) {
            var i = this;
            database.postComment(this.nid, e, t, (function(e, t) {
                e && $.alert(e),
                database.sql && i.loadComments()
            }))
        },
        Vt.prototype.removeComment = function(e) {
            var t = this;
            database.removeComment(this.nid, e, (function(e, i) {
                e && $.alert(e),
                database.sql && t.loadComments()
            }))
        },
        Object.assign(Wt.prototype, Ot.a.prototype),
        Wt.prototype.isWidthAdjustable = function() {
            return !0
        },
        Wt.prototype.isHeightAdjustable = function() {
            return !1
        },
        Wt.prototype.bind = function(e) {
            console.log("Custom.bind");
            var t = this;
            t.load((function() {
                t.updateUI()
            })),
            t.updateVisibility()
        },
        Wt.prototype.updateStructure = function() {
            console.log("Custom.updateStructure");
            var e = this.field;
            this.label.text(e.caption || locale.unnamed),
            this.updateElementWidth()
        },
        Wt.prototype.setHeight = function(e) {},
        Wt.prototype.updateUI = function() {
            console.log("Custom.updateUI"),
            this.content.html(this.value || "")
        },
        Wt.prototype.load = function(e) {
            var t = this;
            t.getValue((function(i, o) {
                t.value = o,
                e()
            }))
        },
        Wt.prototype.getValue = function(e) {
            var t = this;
            database.loadNode(t.container.nid, (function(i, o) {
                if (i)
                    return e(i);
                t.field.exp ? t.field.exp.evaluate(database, o, e) : e(void 0, void 0)
            }))
        };
        var Bt = o("./src/js/widgets/widgets.js");
        function qt(e, t, i) {
            this.container = e,
            this.field = i,
            this.visible = !0,
            this.error = null;
            var o = i.getEditorClass();
            this.el = $('<div class="component">').addClass(Object(Bt.d)(i)).data("component", this).attr("title", i.tooltip || ""),
            this.updateElementWidth(),
            this.el.appendTo(t.el),
            "left" === i.labelPosition && this.el.addClass("label-left"),
            this.label = $("<label>").text(i.caption || locale.unnamed).css("display", widgets.DONT_SHOW_LABEL[o] || "placeholder" === i.labelPosition || "none" === i.labelPosition ? "none" : "").appendTo(this.el),
            this.editor = Object(Bt.c)(this, this),
            this.error || this.setError(void 0)
        }
        Object.assign(qt.prototype, Ot.a.prototype),
        qt.prototype.blur = Ue.a.prototype.blur,
        qt.prototype.focus = Ue.a.prototype.focus,
        qt.prototype.editorUp = Ue.a.prototype.editorUp,
        qt.prototype.editorDown = Ue.a.prototype.editorDown,
        qt.prototype.getNid = function() {
            return this.container.nid
        },
        qt.prototype.destroy = function() {
            this.editor.destroy(),
            this.el.remove()
        },
        qt.prototype.updateStructure = function() {
            var e = this.field,
                t = e.getEditorClass();
            this.label.text(e.caption || locale.unnamed).css("display", widgets.DONT_SHOW_LABEL[t] || "placeholder" === e.labelPosition || "none" === e.labelPosition ? "none" : ""),
            this.el.attr("title", e.tooltip || ""),
            this.updateElementWidth(),
            t !== this.editor.editorClass || "fn" === t && e.exp && e.exp.returnType.base !== this.editor.base ? (this.error && this.error.detach(), this.editor.destroy(), this.el.attr("class", "component " + Object(Bt.d)(e)), this.editor = Object(Bt.c)(this, this), this.error && this.error.appendTo(this.el)) : this.editor.updateStructure(),
            this.el.toggleClass("label-left", "left" === e.labelPosition),
            this.error || this.setError(void 0)
        },
        qt.prototype.bind = function(e) {
            this.editor.load(!0),
            this.updateIsWritable(),
            this.updateVisibility()
        },
        qt.prototype.save = function() {
            this.editor.save && this.editor.save()
        },
        qt.prototype.onUpdate = function() {},
        qt.prototype.offUpdate = function() {},
        qt.prototype.getValue = function(e) {
            const t = this.getNid();
            if (!t)
                return e(void 0, void 0);
            database.loadValue(t, this.field.id, e)
        },
        qt.prototype.setValue = function(e, t) {
            if (!this.getNid())
                return t(void 0, void 0);
            database.update(this.getNid(), this.field.id, e, t)
        },
        qt.prototype.nodeChanged = function() {
            console.log("CmpField.nodeChanged"),
            this.editor.load(!1),
            this.updateIsWritable(),
            this.updateVisibility()
        },
        qt.prototype.isHeightAdjustable = function() {
            return this.editor.isHeightAdjustable()
        },
        qt.prototype.setHeight = function(e) {
            this.editor.setHeight(e)
        },
        qt.prototype.startEditCaption = function() {
            if (TOUCH)
                this.popup(!0);
            else {
                var e = this.field,
                    t = e.caption || "",
                    i = this.el.offset(),
                    o = i.left,
                    n = i.top,
                    s = this.el.outerWidth(),
                    a = {};
                $.pushInputHandler(a);
                var r = $('<div class="nx-backplane">').appendTo($(document.body)),
                    l = $('<input type="text" class="component-label-editor" style="left:' + o + "px;top:" + n + "px;width:" + s + 'px">').appendTo(r).blur((function() {
                        var i = l.val();
                        if (i != t) {
                            var o = e.caption;
                            e.caption = i,
                            e.trigger("update", "caption", o, i),
                            e.type.schema.trigger("change")
                        }
                        c()
                    })).keydown((function(e) {
                        switch (e.which) {
                        case 27:
                            e.preventDefault(),
                            c()
                        }
                    })).val(t).focus().select()
            }
            function c() {
                r.remove(),
                $.popInputHandler(a)
            }
        },
        qt.prototype.widthChanged = function() {
            this.editor && this.editor.widthChanged && this.editor.widthChanged()
        },
        qt.prototype.getError = function() {
            return Object(Bt.b)() ? this.field.getExpressionErrors()[0] : void 0
        };
        var Yt = o("./src/react/LightboxComponent.tsx"),
            Xt = o("./src/react/PdfRenderer.tsx"),
            Gt = o("./src/js/widgets/editors/ColorSelector.js");
        function Jt(e) {
            var t = $.backplane({
                    closable: !1
                }),
                i = $('<div class="paint">').appendTo(t),
                o = $('<div class="paint-head">').appendTo(i),
                n = $('<div class="paint-body">').appendTo(i),
                s = $('<div class="button"><div class="i-32-24 i-light-grey i-undo"></div></div>').click((function() {
                    if (F.length) {
                        var e = F.pop();
                        A.push(e),
                        X(),
                        J()
                    }
                })).appendTo(o),
                a = $('<div class="button"><div class="i-32-24 i-light-grey i-redo"></div></div>').click((function() {
                    if (A.length) {
                        var e = A.pop();
                        F.push(e),
                        X(),
                        J()
                    }
                })).appendTo(o);
            $('<div class="nx-hspace-small2">').appendTo(o);
            var r = $('<div class="button paint-tool"><div class="icon-big-grey icon-big-draw"></div></div>').appendTo(o).click((function() {
                    P = "draw",
                    J()
                })),
                l = $('<div class="button paint-tool"><div class="icon-big-grey icon-big-rect"></div></div>').appendTo(o).click((function() {
                    P = "rect",
                    J()
                })),
                c = $('<div class="button paint-tool"><div class="icon-big-grey icon-big-circle"></div></div>').appendTo(o).click((function() {
                    P = "circle",
                    J()
                }));
            $('<div class="nx-hspace-small2">').appendTo(o);
            var d = $('<div style="width:24px;height:24px;border-radius:12px;border:solid 4px #000;display:inline-block;box-sizing:border-box;text-align:center;line-height:16px;font-size:16px;box-shadow:rgba(255, 255, 255, 1) 0px 0px 8px;color:#555;background-color:#fff;margin:4px"></div>'),
                h = $('<div style="width:24px;height:24px;border-radius:12px;background-color:#0f0;display:inline-block;box-sizing:border-box;text-align:center;line-height:24px;font-size:16px;box-shadow:rgba(255, 255, 255, 1) 0px 0px 8px;color:#555;margin:4px"></div>'),
                p = $('<div style="border-bottom:solid 1px #fff;width:32px;height:14px">');
            $('<div class="button">').append(d).appendTo(o).click((function(e) {
                new Gt.a({
                    $el: $(e.target).closest(".button"),
                    update: function(e) {
                        U = e || "",
                        J()
                    }
                })
            })),
            $('<div class="nx-hspace-small">').appendTo(o),
            $('<div class="button">').append(h).appendTo(o).click((function(e) {
                new Gt.a({
                    $el: $(e.target).closest(".button"),
                    update: function(e) {
                        z = e || "",
                        J()
                    }
                })
            })),
            $('<div class="nx-hspace-small2">').appendTo(o),
            $('<div class="button">').append(p).appendTo(o).click((function(e) {
                var t = $(e.target).offset(),
                    i = $.backplane({
                        close: n
                    }),
                    o = $('<div style="position:absolute;width:48px">').css({
                        left: t.left,
                        top: t.top + 32
                    }).appendTo(i);
                function n() {
                    i.close(),
                    J()
                }
                $('<div style="width:48px;height:48px;background-color:rgb(0,0,0)"><div style="margin:0 8px;border-bottom:solid 1px #fff;width:32px;height:16px"></div></div>').click((function() {
                    V = 1,
                    n()
                })).appendTo(o),
                $('<div style="width:48px;height:48px;background-color:rgb(0,0,0)"><div style="margin:0 8px;border-bottom:solid 2px #fff;width:32px;height:16px"></div></div>').click((function() {
                    V = 2,
                    n()
                })).appendTo(o),
                $('<div style="width:48px;height:48px;background-color:rgb(0,0,0)"><div style="margin:0 8px;border-bottom:solid 4px #fff;width:32px;height:16px"></div></div>').click((function() {
                    V = 4,
                    n()
                })).appendTo(o),
                $('<div style="width:48px;height:48px;background-color:rgb(0,0,0)"><div style="margin:0 8px;border-bottom:solid 8px #fff;width:32px;height:16px"></div></div>').click((function() {
                    V = 8,
                    n()
                })).appendTo(o),
                $('<div style="width:48px;height:48px;background-color:rgb(0,0,0)"><div style="margin:0 8px;border-bottom:solid 16px #fff;width:32px;height:16px"></div></div>').click((function() {
                    V = 16,
                    n()
                })).appendTo(o)
            })),
            $('<div class="nx-hspace-small2">').appendTo(o);
            $('<div class="nx-button-text grey"><span>' + htmlEscape(locale.clear) + "</span></div>").click((function() {
                u = void 0,
                F = [],
                B.clearRect(0, 0, f, m),
                X()
            })).appendTo(o);
            $('<div class="nx-hspace-flex">').appendTo(o);
            $('<div class="nx-button-text grey"><span>' + htmlEscape(locale.cancel) + "</span></div>").click(Q).appendTo(o);
            $('<div class="nx-hspace-small">').appendTo(o);
            $('<div class="nx-button-text blue"><span>' + htmlEscape(locale.okay) + "</span></div>").click((function() {
                if (!F.length)
                    return Q();
                var t = w - b,
                    i = x - y,
                    o = document.createElement("canvas");
                o.width = t,
                o.height = i;
                var n = o.getContext("2d");
                n.setTransform(1, 0, 0, 1, -b, -y),
                u && n.drawImage(u, 0, 0);
                for (var s = 0; s < F.length; s++)
                    F[s].draw(n);
                var a = o.toDataURL("image/png");
                Z(),
                e.save(a)
            })).appendTo(o);
            var u = e.img,
                f = 0,
                m = 0,
                g = 0,
                v = 0,
                b = 0,
                y = 0,
                w = 0,
                x = 0,
                T = null,
                C = 0,
                k = 0,
                S = 0,
                E = 0,
                _ = 0,
                D = 0,
                M = 1,
                N = 0,
                I = 0,
                O = 0,
                R = 0,
                j = 0,
                L = 0,
                F = [],
                A = [],
                H = null,
                P = "draw",
                U = "#000",
                z = "",
                V = 4,
                W = document.createElement("canvas");
            W.style.backgroundColor = "#fff",
            n[0].appendChild(W);
            var B = W.getContext("2d");
            if (u) {
                var q = n.width(),
                    Y = n.height();
                _ = (q - u.width) / 2,
                D = (Y - (q > Y ? 96 : 116) - u.height) / 2
            }
            function X() {
                _ = Math.max(-w * M + 20, Math.min(f - b * M - 20, _)),
                D = Math.max(-x * M + 20, Math.min(m - y * M - 20, D)),
                B.setTransform(1, 0, 0, 1, 0, 0),
                B.clearRect(0, 0, f, m),
                B.setTransform(M, 0, 0, M, _, D),
                u && B.drawImage(u, 0, 0);
                for (var e = 0; e < F.length; e++)
                    F[e].draw(B)
            }
            function G() {
                if (F.length) {
                    b = 1 / 0,
                    y = 1 / 0,
                    w = -1 / 0,
                    x = -1 / 0;
                    for (var e = 0; e < F.length; e++) {
                        var t = F[e],
                            i = t.lineWidth,
                            o = Math.min(t.x0, t.x1) - i,
                            n = Math.min(t.y0, t.y1) - i,
                            s = Math.max(t.x0, t.x1) + i,
                            a = Math.max(t.y0, t.y1) + i;
                        o < b && (b = o),
                        n < y && (y = n),
                        s > w && (w = s),
                        a > x && (x = a)
                    }
                } else
                    b = 0,
                    y = 0,
                    w = 0,
                    x = 0;
                u && (b = Math.min(0, b), y = Math.min(0, y), w = Math.max(u.width, w), x = Math.max(u.height, x))
            }
            function J() {
                switch (d[0].style.borderColor = U || "#fff", d.text(U ? "" : "X"), h[0].style.backgroundColor = z, h.text(z ? "" : "X"), p[0].style.borderBottomWidth = V + "px", p[0].style.height = 16 - Math.floor(V / 2) + "px", r.removeClass("selected"), l.removeClass("selected"), c.removeClass("selected"), P) {
                case "draw":
                    r.addClass("selected");
                    break;
                case "rect":
                    l.addClass("selected");
                    break;
                case "circle":
                    c.addClass("selected")
                }
                s[0].style.opacity = F.length ? 1 : .5,
                a[0].style.opacity = A.length ? 1 : .5
            }
            function K() {
                f = n.width(),
                m = n.height();
                var e = n.offset();
                g = e.left,
                v = e.top,
                W.setAttribute("width", f),
                W.setAttribute("height", m),
                X()
            }
            function Q() {
                Z()
            }
            function Z() {
                window.removeEventListener("resize", K),
                t.close()
            }
            K(),
            J(),
            window.addEventListener("resize", K),
            W.addEventListener(TOUCH ? EVENT_touchstart : "mousedown", (function(e) {
                if (TOUCH && !e.touches)
                    return;
                if (TOUCH && 1 !== e.touches.length) {
                    if (TOUCH && 2 === e.touches.length) {
                        "draw" === H && (T = null, F.pop(), H = null, G(), X()),
                        O = _,
                        R = D,
                        N = e.touches[0].clientX,
                        I = e.touches[0].clientY;
                        var t = e.touches[0].clientX - e.touches[1].clientX,
                            i = e.touches[0].clientY - e.touches[1].clientY;
                        j = Math.sqrt(t * t + i * i),
                        L = M
                    }
                } else {
                    var o = TOUCH ? e.touches[0].clientX : e.clientX,
                        n = TOUCH ? e.touches[0].clientY : e.clientY;
                    if (null === H) {
                        switch (H = "draw", C = (o - g - _) / M, k = (n - v - D) / M, A = [], P) {
                        case "draw":
                            (T = new Kt).moveTo(C, k);
                            break;
                        case "rect":
                            T = new Qt(C, k);
                            break;
                        case "circle":
                            T = new Zt(C, k)
                        }
                        T.strokeStyle = U,
                        T.fillStyle = z,
                        T.lineWidth = V,
                        F.push(T)
                    }
                }
            })),
            W.addEventListener(TOUCH ? EVENT_touchmove : "mousemove", (function(e) {
                if (TOUCH && !e.touches)
                    return;
                if (TOUCH && 1 !== e.touches.length) {
                    if (TOUCH && 2 === e.touches.length) {
                        var t = e.touches[0].clientX,
                            i = e.touches[0].clientY,
                            o = t - N,
                            n = i - I,
                            s = Math.sqrt(o * o + n * n),
                            a = e.touches[0].clientX - e.touches[1].clientX,
                            r = e.touches[0].clientY - e.touches[1].clientY,
                            l = Math.sqrt(a * a + r * r) - j;
                        Math.abs(l) > Math.abs(s) ? ((M = Math.min(2, Math.max(.5, L + l / 100))) >= .95 && M <= 1.05 && (M = 1), _ = O, D = R) : (_ = O + o, D = R + n, M = L),
                        X()
                    }
                } else {
                    var c = TOUCH ? e.touches[0].clientX : e.clientX,
                        d = TOUCH ? e.touches[0].clientY : e.clientY;
                    if ("draw" === H) {
                        switch (S = (c - g - _) / M, E = (d - v - D) / M, P) {
                        case "draw":
                            T.lineTo(S, E);
                            break;
                        case "rect":
                        case "circle":
                            T.x1 = S,
                            T.y1 = E
                        }
                        G(),
                        X(),
                        C = S,
                        k = E
                    }
                }
            })),
            W.addEventListener(TOUCH ? EVENT_touchend : "mouseup", (function(e) {
                if (TOUCH && e.touches && e.touches.length)
                    return;
                "draw" === H && (T.isEmpty() && F.pop(), T = null, H = null, X(), J())
            }))
        }
        function Kt() {
            this.strokeStyle = "#000",
            this.lineWidth = 1,
            this.fillStyle = null,
            this.path = [],
            this.x0 = 0,
            this.y0 = 0,
            this.x1 = 0,
            this.y1 = 0
        }
        function Qt(e, t) {
            this.x0 = e,
            this.y0 = t,
            this.x1 = e,
            this.y1 = t,
            this.strokeStyle = "#000",
            this.lineWidth = 1,
            this.fillStyle = null
        }
        function Zt(e, t) {
            this.x0 = e,
            this.y0 = t,
            this.x1 = e,
            this.y1 = t,
            this.strokeStyle = "#000",
            this.lineWidth = 1,
            this.fillStyle = null
        }
        function ei(e) {
            var t = $.backplane({
                closable: !TOUCH,
                close: function() {
                    window.removeEventListener("resize", y, !1)
                }
            });
            window.addEventListener("resize", y, !1);
            var i = $('<div class="nx-menu-popup" style="position:absolute;padding:0">').appendTo(t),
                o = $('<div style="position:relative;top:0;left:0;width:100%;height:100%">').appendTo(i),
                n = $('<div style="position:absolute;left:0;bottom:0;right:0;height:48px;background-color:#eee;padding:8px;box-sizing:border-box;-webkit-box-sizing:border-box;display:flex;display:-webkit-flex">').appendTo(o);
            $('<div class="nx-button-text grey">').text(locale.cancel).appendTo(n).click((function() {
                t.close(),
                e.cancel && e.cancel()
            })),
            $('<div class="nx-hspace-small">').appendTo(n),
            $('<div class="nx-button-text grey">').text(locale.clear).appendTo(n).click((function() {
                f = [],
                b(h, s, a)
            })),
            $('<div class="nx-hspace-flex">').appendTo(n),
            $('<div class="nx-button-text blue">').text(locale.okay).appendTo(n).click((function() {
                var i = function() {
                    for (var e = 300, t = 150, i = $('<canvas width="300" height="150" style="position:absolute;left:0;top:0;border:solid 1px red">'), o = i[0], n = o.getContext("2d"), s = 1 / 0, a = 1 / 0, r = -1 / 0, l = -1 / 0, c = 0; c < f.length; c++)
                        for (var d = f[c], h = 0; h < d.length; h++) {
                            var p = d[h],
                                u = p[0],
                                m = p[1];
                            s = Math.min(s, u),
                            a = Math.min(a, m),
                            r = Math.max(r, u),
                            l = Math.max(l, m)
                        }
                    var g = (r += 4) - (s -= 4),
                        v = (l += 4) - (a -= 4),
                        y = e / g,
                        w = t / v,
                        x = Math.min(1, y, w);
                    b(n, e, t, x, (e - g * x) / 2 - x * s, (t - v * x) / 2 - x * a);
                    var T = o.toDataURL("image/png");
                    return i.remove(), T
                }();
                t.close(),
                e.okay && e.okay(i)
            }));
            var s,
                a,
                r,
                l,
                c = this.$canvas = $('<canvas style="position:absolute;left:0;top:0;background-color:#fff">').appendTo(o);
            y();
            var d = c[0],
                h = d.getContext("2d");
            d.addEventListener(TOUCH ? EVENT_touchstart : "mousedown", (function(e) {
                if (TOUCH && 1 !== e.touches.length)
                    return;
                if (!p) {
                    p = "draw";
                    var t = TOUCH ? e.touches[0].pageX : e.pageX,
                        i = TOUCH ? e.touches[0].pageY : e.pageY;
                    !function(e, t) {
                        u = [],
                        f.push(u),
                        v(e, t)
                    }(t, i),
                    TOUCH ? (EVENT_target(e).addEventListener(EVENT_touchmove, m, !1), EVENT_target(e).addEventListener(EVENT_touchend, g, !1)) : (window.addEventListener("mousemove", m, !1), window.addEventListener("mouseup", g, !1))
                }
            }), !1);
            var p = null,
                u = null,
                f = [];
            function m(e) {
                TOUCH && 1 !== e.touches.length || "draw" === p && (v(TOUCH ? e.touches[0].pageX : e.pageX, TOUCH ? e.touches[0].pageY : e.pageY), b(h, s, a, 1, 0, 0))
            }
            function g(e) {
                TOUCH && 0 !== e.touches.length || "draw" === p && (u = null, b(h, s, a, 1, 0, 0), p = null, TOUCH ? (EVENT_target(e).removeEventListener(EVENT_touchmove, m, !1), EVENT_target(e).removeEventListener(EVENT_touchend, g, !1)) : (window.removeEventListener(TOUCH ? EVENT_touchmove : "mousemove", m, !1), window.removeEventListener(TOUCH ? EVENT_touchend : "mouseup", g, !1)))
            }
            function v(e, t) {
                u.push([e - r, t - l])
            }
            function b(e, t, i, o, n, s) {
                e.strokeStyle = "#000",
                e.lineWidth = 3,
                e.clearRect(0, 0, t, i);
                for (var a = 0; a < f.length; a++) {
                    var r = f[a],
                        l = r[0];
                    if (e.beginPath(), e.moveTo(n + l[0] * o, s + l[1] * o), 1 === r.length)
                        e.lineTo(n + l[0] * o, s + l[1] * o);
                    else
                        for (var c = 1; c < r.length; c++) {
                            var d = r[c];
                            e.lineTo(n + d[0] * o, s + d[1] * o)
                        }
                    e.stroke()
                }
            }
            function y() {
                var e = window.getWidth(),
                    t = window.getHeight();
                s = Math.min(800, e),
                a = Math.min(448, t),
                r = Math.floor((e - s) / 2),
                l = Math.floor((t - a) / 2),
                i.css({
                    left: r,
                    top: l,
                    width: s,
                    height: a
                }),
                c.attr("width", s).attr("height", a - 48)
            }
        }
        function ti(e, t, i) {
            this.container = e,
            this.field = i,
            this.visible = !0,
            this.error = null,
            this.currentFile = void 0,
            this.el = $('<div class="component">').data("component", this).attr("title", i.tooltip || "").addClass(Object(Bt.d)(i)),
            this.updateElementWidth(),
            this.el.appendTo(t.el),
            "left" === i.labelPosition && this.el.addClass("label-left"),
            this.label = $("<label>").text(this.field.caption || locale.unnamed).css("display", "placeholder" === i.labelPosition || "none" === i.labelPosition ? "none" : "").appendTo(this.el),
            this.removeButton = $('<div class="button icon-big i-32-24 i-grey i-setting-menu">').appendTo($('<div style="position:relative;height:0;text-align:right;z-index:1">').appendTo(this.el)).touch($.proxy(this.popupMenu, this));
            var o = this.el.width();
            this.content = $('<div class="editor-file-file" style="text-align:center;display:table-cell;vertical-align:middle;width:' + o + "px;max-width:" + o + 'px">').css({
                height: 68 * i.height + 32,
                "background-size": i.bgSize || ""
            }).appendTo(this.el).on("contextmenu", $.proxy(this.popupMenu, this)).touch($.proxy(this.fileClicked, this)),
            "signature" !== i.fileHandling && this.registerDropListeners()
        }
        function ii(e) {
            var t = this;
            this.id = "files",
            this.loading = !1,
            this.container = e,
            this.popupMenu = $.proxy(this.popupMenu, this),
            this.selectedIconClass = "tab-icon-container i-18 i-white i-attachment",
            this.unselectedIconClass = "tab-icon-container i-18 i-light-grey i-attachment",
            this.elTab = $('<div class="tab tab-icon">').attr("title", locale.files).append($(`<div class="${this.unselectedIconClass}"></div>`)).touch($.proxy((function() {
                t.container.selectTab(t.id)
            }), this)),
            this.tabSelectedIndicator = $('<div class="tab-selected-indicator">'),
            this.el = $('<div class="files">').hide().appendTo(e.containerEl || e.el),
            this.el[0].addEventListener("dragover", (function(e) {
                return t.el[0].style.backgroundColor = "#ddd", e.preventDefault(), !1
            }), !1),
            this.el[0].addEventListener("dragleave", (function(e) {
                return t.el[0].style.backgroundColor = "", e.preventDefault(), !1
            }), !1),
            this.el[0].addEventListener("drop", (function(e) {
                t.el[0].style.backgroundColor = "";
                var i = t.nid;
                database.typeOf(i);
                if (!t.isWritable())
                    return e.preventDefault(), $.alert(locale.errorNotAuthorized), !1;
                var o = e.target.files || e.dataTransfer && e.dataTransfer.files;
                return o && o.length && setTimeout((function e(i) {
                    if (i >= o.length)
                        return void t.updateUI();
                    var n = o[i];
                    t.importFile(n, (function(t) {
                        setTimeout(e, 0, i + 1)
                    }))
                }), 0, 0), e.preventDefault(), !1
            }), !1),
            this.filesEl = $("<div>").appendTo(this.el)
        }
        function oi(e, t, i) {
            this.container = e,
            this.field = i,
            this.visible = !0,
            this.el = $('<div class="component head">').data("component", this).attr("title", i.tooltip || ""),
            this.updateElementWidth(),
            this.el.appendTo(t.el),
            this.label = $("<label>").text(i.caption).appendTo(this.el),
            this.updateStyle()
        }
        function ni(e) {
            const t = this;
            this.id = "history",
            this.container = e,
            this.selectedIconClass = "tab-icon-container i-18 i-white i-info",
            this.unselectedIconClass = "tab-icon-container i-18 i-light-grey i-info",
            this.elTab = $('<div class="tab tab-icon">').attr("title", locale.history).append($(`<div class="${this.unselectedIconClass}"></div>`)).touch($.proxy((function() {
                t.container.selectTab(t.id)
            }), this)),
            this.tabSelectedIndicator = $('<div class="tab-selected-indicator">'),
            this.el = $('<div class="history">').hide().appendTo(e.containerEl || e.el);
            $('<div class="editor">').appendTo(this.el);
            this.historyDiv = $('<div class="history">').appendTo(this.el)
        }
        Kt.prototype.draw = function(e) {
            var t = this.path;
            e.beginPath();
            for (var i = 0; i < t.length; i++) {
                var o = t[i];
                switch (o[0]) {
                case "M":
                    e.moveTo(o[1], o[2]);
                    break;
                case "L":
                    e.lineTo(o[1], o[2])
                }
            }
            this.fillStyle && (e.closePath(), e.fillStyle = this.fillStyle, e.fill()),
            this.strokeStyle && (e.strokeStyle = this.strokeStyle, e.lineWidth = this.lineWidth, e.stroke())
        },
        Kt.prototype.moveTo = function(e, t) {
            this.path.push(["M", e, t]),
            this.updateBounds()
        },
        Kt.prototype.lineTo = function(e, t) {
            this.path.push(["L", e, t]),
            this.updateBounds()
        },
        Kt.prototype.isEmpty = function() {
            return this.path.length < 2
        },
        Kt.prototype.updateBounds = function() {
            var e = this.path;
            if (e.length) {
                for (var t = 1 / 0, i = -1 / 0, o = 1 / 0, n = -1 / 0, s = 0; s < e.length; s++) {
                    var a = e[s],
                        r = a[1],
                        l = a[2];
                    r < t && (t = r),
                    r > i && (i = r),
                    l < o && (o = l),
                    l > n && (n = l)
                }
                this.x0 = t,
                this.x1 = i,
                this.y0 = o,
                this.y1 = n
            }
        },
        Qt.prototype.draw = function(e) {
            e.beginPath(),
            e.moveTo(this.x0, this.y0),
            e.lineTo(this.x1, this.y0),
            e.lineTo(this.x1, this.y1),
            e.lineTo(this.x0, this.y1),
            e.closePath(),
            this.fillStyle && (e.fillStyle = this.fillStyle, e.fill()),
            this.strokeStyle && (e.strokeStyle = this.strokeStyle, e.lineWidth = this.lineWidth, e.stroke())
        },
        Qt.prototype.isEmpty = function() {
            return Math.abs(this.x0 - this.x1) < 2 && Math.abs(this.y0 - this.y1) < 2
        },
        Qt.prototype.updateBounds = function() {},
        Zt.prototype.draw = function(e) {
            var t,
                i,
                o,
                n,
                s,
                a,
                r,
                l,
                c,
                d,
                h;
            t = e,
            i = this.x0,
            o = this.y0,
            n = this.x1 - this.x0,
            s = this.y1 - this.y0,
            a = n / 2 * .5522848,
            r = s / 2 * .5522848,
            l = i + n,
            c = o + s,
            d = i + n / 2,
            h = o + s / 2,
            t.beginPath(),
            t.moveTo(i, h),
            t.bezierCurveTo(i, h - r, d - a, o, d, o),
            t.bezierCurveTo(d + a, o, l, h - r, l, h),
            t.bezierCurveTo(l, h + r, d + a, c, d, c),
            t.bezierCurveTo(d - a, c, i, h + r, i, h),
            this.fillStyle && (e.fillStyle = this.fillStyle, e.fill()),
            this.strokeStyle && (e.strokeStyle = this.strokeStyle, e.lineWidth = this.lineWidth, e.stroke())
        },
        Zt.prototype.isEmpty = function() {
            return Math.abs(this.x0 - this.x1) < 2 && Math.abs(this.y0 - this.y1) < 2
        },
        Zt.prototype.updateBounds = function() {},
        Object.assign(ti.prototype, Ot.a.prototype),
        ti.prototype.destroy = function() {
            this.el.remove()
        },
        ti.prototype.setWidth = function(e, t) {
            Ot.a.prototype.setWidth.call(this, e, t);
            var i = this.el.width();
            this.content.css({
                width: i,
                "max-width": i
            })
        },
        ti.prototype.resize = function() {
            var e = this.field,
                t = this.el.width();
            this.content.css({
                width: t,
                "max-width": t,
                height: 68 * e.height + 32
            })
        },
        ti.prototype.updateStructure = function() {
            var e = this.field;
            this.el.attr("title", e.tooltip || ""),
            this.updateElementWidth();
            var t = this.el.width();
            this.content.css({
                width: t,
                "max-width": t,
                height: 68 * e.height + 32,
                "background-size": e.bgSize || ""
            }),
            this.label.text(e.caption || locale.unnamed).css("display", "placeholder" === e.labelPosition || "none" === e.labelPosition ? "none" : ""),
            this.el.toggleClass("label-left", "left" === e.labelPosition)
        },
        ti.prototype.validate = function(e) {
            var t = this.field.validate(e);
            return t ? (this.setError(t), !1) : (this.setError(void 0), !0)
        },
        ti.prototype.setError = function(e) {
            e ? (this.error || (this.error = $('<div class="editor-error">').appendTo(this.el)), this.error.html('<div class="editor-error-text"><div class="editor-error-icon i-red i-16-12 i-warning"></div>' + htmlEscape(e) + "</div>"), this.el.addClass("error")) : (this.error && this.error.remove(), this.error = void 0, this.el.removeClass("error"))
        },
        ti.prototype.bind = function() {
            this.nodeChanged()
        },
        ti.prototype.nodeChanged = function() {
            this.updateIsWritable(),
            this.updateVisibility();
            var e = this.container.nid;
            if (e) {
                var t = database.loadNodeSync(e);
                if (t) {
                    var i = t[this.field.id],
                        o = e + "/" + i;
                    if (o !== this.currentFile)
                        if (this.currentFile = o, i) {
                            if (util.RE_IMAGE_FILE_EXT.test(i)) {
                                var n = database.thumb2URL2(e, i);
                                this.content[0].style.backgroundImage = n ? 'url("' + n + '")' : "",
                                this.content[0].innerHTML = ""
                            } else
                                this.content[0].style.backgroundImage = "",
                                this.content[0].innerHTML = '<div class="file-type">' + htmlEscape(i) + "</div>";
                            this.removeButton.css("display", "")
                        } else
                            this.content[0].style.backgroundImage = "",
                            this.content[0].innerHTML = "",
                            this.removeButton.css("display", "none");
                    this.validate(i)
                } else
                    this.setError()
            } else
                this.setError()
        },
        ti.prototype.fileClicked = function(e) {
            var t = "",
                i = "",
                o = this.field;
            o && (i = this.field.id);
            var s = this.container.nid;
            if (s) {
                var r = database.loadNodeSync(s);
                if (r) {
                    var l,
                        c = r[this.field.id],
                        d = r[i];
                    if (d && (t = database.downloadURL(s, d)), c)
                        if ("sketch" === o.fileHandling)
                            this.isWritable() ? this.openPaint() : database.previewFile(s, c);
                        else if (/\.(png|jpg|jpeg|gif)$/i.test(d) || (/\.(png|jpg|jpeg|gif)$/i.test(d), 0)) {
                            var h = $("<div>").appendTo(document.body);
                            n.render(a.createElement(Yt.a, {
                                images: [{
                                    file: t,
                                    name: d
                                }],
                                initialImageIndex: 0,
                                closeLightBox: () => {
                                    n.unmountComponentAtNode(h[0]),
                                    h.remove()
                                },
                                downloadUrl: p
                            }), h[0])
                        } else
                            /\.(pdf)$/i.test(d) ? (l = $.backplane({
                                cls: "nx-backplane-lightbox",
                                beforeClose: () => n.unmountComponentAtNode(l[0])
                            }), n.render(a.createElement(Xt.a, {
                                pdfUrl: t,
                                fileName: d,
                                onDownloadClick: p,
                                onCloseClick: () => l.close()
                            }), l[0])) : p();
                    else {
                        if (!this.isWritable())
                            return;
                        "sketch" === o.fileHandling ? this.openPaint() : "signature" === o.fileHandling ? this.createSignature() : this.chooseFileSystem()
                    }
                }
            }
            function p() {
                database.previewFile(s, c)
            }
        },
        ti.prototype.chooseFileMenu = function(e) {
            var t = this,
                i = $(e.target),
                o = $.backplane({}),
                n = $('<div class="nx-menu-popup">').appendTo(o);
            $('<div class="nx-menu-item">').append($('<div class="nx-menu-label">').text(locale.takePhoto)).appendTo(n).touch((function() {
                o.close(),
                t.takePhoto(e)
            })),
            $('<div class="nx-menu-item">').append($('<div class="nx-menu-label">').text(locale.photoLibrary)).appendTo(n).touch((function() {
                o.close(),
                t.choosePhotoFromLibrary(e)
            })),
            $('<div class="nx-menu-item">').append($('<div class="nx-menu-label">').text(locale.icloudDrive)).appendTo(n).touch((function() {
                o.close(),
                t.chooseICloud()
            })),
            $('<div class="nx-menu-item">').append($('<div class="nx-menu-label">').text(locale.dropbox)).appendTo(n).touch((function() {
                o.close(),
                t.chooseDropbox()
            }));
            var s = n.outerWidth(),
                a = n.outerHeight(),
                r = i.offset();
            r.left += i.width() - 32,
            r.top += 32,
            r.left + s > window.getWidth() && (r.left = window.getWidth() - s),
            r.top + a > window.getHeight() && (r.top = window.getHeight() - a),
            n.offset(r)
        },
        ti.prototype.takePhoto = function(e) {
            var t = this;
            NinoxDocumentInteraction.choosePhotoFromCamera((function(i, o, n) {
                if (i)
                    return $.alert(i);
                o ? t.photoTaken(e) : n && t.videoTaken(n)
            }))
        },
        ti.prototype.choosePhotoFromLibrary = function(e) {
            var t = this;
            NinoxDocumentInteraction.choosePhotoFromLibrary((function(i, o, n) {
                if (i)
                    return $.alert(i);
                o ? t.photoTaken(e) : n && t.videoTaken(n)
            }))
        },
        ti.prototype.photoTaken = function(e) {
            var t,
                i = this,
                o = $(e.target);
            switch (this.field.fileHandling) {
            case "image-s":
                return l("S");
            case "image-m":
                return l("M");
            case "image-l":
                return l("L");
            case "image-o":
                return l("O")
            }
            t = $.backplane({});
            var n = $('<div class="nx-menu-popup">').appendTo(t);
            $('<div class="nx-menu-head">').text(locale.imageSize).appendTo(n),
            $('<div class="nx-menu-item">').append($('<div class="nx-menu-label">').text(locale.imageSizeSmall)).appendTo(n).touch((function() {
                l("S")
            })),
            $('<div class="nx-menu-item">').append($('<div class="nx-menu-label">').text(locale.imageSizeMedium)).appendTo(n).touch((function() {
                l("M")
            })),
            $('<div class="nx-menu-item">').append($('<div class="nx-menu-label">').text(locale.imageSizeLarge)).appendTo(n).touch((function() {
                l("L")
            })),
            $('<div class="nx-menu-item">').append($('<div class="nx-menu-label">').text(locale.imageSizeOriginal)).appendTo(n).touch((function() {
                l("O")
            }));
            var s = n.outerWidth(),
                a = n.outerHeight(),
                r = o.offset();
            function l(e) {
                t && t.close(),
                i.savePhoto(e)
            }
            r.left += o.width() - 32,
            r.top += 32,
            r.left + s > window.getWidth() && (r.left = window.getWidth() - s),
            r.top + a > window.getHeight() && (r.top = window.getHeight() - a),
            n.offset(r)
        },
        ti.prototype.videoTaken = function(e) {
            var t = this;
            if (!t.isWritable())
                return $.alert(locale.errorNotAuthorized);
            var i = this.container.nid,
                o = this.field.id;
            $.loading(!0),
            database.importFile(i, e, (function(e, n) {
                e ? ($.loading(!1), $.alert(e)) : (t.currentFile = void 0, database.update(i, o, n, (function(e) {
                    $.loading(!1),
                    e && $.alert(e)
                })))
            }))
        },
        ti.prototype.savePhoto = function(e) {
            var t = this;
            if (!t.isWritable())
                return $.alert(locale.errorNotAuthorized);
            var i = this.container.nid,
                o = this.field.id;
            $.loading(!0),
            NinoxDocumentInteraction.convertChoosenPhoto(e, (function(e, n) {
                if (e)
                    return $.loading(!1), $.alert(e);
                Object(c.h)(i, locale.photo + " " + util.formatISODateTimeFileName(new Date), (function(e, s) {
                    var a = s += ".jpg";
                    database.importData(n, i, a, (function(e) {
                        if (e)
                            return $.loading(!1), $.alert(e);
                        t.currentFile = void 0,
                        database.update(i, o, a, (function(e) {
                            $.loading(!1),
                            e && $.alert(e)
                        }))
                    }))
                }))
            }))
        },
        ti.prototype.chooseICloud = function() {
            NinoxDocumentInteraction.chooseFileFromICloud($.proxy(this.urlChoosen, this))
        },
        ti.prototype.chooseFromDevice = function() {
            this.isWritable() && ($.loading(!0), setTimeout(() => {
                NinoxDocumentInteraction.chooseFileFromDevice((e, t) => {
                    $.loading(!1),
                    this.urlChoosen(e, t)
                })
            }, 0))
        },
        ti.prototype.chooseDropbox = function() {
            var e = this;
            $.loading(!0),
            setTimeout((function() {
                NinoxDocumentInteraction.chooseFile((function(t, i) {
                    $.loading(!1),
                    e.urlChoosen(t, i)
                }))
            }), 0)
        },
        ti.prototype.chooseFileSystem = function() {
            NinoxDocumentInteraction.chooseFile($.proxy(this.urlChoosen, this))
        },
        ti.prototype.urlChoosen = function(e, t) {
            if (!this.isWritable())
                return $.alert(locale.errorNotAuthorized);
            this.container.nid,
            this.field.id;
            if (e)
                return $.alert(e);
            t && ($.loading(!0), this.importFile(t, (function(e, t) {
                $.loading(!1),
                e && $.alert(e)
            })))
        },
        ti.prototype.importFile = function(e, t) {
            var i = this;
            if (!i.isWritable())
                return $.alert(locale.errorNotAuthorized);
            var o = this.container.nid,
                n = this.field.id;
            !function(t) {
                if ("object" != typeof e)
                    return t();
                var i = /^(.*)\.([a-z0-9]+)/i.exec(e.name);
                if (!i)
                    return t();
                var n = i[1],
                    s = i[2];
                Object(c.h)(o, n, (function(i, o) {
                    e.renameTo = o + "." + s,
                    t()
                }))
            }((function() {
                database.importFile(o, e, (function(e, s) {
                    if (e)
                        return t(e);
                    i.currentFile = void 0,
                    database.update(o, n, s, (function(e) {
                        t(e)
                    }))
                }))
            }))
        },
        ti.prototype.removeFile = function() {
            var e = this;
            if (!e.isWritable())
                return $.alert(locale.errorNotAuthorized);
            var t = this.container.nid;
            if (t) {
                var i = database.loadNodeSync(t);
                if (i) {
                    var o = i[this.field.id];
                    o && $.dialog({
                        closable: !0,
                        caption: locale.removeFile,
                        message: locale.confirmRemoveFile,
                        buttons: [{
                            color: "red",
                            caption: locale.removeFile,
                            callback: function() {
                                database.removeFile(t, o, (function(i) {
                                    i && $.alert(i),
                                    e.currentFile = void 0,
                                    database.update(t, e.field.id, null, (function(e) {
                                        if (e)
                                            return $.alert(e)
                                    }))
                                }))
                            }
                        }]
                    })
                }
            }
        },
        ti.prototype.popupMenu = function(e) {
            var t = this,
                i = this.field,
                o = i.id,
                n = this.container.nid;
            if (n) {
                var s = database.loadNodeSync(n);
                if (s) {
                    var a = s[o];
                    if (a) {
                        var r = $(e.target),
                            l = $.backplane({}),
                            c = $('<div class="nx-menu-popup">').appendTo(l);
                        "signature" !== i.fileHandling && $('<div class="nx-menu-head file-name">').text(a).appendTo(c),
                        "signature" !== i.fileHandling && database.authorizationExport && database.supports.sharing && $('<div class="nx-menu-item">').append($('<div class="nx-menu-label">').text(locale.shareFile + "...")).appendTo(c).touch((function() {
                            l.close(),
                            t.shareFile()
                        })),
                        t.isWritable() && ("signature" !== i.fileHandling && $('<div class="nx-menu-item">').append($('<div class="nx-menu-label">').text(locale.rename)).appendTo(c).touch((function() {
                            l.close(),
                            t.renameFile()
                        })), $('<div class="nx-menu-item">').append($('<div class="nx-menu-label">').text(locale.remove)).appendTo(c).touch((function() {
                            l.close(),
                            t.removeFile()
                        })));
                        var d,
                            h = c.outerWidth(),
                            p = c.outerHeight();
                        return (d = r.is(".i-setting-menu") ? r.offset() : {
                            left: e.clientX,
                            top: e.clientY
                        }).left + h > window.getWidth() && (d.left = window.getWidth() - h), d.top + p > window.getHeight() && (d.top = window.getHeight() - p), c.offset(d), !1
                    }
                }
            }
        },
        ti.prototype.shareFile = function() {
            var e = this.field.id,
                t = this.container.nid;
            if (t) {
                var i = database.loadNodeSync(t);
                if (i) {
                    var o = i[e];
                    o && database.loadSharedFile(t, o, (function(e, i) {
                        if (e)
                            return $.alert(e);
                        var n = $.popdown({
                                head: locale.shareFile,
                                buttons: [{
                                    caption: locale.share,
                                    cls: "grey",
                                    click: function() {
                                        i.url ? database.unshareFile(t, o, (function(e) {
                                            if (e)
                                                return $.alert(e);
                                            i = {},
                                            a()
                                        })) : database.shareFile(t, o, (function(e, t) {
                                            if (e)
                                                return $.alert(e);
                                            i = t,
                                            a()
                                        }))
                                    }
                                }, "-", {
                                    caption: locale.close,
                                    cls: "blue",
                                    click: function() {
                                        n.close()
                                    }
                                }]
                            }),
                            s = $.field({
                                val: i.url,
                                $container: n.$content,
                                touch: function() {
                                    window.open(i.url)
                                }
                            });
                        function a() {
                            s.val(i.url || ""),
                            s.$el.css("display", i.url ? "" : "none"),
                            i.url ? $(n.$buttons.children()[0]).removeClass("grey").addClass("red").text("Unshare") : $(n.$buttons.children()[0]).removeClass("red").addClass("blue").text(locale.share)
                        }
                        a()
                    }))
                }
            }
        },
        ti.prototype.renameFile = function() {
            var e = this;
            if (!e.isWritable())
                return $.alert(locale.errorNotAuthorized);
            var t = this.field.id,
                i = this.container.nid;
            if (i) {
                var o = database.loadNodeSync(i);
                if (o) {
                    var n = o[t];
                    if (n) {
                        var s = $.popdown({
                                head: locale.rename,
                                buttons: ["-", "cancel", " ", {
                                    cls: "blue",
                                    caption: locale.rename,
                                    click: l
                                }]
                            }),
                            a = $('<div class="component editor editor-string" style="width:100%">').appendTo(s.$content);
                        $("<label>").text(locale.name).appendTo(a);
                        var r = $('<input type="text">').val(n).appendTo($('<div class="stringeditor">').appendTo(a)).keydown((function(e) {
                            13 === e.which && l(),
                            27 === e.which && s.close()
                        }))
                    }
                }
            }
            function l() {
                var o = r.val();
                return n === o ? s.close() : util.isValidFileName(o) ? ($.loading(!0), void setTimeout((function() {
                    database.renameFile(i, n, o, (function(n) {
                        if (n)
                            return $.loading(!1), $.alert(locale.couldntRenameFile);
                        e.currentFile = void 0,
                        database.update(i, t, o, (function(e) {
                            $.loading(!1),
                            e && $.alert(e),
                            s.close()
                        }))
                    }))
                }), 0)) : $.alert(locale.invalidFileName)
            }
        },
        ti.prototype.saveFileICloud = function() {
            var e = this.field.id,
                t = this.container.nid;
            if (t) {
                var i = database.loadNodeSync(t);
                if (i) {
                    var o = i[e];
                    if (o) {
                        var n = database.downloadURL(t, o);
                        NinoxDocumentInteraction.saveFileOnICloud(n, (function(e) {
                            e && $.alert(e)
                        }))
                    }
                }
            }
        },
        ti.prototype.saveFileFileSystem = function(e) {
            var t = this.field.id,
                i = this.container.nid;
            if (i) {
                var o = database.loadNodeSync(i);
                if (o) {
                    var n = o[t];
                    if (n) {
                        var s = database.downloadURL(i, n);
                        NinoxDocumentInteraction.saveFile(n, "", (function(e, t) {
                            if (e)
                                return $.alert(e);
                            t && localFileSystem.copyURL(s, t).catch(e => $.alert(e))
                        }))
                    }
                }
            }
        },
        ti.prototype.openFileIn = function(e) {
            var t = this.field.id,
                i = this.container.nid;
            if (i) {
                var o = database.loadNodeSync(i);
                if (o) {
                    var n = o[t];
                    if (n) {
                        var s = database.downloadURL(i, n);
                        NinoxDocumentInteraction.showFileOptions(s, e.clientX, e.clientY, (function() {}))
                    }
                }
            }
        },
        ti.prototype.isHeightAdjustable = function() {
            return !0
        },
        ti.prototype.setHeight = function(e) {
            var t = this.field,
                i = t.height,
                o = Math.max(1, Math.round((e - 32) / 68));
            o !== i && (this.content.css({
                height: 68 * o + 32
            }), t.height = o)
        },
        ti.prototype.registerDropListeners = function() {
            var e = this;
            e.content[0].addEventListener("dragover", (function(t) {
                return e.content[0].style.backgroundColor = "#ddd", t.preventDefault(), !1
            }), !1),
            e.content[0].addEventListener("dragleave", (function(t) {
                return e.content[0].style.backgroundColor = "", t.preventDefault(), !1
            }), !1),
            e.content[0].addEventListener("drop", (function(t) {
                if (e.content[0].style.backgroundColor = "", !e.isWritable())
                    return t.preventDefault(), $.alert(locale.errorNotAuthorized), !1;
                var i = t.target.files || t.dataTransfer && t.dataTransfer.files;
                if (i && 1 === i.length) {
                    var o = i[0],
                        n = e.container.nid,
                        s = e.field.id,
                        a = database.loadNodeSync(n);
                    if (a) {
                        var r = a[s];
                        return e.currentFile = void 0, $.loading(!0), r ? database.removeFile(n, r, (function(e) {
                            if (e)
                                return $.loading(!1), $.alert(e);
                            l()
                        })) : l(), t.preventDefault(), !1
                    }
                }
                function l() {
                    e.importFile(o, (function(e) {
                        $.loading(!1),
                        e && $.alert(e)
                    }))
                }
            }), !1)
        },
        ti.prototype.createSignature = function() {
            var e = this,
                t = e.container.nid;
            if (t && database.loadNodeSync(t)) {
                var i = this.field.id;
                new ei({
                    okay: function(o) {
                        $.loading(!0),
                        Object(c.h)(t, locale.signature, (function(n, s) {
                            s += ".png",
                            database.saveFileDataURL(t, o, s, (function(o) {
                                if (o)
                                    return $.loading(!1), $.alert(o);
                                e.currentFile = void 0,
                                database.update(t, i, s, (function(e) {
                                    $.loading(!1),
                                    e && $.alert(e)
                                }))
                            }))
                        }))
                    }
                })
            }
        },
        ti.prototype.openPaint = function() {
            var e = this,
                t = this.field,
                i = this.container.nid;
            if (i) {
                var o = database.loadNodeSync(i);
                if (o) {
                    var n = void 0,
                        s = o[t.id];
                    if (s) {
                        var a = database.fileURL2(i, s);
                        (n = new Image).crossOrigin = "anonymous",
                        n.addEventListener("load", (function() {
                            r()
                        }), !1),
                        n.src = a
                    } else
                        r()
                }
            }
            function r() {
                new Jt({
                    img: n,
                    save: function(n) {
                        $.loading(!0),
                        function(e, n) {
                            s ? function(e, t) {
                                database.saveFileDataURL(i, e, s, t)
                            }(e, n) : function(e, n) {
                                database.loadFiles(i, (function(s, a) {
                                    if (s)
                                        return n(s);
                                    var r = {};
                                    a && T.each(a, (function(e) {
                                        r[e.name] = !0
                                    }));
                                    for (var l = 1, c = locale.drawing + " " + l + ".png"; r[c];)
                                        l++,
                                        c = locale.drawing + " " + l + ".png";
                                    database.saveFileDataURL(i, e, c, (function(e) {
                                        if (e)
                                            return n(e);
                                        database.update(o._id, t.id, c, n)
                                    }))
                                }))
                            }(e, n)
                        }(n, (function(t) {
                            $.loading(!1),
                            t && $.alert(t),
                            e.currentFile = void 0,
                            e.nodeChanged()
                        }))
                    }
                })
            }
        },
        ii.prototype.isWritable = function() {
            var e = this.nid;
            return !!e && (!!database.typeOf(e) && this.container.isWritable())
        },
        ii.prototype.register = function() {},
        ii.prototype.unregister = function() {},
        ii.prototype.bind = function(e) {
            this.unregister(),
            this.nid = e ? e._id : void 0,
            this.register(),
            this.updateUI()
        },
        ii.prototype.destroy = function() {
            this.unregister(),
            this.el.remove(),
            this.elTab.remove()
        },
        ii.prototype.hide = function(e) {
            this.container.currentTab === this && (this.container.currentTab = void 0, this.el.hide(), this.tabSelectedIndicator.detach(), this.elTab.removeClass("selected"), this.elTab[0].firstElementChild.className = this.unselectedIconClass, e && e())
        },
        ii.prototype.show = function() {
            this.container.currentTab !== this && (this.container.currentTab && this.container.currentTab.hide(), this.container.currentTab = this, this.el.show(), this.elTab.addClass("selected"), this.elTab[0].firstElementChild.className = this.selectedIconClass, this.tabSelectedIndicator.appendTo(this.elTab), this.updateUI())
        },
        ii.prototype.focus = function() {},
        ii.prototype.chooseFileClicked = function(e) {
            this.isWritable() && this.chooseFileSystem()
        },
        ii.prototype.chooseFileMenu = function(e) {
            var t = this;
            if (this.isWritable()) {
                var i = $(e.target),
                    o = $.backplane({}),
                    n = $('<div class="nx-menu-popup">').appendTo(o);
                $('<div class="nx-menu-item">').append($('<div class="nx-menu-label">').text(locale.takePhoto)).appendTo(n).touch((function() {
                    o.close(),
                    t.takePhoto(e)
                })),
                $('<div class="nx-menu-item">').append($('<div class="nx-menu-label">').text(locale.photoLibrary)).appendTo(n).touch((function() {
                    o.close(),
                    t.choosePhotoFromLibrary(e)
                })),
                $('<div class="nx-menu-item">').append($('<div class="nx-menu-label">').text(locale.icloudDrive)).appendTo(n).touch((function() {
                    o.close(),
                    t.chooseICloud()
                })),
                $('<div class="nx-menu-item">').append($('<div class="nx-menu-label">').text(locale.dropbox)).appendTo(n).touch((function() {
                    o.close(),
                    t.chooseDropbox()
                }));
                var s = n.outerWidth(),
                    a = n.outerHeight(),
                    r = i.offset();
                r.left += i.width() - 32,
                r.top += 32,
                r.left + s > window.getWidth() && (r.left = window.getWidth() - s),
                r.top + a > window.getHeight() && (r.top = window.getHeight() - a),
                n.offset(r)
            }
        },
        ii.prototype.takePhoto = function(e) {
            var t = this;
            NinoxDocumentInteraction.choosePhotoFromCamera((function(i, o, n) {
                if (i)
                    return $.alert(i);
                o ? t.photoTaken(e) : n && t.videoTaken(n)
            }))
        },
        ii.prototype.choosePhotoFromLibrary = function(e) {
            var t = this;
            NinoxDocumentInteraction.choosePhotoFromLibrary((function(i, o, n) {
                if (i)
                    return $.alert(i);
                o ? t.photoTaken(e) : n && t.videoTaken(n)
            }))
        },
        ii.prototype.photoTaken = function(e) {
            var t = this,
                i = $(e.target),
                o = $.backplane({}),
                n = $('<div class="nx-menu-popup">').appendTo(o);
            $('<div class="nx-menu-head">').text(locale.imageSize).appendTo(n),
            $('<div class="nx-menu-item">').append($('<div class="nx-menu-label">').text(locale.imageSizeSmall)).appendTo(n).touch((function() {
                l("S")
            })),
            $('<div class="nx-menu-item">').append($('<div class="nx-menu-label">').text(locale.imageSizeMedium)).appendTo(n).touch((function() {
                l("M")
            })),
            $('<div class="nx-menu-item">').append($('<div class="nx-menu-label">').text(locale.imageSizeLarge)).appendTo(n).touch((function() {
                l("L")
            })),
            $('<div class="nx-menu-item">').append($('<div class="nx-menu-label">').text(locale.imageSizeOriginal)).appendTo(n).touch((function() {
                l("O")
            }));
            var s = n.outerWidth(),
                a = n.outerHeight(),
                r = i.offset();
            function l(e) {
                o.close(),
                t.savePhoto(e)
            }
            r.left += i.width() - 32,
            r.top += 32,
            r.left + s > window.getWidth() && (r.left = window.getWidth() - s),
            r.top + a > window.getHeight() && (r.top = window.getHeight() - a),
            n.offset(r)
        },
        ii.prototype.videoTaken = function(e) {
            var t = this,
                i = this.nid;
            $.loading(!0),
            database.importFile(i, e, (function(e, i) {
                $.loading(!1),
                e && $.alert(e),
                t.updateUI()
            }))
        },
        ii.prototype.savePhoto = function(e) {
            if (!this.isWritable())
                return $.alert(locale.errorNotAuthorized);
            var t = this,
                i = this.nid;
            $.loading(!0),
            NinoxDocumentInteraction.convertChoosenPhoto(e, (function(e, o) {
                if (e)
                    return $.loading(!1), $.alert(e);
                Object(c.h)(i, locale.photo + " " + util.formatISODateTimeFileName(new Date), (function(e, n) {
                    var s = n += ".jpg";
                    database.importData(o, i, s, (function(e) {
                        $.loading(!1),
                        e && $.alert(e),
                        t.updateUI()
                    }))
                }))
            }))
        },
        ii.prototype.chooseFromDevice = function() {
            this.isWritable() && ($.loading(!0), setTimeout(() => {
                NinoxDocumentInteraction.chooseFileFromDevice((e, t) => {
                    $.loading(!1),
                    this.urlChoosen(e, t)
                })
            }, 0))
        },
        ii.prototype.chooseICloud = function() {
            this.isWritable() && NinoxDocumentInteraction.chooseFileFromICloud($.proxy(this.urlChoosen, this))
        },
        ii.prototype.chooseDropbox = function() {
            if (this.isWritable()) {
                var e = this;
                $.loading(!0),
                setTimeout((function() {
                    NinoxDocumentInteraction.chooseFile((function(t, i) {
                        $.loading(!1),
                        e.urlChoosen(t, i)
                    }))
                }), 0)
            }
        },
        ii.prototype.chooseFileSystem = function() {
            this.isWritable() && NinoxDocumentInteraction.chooseFile($.proxy(this.urlChoosen, this))
        },
        ii.prototype.urlChoosen = function(e, t) {
            if (!this.isWritable())
                return $.alert(locale.errorNotAuthorized);
            var i = this;
            this.nid;
            if (e)
                return $.alert(e);
            t && ($.loading(!0), i.importFile(t, (function(e) {
                $.loading(!1),
                e && $.alert(e),
                i.updateUI()
            })))
        },
        ii.prototype.importFile = function(e, t) {
            if (!this.isWritable())
                return $.alert(locale.errorNotAuthorized);
            var i = this.nid;
            !function(t) {
                if ("object" != typeof e)
                    return t();
                var o = /^(.*)\.([a-z0-9]+)/i.exec(e.name);
                if (!o)
                    return t();
                var n = o[1],
                    s = o[2];
                Object(c.h)(i, n, (function(i, o) {
                    e.renameTo = o + "." + s,
                    t()
                }))
            }((function() {
                database.importFile(i, e, (function(e, i) {
                    t(e)
                }))
            }))
        },
        ii.prototype.updateUI = async function() {
            var e = this,
                t = this.nid;
            database.countFiles && await database.countFiles(t) ? this.elTab.addClass("has-content") : this.elTab.removeClass("has-content"),
            this.container.currentTab === this && (this.loading || (this.filesEl.empty(), t && function i() {
                e.loading = !0,
                database.loadFiles(t, (function(o, n) {
                    if (t !== e.nid)
                        t = e.nid,
                        setTimeout(i, 200);
                    else {
                        if (e.loading = !1, o)
                            return $.alert(o);
                        var s = database.typeOf(t);
                        if (!s)
                            return;
                        var a = database.loadNodeSync(t);
                        if (!a)
                            return;
                        var r = {},
                            l = s.fields;
                        for (var c in l) {
                            if (l.hasOwnProperty(c))
                                if ("file" === l[c].base) {
                                    var d = a[c];
                                    d && (r[d] = !0)
                                }
                        }
                        let i = [],
                            p = [];
                        for (var h = 0; h < n.length; h++)
                            r[(d = n[h]).name] || (i.push(d), /\.(png|jpg|jpeg|gif)$/i.test(d.name) && p.push(d));
                        e.renderFile(i, p),
                        e.renderFileAddButton()
                    }
                }))
            }()))
        },
        ii.prototype.renderFileAddButton = function() {
            $('<div class="file-add"><div class="icon i-40-24 i-light-grey i-setting-add-file"></div><div class="label">' + htmlEscape(locale.chooseFile) + "</div></div>").appendTo(this.filesEl).click($.proxy(this.chooseFileClicked, this))
        },
        ii.prototype.renderFile = function(e, t) {
            for (var i = this, o = 0; o < e.length; o++) {
                s(e[o])
            }
            function s(e) {
                var o,
                    s,
                    r = i.container.nid,
                    l = e.name,
                    c = $('<div class="file">').data("file", e).appendTo(i.filesEl).on("contextmenu", i.popupMenu).touch((function() {
                        if (/\.(png|jpg|jpeg|gif)$/i.test(e.name) || (/\.(png|jpg|jpeg|gif)$/i.test(e.name), 0))
                            i.showGallery(e, t);
                        else if (/\.(pdf)$/i.test(e.name)) {
                            var o = $.backplane({
                                cls: "nx-backplane-lightbox",
                                beforeClose: () => n.unmountComponentAtNode(o[0])
                            });
                            n.render(a.createElement(Xt.a, {
                                pdfUrl: database.downloadURL(r, e.name),
                                fileName: e.name,
                                onDownloadClick: () => database.previewFile(r, e.name),
                                onCloseClick: () => o.close()
                            }), o[0])
                        } else
                            database.previewFile(r, l)
                    })),
                    d = $('<div class="file-image">').appendTo(c);
                if ($('<div class="file-label">').text(e.name).appendTo(c), $('<div class="button icon-big i-32-24 i-grey i-setting-menu">').appendTo(c).click(i.popupMenu), util.RE_IMAGE_FILE_EXT.test(l)) {
                    var h = database.thumb2URL2(r, l);
                    o = $('<img style="position:relative">').appendTo(d),
                    (s = new Image).src = h,
                    s.complete ? f() : s.onload = f
                } else {
                    var p = /\.(\w+)$/.exec(l),
                        u = p ? p[1] : "?";
                    d.html('<div class="file-type">' + htmlEscape(u) + "</div>")
                }
                function f() {
                    var e,
                        t,
                        i,
                        n = s.naturalWidth,
                        a = s.naturalHeight,
                        r = 150 / n,
                        l = 150 / a;
                    r < l ? (e = 150, i = (150 - a * r) / 2, t = 0) : (i = 0, t = (150 - (e = n * l)) / 2);
                    var c = o[0];
                    c.style.left = t + "px",
                    c.style.top = i + "px",
                    c.style.width = e + "px",
                    c.src = s.src
                }
            }
        },
        ii.prototype.showGallery = function(e, t) {
            var i = this.container.nid,
                o = [];
            for (var s of t)
                o.push({
                    file: database.downloadURL(i, s.name),
                    name: s.name
                });
            var r = database.downloadURL(i, e.name),
                l = o.findIndex(e => e.file === r),
                c = $("<div>").appendTo(document.body);
            n.render(a.createElement(Yt.a, {
                images: o,
                initialImageIndex: l,
                closeLightBox: () => {
                    n.unmountComponentAtNode(c[0]),
                    c.remove()
                },
                downloadUrl: e => {
                    database.previewFile(i, e.name)
                }
            }), c[0])
        },
        ii.prototype.popupMenu = function(e) {
            var t = this,
                i = $(e.target),
                o = i.closest(".file").data("file");
            if (o) {
                var n = $.backplane({}),
                    s = $('<div class="nx-menu-popup">').appendTo(n);
                $('<div class="nx-menu-head file-name">').text(o.name).appendTo(s),
                this.isWritable() && ($('<div class="nx-menu-item">').append($('<div class="nx-menu-label">').text(locale.rename)).appendTo(s).touch((function() {
                    n.close(),
                    t.renameFile(o, e)
                })), $('<div class="nx-menu-item">').append($('<div class="nx-menu-label">').text(locale.remove)).appendTo(s).touch((function() {
                    n.close(),
                    t.removeFile(o)
                })));
                var a = s.outerWidth(),
                    r = s.outerHeight(),
                    l = i.offset();
                return l.left += i.width() - 32, l.left + a > window.getWidth() && (l.left = window.getWidth() - a), l.top + r > window.getHeight() && (l.top = window.getHeight() - r), s.offset(l), !1
            }
        },
        ii.prototype.removeFile = function(e) {
            if (!this.isWritable())
                return $.alert(locale.errorNotAuthorized);
            var t = this,
                i = this.container.nid;
            $.dialog({
                closable: !0,
                caption: locale.removeFile,
                message: locale.confirmRemoveFile,
                buttons: [{
                    color: "red",
                    caption: locale.removeFile,
                    callback: function() {
                        database.removeFile(i, e.name, (function(e) {
                            e && $.alert(e),
                            t.updateUI()
                        }))
                    }
                }]
            })
        },
        ii.prototype.renameFile = function(e, t) {
            if (!this.isWritable())
                return $.alert(locale.errorNotAuthorized);
            var i = this,
                o = this.nid,
                n = e.name,
                s = $.popdown({
                    head: locale.rename,
                    buttons: ["-", "cancel", " ", {
                        cls: "blue",
                        caption: locale.rename,
                        click: l
                    }]
                }),
                a = $('<div class="component editor editor-string" style="width:100%">').appendTo(s.$content);
            $("<label>").text(locale.name).appendTo(a);
            var r = $('<input type="text">').val(n).appendTo($('<div class="stringeditor">').appendTo(a)).keydown((function(e) {
                13 === e.which && l(),
                27 === e.which && close()
            }));
            function l() {
                var e = r.val();
                return n === e ? s.close() : util.isValidFileName(e) ? ($.loading(!0), void setTimeout((function() {
                    database.renameFile(o, n, e, (function(e) {
                        if ($.loading(!1), e)
                            return $.alert(locale.couldntRenameFile);
                        s.close(),
                        i.updateUI()
                    }))
                }), 0)) : $.alert(locale.invalidFileName)
            }
            setTimeout((function() {
                r.focus()
            }), 400)
        },
        ii.prototype.saveFileICloud = function(e) {
            var t = this.nid,
                i = e.name,
                o = database.downloadURL(t, i);
            NinoxDocumentInteraction.saveFileOnICloud(o, (function(e) {
                e && $.alert(e)
            }))
        },
        ii.prototype.saveFileFileSystem = function(e) {
            var t = this.nid,
                i = e.name,
                o = database.downloadURL(t, i);
            NinoxDocumentInteraction.saveFile(i, "", (function(e, t) {
                if (e)
                    return $.alert(e);
                t && localFileSystem.copyURL(o, t).catch(e => $.alert(e))
            }))
        },
        ii.prototype.openFileIn = function(e, t) {
            var i = this.nid,
                o = e.name,
                n = database.downloadURL(i, o);
            NinoxDocumentInteraction.showFileOptions(n, t.clientX, t.clientY, (function() {}))
        },
        Object.assign(oi.prototype, Ot.a.prototype),
        oi.prototype.updateStructure = function() {
            var e = this.field;
            this.el.attr("title", e.tooltip || ""),
            this.updateElementWidth(),
            this.label.text(e.caption || locale.unnamed),
            this.updateStyle()
        },
        oi.prototype.updateStyle = function() {
            var e,
                t = this.field;
            if (t.style)
                try {
                    e = JSON.parse(t.style)
                } catch (e) {}
            this.label.css({
                "background-color": e && e.backgroundColor || "",
                "border-color": e && e.borderColor || "",
                "border-width": e && e.borderWidth || "",
                color: e && e.color || "",
                "font-size": e && e.fontSize || "",
                "text-align": e && e.textAlign || "",
                "font-weight": e && (util.multiHasOne(e.fontStyle, [1]) ? "bold" : "normal") || "",
                "font-style": e && util.multiHasOne(e.fontStyle, [2]) ? "italic" : "",
                "border-left-style": e && (util.multiHasOne(e.borderSides, [1]) ? e.borderStyle : "none") || "",
                "border-top-style": e && (util.multiHasOne(e.borderSides, [2]) ? e.borderStyle : "none") || "",
                "border-bottom-style": e && (util.multiHasOne(e.borderSides, [3]) ? e.borderStyle : "none") || "",
                "border-right-style": e && (util.multiHasOne(e.borderSides, [4]) ? e.borderStyle : "none") || ""
            })
        },
        oi.prototype.startEditCaption = qt.prototype.startEditCaption,
        ni.prototype.bind = function() {
            this.container.currentTab === this && this.load()
        },
        ni.prototype.destroy = function() {
            this.elTab.remove(),
            this.el.remove()
        },
        ni.prototype.hide = function(e) {
            this.container.currentTab === this && (this.container.currentTab = void 0, this.el.hide(), this.historyDiv.empty(), this.elTab.removeClass("selected"), this.elTab[0].firstElementChild.className = this.unselectedIconClass, this.tabSelectedIndicator.detach(), e && e())
        },
        ni.prototype.show = function() {
            this.container.currentTab !== this && (this.container.currentTab && this.container.currentTab.hide(), this.container.currentTab = this, this.el.show(), this.elTab.addClass("selected"), this.elTab[0].firstElementChild.className = this.selectedIconClass, this.tabSelectedIndicator.appendTo(this.elTab), this.load())
        },
        ni.prototype.focus = function() {},
        ni.prototype.load = function() {
            var e = this;
            e.container.nid && database.loadNodeHistory(e.container.nid, (function(t, i) {
                if (t)
                    return $.alert(t);
                e.render(i)
            }))
        },
        ni.prototype.render = function(e) {
            this.historyDiv.empty();
            var t = this.container.type,
                i = this.historyDiv,
                o = void 0,
                n = void 0;
            e.sort((function(e, t) {
                return t[0] - e[0]
            })),
            T.each(e, (function(e) {
                e[0];
                var s = e[1],
                    a = new Date(e[2]),
                    r = e[3],
                    l = util.formatLocaleDate(a);
                if (l !== o && (void 0 !== n && $('<div class="history-foot">').appendTo(i), $('<div class="history-date">').text(l).appendTo(i), o = l, n = void 0), s !== n) {
                    void 0 !== n && $('<div class="history-foot">').appendTo(i);
                    var c = $('<div class="history-head">').appendTo(i);
                    $('<div class="history-user">').text(database.userName(s)).appendTo(c),
                    n = s
                }
                var d = $('<div class="history-entry">').appendTo(i);
                switch ($('<div class="history-time">').text(function(e) {
                    var t = e.getHours(),
                        i = e.getMinutes(),
                        o = e.getSeconds();
                    return (t < 10 ? "0" : "") + t + ":" + (i < 10 ? "0" : "") + i + ":" + (o < 10 ? "0" : "") + o
                }(a)).appendTo(d), r) {
                case "create":
                    $('<div class="history-change">').appendTo(d).text(locale.created);
                    break;
                case "remove":
                    $('<div class="history-change">').appendTo(d).text(locale.removed);
                    break;
                case "update":
                    var h = e[5],
                        p = $('<div class="history-change">').appendTo(d);
                    T.each(h, (function(e, i) {
                        var o = t.fields[i];
                        if (o && database.canRead(o))
                            if (o.isField)
                                $("<div>").text(o.caption + " " + locale.updated + " " + o.format(e)).appendTo(p);
                            else if (o.isReference)
                                if (e) {
                                    var n = o.refType.id + e;
                                    $("<div>").append($('<div class="history-link">' + o.caption + " " + locale.linked + " ...</div>").touch((function() {
                                        new Vi.PopupEditor(n, {})
                                    }))).appendTo(p)
                                } else
                                    $("<div>").text(o.caption + " " + locale.unlinked).appendTo(p);
                            else if (o.isReverse)
                                for (var s in e)
                                    if (e.hasOwnProperty(s)) {
                                        n = o.refType.id + s;
                                        !0 === e[s] ? $("<div>").append($('<div class="history-link">' + o.caption + " " + locale.linked + " ...</div>").touch((function() {
                                            new Vi.PopupEditor(n, {})
                                        }))).appendTo(p) : !1 === e[s] && $("<div>").append($('<div class="history-link">' + o.caption + " " + locale.unlinked + " ...</div>").touch((function() {
                                            new Vi.PopupEditor(n, {})
                                        }))).appendTo(p)
                                    }
                    }))
                }
            })),
            void 0 !== n && $('<div class="history-foot">').appendTo(i)
        };
        o("./src/react/SideEditorTools.css");
        var si = o("./src/react/util/HorizontalScrollContainer/HorizontalScrollContainer.tsx");
        class ai extends a.Component {
            constructor(e)
            {
                super(e),
                this.state = {
                    isScrollable: !1
                }
            }
            render()
            {
                return a.createElement("div", {
                    className: "SideEditorTools_root"
                }, a.createElement(si.a, {
                    controlsConfig: {
                        left: {
                            visibility: window.TOUCH ? "NONE" : "AUTO",
                            containerClassName: "SideEditorTools_movementControls",
                            iconClassName: "i-32-24 i-white i-arrow-solid-left",
                            innerElement: !window.TOUCH && this.state.isScrollable ? a.createElement("div", {
                                className: "SideEditorTools_divider"
                            }) : null
                        },
                        right: {
                            visibility: window.TOUCH ? "NONE" : "AUTO",
                            containerClassName: "SideEditorTools_movementControls",
                            iconClassName: "i-32-24 i-white i-arrow-solid-right"
                        },
                        position: "AFTER_CHILD"
                    },
                    onScrollStateChange: e => this.setState({
                        isScrollable: e
                    }),
                    customScrollBy: e => Math.max(e / 2, 64)
                }, a.createElement(ee.a, {
                    onFastClick: this.props.editFields,
                    className: "SideEditorTools_button",
                    rippleStyle: "LIGHT"
                }, a.createElement("div", {
                    className: "SideEditorTools_buttonIcon i-32-24 i-white i-setting-tool"
                }), a.createElement("div", {
                    className: "SideEditorTools_buttonLabel"
                }, Object(b.getLocale)().editFields)), a.createElement("div", {
                    className: "SideEditorTools_divider"
                }), a.createElement(ee.a, {
                    onFastClick: this.props.popupFields,
                    className: "SideEditorTools_button",
                    rippleStyle: "LIGHT"
                }, a.createElement("div", {
                    className: "SideEditorTools_buttonIcon i-32-24 i-white i-plus"
                }), a.createElement("div", {
                    className: "SideEditorTools_buttonLabel"
                }, Object(b.getLocale)().field)), a.createElement(ee.a, {
                    onFastClick: this.props.addFunction,
                    className: "SideEditorTools_button",
                    rippleStyle: "LIGHT"
                }, a.createElement("div", {
                    className: "SideEditorTools_buttonIcon i-32-24 i-white i-formula"
                }), a.createElement("div", {
                    className: "SideEditorTools_buttonLabel"
                }, Object(b.getLocale)().function)), a.createElement(ee.a, {
                    onFastClick: this.props.popupUIs,
                    className: "SideEditorTools_button",
                    rippleStyle: "LIGHT"
                }, a.createElement("div", {
                    className: "SideEditorTools_buttonIcon i-32-24 i-white i-header"
                }), a.createElement("div", {
                    className: "SideEditorTools_buttonLabel"
                }, Object(b.getLocale)().layoutElement)), a.createElement("div", {
                    className: "SideEditorTools_divider"
                }), a.createElement(ee.a, {
                    onFastClick: this.props.popupReferences,
                    className: "SideEditorTools_button",
                    rippleStyle: "LIGHT"
                }, a.createElement("div", {
                    className: "SideEditorTools_buttonIcon i-32-24 i-white i-field-ref"
                }), a.createElement("div", {
                    className: "SideEditorTools_buttonLabel"
                }, Object(b.getLocale)().linkTo)), a.createElement(ee.a, {
                    onFastClick: this.props.popupReverses,
                    className: "SideEditorTools_button",
                    rippleStyle: "LIGHT"
                }, a.createElement("div", {
                    className: "SideEditorTools_buttonIcon i-32-24 i-white i-field-rev"
                }), a.createElement("div", {
                    className: "SideEditorTools_buttonLabel"
                }, Object(b.getLocale)().linkFrom)), a.createElement(ee.a, {
                    onFastClick: this.props.addSubTable,
                    className: "SideEditorTools_button",
                    rippleStyle: "LIGHT"
                }, a.createElement("div", {
                    className: "SideEditorTools_buttonIcon i-32-24 i-white i-setting-table"
                }), a.createElement("div", {
                    className: "SideEditorTools_buttonLabel"
                }, Object(b.getLocale)().subTable))))
            }
        }
        var ri = o("./src/react/tableView/PopupMenu.tsx");
        class li extends a.Component {
            constructor(e)
            {
                super(e),
                K()(this, "handleClick", (e, t) => {
                    null !== e && (Object(rt.a)(this.state.currentAction), this.state.currentAction(e, t)),
                    this.setState({
                        currentAction: null
                    })
                }),
                K()(this, "popupUIs", e => {
                    const t = [];
                    ["br", "space", "head", "text", "tab", "button", "view", "chart"].forEach(e => {
                        t.push({
                            id: e,
                            text: Object(b.getLocale)().types[e] || e,
                            iconClass: "i-32-24 i-light-grey i-field-" + e
                        })
                    }),
                    this.setState({
                        currentAction: e => this.props.onCreateUI(t[e].id),
                        currentTarget: ee.b.getTarget(e),
                        currentItemsToRender: t,
                        currentMaxCols: 2
                    })
                }),
                K()(this, "popupFields", e => {
                    const t = ["string", "string_multiline", "html", "number", "boolean", "choice", "multi", "date", "time", "timestamp", "timeinterval", "appointment", "file", "signature", "link", "email", "phone", "location", "color", "icon"];
                    this.props.database.supports.authentication && t.push("user");
                    const i = [];
                    t.forEach(e => {
                        i.push({
                            id: e,
                            text: Object(b.getLocale)().types[e],
                            iconClass: "i-32-24 i-light-grey i-field-" + e
                        })
                    }),
                    this.setState({
                        currentAction: e => this.props.onCreateField(t[e]),
                        currentTarget: ee.b.getTarget(e),
                        currentItemsToRender: i,
                        currentMaxCols: 3
                    })
                }),
                K()(this, "popupReferences", e => {
                    const t = this.getSortedTypes();
                    this.setState({
                        currentAction: e => this.props.onCreateReference(t[e]),
                        currentTarget: ee.b.getTarget(e),
                        currentItemsToRender: t,
                        currentMaxCols: void 0
                    })
                }),
                K()(this, "getSortedTypes", () => b.util.localeSortBy(this.props.database.schema.types, "caption").map(e => {
                    const t = e.icon ? "ic ic-" + e.icon : "i-40-24 i-light-grey i-setting-table";
                    return {
                        id: e.id,
                        text: e.caption || Object(b.getLocale)().unnamed,
                        iconClass: "icon-big-grey " + t
                    }
                })),
                K()(this, "popupReverses", e => {
                    const t = this.getSortedTypes();
                    this.setState({
                        currentAction: e => this.props.onCreateReverse(t[e]),
                        currentTarget: ee.b.getTarget(e),
                        currentItemsToRender: t,
                        currentMaxCols: void 0
                    })
                }),
                this.state = {
                    currentTarget: null,
                    currentItemsToRender: [],
                    currentAction: null,
                    currentMaxCols: void 0
                }
            }
            render()
            {
                return a.createElement(a.Fragment, null, a.createElement(ai, {
                    editFields: this.props.editFields,
                    popupFields: this.popupFields,
                    addFunction: this.props.addFunction,
                    popupUIs: this.popupUIs,
                    popupReferences: this.popupReferences,
                    popupReverses: this.popupReverses,
                    addSubTable: this.props.addSubTable
                }), this.renderPopup())
            }
            renderPopup()
            {
                return a.createElement(ri.a, {
                    itemBackground: "DEFAULT",
                    clickTarget: this.state.currentTarget,
                    show: null !== this.state.currentAction,
                    onClick: this.handleClick,
                    maxColumns: this.state.currentMaxCols,
                    items: this.state.currentItemsToRender
                })
            }
        }
        function ci(e, t, i, o) {
            this.columns = this.calculateColumns(),
            this.selectedComponent = void 0,
            this.mouseMode = void 0,
            this.container = e,
            this.tid = t,
            this.type = void 0,
            this.hideFields = i || {},
            this.nid = void 0,
            this.node = void 0,
            this.currentTab = void 0,
            this._isWritable = !0,
            this.el = $('<div class="object --ul-document-object' + (e.isEmbedded ? " object-embedded" : "") + '">').appendTo(e.containerEl || e.el),
            this.el.on("mousedown touchstart", $.proxy(this.mousedown, this)),
            this.elTabs = e.tabsEl,
            this.tabs = [],
            this.createStructure(o),
            ui.on("saveSchema", this.unselectComponent, this)
        }
        ci.prototype.updateStructure = function() {
            var e = this;
            Object(Bt.b)() ? this.el.addClass("adminmode") : (this.el.removeClass("adminmode"), this.unselectComponent());
            var t = this.currentTab ? this.currentTab.id : void 0,
                i = this.type = database.schema.types[this.tid];
            if (!i)
                return this.destroy();
            var o = i.sorted[0] && "tab" === i.sorted[0].base,
                n = this.tabs,
                s = [],
                a = {},
                r = {};
            o || (r[0] = !0);
            for (var l = 0; l < n.length; l++) {
                var c = n[l];
                a[c.id] = c,
                c.children = []
            }
            o || ((c = a[0]).field = {
                id: "0",
                caption: i.caption,
                type: i,
                order: -1
            }, s.push(c)),
            T.each(i.sorted, (function(t) {
                "tab" === t.base ? ((c = a[t.id]) ? c.field = t : c = new Vi.Tab(e, t), s.push(c), r[t.id] = !0) : c.children.push(t)
            }));
            for (l = 0; l < n.length; l++) {
                c = n[l];
                r[c.id] || c.destroy()
            }
            this.tabs = s,
            T.each(this.tabs, (function(e) {
                e.updateStructure()
            })),
            this.updateTabs(),
            this.selectTab(t)
        },
        ci.prototype.createStructure = function(e) {
            var t = this;
            Object(Bt.b)() ? this.el.addClass("adminmode") : this.el.removeClass("adminmode");
            var i,
                o = this.type = database.schema.types[this.tid];
            o && (o.sorted[0] && "tab" === o.sorted[0].base || (i = new Vi.Tab(this, {
                id: "0",
                caption: o.caption,
                type: o,
                order: -1
            }), this.tabs.push(i)), T.each(o.sorted, (function(e) {
                "tab" === e.base ? (i = new Vi.Tab(t, e), t.tabs.push(i)) : i.children.push(e)
            })), database.supports.files && o.hasFiles && (this.files = new Vi.FilesTab(this)), database.supports.comments && o.hasComments && (this.comments = new Vi.CommentsTab(this)), database.supports.history && database.authorizationHistory && o.hasHistory && (this.history = new Vi.HistoryTab(this)), this.updateTabs(), this.selectTab(e))
        },
        ci.prototype.updateTabs = function() {
            T.each(this.tabs, (function(e) {
                e.elTab.detach()
            }), this),
            T.each(this.tabs, (function(e) {
                e.elTab.appendTo(this.elTabs)
            }), this),
            this.files && this.files.elTab.appendTo(this.elTabs),
            this.comments && this.comments.elTab.appendTo(this.elTabs),
            this.history && this.history.elTab.appendTo(this.elTabs)
        },
        ci.prototype.register = function() {
            this.nid && database.on("*", void 0, this.nodeChanged, this)
        },
        ci.prototype.unregister = function() {
            this.nid && database.off("*", void 0, this.nodeChanged, this)
        },
        ci.prototype.destroy = function() {
            ui.off("saveSchema", this.unselectComponent, this),
            this.unregister(),
            T.each(this.tabs, (function(e) {
                e.destroy()
            })),
            this.files && this.files.destroy(),
            this.comments && this.comments.destroy(),
            this.history && this.history.destroy(),
            this.el.remove()
        },
        ci.prototype.bind = function(e) {
            this.unregister(),
            this.node = e,
            this.nid = e ? e._id : void 0,
            this.register(),
            this.updateIsWritable(),
            T.each(this.tabs, (function(t) {
                t.bind(e)
            })),
            this.files && this.files.bind(e),
            this.comments && this.comments.bind(e),
            this.history && this.history.bind(e)
        },
        ci.prototype.updateIsWritable = function() {
            this._isWritable = database.canWriteNode(this.nid)
        },
        ci.prototype.isWritable = function() {
            return this._isWritable
        },
        ci.prototype.save = function() {
            T.each(this.tabs, (function(e) {
                e.save()
            }))
        },
        ci.prototype.getSelectedTab = function() {
            if (this.currentTab)
                return this.currentTab.id
        },
        ci.prototype.selectTab = function(e) {
            let t = e;
            if ("files" === e && this.files)
                this.files.show();
            else if ("comments" === e && this.comments)
                this.comments.show();
            else if ("history" === e && this.history)
                this.history.show();
            else {
                var i = this.tabs;
                const o = i.find(t => t.id === e);
                void 0 === o ? (i[0].show(), t = i[0].id) : o.show()
            }
            this.container.editorTabChanged && this.container.editorTabChanged(t)
        },
        ci.prototype.nodeChanged = function() {
            var e = database.loadNodeSync(this.nid);
            this.node = e,
            this.updateIsWritable(e),
            e && T.each(this.tabs, (function(e) {
                e.nodeChanged()
            }))
        };
        var di = 0;
        function hi(e, t) {
            var i = Object.keys(e);
            if (Object.getOwnPropertySymbols) {
                var o = Object.getOwnPropertySymbols(e);
                t && (o = o.filter((function(t) {
                    return Object.getOwnPropertyDescriptor(e, t).enumerable
                }))),
                i.push.apply(i, o)
            }
            return i
        }
        function pi(e) {
            for (var t = 1; t < arguments.length; t++) {
                var i = null != arguments[t] ? arguments[t] : {};
                t % 2 ? hi(Object(i), !0).forEach((function(t) {
                    K()(e, t, i[t])
                })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(i)) : hi(Object(i)).forEach((function(t) {
                    Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(i, t))
                }))
            }
            return e
        }
        function fi() {
            var e = this;
            this.nid = void 0,
            this.opened = !1,
            this.editor = void 0,
            this.options = {},
            this.lastSelectedTab = void 0,
            this.el = $('<div class="sideeditor">').appendTo(ui.$right),
            $('<div class="popupeditor2-shadow">').appendTo(this.el),
            this.$tools = void 0,
            $('<div class="sideeditor-buttons-left">').appendTo(this.el).button2({
                icon: "i-40-24 i-light-grey i-line-right",
                click: function() {
                    e.close()
                }
            }),
            this.tabsEl = $('<div class="sideeditor-tabs">').appendTo(this.el),
            database.on("rename", void 0, this.nodeRenamed, this),
            database.on("remove", void 0, this.nodeRemoved, this),
            database.on("schema", void 0, this.schemaChanged, this),
            database.on("admin", void 0, this.adminChanged, this)
        }
        function mi(e) {
            var t = ui.sideEditor.opened ? 1 : 0,
                i = widgets.popupEditorStack,
                o = i.length + t,
                n = ui.rightWidth,
                s = ui.leftWidth,
                a = ui.fullWidth - s - n,
                r = 32 * (o - 1),
                l = Math.max(a < r ? 0 : -Math.floor(a / o), -n);
            if (t && ui.fullWidth > 640) {
                var c = l * (o - 1);
                ui.$right[0].style.transform = ui.$right[0].style.WebkitTransform = "translateX(" + c + "px)"
            }
            for (var d = 0; d < i.length; d++) {
                c = l * (o - d - 1 - t);
                e && d === i.length - 1 || ui.fullWidth < 640 || (i[d].el[0].style.transform = i[d].el[0].style.WebkitTransform = "translateX(" + c + "px)")
            }
        }
        function gi() {
            ui.sideEditor.updateTools();
            for (var e = widgets.popupEditorStack, t = 0; t < e.length; t++)
                e[t].updateTools();
            ui.trigger("widgets.tools.updated")
        }
        function vi(e, t) {
            var i = this;
            this.isClosed = !1;
            var o = database.typeOf(e);
            if (!o)
                return;
            var n = ui.sideEditor.opened ? 1 : 0,
                s = widgets.popupEditorStack.length + n + 1,
                a = ui.rightWidth,
                r = ui.leftWidth,
                l = 32 * (s - 1),
                c = ui.fullWidth - r - a < l ? a - l : a;
            t = t || {},
            this.options = t,
            this.nid = e,
            this.children = [],
            this.recordController = {
                hasNextRecord: function() {
                    return !!t.next
                },
                nextRecord: function() {
                    i.editor.save(),
                    t.next && t.next()
                },
                hasPrevRecord: function() {
                    return !!t.prev
                },
                prevRecord: function() {
                    i.editor.save(),
                    t.prev && t.prev()
                },
                hasAddRecord: function() {
                    return !(!t.create || !database.canCreate(o))
                },
                addRecord: function() {
                    i.editor.save(),
                    t.create && t.create()
                },
                hasDuplicateRecord: function() {
                    return !(!t.duplicate || !database.canCreate(o))
                },
                duplicateRecord: function() {
                    i.editor.save(),
                    t.duplicate && database.canCreate(o) && ("function" == typeof t.duplicate ? t.duplicate() : ($.loading(!0), database.duplicate(e, (function(e, t) {
                        if ($.loading(!1), e)
                            return $.alert(e);
                        i.setNid(t)
                    }))))
                },
                hasRemoveRecord: function() {
                    return database.canDelete(o)
                },
                removeRecord: function() {
                    i.remove()
                },
                hasPrintRecord: function() {
                    return !!database.authorizationPrint
                },
                printRecord: function() {
                    i.editor.save(),
                    i.print()
                },
                hasUnlinkRecord: function() {
                    return !!t.unlink
                },
                unlinkRecord: function() {
                    i.editor.save(),
                    t.unlink && t.unlink()
                }
            },
            this.$backplane = $('<div class="nx-backplane nx-backplane-popupeditor2">').appendTo($(document.body)).touch((function(e) {
                var t = $(e.target);
                (t.is(".nx-backplane") || t.is(".popupeditor2-shadow")) && i.close()
            }));
            var d = this.el = $('<div class="popupeditor2" style="transform:translateX(' + c + "px);-webkit-transform:translateX(" + c + "px);width:" + c + "px;bottom:" + ui.footHeight + 'px">').appendTo(this.$backplane);
            ui.fullscreenStack.length > 0 ? (this.$backplane.css("z-index", 10), this.el.css({
                top: 0,
                bottom: 0
            })) : ui.fullWidth > 640 ? (this.$backplane.css("z-index", 8), this.el[0].style.top = ui.topPadding + 96 + "px") : (this.$backplane.css("z-index", 10), this.el.css({
                top: ui.topPadding,
                width: ui.fullWidth + "px"
            })),
            $('<div class="popupeditor2-shadow">').appendTo(this.el),
            $('<div class="popupeditor2-buttons-left">').appendTo(this.el).button2({
                icon: "i-40-18 i-light-grey i-close",
                click: $.proxy(this.close, this)
            }),
            this.tabsEl = $('<div class="popupeditor2-tabs">').appendTo(this.el),
            this.editor = new ci(this, o.id, this.options.hideFields || {}, void 0),
            database.loadNode(e, (function(e, t) {
                t && i.editor.bind(t)
            })),
            database.on("rename", void 0, this.nodeRenamed, this),
            database.on("remove", void 0, this.nodeRemoved, this),
            database.on("schema", void 0, this.schemaChanged, this),
            database.on("admin", void 0, this.adminChanged, this),
            this.keydown = $.proxy(this.keydown, this),
            ui.recordNavigation.pushController(this.recordController),
            $.pushInputHandler(this),
            widgets.popupEditorStack.push(this),
            gi(),
            mi(!0),
            setTimeout((function() {
                d[0].style.transform = d[0].style.WebkitTransform = "translateX(0px)"
            }), 0)
        }
        function bi(e) {
            e = e || {};
            var t = $.backplane({
                    close: function() {
                        e.close && e.close()
                    }
                }),
                i = window.getHeight(),
                o = this.$menu = $('<div class="nx-menu-popup" style="max-height:' + (i - 64) + 'px;overflow:auto">').appendTo(t);
            if (e.head) {
                var n = $('<div class="nx-menu-head">').appendTo(o);
                e.head.caption && n.append($("<span>").text(e.head.caption))
            }
            var s = e.items || [];
            T.each(s, (function(e, t) {
                if (e)
                    if ("string" == typeof e)
                        $('<div class="nx-menu-head2">').append($("<span>").text(e)).appendTo(o);
                    else {
                        var i = $('<div class="nx-menu-item">').appendTo(o).click((function(t) {
                            $(this).addClass("anim-activated"),
                            c(),
                            e.click && e.click(t)
                        }));
                        e.icon && $('<div class="nx-menu-icon ' + e.icon + '">').appendTo(i),
                        e.caption && $('<div class="nx-menu-label">').text(e.caption).appendTo(i),
                        e.css && i.css(e.css)
                    }
            })),
            this.close = c;
            var a = o.outerWidth(),
                r = o.outerHeight(),
                l = e.offset;
            function c() {
                t.close()
            }
            l.left + a > window.getWidth() && (l.left = window.getWidth() - a),
            l.top + r > window.getHeight() && (l.top = window.getHeight() - r),
            o.offset(l)
        }
        ci.prototype.mousedown = function(e) {
            if (Object(Bt.b)() && !(this.mouseMode || e.touches && 1 !== e.touches.length)) {
                var t = this,
                    i = e.target.className,
                    o = $(e.target),
                    n = o.closest(".component").data("component"),
                    s = Date.now(),
                    a = s - di;
                di = s,
                n ? /component-selector-tool/.test(i) ? (n.popup(), e.preventDefault()) : /component-selector-cr/.test(i) ? (!function() {
                    t.mouseMode = "resize-h",
                    $(window).on("mousemove touchmove", l),
                    $(window).on("mouseup touchend", (function e(i) {
                        if (i.touches && 0 !== i.touches.length)
                            return;
                        $(window).off("mousemove touchmove", l),
                        $(window).off("mouseup touchend", e),
                        i.preventDefault(),
                        t.mouseMode = void 0,
                        r !== n.field.formWidth && n.field.type.schema.trigger("change")
                    }));
                    var i = e.touches ? e.touches[0].clientX : e.clientX,
                        o = e.touches ? e.touches[0].clientY : e.clientY,
                        s = n.el.parent(),
                        a = n.el.outerWidth() / s.width(),
                        r = n.field.formWidth;
                    function l(e) {
                        if (!e.touches || 1 === e.touches.length) {
                            e.preventDefault();
                            var t = e.touches ? e.touches[0].clientX : e.clientX,
                                r = e.touches ? e.touches[0].clientY : e.clientY,
                                l = t - i,
                                c = r - o,
                                d = Math.abs(l) > Math.abs(c) ? l : c,
                                h = Math.round(Math.min(4, Math.max(1, 4 * (a + d / s.width())))),
                                p = Math.round(Math.min(32, Math.max(n.field.minFormWidth, 32 * (a + d / s.width())))) / 32;
                            n.setWidth(h, p)
                        }
                    }
                }(), e.preventDefault()) : /component-selector-cb/.test(i) ? (!function() {
                    t.mouseMode = "resize-v";
                    var i = e.touches ? e.touches[0].clientY : e.clientY,
                        o = n.el.outerHeight(),
                        s = n.field.height;
                    function a(e) {
                        if (!e.touches || 1 === e.touches.length) {
                            e.preventDefault();
                            var t = (e.touches ? e.touches[0].clientY : e.clientY) - i;
                            n.setHeight(o + t)
                        }
                    }
                    $(window).on("mousemove touchmove", a),
                    $(window).on("mouseup touchend", (function e(i) {
                        i.touches && 0 !== i.touches.length || ($(window).off("mousemove touchmove", a), $(window).off("mouseup touchend", e), i.preventDefault(), t.mouseMode = void 0, s !== n.field.height && n.field.type.schema.trigger("change"))
                    }))
                }(), e.preventDefault()) : /component-selector/.test(i) ? (a < 400 ? n.startEditCaption && n.startEditCaption() : r(), e.preventDefault()) : o.is("label") || o.is(".component") || o.is(".booleanslide-text") ? t.selectedComponent === n ? (r(), e.preventDefault()) : function() {
                    t.mouseMode = "start-select";
                    var i = e.touches ? e.touches[0].clientX : e.clientX,
                        o = e.touches ? e.touches[0].clientY : e.clientY,
                        s = i,
                        a = o;
                    function r(e) {
                        e.touches && 1 !== e.touches.length || (s = e.touches ? e.touches[0].clientX : e.clientX, a = e.touches ? e.touches[0].clientY : e.clientY)
                    }
                    $(window).on("mousemove touchmove", r),
                    $(window).on("mouseup touchend", (function e(l) {
                        if (!l.touches || 0 === l.touches.length) {
                            $(window).off("mousemove touchmove", r),
                            $(window).off("mouseup touchend", e),
                            t.mouseMode = void 0;
                            var c = s - i,
                                d = a - o;
                            c * c + d * d < 10 && (t.selectComponent(n), l.preventDefault())
                        }
                    }))
                }() : this.unselectComponent() : this.unselectComponent()
            }
            function r() {
                t.mouseMode = "drag";
                var i,
                    o,
                    s,
                    a,
                    r,
                    l,
                    c,
                    d = "init",
                    h = e.touches ? e.touches[0].clientX : e.clientX,
                    p = e.touches ? e.touches[0].clientY : e.clientY,
                    u = n.el.parent();
                function f(e) {
                    if (!e.touches || 1 === e.touches.length) {
                        e.preventDefault();
                        var t,
                            f = e.touches ? e.touches[0].clientX : e.clientX,
                            g = e.touches ? e.touches[0].clientY : e.clientY,
                            v = f - h,
                            b = g - p;
                        if ("init" === d)
                            v * v + b * b > 25 && (d = "drag", i = n.el.outerWidth(), i / u.width(), o = n.el.outerHeight(), s = n.el.offset(), a = $('<div style="display:inline-block;width:' + (i - 1) + "px;height:" + (o - 3) + "px;background-color:#ccc;" + (t = n.field.base, {
                                file: "float:left"
                            }[t] || "") + '">').insertBefore(n.el), n.el.css({
                                position: "absolute",
                                left: s.left,
                                top: s.top,
                                width: i,
                                height: o,
                                backgroundColor: "#e7e7e7",
                                opacity: .8,
                                zIndex: 11
                            }).detach().appendTo($(document.body)), m());
                        else {
                            n.el.css({
                                left: s.left + v,
                                top: s.top + b
                            });
                            var y = function(e, t) {
                                for (var i = 0; i < l.length; i++) {
                                    var o = l[i];
                                    if (e >= o.x && e <= o.x + o.w && t >= o.y && t <= o.y + o.h) {
                                        var n = e - o.x < o.w / 4 ? -1 : e - o.x > 3 * o.w / 4 ? 1 : 0,
                                            s = t - o.y < o.h / 4 ? -1 : t - o.y > 3 * o.h / 4 ? 1 : 0;
                                        return {
                                            dirH: n,
                                            dirV: s,
                                            el: o.el,
                                            tab: o.tab
                                        }
                                    }
                                }
                                return
                            }(f, g);
                            if (y && (!r || y.el !== r.el || y.dirH !== r.dirH || y.dirV !== r.dirV || y.tab !== r.tab)) {
                                if (r && r.tab && r.tab.elTab.css("background-color", ""), (r = y) && r.tab)
                                    r.tab.elTab.css("background-color", "red"),
                                    a.detach();
                                else {
                                    var w = $(r.el).data("component");
                                    r.dirV < 0 || r.dirH < 0 ? (a.insertBefore($(r.el)), c = w.field.order - .5) : (r.dirV > 0 || r.dirH > 0) && (a.insertAfter($(r.el)), c = w.field.order + .5)
                                }
                                m()
                            }
                        }
                    }
                }
                function m() {
                    l = [];
                    for (var e = u.children(".component"), i = 0; i < e.length; i++) {
                        var o = $(e[i]),
                            n = o.offset(),
                            s = o.width(),
                            a = o.height();
                        l.push({
                            x: n.left,
                            y: n.top,
                            w: s,
                            h: a,
                            el: o[0]
                        })
                    }
                    var r = t.tabs;
                    for (i = 0; i < r.length; i++) {
                        var c = r[i];
                        if (!c.visible) {
                            var d = c.elTab;
                            n = d.offset(),
                            s = d.width(),
                            a = d.height();
                            l.push({
                                x: n.left,
                                y: n.top,
                                w: s,
                                h: a,
                                el: d[0],
                                tab: c
                            })
                        }
                    }
                }
                $(window).on("mousemove touchmove", f),
                $(window).on("mouseup touchend", (function e(i) {
                    if (i.touches && 0 !== i.touches.length)
                        return;
                    $(window).off("mousemove touchmove", f),
                    $(window).off("mouseup touchend", e),
                    i.preventDefault(),
                    t.mouseMode = void 0,
                    "drag" === d && (r && r.tab ? (r.tab.elTab.css("background-color", ""), n.field.order = r.tab.field.order + .5, n.field.type.resort(), n.field.type.schema.trigger("change")) : (n.el.css({
                        position: "",
                        left: "",
                        top: "",
                        width: 100 * n.field.formWidth + "%",
                        height: "",
                        backgroundColor: "",
                        opacity: "",
                        zIndex: ""
                    }).detach().insertBefore(a), r && (n.field.order = c, n.field.type.resort(), n.field.type.schema.trigger("change"))), r = void 0, a.remove())
                }))
            }
        },
        ci.prototype.selectComponentByUUID = function(e, t) {
            var i = this.currentTab;
            if (i) {
                var o = i.components;
                if (o)
                    for (var n = 0; n < o.length; n++) {
                        var s = o[n],
                            a = s.field;
                        if (a && a.uuid === e)
                            return this.selectComponent(s), void (t && s.startEditCaption && s.startEditCaption())
                    }
            }
        },
        ci.prototype.selectComponent = function(e) {
            if (e !== this.selectedComponent && (this.blur(), this.unselectComponent(), this.selectedComponent = e, e)) {
                var t = "";
                e.el.addClass("selected"),
                e.popup && (t += '<div class="component-selector-tool button i-32-24 i-white i-setting-tool"></div>'),
                e.isWidthAdjustable() && (t += '<div class="component-selector-cr --ul-resize-right"></div>'),
                e.isHeightAdjustable() && (t += '<div class="component-selector-cb"></div>');
                $('<div class="component-selector">').html(t).prependTo(e.el);
                var i = e.el.offset().top,
                    o = i + e.el.outerHeight(),
                    n = this.el.offset().top,
                    s = n + this.el.height(),
                    a = this.el.scrollTop();
                o > s ? this.el.scrollTop(a + Math.min(i - n, o - s)) : i < n && this.el.scrollTop(a + (i - n))
            }
        },
        ci.prototype.blur = function() {
            T.each(this.tabs, (function(e) {
                e.blur()
            }))
        },
        ci.prototype.focus = function() {
            this.currentTab && this.currentTab.focus()
        },
        ci.prototype.unselectComponent = function(e) {
            this.selectedComponent && (this.selectedComponent.el.children(".component-selector").remove(), this.selectedComponent.el.removeClass("selected"), this.selectedComponent = void 0)
        },
        ci.prototype.resize = function() {
            var e = this.columns,
                t = this.calculateColumns();
            t !== e && (this.columns = t, this.columnsChanged()),
            T.each(this.tabs, (function(e) {
                e.resize()
            }))
        },
        ci.prototype.calculateColumns = function() {
            var e = ui.rightWidth;
            return e <= 320 ? 1 : e <= 480 ? 2 : 4
        },
        ci.prototype.columnsChanged = function() {
            T.each(this.tabs, (function(e) {
                e.columnsChanged()
            }))
        },
        ci.prototype.editorUp = function() {
            this.container.editorUp && this.container.editorUp()
        },
        ci.prototype.editorDown = function() {
            this.container.editorDown && this.container.editorDown()
        },
        ci.prototype.updateBackground = function(e) {
            this.container.updateBackground(e)
        },
        ci.prototype.openTab = function(e) {
            if (e) {
                var t = T.filter(this.tabs, (function(t) {
                    return t.field && t.field.caption === e
                }))[0];
                t && this.selectTab(t.id)
            }
        },
        fi.prototype.destroy = function() {
            database.off("rename", void 0, this.nodeRenamed, this),
            database.off("remove", void 0, this.nodeRemoved, this),
            database.off("schema", void 0, this.schemaChanged, this),
            database.off("admin", void 0, this.adminChanged, this),
            this.close(),
            this.el.remove()
        },
        fi.prototype.schemaChanged = function(e, t, i) {
            this.updateStructure()
        },
        fi.prototype.adminChanged = function(e, t) {
            this.updateStructure()
        },
        fi.prototype.isOnTop = function() {
            return !widgets.popupEditorStack.length
        },
        fi.prototype.open = function(e, t, i) {
            console.log("SideEditor.open", e);
            var o = this;
            if (this.editor && (this.editor.save(), this.lastSelectedTab = this.editor.getSelectedTab()), this.options = t || {}, !e)
                return this.close();
            var n = database.typeOf(e);
            if (!n)
                return this.close();
            this.nid = e;
            const s = xe();
            e !== s.nid && be(pi({}, s, {
                nid: e
            }));
            var a = this.opened;
            a || (this.opened = !0, ui.showRight()),
            this.editor && this.editor.type === n ? this.editor.selectTab(s.tabId && "default" !== s.tabId ? s.tabId : this.lastSelectedTab) : (this.editor && this.editor.destroy(), this.editor = new ci(this, n.id, !0, s.tabId && "default" !== s.tabId ? s.tabId : this.lastSelectedTab)),
            $.loading(!0),
            database.loadNode(e, (function(t, i) {
                $.loading(!1),
                e === o.nid && (i ? o.editor.bind(i) : o.close())
            })),
            !TOUCH && i && setTimeout((function() {
                o.editor && o.editor.focus()
            }), a ? 0 : 400),
            this.updateTools(),
            window.Appcues && window.Appcues.page()
        },
        fi.prototype.editorTabChanged = function(e) {
            const t = xe();
            t.tabId !== e && be(pi({}, t, {
                tabId: e
            }))
        },
        fi.prototype.close = function(e) {
            if (this.opened) {
                this.opened = !1,
                this.nid = void 0;
                var t = this.editor;
                this.editor = void 0,
                t && (t.save(), this.lastSelectedTab = t.getSelectedTab()),
                ui.hideRight((function() {
                    t && t.destroy()
                })),
                this.options.close && !e && this.options.close(),
                this.options = {},
                this.updateTools(),
                be(pi({}, xe(), {
                    nid: void 0,
                    tabId: void 0
                })),
                window.Appcues && window.Appcues.page()
            }
        },
        fi.prototype.isOpen = function() {
            return this.opened
        },
        fi.prototype.focus = function() {
            this.opened && this.editor && this.editor.focus()
        },
        fi.prototype.updateStructure = function() {
            var e = this;
            this.editor && (this.nid && database.typeOf(this.nid) ? (this.editor.updateStructure(), database.loadNode(this.nid, (function(t, i) {
                i && e.editor.bind(i)
            }))) : this.close());
            this.updateTools()
        },
        fi.prototype.updateTools = function() {
            database.adminMode && this.opened && this.isOnTop() ? this.showTools() : this.hideTools()
        },
        fi.prototype.showTools = function() {
            var e = this;
            function t() {
                var t = database.typeOf(e.getSelectedNid());
                if (t) {
                    var i = t.sorted,
                        o = 0,
                        n = e.editor && e.editor.currentTab && e.editor.currentTab.field;
                    n && (o = i.indexOf(n) + 1);
                    for (var s = o; s < i.length; s++) {
                        var a = i[s];
                        if ("tab" === a.base)
                            return a.order - .5
                    }
                }
            }
            this.$tools || (this.$tools = $("<div>").appendTo(this.el)),
            n.render(a.createElement(li, {
                addFunction: function(i) {
                    Object(l.f)("Form", "CreateFunction");
                    var o = t(),
                        n = database.typeOf(e.getSelectedNid());
                    if (!n)
                        return;
                    new ft.a({
                        schema: n.schema,
                        type: n,
                        okay: function(t, i) {
                            if (t && i) {
                                Object(l.f)("Form", "CreateFunctionConfirm");
                                var s = n.schema.createField2(n, {
                                    order: o,
                                    caption: n.createNewFieldName("fn"),
                                    base: "fn",
                                    fn: t
                                }, !1, !0);
                                e.editor.selectComponentByUUID(s.uuid, !0)
                            }
                        }
                    })
                },
                addSubTable: function(i) {
                    Object(l.f)("Form", "CreateSubTable");
                    var o = t(),
                        n = database.schema.clone(),
                        s = n.typeOf(e.getSelectedNid());
                    if (!s)
                        return;
                    var a = n.createType(),
                        r = void 0;
                    new _t({
                        schema: n,
                        schemaDirty: !0,
                        isNewType: !0,
                        type: a.id,
                        beforeSaveType: function() {
                            var e = s.caption;
                            for (let t = 2; a.findElement(e); t++)
                                e = s.caption + t;
                            var t = a.caption;
                            for (let i = 2; s.findElement(t) || a === s && e === t; i++)
                                t = a.caption + i;
                            var i = n.createReference(a, e, s, t, !0, void 0, void 0, void 0, void 0, void 0, o, !1);
                            r = i.reverse.uuid
                        },
                        afterSaveType: function() {
                            r && e.editor.selectComponentByUUID(r)
                        }
                    })
                },
                editFields: function(t) {
                    Object(l.f)("Form", "EditFields");
                    var i = database.typeOf(e.getSelectedNid());
                    if (!i)
                        return;
                    new _t({
                        type: i.id
                    })
                },
                onCreateField: function(i) {
                    Object(l.f)("Form", "CreateField", {
                        fieldType: i
                    });
                    var o = i,
                        n = void 0,
                        s = void 0,
                        a = void 0;
                    "string_multiline" === o ? (o = "string", n = !0) : "signature" === o && (o = "file", s = "signature", a = locale.signature);
                    var r = t(),
                        c = database.typeOf(e.getSelectedNid());
                    if (!c)
                        return;
                    var d = c.createNewFieldName(o, a),
                        h = c.schema.createField2(c, {
                            base: o,
                            order: r,
                            caption: d,
                            stringMultiline: n,
                            fileHandling: s
                        }, !1, !0);
                    e.editor.selectComponentByUUID(h.uuid, !0)
                },
                onCreateReference: function(i) {
                    Object(l.f)("Form", "CreateReference");
                    var o = t(),
                        n = database.typeOf(e.getSelectedNid());
                    if (!n)
                        return;
                    var s = i.id,
                        a = database.schema.types[s];
                    if (!a)
                        return;
                    var r = a.caption;
                    for (let e = 2; n.findElement(r); e++)
                        r = a.caption + e;
                    var c = n.caption;
                    for (let e = 2; a.findElement(c) || n === a && r === c; e++)
                        c = n.caption + e;
                    var d = n.schema.createReference(n, r, a, c, !1, void 0, void 0, void 0, void 0, o, void 0, !1);
                    e.editor.selectComponentByUUID(d.uuid, !0)
                },
                onCreateReverse: function(i) {
                    Object(l.f)("Form", "CreateReverse");
                    var o = t(),
                        n = database.typeOf(e.getSelectedNid());
                    if (!n)
                        return;
                    var s = i.id,
                        a = database.schema.types[s];
                    if (!a)
                        return;
                    var r = n.caption;
                    for (let e = 2; a.findElement(r); e++)
                        r = n.caption + e;
                    var c = a.caption;
                    for (let e = 2; n.findElement(c) || a === n && r === c; e++)
                        c = a.caption + e;
                    var d = a.schema.createReference(a, r, n, c, !1, void 0, void 0, void 0, void 0, void 0, o, !1);
                    e.editor.selectComponentByUUID(d.reverse.uuid)
                },
                database: database,
                onCreateUI: function(i) {
                    Object(l.f)("Form", "LayoutElement", {
                        fieldType: i
                    });
                    var o = "tab" === i ? void 0 : t(),
                        n = database.typeOf(e.getSelectedNid());
                    if (!n)
                        return;
                    var s = locale.types[i],
                        a = n.schema.createUI(n, s, o, i, void 0, !1, !0);
                    e.editor.selectComponentByUUID(a.uuid, "head" === i || "button" === i)
                }
            }), this.$tools[0])
        },
        fi.prototype.hideTools = function() {
            this.$tools && (n.unmountComponentAtNode(this.$tools[0]), this.$tools.remove(), this.$tools = void 0)
        },
        fi.prototype.nodeRemoved = function(e, t) {
            t === this.nid && this.close()
        },
        fi.prototype.nodeRenamed = function(e, t, i) {
            t === this.nid && this.setNid(i)
        },
        fi.prototype.setNid = function(e) {
            this.opened && this.open(e, this.options)
        },
        fi.prototype.remove = function() {
            var e = this,
                t = this.nid,
                i = database.typeOf(t);
            if (!database.canDelete(i))
                return $.alert(locale.errorNotAuthorized);
            $.dialog({
                closable: !0,
                caption: locale.remove,
                message: locale.confirmRemove,
                buttons: [{
                    color: "red",
                    caption: locale.remove,
                    callback: function() {
                        database.remove(t, (function(t) {
                            if (t)
                                return $.alert(t);
                            e.open(void 0)
                        }))
                    }
                }]
            })
        },
        fi.prototype.print = function() {
            this.nid && (window.reports ? reports.openDesigner({
                nid: this.nid,
                nids: this.options.getSelectedNids ? this.options.getSelectedNids() : []
            }) : Object(N.a)(this.nid))
        },
        fi.prototype.prev = function() {
            this.options.prev && this.options.prev()
        },
        fi.prototype.next = function() {
            this.options.next && this.options.next()
        },
        fi.prototype.first = function() {
            this.options.first && this.options.first()
        },
        fi.prototype.last = function() {
            this.options.last && this.options.last()
        },
        fi.prototype.popup = function(e) {
            var t = this,
                i = t.nid,
                o = database.typeOf(i);
            if (o) {
                var n = $.backplane({}),
                    s = $('<div class="nx-menu-popup" style="border-radius:4px">').appendTo(n);
                database.authorizationPrint && $('<div class="nx-menu-item">').append($('<div class="nx-menu-label">').text(locale.print + "...")).appendTo(s).click((function() {
                    n.close(),
                    t.print()
                })),
                this.options.duplicate && database.canCreate(o) && $('<div class="nx-menu-item">').append($('<div class="nx-menu-label">').text(locale.duplicate)).appendTo(s).click((function() {
                    n.close(),
                    t.options.duplicate()
                })),
                database.canDelete(o) && $('<div class="nx-menu-item">').append($('<div class="nx-menu-label">').text(locale.remove)).appendTo(s).click((function() {
                    n.close(),
                    t.remove()
                })),
                $("<hr>").appendTo(s),
                $('<div class="nx-menu-item">').append($('<div class="nx-menu-label">').text(locale.close)).appendTo(s).click((function() {
                    n.close(),
                    t.close()
                }));
                var a = s.outerWidth(),
                    r = s.outerHeight(),
                    l = $(e.target).offset();
                l.top += 32,
                l.left + a > window.getWidth() && (l.left = window.getWidth() - a),
                l.top + r > window.getHeight() && (l.top = window.getHeight() - r),
                s.offset(l)
            }
        },
        fi.prototype.resize = function() {
            this.editor && this.editor.resize(),
            this.updateTools()
        },
        fi.prototype.editorUp = function() {
            this.prev()
        },
        fi.prototype.editorDown = function() {
            this.next()
        },
        fi.prototype.updateBackground = function(e) {
            var t = util.luminosity(e) < .5;
            this.el.css("background-color", e || ""),
            this.el.toggleClass("darkmode", t)
        },
        fi.prototype.getSelectedNid = function() {
            return this.nid
        },
        fi.prototype.openTab = function(e) {
            this.editor.openTab(e)
        },
        vi.prototype.isOnTop = function() {
            return widgets.popupEditorStack[widgets.popupEditorStack.length - 1] === this
        },
        vi.prototype.showTools = fi.prototype.showTools,
        vi.prototype.hideTools = fi.prototype.hideTools,
        vi.prototype.updateTools = function() {
            database.adminMode && !this.isClosed && this.isOnTop() ? this.showTools() : this.hideTools()
        },
        vi.prototype.setNid = function(e) {
            var t = this;
            this.nid = e,
            database.loadNode(e, (function(e, i) {
                i && t.editor.bind(i)
            }))
        },
        vi.prototype.keydown = function(e) {
            if (!($(e.target).closest(".contenteditable").length > 0) && "textarea" !== e.target.localName && "input" !== e.target.localName)
                switch (e.which) {
                case 27:
                    this.close(),
                    e.preventDefault();
                    break;
                case 38:
                    this.options.prev && this.options.prev(),
                    e.preventDefault();
                    break;
                case 40:
                    this.options.next && this.options.next(),
                    e.preventDefault()
                }
        },
        vi.prototype.close = function() {
            var e = this;
            if (!this.isClosed) {
                this.isClosed = !0,
                this.hideTools(),
                widgets.popupEditorStack.pop();
                var t = ui.rightWidth;
                ui.fullWidth < 640 && (t = ui.fullWidth),
                this.el[0].style.transform = this.el[0].style.WebkitTransform = "translateX(" + t + "px)",
                ui.recordNavigation.popController(this.recordController),
                database.off("rename", void 0, this.nodeRenamed, this),
                database.off("remove", void 0, this.nodeRemoved, this),
                database.off("schema", void 0, this.schemaChanged, this),
                database.off("admin", void 0, this.adminChanged, this),
                $.popInputHandler(this),
                setTimeout((function() {
                    e.editor && e.editor.destroy(),
                    e.$backplane.remove(),
                    e.options.close && e.options.close()
                }), 400),
                gi(),
                mi()
            }
        },
        vi.prototype.nodeRenamed = function(e, t, i) {
            t === this.nid && this.setNid(i)
        },
        vi.prototype.nodeRemoved = function(e, t) {
            t === this.nid && this.close()
        },
        vi.prototype.schemaChanged = function(e, t, i) {
            this.updateStructure()
        },
        vi.prototype.adminChanged = function(e, t) {
            this.updateStructure()
        },
        vi.prototype.updateStructure = function() {
            var e = this;
            database.typeOf(this.nid) && (this.editor.updateStructure(), database.loadNode(this.nid, (function(t, i) {
                i ? e.editor.bind(i) : this.close()
            })), this.updateTools())
        },
        vi.prototype.remove = function() {
            var e = this;
            return $.dialog({
                closable: !0,
                caption: locale.remove,
                message: locale.confirmRemove,
                buttons: [{
                    color: "red",
                    caption: locale.remove,
                    callback: function() {
                        e.close(),
                        database.remove(e.nid, (function(e) {
                            if (e)
                                return $.alert(e)
                        }))
                    }
                }]
            }), !1
        },
        vi.prototype.print = function() {
            this.nid && (window.reports ? reports.openDesigner({
                nid: this.nid,
                nids: this.options.getSelectedNids && this.options.getSelectedNids()
            }) : Object(N.a)(this.nid))
        },
        vi.prototype.popup = function(e) {
            var t = this,
                i = t.nid,
                o = database.typeOf(i);
            if (o) {
                var n = $.backplane({}),
                    s = $('<div class="nx-menu-popup" style="border-radius:4px">').appendTo(n);
                database.authorizationPrint && $('<div class="nx-menu-item">').append($('<div class="nx-menu-label">').text(locale.print + "...")).appendTo(s).click((function() {
                    n.close(),
                    t.print()
                })),
                t.options.unlink && $('<div class="nx-menu-item">').append($('<div class="nx-menu-label">').text(locale.unlink)).appendTo(s).click((function() {
                    n.close(),
                    t.options.unlink()
                })),
                t.options.duplicate && database.canCreate(o) && $('<div class="nx-menu-item">').append($('<div class="nx-menu-label">').text(locale.duplicate)).appendTo(s).click((function() {
                    n.close(),
                    t.options.duplicate(t)
                })),
                database.canDelete(o) && $('<div class="nx-menu-item">').append($('<div class="nx-menu-label">').text(locale.remove)).appendTo(s).click((function() {
                    n.close(),
                    t.remove()
                }));
                var a = s.outerWidth(),
                    r = s.outerHeight(),
                    l = $(e.target).offset();
                l.top += 40,
                l.left + a > window.getWidth() && (l.left = window.getWidth() - a),
                l.top + r > window.getHeight() && (l.top = window.getHeight() - r),
                s.offset(l)
            }
        },
        vi.prototype.updateBackground = function(e) {
            var t = util.luminosity(e) < .5;
            this.el.css("background-color", e || ""),
            this.el.toggleClass("darkmode", t)
        },
        vi.prototype.menuNextRecordEnabled = function() {
            return !!this.options.next
        },
        vi.prototype.menuNextRecord = function() {
            this.options.next && this.options.next()
        },
        vi.prototype.menuPrevRecordEnabled = function() {
            return !!this.options.prev
        },
        vi.prototype.menuPrevRecord = function() {
            this.options.prev && this.options.prev()
        },
        vi.prototype.menuFirstRecordEnabled = function() {
            return !!this.options.first
        },
        vi.prototype.menuFirstRecord = function() {
            this.options.first && this.options.first()
        },
        vi.prototype.menuLastRecordEnabled = function() {
            return !!this.options.last
        },
        vi.prototype.menuLastRecord = function() {
            this.options.last && this.options.last()
        },
        vi.prototype.menuCreateRecordEnabled = function() {
            var e = database.typeOf(this.nid);
            return !!(this.options.create && e && database.canCreate(e))
        },
        vi.prototype.menuCreateRecord = function() {
            this.options.create && this.options.create()
        },
        vi.prototype.menuDuplicateRecordEnabled = function() {
            var e = database.typeOf(this.nid);
            return !!(this.options.duplicate && e && database.canCreate(e))
        },
        vi.prototype.menuDuplicateRecord = function() {
            this.options.duplicate && this.options.duplicate()
        },
        vi.prototype.menuDeleteRecordEnabled = function() {
            var e = database.typeOf(this.nid);
            return !(!e || !database.canDelete(e))
        },
        vi.prototype.menuDeleteRecord = function() {
            this.remove()
        },
        vi.prototype.menuPrintRecordEnabled = function() {
            return !!database.authorizationPrint
        },
        vi.prototype.menuPrintRecord = function() {
            this.print()
        },
        vi.prototype.menuUnlinkRecordEnabled = function() {
            return !!this.options.unlink
        },
        vi.prototype.menuUnlinkRecord = function() {
            this.options.unlink && this.options.unlink()
        },
        vi.prototype.menuCloseRecordEnabled = function() {
            return !0
        },
        vi.prototype.menuCloseRecord = function() {
            this.close()
        },
        vi.prototype.getSelectedNid = function() {
            return this.nid
        },
        vi.prototype.editorDown = function() {
            this.editor.save(),
            this.options.next && this.options.next()
        },
        vi.prototype.editorUp = function() {
            this.editor.save(),
            this.options.prev && this.options.prev()
        };
        class yi {
            constructor(e, t, i, o, n)
            {
                K()(this, "isActive", !0),
                K()(this, "valueModel", void 0),
                K()(this, "valueField", void 0),
                K()(this, "functionModel", void 0),
                K()(this, "operandModel", void 0),
                K()(this, "operandField", void 0),
                K()(this, "colorModel", void 0),
                K()(this, "colorField", void 0),
                K()(this, "backgroundModel", void 0),
                K()(this, "backgroundField", void 0),
                K()(this, "cellModel", void 0),
                K()(this, "cellField", void 0),
                K()(this, "iconModel", void 0),
                K()(this, "iconField", void 0),
                K()(this, "$el", void 0),
                K()(this, "$valueFieldContainer", void 0),
                K()(this, "tempCol", {}),
                this.$el = $('<div class="conditional-styling-rule">').data("rule", this).appendTo(o);
                let s = {};
                "number" === n ? (this.valueModel = new b.util.SimpleModel(new b.schemas.TNumber(void 0, void 0, {
                    caption: Object(b.getLocale)().value,
                    formWidth: 1
                }), i.value || 0), s = {
                    "=": {
                        id: "=",
                        caption: "="
                    },
                    "!=": {
                        id: "!=",
                        caption: "!="
                    },
                    "<": {
                        id: "<",
                        caption: "<"
                    },
                    "<=": {
                        id: "<=",
                        caption: "<="
                    },
                    ">": {
                        id: ">",
                        caption: ">"
                    },
                    ">=": {
                        id: ">=",
                        caption: ">="
                    },
                    "f(x)": {
                        id: "f(x)",
                        caption: "f(x)"
                    }
                }) : "string" === n && (this.valueModel = new b.util.SimpleModel(new b.schemas.TString(void 0, void 0, {
                    caption: Object(b.getLocale)().value,
                    formWidth: 1
                }), i.value || ""), s = {
                    "=": {
                        id: "=",
                        caption: "="
                    },
                    "!=": {
                        id: "!=",
                        caption: "!="
                    },
                    startsWith: {
                        id: "startsWith",
                        caption: Object(b.getLocale)().startsWith
                    },
                    endsWith: {
                        id: "endsWith",
                        caption: Object(b.getLocale)().endsWith
                    },
                    contains: {
                        id: "contains",
                        caption: Object(b.getLocale)().op_contains
                    },
                    "f(x)": {
                        id: "f(x)",
                        caption: "f(x)"
                    }
                }),
                this.operandModel = new b.util.SimpleModel(new b.schemas.TChoice(void 0, void 0, {
                    required: !0,
                    values: s,
                    caption: Object(b.getLocale)().operator,
                    formWidth: 1
                }), i.operand || "="),
                this.operandModel.on("update", this.onOperandValueChange, this),
                this.tempCol.expression = i.value,
                this.functionModel = new b.schemas.ExpressionModel(this.tempCol, "expression", void 0, e, Object(b.getLocale)().function),
                this.functionModel.field.formWidth = 1,
                this.valueModel.field.formWidth = 1,
                this.operandField = new Ue.a(void 0, this.operandModel, $('<div style="width:80px">').appendTo(this.$el), {
                    cls: "conditional-styling-rule-part"
                }),
                this.$valueFieldContainer = $('<span style="width: 25%">').appendTo($('<div style="width:120px;flex:1 0 auto;-webkit-flex:1 0 auto">').appendTo(this.$el)),
                this.valueField = new Ue.a(this, this.valueModel, this.$valueFieldContainer, {
                    cls: "conditional-styling-rule-part"
                }),
                this.onOperandValueChange(),
                this.colorModel = new b.util.SimpleModel(new b.schemas.TColor(void 0, void 0, {
                    caption: Object(b.getLocale)().text,
                    formWidth: 1
                }), i.color),
                this.colorField = new Ue.a(this, this.colorModel, $('<div style="width:80px">').appendTo(this.$el), {
                    cls: "conditional-styling-rule-part"
                }),
                this.backgroundModel = new b.util.SimpleModel(new b.schemas.TColor(void 0, void 0, {
                    caption: Object(b.getLocale)().background,
                    formWidth: 1
                }), i.background),
                this.backgroundField = new Ue.a(this, this.backgroundModel, $('<div style="width:80px">').appendTo(this.$el), {
                    cls: "conditional-styling-rule-part"
                }),
                this.cellModel = new b.util.SimpleModel(new b.schemas.TColor(void 0, void 0, {
                    caption: Object(b.getLocale)().cellBackground || "Cell",
                    formWidth: 1
                }), i.cell),
                this.cellField = new Ue.a(this, this.cellModel, $('<div style="width:80px">').appendTo(this.$el), {
                    cls: "conditional-styling-rule-part"
                }),
                this.iconModel = new b.util.SimpleModel(new b.schemas.TIcon(void 0, void 0, {
                    caption: Object(b.getLocale)().icon,
                    formWidth: 1
                }), i.icon),
                this.iconField = new Ue.a(this, this.iconModel, $('<div style="width:80px">').appendTo(this.$el), {
                    cls: "conditional-styling-rule-part"
                });
                const a = $('<div class="conditional-styling-rule-icon-container">').appendTo(this.$el);
                $('<div class="i-32-24 i-light-grey i-setting-trash">').click(() => {
                    this.isActive = !1,
                    this.destroy()
                }).appendTo(a),
                $('<div class="i-24-24 i-lighter-grey i-drag-handle">').appendTo(a)
            }
            destroy()
            {
                this.operandField.destroy(),
                this.iconField.destroy(),
                this.backgroundField.destroy(),
                this.colorField.destroy(),
                this.valueField.destroy(),
                this.$el.remove()
            }
            getRule()
            {
                let e;
                return "f(x)" === this.operandModel.value ? this.tempCol.expression && (e = this.tempCol.expression) : e = this.valueModel.value, {
                    background: this.backgroundModel.value,
                    color: this.colorModel.value,
                    cell: this.cellModel.value,
                    value: e,
                    operand: this.operandModel.value,
                    icon: this.iconModel.value
                }
            }
            onOperandValueChange()
            {
                "f(x)" === this.operandModel.value ? this.onFunctionSelect() : this.onOutOfFunctionSelect()
            }
            onFunctionSelect()
            {
                this.valueField.destroy(),
                this.valueField = new Ue.a(this, this.functionModel, this.$valueFieldContainer, void 0)
            }
            onOutOfFunctionSelect()
            {
                this.valueField.destroy(),
                this.valueField = new Ue.a(this, this.valueModel, this.$valueFieldContainer, void 0)
            }
        }
        class wi {
            constructor(e, t, i, o)
            {
                K()(this, "$popDown", void 0),
                K()(this, "col", void 0),
                K()(this, "rules", []),
                K()(this, "onSave", void 0),
                K()(this, "tableType", void 0),
                K()(this, "createRule", (e, t) => new yi(this.tableType, this.col, e, this.$popDown.$content, t)),
                this.tableType = e,
                this.onSave = i,
                this.col = t;
                const n = this.col.conditionalStyling ? this.col.conditionalStyling : [];
                this.$popDown = window.$.popdown({
                    cls: "xlarge",
                    head: Object(b.getLocale)().conditionalStyling,
                    buttons: [{
                        caption: Object(b.getLocale)().cancel,
                        click: () => this.destroy()
                    }, "-", {
                        cls: "blue",
                        caption: Object(b.getLocale)().addRule,
                        click: () => {
                            this.rules.push(this.createRule({}, o))
                        }
                    }, " ", {
                        cls: "blue",
                        caption: Object(b.getLocale)().okay,
                        click: () => {
                            this.save(),
                            this.destroy()
                        }
                    }]
                });
                for (const e of n)
                    this.rules.push(this.createRule(e, o));
                this.$popDown.$content.css({
                    maxHeight: window.getHeight() / 2 + "px",
                    overflowY: "auto"
                }),
                this.$popDown.$content.sortable({
                    handle: ".i-drag-handle"
                })
            }
            destroy()
            {
                for (const e of this.rules)
                    e.destroy();
                this.$popDown.close()
            }
            save()
            {
                const e = [];
                for (const t of this.$popDown.$content.children()) {
                    const i = $(t).data("rule");
                    i.isActive && e.push(i.getRule())
                }
                this.onSave(e)
            }
        }
        function xi(e, t, i) {
            if (e) {
                const o = Math.max(t, i) - e.length + 1;
                if (o > 0)
                    for (let t = 0; t < o; t++)
                        e.push(void 0);
                const n = e[t];
                e.splice(t, 1),
                e.splice(i, 0, n)
            }
        }
        function Ti(e, t, i) {
            this.rowHeight = 40,
            this.headHeight = 40,
            this.footHeight = 40,
            this.container = e,
            this.tab = t,
            this.field = i,
            this.visible = !0,
            this.reverseRenderer = i.reverseRenderer,
            this.cachedViewConfig = util.getPersistentViewConfig(i.viewConfig),
            this.query = this.createQuery(),
            this.popupEditor = null,
            this.minRows = 0,
            this.maxRows = i.height,
            this.ridxTop = 0,
            this.scrollTop = 0,
            this.scrollLeft = 0,
            this.scrollDoneTimeout = null,
            this.scrollDoneTime = 0,
            this.scrollDone = $.proxy(this.scrollDone, this),
            this.viewWidth = 0,
            this.viewRows = [],
            this.el = $('<div class="component editor editor-list editor-4col">').data("component", this).attr("title", i.tooltip || ""),
            this.updateElementWidth(),
            this.el.appendTo(t.el),
            this.label = $("<label>").text(i.caption || locale.unnamed).appendTo(this.el),
            this.$list = $('<div class="list">').appendTo(this.el).touch($.proxy(this.click, this)).on("contextmenu", $.proxy(this.contextmenu, this)),
            this.$controls = $('<div class="list-controls">').appendTo(this.el),
            this.$find = $('<div class="list-button"><div class="i-32-16 i-light-grey i-search"></div><span>' + htmlEscape(locale.addRowFind) + "</span></div>").appendTo(this.$controls).touch($.proxy(this.addRowFind, this)),
            this.$create = $('<div class="list-button"><div class="i-32-16 i-light-grey i-plus"></div><span>' + htmlEscape(locale.addRowCreate) + "</span></div>").appendTo(this.$controls).touch($.proxy(this.addRowCreate, this)),
            this.$container = $DIV("t-container", this.$list[0]),
            this.$head = $DIV("t-head", this.$container),
            this.$foot = $DIV("t-foot", this.$container),
            this.$foot.style.zIndex = 1,
            this.$body = $DIV("t-body", this.$container),
            this.$content = $DIV("t-content", this.$body),
            this.$view = $DIV("t-view", this.$content),
            this.$headCells = [],
            this.$footCells = [],
            this.$scrollbarVContainer = $DIV("t-scrollbar-v-container", this.$container),
            this.$scrollbarV = $DIV("t-scrollbar-v", this.$scrollbarVContainer),
            this.$scrollbarHContainer = $DIV("t-scrollbar-h-container", this.$container),
            this.$scrollbarHContainer.style.left = 0,
            this.$scrollbarHContainer.style.bottom = 0,
            this.$scrollbarH = $DIV("t-scrollbar-h", this.$scrollbarHContainer),
            this.$scrollVIndicator = $DIV("t-scroll-v-indicator", this.$container),
            this.registerScrollListeners(),
            this.registerHeadResizeListeners(),
            this.registerHeadDragListeners(),
            this.rebalanceColumns(),
            this.updateTable(),
            this.updateButtons(),
            database.on("rename", void 0, this.nodeRenamed, this)
        }
        Object.assign(Ti.prototype, Ot.a.prototype),
        Ti.prototype.createQuery = function() {
            return new queries.QueryReverse(database, this.field, void 0)
        },
        Ti.prototype.updateStructure = function() {
            var e = this.field;
            this.el.attr("title", e.tooltip || ""),
            this.updateElementWidth(),
            this.label.text(e.caption || locale.unnamed),
            this.maxRows = e.height,
            this.queryNeedsUpdate() && (this.query = this.createQuery(), this.rebalanceColumns(), this.updateTable()),
            this.reload()
        },
        Ti.prototype.queryNeedsUpdate = function() {
            return util.viewConfigEquals(this.field.viewConfig, this.cachedViewConfig) ? !(!this.query || this.field == this.query.field) : (this.cachedViewConfig = util.getPersistentViewConfig(this.field.viewConfig), !0)
        },
        Ti.prototype.destroy = function() {
            database.off("rename", void 0, this.nodeRenamed, this),
            this.el.remove()
        },
        Ti.prototype.nodeChanged = function() {
            this.updateIsWritable(),
            this.updateVisibility(),
            this.reload(),
            this.updateButtons()
        },
        Ti.prototype.reload = function() {
            if (this.query) {
                var e = this;
                e.nid = e.container.nid,
                e.query.nid = e.container.nid,
                e.query.load((function() {
                    e.updateAll()
                }))
            }
        },
        Ti.prototype.updateAll = function() {
            this.updateHeight(),
            this.updateHead(),
            this.updateFoot(),
            this.updateRows(),
            this.updateButtons()
        },
        Ti.prototype.saveConfigIfAdminMode = function() {
            Object(Bt.b)() && this.saveConfig()
        },
        Ti.prototype.saveConfig = function() {
            this.query && (this.field.viewConfig = util.getPersistentViewConfig(this.query.getConfig()), this.cachedViewConfig = util.clone(this.field.viewConfig), this.field.type.schema.trigger("change"))
        },
        Ti.prototype.addRowFind = function() {
            if (this.query) {
                var e = this;
                if (!this.isWritable())
                    return $.alert(locale.errorNotAuthorized);
                if (!database.canWrite(e.field.reference))
                    return $.alert(locale.errorNotAuthorized);
                var t = database.canCreate(e.field.refType);
                new $i(e.nid, e.field, {
                    viewConfig: e.query.getConfig(),
                    select: function(t) {
                        database.update(t, e.field.refFieldId, database.ridOf(e.nid), (function(e) {
                            e && $.alert(e)
                        }))
                    },
                    create: t ? function() {
                        e.addRowCreate()
                    } : void 0
                })
            }
        },
        Ti.prototype.addRowCreate = function() {
            var e = this;
            if (!this.isWritable())
                return $.alert(locale.errorNotAuthorized);
            if (!database.canCreate(e.field.refType))
                return $.alert(locale.errorNotAuthorized);
            if (!database.canWrite(e.field.reference))
                return $.alert(locale.errorNotAuthorized);
            var t = {};
            t[e.field.refFieldId] = database.ridOf(e.nid),
            database.create(e.field.refType, t, (function(t, i) {
                if (t)
                    return $.alert(t);
                e.select(i._id, !0)
            }))
        },
        Ti.prototype.contextmenu = function(e) {
            if (this.query) {
                e.preventDefault();
                var t = $(e.target),
                    i = t.closest(".t-head-cell");
                if (i.length) {
                    null != (n = i.attr("data-cidx")) ? this.popupColumnMenu(parseInt(n), e) : this.popupAddColumnMenu(e)
                } else {
                    var o = t.closest(".t-foot-cell");
                    if (o.length) {
                        var n;
                        null != (n = o.attr("data-cidx")) ? this.popupColumnMenu(parseInt(n), e) : this.popupAddColumnMenu(e)
                    } else {
                        var s = t.closest(".t-row");
                        if (s.length) {
                            var a = parseInt(s.attr("data-ridx")) + this.ridxTop,
                                r = this.query.rows[a];
                            r && (this.query.groups[r] || this.popupRowMenu(r, e))
                        }
                    }
                }
            }
        },
        Ti.prototype.popupRowMenu = function(e, t) {
            if (!TOUCH) {
                this.field;
                var i = this.canUnlink(),
                    o = this.canRemove();
                if (i || o) {
                    var n = this,
                        s = $.backplane({}),
                        a = $('<div class="nx-menu-popup" style="border-radius:4px">').appendTo(s);
                    o && $('<div class="nx-menu-item">').append($('<div class="nx-menu-label">').text(locale.removeRecord)).appendTo(a).touch((function() {
                        s.close(),
                        database.remove(e, (function(e) {
                            e && $.alert(e)
                        }))
                    })),
                    i && $('<div class="nx-menu-item">').append($('<div class="nx-menu-label">').text(locale.unlink)).appendTo(a).touch((function() {
                        s.close(),
                        n.unlinkFrom(e)
                    }));
                    var r = a.outerWidth(),
                        l = a.outerHeight(),
                        c = {
                            left: t.clientX,
                            top: t.clientY
                        };
                    return c.left + r > window.getWidth() && (c.left = window.getWidth() - r), c.top + l > window.getHeight() && (c.top = window.getHeight() - l), a.offset(c), !1
                }
            }
        },
        Ti.prototype.click = function(e) {
            if (this.query) {
                var t = $(e.target),
                    i = t.closest(".t-cell-button").attr("data-action");
                if ("find" !== i)
                    if ("create" !== i) {
                        var o = t.closest(".t-row");
                        if (o.length) {
                            var n = parseInt(o.attr("data-ridx")) + this.ridxTop,
                                s = this.query.rows[n];
                            s && (this.query.groups[s] ? (this.query.toggleGroup(s), this.updateHeight(), this.updateRows()) : this.select(s))
                        }
                    } else
                        this.addRowCreate();
                else
                    this.addRowFind()
            }
        },
        Ti.prototype.touchHead = function(e) {
            var t = $(e.target).closest(".t-head-cell");
            if (t.length) {
                var i = t.attr("data-cidx");
                null != i ? this.popupColumnMenu(parseInt(i), e) : this.popupAddColumnMenu(e)
            }
        },
        Ti.prototype.select = function(e, t) {
            if (this.query && e !== this.query.nidSelected) {
                var i = this;
                this.query.nidSelected = e,
                this.updateRows();
                var o = {};
                this.field.isComposition && (o[this.field.refFieldId] = !0),
                e ? this.popupEditor ? this.popupEditor.setNid(e) : this.field.isComposition ? this.popupEditor = new vi(e, {
                    hideFields: o,
                    editMode: !0 === t,
                    close: function() {
                        i.popupEditor = null,
                        i.unselect()
                    },
                    duplicate: function() {
                        i.duplicate()
                    },
                    prev: function() {
                        i.selectPrev()
                    },
                    next: function() {
                        i.selectNext()
                    },
                    getSelectedNids: function() {
                        return i.getSelectedNids()
                    },
                    create: function() {
                        i.addRowCreate()
                    }
                }) : this.popupEditor = new vi(e, {
                    hideFields: o,
                    editMode: !0 === t,
                    unlink: function() {
                        i.unlink()
                    },
                    close: function() {
                        i.popupEditor = null,
                        i.unselect()
                    },
                    duplicate: function(e) {
                        i.duplicate(e)
                    },
                    prev: function() {
                        i.selectPrev()
                    },
                    next: function() {
                        i.selectNext()
                    },
                    getSelectedNids: function() {
                        return i.getSelectedNids()
                    },
                    create: function() {
                        i.addRowCreate()
                    }
                }) : this.popupEditor && (this.popupEditor.close(), this.popupEditor = null)
            }
        },
        Ti.prototype.unlink = function() {
            if (this.query) {
                var e = this.query.nidSelected;
                e && (this.unselect(), this.unlinkFrom(e))
            }
        },
        Ti.prototype.unlinkFrom = function(e) {
            this.canUnlink() && database.update(e, this.field.refFieldId, null, (function(e) {
                e && $.alert(e)
            }))
        },
        Ti.prototype.selectPrev = function() {
            if (this.query) {
                var e = this.query.nidSelected;
                if (e) {
                    var t = this.query.rows.indexOf(e),
                        i = t > 0 ? this.query.rows[t - 1] : 0 === t ? this.query.rows[this.query.rows.length - 1] : void 0;
                    i && this.select(i)
                }
            }
        },
        Ti.prototype.selectNext = function() {
            if (this.query) {
                var e = this.query.nidSelected;
                if (e) {
                    var t = this.query.rows.indexOf(e),
                        i = t < 0 ? void 0 : t < this.query.rows.length - 1 ? this.query.rows[t + 1] : this.query.rows[0];
                    i && this.select(i)
                }
            }
        },
        Ti.prototype.getSelectedNids = function() {
            if (!this.query)
                return [];
            for (var e = this.query.rows, t = this.query.models, i = [], o = 0; o < e.length; o++) {
                var n = e[o];
                t[n] && i.push(n)
            }
            return i
        },
        Ti.prototype.duplicate = function() {
            if (this.query) {
                var e = this,
                    t = e.query.nidSelected;
                t && database.duplicate(t, (function(t, i) {
                    if (t)
                        return $.alert(t);
                    e.select(i, !0)
                }))
            }
        },
        Ti.prototype.unselect = function() {
            this.select(null)
        },
        Ti.prototype.bind = function(e) {
            if (this.query) {
                e && (this.updateIsWritable(), this.updateVisibility(), this.nid = e._id, this.query.nid = e._id, this.reload())
            }
        },
        Ti.prototype.updateTable = function() {
            this.updateHeight(),
            this.createCells(),
            this.updateHead(),
            this.updateFoot(),
            this.updateRows(),
            this.resizeColumns(),
            this.scroll(!0, !1)
        },
        Ti.prototype.updateHeight = function() {
            var e = this.query ? this.query.rows : [],
                t = this.minRows,
                i = this.maxRows,
                o = this.hasFooter(),
                n = Math.max(t, Math.min(i, e.length)),
                s = Math.max(0, n * (this.rowHeight + 0) + this.headHeight + (o ? this.footHeight : 0)) + 1;
            this.$list.css({
                height: s
            })
        },
        Ti.prototype.hasFooter = function() {
            if (!this.query)
                return !1;
            for (var e = this.query.cols, t = !1, i = 0; i < e.length; i++) {
                e[i].agg && (t = !0)
            }
            return t
        },
        Ti.prototype.createCells = function() {
            var e = this.$head,
                t = this.$foot,
                i = this.$view,
                o = (this.$body, this.$headCells = []),
                n = this.$footCells = [],
                s = this.query ? this.query.cols : [],
                a = this.maxRows;
            $EMPTY(e),
            $EMPTY(t),
            $EMPTY(i);
            for (var r = 0; r < s.length; r++) {
                var l = s[r],
                    c = $DIV("t-head-cell", e, {
                        "data-cidx": r
                    });
                $DIV("t-head-resizer", c),
                $EL("span", c).innerHTML = htmlEscape(l.caption || l.expression.caption),
                o[r] = c;
                var d = $DIV("t-foot-cell t-foot-cell-" + l.field.base, t, {
                    "data-cidx": r
                });
                n[r] = d
            }
            for (var h = a + 20, p = [], u = 0; u < h; u++) {
                var f = $DIV("t-row", i, {
                    "data-ridx": u
                });
                f.style.top = 40 * u + "px";
                var m = [];
                for (r = 0; r < s.length; r++) {
                    l = s[r];
                    m[r] = $DIV("t-cell t-cell-" + l.field.base, f)
                }
                var g = {
                    $row: f,
                    $cells: m
                };
                p.push(g)
            }
            this.viewRows = p,
            this.$selectionContainer = $DIV("t-selection-container", this.$view),
            this.$selectionEl1 = $DIV("t-selection t-selection-row", this.$selectionContainer),
            this.resizeRows()
        },
        Ti.prototype.updateRows = function() {
            this._updateRowsId = (this._updateRowsId || 0) + 1;
            const e = this._updateRowsId,
                t = this.query,
                i = this.viewRows,
                o = (t && t.nidSelected, t ? t.models : {}),
                n = t ? t.groups : {},
                s = t ? this.ridxTop : 0,
                a = t ? t.cidxGroup : void 0,
                r = t ? t.rows : [],
                l = t ? t.cols : [];
            let c = 0;
            for (let u = 0; u < i.length; u++) {
                const f = i[u],
                    m = f.$row,
                    g = u + s,
                    v = f.$cells;
                let b = !1,
                    y = !1;
                if (g < 0 || g >= r.length)
                    for (let e = 0; e < l.length; e++) {
                        l[e];
                        const t = v[e];
                        t.innerHTML = "",
                        t.style.backgroundColor = ""
                    }
                else {
                    const i = r[g],
                        s = n[i] || o[i];
                    if (s) {
                        const o = s.values;
                        b = !1,
                        y = !!n[i],
                        y ? c = 0 : c++;
                        for (let n = 0; n < l.length; n++) {
                            const s = l[n],
                                r = v[n];
                            if (s.isReadable) {
                                const l = o[n],
                                    c = r.innerHTML;
                                let h = "",
                                    p = "",
                                    u = !1;
                                if (y && s.agg && n !== a) {
                                    const e = s.aggType.format(l);
                                    null != e && (h = tables.aggTypeToSymbol(s.agg, e))
                                } else {
                                    const o = s.field,
                                        n = o.base;
                                    if ("choice" === n) {
                                        const e = o.getValues()[l];
                                        e && (h += `\n                                            <div \n                                                class="multicombo-item" \n                                                style="${e.color ? "background-color:" + e.color + ";color:" + e.textColor : ""}"\n                                            >\n                                                ${e.icon ? `<div class="choice-symbol ic ic-${e.icon}"></div>` : ""}\n                                                <span>${htmlEscape(e.caption || "")}</span>\n                                            </div>`)
                                    } else if ("dchoice" === n)
                                        u = !0,
                                        o.loadValue(i, l, t => {
                                            if (e === this._updateRowsId)
                                                if (t) {
                                                    const e = `\n                                                <div \n                                                    class="multicombo-item" \n                                                    style="${t.color ? "background-color:" + t.color + ";color:" + util.contrastingTextColorTo(t.color) : ""}"\n                                                >\n                                                    ${t.icon ? `<div class="choice-symbol ic ic-${t.icon}"></div>` : ""}\n                                                    <span>${htmlEscape(t.caption || "")}</span>\n                                                </div>`;
                                                    r.innerHTML = e,
                                                    r.style.background = ""
                                                } else
                                                    r.innerHTML = "",
                                                    r.style.background = ""
                                        });
                                    else if ("multi" === n) {
                                        const e = util.multiDecode(l);
                                        if (e) {
                                            const t = o.getValues();
                                            e.sort((function(e, i) {
                                                const o = t[e],
                                                    n = t[i];
                                                return o ? n ? o.order - n.order : -1 : 0
                                            }));
                                            for (var d = 0; d < e.length; d++) {
                                                const i = t[e[d]];
                                                i && (h += `\n                                            <div \n                                                class="multicombo-item" \n                                                style="${i.color ? "background-color:" + i.color + ";color:" + i.textColor : ""}"\n                                            >\n                                                ${i.icon ? `<div class="choice-symbol ic ic-${i.icon}"></div>` : ""}\n                                                <span>${htmlEscape(i.caption || "")}</span>\n                                            </div>`)
                                            }
                                        }
                                    } else if ("dmulti" === n) {
                                        const t = util.multiDecode(l);
                                        t && (u = !0, o.loadValues(i, (i, o) => {
                                            if (e === this._updateRowsId) {
                                                o = o || {};
                                                let e = "";
                                                t.sort((function(e, t) {
                                                    const i = o[e],
                                                        n = o[t];
                                                    return i ? n ? i.order - n.order : -1 : 0
                                                }));
                                                for (let i = 0; i < t.length; i++) {
                                                    const n = o[t[i]];
                                                    n && (e += `\n                                                    <div \n                                                        class="multicombo-item" \n                                                        style="${n.color ? "background-color:" + n.color + ";color:" + util.contrastingTextColorTo(n.color) : ""}"\n                                                    >\n                                                        ${n.icon ? `<div class="choice-symbol ic ic-${n.icon}"></div>` : ""}\n                                                        <span>${htmlEscape(n.caption || "")}</span>\n                                                    </div>`)
                                                }
                                                r.innerHTML = e,
                                                r.style.background = ""
                                            }
                                        }))
                                    } else if ("color" === n)
                                        l && (h += `<div\n                                        class="t-cell-content-colored" \n                                        style="background-color:${l}"></div>`);
                                    else if ("icon" === n)
                                        l && (h = '<div class="choice-symbol ic ic-' + l + '"></div>');
                                    else if (("number" === n || "string" === n) && null != s.conditionalStyling && s.conditionalStyling.length > 0) {
                                        let e = !1;
                                        for (let n = 0; n < s.conditionalStyling.length && !e; n++) {
                                            const a = s.conditionalStyling[n];
                                            switch (a.operand) {
                                            case "=":
                                                l === a.value && (e = !0);
                                                break;
                                            case ">":
                                                l > a.value && (e = !0);
                                                break;
                                            case ">=":
                                                l >= a.value && (e = !0);
                                                break;
                                            case "<":
                                                l < a.value && (e = !0);
                                                break;
                                            case "<=":
                                                l <= a.value && (e = !0);
                                                break;
                                            case "!=":
                                                null != l && l !== a.value && (e = !0);
                                                break;
                                            case "startsWith":
                                                null != l && String(l).startsWith(a.value) && (e = !0);
                                                break;
                                            case "endsWith":
                                                null != l && String(l).endsWith(a.value) && (e = !0);
                                                break;
                                            case "contains":
                                                null != l && String(l).includes(a.value) && (e = !0);
                                                break;
                                            case "f(x)":
                                                {
                                                    const o = database.loadNodeSync(i),
                                                        n = queries.parseSystem(database.schema, t.type, a.value, {});
                                                    if (o && n) {
                                                        n.evaluateSync(database, o) && (e = !0)
                                                    }
                                                    break
                                                }
                                            }
                                            e && (h = `\n                                            <div \n                                                class="multicombo-item" \n                                                style="${"background-color:" + (a.background || "") + ";color:" + a.color || !1}"\n                                            >\n                                                ${a.icon ? `<div class="choice-symbol ic ic-${a.icon}"></div>` : ""}\n                                                <span>${htmlEscape(o.format(l))}</span>\n                                            </div>`, p = a.cell || "")
                                        }
                                        e || (h = htmlEscape(o.format(l)))
                                    } else if ("styled" === n)
                                        l && (h += `<div \n                                        class="multicombo-item" \n                                        style="${l.background ? `background-color:${l.background};` : ""}${l.color ? `color:${l.color};` : ""}"\n                                    >\n                                        ${l.icon ? `<div class="choice-symbol ic ic-${l.icon}"></div>` : ""}\n                                        <span>${htmlEscape(l.text || "")}</span>\n                                    </div>`);
                                    else if ("file" === o.base) {
                                        if (l) {
                                            const e = database.thumbURL1(l);
                                            e && (h = '<img style="height:40px" src="' + e + '">')
                                        }
                                    } else {
                                        const e = o.format(l);
                                        h = htmlEscape(e)
                                    }
                                }
                                u || (c !== h && (r.innerHTML = h), r.style.backgroundColor = p)
                            } else
                                r.innerHTML = "",
                                r.style.backgroundColor = "#f7f7f7"
                        }
                    }
                }
                var h = null == a && (u + s) % 2 == 0,
                    p = "t-row" + (g < 0 || g >= r.length ? " empty" : (b ? " choosen" : y ? " group" : "") + (h ? " t-row-2nd" : " t-row-1st"));
                p !== m.className && (m.className = p)
            }
            this.updateSelection()
        },
        Ti.prototype.rebalanceColumns = function(e) {
            if (this.query) {
                var t = this.query.cols;
                if (!(t.length < 2)) {
                    var i = this.el.width() - 1;
                    console.log("Rebalance", i);
                    for (var o = 0, n = 0, s = 0; s < t.length; s++) {
                        var a = t[s];
                        s !== e && (o += a.width),
                        n += a.width
                    }
                    if (o <= i) {
                        var r = 0;
                        for (s = 0; s < t.length - 1; s++) {
                            (a = t[s]).width = Math.floor(a.width * i / n),
                            r += a.width
                        }
                        t[t.length - 1].width = i - r
                    }
                }
            }
        },
        Ti.prototype.resizeColumns = function() {
            for (var e = this.viewRows, t = this.query ? this.query.cols : [], i = this.$headCells, o = this.$footCells, n = 0, s = 0; s < t.length; s++) {
                n += (d = t[s]).width
            }
            if (t.length > 0) {
                var a = this.el.width() - 1,
                    r = t[t.length - 1];
                (n < a || n - r.width < a && r.width + a - n >= 50) && (r.width += a - n)
            }
            for (var l = 0; l < e.length; l++) {
                var c = e[l];
                n = 0;
                for (s = 0; s < t.length; s++) {
                    var d = t[s];
                    c.$cells[s].style.left = n + "px",
                    c.$cells[s].style.width = d.width + "px",
                    n += d.width
                }
            }
            n = 0;
            for (s = 0; s < t.length; s++) {
                d = t[s];
                i[s].style.left = n + "px",
                i[s].style.width = d.width + "px",
                o[s].style.left = n + "px",
                o[s].style.width = d.width + "px",
                n += d.width
            }
            this.viewWidth = n,
            this.$head.style.width = n + "px",
            this.$foot.style.width = n + "px"
        },
        Ti.prototype.updateHead = function() {
            for (var e = this.query, t = e ? e.cols : [], i = e ? e.cidxGroup : void 0, o = e ? e.cidxSort : 0, n = !!e && !0 === e.sortDescending, s = this.$headCells, a = 0; a < t.length; a++) {
                var r = t[a],
                    l = s[a],
                    c = a === i,
                    d = a === o,
                    h = !!r.filter,
                    p = '<div class="t-head-resizer"></div><span>' + htmlEscape(r.caption || r.expression.caption) + "</span>" + (h ? '<div class="i-40-16 i-light-grey i-setting-filter" style="width: 12px;"></div>' : "") + (c ? '<div class="i-40-18 i-light-grey i-table-group" style="width: 24px"></div>' : d ? n ? '<div class="i-40-12 i-light-grey i-line-down-thick" style="width: 12px"></div>' : '<div class="i-40-12 i-light-grey i-line-up-thick" style="width: 12px"></div>' : "");
                l.innerHTML = p
            }
        },
        Ti.prototype.updateFoot = function() {
            for (var e = this.query ? this.query.cols : [], t = this.query ? this.query.foot.values : [], i = this.$footCells, o = this.hasFooter(), n = 0; n < e.length; n++) {
                var s = e[n];
                if (s.isReadable)
                    if (s.agg) {
                        s.aggType.base;
                        var a = s.aggType.format(t[n]);
                        null == a && (a = ""),
                        i[n].innerHTML = tables.aggTypeToSymbol(s.agg, a)
                    } else
                        i[n].innerHTML = "";
                else
                    i[n].innerHTML = ""
            }
            o ? (this.$body.style.bottom = "40px", this.$foot.style.display = "") : (this.$body.style.bottom = "0", this.$foot.style.display = "none")
        },
        Ti.prototype.scrollTo = function(e, t) {
            this.scrollTop = t,
            this.scrollLeft = e,
            this.scroll(!1, !0)
        },
        Ti.prototype.scroll = function(e, t) {
            var i = this.scrollTop,
                o = this.scrollLeft,
                n = Math.floor(i / 40),
                s = this.ridxTop;
            n > this.ridxTop + 20 - 1 ? s = n : n < this.ridxTop && (s = n - 20 + 1),
            (s !== this.ridxTop || e) && (this.ridxTop = s, this.updateRows());
            var a = i % 40;
            a < 0 && (a += 40);
            var r = -(a + 40 * (n - s)),
                l = -o;
            l !== this.viewX && (this.$head.style.transform = this.$head.style.WebkitTransform = "translate3d(" + l + "px,0px,0px)", this.$foot.style.transform = this.$foot.style.WebkitTransform = "translate3d(" + l + "px,0px,0px)", this.viewX = l),
            this.$view.style.transform = this.$view.style.WebkitTransform = "translate3d(" + l + "px," + r + "px,0px)",
            this.updateScrollbar(t)
        },
        Ti.prototype.registerScrollListeners = function() {
            TOUCH ? (this.registerScrollTouchListeners(), this.registerScrollbarVTouchListeners()) : (this.registerScrollMouseListeners(), this.registerScrollbarVMouseListeners(), this.registerScrollbarHMouseListeners())
        },
        Ti.prototype.registerScrollMouseListeners = function() {
            var e = this;
            function t(t) {
                if (e.query) {
                    var i = e.hasFooter(),
                        o = Math.max(0, 40 * e.query.rows.length - 1 - e.$list.height() + (i ? 80 : 40)),
                        n = OSX_10_9_MODE ? -t.wheelDeltaY : t.deltaY * (1 == t.deltaMode ? 40 : 2 == t.deltaMode ? window.getHeight() : 1),
                        s = OSX_10_9_MODE ? t.wheelDeltaX : -t.deltaX;
                    Math.abs(s) > Math.abs(n) ? n = 0 : s = 0;
                    var a = e.scrollTop,
                        r = Math.min(Math.max(a + n, 0), o),
                        l = Math.min(Math.max(0, e.scrollLeft - s), Math.max(0, e.viewWidth - 1 - e.$list.width()));
                    return e.scrollTo(l, r), t.preventDefault(), !1
                }
            }
            OSX_10_9_MODE ? e.$body.addEventListener("mousewheel", t) : e.$body.addEventListener("wheel", t)
        },
        Ti.prototype.registerScrollTouchListeners = function() {
            var e,
                t = this,
                i = 0,
                o = 0,
                n = 0,
                s = 0,
                a = 0,
                r = 0,
                l = 0,
                c = null,
                d = !1,
                h = 500 / 60,
                p = !0;
            function u() {
                if (t.query && d) {
                    var e = t.scrollTop,
                        i = t.scrollLeft,
                        o = Math.max(0, 40 * t.query.rows.length - t.$list.height() + (p ? 80 : 40));
                    if (e < 0) {
                        var n = e - 10 * e * h / 500;
                        Math.abs(n) < .1 && (n = 0),
                        t.scrollTo(i, n),
                        requestAnimationFrame(u)
                    } else if (0 === e)
                        d = !1;
                    else if (e > o) {
                        n = e - 10 * (e - o) * h / 500;
                        Math.abs(n - o) < .1 && (n = o),
                        t.scrollTo(i, n),
                        requestAnimationFrame(u)
                    } else if (e === o)
                        d = !1;
                    else if (l >= 500)
                        d = !1;
                    else {
                        var s = 1 - l * l / 25e4;
                        if (!isNaN(s)) {
                            var c = s * a,
                                f = s * r,
                                m = Math.min(Math.max(0, i - c), Math.max(0, t.viewWidth - 1 - t.$list.width()));
                            n = e - f;
                            t.scrollTo(m, n)
                        }
                        l += h,
                        requestAnimationFrame(u)
                    }
                }
            }
            t.$body.addEventListener("touchstart", (function(a) {
                return d = !1, i = n = a.touches[0].clientX, o = s = a.touches[0].clientY, e = (new Date).getTime(), c = null, p = t.hasFooter(), a.preventDefault(), !1
            })),
            t.$body.addEventListener("touchmove", (function(e) {
                d = !1;
                var i = e.touches[0].clientX,
                    o = e.touches[0].clientY,
                    a = i - n,
                    r = o - s;
                c || a * a + r * r > 9 && (c = Math.abs(a) > Math.abs(r) ? "H" : "V"),
                "H" === c ? r = 0 : a = 0;
                var l = Math.min(Math.max(0, t.scrollLeft - a), Math.max(0, t.viewWidth - 1 - t.$list.width())),
                    h = t.scrollTop - r;
                return t.scrollTo(l, h), n = i, s = o, e.preventDefault(), !1
            })),
            t.$body.addEventListener("touchend", (function(p) {
                if (c) {
                    var f = (new Date).getTime() - e;
                    return a = "H" === c ? (n - i) * h / f : 0, r = "V" === c ? t.scrollTop < 0 ? 0 : (s - o) * h / f : 0, l = 0, d = !0, requestAnimationFrame(u), p.preventDefault(), !1
                }
                return t.click(p)
            }))
        },
        Ti.prototype.popupColumnMenu = function(e) {
            if (!this.query)
                return;
            var t = this,
                i = this.query,
                o = i.cols[e];
            if (!o)
                return;
            var n = e === i.cidxSort && !i.sortDescending,
                s = e === i.cidxSort && i.sortDescending,
                a = e === i.cidxGroup,
                r = $.backplane({});
            const l = "number" === o.expression.returnType.base ? "number" : "string" === o.expression.returnType.base ? "string" : null;
            var c = $('<div class="nx-menu-popup grey column-menu">').appendTo(r),
                d = $('<div class="column-menu-section" style="display:flex;display:-webkit-flex;flex-direction:row;-webkit-flex-direction:row">').appendTo(c),
                h = $('<div style="flex-grow:1;-webkit-flex-grow:1;width:48px">').appendTo(d),
                p = ($('<div style="width:32px;padding:8px"><div class="type-symbol type-symbol-white type-symbol-fn" style="border-radius:4px;background-color:#007AEB"></div></div>').appendTo(d).click((function() {
                    new ft.a({
                        schema: i.type.schema,
                        type: i.type,
                        variables: {},
                        supportsCommands: !1,
                        value: o.expression.toString(),
                        okay: function(o, n) {
                            r.close(),
                            n && (i.setExpression(e, n), t.reload(), t.saveConfigIfAdminMode())
                        },
                        cancel: function() {}
                    })
                })), $('<div class="component editor" style="width:100%">').appendTo(h)),
                u = $('<input type="text">').val(o.caption).attr("placeholder", o.expression.caption).appendTo($('<div class="stringeditor">').appendTo(p)).change((function() {
                    o.caption = u.val() || void 0,
                    r.close(),
                    t.updateTable(),
                    t.saveConfigIfAdminMode()
                })),
                f = $('<div class="column-menu-section">').appendTo(c),
                m = $('<div class="editor" style="width:100%">').appendTo(f),
                g = tables.createFilterEditor({
                    updateFilter: function(e) {
                        e && r.close(),
                        o.filter = g.getFilter(),
                        t.reload(),
                        t.saveConfigIfAdminMode()
                    }
                }, m, o.field, o.filter),
                v = $('<div class="column-menu-section">').appendTo(c),
                b = $('<div class="editor" style="width:100%">').appendTo(v),
                y = $('<div class="switch table-popup-sorting">').appendTo(b);
            $('<div class="switch-item' + (n ? " selected" : "") + '">').append($('<div class="icon i-32-12 i-light-grey i-line-up-thick inline-block inline-block">')).append($("<span>").text(locale.sortAscending)).appendTo(y).click((function() {
                r.close(),
                i.sort(e, !1),
                t.updateTable(),
                t.saveConfigIfAdminMode()
            })),
            $('<div class="switch-item' + (s ? " selected" : "") + '">').append($('<div class="icon i-32-12 i-light-grey i-line-down-thick inline-block">')).append($("<span>").text(locale.sortDescending)).appendTo(y).click((function() {
                r.close(),
                i.sort(e, !0),
                t.updateTable(),
                t.saveConfigIfAdminMode()
            })),
            $('<div class="switch-item' + (a ? " selected" : "") + '">').append($('<div class="icon i-32-16 i-light-grey i-table-group">')).append($("<span>").text(locale.grouped)).appendTo(y).click((function() {
                r.close(),
                a ? (i.ungroup(), t.updateTable()) : (i.group(e), t.updateTable()),
                t.saveConfigIfAdminMode()
            }));
            var w = o.field.aggregations;
            if (w && w.length) {
                var x = $('<div class="column-menu-section">').appendTo(c),
                    C = $('<div class="editor" style="width:100%">').appendTo(x),
                    k = $('<div class="switch">').appendTo(C);
                T.each(w, (function(n) {
                    $('<div class="switch-item' + (n === o.agg ? " selected" : "") + '">').text(locale.agg[n]).appendTo(k).click((function() {
                        r.close(),
                        n !== o.agg ? i.setAggregation(e, n) : i.setAggregation(e, void 0),
                        t.updateTable(),
                        t.saveConfigIfAdminMode()
                    }))
                }))
            }
            null !== l && $('<div class="buttons">').appendTo(c).append(`<div class="root-help-link">${locale.conditionalStyling}...</div>`).touch((function() {
                r.close(),
                new wi(i.type, o, (function(e) {
                    o.conditionalStyling = e,
                    t.updateTable(),
                    t.saveConfigIfAdminMode()
                }), l)
            }));
            var S = $('<div class="buttons">').appendTo(c);
            $('<div class="nx-button-text grey">').text(locale.hideColumn).appendTo(S).click((function() {
                r.close(),
                i.removeColumn(e),
                t.updateTable(),
                t.saveConfigIfAdminMode()
            })),
            $('<div class="nx-hspace-flex">').appendTo(S),
            $('<div class="nx-button-text blue">').text(locale.showColumn + "...").appendTo(S).click((function() {
                r.close(),
                t.popupAddColumnMenu(e)
            }));
            var E = c.outerWidth(),
                _ = c.outerHeight(),
                D = $(this.$headCells[e]).offset();
            D.left -= 8,
            D.top += 40,
            D.left + E > window.getWidth() && (D.left = window.getWidth() - E),
            D.top + _ > window.getHeight() && (D.top = window.getHeight() - _),
            c.offset(D)
        },
        Ti.prototype.popupAddColumnMenu = function(e, t) {
            if (this.query) {
                var i = this.$headCells[e] ? $(this.$headCells[e]).offset() : this.$list.offset();
                i.top += 40;
                var o = this,
                    n = this.query,
                    s = [];
                t || (t = [{
                    type: n.type,
                    path: "",
                    multiple: !1
                }]),
                t.length > 1 ? s.push({
                    icon: "i-32-24 i-light-grey i-arrow-solid-left",
                    caption: locale.back,
                    click: function() {
                        var i = t.slice(1);
                        o.popupAddColumnMenu(e, i)
                    }
                }) : s.push({
                    icon: "i-light-grey i-32-24 i-field-fn",
                    caption: locale.function,
                    click: function() {
                        new ft.a({
                            schema: n.type.schema,
                            type: n.type,
                            variables: {},
                            supportsCommands: !1,
                            value: "",
                            okay: function(t, i) {
                                i && n.addColumn(e + 1, {
                                    expression: i.toString()
                                }, (function() {
                                    o.rebalanceColumns(e + 1),
                                    o.updateTable(),
                                    o.saveConfigIfAdminMode()
                                }))
                            },
                            cancel: function() {}
                        })
                    }
                });
                var a = {};
                if (this.query.cols)
                    for (var r = 0; r < this.query.cols.length; r++) {
                        var l = this.query.cols[r].expression;
                        l && (a[l.toString()] = !0)
                    }
                var c = t[0].type,
                    d = t[0].path,
                    h = t[0].multiple;
                a[d + "_id"] || s.push({
                    icon: "i-32-24 i-light-grey i-field-number",
                    caption: locale.id,
                    field: c.field_id,
                    click: m
                });
                for (var p = c.sorted, u = 0; u < p.length; u++) {
                    var f = p[u];
                    (f.isField || f.isReverse || f.isReference) && (a[d + f.id] || s.push({
                        icon: "i-light-grey i-32-24 i-field-" + f.base,
                        caption: f.caption,
                        field: f,
                        click: m
                    }))
                }
                new bi({
                    offset: i,
                    head: {
                        caption: locale.showColumn
                    },
                    items: s
                })
            }
            function m() {
                var s = this.field;
                if (s.isReference) {
                    var a = [{
                        type: s.refType,
                        path: d + s.id + ".",
                        multiple: h
                    }].concat(t);
                    o.popupAddColumnMenu(e, a)
                } else if (s.isReverse) {
                    a = [{
                        type: s.refType,
                        path: d + s.id + ".",
                        multiple: !0
                    }].concat(t);
                    o.popupAddColumnMenu(e, a)
                } else if (s.isField)
                    if (h) {
                        for (var r = [{
                                icon: "i-32-24 i-light-grey i-arrow-solid-left",
                                caption: locale.back,
                                click: v
                            }], l = s.aggregations, c = 0; c < l.length; c++) {
                            var p = l[c];
                            r.push({
                                caption: locale.agg[p] + "(" + s.caption + ")",
                                field: s,
                                agg: p,
                                click: g
                            })
                        }
                        new bi({
                            offset: i,
                            head: {
                                caption: locale.showColumn
                            },
                            items: r
                        })
                    } else
                        n.addColumn(e + 1, {
                            expression: d + s.id
                        }, (function() {
                            o.rebalanceColumns(e + 1),
                            o.updateTable(),
                            o.saveConfigIfAdminMode()
                        }))
            }
            function g() {
                var t = this.agg,
                    i = this.field;
                n.addColumn(e + 1, {
                    expression: t + "(" + d + i.id + ")"
                }, (function() {
                    o.rebalanceColumns(e + 1),
                    o.updateTable(),
                    o.saveConfigIfAdminMode()
                }))
            }
            function v() {
                o.popupAddColumnMenu(e, t)
            }
        },
        Ti.prototype.isHeightAdjustable = function() {
            return !0
        },
        Ti.prototype.setHeight = function(e) {
            var t = Math.max(1, Math.round((e - this.headHeight - this.footHeight) / (this.rowHeight + 0)));
            this.field.height = t,
            this.maxRows = t,
            this.updateTable()
        },
        Ti.prototype.setWidth = function(e, t) {
            Ot.a.prototype.setWidth.call(this, e, t),
            this.resizeColumns()
        },
        Ti.prototype.resize = function() {
            this.resizeColumns()
        },
        Ti.prototype.canUnlink = function() {
            var e = this.field;
            return !e.isComposition && this.isWritable() && database.canWrite(e.reference)
        },
        Ti.prototype.canRemove = function() {
            var e = this.field;
            return this.isWritable() && database.canDelete(e.refType)
        },
        Ti.prototype.startEditCaption = qt.prototype.startEditCaption,
        Ti.prototype.registerRowResizeListeners = function() {
            var e = this;
            this.$view.addEventListener(TOUCH ? EVENT_touchstart : "mousedown", (function(t) {
                const i = "touchstart" === t.type;
                if (i && 1 !== t.touches.length)
                    return;
                var o = t.target;
                if (!$(o).is(".t-rowhead-resizer"))
                    return;
                var n = i ? t.touches[0].clientY : t.clientY,
                    s = e.rowHeight,
                    a = e.scrollTop;
                i ? (EVENT_target(t).addEventListener(EVENT_touchend, l, !1), EVENT_target(t).addEventListener(EVENT_touchmove, r, !1)) : (window.addEventListener("mouseup", l, !1), window.addEventListener("mousemove", r, !1));
                function r(t) {
                    if (!i || 1 === t.touches.length) {
                        var o = (i ? t.touches[0].clientY : t.clientY) - n;
                        s < 40 ? s + o > 40 && (o = Math.max(40 - s, o - 24)) : s + o < 40 && (o = Math.min(40 - s, o + 24));
                        var r = Math.min(120, Math.max(28, Math.round(s + o))),
                            l = r - s;
                        e.rowHeight = r,
                        e.scrollTop = a + a / s * l,
                        e.resizeRows(),
                        e.updateSelection(),
                        e.updateRows(),
                        t.preventDefault()
                    }
                }
                function l(t) {
                    i && 0 !== t.touches.length || (i ? (EVENT_target(t).removeEventListener(EVENT_touchend, l, !1), EVENT_target(t).removeEventListener(EVENT_touchmove, r, !1)) : (window.removeEventListener("mousemove", r, !1), window.removeEventListener("mouseup", l, !1)), t.preventDefault(), e.saveTableRowHeight(e.rowHeight))
                }
                t.preventDefault(),
                t.stopPropagation()
            }), !1)
        },
        Ti.prototype.resizeRows = function() {
            for (var e = this.viewRows, t = 0; t < e.length; t++) {
                var i = e[t];
                i.$row.style.top = t * (this.rowHeight + 0) + "px",
                i.$row.style.height = this.rowHeight + "px";
                for (var o = i.$cells, n = this.query ? this.query.cols : [], s = this.rowHeight < 40 ? Math.floor((this.rowHeight - 18) / 2) + "px" : "", a = 0; a < n.length; a++)
                    o[a].style.paddingTop = s
            }
            this.$view.className = this.rowHeight <= "40" ? "t-view" : "t-view t-view-resized-rows"
        },
        Ti.prototype.registerHeadResizeListeners = function() {
            var e = this;
            function t(t) {
                if (e.query && (!TOUCH || 1 === t.touches.length)) {
                    var o = t.target;
                    if ("t-head-resizer" === o.className) {
                        var n = o.parentNode.getAttribute("data-cidx");
                        if (n) {
                            n = parseInt(n);
                            var s = e.query.cols[n];
                            if (s) {
                                var a = s.width,
                                    r = TOUCH ? t.touches[0].clientX : t.clientX,
                                    l = TOUCH ? t.touches[0].clientY : t.clientY,
                                    c = !1;
                                return TOUCH ? (EVENT_target(t).addEventListener(EVENT_touchmove, d, !1), EVENT_target(t).addEventListener(EVENT_touchend, h, !1)) : (document.addEventListener("mousemove", d, !1), document.addEventListener("mouseup", h, !1)), i(t), !1
                            }
                        }
                    }
                }
                function d(t) {
                    if (!TOUCH || 1 === t.touches.length) {
                        var o = TOUCH ? t.touches[0].clientX : t.clientX,
                            n = TOUCH ? t.touches[0].clientY : t.clientY,
                            d = o - r,
                            h = n - l,
                            p = Math.abs(d) > Math.abs(h) ? d : h;
                        if (Math.abs(p) > 1 && (c = !0), c) {
                            c = !0;
                            var u = Math.max(32, a + p);
                            s.width = u,
                            e.resizeColumns()
                        }
                        return i(t), !1
                    }
                }
                function h(t) {
                    if (!TOUCH || 0 === t.touches.length)
                        return TOUCH ? (EVENT_target(t).removeEventListener(EVENT_touchmove, d, !1), EVENT_target(t).removeEventListener(EVENT_touchend, h, !1)) : (document.removeEventListener("mousemove", d, !1), document.removeEventListener("mouseup", h, !1)), c ? e.saveConfigIfAdminMode() : e.touchHead(t), i(t), !1
                }
            }
            function i(e) {
                e.preventDefault(),
                e.stopPropagation()
            }
            TOUCH ? e.$head.addEventListener(EVENT_touchstart, t, !1) : e.$head.addEventListener("mousedown", t, !1)
        },
        Ti.prototype.registerHeadDragListeners = function() {
            var e = this;
            function t(t) {
                if (e.query && (!TOUCH || 1 === t.touches.length)) {
                    var i = t.target;
                    if ("t-head-resizer" !== i.className) {
                        for (; i && "t-head-cell" !== i.className;)
                            i = i.parentNode;
                        if (i) {
                            var o = i.getAttribute("data-cidx");
                            if (o) {
                                o = parseInt(o);
                                var n = e.query.cols;
                                if (n[o]) {
                                    for (var s = e.$headCells, a = e.$footCells, r = s[o], l = a[o], c = e.$container.getBoundingClientRect(), d = 0, h = 0; h < o; h++)
                                        d += n[h].width;
                                    var p = TOUCH ? t.touches[0].clientX : t.clientX,
                                        u = (e.scrollLeft, !1),
                                        f = o,
                                        m = [];
                                    b(),
                                    TOUCH ? (EVENT_target(t).addEventListener(EVENT_touchmove, g, !0), EVENT_target(t).addEventListener(EVENT_touchend, v, !0)) : (window.addEventListener("mousemove", g, !0), window.addEventListener("mouseup", v, !0)),
                                    t.preventDefault(),
                                    t.stopPropagation()
                                }
                            }
                        }
                    }
                }
                function g(t) {
                    if (!TOUCH || 1 === t.touches.length) {
                        var i = TOUCH ? t.touches[0].clientX : t.clientX,
                            s = i - p;
                        if (Math.abs(s) > 3) {
                            u = !0,
                            r.style.zIndex = "1",
                            r.style.backgroundColor = "rgba(200,200,200,.5)",
                            l.style.zIndex = "1",
                            l.style.backgroundColor = "rgba(200,200,200,.5)";
                            for (var a = e.viewRows, h = 0; h < a.length; h++) {
                                a[h].$cells[o].style.zIndex = 1
                            }
                        }
                        if (u) {
                            var g = d + s + "px";
                            r.style.left = g,
                            l.style.left = g;
                            for (a = e.viewRows, h = 0; h < a.length; h++)
                                a[h].$cells[o].style.left = g;
                            for (var v = c.left, y = 0; y < m.length; y++) {
                                var w = n[m[y]],
                                    x = v - e.scrollLeft,
                                    T = x + w.width / 3,
                                    $ = x + 2 * w.width / 3,
                                    C = x + w.width;
                                if (y !== f) {
                                    if (x <= i && T > i) {
                                        f = y,
                                        b();
                                        break
                                    }
                                    if ($ < i && C >= i) {
                                        f = y + 1,
                                        b();
                                        break
                                    }
                                }
                                v += w.width
                            }
                        }
                        t.preventDefault(),
                        t.stopPropagation()
                    }
                }
                function v(t) {
                    if (!TOUCH || 0 === t.touches.length) {
                        if (TOUCH ? (EVENT_target(t).removeEventListener(EVENT_touchmove, g, !0), EVENT_target(t).removeEventListener(EVENT_touchend, v, !0)) : (window.removeEventListener("mousemove", g, !0), window.removeEventListener("mouseup", v, !0)), u) {
                            r.style.zIndex = "",
                            r.style.backgroundColor = "",
                            l.style.zIndex = "",
                            l.style.backgroundColor = "";
                            for (var i = e.viewRows, s = 0; s < i.length; s++) {
                                i[s].$cells[o].style.zIndex = ""
                            }
                            if (o === f)
                                e.resizeColumns();
                            else {
                                var a = void 0 !== e.cidxSort ? n[e.cidxSort] : void 0,
                                    c = void 0 !== e.cidxSort ? n[e.cidxGroup] : void 0;
                                xi(n, o, f),
                                a && (e.cidxSort = n.indexOf(a)),
                                c && (e.cidxGroup = n.indexOf(c));
                                var d = e.query.models,
                                    h = e.query.groups;
                                for (var p in d) {
                                    if (d.hasOwnProperty(p))
                                        xi(d[p].values, o, f)
                                }
                                for (var m in h) {
                                    if (h.hasOwnProperty(m))
                                        xi(h[m].values, o, f)
                                }
                                xi(e.query.foot.values, o, f),
                                e.createCells(),
                                e.resizeColumns(),
                                e.updateHead(),
                                e.updateRows(),
                                e.updateFoot(),
                                e.saveConfigIfAdminMode()
                            }
                        } else
                            e.touchHead(t);
                        t.preventDefault(),
                        t.stopPropagation()
                    }
                }
                function b() {
                    m = [];
                    for (var t = 0; t < n.length; t++)
                        m[t] = t;
                    m.splice(o, 1),
                    m.splice(f, 0, o);
                    for (var i = 0, r = e.viewRows, l = 0; l < r.length; l++) {
                        var c = r[l];
                        i = 0;
                        for (t = 0; t < m.length; t++) {
                            var d = n[m[t]].width;
                            if (t !== f)
                                c.$cells[m[t]].style.left = i + "px";
                            i += d
                        }
                    }
                    i = 0;
                    for (t = 0; t < m.length; t++) {
                        d = n[m[t]].width;
                        if (t !== f)
                            s[m[t]].style.left = i + "px",
                            a[m[t]].style.left = i + "px";
                        i += d
                    }
                }
            }
            TOUCH ? e.$head.addEventListener(EVENT_touchstart, t, !1) : e.$head.addEventListener("mousedown", t, !1)
        },
        Ti.prototype.updateScrollbar = function(e) {
            if (this.query) {
                var t = this.query.rows.length,
                    i = this.scrollTop,
                    o = this.scrollLeft,
                    n = this.hasFooter(),
                    s = this.containerHeight() - (n ? 80 : 40),
                    a = Math.max(s, 40 * t),
                    r = this.viewWidth - 1,
                    l = this.$container.clientWidth,
                    c = a - 1 > s,
                    d = r > l,
                    h = s - 4,
                    p = l - (c ? 16 : 0),
                    u = Math.max(36, Math.round(h * s / a)),
                    f = Math.max(0, Math.min(h - u, Math.round(i / (a - s) * (h - u)))) + 2,
                    m = Math.max(36, Math.min(p, Math.round(p * (l / r)))),
                    g = Math.max(0, Math.min(p - m, Math.round(o / (r - l) * (p - m)))) + 2,
                    v = this.$scrollbarV;
                v.style.top = f + "px",
                v.style.height = u + "px";
                var b = this.$scrollbarH;
                d ? (this.$scrollbarHContainer.style.display = "", b.style.left = g + "px", b.style.width = m + "px") : this.$scrollbarHContainer.style.display = "none",
                e && (this.scrollDoneTime = Date.now() + 1e3, this.scrollDoneTimeout || (c && (v.className = "t-scrollbar-v scrolling"), d && (b.className = "t-scrollbar-h scrolling"), this.scrollDoneTimeout = setTimeout(this.scrollDone, 1e3))),
                this.$scrollVIndicator.style.opacity = 0 != i ? 1 : 0
            }
        },
        Ti.prototype.scrollDone = function() {
            var e = Date.now(),
                t = this.scrollDoneTime - e;
            t < 100 ? (this.$scrollbarV.className = "t-scrollbar-v", this.$scrollbarH.className = "t-scrollbar-h", this.scrollDoneTimeout = null) : this.scrollDoneTimeout = setTimeout(this.scrollDone, t)
        },
        Ti.prototype.containerHeight = function() {
            return this.$list.height() + 2
        },
        Ti.prototype.registerScrollbarVMouseListeners = function() {
            var e = this;
            this.$scrollbarV.addEventListener("mousedown", (function(t) {
                if (!e.query)
                    return;
                t.target;
                var i = t.clientY,
                    o = e.scrollTop,
                    n = e.query.rows.length,
                    s = e.hasFooter(),
                    a = e.containerHeight() - (s ? 80 : 40),
                    r = a - 4,
                    l = Math.max(a, 40 * n - 1),
                    c = l / r;
                function d(t) {
                    var n = t.clientY - i;
                    e.scrollTo(e.scrollLeft, Math.max(0, Math.min(l - a, Math.round(o + c * n)))),
                    t.preventDefault()
                }
                window.addEventListener("mouseup", (function e(t) {
                    window.removeEventListener("mousemove", d, !1),
                    window.removeEventListener("mouseup", e, !1),
                    t.preventDefault()
                }), !1),
                window.addEventListener("mousemove", d, !1),
                t.preventDefault()
            }), !1)
        },
        Ti.prototype.registerScrollbarVTouchListeners = function() {
            var e = this;
            this.$scrollbarV.addEventListener(EVENT_touchstart, (function(t) {
                if (!e.query)
                    return;
                if (1 !== t.touches.length)
                    return;
                var i = t.touches[0].clientY,
                    o = e.scrollTop,
                    n = e.query.rows.length,
                    s = e.hasFooter(),
                    a = e.containerHeight() - (s ? 80 : 40),
                    r = a - 4,
                    l = Math.max(a, 40 * n - 1),
                    c = l / r;
                function d(t) {
                    if (1 === t.touches.length) {
                        var n = t.touches[0].clientY - i;
                        e.scrollTo(e.scrollLeft, Math.max(0, Math.min(l - a, Math.round(o + c * n)))),
                        t.preventDefault()
                    }
                }
                EVENT_target(t).addEventListener(EVENT_touchmove, d, !1),
                EVENT_target(t).addEventListener(EVENT_touchend, (function e(t) {
                    0 === t.touches.length && (EVENT_target(t).removeEventListener(EVENT_touchmove, d, !1), EVENT_target(t).removeEventListener(EVENT_touchend, e, !1), t.preventDefault())
                }), !1)
            }), !1)
        },
        Ti.prototype.registerScrollbarHMouseListeners = function() {
            var e = this;
            this.$scrollbarH.addEventListener("mousedown", (function(t) {
                t.target;
                var i = t.clientX,
                    o = e.scrollLeft,
                    n = e.$container.clientWidth,
                    s = n - 4,
                    a = e.viewWidth - 1,
                    r = a / s;
                function l(t) {
                    var s = t.clientX - i;
                    e.scrollTo(Math.max(0, Math.min(a - n, Math.round(o + r * s))), e.scrollTop),
                    t.preventDefault()
                }
                window.addEventListener("mouseup", (function e(t) {
                    window.removeEventListener("mousemove", l, !1),
                    window.removeEventListener("mouseup", e, !1),
                    t.preventDefault()
                }), !1),
                window.addEventListener("mousemove", l, !1),
                t.preventDefault()
            }), !1)
        },
        Ti.prototype.nodeRenamed = function(e, t, i) {
            var o = this;
            o.query && o.query.nodeRenamed(e, t, i, (function() {
                o.updateAll()
            }))
        },
        Ti.prototype.rowY = function(e, t) {
            return ((e < t ? e : t) - this.ridxTop) * this.rowHeight
        },
        Ti.prototype.rowH = function(e, t) {
            return (Math.abs(t - e) + 1) * this.rowHeight
        },
        Ti.prototype.updateSelection = function() {
            var e = this.query;
            if (!e)
                return this.hideSelection();
            var t = e.rows;
            if (!e.nidSelected)
                return this.hideSelection();
            var i = t.indexOf(e.nidSelected);
            if (-1 === i)
                return this.hideSelection();
            this.$selectionContainer.style.display = "";
            var o = this.rowY(i, i),
                n = this.rowH(i, i) - 1,
                s = this.viewWidth - 2,
                a = this.$selectionEl1;
            a.style.left = "1px",
            a.style.top = o + "px",
            a.style.width = s - 1 + "px",
            a.style.height = n + "px"
        },
        Ti.prototype.hideSelection = function() {
            this.$selectionContainer.style.display = "none"
        },
        Ti.prototype.updateButtons = function() {
            var e = this.field,
                t = this.container,
                i = !1,
                o = !1;
            this.isWritable() && database.canWrite(e.reference) && (i = database.canCreate(e.refType) && (!e.refType.master || e.refType.master === t.type), o = !e.isComposition),
            this.$find && this.$find.css("display", o ? "" : "none"),
            this.$create && this.$create.css("display", i ? "" : "none"),
            this.$controls && this.$controls.css("display", o || i ? "" : "none")
        };
        function $i(e, t, i) {
            this.rowHeight = 40,
            this.headHeight = 40,
            this.footHeight = 40;
            var o = this;
            this.resize = $.proxy(this.resize, this);
            var n = null,
                s = null,
                a = 0;
            this.nid = e,
            this.field = t,
            this.options = i,
            this.viewIsDirty = !1,
            this.query = new queries.Query(database, Object.assign({}, i.viewConfig || t.viewConfig, {
                type: t.refTypeId,
                choosen: {}
            })),
            this.$backplane = $.backplane({
                close: $.proxy(this.closed, this)
            });
            var r = this.$popup = $('<div class="popupeditor pane">').css({
                    left: 32,
                    top: 32,
                    right: 32,
                    bottom: 32
                }).appendTo(this.$backplane),
                l = $('<div style="display:flex;display:-webkit-flex;position:absolute;left:16px;top:16px;right:16px">').appendTo(r),
                c = $('<div class="editor editor-string" style="flex:1 1 auto;-webkit-flex:1 1 auto;padding:0 8px 0 0">').appendTo(l);
            function d() {
                s && clearTimeout(s),
                s = setTimeout(h, 200)
            }
            function h(e) {
                s = null;
                var t = o.$search.val().trim();
                (e || t !== n) && (n = t, async function(e, t) {
                    var i = o.nid,
                        n = o.field,
                        s = o.query,
                        r = s.deps,
                        l = n.isReverse || !1,
                        c = s.getWhereExpression(),
                        d = l ? n.reference.constraintExp : n.constraintExp;
                    if (database.find) {
                        var h = null;
                        d && (h = l ? d.resolve({
                            a: new queries.This(n.refType),
                            b: new queries.Record(n.type, new queries.Const(schemas.ridOf(i), schemas.tnumber))
                        }) : d.resolve({
                            a: new queries.Record(n.type, new queries.Const(schemas.ridOf(i), schemas.tnumber)),
                            b: new queries.This(n.refType)
                        }));
                        var p = c ? d ? "select " + n.refTypeId + " where (" + c.toString() + ") and (" + h.toString() + ")" : "select " + n.refTypeId + " where (" + c.toString() + ")" : d ? "select " + n.refTypeId + " where (" + h.toString() + ")" : "select " + n.refTypeId;
                        database.find(p, t, g)
                    } else {
                        var u = c ? c.getSyncJS() : void 0;
                        if (d) {
                            var f = d.getSyncJS(),
                                m = database.loadNodeSync(i);
                            g(void 0, m ? l ? await database.selectFindSyncJS(n.refTypeId, (function(e) {
                                return (!u || u(u.ctx, database, e)) && f(f.ctx, database, void 0, {
                                        a: e,
                                        b: m
                                    })
                            }), t, 0) : await database.selectFindSyncJS(n.refTypeId, (function(e) {
                                return (!u || u(u.ctx, database, e)) && f(f.ctx, database, void 0, {
                                        a: m,
                                        b: e
                                    })
                            }), t, 0) : [])
                        } else
                            g(void 0, u ? await database.selectFindSyncJS(n.refTypeId, (function(e) {
                                return u(u.ctx, database, e)
                            }), t, 0) : await database.selectFindSyncJS(n.refTypeId, void 0, t, 0))
                    }
                    function g(t, i) {
                        e === a && database.loadNodes2(i, r, (function() {
                            if (e === a) {
                                if (t)
                                    return v(t);
                                if (l) {
                                    for (var o = n.refFieldId, s = [], r = 0; r < i.length; r++) {
                                        var c = i[r],
                                            d = database.loadNodeSync(c);
                                        if (d)
                                            d[o] || s.push(c)
                                    }
                                    v(void 0, s)
                                } else
                                    v(void 0, i)
                            }
                        }))
                    }
                    function v(t, i) {
                        e === a && (t && $.alert(t), s.loadNids(i || [], (function() {
                            o.updateHeight(),
                            o.updateHead(),
                            o.updateFoot(),
                            o.updateRows()
                        })))
                    }
                }(++a, t))
            }
            this.$search = $('<input type="text" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">').attr("placeholder", locale.refFinderSearchCaption + " " + (t.refType.caption || t.refType.id)).appendTo($('<div class="stringeditor">').appendTo(c)).keydown((function(e) {
                switch (e.which) {
                case 27:
                    return o.close(), !1
                }
            })).keyup(d).change(d),
            i.create && ($('<div class="nx-button-text blue" style="flex:0 0 auto;-webkit-flex:0 0 auto">').text(locale.createRecord).appendTo(l).touch((function() {
                o.close(),
                i.create()
            })), $('<div class="nx-hspace-small">').appendTo(l)),
            $('<div class="nx-button-text grey" style="flex:0 0 auto;-webkit-flex:0 0 auto">').text(locale.cancel).appendTo(l).touch($.proxy(this.close, this)),
            this.el = this.$list = $('<div class="list">').appendTo($('<div class="editor editor-rev" style="position:absolute;top:56px;left:8px;right:8px;bottom:8px">').appendTo(r)).touch($.proxy(this.click, this)),
            this.$container = $DIV("t-container", this.$list[0]),
            this.$head = $DIV("t-head", this.$container),
            this.$foot = $DIV("t-foot", this.$container),
            this.$body = $DIV("t-body", this.$container),
            this.$content = $DIV("t-content", this.$body),
            this.$view = $DIV("t-view hoverable", this.$content),
            this.$headCells = [],
            this.$footCells = [],
            this.$scrollbarVContainer = $DIV("t-scrollbar-v-container", this.$container),
            this.$scrollbarV = $DIV("t-scrollbar-v", this.$scrollbarVContainer),
            this.$scrollbarHContainer = $DIV("t-scrollbar-h-container", this.$container),
            this.$scrollbarHContainer.style.left = 0,
            this.$scrollbarHContainer.style.bottom = 0,
            this.$scrollbarH = $DIV("t-scrollbar-h", this.$scrollbarHContainer),
            this.$scrollVIndicator = $DIV("t-scroll-v-indicator", this.$container),
            this.ridxTop = 0,
            this.scrollTop = 0,
            this.scrollLeft = 0,
            this.scrollDoneTimeout = null,
            this.scrollDoneTime = 0,
            this.scrollDone = $.proxy(this.scrollDone, this),
            this.viewWidth = 0,
            this.viewRows = [],
            this.minRows = this.maxRows = Math.max(1, Math.floor((window.getHeight() - 144) / 40) - (this.hasFooter() ? 2 : 1)),
            this.registerScrollListeners(),
            this.registerHeadResizeListeners(),
            this.registerHeadDragListeners(),
            this.updateTable(),
            window.addEventListener("resize", this.resize),
            database.on("rename", void 0, this.nodeRenamed, this),
            this.$search.focus(),
            this.reload = function() {
                s && clearTimeout(s),
                h(!0)
            },
            d()
        }
        $i.prototype.click = function(e) {
            var t = $(e.target),
                i = t.closest(".t-foot-cell");
            if (i.length) {
                var o = i.attr("data-cidx");
                null != o ? this.popupColumnMenu(parseInt(o), e) : this.popupAddColumnMenu(e)
            } else {
                var n = t.closest(".t-row");
                if (n.length) {
                    var s = parseInt(n.attr("data-ridx")) + this.ridxTop,
                        a = this.query.rows[s];
                    a && (this.query.groups[a] ? (this.query.toggleGroup(a), this.updateHeight(), this.updateRows()) : (this.options.select && this.options.select(a), this.close()))
                }
            }
        },
        $i.prototype.touchHead = Ti.prototype.touchHead,
        $i.prototype.closed = function() {
            this.viewIsDirty && this.options.saveViewConfig && this.options.saveViewConfig(this.query.getConfig()),
            database.off("rename", void 0, this.nodeRenamed, this),
            window.removeEventListener("resize", this.resize)
        },
        $i.prototype.close = function() {
            this.$backplane.close()
        },
        $i.prototype.add = function() {},
        $i.prototype.resize = function() {
            this.updateTable()
        },
        $i.prototype.registerHeadResizeListeners = Ti.prototype.registerHeadResizeListeners,
        $i.prototype.registerHeadDragListeners = Ti.prototype.registerHeadDragListeners,
        $i.prototype.updateAll = Ti.prototype.updateAll,
        $i.prototype.updateTable = Ti.prototype.updateTable,
        $i.prototype.createCells = Ti.prototype.createCells,
        $i.prototype.tableHeadDropped = Ti.prototype.tableHeadDropped,
        $i.prototype.rebalanceColumns = Ti.prototype.rebalanceColumns,
        $i.prototype.resizeColumns = Ti.prototype.resizeColumns,
        $i.prototype.columnResizeDrag = Ti.prototype.columnResizeDrag,
        $i.prototype.updateHeight = function() {
            this.minRows = this.maxRows = Math.max(1, Math.floor((window.getHeight() - 144) / 40) - (this.hasFooter() ? 2 : 1)),
            Ti.prototype.updateHeight.call(this)
        },
        $i.prototype.updateRows = Ti.prototype.updateRows,
        $i.prototype.updateHead = Ti.prototype.updateHead,
        $i.prototype.updateFoot = Ti.prototype.updateFoot,
        $i.prototype.scroll = Ti.prototype.scroll,
        $i.prototype.scrollTo = Ti.prototype.scrollTo,
        $i.prototype.registerScrollListeners = Ti.prototype.registerScrollListeners,
        $i.prototype.registerScrollMouseListeners = Ti.prototype.registerScrollMouseListeners,
        $i.prototype.registerScrollTouchListeners = Ti.prototype.registerScrollTouchListeners,
        $i.prototype.popupColumnMenu = Ti.prototype.popupColumnMenu,
        $i.prototype.popupAddColumnMenu = Ti.prototype.popupAddColumnMenu,
        $i.prototype.saveConfigIfAdminMode = function() {
            this.viewIsDirty = !0
        },
        $i.prototype.hasFooter = Ti.prototype.hasFooter,
        $i.prototype.updateScrollbar = Ti.prototype.updateScrollbar,
        $i.prototype.scrollDone = Ti.prototype.scrollDone,
        $i.prototype.containerHeight = Ti.prototype.containerHeight,
        $i.prototype.registerScrollbarVMouseListeners = Ti.prototype.registerScrollbarVMouseListeners,
        $i.prototype.registerScrollbarVTouchListeners = Ti.prototype.registerScrollbarVTouchListeners,
        $i.prototype.registerScrollbarHMouseListeners = Ti.prototype.registerScrollbarHMouseListeners,
        $i.prototype.nodeRenamed = Ti.prototype.nodeRenamed,
        $i.prototype.isWritable = Ti.prototype.isWritable,
        $i.prototype.updateSelection = Ti.prototype.updateSelection,
        $i.prototype.hideSelection = Ti.prototype.hideSelection,
        $i.prototype.resizeRows = Ti.prototype.resizeRows;
        var Ci = o("./src/js/widgets/editors/ChoiceEditor.js");
        class ki {
            constructor(e)
            {
                K()(this, "reference", void 0),
                K()(this, "editor", void 0),
                this.reference = e,
                this.editor = new Ci.a({
                    el: this.reference.el,
                    setError: e => this.reference.setError(e),
                    editorUp: () => this.reference.container.editorUp(),
                    editorDown: () => this.reference.container.editorDown(),
                    getNid: () => this.reference.getNid(),
                    focus: () => this.reference.focus(),
                    focusNext: () => this.reference.focusNext(),
                    focusPrev: () => this.reference.focusPrev()
                }, {
                    field: this.reference.field,
                    onUpdate: () => {},
                    offUpdate: () => {},
                    getValue: e => e(void 0, this.reference.value),
                    setValue: (e, t) => this.reference.update(e, t),
                    isWritable: () => this.reference.isWritable()
                })
            }
            destroy()
            {
                this.editor.destroy()
            }
            nodeChanged()
            {
                this.editor.load(!1)
            }
            updateButtons() {}
            updateStructure()
            {
                this.editor.updateStructure(),
                this.editor.load(!0)
            }
            resize()
            {
                this.editor.resizeAux()
            }
            focus()
            {
                this.editor.focus()
            }
            startEdit()
            {
                this.editor.startEdit()
            }
            stopEdit()
            {
                this.editor.stopEdit()
            }
        }
        class Si {
            constructor(e)
            {
                K()(this, "reference", void 0),
                K()(this, "subDocument", void 0),
                K()(this, "$subDocument", void 0),
                K()(this, "$search", void 0),
                K()(this, "$create", void 0),
                K()(this, "$find", void 0),
                K()(this, "$unlink", void 0),
                this.reference = e,
                this.$create = $('<div class="stringeditor-button2"><div class="i-32-18 i-light-grey i-setting-add"></div></div>').attr("title", Object(b.getLocale)().addRowCreate).click(() => (this.reference.create(), !1)),
                this.$find = $('<div class="stringeditor-button"><div class="button i-32-18 i-light-grey i-search"></div></div>').attr("title", Object(b.getLocale)().addRowFind).click(() => (this.reference.find(), !1)),
                this.$search = $('<div class="stringeditor">').append('<div class="input-text text-selectable">').append(this.$create).append(this.$find).appendTo(this.reference.el).click(() => this.reference.find()),
                this.$subDocument = $('<div class="subdocument" style="display:none">').appendTo(this.reference.el);
                const t = $('<div class="subdocument-head">').appendTo(this.$subDocument),
                    i = $('<div class="subdocument-tabs">').appendTo(t);
                this.$unlink = $('<div class="subdocument-unlink i-light-grey i-18 i-unlink">').attr("title", Object(b.getLocale)().unlink).click(() => (this.reference.unlink(), !1)).appendTo(t);
                const o = $('<div class="subdocument-container">').appendTo(this.$subDocument);
                this.subDocument = new ci({
                    containerEl: o,
                    tabsEl: i,
                    isEmbedded: !0,
                    updateBackground: () => {}
                }, this.reference.field.refTypeId, {}, void 0)
            }
            destroy()
            {
                this.subDocument.destroy(),
                this.$subDocument.remove(),
                this.$search.remove()
            }
            nodeChanged()
            {
                const e = this.reference.getRef();
                e ? window.database.loadNode(e, (e, t) => {
                    this.updateSubDocument(t)
                }) : this.updateSubDocument(void 0)
            }
            updateButtons()
            {
                const e = this.reference.getRef();
                let t = !1,
                    i = !1,
                    o = !1;
                this.reference.isWritable() && (t = !e && window.database.canCreate(this.reference.field.refType) && !this.reference.field.refType.master, o = !!e && !this.reference.field.cascade, i = !e),
                this.$create && (this.$create[0].style.display = t ? "" : "none"),
                this.$find && (this.$find[0].style.display = i ? "" : "none"),
                this.$unlink && (this.$unlink[0].style.display = o ? "" : "none")
            }
            updateStructure()
            {
                this.subDocument && this.subDocument.updateStructure()
            }
            resize()
            {
                this.subDocument.resize()
            }
            updateSubDocument(e)
            {
                e ? (this.$search.css("display", "none"), this.$subDocument.css("display", ""), this.subDocument.bind(e)) : (this.$search.css("display", ""), this.$subDocument.css("display", "none"), this.subDocument.bind(null))
            }
        }
        class Ei {
            constructor(e)
            {
                K()(this, "reference", void 0),
                K()(this, "content", void 0),
                K()(this, "text", void 0),
                K()(this, "$create", void 0),
                K()(this, "$find", void 0),
                K()(this, "$unlink", void 0),
                this.reference = e,
                this.content = $('<div class="stringeditor">').appendTo(this.reference.el).click(() => (this.reference.open(), !1)),
                this.text = $('<div class="input-text text-selectable">').appendTo(this.content),
                this.$create = $('<div class="stringeditor-button2"><div class="i-32-18 i-light-grey i-setting-add"></div></div>').attr("title", Object(b.getLocale)().addRowCreate).click(() => (this.reference.create(), !1)).appendTo(this.content),
                this.$find = $('<div class="stringeditor-button"><div class="button i-32-18 i-light-grey i-search"></div></div>').attr("title", Object(b.getLocale)().addRowFind).click(() => (this.reference.find(), !1)).appendTo(this.content),
                this.$unlink = $('<div class="stringeditor-button"><div class="button i-32-18 i-light-grey i-unlink"></div></div>').attr("title", Object(b.getLocale)().unlink).click(() => (this.reference.unlink(), !1)).appendTo(this.content)
            }
            destroy()
            {
                this.content.remove()
            }
            nodeChanged()
            {
                this.reference.formatReference(e => {
                    this.text[0].innerText = e
                })
            }
            updateButtons()
            {
                const e = this.reference.isWritable(),
                    t = this.reference.getRef();
                let i = !1,
                    o = !1,
                    n = !1;
                e && (i = !t && window.database.canCreate(this.reference.field.refType) && !this.reference.field.refType.master, n = !!t && !this.reference.field.cascade, o = !t),
                this.$create && (this.$create[0].style.display = i ? "" : "none"),
                this.$find && (this.$find[0].style.display = o ? "" : "none"),
                this.$unlink && (this.$unlink[0].style.display = n ? "" : "none")
            }
            updateStructure() {}
            resize() {}
        }
        function _i(e) {
            const {values: t, isSelected: i, setSelected: o} = e;
            return a.createElement("div", {
                className: "choiceradio"
            }, t.map(e => a.createElement(Di, {
                key: e.id,
                value: e,
                isSelected: i(e.id),
                onClick: t => {
                    o(e.id, !i(e.id))
                }
            })))
        }
        function Di(e) {
            const {isSelected: t, value: i, onClick: o} = e;
            return a.createElement("div", {
                onClick: o,
                className: "choiceradio-item" + (t ? " selected" : ""),
                style: {
                    backgroundColor: t && i.color ? i.color : "",
                    color: e.isSelected ? e.value.textColor : ""
                }
            }, a.createElement("div", {
                className: "choiceradio-item-radio-container"
            }, a.createElement("div", {
                className: "choiceradio-item-radio"
            })), i.icon ? a.createElement("div", {
                className: "choice-symbol ic ic-" + i.icon
            }) : null, a.createElement("div", {
                className: "choiceradio-item-text",
                style: {
                    color: t && i.textColor || ""
                }
            }, i.caption))
        }
        class Mi {
            constructor(e)
            {
                K()(this, "reference", void 0),
                K()(this, "el", void 0),
                K()(this, "isDestroyed", !1),
                K()(this, "isReady", !1),
                K()(this, "query", void 0),
                this.reference = e,
                this.el = document.createElement("div"),
                this.reference.el[0].appendChild(this.el)
            }
            destroy()
            {
                var e;
                this.isDestroyed || (this.isDestroyed = !0, s.a.unmountComponentAtNode(this.el), null === (e = this.el.parentElement) || void 0 === e || e.removeChild(this.el))
            }
            nodeChanged()
            {
                this.isDestroyed || this.load()
            }
            updateButtons() {}
            updateStructure() {}
            resize() {}
            load()
            {
                this.isReady = !1,
                this.query && (this.query.destroy(), this.query = void 0),
                this.reference.field.viewConfig && (this.reference.field.viewConfig.type = this.reference.field.refTypeId),
                this.query = new b.QueryReference(window.database, this.reference.field, this.reference.container.nid),
                this.query.load(() => {
                    this.isDestroyed || this.updateDOM(this.el),
                    this.isReady = !0
                })
            }
            getValues()
            {
                const e = this.query;
                if (!e)
                    return [];
                window.database,
                this.reference.field;
                let t = 0;
                return e.rows.slice(0, 100).map(i => {
                    const o = e.models[i];
                    let n,
                        s,
                        a;
                    const r = [];
                    if (o)
                        for (let t = 0; t < e.cols.length; t++) {
                            const i = e.cols[t].expression.returnType;
                            "icon" === i.base ? n = o.values[t] : "color" === i.base ? (s = o.values[t], a = s ? b.util.contrastingTextColorTo(s) : void 0) : r.push(i.format(o.values[t]))
                        }
                    return t++, {
                        id: i,
                        caption: r.join(" "),
                        color: s,
                        textColor: a,
                        icon: n,
                        order: t
                    }
                })
            }
            getValue()
            {
                return this.reference.getRef()
            }
            setValue(e)
            {
                this.isReady && (null === e && this.reference.field.required || this.reference.update(e ? window.database.ridOf(e) : null))
            }
        }
        class Ni extends Mi {
            constructor(e)
            {
                super(e)
            }
            updateDOM(e)
            {
                s.a.render(a.createElement(_i, {
                    values: this.getValues(),
                    isSelected: e => e === this.getValue(),
                    setSelected: (e, t) => this.setValue(t ? e : null)
                }), e)
            }
        }
        function Ii(e) {
            const {values: t, isSelected: i, setSelected: o} = e;
            return a.createElement("div", {
                className: "choiceswitch"
            }, t.map(e => a.createElement(Oi, {
                key: e.id,
                value: e,
                isSelected: i(e.id),
                onClick: t => {
                    o(e.id, !i(e.id))
                }
            })))
        }
        function Oi(e) {
            const {isSelected: t, value: i, onClick: o} = e;
            return a.createElement("div", {
                onClick: o,
                className: "choiceswitch-item" + (t ? " selected" : ""),
                style: {
                    backgroundColor: t && i.color ? i.color : "",
                    color: e.isSelected ? e.value.textColor : ""
                }
            }, i.icon ? a.createElement("div", {
                className: "choice-symbol ic ic-" + i.icon
            }) : null, a.createElement("span", null, i.caption))
        }
        class Ri extends Mi {
            constructor(e)
            {
                super(e)
            }
            updateDOM(e)
            {
                s.a.render(a.createElement(Ii, {
                    values: this.getValues(),
                    isSelected: e => e === this.getValue(),
                    setSelected: (e, t) => this.setValue(t ? e : null)
                }), e)
            }
        }
        class ji extends Ot.a {
            constructor(e, t, i)
            {
                super(),
                K()(this, "container", void 0),
                K()(this, "field", void 0),
                K()(this, "visible", void 0),
                K()(this, "value", void 0),
                K()(this, "error", void 0),
                K()(this, "editor", void 0),
                K()(this, "el", void 0),
                K()(this, "label", void 0),
                K()(this, "renderer", void 0),
                K()(this, "currentLoadingId", 0),
                this.container = e,
                this.field = i,
                this.visible = !0,
                this.value = void 0,
                this.error = null,
                this.editor = void 0,
                this.el = $('<div class="component">').appendTo(t.el).data("component", this).attr("title", i.tooltip || "").addClass(Object(Bt.d)(i)),
                this.updateElementWidth(),
                "left" === i.labelPosition && this.el.addClass("label-left"),
                this.label = $("<label>").text(i.caption || Object(b.getLocale)().unnamed).css("display", "placeholder" === i.labelPosition || "none" === i.labelPosition ? "none" : "").appendTo(this.el),
                this.updateEditor(),
                this.updateButtons()
            }
            updateStructure()
            {
                this.el.attr("title", this.field.tooltip || ""),
                this.updateElementWidth(),
                this.label.text(this.field.caption || Object(b.getLocale)().unnamed).css("display", "placeholder" === this.field.labelPosition || "none" === this.field.labelPosition ? "none" : ""),
                this.el.toggleClass("label-left", "left" === this.field.labelPosition),
                this.updateEditor(),
                this.nodeChanged(),
                this.editor && this.editor.updateStructure()
            }
            updateEditor()
            {
                const e = this.field.referenceRenderer;
                if (!this.editor || e !== this.renderer)
                    switch (this.editor && (this.editor.destroy(), this.editor = void 0), this.renderer = e, e) {
                    case "embed":
                        this.editor = new Si(this);
                        break;
                    case "combo":
                        this.editor = new ki(this);
                        break;
                    case "switch":
                        this.editor = new Ri(this);
                        break;
                    case "radio":
                        this.editor = new Ni(this);
                        break;
                    default:
                        this.editor = new Ei(this)
                    }
            }
            updateButtons()
            {
                this.editor && this.editor.updateButtons()
            }
            resize()
            {
                this.editor && this.editor.resize()
            }
            destroy()
            {
                this.editor && this.editor.destroy(),
                this.el.remove()
            }
            bind()
            {
                this.nodeChanged()
            }
            nodeChanged()
            {
                this.updateIsWritable(),
                this.updateVisibility(),
                this.updateButtons();
                const e = this.container.nid;
                e && window.database.loadNode(e, (e, t) => {
                    this.value = !e && t ? t[this.field.id] : void 0,
                    this.editor && this.editor.nodeChanged(),
                    this.updateButtons(),
                    this.validate(this.value)
                })
            }
            find()
            {
                if (!this.isWritable())
                    return;
                const e = this.container.nid;
                e && new $i(e, this.field, {
                    backButtonCaption: this.field.type.caption,
                    select: e => {
                        this.update(window.database.ridOf(e))
                    },
                    saveViewConfig: e => {
                        this.saveConfigIfAdminMode(e)
                    },
                    create: window.database.canCreate(this.field.refType) ? () => {
                        this.create()
                    } : void 0
                })
            }
            update(e, t)
            {
                window.database.update(this.container.nid, this.field.id, e, e => {
                    e && $.alert(e),
                    t && t(e)
                })
            }
            saveConfigIfAdminMode(e)
            {
                Object(Bt.b)() && this.saveConfig(e)
            }
            saveConfig(e)
            {
                this.field.viewConfig = e,
                this.field.type.schema.trigger("change")
            }
            create()
            {
                if (!this.isWritable())
                    return;
                if (!window.database.canCreate(this.field.refType))
                    return;
                const e = this.container.nid;
                if (!e)
                    return;
                const t = {};
                t[this.field.refFieldId] = [b.schemas.ridOf(e)],
                window.database.create(this.field.refType, t, (e, t) => {
                    if (e)
                        return $.alert(e);
                    t ? (this.value = b.schemas.ridOf(t._id), this.open()) : this.value = void 0
                })
            }
            unlink()
            {
                const e = this.container.nid;
                e && window.database.update(e, this.field.id, null, e => {
                    if (e)
                        return $.alert(e)
                })
            }
            open()
            {
                if (this.value) {
                    const e = this.getRef();
                    if (this.field.isComposition)
                        new Vi.PopupEditor(e, {});
                    else {
                        const t = new Vi.PopupEditor(e, {
                            unlink: () => {
                                t.close(),
                                this.unlink()
                            }
                        })
                    }
                } else
                    this.find()
            }
            validate(e)
            {
                const t = this.field.validate(e);
                return t ? (this.setError(t), !1) : (this.setError(void 0), !0)
            }
            startEditCaption()
            {
                qt.prototype.startEditCaption.call(this)
            }
            formatReference(e)
            {
                if (!this.value)
                    return void e("");
                const t = this.getRef();
                window.database.loadNode(t, (t, i) => {
                    i ? this.field.referenceFormatExp ? this.field.referenceFormatExp.evaluate(window.database, i, (t, i) => {
                        e(t ? "ERROR: " + t : this.field.referenceFormatExp.returnType.format(i) || "")
                    }) : e(this.field.refType.format(i) || "") : e("")
                })
            }
            loadRecords(e, t)
            {
                const i = this.currentLoadingId + 1;
                this.currentLoadingId = i;
                const o = this,
                    n = window.database,
                    s = this.container.nid,
                    a = this.field,
                    r = a.constraintExp,
                    l = {};
                if (window.NINOX_APP)
                    if (r) {
                        const t = r.getSyncJS(),
                            i = n.loadNodeSync(s);
                        c(void 0, i ? n.selectFindSyncJS(a.refTypeId, e => t(t.ctx, n, void 0, {
                            a: i,
                            b: e
                        }), e, 0) : [])
                    } else
                        c(void 0, n.selectFindSyncJS(a.refTypeId, void 0, e, 0));
                else {
                    let t = null;
                    r && (t = r.resolve({
                        a: new b.queries.Record(a.type, new b.queries.Const(b.schemas.ridOf(s), b.schemas.tnumber)),
                        b: new b.queries.This(a.refType)
                    }));
                    const i = r ? "select " + a.refTypeId + " where (" + t.toString() + ")" : "select " + a.refTypeId;
                    n.find(i, e, c)
                }
                function c(e, t) {
                    i === o.currentLoadingId && n.loadNodes2(t, l, () => {
                        if (i === o.currentLoadingId)
                            return e ? d(e) : void d(void 0, t)
                    })
                }
                function d(e, n) {
                    i === o.currentLoadingId && (e && $.alert(e), t(n || []))
                }
            }
            getNid()
            {
                return this.container.nid
            }
            getRef()
            {
                return this.value ? this.field.refTypeId + this.value : void 0
            }
            focus()
            {
                var e;
                if (!this.visible)
                    return !1;
                if (!this.isWritable())
                    return !1;
                if (null === (e = this.editor) || void 0 === e ? void 0 : e.focus) {
                    if (window.NINOX_IOS)
                        this.editor.focus();
                    else {
                        var t;
                        const e = this.container && this.container.el || this.el.parent(),
                            i = e.offset().top,
                            o = i + e.height(),
                            n = e.scrollTop(),
                            s = (null === (t = this.el.offset()) || void 0 === t ? void 0 : t.top) || 0,
                            a = (this.el.height() || 0) + s + 8;
                        s < i ? e.scrollTop(n - (i - s)) : a > o && e.scrollTop(n + (a - o)),
                        setTimeout(() => {
                            var e;
                            (null === (e = this.editor) || void 0 === e ? void 0 : e.focus) && this.editor.focus()
                        }, 0)
                    }
                    return !0
                }
                return !1
            }
        }
        function Li(e, t, i) {
            var o = this;
            this.container = e,
            this.tab = t,
            this.field = i,
            this.visible = !0,
            this.reverseRenderer = i.reverseRenderer,
            this.cachedViewConfig = util.getPersistentViewConfig(i.viewConfig),
            this.query = new queries.QueryReverse(database, i, void 0),
            this.popupEditor = null,
            this.el = $('<div class="component editor reversefield">').data("component", this).attr("title", i.tooltip || "").touch($.proxy(this.clicked, this)),
            this.updateElementWidth(),
            this.el.appendTo(t.el),
            this.label = $("<label>").text(i.caption || locale.unnamed).appendTo(this.el),
            this.$content = $('<div class="stringeditor">').appendTo(this.el),
            this.$text = $('<div class="input-text reversefield-items">').appendTo(this.$content),
            this.$create = $('<div class="stringeditor-button2"><div class="i-32-18 i-light-grey i-setting-add"></div></div>').attr("title", locale.addRowCreate).touch((function() {
                return o.addRowCreate(), !1
            })).appendTo(this.$content),
            this.$find = $('<div class="stringeditor-button"><div class="button i-32-18 i-light-grey i-search"></div></div>').attr("title", locale.addRowFind).touch((function() {
                return o.addRowFind(), !1
            })).appendTo(this.$content),
            this.updateButtons(),
            this.updateHeight(),
            database.on("rename", void 0, this.nodeRenamed, this)
        }
        function Fi(e, t, i) {
            this.container = e,
            this.tab = t,
            this.field = i,
            this.visible = !0,
            this.reverseRenderer = i.reverseRenderer,
            this.el = $('<div class="component editor">').appendTo(t.el).data("component", this).attr("title", i.tooltip || ""),
            this.label = $("<label>").text(i.caption || locale.unnamed).appendTo(this.el),
            this.$content = $('<div style="background-color:green;height:32px;width:200px">LIST</div>').appendTo(this.el)
        }
        Object.assign(Li.prototype, Ot.a.prototype),
        Li.prototype.updateStructure = function() {
            var e = this.field;
            this.el.attr("title", e.tooltip || ""),
            this.updateElementWidth(),
            this.label.text(e.caption || locale.unnamed),
            util.viewConfigEquals(e.viewConfig, this.cachedViewConfig) || (this.cachedViewConfig = util.getPersistentViewConfig(this.field.viewConfig), this.query = new queries.QueryReverse(database, e, void 0), this.updateTable()),
            this.updateButtons(),
            this.updateHeight(),
            this.reload()
        },
        Li.prototype.updateRows = Li.prototype.updateTable = Li.prototype.updateAll = function() {
            for (var e = this.query, t = e.nidSelected, i = e.rows, o = e.cols, n = e.models, s = "", a = (e.type, this.canUnlink()), r = 0; r < i.length; r++) {
                var l = i[r],
                    c = n[l];
                if (c) {
                    for (var d = [], h = 0; h < o.length; h++) {
                        var p = o[h],
                            u = c.values[h];
                        if (null != u) {
                            var f = p.field.format(u);
                            f && d.push(f)
                        }
                    }
                    var m = d.join(" ") || locale.unnamed;
                    s += '<div class="reversefield-item' + (l === t ? " selected" : "") + '" data-nid="' + l + '"><span>' + htmlEscape(m) + "</span>" + (a ? '<div class="icon-medium-black icon-medium-unlink"></div>' : "") + "</div>"
                }
            }
            this.$text.html(s),
            this.updateButtons()
        },
        Li.prototype.updateHead = function() {},
        Li.prototype.updateFoot = function() {},
        Li.prototype.clicked = function(e) {
            var t = $(e.target),
                i = t.closest(".reversefield-item").attr("data-nid");
            i && (t.is(".icon-medium-unlink") ? this.unlinkFrom(i) : this.select(i))
        },
        Li.prototype.reload = Ti.prototype.reload,
        Li.prototype.bind = Ti.prototype.bind,
        Li.prototype.destroy = Ti.prototype.destroy,
        Li.prototype.nodeChanged = Ti.prototype.nodeChanged,
        Li.prototype.addRowFind = Ti.prototype.addRowFind,
        Li.prototype.addRowCreate = Ti.prototype.addRowCreate,
        Li.prototype.select = Ti.prototype.select,
        Li.prototype.unselect = Ti.prototype.unselect,
        Li.prototype.unlinkFrom = Ti.prototype.unlinkFrom,
        Li.prototype.selectPrev = function() {},
        Li.prototype.selectNext = function() {},
        Li.prototype.getSelectedNids = function() {
            return []
        },
        Li.prototype.duplicate = Ti.prototype.duplicate,
        Li.prototype.canUnlink = Ti.prototype.canUnlink,
        Li.prototype.canRemove = Ti.prototype.canRemove,
        Li.prototype.isWritable = Ti.prototype.isWritable,
        Li.prototype.nodeRenamed = Ti.prototype.nodeRenamed,
        Li.prototype.isHeightAdjustable = function() {
            return !0
        },
        Li.prototype.setHeight = function(e) {
            var t = this.field,
                i = t.height,
                o = Math.max(1, Math.round(e / 32));
            o !== i && (this.$content.css({
                height: 32 * o - 2
            }), this.$text.css({
                "white-space": o > 1 ? "normal" : ""
            }), t.height = o)
        },
        Li.prototype.updateHeight = function() {
            var e = this.field.height || 1;
            e = Math.max(1, Math.min(32, e));
            this.$content.css({
                height: 32 * e - 2
            }),
            this.$content.toggleClass("input-text-multiline", e > 1),
            this.$text.css({
                "white-space": e > 1 ? "normal" : ""
            })
        },
        Li.prototype.startEditCaption = qt.prototype.startEditCaption,
        Li.prototype.updateButtons = Ti.prototype.updateButtons,
        Object.assign(Fi.prototype, Ot.a.prototype);
        class Ai extends Ot.a {
            constructor(e, t, i)
            {
                super(),
                K()(this, "container", void 0),
                K()(this, "tab", void 0),
                K()(this, "field", void 0),
                K()(this, "el", void 0),
                K()(this, "label", void 0),
                K()(this, "content", void 0),
                K()(this, "isDestroyed", !1),
                K()(this, "query", void 0),
                K()(this, "nid", void 0),
                this.container = e,
                this.tab = t,
                this.field = i,
                this.el = $('<div class="component editor choice">').data("component", this).attr("title", i.tooltip || ""),
                this.updateElementWidth(),
                this.el.appendTo(t.el),
                this.label = $("<label>").text(i.caption || Object(b.getLocale)().unnamed).appendTo(this.el),
                this.content = $("<div>").appendTo(this.el)
            }
            destroy()
            {
                this.isDestroyed || (this.isDestroyed = !0, this.query && (this.query.destroy(), this.query = void 0), s.a.unmountComponentAtNode(this.content[0]), this.el.remove(), super.destroy())
            }
            bind(e)
            {
                this.query && (this.query.destroy(), this.query = void 0),
                this.field.viewConfig && (this.field.viewConfig.type = this.field.refTypeId),
                this.query = new b.Query(window.database, this.field.viewConfig || {
                    type: this.field.refTypeId
                }, !1),
                this.nid = e._id,
                this.reload()
            }
            updateStructure() {}
            isHeightAdjustable()
            {
                return !0
            }
            setHeight(e) {}
            updateHeight() {}
            startEditCaption() {}
            reload()
            {
                this.query && this.query.load(() => this.queryLoaded())
            }
            queryLoaded()
            {
                this.isDestroyed || this.updateDOM()
            }
            getValues()
            {
                const e = this.query;
                return e ? e.rows.slice(0, 100).map(t => {
                    const i = e.models[t];
                    let o,
                        n,
                        s;
                    const a = [];
                    if (i)
                        for (let t = 0; t < e.cols.length; t++) {
                            const r = e.cols[t].expression.returnType;
                            "icon" === r.base ? o = i.values[t] : "color" === r.base ? (n = i.values[t], s = n ? b.util.contrastingTextColorTo(n) : void 0) : a.push(r.format(i.values[t]))
                        }
                    return {
                        id: b.util.ridOf(t),
                        caption: a.join(" "),
                        color: n,
                        textColor: s,
                        icon: o
                    }
                }) : []
            }
            isSelected(e)
            {
                const t = window.database.loadNodeSync(this.nid);
                if (!t)
                    return !1;
                const i = t[this.field.id];
                return !!i && -1 !== i.indexOf(parseInt(e, 10))
            }
            setSelected(e, t)
            {
                const i = this.field.refTypeId + e;
                window.database.update(i, this.field.refFieldId, t ? b.util.ridOf(this.nid) : null, () => {
                    this.reload()
                })
            }
            updateDOM()
            {
                this.isDestroyed || s.a.render(a.createElement(_i, {
                    values: this.getValues(),
                    isSelected: e => this.isSelected(e),
                    setSelected: (e, t) => this.setSelected(e, t)
                }), this.content[0])
            }
        }
        function Hi(e, t, i) {
            this.container = e,
            this.field = i,
            this.visible = !0,
            this.el = $('<div class="component space">').data("component", this).attr("title", i.tooltip || "").css("height", i.height || 64),
            this.updateElementWidth(),
            this.el.appendTo(t.el)
        }
        function Pi(e, t) {
            this.container = e,
            this.id = t.id,
            this.field = t,
            this.visible = !1,
            this.hidden = !1,
            this.toolbox = void 0,
            this.children = [],
            this.components = [],
            this.elTab = $('<div class="tab">').attr("title", t.tooltip || "").touch($.proxy(this.clicked, this)).on("contextmenu", $.proxy(this.clicked, this)),
            this.textContainer = $("<div>").appendTo(this.elTab),
            this.tabSelectedIndicator = $('<div class="tab-selected-indicator">'),
            this.el = null,
            this.updateTab()
        }
        function Ui(e, t, i) {
            this.container = e,
            this.field = i,
            this.visible = !0,
            this.el = $('<div class="component text">').data("component", this).attr("title", i.tooltip || ""),
            this.updateElementWidth(),
            this.el.appendTo(t.el),
            this.label = $("<label>").text(i.caption).appendTo(this.el),
            this.updateStyle()
        }
        function zi(e, t, i) {
            Ti.call(this, e, t, i),
            this._cachedFn = i.fn
        }
        Object.assign(Hi.prototype, Ot.a.prototype),
        Hi.prototype.updateStructure = function() {
            var e = this.field;
            this.el.css("height", e.height || 64).attr("title", e.tooltip || ""),
            this.updateElementWidth()
        },
        Hi.prototype.isHeightAdjustable = function() {
            return !0
        },
        Hi.prototype.setHeight = function(e) {
            this.field.height = 8 * Math.max(1, Math.min(64, Math.round(e / 8))),
            this.updateStructure()
        },
        Pi.prototype.show = function() {
            if (this.hidden)
                return;
            if (this.visible)
                return;
            this.visible = !0;
            var e = this.container,
                t = this.children;
            let i = e.currentTab;
            i || (i = {
                hide: function(e) {
                    e()
                }
            }),
            i.hide(() => {
                e.currentTab = this,
                this.elTab.addClass("selected"),
                this.tabSelectedIndicator.appendTo(this.elTab),
                this.el = $('<div class="form">').appendTo(e.containerEl || e.el),
                Object(c.c)(this.field.beforeShow, this.container.nid, i => {
                    i && $.alert(i),
                    this.components = [];
                    for (var o = 0; o < t.length; o++) {
                        var n = t[o],
                            s = this.createComponent(n);
                        s && this.components.push(s)
                    }
                    var a = e.node;
                    a && this.bind(a),
                    this.container.updateBackground(this.field.bgColor),
                    this.updateTab()
                })
            })
        },
        Pi.prototype.updateTab = function() {
            var e = this.field;
            this.textContainer.text(e.caption),
            this.elTab.attr("title", e.tooltip || "")
        },
        Pi.prototype.createComponent = function(e) {
            if (database.canRead(e) && (!e.viewConfig || "none" !== e.viewConfig.mode) && (!e.visibilityExp || !e.visibilityExp.isConstant() || e.visibilityExp.evaluateSync(database, void 0))) {
                var t = this.container;
                if (!t.hideFields[e.id])
                    switch (e.base) {
                    case "space":
                        return new Vi.Space(t, this, e);
                    case "br":
                        return new Vi.BR(t, this, e);
                    case "head":
                        return new Vi.Head(t, this, e);
                    case "text":
                        return new Vi.Text(t, this, e);
                    case "custom":
                        return new Vi.Custom(t, this, e);
                    case "view":
                        return new Vi.View(t, this, e);
                    case "chart":
                        return new Vi.Chart(t, this, e);
                    case "button":
                        return new Vi.Button(t, this, e);
                    case "ref":
                        return new Vi.Reference(t, this, e);
                    case "rev":
                        return "field" === e.reverseRenderer ? new Vi.ReverseField(t, this, e) : "list" === e.reverseRenderer ? new Vi.ReverseList(t, this, e) : "radio" === e.reverseRenderer ? new Vi.ReverseRadio(t, this, e) : new Vi.Reverse(t, this, e);
                    case "file":
                        return new Vi.File(t, this, e);
                    default:
                        return e.isField ? new Vi.CmpField(t, this, e) : void 0
                    }
            }
        },
        Pi.prototype.updateStructure = function() {
            if (this.updateTab(), this.visible) {
                this.container.type;
                for (var e = this.components, t = this.children, i = {}, o = 0; o < t.length; o++) {
                    i[(r = t[o]).id] = r
                }
                var n = {};
                for (o = 0; o < e.length; o++) {
                    var s = i[(l = e[o]).field.id];
                    s ? (l.field = s, n[s.id] = l) : l.destroy()
                }
                var a = [];
                for (o = 0; o < t.length; o++) {
                    var r;
                    (l = n[(r = t[o]).id]) ? "rev" === r.base && r.reverseRenderer != l.reverseRenderer && (l.destroy(), l = this.createComponent(r)) : l = this.createComponent(r),
                    l && (l.field = r, a.push(l))
                }
                this.components = a;
                for (o = 0; o < a.length; o++) {
                    var l;
                    (l = a[o]).el.index() !== o && (o > 0 ? l.el.insertAfter(a[o - 1].el) : l.el.prependTo(this.el)),
                    l.updateStructure()
                }
                this.visible && this.container.updateBackground(this.field.bgColor)
            }
        },
        Pi.prototype.hide = function(e) {
            this.visible && (this.visible = !1, this.container.currentTab === this && (this.container.currentTab = void 0, this.container.updateBackground(), this.elTab.removeClass("selected"), this.tabSelectedIndicator.detach(), T.each(this.components, (function(e) {
                e.destroy()
            })), this.components = [], this.el.remove(), this.el = null, this.updateTab(), Object(c.c)(this.field.afterHide, this.container.nid, t => {
                t && $.alert(t),
                e && e()
            })))
        },
        Pi.prototype.bind = function(e) {
            this.updateVisibility(),
            this.visible && T.each(this.components, (function(t) {
                t.bind(e)
            }))
        },
        Pi.prototype.updateVisibility = function() {
            if (this.field.visibilityExp) {
                var e = this,
                    t = this._updateVisibilityId = Math.random();
                database.loadNode(e.container.nid, (function(i, o) {
                    o && e.field.visibilityExp.evaluate(database, o, (function(i, o) {
                        t === e._updateVisibilityId && e.setHidden(!i && !o)
                    }))
                }))
            } else
                this.hidden && this.setHidden(!1)
        },
        Pi.prototype.setHidden = function(e) {
            this.hidden = !!e,
            e ? (this.elTab[0].style.display = "none", this.blur(), this.visible && (this.hide(), this.container.selectTab("0"))) : this.elTab[0].style.display = ""
        },
        Pi.prototype.resize = function(e) {
            this.visible && T.each(this.components, (function(e) {
                e.resize && e.resize()
            }))
        },
        Pi.prototype.save = function() {
            this.visible && T.each(this.components, (function(e) {
                e.save && e.save()
            }))
        },
        Pi.prototype.nodeChanged = function() {
            this.updateVisibility(),
            this.visible && T.each(this.components, (function(e) {
                e.nodeChanged && e.nodeChanged()
            }))
        },
        Pi.prototype.blur = function() {
            this.visible && T.each(this.components, (function(e) {
                e.blur()
            }))
        },
        Pi.prototype.focus = function() {
            if (this.visible)
                for (var e = this.components, t = 0; t < e.length; t++) {
                    var i = e[t];
                    if (i.focus && i.focus())
                        return
                }
        },
        Pi.prototype.destroy = function() {
            this.hide(),
            this.elTab.remove()
        },
        Pi.prototype.clicked = function() {
            return this.container.currentTab === this ? Object(Bt.b)() && this.popup() : this.container.selectTab(this.id), !1
        },
        Pi.prototype.popup = function() {
            var e = this.field;
            if ("0" !== this.id) {
                var t = $.backplane({
                        close: function() {
                            o.destroy(),
                            n.destroy()
                        }
                    }),
                    i = $('<div class="nx-menu-popup grey" style="width:256px">').appendTo(t),
                    o = new Ue.a(this, e.getCaptionModel(), i, {
                        formWidth: .75
                    }),
                    n = new Ue.a(this, e.getBGColorModel(), i, {
                        formWidth: .25
                    });
                $('<div class="nx-menu-item">').append($('<div class="nx-menu-label">').text(locale.removeTab)).appendTo(i).touch((function() {
                    t.close(),
                    e.type.schema.removeField(e)
                }));
                var s = i.outerWidth(),
                    a = i.outerHeight(),
                    r = this.elTab.offset();
                r.top += this.elTab.outerHeight(),
                r.left + s > window.getWidth() - 1 && (r.left = window.getWidth() - s - 1),
                r.top + a > window.getHeight() && (r.top = window.getHeight() - a),
                i.offset(r)
            }
        },
        Pi.prototype.editorUp = function() {
            this.container.editorUp && this.container.editorUp()
        },
        Pi.prototype.editorDown = function() {
            console.log("Tab.editorDown"),
            this.container.editorDown && this.container.editorDown()
        },
        Pi.prototype.isWritable = function() {
            return this.container.isWritable()
        },
        Pi.prototype.columnsChanged = function() {
            T.each(this.components, (function(e) {
                e.updateElementWidth()
            }))
        },
        Object.assign(Ui.prototype, Ot.a.prototype),
        Ui.prototype.updateStructure = oi.prototype.updateStructure,
        Ui.prototype.updateStyle = oi.prototype.updateStyle,
        Ui.prototype.startEditCaption = qt.prototype.startEditCaption,
        Object.assign(zi.prototype, Ti.prototype),
        zi.prototype.createQuery = function() {
            try {
                return new queries.QueryExpression(database, this.field, this.container.nid)
            } catch (e) {
                return
            }
        },
        zi.prototype.updateButtons = function() {
            this.$controls[0].style.display = "none",
            this.$create[0].style.display = "none",
            this.$find[0].style.display = "none"
        },
        zi.prototype.addRowFind = function() {},
        zi.prototype.addRowCreate = function() {},
        zi.prototype.canUnlink = function() {
            return !1
        },
        zi.prototype.canRemove = function() {
            return !1
        },
        zi.prototype.queryNeedsUpdate = function() {
            var e = Ti.prototype.queryNeedsUpdate.call(this);
            return this.field.fn !== this._cachedFn ? (this._cachedFn = this.field.fn, !0) : e
        },
        zi.prototype.isWritable = function() {
            return !1
        };
        const Vi = {
            BR: Rt,
            Button: jt,
            Chart: zt,
            CommentsTab: Vt,
            Custom: Wt,
            CmpField: qt,
            File: ti,
            FilesTab: ii,
            Head: oi,
            HistoryTab: ni,
            PopupEditor: vi,
            Reference: ji,
            Reverse: Ti,
            ReverseField: Li,
            ReverseList: Fi,
            ReverseRadio: Ai,
            Space: Hi,
            Tab: Pi,
            Text: Ui,
            View: zi
        };
        o("./src/react/HomeHistory.css");
        function Wi({entries: e}) {
            return a.createElement("div", null, e.map((e, t) => a.createElement(Bi, {
                entry: e,
                key: t
            })))
        }
        function Bi({entry: {nid: e, change: t, time: i}}) {
            return a.createElement("div", {
                className: "History_entry",
                onClick: function() {
                    return new Vi.PopupEditor(e, {})
                }
            }, a.createElement("div", {
                className: "History_change"
            }, t), a.createElement("div", {
                className: "History_time"
            }, i))
        }
        class qi {
            constructor(e, t)
            {
                K()(this, "container", void 0),
                K()(this, "el", void 0),
                K()(this, "base", "history"),
                K()(this, "visible", !1),
                K()(this, "database", window.database),
                K()(this, "locale", Object(b.getLocale)()),
                this.container = e,
                this.el = $('<div class="admin-options" style="top:48px;background-color:rgba(255,255,255,.8)">')
            }
            getNavigationState()
            {
                return {
                    base: "history"
                }
            }
            destroy()
            {
                this.hide(),
                this.el.remove()
            }
            hide()
            {
                this.visible && (this.visible = !1, this.el.detach(), this.database.off("history", void 0, this.updateUI, this))
            }
            show()
            {
                Object(l.f)("History", "Open"),
                this.visible || (this.visible = !0, this.el.appendTo(this.container.el), this.updateUI(), this.database.on("history", void 0, this.updateUI, this))
            }
            async updateUI()
            {
                if (!this.visible)
                    return;
                if (!this.database.supports.history || !this.database.authorizationHistory)
                    return;
                const e = await this.getHistoryEntries();
                n.render(a.createElement(Wi, {
                    entries: e
                }), this.el[0])
            }
            async getHistoryEntries()
            {
                const e = await this.getHistory(),
                    t = ["create", "remove", "update", "comment"],
                    i = e.filter(e => t.includes(e[3])),
                    o = i.map(e => e[4]);
                return await this.preloadNodes(o), i.reduce((e, [t, i, o, n, s]) => {
                    const a = this.database.typeOf(s);
                    if (a && this.database.canRead(a)) {
                        const l = `${this.database.userName(i)}, ${function(e) {const t = Object(b.getLocale)(),i = e.getTime(),o = new Date,n = new Date(o.getFullYear(), o.getMonth(), o.getDate()).getTime(),s = new Date(o.getFullYear(), o.getMonth(), o.getDate() + 1).getTime(),a = new Date(o.getFullYear(), o.getMonth(), o.getDate() - 1).getTime();if (i >= n && i < s)return t.today;return i >= a && i < n ? t.yesterday : b.util.formatLocaleDate(e)}(new Date(o))} ${r = o, b.util.formatLocaleTime(r)}`;
                        if ("remove" === n)
                            return [...e, {
                                nid: s,
                                change: `${a.caption} #${b.schemas.ridOf(s)} ${this.locale.removed}`,
                                time: l,
                                seq: t
                            }];
                        const c = this.database.loadNodeSync(s);
                        if (c && !e[s]) {
                            const i = "create" === n ? `${a.caption} #${b.schemas.ridOf(s)} ${this.locale.created}` : "comment" === n ? `${a.caption} #${b.schemas.ridOf(s)} ${a.format(c).substr(0, 20)} ${this.locale.commented}` : `${a.caption} #${b.schemas.ridOf(s)} ${a.format(c).substr(0, 20)} ${this.locale.modified}`;
                            return [...e, {
                                nid: s,
                                change: i,
                                time: l,
                                seq: t
                            }]
                        }
                    }
                    var r;
                    return e
                }, [])
            }
            async preloadNodes(e)
            {
                return new Promise(t => {
                    this.database.loadNodes(e, () => t())
                })
            }
            async getHistory()
            {
                return new Promise((e, t) => {
                    this.database.loadHistory((i, o) => {
                        i ? t(i) : e(o)
                    })
                })
            }
        }
        o("./src/react/HomeTableList.css");
        const Yi = Object(Me.SortableHandle)(({hidden: e}) => a.createElement("span", {
                className: "HomeTableList_sortingHandleContainer"
            }, a.createElement("span", {
                className: "i-32-24 i-lighter-grey i-drag-handle"
            }), e ? a.createElement("span", {
                className: "Hud_hiddenTag"
            }, Object(b.getLocale)().hidden) : null)),
            Xi = Object(Me.SortableElement)(({value: e}) => a.createElement("span", {
                className: "home-table --ul-home-table"
            }, e)),
            Gi = Object(Me.SortableContainer)(({children: e}) => a.createElement("div", null, e));
        class Ji extends a.Component {
            constructor(e)
            {
                super(e),
                K()(this, "onSortEnd", (e, t, i) => {
                    e !== t && this.props.database.schema.updateTypeOrder(e, t, i)
                })
            }
            render()
            {
                const e = [],
                    t = this.props.database.schema.types;
                return b.util.localeSortBy(t, "order").map(t => {
                    if (this.shouldShowType(t) && !t.master) {
                        const i = t.getAllChildren().filter(e => this.shouldShowType(e)),
                            o = i.length > 0;
                        e.push(a.createElement(ee.a, {
                            key: t.id,
                            onFastClick: () => this.props.onTableClick(t.id)
                        }, this.props.database.adminMode && this.props.database.isAdminEnabled() ? a.createElement("div", {
                            style: {
                                position: "absolute",
                                left: -8
                            }
                        }, a.createElement(Yi, {
                            hidden: t.hidden
                        })) : null, o ? a.createElement(ee.a, {
                            onFastClick: e => this.props.onShowChildrenClick(e, i),
                            className: "HomeTableList_burgerMenuContainer"
                        }, a.createElement("div", {
                            className: "button i-32-24 i-light-grey i-setting-menu"
                        })) : null, a.createElement("div", {
                            className: "home-table-label"
                        }, t.caption || t.id)))
                    }
                }), this.renderSortable(e, null)
            }
            shouldShowType(e)
            {
                const t = this.props.database;
                return t.canRead(e) && !e.hidden || t.adminMode && t.isAdminEnabled()
            }
            renderSortable(e, t)
            {
                return a.createElement(a.Fragment, null, a.createElement(Gi, {
                    onSortEnd: e => this.onSortEnd(e.oldIndex, e.newIndex, t),
                    axis: "xy",
                    useDragHandle: !0
                }, e.map((e, t) => a.createElement(Xi, {
                    key: `item-${t}`,
                    index: t,
                    value: e
                }))), this.props.database.adminMode && this.props.database.isAdminEnabled() ? a.createElement(ee.a, {
                    className: "home-table home-table-add --ul-add-table-button",
                    onFastClick: this.props.onAddTableClick,
                    rippleStyle: "LIGHT"
                }, a.createElement("div", {
                    className: "home-table-label"
                }, a.createElement("div", {
                    className: "i-24-24 i-light-grey i-plus",
                    style: {
                        margin: "0 auto 8px auto"
                    }
                }), a.createElement("div", null, Object(b.getLocale)().addTable))) : null, this.props.database.authorizationImport ? a.createElement(ee.a, {
                    rippleStyle: "LIGHT",
                    className: "home-table home-table-add",
                    onFastClick: this.props.onImportClick
                }, a.createElement("div", {
                    className: "home-table-label"
                }, a.createElement("div", {
                    className: "i-24-24 i-light-grey i-setting-import",
                    style: {
                        margin: "0 auto 8px auto"
                    }
                }), a.createElement("div", null, Object(b.getLocale)().importData))) : null, window.NINOX_APP && this.props.database.isAdmin() ? a.createElement(ee.a, {
                    className: "home-table home-table-add",
                    onFastClick: this.props.onExportClick,
                    rippleStyle: "LIGHT"
                }, a.createElement("div", {
                    className: "home-table-label"
                }, a.createElement("div", {
                    className: "i-24-24 i-light-grey i-setting-export",
                    style: {
                        margin: "0 auto 8px auto"
                    }
                }), a.createElement("div", null, Object(b.getLocale)().exportData))) : null)
            }
        }
        class Ki {
            constructor(e, t)
            {
                this.container = e,
                this.visible = !1,
                this.el = $('<div class="home home-tables">'),
                database.on("schema", void 0, this.schemaChanged, this),
                database.on("admin", void 0, this.schemaChanged, this),
                this.base = "tables"
            }
            getNavigationState()
            {
                return {
                    base: "tables"
                }
            }
            destroy()
            {
                database.off("admin", void 0, this.schemaChanged, this),
                database.off("schema", void 0, this.schemaChanged, this),
                n.unmountComponentAtNode(this.el[0]),
                this.el.remove()
            }
            hide()
            {
                this.visible && (n.unmountComponentAtNode(this.el[0]), this.visible = !1, this.el.detach())
            }
            show()
            {
                this.visible || (this.visible = !0, this.el.appendTo(this.container.el), this.updateUI())
            }
            schemaChanged(e, t, i)
            {
                this.updateUI()
            }
            updateUI()
            {
                this.visible && n.render(a.createElement(Ji, {
                    database: database,
                    onTableClick: e => ui.openTable(e),
                    onShowChildrenClick: (e, t) => this.showChildrenList(e, t),
                    onAddTableClick: () => {
                        Object(l.f)("DatabaseHomeTable", "Create"),
                        new _t({})
                    },
                    onExportClick: () => {
                        Object(l.f)("DatabaseHome", "ExportData"),
                        new Be({})
                    },
                    onImportClick: () => {
                        Object(l.f)("DatabaseHome", "ImportData"),
                        new Ye({})
                    }
                }), this.el[0])
            }
            showChildrenList(e, t)
            {
                var i = $.backplane({}),
                    o = $('<div class="nx-menu-popup">').appendTo(i);
                T.each(b.util.localeSortBy(t, "order"), (function(e) {
                    $('<div class="nx-menu-item">').append($('<div class="nx-menu-label">').text(e.caption)).appendTo(o).click((function() {
                        i.close(),
                        ui.openTable(e.id)
                    }))
                }));
                const n = $(e.event.target);
                var s = n.offset(),
                    a = o.outerWidth(),
                    r = o.outerHeight();
                return s.top += 32, s.left += n.width() - 32, s.left + a > window.getWidth() && (s.left = window.getWidth() - a), s.top + r > window.getHeight() && (s.top = window.getHeight() - r), o.offset(s), !1
            }
        }
        function Qi(e, t) {
            var i = Object.keys(e);
            if (Object.getOwnPropertySymbols) {
                var o = Object.getOwnPropertySymbols(e);
                t && (o = o.filter((function(t) {
                    return Object.getOwnPropertyDescriptor(e, t).enumerable
                }))),
                i.push.apply(i, o)
            }
            return i
        }
        function Zi(e) {
            for (var t = 1; t < arguments.length; t++) {
                var i = null != arguments[t] ? arguments[t] : {};
                t % 2 ? Qi(Object(i), !0).forEach((function(t) {
                    K()(e, t, i[t])
                })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(i)) : Qi(Object(i)).forEach((function(t) {
                    Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(i, t))
                }))
            }
            return e
        }
        class eo {
            constructor()
            {
                K()(this, "base", "home"),
                K()(this, "visible", void 0),
                K()(this, "view", void 0),
                K()(this, "el", void 0),
                K()(this, "$tabs", void 0),
                this.visible = !1,
                this.view = void 0,
                this.resizeBackground = this.resizeBackground.bind(this),
                this.el = $('<div class="home">'),
                this.$tabs = $('<div class="secondary-tabs">'),
                this.updateBackground(),
                window.database.on("admin", void 0, this.adminChanged, this)
            }
            getTabs(e)
            {
                const t = [];
                return t.push({
                    id: "tables",
                    iconClass: "",
                    isSelected: "tables" === e,
                    text: Object(b.getLocale)().tables
                }), window.database.supports.history && window.database.authorizationHistory && t.push({
                    id: "history",
                    iconClass: "",
                    isSelected: "history" === e,
                    text: Object(b.getLocale)().history
                }), window.database.adminMode && window.database.adminEnabled && window.database.isAdmin() && (t.push({
                    id: "schema",
                    iconClass: "",
                    isSelected: "schema" === e,
                    text: Object(b.getLocale)().dataModel
                }), t.push({
                    id: "options",
                    iconClass: "",
                    isSelected: "options" === e,
                    text: Object(b.getLocale)().options
                }), window.database.supports.authentication && t.push({
                    id: "security",
                    iconClass: "",
                    isSelected: "security" === e,
                    text: Object(b.getLocale)().security
                }), t.push({
                    id: "console",
                    iconClass: "",
                    isSelected: "console" === e,
                    text: "Console"
                })), t
            }
            getNavigationState()
            {
                return {
                    base: "home",
                    view: void 0 === this.view ? {
                        base: "tables"
                    } : this.view.getNavigationState()
                }
            }
            setNavigationState(e)
            {
                let t = e.vid;
                var i,
                    o;
                "default" === t && (t = null !== (i = null === (o = e.view) || void 0 === o ? void 0 : o.base) && void 0 !== i ? i : "tables", be(Zi({}, xe(), {
                    vid: t
                })));
                const n = {
                    base: t
                };
                switch (n.base) {
                case "tables":
                case "history":
                    this.createView(n);
                    break;
                case "schema":
                case "options":
                case "security":
                case "console":
                case "localizations":
                    window.database.adminMode ? this.createView(n) : (be(Zi({}, xe(), {
                        vid: "tables"
                    })), this.createView({
                        base: "tables"
                    }));
                    break;
                default:
                    this.setNavigationState({
                        vid: "default"
                    })
                }
            }
            navigateToView(e)
            {
                ve(Zi({}, xe(), {
                    vid: e
                }))
            }
            createView(e)
            {
                const t = e.base;
                if (this.view) {
                    if (t === this.view.base)
                        return void (this.view.visible || this.view.show());
                    this.view.destroy(),
                    this.view = void 0
                }
                switch (t) {
                case "history":
                    this.view = new qi(this, e);
                    break;
                case "schema":
                    this.view = new Dt(this, e);
                    break;
                case "options":
                    this.view = new gt(this, e);
                    break;
                case "security":
                    this.view = new Mt(this, e);
                    break;
                case "console":
                    this.view = new It(this, e);
                    break;
                case "localization":
                    this.view = new pt(this, e, window.database);
                    break;
                default:
                    this.view = new Ki(this, e)
                }
                this.view.show(),
                this.updateTabs()
            }
            updateTabs()
            {
                if (!this.visible || !this.view)
                    return;
                const e = this.view.base;
                s.a.render(r.a.createElement(Pe.a, {
                    items: this.getTabs(e),
                    currentItemId: e,
                    onItemSelect: e => this.navigateToView(e),
                    onContextMenuClick: () => {},
                    onNewItemClick: null,
                    popupItemBackground: "OFF_WHITE"
                }), this.$tabs[0])
            }
            adminChanged()
            {
                window.database.adminMode || !this.visible || {
                    tables: !0,
                    history: !0
                }[this.view.base] ? this.updateTabs() : this.navigateToView("tables")
            }
            destroy()
            {
                var e;
                window.database.off("admin", void 0, this.adminChanged, this),
                this.hide(),
                this.$tabs.remove(),
                this.el.remove(),
                null === (e = this.view) || void 0 === e || e.destroy()
            }
            show()
            {
                this.visible || (this.visible = !0, this.$tabs.appendTo(window.ui.$header), this.el.appendTo(window.ui.$body), this.updateTabs(), window.NINOX_IOS && window.addEventListener("orientationchange", this.resizeBackground), $.pushInputHandler(this))
            }
            hide()
            {
                this.visible && (this.visible = !1, this.view && this.view.hide(), this.el.detach(), s.a.unmountComponentAtNode(this.$tabs[0]), this.$tabs.detach(), window.NINOX_IOS && window.removeEventListener("orientationchange", this.resizeBackground), $.popInputHandler(this))
            }
            resizeBackground()
            {
                if (window.NINOX_IOS) {
                    const e = this.el[0];
                    0 === window.orientation || 180 === window.orientation ? (e.style.width = screen.width + "px", e.style.height = screen.height - 90 + "px") : (e.style.width = screen.height + "px", e.style.height = screen.width - 90 + "px")
                }
            }
            menuNewTableEnabled()
            {
                return !!window.database.adminEnabled
            }
            menuNewTable()
            {
                window.database.adminEnabled && new _t({})
            }
            menuImportDataEnabled()
            {
                return !!window.database.authorizationImport
            }
            menuImportData()
            {
                window.database.authorizationImport && new Ye({})
            }
            menuExportDataEnabled()
            {
                return !!window.database.authorizationExport
            }
            menuExportData()
            {
                window.database.authorizationExport && new Be({})
            }
            async updateBackground(e)
            {
                const t = this.el[0],
                    i = window.database.settings || {},
                    o = window.database.account && window.database.account.settings && window.database.account.settings.databaseBackgroundCustomCSS;
                if (o) {
                    for (const e in o)
                        if (o.hasOwnProperty(e)) {
                            let i = o[e];
                            const n = /^url\((.*)\)$/.exec(i);
                            if (n) {
                                const e = n[1];
                                i = "url(" + (await window.localFileSystem.cachedURL(e, null) || e) + ")"
                            }
                            t.style[e] = i
                        }
                } else {
                    if (null == i.bgType)
                        t.className = "home background-file default",
                        t.style.backgroundImage = "",
                        t.style.backgroundColor = "";
                    else if ("solid" === i.bgType)
                        t.className = "home",
                        t.style.backgroundImage = "",
                        t.style.backgroundColor = i.bgColor || "";
                    else if ("gradient" === i.bgType)
                        t.className = "home",
                        t.style.backgroundImage = "linear-gradient(" + (i.bgGradient0 || "#ccc") + " 0%, " + (i.bgGradient1 || "#aaa") + " 100%)",
                        t.style.backgroundColor = "";
                    else if ("image" === i.bgType)
                        t.className = "home background-file",
                        t.style.backgroundImage = 'url("' + window.database.backgroundURL(e) + '")',
                        t.style.backgroundColor = i.bgColor || "";
                    else {
                        const o = i.backgroundClass || "background";
                        t.className = "home background " + o,
                        "background-file" === o ? (t.style.backgroundImage = 'url("' + window.database.backgroundURL(e) + '")', t.style.backgroundColor = i.bgColor || "") : (t.style.backgroundImage = "", t.style.backgroundColor = "")
                    }
                    t.style.backgroundPosition = (i.bgPosH || "center") + " " + (i.bgPosV || "center"),
                    t.style.backgroundSize = i.bgSize || "cover",
                    t.style.backgroundRepeat = i.bgRepeat || "no-repeat"
                }
            }
        }
        var to = o("./src/react/util/general.ts");
        o("./src/react/util/SimpleContextMenu.css");
        class io extends a.Component {
            constructor(e)
            {
                super(e)
            }
            render()
            {
                return a.createElement(nt.a, {
                    positionAdjustment: this.props.positionAdjustment,
                    clickTarget: this.props.clickTarget,
                    show: this.props.show,
                    settings: {
                        style: "tooltip",
                        arrowColor: "white"
                    },
                    onClick: this.props.onClick,
                    className: "SimpleContextMenu_container",
                    killWhenTargetIsNull: this.props.killWhenTargetIsNull
                }, 0 === this.props.items.length ? a.createElement("div", {
                    className: "SimpleContextMenu_emptyText"
                }, Object(b.getLocale)().errorNotAuthorized) : this.props.items.map((e, t) => a.createElement(ee.a, {
                    key: e.text + t,
                    className: Object(to.a)("nx-menu-item", {
                        "nx-menu-item-selected": !0 === e.isSelected,
                        "nx-menu-item-disabled": !0 === e.disabled,
                        "nx-menu-item-divider": !0 === e.topBorder
                    }),
                    onFastClick: t => {
                        e.disabled || (this.props.onClick(), e.onClick(t))
                    }
                }, e.isSelected ? a.createElement("div", {
                    className: "nx-menu-item-selected-indicator"
                }) : null, a.createElement("div", {
                    className: "nx-menu-label"
                }, e.text))))
            }
        }
        const oo = 36e5,
            no = 24 * oo;
        function so(e) {
            var t = this;
            this.calendar = e,
            this.nodes = {},
            this.days = 5,
            this.showFullDay = !1,
            this.el = $('<div class="calendar-week">'),
            this.$head = $('<div class="calendar-week-header">').appendTo(this.el),
            this.$body = $('<div class="calendar-week-body">').appendTo(this.el),
            this.$nav = $('<div class="hud-menu-group" style="margin-left:8px">'),
            this.$controls = $('<div class="calendar-controls">'),
            this.smallContextMenuTarget = null,
            this.$controlsSmall = $('<div class="hud-menu-button i-32-24 i-light-grey i-column">').click(e => {
                this.smallContextMenuTarget = e.target,
                this.updateUI()
            }),
            $('<div class="button i-32-24 i-light-grey i-arrow-solid-left">').appendTo(this.$nav).touch($.proxy(this.prevWeek, this)),
            this.$label = $('<div class="calendar-week-label">').appendTo(this.$nav).touch($.proxy(this.popupMiniCalendar, this)),
            $('<div class="button i-32-24 i-light-grey i-arrow-solid-right">').appendTo(this.$nav).touch($.proxy(this.nextWeek, this)),
            this.$show7Days = $('<div class="button option first">').text(locale.sevenDays).appendTo(this.$controls).touch((function() {
                t.setDays(7),
                t.load()
            })),
            this.$show5Days = $('<div class="button option selected">').text(locale.fiveDays).appendTo(this.$controls).touch((function() {
                t.setDays(5),
                t.load()
            })),
            this.$show1Days = $('<div class="button option last">').text(locale.oneDay).appendTo(this.$controls).touch((function() {
                t.setDays(1),
                t.load()
            })),
            this.$showFullDay = $('<div class="button option first last selected" style="margin-left:8px">').text(locale.showOnlyWorkHours).appendTo(this.$controls).touch((function() {
                t.setShowFullDay(!t.showFullDay),
                t.load()
            })),
            this.el.click((function(e) {
                var i = $(e.target).closest(".calendar-week-full-box,.calendar-week-box,.calendar-week-cell"),
                    o = i.data("nid"),
                    n = i.data("time");
                o ? new Vi.PopupEditor(o, {
                    duplicate: !0
                }) : n && function(e) {
                    var i = [];
                    if (T.each(database.schema.types, (function(e) {
                        database.canCreate(e) && T.each(e.fields, (function(e) {
                            "appointment" === e.base && database.canWrite(e) && i.push(e)
                        }))
                    })), 0 === i.length)
                        return void $.notify(locale.calendarCreateAppointmentField);
                    var o = $(e.target).data("time"),
                        n = new Date(o),
                        s = $.backplane({}),
                        a = $('<div class="nx-menu-popup grey" style="border-radius:4px">').appendTo(s);
                    $("<h1>").text(locale.createRecord).appendTo(a),
                    $('<div style="text-align:center;padding:8px 0">').text(util.formatLocaleDate(n)).appendTo(a);
                    var r = $('<div style="padding:8px 0">').appendTo(a);
                    $("<label>").text(locale.appointmentBegin + " ").appendTo(r);
                    var l = $('<input type="text" class="appointment-time">').val(ao(n)).appendTo(r);
                    $("<label>").text(" " + locale.appointmentEnd + " ").appendTo(r);
                    var c = $('<input type="text" class="appointment-time">').val(ao(new Date(o + oo))).appendTo(r);
                    TOUCH && (l.attr("type", "time"), c.attr("type", "time"));
                    T.each(i, (function(e) {
                        var i = e.type;
                        $('<div class="nx-menu-item">').append($('<div class="nx-menu-icon i-32-24 i-grey i-setting-add">')).append($('<div class="nx-menu-label">').text(i.caption + " (" + e.caption + ")")).appendTo(a).touch((function() {
                            var o = ro(l.val()),
                                a = ro(c.val()) - o;
                            if (!(a < 0)) {
                                var r = new Date(n.getFullYear(), n.getMonth(), n.getDate()).getTime() + o;
                                s.close();
                                var d = {};
                                d[e.id] = r + "/" + a,
                                database.create(i, d, (function(e, i) {
                                    if (e)
                                        return $.alert(e);
                                    t.nodes[i._id] = i,
                                    t.updateUI(),
                                    new Vi.PopupEditor(i._id, {
                                        duplicate: !0
                                    })
                                }))
                            }
                        }))
                    }));
                    var d = a.outerWidth(),
                        h = a.outerHeight(),
                        p = {
                            left: e.clientX - 24,
                            top: e.clientY + 16
                        };
                    p.left + d > window.getWidth() && (p.left = window.getWidth() - d);
                    p.top + h > window.getHeight() && (p.top = window.getHeight() - h);
                    a.offset(p)
                }(e)
            }));
            var i = new Date;
            this.start = new Date(i.getFullYear(), i.getMonth(), i.getDate()),
            this.resizeListener = T.debounce($.proxy(this.updateUI, this), 100),
            this.updateLabel()
        }
        function ao(e) {
            var t = e.getHours(),
                i = e.getMinutes();
            return (t < 10 ? "0" : "") + t + ":" + (i < 10 ? "0" : "") + i
        }
        function ro(e) {
            if (!e || "string" != typeof e)
                return 0;
            var t = e.split(":");
            if (2 !== t.length)
                return 0;
            var i = 36e5 * parseInt(t[0]) + 6e4 * parseInt(t[1]);
            return isNaN(i) ? 0 : i
        }
        function lo(e) {
            this.calendar = e,
            this.visible = !1,
            this.el = $('<div class="calendar-month">'),
            this.controls = $('<div class="hud-menu-group" style="margin-left:8px">'),
            $('<div class="button i-32-24 i-light-grey i-arrow-solid-first">').appendTo(this.controls).touch($.proxy(this.prevYear, this)),
            $('<div class="button i-32-24 i-light-grey i-arrow-solid-left">').appendTo(this.controls).touch($.proxy(this.prevMonth, this)),
            this.label = $('<div class="calendar-month-label">').appendTo(this.controls).touch($.proxy(this.popupMiniCalendar, this)),
            $('<div class="button i-32-24 i-light-grey i-arrow-solid-right">').appendTo(this.controls).touch($.proxy(this.nextMonth, this)),
            $('<div class="button i-32-24 i-light-grey i-arrow-solid-last">').appendTo(this.controls).touch($.proxy(this.nextYear, this)),
            this.table = $('<table class="calendar-table">').appendTo(this.el),
            this.thead = $("<thead>").appendTo(this.table),
            this.trhead = $("<tr>").appendTo(this.thead),
            $('<th class="calendar-month-week">').text(locale.calendarWeek).appendTo(this.trhead);
            for (var t = 0; t < 7; t++)
                $("<th>").text(locale.dayNames[(t + locale.firstDayOfWeek) % 7]).appendTo(this.trhead);
            this.tbody = $("<tbody>").appendTo(this.table),
            this.trs = [],
            this.tds = [],
            this.cells = [];
            for (var i = 0; i < 6; i++) {
                var o = $("<tr>").appendTo(this.tbody);
                this.trs.push(o),
                this.tds.push($('<th class="calendar-month-week">').appendTo(o));
                for (var n = 0; n < 7; n++) {
                    var s = 7 * i + n,
                        a = $("<td>").appendTo(o).data("index", s);
                    this.cells[s] = new co(this, a, s)
                }
            }
            var r = new Date;
            this.setDate(r.getFullYear(), r.getMonth())
        }
        function co(e, t, i) {
            this.calendar = e,
            this.td = t,
            this.index = i,
            this.refs = {}
        }
        function ho(e, t) {
            var i = Object.keys(e);
            if (Object.getOwnPropertySymbols) {
                var o = Object.getOwnPropertySymbols(e);
                t && (o = o.filter((function(t) {
                    return Object.getOwnPropertyDescriptor(e, t).enumerable
                }))),
                i.push.apply(i, o)
            }
            return i
        }
        function po(e) {
            for (var t = 1; t < arguments.length; t++) {
                var i = null != arguments[t] ? arguments[t] : {};
                t % 2 ? ho(Object(i), !0).forEach((function(t) {
                    K()(e, t, i[t])
                })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(i)) : ho(Object(i)).forEach((function(t) {
                    Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(i, t))
                }))
            }
            return e
        }
        function uo() {
            this.visible = !1,
            this.tabs = $('<div class="secondary-tabs" style="display:flex;display:-webkit-flex">'),
            this.calendarMonth = new lo(this),
            this.calendarWeek = new so(this),
            this.tabMonth = $('<div class="secondary-tab">').text(locale.month).appendTo(this.tabs).touch((function() {
                ve(po({}, xe(), {
                    vid: "month"
                }))
            })),
            this.tabWeek = $('<div class="secondary-tab">').text(locale.week).appendTo(this.tabs).touch((function() {
                ve(po({}, xe(), {
                    vid: "week"
                }))
            })),
            this.currentTab = this.calendarWeek,
            this.tabWeek.addClass("selected"),
            this.currentDate = null
        }
        function fo(e) {
            var t = e.year,
                i = new Date,
                o = e.selectedDay,
                n = $.backplane({}),
                s = $('<div class="nx-menu-popup minical-popup">').css({
                    top: 40,
                    left: ui.leftWidth
                }).appendTo(n),
                a = $('<div class="minical">').appendTo(s).touch((function(t) {
                    if (e.selectMonth) {
                        var i = $(t.target).closest(".minical-month");
                        i.length && (e.selectMonth(parseInt(i.attr("data-year")), parseInt(i.attr("data-month"))), n.close())
                    } else if (e.selectDay) {
                        var o = $(t.target).closest(".minical-day");
                        o.length && (e.selectDay(parseInt(o.attr("data-year")), parseInt(o.attr("data-month")), parseInt(o.attr("data-day"))), n.close())
                    }
                }));
            e.selectMonth ? a.addClass("minical-monthselectable") : e.selectDay && a.addClass("minical-dayselectable");
            for (var r = $('<div class="minical-months">').appendTo(a), l = 0; l < 12; l++) {
                var c = new Date(t, l, 1),
                    d = c.getDay(),
                    h = locale.firstDayOfWeek,
                    p = d >= h ? h - d + 1 : h - d - 6,
                    u = new Date(c.getFullYear(), c.getMonth(), p),
                    f = $('<div class="minical-month" data-year="' + t + '" data-month="' + l + '">').appendTo(r);
                $('<div class="minical-month-label">').text(locale.monthNames[l]).appendTo(f);
                for (var m = $('<div class="minical-days">').appendTo(f), g = 0; g < 6; g++)
                    for (var v = 0; v < 7; v++) {
                        var b = new Date(u.getFullYear(), u.getMonth(), u.getDate() + 7 * g + v),
                            y = b.getFullYear() === t && b.getMonth() === l,
                            w = b.getFullYear() === i.getFullYear() && b.getMonth() === i.getMonth() && b.getDate() === i.getDate(),
                            x = o && b.getFullYear() === o.getFullYear() && b.getMonth() === o.getMonth() && b.getDate() === o.getDate();
                        $('<div class="minical-day ' + (y ? x ? "selected" : w ? "today" : "this-month" : "other-month") + '" data-day="' + b.getDate() + '" data-year="' + b.getFullYear() + '" data-month="' + b.getMonth() + '">').text(b.getDate()).appendTo(m)
                    }
            }
        }
        function mo(e, t) {
            var i = Object.keys(e);
            if (Object.getOwnPropertySymbols) {
                var o = Object.getOwnPropertySymbols(e);
                t && (o = o.filter((function(t) {
                    return Object.getOwnPropertyDescriptor(e, t).enumerable
                }))),
                i.push.apply(i, o)
            }
            return i
        }
        so.prototype.destroy = function() {
            this.hide(),
            this.el.remove(),
            this.$controls.remove(),
            this.$nav.remove()
        },
        so.prototype.prevWeek = function() {
            var e = this.start;
            1 === this.days ? this.start = new Date(e.getFullYear(), e.getMonth(), e.getDate() - 1) : this.start = new Date(e.getFullYear(), e.getMonth(), e.getDate() - 7),
            this.updateLabel(),
            this.load(),
            this.calendar.dateChanged(this.start)
        },
        so.prototype.nextWeek = function() {
            var e = this.start;
            e = this.start;
            1 === this.days ? this.start = new Date(e.getFullYear(), e.getMonth(), e.getDate() + 1) : this.start = new Date(e.getFullYear(), e.getMonth(), e.getDate() + 7),
            this.updateLabel(),
            this.load(),
            this.calendar.dateChanged(this.start)
        },
        so.prototype.show = function(e) {
            this.visible || (this.visible = !0, e && this.setDate(e, !1), this.$nav.appendTo(ui.$menuCenter), this.$controls.appendTo(ui.$menuCenter), this.$controlsSmall.appendTo(ui.$menuCenter), this.el.appendTo(ui.$body), this.load(!0), database.on("schema", void 0, this.schemaChanged, this), database.onChange(void 0, this.databaseChange, this), database.onRemove(void 0, this.databaseRemove, this), database.onCreate(void 0, this.databaseCreate, this), $(window).on("resize", this.resizeListener))
        },
        so.prototype.hide = function() {
            this.visible && (this.visible = !1, this.$controls.detach(), this.$controlsSmall.detach(), this.$nav.detach(), this.el.detach(), this.nodes = {}, database.off("schema", void 0, this.schemaChanged, this), database.offChange(void 0, this.databaseChange, this), database.offRemove(void 0, this.databaseRemove, this), database.offCreate(void 0, this.databaseCreate, this), $(window).off("resize", this.resizeListener))
        },
        so.prototype.bodyResized = function() {
            this.updateUI()
        },
        so.prototype.schemaChanged = function(e, t, i) {
            this.load()
        },
        so.prototype.databaseChange = function(e, t) {
            var i = this;
            i.nodes[t] && database.loadNode(t, (function(e, o) {
                i.nodes && i.nodes[t] && (i.nodes[t] = o, i.updateUI())
            }))
        },
        so.prototype.databaseRemove = function(e, t) {
            this.nodes[t] && (delete this.nodes[t], this.updateUI())
        },
        so.prototype.databaseCreate = function(e, t, i) {
            var o = this;
            database.loadNode(i, (function(e, t) {
                t && (o.nodes[i] = t, o.updateUI())
            }))
        },
        so.prototype.load = function() {
            var e = this,
                t = this.days,
                i = this.start,
                o = new Date(i.getFullYear(), i.getMonth(), i.getDate() + t);
            database.loadCalendarFromTo(i, o, (function(t, i) {
                e.updateRefs(i || [])
            }))
        },
        so.prototype.updateRefs = function(e) {
            var t = this,
                i = {},
                o = (e = T.uniq(e), this.calendar.getDependencies());
            database.loadNodes2(e, o, (function() {
                database.filterReadable(void 0, e, (function(e) {
                    for (var o = 0; o < e.length; o++) {
                        var n = e[o],
                            s = database.loadNodeSync(n);
                        s && (i[n] = s)
                    }
                    t.nodes = i,
                    t.updateUI()
                }))
            }))
        },
        so.prototype.updateLabel = function() {
            this.$label.text(util.formatLocaleDate(this.start))
        },
        so.prototype.updateUI = async function() {
            if (!this.visible)
                return;
            ui.fullWidth < 750 ? (this.$controls.hide(), this.$controlsSmall.show()) : (this.$controls.show(), this.$controlsSmall.hide(), this.smallContextMenuTarget = null),
            s.a.render(r.a.createElement(io, {
                show: null !== this.smallContextMenuTarget,
                clickTarget: this.smallContextMenuTarget,
                items: [{
                    text: locale.sevenDays,
                    onClick: () => {
                        this.setDays(7),
                        this.load()
                    },
                    isSelected: 7 === this.days
                }, {
                    text: locale.fiveDays,
                    onClick: () => {
                        this.setDays(5),
                        this.load()
                    },
                    isSelected: 5 === this.days
                }, {
                    text: locale.oneDay,
                    onClick: () => {
                        this.setDays(1),
                        this.load()
                    },
                    isSelected: 1 === this.days
                }, {
                    text: locale.showOnlyWorkHours,
                    onClick: () => {
                        this.setShowFullDay(!this.showFullDay),
                        this.load()
                    },
                    isSelected: this.showFullDay
                }],
                onClick: () => {
                    this.smallContextMenuTarget = null,
                    this.updateUI()
                }
            }), this.$controlsSmall[0]);
            const e = Math.floor(parseInt(NinoxDocumentInteraction.getUserDefault("ui.calendar.dayStart") || "28800000") / 36e5),
                t = Math.ceil(parseInt(NinoxDocumentInteraction.getUserDefault("ui.calendar.dayEnd") || "64800000") / 36e5),
                i = this.$body;
            i.empty();
            const o = this.start,
                n = this.days,
                a = this.showFullDay ? 0 : e,
                l = this.showFullDay ? 24 : t,
                c = this.el.width(),
                d = this.el.height(),
                h = Math.max(Math.floor((c - 64) / n), 32),
                p = c - h * n,
                u = this.$head.empty();
            $('<div class="calendar-week-head">').appendTo(u).css({
                position: "absolute",
                width: p,
                top: 0,
                left: 0,
                "max-height": d + "px"
            });
            const f = [];
            for (let e = 0; e < n; e++) {
                const t = new Date(o.getFullYear(), o.getMonth(), o.getDate() + e),
                    i = $("<div>");
                $('<div class="calendar-week-head">').appendTo(u).css({
                    position: "absolute",
                    width: h - 1,
                    top: 0,
                    left: p + e * h,
                    "max-height": d + "px"
                }).append($("<div>").text(locale.dayNames[t.getDay()] + " " + t.getDate() + ".")).append(i),
                f.push({
                    date: t,
                    begin: t.getTime(),
                    left: p + e * h,
                    width: h,
                    boxes: [],
                    $full: i
                })
            }
            const m = this.$hours = $('<div class="calendar-week-hours">').appendTo(this.$body).css({
                position: "absolute",
                width: p + 1,
                top: 0,
                left: 0
            });
            for (let e = a; e < l; e++) {
                const t = e === a ? "" : (e < 10 ? "0" : "") + e + ":00";
                $('<div class="calendar-week-hour">').text(t).appendTo(m)
            }
            for (let o = 0; o < n; o++) {
                const n = f[o],
                    s = $('<div class="calendar-week-col">').appendTo(i).css({
                        position: "absolute",
                        width: h - 1,
                        top: 0,
                        left: p + o * h
                    });
                for (let i = a; i < l; i++) {
                    const o = $('<div class="calendar-week-cell">').appendTo(s).data("time", n.begin + i * oo).addClass(i < e ? "calendar-week-cell-early" : i >= t ? "calendar-week-cell-late" : "calendar-week-cell-normal");
                    (n.date.getDay() + 6) % 7 > 4 && o.addClass("calendar-week-cell-weekend")
                }
            }
            for (const e of Object.values(this.nodes)) {
                const t = e._id,
                    i = database.typeOf(t);
                if (i)
                    for (const s in i.fields)
                        if (i.fields.hasOwnProperty(s)) {
                            const a = i.fields[s];
                            if (a.dateCalendar)
                                if ("date" === a.base || "datx" === a.base) {
                                    const r = e[s];
                                    if (r) {
                                        const s = new Date(r);
                                        "datx" === a.base && (s = new Date(s.getUTCFullYear(), s.getUTCMonth(), s.getUTCDate())),
                                        a.dateYearly && s.setYear(o.getFullYear());
                                        const l = Math.floor((s.getTime() - f[0].begin) / no);
                                        if (l >= 0 && l < n) {
                                            const o = f[l],
                                                n = $('<div class="calendar-week-full-box">').data("nid", t).appendTo(o.$full),
                                                s = a.dateCalendarFormatExp;
                                            if (s) {
                                                const i = await s.promise(database, e).catch(() => {});
                                                null != i ? "styled" === s.returnType.base ? (n.html((i.icon ? '<div class="choice-icon ic ic-' + i.icon + '"></div>' : "") + '<span style="color:' + (i.color || "") + '">' + htmlEscape(i.text) + "</span>"), n.css("background-color", i.background || a.dateCalendarColor || "")) : "choice" === s.returnType.base || "dchoice" === s.returnType.base ? s.returnType.loadValue(t, i, e => {
                                                    e ? (n.html((e.icon ? '<div class="choice-icon ic ic-' + e.icon + '"></div>' : "") + '<span style="color:' + (e.textColor || "") + '">' + htmlEscape(e.caption) + "</span>"), n.css("background-color", e.color || a.dateCalendarColor || "")) : n.css("background-color", a.dateCalendarColor || "")
                                                }) : "icon" === s.returnType.base ? n.html('<div class="choice-icon ic ic-' + i + '"></div>') : "color" === s.returnType.base ? n.css("background-color", color || a.dateCalendarColor || "") : (n.text(s.returnType.format(i)), n.css("background-color", a.dateCalendarColor || "")) : (n.text(""), n.css("background-color", a.dateCalendarColor || ""))
                                            } else
                                                n.text(i.caption + ": " + i.format(e)),
                                                n.css("background-color", a.dateCalendarColor || "")
                                        }
                                    }
                                } else if ("appointment" === a.base) {
                                    const o = e[s];
                                    if (o) {
                                        const n = o.split("/"),
                                            s = parseInt(n[0]),
                                            r = parseInt(n[1]),
                                            l = s + r;
                                        if (!isNaN(s) && !isNaN(r)) {
                                            let o = Math.floor((s - f[0].begin) / no),
                                                n = Math.floor((l - f[0].begin) / no);
                                            if (o < 0 && (o = 0), n >= f.length && (n = f.length - 1), o < f.length && n >= 0)
                                                for (let r = o; r <= n; r++) {
                                                    const o = f[r],
                                                        n = Math.max(s, o.begin),
                                                        c = Math.min(o.begin + no, l),
                                                        d = $('<div class="calendar-week-box">').data("nid", t),
                                                        h = a.dateCalendarFormatExp;
                                                    h ? h.evaluate(database, e, (t, i) => {
                                                        null != i ? "styled" === h.returnType.base ? (d.html((i.icon ? '<div class="choice-icon ic ic-' + i.icon + '"></div>' : "") + '<span style="color:' + (i.color || "") + '">' + htmlEscape(i.text) + "</span>"), d.css("background-color", i.background || a.dateCalendarColor || "")) : "choice" === h.returnType.base || "dchoice" === h.returnType.base ? h.returnType.loadValue(e._id, i, e => {
                                                            e ? (d.html((e.icon ? '<div class="choice-icon ic ic-' + e.icon + '"></div>' : "") + '<span style="color:' + (e.textColor || "") + '">' + htmlEscape(e.caption) + "</span>"), d.css("background-color", e.color || a.dateCalendarColor || "")) : d.css("background-color", a.dateCalendarColor || "")
                                                        }) : "icon" === h.returnType.base ? (d.html('<div class="choice-icon ic ic-' + i + '"></div>'), d.css("background-color", a.dateCalendarColor || "")) : "color" === h.returnType.base ? d.css("background-color", i || a.dateCalendarColor || "") : (d.text(h.returnType.format(i)), d.css("background-color", a.dateCalendarColor || "")) : (d.text(""), d.css("background-color", a.dateCalendarColor || ""))
                                                    }) : (d.text(i.caption + ": " + i.format(e)), d.css("background-color", a.dateCalendarColor || ""));
                                                    const p = {
                                                        $box: d,
                                                        begin: n,
                                                        end: c,
                                                        left: 0,
                                                        right: 0,
                                                        width: 0,
                                                        prev: null,
                                                        next: null
                                                    };
                                                    o.boxes.push(p)
                                                }
                                        }
                                    }
                                }
                        }
            }
            for (let e = 0; e < f.length; e++) {
                const t = f[e],
                    o = t.boxes;
                o.sort((function(e, t) {
                    return e.begin - t.begin
                }));
                for (let e = 0; e < o.length; e++) {
                    const t = o[e];
                    if (e < o.length - 1) {
                        const i = o[e + 1];
                        t.end > i.begin && (t.next = i)
                    }
                    for (let i = e - 1; i >= 0; i--) {
                        const e = o[i];
                        if (e.end > t.begin) {
                            t.prev = e;
                            break
                        }
                    }
                }
                for (let e = 0; e < o.length; e++) {
                    const i = o[e];
                    i.prev ? i.left = i.prev.right : i.left = 0;
                    let n = 0,
                        s = i;
                    for (; s = s.next;)
                        n++;
                    i.width = Math.floor((t.width - i.left) / (n + 1)),
                    i.right = i.left + i.width
                }
                for (let e = 0; e < o.length; e++) {
                    const n = o[e];
                    n.$box.css({
                        left: t.left + n.left,
                        width: n.width + 1,
                        top: Math.floor(64 * (n.begin - t.begin) / oo - 64 * a) - 1,
                        height: Math.ceil(64 * (n.end - n.begin) / oo) + 1
                    }).appendTo(i)
                }
            }
        },
        so.prototype.setShowFullDay = function(e) {
            e ? (this.showFullDay = !0, this.$showFullDay.removeClass("selected")) : (this.showFullDay = !1, this.$showFullDay.addClass("selected")),
            NinoxDocumentInteraction.setUserDefault("ui.calendarWeekFullDay", e ? "true" : "false")
        },
        so.prototype.setDays = function(e) {
            if (e !== this.days) {
                if (this.$show7Days.toggleClass("selected", 7 == e), this.$show5Days.toggleClass("selected", 5 == e), this.$show1Days.toggleClass("selected", 1 == e), this.days = e, e > 1) {
                    var t = this.start,
                        i = t.getDay(),
                        o = locale.firstDayOfWeek,
                        n = 7 === e ? t.getDate() - i + o - (i < o ? 7 : 0) : t.getDate() - i + 1 - (i < o ? 7 : 0);
                    this.start = new Date(t.getFullYear(), t.getMonth(), n)
                }
                NinoxDocumentInteraction.setUserDefault("ui.calendarWeekDays", String(e)),
                this.calendar.dateChanged(this.start)
            }
        },
        so.prototype.setDate = function(e, t) {
            var i = this.days;
            if (i > 1) {
                var o = e,
                    n = o.getDay(),
                    s = locale.firstDayOfWeek,
                    a = 7 === i ? o.getDate() - n + s - (n < s ? 7 : 0) : o.getDate() - n + 1 - (n < s ? 7 : 0);
                this.start = new Date(o.getFullYear(), o.getMonth(), a)
            } else
                this.start = new Date(e.getFullYear(), e.getMonth(), e.getDate());
            this.updateLabel(),
            this.load(),
            !1 !== t && this.calendar.dateChanged(this.start)
        },
        so.prototype.getNavigationState = function() {
            return {
                year: this.start.getFullYear(),
                month: this.start.getMonth(),
                day: this.start.getDate(),
                days: this.days,
                showFullDay: this.showFullDay
            }
        },
        so.prototype.setNavigationState = function(e) {
            var t = new Date;
            this.start = new Date(null != e.year ? e.year : t.getFullYear(), null != e.month ? e.month : t.getMonth(), null != e.day ? e.day : t.getDate());
            var i = 5;
            if (null != e.days)
                i = e.days;
            else {
                var o = NinoxDocumentInteraction.getUserDefault("ui.calendarWeekDays");
                o && (i = parseInt(o))
            }
            this.setDays(i),
            this.setShowFullDay(null != e.showFullDay ? e.showFullDay : "true" === NinoxDocumentInteraction.getUserDefault("ui.calendarWeekFullDay")),
            this.load(),
            this.calendar.dateChanged(this.start)
        },
        so.prototype.popupMiniCalendar = function() {
            var e = this;
            new fo({
                year: e.start.getFullYear(),
                selectedDay: e.start,
                selectDay: function(t, i, o) {
                    e.setDate(new Date(t, i, o))
                }
            })
        },
        lo.prototype.destroy = function() {
            this.hide(),
            this.controls.remove(),
            this.el.remove()
        },
        lo.prototype.show = function(e) {
            this.visible || (this.visible = !0, e && this.setDate(e.getFullYear(), e.getMonth(), !1), this.controls.appendTo(ui.$menuCenter), this.el.appendTo(ui.$body), this.updateUI(), database.on("schema", void 0, this.schemaChanged, this), database.onChange(void 0, this.updateUI, this), database.onCreate(void 0, this.updateUI, this), database.onRemove(void 0, this.updateUI, this))
        },
        lo.prototype.hide = function() {
            this.visible && (this.visible = !1, database.off("schema", void 0, this.schemaChanged, this), database.offChange(void 0, this.updateUI, this), database.offCreate(void 0, this.updateUI, this), database.offRemove(void 0, this.updateUI, this), this.controls.detach(), this.el.detach())
        },
        lo.prototype.schemaChanged = function(e, t, i) {
            this.updateUI()
        },
        lo.prototype.bodyResized = function() {
            this.updateUI()
        },
        lo.prototype.onchange = function() {
            this.updateUI()
        },
        lo.prototype.setDate = function(e, t, i) {
            if (e !== this.year || t !== this.month) {
                var o = new Date;
                this.today = new Date(o.getFullYear(), o.getMonth(), o.getDate());
                var n = new Date(e, t, 1);
                this.week = util.getWeek(n),
                this.date = n,
                this.year = n.getFullYear(),
                this.month = n.getMonth();
                var s = n.getDay(),
                    a = locale.firstDayOfWeek,
                    r = s >= a ? a - s + 1 : a - s - 6;
                this.startDate = new Date(n.getFullYear(), n.getMonth(), r),
                !1 !== i && this.calendar.dateChanged(new Date(e, t, 1))
            }
        },
        lo.prototype.nextMonth = function() {
            this.month < 11 ? (this.setDate(this.year, this.month + 1), this.updateUI()) : (this.setDate(this.year + 1, 0), this.updateUI())
        },
        lo.prototype.prevMonth = function() {
            this.month > 0 ? (this.setDate(this.year, this.month - 1), this.updateUI()) : (this.setDate(this.year - 1, 11), this.updateUI())
        },
        lo.prototype.nextYear = function() {
            this.setDate(this.year + 1, this.month),
            this.updateUI()
        },
        lo.prototype.prevYear = function() {
            this.setDate(this.year - 1, this.month),
            this.updateUI()
        },
        lo.prototype.getDate = function(e) {
            return new Date(this.startDate.getFullYear(), this.startDate.getMonth(), this.startDate.getDate() + e)
        },
        lo.prototype.getIndex = function(e) {
            var t = this.startDate,
                i = e;
            return Math.floor((i - t) / 864e5 - (i.getTimezoneOffset() - t.getTimezoneOffset()) / 1440)
        },
        lo.prototype.updateUI = function() {
            if (this.visible) {
                var e = this,
                    t = new Date(e.year, e.month, 1),
                    i = new Date(e.year, e.month + 1, 1);
                database.loadCalendarFromTo(t, i, (function(t, i) {
                    var o = {},
                        n = [];
                    if (i)
                        for (var s = 0; s < i.length; s++) {
                            var a = i[s];
                            o[a] || (n.push(a), o[a] = !0)
                        }
                    e.updateRefs(n)
                }))
            }
        },
        lo.prototype.updateRefs = function(e) {
            var t = this,
                i = this.calendar.getDependencies();
            database.loadNodes2(e, i, (function() {
                database.filterReadable(void 0, e, (function(e) {
                    t.label.text(locale.monthNames[t.date.getMonth()] + " " + t.date.getFullYear());
                    for (var i = 0; i < t.cells.length; i++)
                        t.cells[i].updateUI();
                    for (i = 0; i < 6; i++) {
                        let e = new Date(t.date.getTime());
                        e.setDate(e.getDate() + 7 * i),
                        t.tds[i].text(String(util.moment(e).isoWeek()))
                    }
                    t.cells[35].date.getMonth() !== t.month ? t.trs[5].hide() : t.trs[5].show(),
                    T.each(e, (function(e) {
                        var i = database.loadNodeSync(e);
                        if (i) {
                            var o = database.typeOf(e);
                            if (o)
                                for (var n in o.fields)
                                    if (o.fields.hasOwnProperty(n)) {
                                        var s = o.fields[n];
                                        if (s.dateCalendar)
                                            if ("date" === s.base) {
                                                if ("number" == typeof (r = i[n]) && !isNaN(r)) {
                                                    var a = new Date(r);
                                                    s.dateYearly && a.setYear(t.year),
                                                    (h = t.getIndex(a)) >= 0 && h < 42 && t.cells[h].addRef(o, s, i)
                                                }
                                            } else if ("datx" === s.base) {
                                                if ("number" == typeof (r = i[n]) && !isNaN(r)) {
                                                    a = new Date(r);
                                                    a = new Date(a.getUTCFullYear(), a.getUTCMonth(), a.getUTCDate()),
                                                    s.dateYearly && a.setYear(t.year),
                                                    (h = t.getIndex(a)) >= 0 && h < 42 && t.cells[h].addRef(o, s, i)
                                                }
                                            } else if ("appointment" === s.base) {
                                                var r;
                                                if (r = i[n]) {
                                                    var l = r.split("/");
                                                    if (2 === l.length) {
                                                        var c = parseInt(l[0]),
                                                            d = c + parseInt(l[1]);
                                                        for (a = new Date(c);;) {
                                                            var h;
                                                            if ((h = t.getIndex(a)) >= 0 && h < 42 && t.cells[h].addRef(o, s, i), (a = new Date(a.getFullYear(), a.getMonth(), a.getDate() + 1)).getTime() > d)
                                                                break
                                                        }
                                                    }
                                                }
                                            }
                                    }
                        }
                    }))
                }))
            }))
        },
        co.prototype.updateUI = function() {
            this.refs = {},
            this.td.empty(),
            this.td.attr("class", "calendar-day-" + (this.index + locale.firstDayOfWeek) % 7),
            this.date = this.calendar.getDate(this.index),
            this.label = $("<label>").text(this.date.getDate()).appendTo($('<div class="placeholder">').appendTo(this.td)),
            this.ul = $("<ul>").appendTo(this.td),
            this.date.toString() == this.calendar.today.toString() ? this.td.addClass("calendar-today") : this.date.getMonth() !== this.calendar.month && this.td.addClass("calendar-other-month")
        },
        co.prototype.addRef = function(e, t, i) {
            this.refs[i._id] = !0;
            var o = $("<li>").appendTo(this.ul).touch((function(e) {
                    return new Vi.PopupEditor(i._id, {
                        duplicate: !0
                    }), !1
                })),
                n = t.dateCalendarFormatExp;
            n ? n.evaluate(database, i, (function(s, a) {
                if (s)
                    o.text(e.caption + ": " + e.format(i));
                else if (null != a)
                    switch (n.returnType.base) {
                    case "choice":
                    case "dchoice":
                        n.returnType.loadValue(i._id, a, e => {
                            e ? (o.html((e.icon ? '<div class="choice-icon ic ic-' + e.icon + '"></div>' : "") + '<span style="color:' + (e.textColor || "") + '">' + htmlEscape(e.caption) + "</span>"), o.css("background-color", e.color || t.dateCalendarColor || "")) : o.css("background-color", t.dateCalendarColor || "")
                        });
                        break;
                    case "styled":
                        o.html((a.icon ? '<div class="choice-icon ic ic-' + a.icon + '"></div>' : "") + '<span style="color:' + (a.color || "") + '">' + htmlEscape(a.text) + "</span>"),
                        o.css("background-color", a.background || t.dateCalendarColor || "");
                        break;
                    case "color":
                        o.css("background-color", color || t.dateCalendarColor || "");
                        break;
                    case "icon":
                        o.html('<div class="choice-icon ic ic-' + a + '"></div>'),
                        o.css("background-color", t.dateCalendarColor || "");
                        break;
                    default:
                        o.text(n.returnType.format(a)),
                        o.css("background-color", t.dateCalendarColor || "")
                    }
                else
                    o.css("background-color", t.dateCalendarColor || "")
            })) : (o.text(e.caption + ": " + e.format(i)), o.css("background-color", t.dateCalendarColor || ""))
        },
        lo.prototype.getNavigationState = function() {
            return {
                year: this.year,
                month: this.month
            }
        },
        lo.prototype.setNavigationState = function(e) {
            var t = new Date;
            this.setDate(null != e.year ? e.year : t.getFullYear(), null != e.month ? e.month : t.getMonth()),
            this.updateUI()
        },
        lo.prototype.popupMiniCalendar = function() {
            var e = this;
            new fo({
                year: this.year,
                selectMonth: function(t, i) {
                    e.setDate(t, i),
                    e.updateUI()
                }
            })
        },
        uo.prototype.showMonth = function() {
            this.tabMonth.addClass("selected"),
            this.tabWeek.removeClass("selected"),
            this.calendarMonth.show(this.currentDate),
            this.calendarWeek.hide(),
            this.currentTab = this.calendarMonth,
            NinoxDocumentInteraction.setUserDefault("ui.calendarMode", "month")
        },
        uo.prototype.showWeek = function() {
            this.tabMonth.removeClass("selected"),
            this.tabWeek.addClass("selected"),
            this.calendarMonth.hide(),
            this.calendarWeek.show(this.currentDate),
            this.currentTab = this.calendarWeek,
            NinoxDocumentInteraction.setUserDefault("ui.calendarMode", "week")
        },
        uo.prototype.dateChanged = function(e) {
            this.currentDate = e
        },
        uo.prototype.destroy = function() {
            this.calendarMonth.destroy(),
            this.calendarWeek.destroy(),
            this.tabs.remove()
        },
        uo.prototype.show = function() {
            this.visible || (this.visible = !0, this.tabs.appendTo(ui.$header), this.currentTab.show())
        },
        uo.prototype.hide = function() {
            this.visible && (this.visible = !1, this.currentTab.hide(), this.tabs.detach())
        },
        uo.prototype.bodyResized = function() {
            this.currentTab.bodyResized()
        },
        uo.prototype.getDependencies = function() {
            var e = {},
                t = database.schema.types;
            for (var i in t)
                if (t.hasOwnProperty(i)) {
                    var o = t[i].fields;
                    for (var n in o) {
                        var s = o[n];
                        s.dateCalendar && s.dateCalendarFormatExp && (e = queries.extendDependencies(s.dateCalendarFormatExp.dependencies))
                    }
                }
            return e
        },
        uo.prototype.getNavigationState = function() {
            return {
                base: "calendar",
                mode: this.currentTab === this.calendarMonth ? "month" : "week",
                calendarMonth: this.calendarMonth.getNavigationState(),
                calendarWeek: this.calendarWeek.getNavigationState()
            }
        },
        uo.prototype.setNavigationState = function(e) {
            this.calendarMonth.setNavigationState(e.calendarMonth || {}),
            this.calendarWeek.setNavigationState(e.calendarWeek || {});
            const t = xe(),
                i = "month" === t.vid ? "month" : "week" === t.vid ? "week" : e.mode || "week";
            i !== t.vid && be(po({}, t, {
                vid: i
            })),
            "month" === i ? this.showMonth() : this.showWeek()
        },
        uo.prototype.updateUI = function() {
            this.visible && this.currentTab && this.currentTab.updateUI()
        },
        uo.prototype.popupSync = function() {
            var e = this;
            $.loading(!0),
            NinoxCalendar.enableCalendarSync((function(t, i) {
                return $.loading(!1), t ? callback(t) : i ? void e.showCalendarSyncOptions() : callback(locale.noCalendarAccess)
            }))
        },
        uo.prototype.showCalendarSyncOptions = async function() {
            for (var e, t = this, i = "db." + database.getUniqueID(), o = "true" === NinoxDocumentInteraction.getUserDefault(i + ".calendar.syncEnabled"), n = NinoxDocumentInteraction.getUserDefault(i + ".calendar.syncStorage"), s = parseInt(NinoxDocumentInteraction.getUserDefault(i + ".calendar.syncBeyond") || "1"), a = parseInt(NinoxDocumentInteraction.getUserDefault(i + ".calendar.syncAhead") || "3"), r = parseInt(NinoxDocumentInteraction.getUserDefault("ui.calendar.dayStart") || "28800000"), l = parseInt(NinoxDocumentInteraction.getUserDefault("ui.calendar.dayEnd") || "64800000"), c = util.localeSortBy(await NinoxCalendar.getSources(), "title"), d = {}, h = 0; h < c.length; h++) {
                var p = c[h];
                d[p.id] = {
                    id: p.id,
                    caption: p.title,
                    order: h
                },
                e || !/icloud/i.test(p.title) && !/^androidlocal$/.test(p.id) || (e = p.id)
            }
            n || (n = e);
            var u = $.popdown({
                    cls: "small",
                    head: locale.calendarOptions,
                    closable: !1,
                    buttons: ["cancel", "-", {
                        caption: locale.okay,
                        cls: "blue",
                        click: function() {
                            var e = parseInt(v.value);
                            if (!(e >= 0))
                                return $.alert("Sync beyond must be greater than 0");
                            if (!(e <= 12))
                                return $.alert("Sync beyond cannot be greater than 12");
                            var o = parseInt(y.value);
                            if (!(o >= 1))
                                return $.alert("Sync ahead must be greater than 0");
                            if (!(o <= 12))
                                return $.alert("Sync ahead cannot be greater than 12");
                            var n = x.value;
                            if (!(n >= 0))
                                return $.alert("Day start must be greater or equal to 00:00");
                            if (!(n <= 864e5))
                                return $.alert("Day start must be smaller or eqaal to 24:00");
                            var s = T.value;
                            if (!(s >= 0))
                                return $.alert("Day end must be greater or equal to 00:00");
                            if (!(s <= 864e5))
                                return $.alert("Day end must be smaller or eqaal to 24:00");
                            if (!(n < s))
                                return $.alert("Day start must be smaller than day end.");
                            NinoxDocumentInteraction.setUserDefault(i + ".calendar.syncEnabled", String(f.value)),
                            NinoxDocumentInteraction.setUserDefault(i + ".calendar.syncStorage", String(m.value || "")),
                            NinoxDocumentInteraction.setUserDefault(i + ".calendar.syncBeyond", String(e)),
                            NinoxDocumentInteraction.setUserDefault(i + ".calendar.syncAhead", String(o)),
                            NinoxDocumentInteraction.setUserDefault("ui.calendar.dayStart", String(n)),
                            NinoxDocumentInteraction.setUserDefault("ui.calendar.dayEnd", String(s)),
                            u.close(),
                            database.calendarSync && database.calendarSync.settingsChanged();
                            t.updateUI()
                        }
                    }]
                }),
                f = new util.SimpleModel(new schemas.TBoolean(void 0, void 0, {
                    caption: locale.calendarSyncEnabled,
                    required: !0,
                    width: 2,
                    booleanRenderer: "switch"
                }));
            f.value = o,
            f.on("update", C);
            new Ue.a(this, f, u.$content);
            var m = new util.SimpleModel(new schemas.TChoice(void 0, void 0, {
                caption: locale.calendarSyncLocation,
                required: !0,
                width: 2,
                values: d
            }));
            m.value = n;
            var g = new Ue.a(this, m, u.$content),
                v = new util.SimpleModel(new schemas.TNumber(void 0, void 0, {
                    caption: locale.calendarSyncBeyond,
                    required: !0,
                    width: 2
                }));
            v.value = s;
            var b = new Ue.a(this, v, u.$content),
                y = new util.SimpleModel(new schemas.TNumber(void 0, void 0, {
                    caption: locale.calendarSyncAhead,
                    required: !0,
                    width: 2
                }));
            y.value = a;
            var w = new Ue.a(this, y, u.$content);
            $("<hr>").appendTo(u.$content),
            $('<div class="nx-sub-head">').text(locale.defineWorkHours).appendTo(u.$content);
            var x = new util.SimpleModel(new schemas.TTime(void 0, void 0, {
                caption: locale.calendarWorkStart,
                required: !0,
                width: 2
            }));
            x.value = r;
            new Ue.a(this, x, u.$content);
            var T = new util.SimpleModel(new schemas.TTime(void 0, void 0, {
                caption: locale.calendarWorkEnd,
                required: !0,
                width: 2
            }));
            T.value = l;
            new Ue.a(this, T, u.$content);
            function C() {
                var e = f.value;
                g.el.css("display", e ? "" : "none"),
                w.el.css("display", e ? "" : "none"),
                b.el.css("display", e ? "" : "none")
            }
            C()
        };
        class go {
            constructor()
            {
                K()(this, "visible", void 0),
                K()(this, "el", void 0),
                K()(this, "$controls", void 0),
                K()(this, "$search", void 0),
                K()(this, "$searchContainer", void 0),
                K()(this, "$searchText", void 0),
                K()(this, "$searchCancel", void 0),
                K()(this, "$searchPlaceholder", void 0),
                K()(this, "recordController", void 0),
                K()(this, "keydown", void 0);
                const e = this;
                this.visible = !1,
                this.el = $('<div class="search-page">').click((function(e) {
                    const i = $(e.target).closest("tr");
                    t && t.attr("nid") === i.attr("nid") ? r(void 0) : r(i)
                })),
                this.$controls = $('<div class="hud-menu-group" style="margin-left:12px">'),
                this.$searchContainer = $('<div class="hud-menu-search">').appendTo(this.$controls),
                this.$searchPlaceholder = $('<div class="hud-menu-search-placeholder">').appendTo(this.$searchContainer),
                $('<div class="i-24-16 i-light-grey i-search" style="opacity: 0.5;margin-left: 3px;">').appendTo(this.$searchPlaceholder),
                this.$searchText = $('<div style="overflow: hidden;text-overflow: ellipsis;white-space: nowrap;">').text(Object(b.getLocale)().FindIn$.replace("$", database.name)).appendTo(this.$searchPlaceholder),
                this.$search = $('<input type="text" class="hud-menu-search-input" style="display:none">').appendTo(this.$searchContainer).keyup(v).change(v),
                (this.$searchCancel = $('<div class="i-32-16 i-light-grey i-close" style="margin-left:-32px;margin-top:4px;display:none">').appendTo($('<div style="width:0;flex:0 0 0px;-webkit-flex:0 0 0px">').appendTo(this.$searchContainer))).touch(() => {
                    this.$search.val(""),
                    v()
                }),
                this.$searchPlaceholder.touch($.proxy(this.focus, this)),
                this.$search.blur(() => {
                    this.$searchPlaceholder.css("display", ""),
                    this.$search.css("display", "none")
                }),
                this.recordController = {
                    hasNextRecord: () => !0,
                    nextRecord: p,
                    hasPrevRecord: () => !0,
                    prevRecord: u,
                    hasAddRecord: () => {
                        if (!i)
                            return !1;
                        const e = database.typeOf(i);
                        return !!e && database.canCreate(e)
                    },
                    addRecord: () => {
                        if (!i)
                            return;
                        const e = database.typeOf(i);
                        e && database.canCreate(e) && database.create(e, {}, (e, t) => {
                            if (e)
                                return $.alert(e);
                            l(),
                            t && c(t._id)
                        })
                    },
                    hasDuplicateRecord: () => {
                        if (!i)
                            return !1;
                        const e = database.typeOf(i);
                        return !!e && database.canCreate(e)
                    },
                    duplicateRecord: h,
                    hasRemoveRecord: () => {
                        if (!i)
                            return !1;
                        const e = database.typeOf(i);
                        return !!e && database.canDelete(e)
                    },
                    removeRecord: function() {
                        const e = i;
                        if (!e)
                            return;
                        const t = database.typeOf(e);
                        if (!t)
                            return;
                        if (!database.canDelete(t))
                            return;
                        $.dialog({
                            closable: !0,
                            caption: Object(b.getLocale)().remove,
                            message: Object(b.getLocale)().confirmRemove,
                            buttons: [{
                                color: "red",
                                caption: Object(b.getLocale)().remove,
                                callback: () => {
                                    $.loading(!0),
                                    database.remove(e, t => {
                                        if ($.loading(!1), t)
                                            return $.alert(t);
                                        g(e)
                                    })
                                }
                            }]
                        })
                    },
                    hasPrintRecord: () => !(!i || !1 === database.authorizationPrint),
                    printRecord: function() {
                        if (!1 === database.authorizationPrint)
                            return;
                        const e = i;
                        if (!e)
                            return;
                        if (!database.typeOf(e))
                            return;
                        reports ? reports.openDesigner({
                            nid: e
                        }) : Object(N.a)(e)
                    }
                },
                this.keydown = e => {
                    switch (e.which) {
                    case 27:
                        l();
                        break;
                    case 38:
                        u();
                        break;
                    case 40:
                        p()
                    }
                };
                let t = null,
                    i = null,
                    o = "",
                    n = null,
                    s = 0,
                    a = {};
                function r(e) {
                    if (t && (t.removeClass("selected"), t = null), e) {
                        const i = e.attr("nid");
                        i ? (e.addClass("selected"), t = e, c(i)) : d()
                    } else
                        d();
                    ui.recordNavigation.updateUI()
                }
                function l() {
                    r(void 0)
                }
                function c(e) {
                    i = e,
                    ui.sideEditor.open(i, {
                        prev: u,
                        next: p,
                        first: f,
                        last: m,
                        close: l,
                        duplicate: h
                    }, !1)
                }
                function d() {
                    i = null,
                    ui.sideEditor.close()
                }
                function h() {
                    i && database.duplicate(i, (e, t) => {
                        if (e)
                            return $.alert(e);
                        l(),
                        c(t)
                    })
                }
                function p() {
                    t && r(t.next())
                }
                function u() {
                    t && r(t.prev())
                }
                function f() {
                    if (t) {
                        const e = t.siblings();
                        e.length > 0 && r($(e[0]))
                    }
                }
                function m() {
                    if (t) {
                        const e = t.siblings();
                        e.length > 0 && r($(e[e.length - 1]))
                    }
                }
                const g = e => {
                    e === i && l();
                    const t = b.schemas.RE_NID.exec(e);
                    if (!t)
                        return;
                    const o = t[1],
                        n = parseInt(t[2], 10),
                        s = a[o];
                    if (s) {
                        const e = s.rids,
                            t = e.indexOf(n);
                        -1 !== t && e.splice(t, 1),
                        x()
                    }
                };
                function v() {
                    const t = e.$search.val();
                    e.$searchText.text(t || Object(b.getLocale)().FindIn$.replace("$", database.name)).css("color", t ? "" : "#7D8294"),
                    e.$searchCancel.css("display", t ? "" : "none"),
                    n && clearTimeout(n),
                    n = window.setTimeout(y, 200)
                }
                function y() {
                    n = null;
                    const t = e.$search.val().trim();
                    t !== o && (o = t, s++, w(s, t))
                }
                const w = (e, t) => {
                    t ? database.fastSearch(void 0, t, (function(t, i) {
                        if (e !== s)
                            return;
                        a = {};
                        const o = [];
                        let n = {};
                        (function() {
                            for (const e in i)
                                if (i.hasOwnProperty(e)) {
                                    const t = i[e];
                                    if (t.length) {
                                        const i = database.schema.types[e];
                                        if (i && database.canRead(i)) {
                                            i.canReadExp && (n = b.queries.extendDependencies(n, i.canReadExp.dependencies));
                                            const s = i.sorted,
                                                r = [];
                                            for (let t = 0; t < s.length && r.length < 8; t++) {
                                                const i = s[t];
                                                if ((i.isField && "file" !== i.base || i.isReference) && database.canRead(i))
                                                    if (r.push(i), "fn" === i.base && i.exp)
                                                        n = b.queries.extendDependencies(n, i.exp.dependencies);
                                                    else if (i.isReference) {
                                                        const t = {};
                                                        t[e] = i.id,
                                                        n = b.queries.extendDependencies(n, t)
                                                    }
                                            }
                                            a[e] = {
                                                type: i,
                                                fields: r,
                                                rids: t
                                            };
                                            for (const i of t)
                                                o.push(e + t)
                                        }
                                    }
                                }
                        })(),
                        database.loadNodes2(o, n, () => {
                            x()
                        })
                    })) : (a = {}, x())
                };
                async function x() {
                    let t = "";
                    for (const e in a)
                        if (a.hasOwnProperty(e)) {
                            const i = a[e],
                                o = i.rids,
                                n = i.type,
                                s = n.canReadExp;
                            o.sort((e, t) => e - t);
                            const r = i.fields;
                            t += "<h1>" + htmlEscape(n.caption) + "</h1><table><thead><tr>",
                            t += '<th style="position:sticky;top:-1px;background: white;">' + htmlEscape(Object(b.getLocale)().id) + "</th>";
                            for (const e of r)
                                t += '<th style="position:sticky;top:-1px;background: white;">' + htmlEscape(e.caption) + "</th>";
                            t += "</tr></thead><tbody>";
                            for (const i of o) {
                                const o = e + i,
                                    n = database.loadNodeSync(o);
                                if (n && (!s || await s.promise(database, n).catch(() => {}))) {
                                    t += '<tr nid="' + o + '">',
                                    t += '<td style="text-align:right">' + i + "</td>";
                                    for (const e of r)
                                        if ("choice" === e.base || "dchoice" === e.base) {
                                            const i = n[e.id],
                                                s = null == i ? void 0 : await new Promise(t => e.loadValue(o, i, t));
                                            t += s ? '<td style="text-align:' + e.columnAlign + '"><div class="multicombo-item" style="' + (s.color ? "background-color:" + s.color : "") + '">' + (s.icon ? '<div class="choice-symbol ic ic-' + s.icon + '"></div>' : "") + "<span>" + htmlEscape(s.caption || "") + "</span></div></td>" : '<td style="text-align:' + e.columnAlign + '"></td>'
                                        } else if ("multi" === e.base || "dmulti" === e.base) {
                                            t += '<td style="text-align:' + e.columnAlign + '">';
                                            const i = n[e.id];
                                            if (i) {
                                                const n = b.util.multiDecode(i);
                                                if (n) {
                                                    const i = await new Promise(t => e.loadValues(o, (e, i) => t(i || {})));
                                                    for (const e of n) {
                                                        const o = i[e];
                                                        o && (t += '<div class="multicombo-item" style="' + (o.color ? "background-color:" + o.color : "") + '">' + (o.icon ? '<div class="choice-symbol ic ic-' + o.icon + '"></div>' : "") + "<span>" + htmlEscape(o.caption || "") + "</span></div>")
                                                    }
                                                }
                                            }
                                            t += "</td>"
                                        } else {
                                            let i = "";
                                            if ("fn" === e.base) {
                                                if (e.exp) {
                                                    const t = await e.exp.promise(database, n).catch(() => {});
                                                    null == t || t._missingNodes || (i = e.exp.returnType.format(t))
                                                }
                                            } else if (e.isField)
                                                i = e.format(n[e.id]);
                                            else if (e.isReference) {
                                                const t = n[e.id];
                                                if (t) {
                                                    const o = database.loadNodeSync(e.refTypeId + t);
                                                    i = e.refType.format(o)
                                                }
                                            }
                                            t += '<td style="text-align:' + e.columnAlign + '">' + htmlEscape(i) + "</td>"
                                        }
                                    t += "</tr>"
                                }
                            }
                            t += "</tbody></table>"
                        }
                    e.el.html(t)
                }
            }
            destroy()
            {
                this.hide(),
                this.el.remove()
            }
            show()
            {
                this.visible || (this.visible = !0, this.$controls.appendTo(ui.$menuCenter), this.el.appendTo(ui.$body), ui.recordNavigation.pushController(this.recordController), $.pushInputHandler(this), setTimeout($.proxy(this.focus, this), 100))
            }
            hide()
            {
                this.visible && (this.visible = !1, ui.recordNavigation.popController(this.recordController), $.popInputHandler(this), ui.sideEditor.close(), this.$search.blur(), this.$controls.detach(), this.el.detach())
            }
            setNavigationState()
            {
                "all" !== xe().vid && be(function(e) {
                    for (var t = 1; t < arguments.length; t++) {
                        var i = null != arguments[t] ? arguments[t] : {};
                        t % 2 ? mo(Object(i), !0).forEach((function(t) {
                            K()(e, t, i[t])
                        })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(i)) : mo(Object(i)).forEach((function(t) {
                            Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(i, t))
                        }))
                    }
                    return e
                }({}, xe(), {
                    vid: "all"
                }))
            }
            getNavigationState()
            {
                return {
                    base: "search"
                }
            }
            focus()
            {
                this.$searchPlaceholder.css("display", "none"),
                this.$search.css("display", ""),
                this.$search.focus()
            }
        }
        function vo(e, t) {
            var i = this,
                o = database.typeOf(e);
            o && (t = t || {}, this.options = t, this.nid = e, this.children = [], this.$backplane = $.backplane({
                closable: !1
            }), this.el = $('<div class="fullscreeneditor' + (!1 === t.controls ? " no-controls" : "") + '">').appendTo(this.$backplane), this.buttons = $('<div class="popupeditor2-buttons-left">').appendTo(this.el).button2({
                icon: "i-40-18 i-light-grey i-close",
                click: $.proxy(ui.closeFullscreen, ui)
            }), this.tabsEl = $('<div class="popupeditor2-tabs">').appendTo(this.el), this.editor = new ci(this, o.id, {}, void 0), database.loadNode(e, (function(e, t) {
                t && i.editor.bind(t)
            })), database.on("rename", void 0, this.nodeRenamed, this), database.on("remove", void 0, this.nodeRemoved, this), database.on("schema", void 0, this.schemaChanged, this), database.on("admin", void 0, this.adminChanged, this), $.pushInputHandler(this))
        }
        vo.prototype.setNid = function(e) {
            var t = this;
            this.nid = e,
            database.loadNode(e, (function(e, i) {
                i && t.editor.bind(i)
            }))
        },
        vo.prototype.close = function() {
            database.off("rename", void 0, this.nodeRenamed, this),
            database.off("remove", void 0, this.nodeRemoved, this),
            database.off("schema", void 0, this.schemaChanged, this),
            database.off("admin", void 0, this.adminChanged, this),
            $.popInputHandler(this),
            this.$backplane.close()
        },
        vo.prototype.nodeRenamed = function(e, t, i) {
            t === this.nid && this.setNid(i)
        },
        vo.prototype.nodeRemoved = function(e, t) {
            t === this.nid && this.close()
        },
        vo.prototype.schemaChanged = function(e, t, i) {
            this.updateStructure()
        },
        vo.prototype.adminChanged = function(e, t) {
            this.updateStructure()
        },
        vo.prototype.updateStructure = function() {
            var e = this;
            database.typeOf(this.nid) && (this.editor.updateStructure(), database.loadNode(this.nid, (function(t, i) {
                i ? e.editor.bind(i) : this.close()
            })))
        },
        vo.prototype.updateBackground = function(e) {
            var t = util.luminosity(e) < .5;
            this.el.css("background-color", e || "#FFF"),
            this.el.toggleClass("darkmode", t)
        },
        vo.prototype.getSelectedNid = function() {
            return this.nid
        };
        let bo = "";
        function yo() {
            var e,
                t = Array.prototype.join.call(arguments, " "),
                i = document.getElementById("LOG");
            if (e = i ? $(i) : $('<div id="LOG" style="position:fixed;left:0;bottom:0;width:100%;padding:32px;box-sizing:border-box;-moz-box-sizing:border-box;background-color:rgba(0,0,0,.8);color:#fff;overflow:auto;z-index:999">').hide().appendTo($(document.body)).click((function() {
                return bo = "", e.stop(!0, !1).hide().empty(), !1
            })), t !== bo) {
                var o = e.children();
                o.length > 4 && $(o[0]).remove(),
                o.css("color", "#aaa"),
                e.append($("<div>").text([].join.call(arguments, " ")))
            }
            e.stop(!0, !1).fadeIn().delay(3e3).fadeOut(),
            bo = t
        }
        function wo() {
            Object(c.f)() || function() {
                var e = database.account.id;
                if ("local" === e)
                    ui.planInfo = void 0,
                    xo();
                else {
                    var t = NinoxDocumentInteraction.getUserDefault("ui.planInfo." + e);
                    t && (ui.planInfo = b.util.parseJSON(t), xo());
                    var i = database.account.getOwnerId();
                    dbms.getRemoteConnection().getPlanInfo(i, (function(e, t) {
                        if (e)
                            return console.log(e);
                        t && function(e) {
                            var t = database.account.id;
                            if ("local" === t)
                                return;
                            ui.planInfo = e,
                            NinoxDocumentInteraction.setUserDefault("ui.planInfo." + t, JSON.stringify(e)),
                            xo()
                        }(t)
                    }))
                }
            }()
        }
        function xo() {
            var e = database.account.id;
            if ("local" !== e) {
                var t = dbms.getRemoteConnection().getAccount(e),
                    i = t.owner === dbms.getRemoteConnection().getUserId(),
                    o = t.users[t.owner],
                    n = !1,
                    s = !1;
                ui.planInfo && (n = "none" === ui.planInfo.name, s = ui.planInfo.free > ui.planInfo.collaborators),
                function(e, t, i, o, n, s) {
                    t || i ? (ui.$planInfo ? ui.$planInfo.empty() : (trackPageView("expired"), Object(l.f)("PlanExpired", "Show", {
                        isOwner: o
                    }), ui.setTopPadding(128), ui.$planInfo = $('<div style="background:#fff;position:absolute;left:0;top:0;width:100%;height:127px;display:flex;-webkit-display:flex;align-items:center;align-content:center;border-bottom:solid 1px #ccc">').prependTo(document.body)), $('<div style="flex:1 1 0px;-webkit-flex:1 1 0px">').appendTo(ui.$planInfo), $('<div class="thankyou" style="flex:0 0 auto;-webkit-flex:0 0 auto">').appendTo(ui.$planInfo), $('<div style="flex:0 1 32px;-webkit-flex:0 1 32px">').appendTo(ui.$planInfo), o ? $('<div style="flex:0 1 auto;-webkit-flex:0 1 auto">').html('<div style="font-size:16px;font-weight:bold;padding:4px">' + htmlEscape(t ? locale.planExpired : locale.planOverused) + '</div><div style="padding:4px">' + htmlEscape(locale.planUsageInfo.replace("$1", e.total).replace("$2", e.teamCount)) + (e.basic > 0 ? htmlEscape(" " + locale.planUsageCovered.replace("$1", e.basic)) : "") + '</div><div style="padding:4px">' + htmlEscape(locale.planGetNow.replace("$1", e.free)) + "</div>").appendTo(ui.$planInfo) : $('<div style="flex:0 1 auto;-webkit-flex:0 1 auto">').html(htmlEscape((t ? locale.planExpiredMember : locale.planOverusedMember).replace("$1", n.email))).appendTo(ui.$planInfo), $('<div style="flex:0 1 32px;-webkit-flex:0 1 32px">').appendTo(ui.$planInfo), $('<div class="nx-button-text blue" style="flex:0 0 auto;-webkit-flex:0 0 auto">').text(o ? locale.planGetNowCTA : locale.contactOwner).appendTo(ui.$planInfo).touch((function() {
                        if (o)
                            Object(l.f)("PlanExpired", "Upgrade", {
                                isOwner: o
                            }),
                            trackEvent("expired-upgrade", "click"),
                            root.upgradePlan();
                        else {
                            Object(l.f)("PlanExpired", "ContactOwner", {
                                isOwner: o
                            }),
                            trackEvent("expired-contact", "click");
                            var e = "mailto:" + n.email;
                            NinoxDocumentInteraction.openBrowser(e)
                        }
                    })), $('<div style="flex:1 1 0px;-webkit-flex:1 1 0px">').appendTo(ui.$planInfo)) : ui.$planInfo && (ui.setTopPadding(0), ui.$planInfo.remove(), ui.$planInfo = void 0)
                }(ui.planInfo, n, s, i, o)
            }
        }
        o("./src/react/credentials/Credentials.scss");
        const To = [{
            name: "Afghanistan",
            code: "AF"
        }, {
            name: "Åland Islands",
            code: "AX"
        }, {
            name: "Albania",
            code: "AL"
        }, {
            name: "Algeria",
            code: "DZ"
        }, {
            name: "American Samoa",
            code: "AS"
        }, {
            name: "AndorrA",
            code: "AD"
        }, {
            name: "Angola",
            code: "AO"
        }, {
            name: "Anguilla",
            code: "AI"
        }, {
            name: "Antarctica",
            code: "AQ"
        }, {
            name: "Antigua and Barbuda",
            code: "AG"
        }, {
            name: "Argentina",
            code: "AR"
        }, {
            name: "Armenia",
            code: "AM"
        }, {
            name: "Aruba",
            code: "AW"
        }, {
            name: "Australia",
            code: "AU"
        }, {
            name: "Austria",
            code: "AT"
        }, {
            name: "Azerbaijan",
            code: "AZ"
        }, {
            name: "Bahamas",
            code: "BS"
        }, {
            name: "Bahrain",
            code: "BH"
        }, {
            name: "Bangladesh",
            code: "BD"
        }, {
            name: "Barbados",
            code: "BB"
        }, {
            name: "Belarus",
            code: "BY"
        }, {
            name: "Belgium",
            code: "BE"
        }, {
            name: "Belize",
            code: "BZ"
        }, {
            name: "Benin",
            code: "BJ"
        }, {
            name: "Bermuda",
            code: "BM"
        }, {
            name: "Bhutan",
            code: "BT"
        }, {
            name: "Bolivia",
            code: "BO"
        }, {
            name: "Bosnia and Herzegovina",
            code: "BA"
        }, {
            name: "Botswana",
            code: "BW"
        }, {
            name: "Bouvet Island",
            code: "BV"
        }, {
            name: "Brazil",
            code: "BR"
        }, {
            name: "British Indian Ocean Territory",
            code: "IO"
        }, {
            name: "Brunei Darussalam",
            code: "BN"
        }, {
            name: "Bulgaria",
            code: "BG"
        }, {
            name: "Burkina Faso",
            code: "BF"
        }, {
            name: "Burundi",
            code: "BI"
        }, {
            name: "Cambodia",
            code: "KH"
        }, {
            name: "Cameroon",
            code: "CM"
        }, {
            name: "Canada",
            code: "CA"
        }, {
            name: "Cape Verde",
            code: "CV"
        }, {
            name: "Cayman Islands",
            code: "KY"
        }, {
            name: "Central African Republic",
            code: "CF"
        }, {
            name: "Chad",
            code: "TD"
        }, {
            name: "Chile",
            code: "CL"
        }, {
            name: "China",
            code: "CN"
        }, {
            name: "Christmas Island",
            code: "CX"
        }, {
            name: "Cocos (Keeling) Islands",
            code: "CC"
        }, {
            name: "Colombia",
            code: "CO"
        }, {
            name: "Comoros",
            code: "KM"
        }, {
            name: "Congo",
            code: "CG"
        }, {
            name: "The Democratic Republic of the Congo",
            code: "CD"
        }, {
            name: "Cook Islands",
            code: "CK"
        }, {
            name: "Costa Rica",
            code: "CR"
        }, {
            name: "Cote D'Ivoire",
            code: "CI"
        }, {
            name: "Croatia",
            code: "HR"
        }, {
            name: "Cuba",
            code: "CU"
        }, {
            name: "Cyprus",
            code: "CY"
        }, {
            name: "Czech Republic",
            code: "CZ"
        }, {
            name: "Denmark",
            code: "DK"
        }, {
            name: "Djibouti",
            code: "DJ"
        }, {
            name: "Dominica",
            code: "DM"
        }, {
            name: "Dominican Republic",
            code: "DO"
        }, {
            name: "Ecuador",
            code: "EC"
        }, {
            name: "Egypt",
            code: "EG"
        }, {
            name: "El Salvador",
            code: "SV"
        }, {
            name: "Equatorial Guinea",
            code: "GQ"
        }, {
            name: "Eritrea",
            code: "ER"
        }, {
            name: "Estonia",
            code: "EE"
        }, {
            name: "Ethiopia",
            code: "ET"
        }, {
            name: "Falkland Islands (Malvinas)",
            code: "FK"
        }, {
            name: "Faroe Islands",
            code: "FO"
        }, {
            name: "Fiji",
            code: "FJ"
        }, {
            name: "Finland",
            code: "FI"
        }, {
            name: "France",
            code: "FR"
        }, {
            name: "French Guiana",
            code: "GF"
        }, {
            name: "French Polynesia",
            code: "PF"
        }, {
            name: "French Southern Territories",
            code: "TF"
        }, {
            name: "Gabon",
            code: "GA"
        }, {
            name: "Gambia",
            code: "GM"
        }, {
            name: "Georgia",
            code: "GE"
        }, {
            name: "Germany",
            code: "DE"
        }, {
            name: "Ghana",
            code: "GH"
        }, {
            name: "Gibraltar",
            code: "GI"
        }, {
            name: "Greece",
            code: "GR"
        }, {
            name: "Greenland",
            code: "GL"
        }, {
            name: "Grenada",
            code: "GD"
        }, {
            name: "Guadeloupe",
            code: "GP"
        }, {
            name: "Guam",
            code: "GU"
        }, {
            name: "Guatemala",
            code: "GT"
        }, {
            name: "Guernsey",
            code: "GG"
        }, {
            name: "Guinea",
            code: "GN"
        }, {
            name: "Guinea-Bissau",
            code: "GW"
        }, {
            name: "Guyana",
            code: "GY"
        }, {
            name: "Haiti",
            code: "HT"
        }, {
            name: "Heard Island and Mcdonald Islands",
            code: "HM"
        }, {
            name: "Holy See (Vatican City State)",
            code: "VA"
        }, {
            name: "Honduras",
            code: "HN"
        }, {
            name: "Hong Kong",
            code: "HK"
        }, {
            name: "Hungary",
            code: "HU"
        }, {
            name: "Iceland",
            code: "IS"
        }, {
            name: "India",
            code: "IN"
        }, {
            name: "Indonesia",
            code: "ID"
        }, {
            name: "Iran, Islamic Republic Of",
            code: "IR"
        }, {
            name: "Iraq",
            code: "IQ"
        }, {
            name: "Ireland",
            code: "IE"
        }, {
            name: "Isle of Man",
            code: "IM"
        }, {
            name: "Israel",
            code: "IL"
        }, {
            name: "Italy",
            code: "IT"
        }, {
            name: "Jamaica",
            code: "JM"
        }, {
            name: "Japan",
            code: "JP"
        }, {
            name: "Jersey",
            code: "JE"
        }, {
            name: "Jordan",
            code: "JO"
        }, {
            name: "Kazakhstan",
            code: "KZ"
        }, {
            name: "Kenya",
            code: "KE"
        }, {
            name: "Kiribati",
            code: "KI"
        }, {
            name: "Korea",
            code: "KP"
        }, {
            name: "Korea, Republic of",
            code: "KR"
        }, {
            name: "Kuwait",
            code: "KW"
        }, {
            name: "Kyrgyzstan",
            code: "KG"
        }, {
            name: "Laos",
            code: "LA"
        }, {
            name: "Latvia",
            code: "LV"
        }, {
            name: "Lebanon",
            code: "LB"
        }, {
            name: "Lesotho",
            code: "LS"
        }, {
            name: "Liberia",
            code: "LR"
        }, {
            name: "Libyan Arab Jamahiriya",
            code: "LY"
        }, {
            name: "Liechtenstein",
            code: "LI"
        }, {
            name: "Lithuania",
            code: "LT"
        }, {
            name: "Luxembourg",
            code: "LU"
        }, {
            name: "Macao",
            code: "MO"
        }, {
            name: "Macedonia, The Former Yugoslav Republic of",
            code: "MK"
        }, {
            name: "Madagascar",
            code: "MG"
        }, {
            name: "Malawi",
            code: "MW"
        }, {
            name: "Malaysia",
            code: "MY"
        }, {
            name: "Maldives",
            code: "MV"
        }, {
            name: "Mali",
            code: "ML"
        }, {
            name: "Malta",
            code: "MT"
        }, {
            name: "Marshall Islands",
            code: "MH"
        }, {
            name: "Martinique",
            code: "MQ"
        }, {
            name: "Mauritania",
            code: "MR"
        }, {
            name: "Mauritius",
            code: "MU"
        }, {
            name: "Mayotte",
            code: "YT"
        }, {
            name: "Mexico",
            code: "MX"
        }, {
            name: "Micronesia, Federated States of",
            code: "FM"
        }, {
            name: "Moldova, Republic of",
            code: "MD"
        }, {
            name: "Monaco",
            code: "MC"
        }, {
            name: "Mongolia",
            code: "MN"
        }, {
            name: "Montserrat",
            code: "MS"
        }, {
            name: "Morocco",
            code: "MA"
        }, {
            name: "Mozambique",
            code: "MZ"
        }, {
            name: "Myanmar",
            code: "MM"
        }, {
            name: "Namibia",
            code: "NA"
        }, {
            name: "Nauru",
            code: "NR"
        }, {
            name: "Nepal",
            code: "NP"
        }, {
            name: "Netherlands",
            code: "NL"
        }, {
            name: "Netherlands Antilles",
            code: "AN"
        }, {
            name: "New Caledonia",
            code: "NC"
        }, {
            name: "New Zealand",
            code: "NZ"
        }, {
            name: "Nicaragua",
            code: "NI"
        }, {
            name: "Niger",
            code: "NE"
        }, {
            name: "Nigeria",
            code: "NG"
        }, {
            name: "Niue",
            code: "NU"
        }, {
            name: "Norfolk Island",
            code: "NF"
        }, {
            name: "Northern Mariana Islands",
            code: "MP"
        }, {
            name: "Norway",
            code: "NO"
        }, {
            name: "Oman",
            code: "OM"
        }, {
            name: "Pakistan",
            code: "PK"
        }, {
            name: "Palau",
            code: "PW"
        }, {
            name: "Palestinian Territory, Occupied",
            code: "PS"
        }, {
            name: "Panama",
            code: "PA"
        }, {
            name: "Papua New Guinea",
            code: "PG"
        }, {
            name: "Paraguay",
            code: "PY"
        }, {
            name: "Peru",
            code: "PE"
        }, {
            name: "Philippines",
            code: "PH"
        }, {
            name: "Pitcairn",
            code: "PN"
        }, {
            name: "Poland",
            code: "PL"
        }, {
            name: "Portugal",
            code: "PT"
        }, {
            name: "Puerto Rico",
            code: "PR"
        }, {
            name: "Qatar",
            code: "QA"
        }, {
            name: "Reunion",
            code: "RE"
        }, {
            name: "Romania",
            code: "RO"
        }, {
            name: "Russian Federation",
            code: "RU"
        }, {
            name: "RWANDA",
            code: "RW"
        }, {
            name: "Saint Helena",
            code: "SH"
        }, {
            name: "Saint Kitts and Nevis",
            code: "KN"
        }, {
            name: "Saint Lucia",
            code: "LC"
        }, {
            name: "Saint Pierre and Miquelon",
            code: "PM"
        }, {
            name: "Saint Vincent and the Grenadines",
            code: "VC"
        }, {
            name: "Samoa",
            code: "WS"
        }, {
            name: "San Marino",
            code: "SM"
        }, {
            name: "Sao Tome and Principe",
            code: "ST"
        }, {
            name: "Saudi Arabia",
            code: "SA"
        }, {
            name: "Senegal",
            code: "SN"
        }, {
            name: "Serbia and Montenegro",
            code: "CS"
        }, {
            name: "Seychelles",
            code: "SC"
        }, {
            name: "Sierra Leone",
            code: "SL"
        }, {
            name: "Singapore",
            code: "SG"
        }, {
            name: "Slovakia",
            code: "SK"
        }, {
            name: "Slovenia",
            code: "SI"
        }, {
            name: "Solomon Islands",
            code: "SB"
        }, {
            name: "Somalia",
            code: "SO"
        }, {
            name: "South Africa",
            code: "ZA"
        }, {
            name: "South Georgia and the South Sandwich Islands",
            code: "GS"
        }, {
            name: "Spain",
            code: "ES"
        }, {
            name: "Sri Lanka",
            code: "LK"
        }, {
            name: "Sudan",
            code: "SD"
        }, {
            name: "Suriname",
            code: "SR"
        }, {
            name: "Svalbard and Jan Mayen",
            code: "SJ"
        }, {
            name: "Swaziland",
            code: "SZ"
        }, {
            name: "Sweden",
            code: "SE"
        }, {
            name: "Switzerland",
            code: "CH"
        }, {
            name: "Syrian Arab Republic",
            code: "SY"
        }, {
            name: "Taiwan, Province of China",
            code: "TW"
        }, {
            name: "Tajikistan",
            code: "TJ"
        }, {
            name: "Tanzania, United Republic of",
            code: "TZ"
        }, {
            name: "Thailand",
            code: "TH"
        }, {
            name: "Timor-Leste",
            code: "TL"
        }, {
            name: "Togo",
            code: "TG"
        }, {
            name: "Tokelau",
            code: "TK"
        }, {
            name: "Tonga",
            code: "TO"
        }, {
            name: "Trinidad and Tobago",
            code: "TT"
        }, {
            name: "Tunisia",
            code: "TN"
        }, {
            name: "Turkey",
            code: "TR"
        }, {
            name: "Turkmenistan",
            code: "TM"
        }, {
            name: "Turks and Caicos Islands",
            code: "TC"
        }, {
            name: "Tuvalu",
            code: "TV"
        }, {
            name: "Uganda",
            code: "UG"
        }, {
            name: "Ukraine",
            code: "UA"
        }, {
            name: "United Arab Emirates",
            code: "AE"
        }, {
            name: "United Kingdom",
            code: "GB"
        }, {
            name: "United States",
            code: "US"
        }, {
            name: "United States Minor Outlying Islands",
            code: "UM"
        }, {
            name: "Uruguay",
            code: "UY"
        }, {
            name: "Uzbekistan",
            code: "UZ"
        }, {
            name: "Vanuatu",
            code: "VU"
        }, {
            name: "Venezuela",
            code: "VE"
        }, {
            name: "Viet Nam",
            code: "VN"
        }, {
            name: "Virgin Islands, British",
            code: "VG"
        }, {
            name: "Virgin Islands, U.S.",
            code: "VI"
        }, {
            name: "Wallis and Futuna",
            code: "WF"
        }, {
            name: "Western Sahara",
            code: "EH"
        }, {
            name: "Yemen",
            code: "YE"
        }, {
            name: "Zambia",
            code: "ZM"
        }, {
            name: "Zimbabwe",
            code: "ZW"
        }];
        function $o(e, t) {
            var i = Object.keys(e);
            if (Object.getOwnPropertySymbols) {
                var o = Object.getOwnPropertySymbols(e);
                t && (o = o.filter((function(t) {
                    return Object.getOwnPropertyDescriptor(e, t).enumerable
                }))),
                i.push.apply(i, o)
            }
            return i
        }
        const Co = {
                SignUp0: e => {
                    const t = Object(b.getLocale)(),
                        i = t => {
                            e.setFormState({
                                isBusiness: "true" === t.target.value
                            })
                        };
                    return a.createElement(a.Fragment, null, a.createElement(ee.a, {
                        className: "close-popup",
                        onFastClick: () => e.close()
                    }), a.createElement("h4", {
                        className: "center mb-24"
                    }, t.signUpHeader1_1, a.createElement("br", null), t.signUpHeader1_2), a.createElement("div", {
                        className: "mb-24"
                    }, a.createElement("label", {
                        className: "form-control"
                    }, a.createElement("input", {
                        onChange: i,
                        checked: e.formState.isBusiness,
                        type: "radio",
                        name: "userType",
                        value: "true"
                    }), a.createElement("div", {
                        className: "radio-control"
                    }, t.business)), a.createElement("label", {
                        className: "form-control"
                    }, a.createElement("input", {
                        onChange: i,
                        checked: !e.formState.isBusiness,
                        type: "radio",
                        name: "userType",
                        value: "false"
                    }), a.createElement("div", {
                        className: "radio-control"
                    }, t.private))), a.createElement("div", {
                        className: "center mb-40 body--2 content--60"
                    }, t.signUpBusinessMessage), a.createElement("div", {
                        className: "mb-24"
                    }, a.createElement(ee.a, {
                        className: "button button--filled",
                        onFastClick: () => e.switchPage("SignUp1")
                    }, t.next)), a.createElement("div", {
                        className: "center"
                    }, t.haveAnAccount, " ", a.createElement(ee.a, {
                        onFastClick: () => e.switchPage("SignIn0"),
                        className: "link"
                    }, t.login2)))
                },
                SignUp1: e => {
                    const t = Object(b.getLocale)(),
                        [i, o] = a.useState(!1),
                        [n, s] = a.useState(null),
                        r = e.formState.email.length && b.util.isValidEmail(e.formState.email),
                        c = e.formState.password.length >= 8,
                        d = r && c;
                    return a.createElement(a.Fragment, null, a.createElement(ee.a, {
                        className: "close-popup",
                        onFastClick: () => e.close()
                    }), a.createElement("h4", {
                        className: "center mb-24"
                    }, t.signUpHeader2), a.createElement("div", {
                        className: "mb-24"
                    }, a.createElement("label", {
                        className: "form-control required"
                    }, a.createElement("span", {
                        className: "caption"
                    }, t.emailAddress), a.createElement("input", {
                        type: "email",
                        required: !0,
                        onChange: t => {
                            e.setFormState({
                                email: t.target.value
                            }),
                            o(!1)
                        },
                        value: e.formState.email,
                        className: Object(to.a)({
                            error: i && !r
                        })
                    }), i && !r ? a.createElement("div", {
                        className: "error-message"
                    }, t.invalidUserEMail) : null), a.createElement("label", {
                        className: "form-control required"
                    }, a.createElement("span", {
                        className: "caption"
                    }, t.password), a.createElement("input", {
                        type: "password",
                        onChange: t => {
                            e.setFormState({
                                password: t.target.value
                            }),
                            o(!1)
                        },
                        value: e.formState.password,
                        className: Object(to.a)({
                            error: i && !c
                        })
                    }), i && !c ? a.createElement("div", {
                        className: "error-message"
                    }, t.passwordSpecificLength) : null), a.createElement("div", {
                        className: "mb-24"
                    }, a.createElement("label", {
                        className: "form-control"
                    }, a.createElement("input", {
                        type: "checkbox",
                        name: "newsletter",
                        onChange: t => {
                            e.setFormState({
                                newsletter: t.target.checked
                            }),
                            o(!1)
                        },
                        checked: e.formState.newsletter
                    }), a.createElement("div", {
                        className: "checkbox-control"
                    }, t.signUpNewsletter, " ", a.createElement("a", {
                        className: "privacy-link",
                        href: "https://ninox.com/privacy#privacy5",
                        target: "_blank"
                    }, t.signUpPrivacyPolicy))))), i && n ? a.createElement("div", {
                        className: "form-error-message mb-24 center"
                    }, n) : null, a.createElement("div", {
                        className: "mb-24"
                    }, a.createElement(ee.a, {
                        className: "button button--filled",
                        onFastClick: function() {
                            o(!0),
                            d && Object(l.b)((t, i) => {
                                t && console.warn("Could not fetch attribution details", t),
                                $.loading(!0),
                                window.dbms.getRemoteConnection().signup({
                                    email: e.formState.email,
                                    password: e.formState.password,
                                    newsletter: e.formState.newsletter,
                                    iadAttributionDetails: i
                                }, (t, i) => {
                                    if (window.trackEvent("signup", t ? "error" : "success"), Object(l.f)("Signup", t ? "Error" : "Success"), $.loading(!1), t)
                                        return s(t);
                                    e.setUserId(i),
                                    e.formState.isBusiness ? e.switchPage("SignUp2") : (e.close(), e.afterLogin())
                                })
                            })
                        }
                    }, t.register)), a.createElement("div", {
                        className: "center"
                    }, t.termsDisclamer.split("$")[0], a.createElement("a", {
                        href: "https://ninox.com/en/terms",
                        className: "link"
                    }, t.termsDisclamer.split("$")[1]), t.termsDisclamer.split("$")[2]), a.createElement("div", {
                        className: "or-line"
                    }, a.createElement("div", {
                        className: "or-text"
                    }, t.op_or)), a.createElement("div", {
                        className: "center"
                    }, t.haveAnAccount, " ", a.createElement(ee.a, {
                        onFastClick: () => e.switchPage("SignIn0"),
                        className: "link"
                    }, t.login2)))
                },
                SignUp2: e => {
                    const t = Object(b.getLocale)(),
                        [i, o] = a.useState(!1),
                        [n, s] = a.useState(null),
                        r = !!e.formState.displayName.length,
                        l = !!e.formState.company.length,
                        c = e.formState.telephone.length > 6,
                        d = r && l && c;
                    return a.createElement(a.Fragment, null, a.createElement("h4", {
                        className: "center mb-24"
                    }, t.signUpHeader3), a.createElement("div", {
                        className: "mb-24"
                    }, a.createElement("label", {
                        className: "form-control required"
                    }, a.createElement("span", {
                        className: "caption"
                    }, t.fullName), a.createElement("input", {
                        className: Object(to.a)({
                            error: i && !r
                        }),
                        type: "text",
                        required: !0,
                        onChange: t => {
                            e.setFormState({
                                displayName: t.target.value
                            }),
                            o(!1)
                        },
                        value: e.formState.displayName
                    }), i && !r ? a.createElement("div", {
                        className: "error-message"
                    }, t.allFieldsAreRequired) : null), a.createElement("label", {
                        className: "form-control required"
                    }, a.createElement("span", {
                        className: "caption"
                    }, t.company), a.createElement("input", {
                        className: Object(to.a)({
                            error: i && !l
                        }),
                        type: "text",
                        required: !0,
                        onChange: t => {
                            e.setFormState({
                                company: t.target.value
                            }),
                            o(!1)
                        },
                        value: e.formState.company
                    }), i && !l ? a.createElement("div", {
                        className: "error-message"
                    }, t.allFieldsAreRequired) : null), a.createElement("span", {
                        className: "form-control required"
                    }, a.createElement("span", {
                        className: "caption"
                    }, t.country), a.createElement("input", {
                        type: "text",
                        required: !0,
                        value: e.formState.country,
                        readOnly: !0
                    }), a.createElement("select", {
                        value: e.formState.country,
                        onChange: t => e.setFormState({
                            country: t.target.value
                        }),
                        style: {
                            width: "100%",
                            position: "absolute",
                            top: "32px",
                            left: 0,
                            opacity: 0
                        }
                    }, To.map(({name: e}) => a.createElement("option", {
                        key: e,
                        value: e
                    }, e)))), a.createElement("label", {
                        className: "form-control required"
                    }, a.createElement("span", {
                        className: "caption"
                    }, t.workPhone), a.createElement("input", {
                        className: Object(to.a)({
                            error: i && !c
                        }),
                        type: "phone",
                        required: !0,
                        onChange: t => {
                            e.setFormState({
                                telephone: t.target.value
                            }),
                            o(!1)
                        },
                        value: e.formState.telephone
                    }), i && !c ? a.createElement("div", {
                        className: "error-message"
                    }, t.allFieldsAreRequired) : null)), i && n ? a.createElement("div", {
                        className: "form-error-message mb-24 center"
                    }, n) : null, a.createElement("div", {
                        className: "mb-24"
                    }, a.createElement(ee.a, {
                        className: "button button--filled",
                        onFastClick: function() {
                            if (!d)
                                return o(!0);
                            const {displayName: t, company: i, country: n, telephone: a} = e.formState;
                            $.loading(!0),
                            window.dbms.getRemoteConnection().updateUserProfile({
                                displayName: t,
                                company: i,
                                country: n,
                                telephone: a
                            }, t => {
                                if (t)
                                    return s(t);
                                e.close(),
                                $.loading(!1),
                                e.afterLogin()
                            })
                        }
                    }, t.saveProfile)), a.createElement("div", {
                        className: "body--2 content--60 center"
                    }, t.allFieldsAreRequired))
                },
                SignIn0: e => {
                    const t = Object(b.getLocale)(),
                        [i, o] = a.useState(!1),
                        [n, s] = a.useState(!1),
                        r = e.formState.email,
                        [d, h] = a.useState(""),
                        p = r.length && d.length;
                    function u() {
                        if (!p)
                            return o(!0);
                        const t = window.dbms;
                        $.loading(!0),
                        t.getRemoteConnection().login(r, d, i => {
                            if (window.trackEvent("login", i ? "error" : "success"), Object(l.f)("Login", i ? "Error" : "Success"), $.loading(!1), i)
                                return s(!0);
                            const o = t.getRemoteConnection().getCurrentUser();
                            e.setUserId(o.id),
                            Object(c.f)() && o.passwordExpired && t.getRemoteConnection().logout(() => {
                                e.switchPage("ResetPassword0")
                            }),
                            NinoxDocumentInteraction.setUserDefault("nx.session.logout.user", ""),
                            NinoxDocumentInteraction.setUserDefault("nx.session.login.user", r),
                            e.close(),
                            e.afterLogin()
                        })
                    }
                    function f(e) {
                        13 === e.nativeEvent.keyCode && p && u()
                    }
                    return a.createElement(a.Fragment, null, a.createElement(ee.a, {
                        className: "close-popup",
                        onFastClick: () => e.close()
                    }), a.createElement("div", {
                        className: "mb-24"
                    }, a.createElement("label", {
                        className: "form-control required"
                    }, a.createElement("span", {
                        className: "caption"
                    }, t.emailAddress), a.createElement("input", {
                        className: Object(to.a)({
                            error: i && 0 === r.length
                        }),
                        type: "email",
                        required: !0,
                        onKeyDown: f,
                        onChange: t => {
                            var i;
                            i = t.target.value,
                            e.setFormState({
                                email: i
                            }),
                            s(!1)
                        },
                        value: r
                    })), a.createElement("label", {
                        className: "form-control required"
                    }, a.createElement("span", {
                        className: "caption"
                    }, t.password), a.createElement("input", {
                        className: Object(to.a)({
                            error: i && 0 === d.length
                        }),
                        type: "password",
                        required: !0,
                        onKeyDown: f,
                        onChange: e => {
                            h(e.target.value),
                            s(!1)
                        },
                        value: d
                    }))), n ? a.createElement("div", {
                        className: "form-error-message mb-24 center"
                    }, t.invalidCredentials) : null, a.createElement("div", {
                        className: "mb-24"
                    }, a.createElement(ee.a, {
                        className: "button button--filled",
                        onFastClick: u
                    }, t.login)), e.canSignup ? a.createElement("div", null, a.createElement("div", {
                        className: "center"
                    }, a.createElement(ee.a, {
                        onFastClick: () => e.switchPage("SignUp0"),
                        className: "link"
                    }, t.dontHaveAnAccount)), a.createElement("div", {
                        className: "or-line"
                    }, a.createElement("div", {
                        className: "or-text"
                    }, t.op_or))) : null, a.createElement("div", {
                        className: "center"
                    }, a.createElement("span", null, t.problemsLoggingIn, " "), a.createElement(ee.a, {
                        onFastClick: () => e.switchPage("ForgotPassword0"),
                        className: "link"
                    }, t.resetPassword)))
                },
                ResetPassword0: e => {
                    const t = Object(b.getLocale)(),
                        [i, o] = a.useState(null),
                        [n, s] = a.useState(""),
                        [r, l] = a.useState(""),
                        [c, d] = a.useState(""),
                        h = n === r && n.length > 0,
                        p = r !== c && c.length > 0 && !h,
                        u = !p && !h && n.length > 0;
                    return a.createElement(a.Fragment, null, a.createElement("h4", {
                        className: "center mb-24"
                    }, t.passwordExpired), a.createElement("div", {
                        className: "mb-24"
                    }, a.createElement("div", {
                        className: "",
                        style: {
                            width: "100%"
                        }
                    }, a.createElement("label", {
                        className: "form-control required"
                    }, a.createElement("span", {
                        className: "caption"
                    }, t.oldPassword), a.createElement("input", {
                        type: "password",
                        required: !0,
                        onChange: e => {
                            s(e.target.value),
                            o(null)
                        },
                        value: n
                    })), a.createElement("label", {
                        className: "form-control required"
                    }, a.createElement("span", {
                        className: "caption"
                    }, t.newPassword), a.createElement("input", {
                        type: "password",
                        required: !0,
                        onChange: e => {
                            l(e.target.value),
                            o(null)
                        },
                        value: r
                    }), h ? a.createElement("div", {
                        className: "error-message"
                    }, t.newOldPassword) : null), a.createElement("label", {
                        className: "form-control required"
                    }, a.createElement("span", {
                        className: "caption"
                    }, t.repeatPassword), a.createElement("input", {
                        type: "password",
                        required: !0,
                        onChange: e => {
                            d(e.target.value),
                            o(null)
                        },
                        value: c
                    }), p ? a.createElement("div", {
                        className: "error-message"
                    }, t.matchPasswords) : null)), i ? a.createElement("div", {
                        className: "form-error-message mb-24 center"
                    }, i) : null), a.createElement("div", {
                        className: "mb-24"
                    }, a.createElement(ee.a, {
                        className: "button button--filled",
                        onFastClick: function() {
                            if (!u)
                                return;
                            window.dbms.getRemoteConnection().changeExpiredPassword({
                                userId: e.userId,
                                oldPassword: n,
                                newPassword: r
                            }, (t, i) => {
                                if (t)
                                    return o(t);
                                e.close()
                            })
                        }
                    }, t.save)))
                },
                ForgotPassword0: e => {
                    const t = Object(b.getLocale)(),
                        [i, o] = a.useState(!1),
                        [n, s] = a.useState(null),
                        r = b.util.isValidEmail(e.formState.email);
                    return a.createElement(a.Fragment, null, a.createElement(ee.a, {
                        className: "close-popup",
                        onFastClick: () => e.close()
                    }), a.createElement("h4", {
                        className: "center mb-24"
                    }, t.forgotPassword), a.createElement("div", {
                        className: "mb-24"
                    }, a.createElement("div", {
                        className: "",
                        style: {
                            width: "100%"
                        }
                    }, a.createElement("label", {
                        className: "form-control required"
                    }, a.createElement("span", {
                        className: "caption"
                    }, t.email), a.createElement("input", {
                        className: Object(to.a)({
                            error: i && !r
                        }),
                        type: "email",
                        required: !0,
                        onChange: t => {
                            e.setFormState({
                                email: t.target.value
                            }),
                            o(!1)
                        },
                        value: e.formState.email
                    }), i && !r ? a.createElement("div", {
                        className: "error-message"
                    }, t.emailNotRegistered) : null))), n ? a.createElement("div", {
                        className: "form-error-message mb-24 center"
                    }, t.wrongUserPassword) : null, a.createElement("div", {
                        className: "mb-24"
                    }, a.createElement(ee.a, {
                        className: "button button--filled",
                        onFastClick: function() {
                            if (!r)
                                return o(!0);
                            const i = window.dbms;
                            Object(l.f)("ForgotPassword", "Click"),
                            i.getRemoteConnection().forgotPassword({
                                email: e.formState.email
                            }, i => {
                                i ? (s(i), Object(l.f)("ForgotPassword", "Error")) : (s(t.forgotPasswordSuccess + ":\n" + e.formState.email), Object(l.f)("ForgotPassword", "Success"), e.switchPage("SignIn0"))
                            })
                        }
                    }, t.resetPassword)), a.createElement("div", {
                        className: "center"
                    }, a.createElement("span", null, t.noNeedToResetPassword, " "), a.createElement(ee.a, {
                        onFastClick: () => e.switchPage("SignIn0"),
                        className: "link"
                    }, t.signIn)))
                }
            },
            ko = e => {
                const [t, i] = a.useState(e.wantsSignup ? "SignUp0" : "SignIn0"),
                    [o, n] = a.useState(""),
                    [s, r] = a.useState({
                        password: "",
                        displayName: "",
                        telephone: "",
                        country: "Germany",
                        company: "",
                        email: "",
                        locale: "",
                        isBusiness: !0,
                        newsletter: !1
                    });
                const c = Co[t] || null;
                return a.createElement(a.Fragment, null, a.createElement("div", {
                    className: "credentials-popup--background"
                }, a.createElement("div", {
                    className: "credentials-popup--content"
                }, a.createElement("div", {
                    className: "credentials"
                }, c && a.createElement(c, {
                    formState: s,
                    setFormState: function(e) {
                        r(function(e) {
                            for (var t = 1; t < arguments.length; t++) {
                                var i = null != arguments[t] ? arguments[t] : {};
                                t % 2 ? $o(Object(i), !0).forEach((function(t) {
                                    K()(e, t, i[t])
                                })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(i)) : $o(Object(i)).forEach((function(t) {
                                    Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(i, t))
                                }))
                            }
                            return e
                        }({}, s, {}, e))
                    },
                    switchPage: function(e) {
                        Object(l.f)(e, "Open"),
                        i(e)
                    },
                    close: e.close,
                    afterLogin: e.afterLogin,
                    canSignup: e.canSignup,
                    userId: o,
                    setUserId: n
                })))))
            };
        o("./src/react/EmailVerificationReminder.css");
        const So = e => r.a.createElement("div", {
            className: "EmailVerificationReminder_root"
        }, r.a.createElement("div", {
            className: "i-48-24 i-asIs i-email-notification EmailVerificationReminder_icon"
        }), r.a.createElement("div", null, r.a.createElement("div", {
            className: "EmailVerificationReminder_header"
        }, Object(b.getLocale)().pleaseConfirmYourEmail), r.a.createElement("div", {
            className: "EmailVerificationReminder_body"
        }, r.a.createElement("span", {
            className: "EmailVerificationReminder_buttonContainer"
        }, r.a.createElement(ee.a, {
            onFastClick: e.onResendClick,
            className: "EmailVerificationReminder_button"
        }, Object(b.getLocale)().resend), ` ${Object(b.getLocale)().to} ${e.email} `), r.a.createElement("span", {
            className: "EmailVerificationReminder_buttonContainer"
        }, Object(b.getLocale)().or, " ", r.a.createElement(ee.a, {
            className: "EmailVerificationReminder_button",
            onFastClick: e.onContactSupportClick
        }, Object(b.getLocale)().contactSupport)))));
        o("./src/react/verification/ResendButton.scss");
        Object(b.getLocale)().resend;
        const Eo = e => {
                const t = Object(b.getLocale)(),
                    [i, o] = a.useState(0);
                function n() {
                    0 === i && (o(1), e.action().then(() => {
                        setTimeout(() => {
                            o(2),
                            setTimeout(() => {
                                o(0)
                            }, 2e3)
                        }, 500)
                    }).catch(e => console.error("resend error: ", e)))
                }
                return a.createElement(a.Fragment, null, a.createElement("div", {
                    className: "resend-button nx-button-text blue",
                    onTouchEnd: n,
                    onMouseUp: n
                }, a.createElement("div", {
                    className: Object(to.a)("btn-wrapper", {
                        next: 0 === i,
                        prev: 1 === i
                    })
                }, t.resend), a.createElement("div", {
                    className: Object(to.a)("btn-wrapper", {
                        next: 1 === i,
                        prev: 2 === i
                    })
                }, a.createElement("div", {
                    className: "small-spinner"
                })), a.createElement("div", {
                    className: Object(to.a)("btn-wrapper", {
                        next: 2 === i,
                        prev: 0 === i
                    })
                }, t.sent)))
            },
            _o = e => a.createElement(ee.a, {
                className: Object(to.a)("nx-button-text", e.type, {
                    disabled: !!e.disabled
                }),
                onFastClick: () => {
                    e.disabled || e.onClick()
                }
            }, e.children),
            Do = {
                Verify1: e => {
                    const t = Object(b.getLocale)(),
                        i = (new Date).getHours();
                    let o;
                    const n = [t.night, t.morning, t.day, t.evening];
                    return o = i < 12 ? i < 6 ? 0 : 1 : i < 18 ? 2 : 3, a.createElement(a.Fragment, null, a.createElement("div", {
                        className: "mb-16"
                    }, a.createElement("div", {
                        className: "i-48-48 i-asIs i-email-notification"
                    })), a.createElement("h4", {
                        className: "mb-16"
                    }, t.helloGood$.replace("$", n[o])), a.createElement("div", {
                        className: "content--60"
                    }, t.verificationLinkSent), a.createElement("div", {
                        className: "mb-16"
                    }, e.user.email), a.createElement("div", {
                        className: "mb-48 content--60"
                    }, t.canFindIt), a.createElement("div", {
                        style: {
                            display: "flex"
                        }
                    }, a.createElement(Eo, {
                        action: e.resend
                    })))
                },
                Verify2: e => {
                    const t = Object(b.getLocale)(),
                        i = t.verifyEmail$.trim().split("$");
                    return a.createElement(a.Fragment, null, a.createElement("div", {
                        className: "mb-16"
                    }, a.createElement("div", {
                        className: "i-48-48 i-asIs i-email-notification"
                    })), a.createElement("h4", {
                        className: "mb-16"
                    }, t.verificationPending), a.createElement("div", {
                        className: "mb-48 content--60"
                    }, i[0], a.createElement("span", {
                        className: "content--80"
                    }, e.user.email), i[1]), a.createElement("div", {
                        style: {
                            display: "flex"
                        }
                    }, a.createElement(Eo, {
                        action: e.resend
                    }), a.createElement("div", {
                        className: "nx-hspace-small2"
                    }), a.createElement(_o, {
                        type: "grey-simple",
                        onClick: () => e.logout()
                    }, t.switchAccount)))
                }
            },
            Mo = e => {
                const [t, i] = a.useState(e.isFirst ? "Verify1" : "Verify2");
                const o = Do[t] || null;
                return a.createElement(a.Fragment, null, a.createElement("div", {
                    className: "verify-popup--background"
                }, a.createElement("div", {
                    className: "credentials-popup--content"
                }, a.createElement("div", {
                    className: "credentials"
                }, o && a.createElement(o, {
                    user: e.user,
                    switchPage: function(e) {
                        Object(l.f)(e, "Open"),
                        i(e)
                    },
                    logout: e.logout,
                    resend: e.resend
                })))))
            };
        o("./src/react/AdminDatabaseActions.css");
        const No = e => a.createElement("div", {
            className: "AdminDataBaseActions_root" + (e.isEmptyTeam ? "AdminDataBaseActionsEmptyTeam" : "")
        }, a.createElement("div", {
            className: "AdminDatabaseActions_buttonsContainer"
        }, a.createElement("div", {
            className: "AdminDatabaseActions_buttonContainer --ul-create-db-button"
        }, a.createElement(ee.a, {
            onFastClick: e.onNewDatabaseClick,
            behaviour: "FORCE_RIPPLE",
            className: "AdminDatabaseActions_iconContainer"
        }, a.createElement("div", {
            className: "i-32-24 i-light-grey i-plus"
        })), a.createElement("div", {
            className: "AdminDatabaseActions_textContainer"
        }, Object(b.getLocale)().createDatabase)), a.createElement("div", {
            className: "AdminDatabaseActions_buttonContainer"
        }, a.createElement(ee.a, {
            onFastClick: e.onImportArchiveClick,
            behaviour: "FORCE_RIPPLE",
            className: "AdminDatabaseActions_iconContainer"
        }, a.createElement("div", {
            className: "i-32-24 i-light-grey i-setting-import"
        })), a.createElement("div", {
            className: "AdminDatabaseActions_textContainer"
        }, Object(b.getLocale)().importArchive)), void 0 !== e.onManageBackupsClick ? a.createElement("div", {
            className: "AdminDatabaseActions_buttonContainer"
        }, a.createElement(ee.a, {
            onFastClick: e.onManageBackupsClick,
            behaviour: "FORCE_RIPPLE",
            className: "AdminDatabaseActions_iconContainer"
        }, a.createElement("div", {
            className: "i-32-24 i-light-grey i-backup"
        })), a.createElement("div", {
            className: "AdminDatabaseActions_textContainer"
        }, Object(b.getLocale)().manageBackups)) : null));
        o("./src/react/DatabaseIcon.css");
        const Io = e => {
            const [t, i] = a.useState(null);
            a.useEffect(() => {
                !async function() {
                    let t = e.db.icon;
                    "URL" === e.db.type && null !== t && (t.startsWith("//") && (t = "https:" + t), t.startsWith("https://") && (t = await window.localFileSystem.cachedURL(t, null) || t), i(t))
                }()
            }, [e.db.icon]);
            const o = t => {
                void 0 !== e.onContextMenu && e.onContextMenu(t, e.db.id, "DatabaseIcon_rootId" + e.index)
            };
            return a.createElement(a.Fragment, null, a.createElement(ee.a, {
                id: "DatabaseIcon_rootId" + e.index,
                behaviour: "FORCE_RIPPLE",
                onFastClick: () => e.onClick(e.db.id),
                onFastContextMenu: o,
                className: Object(to.a)("root-db DatabaseIcon_buttonContainer", e.db.isStored ? "root-db-stored" : "root-db-not-stored", "--ul-db-root"),
                "data-dbtype": "sync"
            }, a.createElement("div", {
                className: "DatabaseIcon_iconContainer",
                style: {
                    backgroundColor: e.db.color ? e.db.color : ""
                }
            }, (e => {
                let i,
                    o,
                    n;
                return "URL" === e.type && null !== t ? o = {
                    background: `url(${t})`,
                    backgroundSize: "contain",
                    backgroundRepeat: "no-repeat",
                    width: "40px",
                    height: "40px",
                    padding: "4px"
                } : (n = `root-db-icon i-db-icon-big i-db i-${e.icon ? e.icon : "0"}`, i = "DatabaseIcon_newIconWrapper"), a.createElement("span", {
                    className: i
                }, a.createElement("div", {
                    className: n,
                    style: o
                }), e.isStored ? null : a.createElement("div", {
                    className: "db-badge db-badge-new db-badge-react"
                }))
            })(e.db)), void 0 === e.onContextMenu ? null : a.createElement(ee.a, {
                className: "root-db-indicator-place",
                onFastClick: o,
                onContextMenu: () => {}
            }, a.createElement("div", {
                className: (e.db.isStored ? "root-db-indicator" : "root-db-indicator-new") + " i-32-24 i-light-grey i-line-down"
            })), a.createElement("div", {
                className: "root-db-hover-place"
            }, a.createElement("div", {
                className: "root-db-hover",
                style: {
                    background: e.db.color ? e.db.color : ""
                }
            })), void 0 === e.db.name ? null : a.createElement("div", {
                className: "DatabaseIcon_textContainer"
            }, e.db.name), void 0 !== e.db.localStorageType ? a.createElement("div", {
                style: {
                    position: "absolute",
                    top: 0
                },
                className: Object(to.a)("i-32-24 i-light-grey", {
                    "i-cloud-okay": "cloud" === e.db.localStorageType
                })
            }) : null))
        };
        o("./src/react/DatabaseList.css");
        class Oo extends a.Component {
            constructor(e)
            {
                super(e),
                K()(this, "handleContext", (e, t, i) => {
                    this.props.onContextMenuClick(ee.b.getTarget(e).closest("#" + i), t)
                })
            }
            render()
            {
                return a.createElement("div", {
                    className: "DatabaseList_root"
                }, this.props.databases.map((e, t) => a.createElement("div", {
                    key: e.id,
                    className: "DatabaseList_item"
                }, a.createElement(Io, {
                    index: t,
                    onClick: this.props.onDatabaseClick,
                    db: e,
                    onContextMenu: this.handleContext
                }))))
            }
        }
        function Ro(e, t) {
            var i = Object.keys(e);
            if (Object.getOwnPropertySymbols) {
                var o = Object.getOwnPropertySymbols(e);
                t && (o = o.filter((function(t) {
                    return Object.getOwnPropertyDescriptor(e, t).enumerable
                }))),
                i.push.apply(i, o)
            }
            return i
        }
        class jo extends a.Component {
            constructor(e)
            {
                super(e),
                K()(this, "handleContextMenu", (e, t) => {
                    Object(l.f)("DatabaseMenu", "Open"),
                    this.setState({
                        currentContext: {
                            target: e,
                            id: t
                        }
                    })
                }),
                K()(this, "getContextMenuItems", () => {
                    const e = [];
                    return this.props.isAdmin && e.push({
                        text: Object(b.getLocale)().renameDatabase,
                        onClick: () => this.handleContextMenuItemClick("DatabaseMenu", this.props.onRenameDatabase)
                    }, {
                        text: Object(b.getLocale)().createBackup,
                        onClick: () => this.handleContextMenuItemClick("CreateBackup", this.props.onCreateBackup)
                    }, {
                        text: Object(b.getLocale)().remove,
                        onClick: () => this.handleContextMenuItemClick("Remove", this.props.onRemove)
                    }), window.NINOX_APP && e.push({
                        text: Object(b.getLocale)().resetSync,
                        onClick: () => this.handleContextMenuItemClick("ResetSync", this.props.onResetSync)
                    }), e
                }),
                this.state = {
                    currentContext: null,
                    classAndStyle: {
                        className: "",
                        style: {}
                    }
                }
            }
            async updateClassAndStyle()
            {
                const e = await this.getClassAndStyle();
                b.util.equals(e, this.state.classAndStyle) || this.setState(function(e) {
                    for (var t = 1; t < arguments.length; t++) {
                        var i = null != arguments[t] ? arguments[t] : {};
                        t % 2 ? Ro(Object(i), !0).forEach((function(t) {
                            K()(e, t, i[t])
                        })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(i)) : Ro(Object(i)).forEach((function(t) {
                            Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(i, t))
                        }))
                    }
                    return e
                }({}, this.state, {
                    classAndStyle: e
                }))
            }
            render()
            {
                this.updateClassAndStyle();
                const e = this.getCustomHTML(),
                    t = this.getDatabases(),
                    i = 0 === t.length,
                    {className: o, style: n} = this.state.classAndStyle;
                return a.createElement("div", {
                    className: Object(to.a)(o, "--ul-database"),
                    style: n
                }, a.createElement(Oo, {
                    databases: t,
                    onContextMenuClick: this.handleContextMenu,
                    onDatabaseClick: this.props.onDatabaseClick
                }), this.props.isAdmin ? a.createElement(No, {
                    isEmptyTeam: i,
                    onNewDatabaseClick: this.props.onNewDatabaseClick,
                    onImportArchiveClick: this.props.onImportArchiveClick,
                    onManageBackupsClick: this.props.onManageBackupsClick
                }) : null, i ? null : a.createElement(io, {
                    items: this.getContextMenuItems(),
                    positionAdjustment: {
                        top: -20,
                        left: 0
                    },
                    clickTarget: null !== this.state.currentContext ? this.state.currentContext.target : null,
                    onClick: () => this.setState({
                        currentContext: null
                    }),
                    show: null !== this.state.currentContext
                }), e ? a.createElement("div", {
                    dangerouslySetInnerHTML: {
                        __html: e
                    }
                }) : null)
            }
            handleContextMenuItemClick(e, t)
            {
                Object(rt.a)(this.state.currentContext),
                Object(l.f)("DatabaseMenu", e),
                t(this.state.currentContext.id),
                this.setState({
                    currentContext: null
                })
            }
            getCustomHTML()
            {
                const e = this.props.account;
                return (e ? e.settings : {}).backgroundCustomHTML
            }
            async getClassAndStyle()
            {
                const e = this.props.account,
                    t = e ? e.settings : {},
                    i = t.backgroundCustomCSS,
                    o = e ? await e.backgroundURL() : null;
                let n = "";
                const s = {};
                if (i) {
                    n = "root-remote-dblist";
                    for (const e in i)
                        if (i.hasOwnProperty(e)) {
                            let t = i[e];
                            const o = /^url\((.*)\)$/.exec(t);
                            if (o) {
                                const e = o[1];
                                t = "url(" + (await this.props.localFileSystem.cachedURL(e, null) || e) + ")"
                            }
                            s[e.replace(/-[a-z]/g, e => e[1].toUpperCase())] = t
                        }
                } else if (t.bgType) {
                    if ("solid" === t.bgType)
                        n = "root-remote-dblist",
                        s.backgroundImage = "",
                        s.backgroundColor = t.bgColor || "";
                    else if ("gradient" === t.bgType)
                        n = "root-remote-dblist",
                        s.backgroundImage = "linear-gradient(" + (t.bgGradient0 || "#ccc") + " 0%, " + (t.bgGradient1 || "#aaa") + " 100%)",
                        s.backgroundColor = "";
                    else if ("image" === t.bgType)
                        n = "root-remote-dblist background-file",
                        s.backgroundImage = 'url("' + o + '")',
                        s.backgroundColor = t.bgColor || "";
                    else {
                        const e = t.backgroundClass || "background";
                        n = "root-remote-dblist background " + e,
                        "background-file" === e ? (s.backgroundImage = 'url("' + o + '")', s.backgroundColor = t.bgColor || "") : (s.backgroundImage = "", s.backgroundColor = "")
                    }
                    s.backgroundPosition = (t.bgPosH || "center") + " " + (t.bgPosV || "center"),
                    s.backgroundSize = t.bgSize || "cover",
                    s.backgroundRepeat = t.bgRepeat || "no-repeat"
                } else
                    n = "root-remote-dblist",
                    s.backgroundPosition = "center center",
                    s.backgroundSize = "cover",
                    s.backgroundRepeat = "no-repeat",
                    s.backgroundImage = "";
                return this.props.hideUserList && (s.right = "0"), {
                    className: n,
                    style: s
                }
            }
            getDatabases()
            {
                const e = this.props.account;
                return e ? e.listDatabases().map(e => {
                    const t = e.settings,
                        i = t ? t.icon : null,
                        o = t ? t.color : null;
                    return {
                        name: e.name,
                        id: e.id,
                        isStored: e.isStored,
                        color: o,
                        icon: i,
                        type: /^(https?\:)?\/\//.test(i) ? "URL" : "IMAGE"
                    }
                }) : []
            }
        }
        class Lo extends a.Component {
            constructor(e)
            {
                super(e)
            }
            render()
            {
                const e = this.props.account,
                    t = e.getInvitations();
                return e.isAdmin() ? a.createElement(a.Fragment, null, t.length > 0 ? a.createElement(a.Fragment, null, a.createElement("div", {
                    className: "account-head",
                    style: {
                        marginTop: "16px"
                    }
                }, Object(b.getLocale)().invitations), a.createElement("div", {
                    className: "account-invitations"
                }, t.map(e => a.createElement(ee.a, {
                    key: e.inviteCode,
                    className: "account-invitation",
                    onFastClick: () => this.props.onClick(e.inviteCode)
                }, a.createElement("div", {
                    className: "account-invitation-name"
                }, e.email))))) : null, a.createElement(ee.a, {
                    style: {
                        padding: "0 24px"
                    },
                    className: "root-remote-button",
                    onFastClick: this.props.invite
                }, a.createElement("div", {
                    className: "i-32-24 i-blue i-setting-add"
                }), a.createElement("span", null, Object(b.getLocale)().invite))) : null
            }
        }
        function Fo(e) {
            const t = e.plan;
            return "trial" === t.name ? a.createElement("div", {
                className: "account-plan"
            }, Object(b.getLocale)().planTrial, a.createElement("br", null), Object(b.getLocale)().planTrialExpiresAt, ": ", b.util.formatLocaleDate(t.expiresAt)) : "basic" === t.name ? t.collaborators >= t.accountableUserCount ? a.createElement("div", {
                className: "account-plan"
            }, Object(b.getLocale)().planCurrentCovers.replace("$1", t.collaborators)) : a.createElement("div", {
                className: "account-plan"
            }, a.createElement("div", {
                className: "icon-big-white icon-big-close",
                style: {
                    backgroundColor: "#f00",
                    borderRadius: "16px",
                    flex: "0 0 32px",
                    WebkitFlex: "0 0 32px",
                    marginRight: "8px"
                }
            }), a.createElement("div", null, Object(b.getLocale)().planCurrentCovers.replace("$1", t.collaborators), a.createElement("br", null), Object(b.getLocale)().planUsageRequired.replace("$1", t.accountableUserCount))) : a.createElement("div", {
                className: "account-plan"
            }, a.createElement("div", {
                className: "icon-big-white icon-big-close",
                style: {
                    backgroundColor: "#f00",
                    borderRadius: "16px",
                    flex: "0 0 32px",
                    WebkitFlex: "0 0 32px",
                    marginRight: "8px"
                }
            }), a.createElement("div", null, Object(b.getLocale)().planNone))
        }
        class Ao extends a.Component {
            render()
            {
                const e = this.props.account;
                if (e.isOwner() && !this.props.isPrivateCloud) {
                    const t = e.getPlan();
                    return a.createElement(a.Fragment, null, a.createElement("div", {
                        className: "account-head"
                    }, Object(b.getLocale)().currentPlan), a.createElement(Fo, {
                        plan: t
                    }), a.createElement("div", {
                        style: {
                            padding: "0 24px"
                        }
                    }, a.createElement("div", {
                        className: "nx-hspace-flex"
                    }), a.createElement(ee.a, {
                        className: "nx-button-text blue",
                        style: {
                            height: 48,
                            lineHeight: "48px",
                            textAlign: "center"
                        },
                        onFastClick: this.props.upgradePlan
                    }, Object(b.getLocale)().upgradePlan)), a.createElement("div", {
                        style: {
                            height: 1,
                            margin: 24,
                            background: "#EFF1F9"
                        }
                    }))
                }
                return null
            }
        }
        function Ho(e, t) {
            var i = Object.keys(e);
            if (Object.getOwnPropertySymbols) {
                var o = Object.getOwnPropertySymbols(e);
                t && (o = o.filter((function(t) {
                    return Object.getOwnPropertyDescriptor(e, t).enumerable
                }))),
                i.push.apply(i, o)
            }
            return i
        }
        function Po(e) {
            for (var t = 1; t < arguments.length; t++) {
                var i = null != arguments[t] ? arguments[t] : {};
                t % 2 ? Ho(Object(i), !0).forEach((function(t) {
                    K()(e, t, i[t])
                })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(i)) : Ho(Object(i)).forEach((function(t) {
                    Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(i, t))
                }))
            }
            return e
        }
        class Uo extends a.Component {
            constructor(e)
            {
                super(e),
                this.state = {
                    icon: null
                },
                this.updateUserIcon()
            }
            getUserIcon(e)
            {
                if (null === e)
                    return a.createElement("div", {
                        className: "button"
                    }, a.createElement("div", {
                        className: "i-32-24 i-white i-field-user"
                    }));
                {
                    const t = Po({}, this.props.style, {
                        color: "#fff",
                        fontWeight: "bold",
                        textAlign: "center",
                        backgroundPosition: "center",
                        backgroundRepeat: "no-repeat",
                        borderRadius: "50%",
                        WebkitBackgroundSize: this.props.style.backgroundSize,
                        MozBackgroundSize: this.props.style.backgroundSize
                    });
                    if (this.state.icon)
                        return a.createElement("div", {
                            className: "button"
                        }, a.createElement("div", {
                            style: Po({
                                background: `url(${this.state.icon})`
                            }, t)
                        }));
                    {
                        const i = (e.name || "?")[0].toLocaleUpperCase(),
                            o = b.util.pickColor(e.id);
                        return a.createElement("div", {
                            className: "button"
                        }, a.createElement("div", {
                            style: Po({
                                backgroundColor: o
                            }, t)
                        }, i))
                    }
                }
            }
            render()
            {
                return a.createElement(ee.a, {
                    onFastClick: this.props.onClick
                }, this.getUserIcon(this.props.user))
            }
            async updateUserIcon()
            {
                const {user: e} = this.props;
                e && e.photo && this.setState({
                    icon: await window.localFileSystem.cachedURL("https:" + e.photo, null)
                })
            }
        }
        class zo extends a.Component {
            render()
            {
                const e = this.props.account,
                    t = e.getOwnerId(),
                    i = e.getCurrentUserId();
                return a.createElement(a.Fragment, null, a.createElement("div", {
                    className: "account-head",
                    style: {
                        marginTop: "16px"
                    }
                }, Object(b.getLocale)().teamMembers), a.createElement("div", {
                    className: "account-users"
                }, e.getMembers().map(e => a.createElement(ee.a, {
                    key: e.id,
                    onFastClick: () => this.props.onClick(e.id)
                }, a.createElement("div", {
                    className: `account-user ${i === e.id ? " selected" : ""}`
                }, i === e.id ? a.createElement("div", {
                    className: "account-user-selected-indicator"
                }) : null, a.createElement(Uo, {
                    onClick: () => {},
                    user: e,
                    style: {
                        width: "24px",
                        height: "24px",
                        fontSize: "14px",
                        lineHeight: "24px",
                        backgroundSize: "24px 24px",
                        margin: "4px -2px 4px 4px"
                    }
                }), a.createElement("div", {
                    className: "account-user-name"
                }, e.name, " ", e.id === t ? " (Owner)" : e.roles.admin ? " (Admin)" : ""))))))
            }
        }
        class Vo extends a.Component {
            render()
            {
                if (this.props.hideUserList)
                    return null;
                const e = this.props.account;
                return a.createElement("div", {
                    className: "root-remote-info --ul-remote-info"
                }, a.createElement(Ao, {
                    account: e,
                    isPrivateCloud: this.props.isPrivateCloud,
                    upgradePlan: this.props.upgradePlan
                }), a.createElement(zo, {
                    account: e,
                    onClick: this.props.onClickUser
                }), a.createElement(Lo, {
                    account: e,
                    onClick: this.props.onClickInvitation,
                    invite: this.props.invite
                }))
            }
        }
        class Wo extends a.Component {
            render()
            {
                const e = this.props.account,
                    t = e && e.settings && !0 === e.settings.hideUserList && !e.isRootUser();
                return a.createElement(a.Fragment, null, a.createElement(jo, {
                    isAdmin: this.props.isAdmin,
                    localFileSystem: this.props.localFileSystem,
                    NinoxDocumentInteraction: this.props.NinoxDocumentInteraction,
                    account: this.props.account,
                    onDatabaseClick: this.props.onDatabaseClick,
                    onCreateBackup: this.props.onCreateBackup,
                    onRemove: this.props.onRemove,
                    onRenameDatabase: this.props.onRenameDatabase,
                    onResetSync: this.props.onResetSync,
                    onNewDatabaseClick: this.props.onNewDatabaseClick,
                    onImportArchiveClick: this.props.onImportArchiveClick,
                    onManageBackupsClick: this.props.onManageBackupsClick,
                    hideUserList: t
                }), a.createElement(Vo, {
                    account: this.props.account,
                    isPrivateCloud: this.props.isPrivateCloud,
                    onClickInvitation: this.props.onClickInvitation,
                    onClickUser: this.props.onClickUser,
                    upgradePlan: this.props.upgradePlan,
                    invite: this.props.invite,
                    hideUserList: t
                }))
            }
        }
        function Bo(e) {
            const t = e.items.sort((e, t) => t.timestamp - e.timestamp);
            if (0 === t.length)
                return null;
            const i = t[0].dbname;
            return a.createElement("div", null, a.createElement("div", {
                className: "root-backup-item root-backup-group"
            }, a.createElement("div", {
                className: "root-backup-item-label"
            }, i)), t.map(t => a.createElement(ee.a, {
                key: t.id,
                onFastClick: () => e.handleSnapshotClick(t.id),
                className: "root-backup-item root-backup-child" + (e.selectedSnapshotId === t.id ? " selected" : "")
            }, a.createElement("div", {
                className: "root-backup-item-info"
            }, a.createElement("div", null, b.util.formatLocaleDateTime(t.timestamp))))))
        }
        class qo extends a.Component {
            constructor(e)
            {
                super(e),
                K()(this, "handleSnapshotClick", e => {
                    this.setState({
                        selectedSnapshotId: e
                    }),
                    this.props.onSnapshotClick(e)
                }),
                this.state = {
                    selectedSnapshotId: null
                }
            }
            render()
            {
                const e = this.props.snapshots;
                return Object.keys(e).map(t => ({
                    dbid: t,
                    items: e[t]
                })).filter(e => e.items.length > 0).sort((e, t) => String(e.items[0].dbname).localeCompare(String(t.items[0].dbname))).map(e => a.createElement(Bo, {
                    key: e.dbid,
                    dbid: e.dbid,
                    items: e.items,
                    selectedSnapshotId: this.state.selectedSnapshotId,
                    handleSnapshotClick: this.handleSnapshotClick
                }))
            }
        }
        class Yo extends a.Component {
            constructor(e)
            {
                super(e)
            }
            render()
            {
                return a.createElement("div", {
                    className: "nx-button-bar",
                    style: {
                        margin: 0,
                        padding: 24
                    }
                }, a.createElement(ee.a, {
                    onFastClick: this.props.onDeleteClick,
                    className: "nx-button-text grey"
                }, Object(b.getLocale)().remove), a.createElement("div", {
                    className: "nx-hspace-flex"
                }), "backups" === this.props.currentTab ? a.createElement(ee.a, {
                    onFastClick: this.props.onDownloadBackupClick,
                    className: "nx-button-text grey"
                }, Object(b.getLocale)().dumpDatabase) : null, a.createElement("div", {
                    className: "nx-hspace-small"
                }), a.createElement(ee.a, {
                    onFastClick: this.props.onRestoreClick,
                    className: "nx-button-text grey"
                }, Object(b.getLocale)().restoreBackup), a.createElement("div", {
                    className: "nx-hspace-small"
                }), a.createElement(ee.a, {
                    onFastClick: this.props.onCloseClick,
                    className: "nx-button-text blue"
                }, Object(b.getLocale)().close))
            }
        }
        class Xo extends a.Component {
            constructor(e)
            {
                super(e)
            }
            render()
            {
                return this.props.backups.slice().sort((e, t) => t.timestamp - e.timestamp).map(e => a.createElement(ee.a, {
                    key: e.id,
                    onFastClick: () => this.props.onBackupClick(e.id),
                    className: "root-backup-item" + (e.id === this.props.selectedBackupId ? " selected" : "")
                }, a.createElement("div", {
                    className: "root-backup-item-label"
                }, e.dbname), a.createElement("div", {
                    className: "root-backup-item-info"
                }, a.createElement("div", null, b.util.formatLocaleDateTime(e.timestamp)), a.createElement("div", null, e.user ? e.user.name : ""))))
            }
        }
        function Go(e, t) {
            var i = Object.keys(e);
            if (Object.getOwnPropertySymbols) {
                var o = Object.getOwnPropertySymbols(e);
                t && (o = o.filter((function(t) {
                    return Object.getOwnPropertyDescriptor(e, t).enumerable
                }))),
                i.push.apply(i, o)
            }
            return i
        }
        function Jo(e) {
            for (var t = 1; t < arguments.length; t++) {
                var i = null != arguments[t] ? arguments[t] : {};
                t % 2 ? Go(Object(i), !0).forEach((function(t) {
                    K()(e, t, i[t])
                })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(i)) : Go(Object(i)).forEach((function(t) {
                    Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(i, t))
                }))
            }
            return e
        }
        class Ko extends a.Component {
            constructor(e)
            {
                super(e),
                K()(this, "onBackupClicked", e => {
                    this.setState({
                        currBackupId: e
                    })
                }),
                K()(this, "removeBackup", () => {
                    if (null !== this.state.currBackupId)
                        if ("backups" === this.state.currTab && "backups" === this.getCurrentSelectionType())
                            this.props.loading(!0),
                            this.props.account.removeBackup(this.state.currBackupId, e => {
                                if (this.props.loading(!1), e)
                                    return this.props.alert(e);
                                this.reload()
                            });
                        else if ("snapshots" === this.state.currTab && "snapshots" === this.getCurrentSelectionType()) {
                            if (!this.props.isPaidPlan)
                                return this.props.alert("Please upgrade your account to use this feature.");
                            this.props.loading(!0),
                            this.props.account.removeSnapshot(this.state.currBackupId.split("/")[0], parseInt(this.state.currBackupId.split("/")[1], 10), e => {
                                if (this.props.loading(!1), e)
                                    return this.props.alert(e);
                                this.reload()
                            })
                        }
                }),
                K()(this, "restoreBackup", () => {
                    if ("backups" === this.state.currTab && "backups" === this.getCurrentSelectionType()) {
                        if (!this.props.isPaidPlan)
                            return this.props.alert("Please upgrade your account to use this feature.");
                        this.props.loading(!0),
                        this.props.account.restoreBackup(this.state.currBackupId, e => {
                            if (this.props.loading(!1), e)
                                return this.props.alert(e);
                            this.props.closePopup()
                        })
                    } else if ("snapshots" === this.state.currTab && "snapshots" === this.getCurrentSelectionType()) {
                        if (!this.props.isPaidPlan)
                            return this.props.alert("Please upgrade your account to use this feature.");
                        this.props.loading(!0),
                        Object(rt.a)(this.state.currBackupId),
                        this.props.account.restoreSnapshot(this.state.currBackupId.split("/")[0], parseInt(this.state.currBackupId.split("/")[1], 10), e => {
                            if (this.props.loading(!1), e)
                                return this.props.alert(e);
                            this.props.closePopup()
                        })
                    }
                }),
                K()(this, "downloadBackup", () => {
                    if (null === this.state.currBackupId)
                        return;
                    let e = null;
                    for (const t of this.state.manualBackups)
                        if (t.id === this.state.currBackupId) {
                            e = t;
                            break
                        }
                    if (null === e)
                        return;
                    const t = this.props.account.downloadBackupURL(e.id, e.dbname + ".ninox");
                    this.props.ninoxDocumentInteraction.openBrowser(t),
                    this.props.closePopup()
                }),
                this.state = {
                    currBackupId: e.initialSelection,
                    currTab: e.initialTab,
                    manualBackups: [],
                    snapshots: []
                },
                this.reload()
            }
            reload()
            {
                this.props.loading(!0),
                this.props.account.listBackups((e, t) => {
                    this.props.loading(!1),
                    e && this.props.alert(e);
                    let i = [];
                    if (t) {
                        const e = this.props.dbms.getRemoteConnection();
                        i = t.sort((e, t) => t.timstamp - e.timestamp).map(t => Jo({}, t, {
                            user: e.getAccountUser(this.props.account.id, t.user)
                        }))
                    }
                    this.setState({
                        manualBackups: i
                    })
                }),
                this.props.account.listSnapshots((e, t) => {
                    this.props.loading(!1),
                    e && this.props.alert(e);
                    let i = {};
                    if (t) {
                        for (const e in t)
                            t[e] = t[e].map(t => Jo({}, t, {
                                id: e + "/" + t.timestamp
                            }));
                        i = t
                    }
                    this.setState({
                        snapshots: i
                    })
                })
            }
            render()
            {
                return a.createElement("span", null, a.createElement("div", {
                    className: "nx-section-head",
                    style: {
                        borderBottom: "none"
                    }
                }, Object(b.getLocale)().manageBackups), a.createElement($t, {
                    tabs: [{
                        isSelected: "snapshots" === this.state.currTab,
                        text: Object(b.getLocale)().automatedBackups,
                        onClick: () => this.setState({
                            currTab: "snapshots"
                        })
                    }, {
                        isSelected: "backups" === this.state.currTab,
                        text: Object(b.getLocale)().manualBackups,
                        onClick: () => this.setState({
                            currTab: "backups"
                        })
                    }]
                }), a.createElement("div", {
                    className: "root-backup-list",
                    style: {
                        height: window.getHeight() - 288
                    }
                }, "backups" === this.state.currTab ? a.createElement(Xo, {
                    backups: this.state.manualBackups,
                    onBackupClick: this.onBackupClicked,
                    selectedBackupId: this.state.currBackupId
                }) : null, "snapshots" === this.state.currTab ? a.createElement(qo, {
                    snapshots: this.state.snapshots,
                    onSnapshotClick: this.onBackupClicked,
                    selectedSnapshotId: this.state.currBackupId
                }) : null), a.createElement(Yo, {
                    currentTab: this.state.currTab,
                    onDeleteClick: this.removeBackup,
                    onDownloadBackupClick: this.downloadBackup,
                    onRestoreClick: this.restoreBackup,
                    onCloseClick: this.props.closePopup
                }))
            }
            getCurrentSelectionType()
            {
                return null === this.state.currBackupId ? null : -1 === this.state.currBackupId.indexOf("/") ? "backups" : "snapshots"
            }
        }
        o("./src/react/TemplatesList.css");
        class Qo extends a.Component {
            constructor(e)
            {
                super(e)
            }
            render()
            {
                return a.createElement("div", {
                    className: "TemplatesList_root"
                }, a.createElement(ee.a, {
                    behaviour: "FORCE_RIPPLE",
                    onFastClick: () => this.props.onClick(null),
                    className: "TemplatesList_templateContainer"
                }, a.createElement(Io, {
                    db: {
                        isStored: !0,
                        id: "new",
                        type: "IMAGE",
                        icon: "root-db-icon i-db-icon-big i-db i-database",
                        color: "#9da9ce"
                    },
                    onClick: () => this.props.onClick(null),
                    index: -1
                }), a.createElement("div", {
                    className: "TemplatesList_templateCopy"
                }, a.createElement("div", {
                    className: "TemplatesList_templateTitle"
                }, Object(b.getLocale)().new), a.createElement("div", {
                    className: "TemplatesList_templateDesc"
                }, Object(b.getLocale)().noTemplate))), 0 === this.props.templatesList.length ? "Loading..." : this.props.templatesList.map((e, t) => {
                    const i = {
                        color: e.color,
                        icon: e.icon,
                        type: "IMAGE",
                        id: e.id,
                        isStored: !0
                    };
                    return a.createElement(ee.a, {
                        key: t,
                        behaviour: "FORCE_RIPPLE",
                        onFastClick: () => this.props.onClick(e),
                        className: "TemplatesList_templateContainer"
                    }, a.createElement(Io, {
                        db: i,
                        onClick: () => this.props.onClick(e),
                        index: t
                    }), a.createElement("div", {
                        className: "TemplatesList_templateCopy"
                    }, a.createElement("div", {
                        className: "TemplatesList_templateTitle"
                    }, e.title), a.createElement("div", {
                        className: "TemplatesList_templateDesc"
                    }, e.summary)))
                }))
            }
        }
        function Zo(e) {
            Object(l.f)("Templates", "Open");
            var t = $.backplane({
                    close: function() {
                        n.unmountComponentAtNode(r[0]),
                        window.Appcues && window.Appcues.page()
                    },
                    cls: "templates-root"
                }),
                i = $('<div class="nx-popdown-large templates-pane">').appendTo(t);
            const o = $('<div class="nx-section-head templates-head">').appendTo(i);
            $(`<div style="width: 100%">${locale.chooseTemplate}</div>`).appendTo(o),
            $('<div class="i-32-24 i-light-grey i-close" style="position: absolute;right: 24px;">').appendTo(o).touch((function() {
                t.close(),
                e.cancel && e.cancel()
            }));
            var s = $('<div class="nx-section-pane templates-body" style="">').appendTo(i),
                r = $('<div class="templates-list --ul-template-list">').appendTo(s),
                c = [];
            function d() {
                n.render(a.createElement(Qo, {
                    templatesList: c,
                    onClick: i => function(i) {
                        t.close(),
                        Object(l.f)("Templates", "Click", {
                            template: i ? i.title : "empty"
                        }),
                        trackEvent("templates", "click-" + (i ? i.title : "empty")),
                        e.okay && e.okay(i ? {
                            url: i.file,
                            icon: i.icon,
                            color: i.color,
                            name: i.title
                        } : void 0, t)
                    }(i)
                }), r[0])
            }
            function h(e) {
                switch (e) {
                case "5996a84f60418b1043550550":
                case "5995849160418b1043550513":
                    return {
                        icon: "i-db-icon-big i-db i-team",
                        color: "#6691FF"
                    };
                case "5996ada460418b1043550569":
                case "5995881860418b104355051f":
                    return {
                        icon: "i-db-icon-big i-db i-calendar",
                        color: "#9485F2"
                    };
                case "5996aa7b60418b1043550560":
                case "599582f260418b104355050d":
                    return {
                        icon: "i-db-icon-big i-db i-dj",
                        color: "#52C2CC"
                    };
                case "59bfeba6244b0e67ed2585dc":
                case "59bfd6cf244b0e67ed2585d6":
                    return {
                        icon: "i-db-icon-big i-db i-person",
                        color: "#FFB450"
                    };
                case "599c353160418b1043550581":
                case "598b323052ed71082bd69faf":
                    return {
                        icon: "i-db-icon-big i-db i-bill",
                        color: "#FF7F66"
                    };
                case "5996acca60418b1043550564":
                case "5995859560418b1043550517":
                    return {
                        icon: "i-db-icon-big i-db i-pallet",
                        color: "#52C2CC"
                    };
                case "5cc6cd632cc4a577c6ee6e41":
                case "599586d460418b104355051d":
                    return {
                        icon: "i-db-icon-big i-db i-collage",
                        color: "#64C1FA"
                    };
                case "5996a98460418b104355055b":
                case "5995599160418b10435504f8":
                    return {
                        icon: "i-db-icon-big i-db i-timer",
                        color: "#9485F2"
                    };
                case "5996a7d260418b1043550547":
                case "5995641b60418b1043550500":
                    return {
                        icon: "i-db-icon-big i-db i-tree_structure",
                        color: "#52C2CC"
                    };
                case "5996a8ff60418b1043550556":
                case "59955c2560418b10435504fc":
                    return {
                        icon: "i-db-icon-big i-db i-todo_list",
                        color: "#FFB450"
                    };
                case "5996ae3460418b104355056c":
                case "5995896860418b1043550522":
                    return {
                        icon: "i-db-icon-big i-db i-cottage",
                        color: "#64C1FA"
                    };
                case "59a041f0e576076126c2cc0b":
                case "598b30d652ed71082bd69fab":
                    return {
                        icon: "i-db-icon-big i-db i-frame",
                        color: "#FF7F66"
                    };
                case "5996a65260418b1043550543":
                case "599558a860418b10435504f3":
                    return {
                        icon: "i-db-icon-big i-db i-spoon_of_sugar",
                        color: "#6691FF"
                    };
                default:
                    return null
                }
            }
            trackPageView("templates"),
            window.Appcues && window.Appcues.page(),
            async function() {
                var e = await localFileSystem.cachedURL("https://ninox.com/api/templates", 864e5) || "https://ninox.com/api/templates";
                $.get(e, (function(e) {
                    var t = void 0;
                    if ("string" == typeof e)
                        try {
                            t = JSON.parse(e)
                        } catch (e) {
                            console.log(e)
                        }
                    else
                        t = e;
                    if (t && t.length) {
                        var i = T.filter(t, (function(e) {
                            return e.lang == locale.LOCALE
                        }));
                        i.length || (i = T.filter(t, (function(e) {
                            return "en" == e.lang
                        }))),
                        i.sort((function(e, t) {
                            return null != e.position && null != t.position ? e.position !== t.position ? e.position - t.position : e.title.localeCompare(t.title) : null != e.position ? -1 : null != t.position ? 1 : e.title.localeCompare(t.title)
                        }));
                        for (const e of i) {
                            const t = h(e.id);
                            null !== t && (e.icon = t.icon, e.color = t.color)
                        }
                        c = i,
                        d()
                    }
                }))
            }().then(() => d())
        }
        const en = ["#FF7F66", "#FFB450", "#FADA33", "#52CC74", "#64C1FA", "#6691FF", "#9485F2", "#EC87E2"],
            tn = ["database", "person", "team", "location", "info", "document", "framed_chart", "folder", "clipboard", "group", "calendar", "dj", "frame", "bill", "pallet", "collage", "spoon_of_sugar", "todo_list", "tree_structure", "timer", "cottage", "beer", "bulb", "palm", "start", "symbol", "bell", "libra", "trolley", "radar", "chart", "livingcosts", "check", "duedate", "globe"];
        function on(e) {
            this.color = e.color || "#9da9ce",
            this.icon = e.icon || tn[0],
            this.colorIndex = "#CUSTOM",
            this.latestRenderId = 0;
            for (let e = 0; e < en.length; e++)
                en[e] === this.color && (this.colorIndex = e);
            this.$el = $('<div class="dbics --ul-icon-selector">').appendTo(e.$parent),
            this.$button = $('<div class="dbics-button">').appendTo(this.$el).touch($.proxy(this.popup, this)),
            this.updateUI()
        }
        function nn(e) {
            trackPageView("createdb");
            var t = e.account,
                i = $.popdown({
                    close: e.cancel
                });
            const o = $('<div class="nx-section-head">').text(e.title || locale.createDatabase).appendTo(i.$pane);
            $('<div class="i-32-24 i-light-grey i-close" style="position: absolute;right: 24px;top: 18px;">').appendTo(o).touch(b);
            var n = $('<div class="nx-section-pane">').appendTo(i.$pane),
                s = $('<div style="display:flex;display:-webkit-flex">').appendTo(n),
                a = null;
            e.dontShowIconColor || (a = new on({
                $parent: s,
                icon: e.icon || null,
                color: e.color || null
            }));
            var r = $('<div class="component editor editor-string --ul-create-db-popdown-input" style="width:100%">').appendTo(s);
            $("<label>").text(e.label || locale.databaseName).appendTo(r);
            var l,
                c,
                d = $('<input type="text">').val(e.name || "").appendTo($('<div class="stringeditor">').appendTo(r)).keydown((function(e) {
                    13 === e.which && v(),
                    27 === e.which && b()
                })),
                h = NinoxDocumentInteraction.getUserDefault("ui.new-database-location") || "local";
            if (!e.dontShowLocations) {
                var p = $('<div class="nx-switch-big">').appendTo(i.$pane);
                l = $('<div class="nx-switch-big-item-icon-text selected">').append($('<div class="i-32-24 i-light-grey i-local">')).append($("<div>").text(locale.databaseLocationLocal)).appendTo(p).on(TOUCH ? EVENT_touchstart : "mousedown", (function() {
                    return h = "local", g(), !1
                })),
                c = $('<div class="nx-switch-big-item-icon-text">').append($('<div class="i-32-24 i-light-grey i-cloud-okay">')).append($("<div>").text(locale.databaseLocationCloud)).appendTo(p).on(TOUCH ? EVENT_touchstart : "mousedown", (function() {
                    return h = "cloud", g(), !1
                }))
            }
            var u = new util.SimpleModel(new schemas.TBoolean(void 0, void 0, {
                    caption: locale.includeData,
                    required: !0,
                    formWidth: .5
                }), !0),
                f = new util.SimpleModel(new schemas.TBoolean(void 0, void 0, {
                    caption: locale.includeFiles,
                    required: !0,
                    formWidth: .5
                }), !0);
            if (e.includeOptions)
                new Ue.a(void 0, u, n),
                new Ue.a(void 0, f, n);
            var m = $('<div class="nx-button-bar">').appendTo(n);
            function g() {
                e.dontShowLocations || (l.toggleClass("selected", "local" === h), c.toggleClass("selected", "cloud" === h), NinoxDocumentInteraction.setUserDefault("ui.new-database-location", h))
            }
            function v() {
                var o = d.val().trim();
                util.isValidDatabaseName(o) ? t.getDatabaseNames()[o] ? $.alert(locale.duplicateDatabaseName) : i.close((function() {
                    e.okay && e.okay({
                        name: o,
                        location: h,
                        includeData: u.value,
                        includeFiles: f.value,
                        icon: a ? a.icon : void 0,
                        color: a ? a.color : void 0
                    })
                })) : $.alert(locale.invalidDatabaseName)
            }
            function b() {
                i.close(e.cancel)
            }
            $('<div class="nx-hspace-flex">').appendTo(m),
            $('<div class="nx-hspace-small">').appendTo(m),
            $('<div class="nx-button-text blue --ul-create-db-popdown-button">').text(e.button || locale.createDatabaseOkay).appendTo(m).click(v),
            g(),
            setTimeout((function() {
                d.focus()
            }), 400)
        }
        function sn(e, t) {
            var i = t.account,
                o = $.popdown({
                    close: t.cancel
                });
            $('<div class="nx-section-head">').text(locale.renameDatabase).appendTo(o.$pane);
            var n = $('<div class="nx-section-pane">').appendTo(o.$pane),
                s = $('<div style="display:flex;display:-webkit-flex">').appendTo(n),
                a = new on({
                    $parent: s,
                    icon: e.settings && e.settings.icon || e.icon,
                    color: e.settings && e.settings.color || e.color
                }),
                r = $('<div class="component editor editor-string" style="width:100%">').appendTo(s);
            $("<label>").text(locale.databaseName).appendTo(r);
            var l = $('<input type="text">').val(e.name).appendTo($('<div class="stringeditor">').appendTo(r)).keydown((function(e) {
                    13 === e.which && d(),
                    27 === e.which && close()
                })),
                c = $('<div class="nx-button-bar">').appendTo(n);
            function d() {
                var n = l.val().trim();
                if (util.isValidDatabaseName(n)) {
                    if (n !== e.name)
                        if (i.getDatabaseNames()[n])
                            return void $.alert(locale.duplicateDatabaseName);
                    o.close((function() {
                        t.okay && t.okay({
                            name: n,
                            icon: a.icon,
                            color: a.color
                        })
                    }))
                } else
                    $.alert(locale.invalidDatabaseName)
            }
            $('<div class="nx-hspace-flex">').appendTo(c),
            $('<div class="nx-button-text grey">').text(locale.cancel).appendTo(c).click((function() {
                o.close(t.cancel)
            })),
            $('<div class="nx-hspace-small">').appendTo(c),
            $('<div class="nx-button-text blue">').text(locale.renameDatabaseOkay).appendTo(c).click(d),
            setTimeout((function() {
                l.focus()
            }), 400)
        }
        function an(e, t) {
            this.root = e,
            this.accountId = t,
            this.resync = $.proxy(this.resync, this),
            this.resyncInterval = null,
            this.account = dbms.getRemoteAccount(t),
            this.account && this.account.sync()
        }
        function rn(e) {
            this.$user = $('<div id="react-user-icon" class="--ul-user-icon" style="margin-right:8px"/>').appendTo(e),
            this.updateUI()
        }
        function ln(e, t) {
            var i = Object.keys(e);
            if (Object.getOwnPropertySymbols) {
                var o = Object.getOwnPropertySymbols(e);
                t && (o = o.filter((function(t) {
                    return Object.getOwnPropertyDescriptor(e, t).enumerable
                }))),
                i.push.apply(i, o)
            }
            return i
        }
        function cn(e) {
            for (var t = 1; t < arguments.length; t++) {
                var i = null != arguments[t] ? arguments[t] : {};
                t % 2 ? ln(Object(i), !0).forEach((function(t) {
                    K()(e, t, i[t])
                })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(i)) : ln(Object(i)).forEach((function(t) {
                    Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(i, t))
                }))
            }
            return e
        }
        on.prototype.updateUI = async function() {
            this.latestRenderId++;
            const e = this.latestRenderId;
            var t = this.icon,
                i = !1,
                o = null;
            t && (/^\/\//.test(t) && (t = "https:" + t), /^\https?\:\/\//.test(t) && (i = !0, o = await localFileSystem.cachedURL(t, null) || t)),
            e === this.latestRenderId && (this.$button[0].style.backgroundColor = this.color, i ? this.$button.html('<img src="' + o + '" style="width:40px;height:40px;padding:4px">') : this.$button.html('<div class="i-db-icon-big i-db i-' + t + '" style="position: relative"><div class="i-32-24 i-light-grey i-line-down" style="position: absolute; right: 0;"></div>'))
        },
        on.prototype.popup = function() {
            var e = this,
                t = $.backplane({}),
                i = $('<div class="nx-menu-popup dbics-menu --ul-icon-selector-popup">').appendTo(t),
                o = $('<div class="dbics-colors">').appendTo(i).touch((function(t) {
                    var i = $(t.target).closest(".dbics-color").attr("data-color-index");
                    console.log("colorClicked", i),
                    i && ("#CUSTOM" === i ? new Gt.a({
                        $el: $(t.target),
                        update: function(t) {
                            e.color = t,
                            e.colorIndex = "#CUSTOM",
                            r()
                        }
                    }) : (e.colorIndex = i, e.color = en[i], r()))
                })),
                n = $('<div class="dbics-icons">').appendTo(i).touch((function(t) {
                    var i = $(t.target).closest(".i-db").attr("data-icon");
                    console.log("iconClicked", i),
                    i && (e.icon = i, r())
                }));
            r();
            i.outerWidth();
            var s = i.outerHeight(),
                a = this.$el.offset();
            function r() {
                !function() {
                    for (var t = "", i = 0; i < en.length; i++) {
                        t += `\n            <div class="dbics-color" style="background-color:${en[i]}" data-color-index="${i}">\n                ${parseInt(e.colorIndex, 10) === i ? '<div class="dbics-color-selected"></div>' : ""}\n            </div>`
                    }
                    t += '<div class="dbics-color dbics-color-more i-32-24 i-light-grey i-line-down" data-color-index="#CUSTOM"></div>',
                    o.html(t)
                }(),
                function() {
                    for (var t = "", i = 0; i < tn.length; i++) {
                        var o = tn[i];
                        t += '<div class="i-db-icon-small i-db i-' + o + '" data-icon="' + o + '"></div></div>'
                    }
                    n.html(t),
                    n[0].style.backgroundColor = e.color
                }(),
                e.updateUI()
            }
            a.top += 90,
            a.top + s > window.getHeight() && (a.top = window.getHeight() - s),
            i.offset(a)
        },
        an.prototype.destroy = function() {
            this.hide()
        },
        an.prototype.show = function() {
            if (!this.visible) {
                this.visible = !0;
                this.account && this.account.sync(),
                this.updateUI(),
                this.resyncInterval = setInterval(this.resync, 1e4),
                this.account && this.account.on("change", this.updateUI, this)
            }
        },
        an.prototype.hide = function() {
            this.visible && (this.visible = !1, this.account && this.account.off("change", this.updateUI, this), this.resyncInterval && (clearInterval(this.resyncInterval), this.resyncInterval = null), n.unmountComponentAtNode(this.root.$body[0]))
        },
        an.prototype.resync = function() {
            this.account && this.account.sync()
        },
        an.prototype.updateUI = function() {
            this.visible && n.render(a.createElement(Wo, {
                isAdmin: this.isAdmin(),
                localFileSystem: localFileSystem,
                NinoxDocumentInteraction: NinoxDocumentInteraction,
                account: this.account,
                onDatabaseClick: e => this.callWithDb(e, e => this.openDatabase(e)),
                onResetSync: e => this.account.resetSync(e),
                onCreateBackup: e => this.callWithDb(e, e => this.createBackup(e)),
                onRemove: e => this.callWithDb(e, e => this.removeDialog(e)),
                onRenameDatabase: e => this.callWithDb(e, e => this.renameDatabase(e)),
                onNewDatabaseClick: () => this.createDatabase(),
                onImportArchiveClick: () => this.importArchive(),
                onManageBackupsClick: () => this.manageBackups(),
                isPrivateCloud: Object(c.f)(),
                onClickInvitation: e => this.popupAccountInvitation(e),
                onClickUser: e => this.popupAccountUser(e),
                upgradePlan: () => this.root.upgradePlan(),
                invite: () => this.inviteDialog()
            }), this.root.$body[0])
        },
        an.prototype.removeDialog = function(e) {
            Object(l.f)("DatabaseMenu", "Remove"),
            $.dialog({
                closable: !0,
                caption: locale.dropDatabase,
                message: locale.confirmDropDatabase,
                buttons: [{
                    color: "red",
                    caption: locale.dropDatabase,
                    callback: () => {
                        Object(l.f)("DatabaseMenu", "RemoveConfirm"),
                        this.account.removeDatabase(e, (function(e) {
                            e && $.alert(e)
                        }))
                    }
                }]
            })
        },
        an.prototype.callWithDb = function(e, t) {
            if (this.account) {
                var i = this.account.getDatabase(e);
                i && t(i)
            }
        },
        an.prototype.openDatabase = function(e, t) {
            Object(l.f)("Database", "Open");
            this.account ? ve({
                teamId: this.accountId,
                dbId: e.id
            }) : t && t("Account not found")
        },
        an.prototype.createDatabase = function(e) {
            Object(l.f)("CreateDatabase", "Open");
            var t = this.account;
            new Zo({
                cancel: function() {
                    Object(l.f)("CreateDatabase", "Cancel")
                },
                okay: function(e, i) {
                    new nn({
                        account: t,
                        name: (e = e || {}).name,
                        color: e.color,
                        icon: e.icon,
                        includeOptions: !1,
                        dontShowLocations: !0,
                        okay: function(o) {
                            Object(l.f)("CreateDatabase", "Confirm", {
                                template: e.name || "empty"
                            }),
                            o.name && (i.close(), e.url ? ($.loading(!0), t.loadArchive({
                                url: e.url,
                                name: o.name,
                                icon: o.icon,
                                color: o.color
                            }, (function(e) {
                                $.loading(!1),
                                e && $.alert(e)
                            }))) : ($.loading(!0), t.createDatabase(o, (function(e) {
                                $.loading(!1),
                                e && $.alert(e)
                            }))))
                        }
                    })
                }
            })
        },
        an.prototype.renameDatabase = function(e, t) {
            Object(l.f)("RenameDatabase", "Open");
            var i = this.account;
            if (!i)
                return t("Account not found.");
            new sn({
                name: e.name,
                icon: e.settings && e.settings.icon,
                color: e.settings && e.settings.color
            }, {
                account: i,
                okay: function(o) {
                    Object(l.f)("RenameDatabase", "Confirm"),
                    $.loading(!0),
                    i.renameDatabase(e, o, (function(e, i) {
                        $.loading(!1),
                        e && $.alert(e),
                        t && t(e, i)
                    }))
                },
                cancel: function() {
                    Object(l.f)("RenameDatabase", "Cancel"),
                    t && t()
                }
            })
        },
        an.prototype.isAdmin = function() {
            return !!this.account && this.account.isAdmin()
        },
        an.prototype.isRootUser = function() {
            return dbms.getRemoteConnection().getSessionInfo().user.isRoot
        },
        an.prototype.isOwner = function() {
            var e = dbms.getRemoteConnection();
            return e.getAccount(this.accountId).owner === e.getUserId()
        },
        an.prototype.popupOptions = function(e) {
            this.isOwner() || this.isRootUser() ? this.popupOptions_Owner(e) : this.popupOptions_User(e)
        },
        an.prototype.popupOptions_Owner = function() {
            Object(l.f)("TeamSettings", "Open", {
                isOwner: !0
            });
            var e = this,
                t = dbms.getRemoteConnection(),
                i = this.account;
            if (i) {
                var o = $.popdown({
                        head: locale.teamSettings,
                        buttons: [{
                            caption: locale.removeTeam,
                            click: function() {
                                if (!t.canRemoveAccount(i.id))
                                    return $.alert(locale.cannotRemoveTeam);
                                Object(l.f)("RemoveTeam", "Open"),
                                $.dialog({
                                    closable: !0,
                                    caption: locale.removeTeam + ": " + i.name,
                                    message: locale.removeTeamConfirm,
                                    buttons: [{
                                        color: "red",
                                        caption: locale.removeTeam,
                                        callback: function() {
                                            Object(l.f)("RemoveTeam", "Confirm"),
                                            o.close(),
                                            t.removeAccount(i.id, (function(e) {
                                                e && $.alert(e)
                                            }))
                                        }
                                    }]
                                })
                            }
                        }, "-", {
                            cls: "blue",
                            caption: locale.okay,
                            click: function() {
                                var e = n.val();
                                if (e != i.name) {
                                    if (Object(l.f)("RemoveSettings", "UpdateName"), !util.isValidDatabaseName(e))
                                        return $.alert(locale.invalidTeamName);
                                    $.loading(!0),
                                    t.updateAccount({
                                        id: i.id,
                                        name: e
                                    }, (function(e) {
                                        if (Object(l.f)("RemoveSettings", "Close"), $.loading(!1), e)
                                            return $.alert(e);
                                        o.close()
                                    }))
                                } else
                                    Object(l.f)("RemoveSettings", "Close"),
                                    o.close()
                            }
                        }]
                    }),
                    n = $.input({
                        caption: locale.teamName,
                        val: i.name,
                        $container: o.$content
                    });
                new ut({
                    $container: o.$content,
                    settings: i.settings || {},
                    updateSettings: function(t, i) {
                        Object(l.f)("TeamSettings", "Update"),
                        $.loading(!0),
                        e.account.server.updateSettings(t, (function(t, o) {
                            $.loading(!1),
                            t || (e.account.settings = o, e.account.sync(!0)),
                            i(t)
                        }))
                    },
                    setBackground: function(t, i) {
                        $.loading(!0),
                        Object(l.f)("TeamSettings", "UpdateBackground"),
                        e.account.server.updateSettings({
                            bgType: "presets",
                            backgroundClass: t
                        }, (function(t, o) {
                            $.loading(!1),
                            t || (e.account.settings = o, e.account.sync(!0)),
                            i(t)
                        }))
                    },
                    setBackgroundFile: function(t, i) {
                        Object(l.f)("TeamSettings", "UploadBackground"),
                        e.account.server.uploadBackground({
                            file: t
                        }, (function(t) {
                            e.account.sync(!0),
                            i(t)
                        }))
                    }
                })
            }
        },
        an.prototype.popupOptions_User = function() {
            if (!Object(c.f)()) {
                Object(l.f)("TeamSettings", "Open", {
                    isOwner: !1
                });
                var e = this.account;
                if (e) {
                    var t = $.popdown({
                        head: locale.teamName,
                        buttons: [{
                            caption: locale.leaveThisTeam,
                            click: function() {
                                Object(l.f)("LeaveTeam", "Open");
                                var i = dbms.getRemoteConnection(),
                                    o = i.getCurrentUser().id;
                                if (!i.hasOtherAdmins(e.id, o))
                                    return $.alert(locale.oneAdminRequired);
                                $.dialog({
                                    closable: !0,
                                    caption: locale.leaveTeam + ": " + e.name,
                                    message: locale.leaveTeamConfirm,
                                    buttons: [{
                                        color: "red",
                                        caption: locale.leaveTeam,
                                        callback: function() {
                                            Object(l.f)("LeaveTeam", "Confirm"),
                                            t.close(),
                                            dbms.getRemoteConnection().removeAccountUser(e.id, o, (function(e) {
                                                e && $.alert(e)
                                            }))
                                        }
                                    }]
                                })
                            }
                        }, "-", {
                            cls: "blue",
                            caption: locale.okay,
                            click: function() {
                                Object(l.f)("TeamSettings", "Close"),
                                t.close()
                            }
                        }]
                    });
                    $.field({
                        caption: "Team Name",
                        val: e.name,
                        $container: t.$content
                    })
                }
            }
        },
        an.prototype.importDatabase = function(e) {
            return this.isAdmin() ? NinoxDocumentInteraction.isOnline() ? void 0 : $.alert(locale.notConnected) : $.alert(locale.errorNotAuthorized)
        },
        an.prototype.importArchive = function() {
            if (!this.isAdmin())
                return $.alert(locale.errorNotAuthorized);
            Object(l.f)("ImportArchive", "Open");
            var e = this,
                t = $.popdown({
                    cls: "small",
                    head: locale.importDatabase,
                    buttons: ["-", "cancel", " ", {
                        cls: "blue",
                        caption: locale.importDatabase,
                        click: function() {
                            if (!n[0].files[0])
                                return $.alert("Please select a file for upload.");
                            Object(l.f)("ImportArchive", "Upload"),
                            $.loading(!0);
                            var o = {
                                name: i.val(),
                                file: n[0].files[0]
                            };
                            e.account.server.uploadArchive(o, (function(i, o) {
                                if (Object(l.f)("ImportArchive", "Confirm"), $.loading(!1), t.close(), i)
                                    return $.alert(i);
                                e.account.sync()
                            }))
                        }
                    }]
                }),
                i = $.input({
                    caption: locale.createDatabaseName,
                    $container: t.$content
                }),
                o = $('<div class="component editor editor-string editor-4col">').appendTo(t.$content);
            $("<label>").text(locale.importChooseFile).appendTo(o);
            var n = $('<input name="file" type="file" accept=".ninox" style="width:100%">').appendTo(o)
        },
        an.prototype.popupAccountUser = function(e) {
            Object(l.f)("TeamMember", "Open");
            var t = dbms.getRemoteConnection(),
                i = t.getAccount(this.accountId),
                o = this.isAdmin(),
                n = this;
            if (e) {
                var s = t.getAccountUser(this.accountId, e);
                if (s) {
                    var a = s.id === i.owner,
                        r = [];
                    o && !a && r.push({
                        caption: locale.removeFromTeam,
                        click: function() {
                            if (Object(l.f)("TeamMember", "Remove"), a)
                                return $.alert("Cannot remove the team's owner");
                            if (!t.hasOtherAdmins(n.accountId, s.id))
                                return $.alert(locale.oneAdminRequired);
                            $.dialog({
                                closable: !0,
                                caption: locale.removeFromTeamHead,
                                message: locale.removeFromTeamConfirm,
                                buttons: [{
                                    color: "red",
                                    caption: locale.removeFromTeamOkay,
                                    callback: function() {
                                        Object(l.f)("TeamMember", "RemoveConfirm"),
                                        d.close(),
                                        $.loading(!0),
                                        t.removeAccountUser(n.accountId, s.id, (function(e) {
                                            if ($.loading(!1), e)
                                                return $.alert(e)
                                        }))
                                    }
                                }]
                            })
                        }
                    }),
                    r.push("-"),
                    r.push("cancel"),
                    r.push(" "),
                    o && r.push({
                        cls: "blue",
                        caption: locale.okay,
                        click: function() {
                            if (d.close(), a)
                                return;
                            var e = T.keys(s.roles),
                                i = T.keys(c.value || {});
                            if (-1 === i.indexOf("admin") && !t.hasOtherAdmins(n.accountId, s.id))
                                return $.alert(locale.oneAdminRequired);
                            util.equals(e, i) ? Object(l.f)("TeamMember", "Close") : (Object(l.f)("TeamMember", "UpdateRoles"), $.loading(!0), t.updateAccountUser(n.accountId, {
                                id: s.id,
                                roles: i
                            }, (function(e) {
                                if ($.loading(!1), Object(l.f)("TeamMember", "Close"), e)
                                    return $.alert(e)
                            })))
                        }
                    });
                    var c,
                        d = $.popdown({
                            head: locale.teamMember,
                            buttons: r
                        });
                    $.field({
                        caption: locale.name,
                        val: s.name,
                        $container: d.$content
                    }),
                    $.field({
                        caption: locale.email,
                        val: s.email,
                        $container: d.$content
                    }),
                    o && !a && (c = this.createRoleModel(s.roles), new Ue.a({
                        el: d.$content
                    }, c))
                }
            }
        },
        an.prototype.popupAccountInvitation = function(e) {
            Object(l.f)("Invitation", "Open");
            var t = dbms.getRemoteConnection();
            if (this.isAdmin()) {
                var i = this;
                if (e) {
                    var o = t.getInvitation(i.accountId, e);
                    if (o) {
                        var n = $.popdown({
                            head: locale.invitation,
                            buttons: [{
                                caption: locale.cancelInvitation,
                                click: function() {
                                    $.dialog({
                                        closable: !0,
                                        caption: locale.cancelInvitation,
                                        message: locale.cancelInvitationConfirm,
                                        buttons: [{
                                            color: "red",
                                            caption: locale.cancelInvitation,
                                            callback: function() {
                                                Object(l.f)("Invitation", "Remove"),
                                                n.close(),
                                                $.loading(!0),
                                                t.cancelInvitation(i.accountId, o.inviteCode, (function(e) {
                                                    if ($.loading(!1), e)
                                                        return $.alert(e)
                                                }))
                                            }
                                        }]
                                    })
                                }
                            }, " ", {
                                caption: locale.resendInvitation,
                                click: function() {
                                    n.close(),
                                    $.loading(!0),
                                    t.resendInvitation(i.accountId, o.inviteCode, (function(e) {
                                        if (Object(l.f)("Invitation", "Resend"), $.loading(!1), e)
                                            return $.alert(e)
                                    }))
                                }
                            }, "-", {
                                cls: "blue",
                                caption: locale.okay,
                                click: function() {
                                    Object(l.f)("Invitation", "Close"),
                                    n.close()
                                }
                            }]
                        });
                        $.field({
                            caption: locale.email,
                            val: o.email,
                            $container: n.$content
                        }),
                        $.field({
                            caption: locale.roles,
                            val: T.keys(o.roles).sort().join(", "),
                            $container: n.$content
                        }),
                        $.field({
                            caption: locale.invitedFrom,
                            val: o.user ? o.user.name : locale.unknown,
                            $container: n.$content,
                            width: "50%"
                        }),
                        $.field({
                            caption: locale.invitedAt,
                            val: util.formatLocaleDateTime(o.createdAt),
                            $container: n.$content,
                            width: "50%"
                        })
                    }
                }
            }
        },
        an.prototype.createRoleModel = function(e) {
            var t = this,
                i = {
                    base: "extchoice",
                    required: !0,
                    stringAutocorrect: !1,
                    width: 4,
                    formWidth: 1,
                    caption: locale.roles,
                    getEditorClass: function() {
                        return "extchoice"
                    },
                    getValues: function() {
                        return dbms.getRemoteConnection().getSessionInfo().getRoles(t.accountId)
                    },
                    createValue: function(e, i) {
                        Object(l.f)("Role", "Create");
                        var o = {
                            id: e,
                            caption: e
                        };
                        dbms.getRemoteConnection().getSessionInfo().addRole(t.accountId, o),
                        i(void 0, o)
                    },
                    validate: function(e) {},
                    format: function(e) {
                        return e || ""
                    },
                    formatEditor: function(e) {
                        return e || ""
                    },
                    parseEditor: function(e) {
                        if ("string" == typeof e && (e = e.toLocaleLowerCase().trim()))
                            for (var i = util.localeSortBy(dbms.getRemoteConnection().getSessionInfo().getRoles(t.accountId), "caption"), o = 0; o < i.length; o++) {
                                var n = i[o];
                                if (n.caption && 0 === n.caption.toLocaleLowerCase().indexOf(e))
                                    return n.id
                            }
                    },
                    convert: function(e) {
                        return e
                    }
                };
            return new util.SimpleModel(i, e || {
                editor: !0
            })
        },
        an.prototype.emailNotVerified = function() {
            Object(l.f)("VerifyEmail", "Show");
            var e = $.popdown({
                cls: "small",
                head: locale.confirmEmail,
                buttons: ["cancel", "-", {
                    caption: locale.resendVerificationMail,
                    cls: "blue",
                    click: function() {
                        Object(l.f)("VerifyEmail", "Resend"),
                        e.close(),
                        dbms.getRemoteConnection().resendVerificationMail({}, (function(e) {
                            if (e)
                                return $.alert(e)
                        }))
                    }
                }]
            })
        },
        an.prototype.inviteDialog = function() {
            var e = dbms.getRemoteConnection();
            if (this.isAdmin()) {
                if (!e.canInvite(this.accountId))
                    return this.emailNotVerified();
                if (e.getAccount(this.accountId)) {
                    Object(l.f)("Invite", "Open");
                    var t = this,
                        i = $.popdown({
                            cls: "small",
                            head: locale.inviteHead,
                            buttons: ["cancel", "-", {
                                caption: locale.sendInvitation,
                                cls: "blue",
                                click: function() {
                                    var s = o.val().trim().toLocaleLowerCase();
                                    if (!util.isValidEmail(s))
                                        return $.alert(locale.emailMissing);
                                    Object(l.f)("Invite", "Send"),
                                    $.loading(!0),
                                    e.invite({
                                        accountId: t.accountId,
                                        email: s,
                                        roles: Object.keys(n.value)
                                    }, (function(e) {
                                        if ($.loading(!1), i.close(), Object(l.f)("Invite", e ? "Error" : "Success"), e)
                                            return $.alert(e)
                                    }))
                                }
                            }]
                        }),
                        o = $.input({
                            caption: locale.email,
                            type: "email",
                            $container: i.$content,
                            focus: !0
                        }),
                        n = this.createRoleModel();
                    new Ue.a({
                        el: i.$content
                    }, n)
                }
            }
        },
        an.prototype.removeDatabase = function(e, t) {
            if (!this.isAdmin())
                return $.alert(locale.errorNotAuthorized);
            Object(l.f)("Database", "Remove"),
            this.account.removeDatabase(e, t)
        },
        an.prototype.saveDatabaseArchiveAs = function(e, t) {
            Object(l.f)("Database", "Export"),
            this.saveDatabaseArchiveAsFile(e)
        },
        an.prototype.saveDatabaseArchiveAsFile = function(e) {
            var t = this;
            NinoxDocumentInteraction.saveFile(e.name, "ninox", (function(i, o) {
                if (i)
                    return $.alert(i);
                o && ($.loading(!0), t.saveDatabaseArchiveToURL(e, o, (function(e) {
                    $.loading(!1),
                    e && $.alert(e)
                })))
            }))
        },
        an.prototype.saveDatabaseArchiveAsMenu = function(e, t) {
            var i = this,
                o = ($(t.target), $('<div class="nx-backplane nx-backplane-dark">').touch((function(e) {
                    $(e.target).is(".nx-backplane") && h()
                }))),
                n = $('<div class="nx-menu-popup grey">').appendTo(o);
            $('<div class="nx-menu-head">').text(locale.saveArchiveAs).appendTo(n),
            $('<div class="nx-menu-item">').append($('<div class="nx-menu-label">').text(locale.openIn + "...")).appendTo(n).touch((function() {
                h(),
                i.saveDatabaseArchiveShare(e, t)
            })),
            $('<div class="nx-menu-item">').append($('<div class="nx-menu-label">').text(locale.storeOnICloudDrive)).appendTo(n).touch((function() {
                h(),
                i.saveDatabaseArchiveICloud(e, t)
            })),
            o.appendTo($(document.body));
            var s = window.getWidth(),
                a = window.getHeight(),
                r = n.outerWidth(),
                l = n.outerHeight(),
                c = t.touches && t.touches[0] && t.touches[0].clientX || t.clientX || 0,
                d = t.touches && t.touches[0] && t.touches[0].clientY || t.clientY || 0;
            return c + r > s && (c = s - r), d + l > a && (d = a - l), n.offset({
                left: c,
                top: d
            }), !1;
            function h() {
                o.remove()
            }
        },
        an.prototype.saveDatabaseArchiveICloud = async function(e, t) {
            var i = await localFileSystem.tempURL(e.name + ".ninox");
            $.loading(!0),
            this.saveDatabaseArchiveToURL(e, i, (function(e) {
                if ($.loading(!1), e)
                    return $.alert(e);
                NinoxDocumentInteraction.saveFileOnICloud(i, (function(e) {
                    e && $.alert(e),
                    localFileSystem.removeURL(i).catch(e => console.log(e))
                }))
            }))
        },
        an.prototype.saveDatabaseArchiveShare = async function(e, t) {
            var i = await localFileSystem.tempURL(e.name + ".ninox");
            $.loading(!0),
            this.saveDatabaseArchiveToURL(e, i, (function(e) {
                if ($.loading(!1), e)
                    return $.alert(e);
                NinoxDocumentInteraction.showFileOptions(i, t.clientX || 0, t.clientY || 0, (function() {
                    localFileSystem.removeURL(i).catch(e => console.log(e))
                }))
            }))
        },
        an.prototype.saveDatabaseArchiveToURL = function(e, t, i) {
            this.account;
            i("NOT IMPLEMENTED")
        },
        an.prototype.createBackup = function(e) {
            const t = this,
                i = $.popdown({
                    cls: "small",
                    head: locale.createBackup + ": " + e.name,
                    buttons: ["cancel", "-", {
                        caption: locale.okay,
                        cls: "blue",
                        click: function() {
                            const c = {
                                dbid: e.id,
                                data: o.value,
                                files: n.value,
                                comments: s.value,
                                history: a.value,
                                messages: !1,
                                maxAge: r && r.value ? l.value : void 0
                            };
                            $.loading(!0),
                            t.account.createBackup(c, (function(e, o) {
                                if ($.loading(!1), e)
                                    return $.alert(e);
                                i.close(),
                                t.manageBackups("backups", o.id)
                            }))
                        }
                    }]
                }),
                o = new util.SimpleModel(new schemas.TBoolean(void 0, void 0, {
                    caption: "Include data",
                    booleanRenderer: "check",
                    formWidth: 4
                }), !0);
            new Ue.a(void 0, o, i.$content);
            const n = new util.SimpleModel(new schemas.TBoolean(void 0, void 0, {
                caption: "Include files",
                booleanRenderer: "check",
                formWidth: 4
            }), !0);
            new Ue.a(void 0, n, i.$content);
            const s = new util.SimpleModel(new schemas.TBoolean(void 0, void 0, {
                caption: "Include comments",
                booleanRenderer: "check",
                formWidth: 4
            }), !0);
            new Ue.a(void 0, s, i.$content);
            const a = new util.SimpleModel(new schemas.TBoolean(void 0, void 0, {
                caption: "Include history",
                booleanRenderer: "check",
                formWidth: 4
            }), !1);
            new Ue.a(void 0, a, i.$content);
            let r = void 0,
                l = void 0;
            if (window.NINOX_BETA) {
                r = new util.SimpleModel(new schemas.TBoolean(void 0, void 0, {
                    caption: "Beta: Create historic backup",
                    booleanRenderer: "check",
                    formWidth: 4
                }), !1),
                new Ue.a(void 0, r, i.$content);
                const e = $('<div style="display:none">').appendTo(i.$content);
                $('<div class="component text">Try to restore a historic version of this database from the database change history. This will only succeed, if the history has not been cleared out. In case this database has been transferred from another Ninox team, this option will only work, if the history has been included in backups and restores.</div>').appendTo(e),
                l = new util.SimpleModel(new schemas.TTimestamp(void 0, void 0, {
                    caption: "Date and time of database",
                    booleanRenderer: "check",
                    formWidth: 4
                }), Date.now()),
                new Ue.a(void 0, l, e),
                r.on("update", () => {
                    e.css("display", r.value ? "" : "none")
                })
            }
        },
        an.prototype.isPaidPlan = function() {
            if (Object(c.f)())
                return !0;
            var e = dbms.getRemoteConnection().getSessionInfo().getPlan();
            return e && "basic" === e.name || !1
        },
        an.prototype.manageBackups = function(e, t) {
            Object(l.f)("Backups", "Open");
            const i = $.popdown({
                close: function() {
                    console.log("Unmount Backups?", n.unmountComponentAtNode(i.$pane[0]))
                }
            });
            n.render(a.createElement(Ko, {
                initialTab: e || "snapshots",
                initialSelection: t || null,
                account: this.account,
                dbms: dbms,
                ninoxDocumentInteraction: NinoxDocumentInteraction,
                isPaidPlan: this.isPaidPlan(),
                alert: $.alert,
                loading: $.loading,
                closePopup: () => i.close()
            }), i.$pane[0])
        },
        rn.prototype.destroy = function() {
            n.unmountComponentAtNode(this.$user[0]),
            this.$user.remove(),
            this.$user = void 0
        },
        rn.prototype.updateUI = function() {
            var e = null;
            if (this.$user) {
                var t = dbms.getRemoteConnection();
                t.isLoggedIn() && (e = t.getCurrentUser())
            }
            n.render(a.createElement(Uo, {
                onClick: () => this.popup(),
                user: e || null,
                style: {
                    width: "28px",
                    height: "28px",
                    fontSize: "18px",
                    lineHeight: "28px",
                    backgroundSize: "28px 28px",
                    margin: e ? "2px" : void 0
                }
            }), this.$user[0])
        },
        rn.prototype.popup = function(e) {
            var t = this,
                i = dbms.getRemoteConnection();
            if (!i.isLoggedIn())
                return root.ninoxCloudSignup();
            var o = [];
            o.push({
                caption: locale.logout,
                click: function() {
                    n.close(),
                    root.ninoxCloudLogout()
                }
            }),
            o.push("-"),
            Object(c.f)() || (o.push({
                caption: locale.upgradePlan,
                click: function() {
                    n.close(),
                    root.upgradePlan()
                }
            }), o.push(" ")),
            o.push("cancel"),
            o.push(" "),
            o.push({
                cls: "blue",
                caption: locale.okay,
                click: function() {
                    n.close();
                    var e = r.val();
                    e != s.displayName && ($.loading(!0), i.updateUserProfile({
                        displayName: e
                    }, (function(e) {
                        $.loading(!1),
                        e && $.alert(e),
                        t.updateUI()
                    })))
                }
            });
            var n = $.popdown({
                    head: locale.yourAccount,
                    buttons: o
                }),
                s = i.getCurrentUser(),
                a = $('<div style="display:flex;display:-webkit-flex">').appendTo(n.$content),
                r = $.input({
                    caption: locale.name,
                    val: s.displayName || "",
                    $container: a
                });
            Object(c.f)() || ($('<div class="nx-hspace-small">').appendTo(a), $('<div class="nx-button-text grey">').text(locale.profileImage).appendTo($('<div style="width:160px;margin-right:8px;margin-top:27px">').appendTo(a)).on("click", (function(e) {
                $.chooseFile(e, (function(e, o) {
                    o && i.uploadProfileImage({
                        file: o
                    }, (function(e) {
                        e && $.alert(e),
                        setTimeout((function() {
                            t.updateUI()
                        }), 2e3)
                    }))
                }))
            }))),
            $.field({
                caption: locale.email,
                val: s.email,
                type: "email",
                $container: n.$content
            }),
            Object(c.g)() || $('<div style="padding:8px 12px 0 12px;color:#3059f0;font-weight:600;cursor:default">' + htmlEscape(locale.changePassword) + "</div>").appendTo(n.$content).touch((function() {
                var e = $.popdown({
                        cls: "small",
                        head: locale.changePassword,
                        closable: !0,
                        buttons: [{
                            caption: locale.cancel,
                            click: function() {
                                e.close()
                            }
                        }, "-", {
                            caption: locale.okay,
                            click: n,
                            cls: "blue"
                        }]
                    }),
                    t = $.input({
                        type: "password",
                        caption: locale.oldPassword,
                        $container: e.$content,
                        focus: !0,
                        enter: function() {
                            i.focus()
                        }
                    }),
                    i = $.input({
                        type: "password",
                        caption: locale.newPassword,
                        $container: e.$content,
                        enter: function() {
                            o.focus()
                        }
                    }),
                    o = $.input({
                        type: "password",
                        caption: locale.repeatPassword,
                        $container: e.$content,
                        enter: n
                    });
                function n() {
                    var n = t.val(),
                        s = i.val(),
                        a = o.val();
                    return util.isValidPassword(n) && util.isValidPassword(s) ? s !== a ? $.alert(locale.passwordMismatch) : void dbms.getRemoteConnection().changePassword({
                        oldPassword: n,
                        newPassword: s
                    }, (function(t) {
                        t ? $.alert(t) : e.close()
                    })) : $.alert(locale.invalidPassword)
                }
            }))
        };
        class dn {
            constructor()
            {
                K()(this, "accountId", void 0),
                K()(this, "visible", void 0),
                K()(this, "accountView", void 0),
                K()(this, "refreshRemoteConnection", void 0),
                K()(this, "refreshRemoteConnectionInterval", void 0),
                K()(this, "$el", void 0),
                K()(this, "$controls", void 0),
                K()(this, "$accountTabs", void 0),
                K()(this, "$controlsButtons", void 0),
                K()(this, "$body", void 0),
                K()(this, "$admin", void 0),
                K()(this, "$header", void 0),
                K()(this, "user", void 0),
                K()(this, "$verificationContainer", void 0),
                this.accountId = null,
                this.visible = !1,
                this.accountView = null,
                this.refreshRemoteConnection = () => {
                    NinoxDocumentInteraction.isOnline() && dbms.getRemoteConnection().refresh()
                },
                this.refreshRemoteConnectionInterval = null,
                this.show(),
                this.processSAMLToken(() => {
                    dbms.getRemoteConnection().isLoggedIn() ? this.afterLogin() : this.ninoxCloudSignup()
                })
            }
            afterLogin()
            {
                const e = this.ensureAccount();
                if (e) {
                    this.selectAccount(e.id);
                    const t = le;
                    t ? this.cbTemplate(t) : void 0 !== xe().dbId ? this.cbDatabase() : dbms.on("change", this.dbmsChanged, this)
                }
                const t = dbms.getRemoteConnection(),
                    i = t.getCurrentUser(),
                    o = new Date(i.createdAt);
                if (!i.verified && o.getTime() > 1611676659229) {
                    if (NinoxDocumentInteraction.getUserDefault("nx.session.logout.user") === i.email)
                        return this.ninoxCloudLogout();
                    NinoxDocumentInteraction.setUserDefault("nx.session.logout.user", i.email);
                    let e = $(".credentials-verify");
                    0 === e.length && (e = $('<div class="credentials-verify">').appendTo(document.body));
                    const o = NinoxDocumentInteraction.getUserDefault("nx.session.login.user") !== i.email;
                    e = $('<div class="credentials-verify">').appendTo(document.body),
                    setTimeout(() => {
                        this.hide()
                    }, 0),
                    n.render(a.createElement(Mo, {
                        user: i,
                        isFirst: o,
                        logout: this.ninoxCloudLogout,
                        resend: () => new Promise((e, i) => {
                            t.resendVerificationMail({}, t => t ? i(t) : e())
                        })
                    }), e[0])
                }
            }
            cbTeam(e)
            {
                const t = dbms.getDefaultAccountId();
                "default" === e.teamId ? (be(cn({}, e, {
                    teamId: dbms.getDefaultAccountId()
                })), this.selectAccount(t)) : (this.selectAccount(e.teamId), null == this.accountId && dbms.getRemoteConnection().isLoggedIn() && (be(cn({}, e, {
                    teamId: dbms.getDefaultAccountId()
                })), this.selectAccount(t)))
            }
            ensureAccount()
            {
                const e = xe(),
                    t = dbms.getDefaultAccountId();
                let i,
                    o = e.teamId;
                return "default" === o && t ? (o = t, be({
                    teamId: o
                }), e.dbId && window.location.reload(), i = dbms.getAccount(o)) : (i = dbms.getAccount(o), !i && t && (o = t, be({
                    teamId: o
                }), e.dbId && window.location.reload(), i = dbms.getAccount(o))), i
            }
            cbDatabase()
            {
                const e = this.ensureAccount();
                e && ($.loading(!0), e.ensureDatabase(xe().dbId, (t, i) => {
                    if (t || !i)
                        return $.loading(!1), this.show(), void be({
                            teamId: xe().teamId
                        });
                    e.openDatabase(i, e => {
                        $.loading(!1),
                        e ? (this.show(), be({
                            teamId: xe().teamId
                        })) : (this.hide(), ui.init())
                    })
                }))
            }
            cbTemplate(e)
            {
                dbms.getRemoteConnection().isLoggedIn() ? this.installTemplate(e) : this.ninoxCloudSignup(),
                be({
                    teamId: xe().teamId
                })
            }
            show()
            {
                if (this.visible)
                    return;
                Te("team", this.cbTeam, this),
                Te("tab", this.cbDatabase, this),
                Te("view", this.cbDatabase, this),
                trackPageView("home"),
                Object(l.f)("TeamsHome", "Open"),
                this.visible = !0;
                const e = (Object(c.d)("settings") || {}).windowTitle || "Ninox Database";
                NinoxDocumentInteraction.setWindowTitle(e),
                this.$el = $('<div class="root">').appendTo($(document.body)),
                this.$verificationContainer = $('<div style="position: absolute; left: 0; right: 0;">').appendTo(this.$el).hide(),
                this.$controls = $('<div class="root-controls">').appendTo(this.$el),
                this.$accountTabs = $('<div class="root-tabs --ul-account-tabs">').appendTo(this.$controls),
                this.$controlsButtons = $('<div class="root-controls-buttons">').appendTo(this.$controls),
                this.$body = $('<div class="root-body">').appendTo(this.$el),
                this.user = new rn(this.$controlsButtons),
                $('<div class="button --ul-app-setting-button"><div class="i-32-24 i-white i-setting-settings"></div></div>').appendTo(this.$controlsButtons).touch($.proxy(this.popupOptions, this)),
                this.accountView && this.accountView.show(),
                this.updateUI(),
                this.refreshRemoteConnectionInterval || (this.refreshRemoteConnectionInterval = window.setInterval(this.refreshRemoteConnection, 2e4)),
                window.Appcues && window.Appcues.page()
            }
            hide()
            {
                this.visible && ($e("team", this.cbTeam, this), $e("view", this.cbDatabase, this), $e("tab", this.cbDatabase, this), this.visible = !1, this.refreshRemoteConnectionInterval && (clearInterval(this.refreshRemoteConnectionInterval), this.refreshRemoteConnectionInterval = null), this.accountView && this.accountView.hide(), n.unmountComponentAtNode(this.$accountTabs[0]), this.$el.remove(), this.$el = null, this.$body = null, this.$controls = null, this.$header = null, this.$accountTabs = null, this.user.destroy(), this.user = null)
            }
            updateUI()
            {
                if (!this.visible)
                    return;
                this.$verificationContainer.hide();
                const e = dbms.getRemoteConnection();
                if (e.isLoggedIn()) {
                    const t = e.getCurrentUser();
                    t.verified || (this.$el[0].style.top = "80px", n.render(a.createElement(So, {
                        onContactSupportClick: () => NinoxDocumentInteraction.openBrowser("mailto:support@ninox.com"),
                        onResendClick: () => e.resendVerificationMail({}, console.log),
                        email: t.email
                    }), this.$verificationContainer[0]), this.$verificationContainer[0].style.top = "-80px", this.$verificationContainer[0].style.height = "80px", this.$verificationContainer.show())
                }
                this.updateUITabs(),
                this.accountView && this.accountView.updateUI(),
                this.user.updateUI();
                dbms.getRemoteConnection().getSessionInfo().user
            }
            updateUITabs()
            {
                const e = dbms.listAccounts().map(e => cn({}, e, {
                    id: e.id,
                    isSelected: e.id === this.accountId,
                    text: "" === e.name ? Object(b.getLocale)().unknown : e.name,
                    iconClass: "i-32-24 i-light-grey i-people-group"
                }));
                n.render(a.createElement(Pe.a, {
                    popupItemBackground: "OFF_WHITE",
                    items: e,
                    currentItemId: this.accountId,
                    onItemSelect: e => this.accountTabsClicked(e),
                    onContextMenuClick: e => this.accountTabsContextmenu(e),
                    onNewItemClick: Object(c.f)() ? null : () => this.createAccount(),
                    newButtonText: "+ " + (dbms.getRemoteConnection().isLoggedIn() ? Object(b.getLocale)().newTeam : Object(b.getLocale)().signupCreateTeam)
                }), this.$accountTabs[0])
            }
            dbmsChanged()
            {
                dbms.getAccount(this.accountId) ? this.updateUI() : this.selectAccount(dbms.getDefaultAccountId())
            }
            accountTabsClicked(e)
            {
                e === this.accountId ? this.popupAccountOptions(e) : ve({
                    teamId: e
                })
            }
            accountTabsContextmenu(e)
            {
                this.popupAccountOptions(e)
            }
            createAccount()
            {
                dbms.getRemoteConnection().isLoggedIn() ? this.createAccountDialog() : this.ninoxCloudSignup()
            }
            createAccountDialog()
            {
                const e = this;
                if (!dbms.getRemoteConnection().canCreateTestAccount())
                    return $.alert(Object(b.getLocale)().alreadyTrialPlan);
                const t = $.popdown({
                        cls: "small",
                        head: Object(b.getLocale)().createNewTeam,
                        buttons: ["cancel", "-", {
                            caption: Object(b.getLocale)().createTeam,
                            cls: "blue",
                            click: function() {
                                const o = i.val().trim();
                                if (!o)
                                    return $.alert(Object(b.getLocale)().noTeamName);
                                $.loading(!0),
                                dbms.getRemoteConnection().createAccount({
                                    name: o
                                }, (i, o) => {
                                    if ($.loading(!1), i)
                                        return $.alert(i);
                                    t.close(),
                                    o && e.afterLogin()
                                })
                            }
                        }]
                    }),
                    i = $.input({
                        caption: Object(b.getLocale)().chooseTeamName,
                        $container: t.$content,
                        focus: !0
                    })
            }
            selectAccount(e)
            {
                if (e !== this.accountId) {
                    this.accountView && (this.accountView.destroy(), this.accountView = null);
                    const t = dbms.getAccount(e);
                    t ? (this.accountId = e, "local" === t.base ? (this.accountView = new RootLocal(this, e), trackPageView("home/local"), Object(l.f)("MyDatabases", "Open")) : (this.accountView = new an(this, e), trackPageView("home/team"), Object(l.f)("Team", "Open"))) : this.accountId = null
                }
                this.accountView && this.visible && this.accountView.show(),
                this.updateUI()
            }
            popupAccountOptions(e)
            {
                e === this.accountId && this.accountView && this.accountView.popupOptions()
            }
            selectServer()
            {
                const e = $.popdown({
                        cls: "small",
                        head: "Select Server",
                        buttons: ["cancel", "-", {
                            caption: Object(b.getLocale)().okay,
                            cls: "blue",
                            click: function() {
                                const e = t.val().trim();
                                if (e && !/^([a-z][a-z0-9\-\_]*)(\.[a-z][a-z0-9\-\_]*)*(\:[0-9]+)?$/.test(e))
                                    return $.alert("Invalid address.");
                                e != NinoxDocumentInteraction.getUserDefault("nx.server") && (NinoxDocumentInteraction.setUserDefault("nx.server", e), dbms.getRemoteConnection().clearSession(), window.location.reload())
                            }
                        }]
                    }),
                    t = $.input({
                        caption: "Server",
                        $container: e.$content,
                        focus: !0
                    });
                t.$input.attr("autocomplete", "off").attr("autocorrect", "off").attr("autocapitalize", "off").attr("spellcheck", "false"),
                t.val(NinoxDocumentInteraction.getUserDefault("nx.server"))
            }
            popupOptions(e)
            {
                const t = this,
                    i = dbms.getRemoteConnection(),
                    o = i.getAccount(this.accountId),
                    n = o && o.owner === i.getUserId(),
                    s = $.backplane({
                        close: function() {
                            c.destroy()
                        }
                    }),
                    a = $('<div class="nx-menu-popup popupeditor">').css({
                        left: "auto",
                        right: 0,
                        top: 40
                    }).appendTo(s);
                $('<div class="nx-menu-item">').append($('<div class="nx-menu-icon i-32-24 i-light-grey i-question">')).append($('<div class="nx-menu-label">').text(Object(b.getLocale)().onlineHelp)).appendTo(a).touch(() => {
                    s.close(),
                    trackEvent("UserManual", "Click"),
                    Object(l.f)("UserManual", "Click"),
                    NinoxDocumentInteraction.openBrowser(function() {
                        const e = "de" === Object(b.getLocale)().LOCALE ? "de" : "en";
                        let t = "https://ninox.com";
                        ["qs", "alpha"].includes("prod") && (t = "https://q-www.ninox.com");
                        const i = `${t}/${e}/manual`;
                        return i + "?h=1&utm_medium=ninox-app&utm_campaign=app-other-manual&utm_source=app-other"
                    }())
                }),
                $('<div class="nx-menu-item">').append($('<div class="nx-menu-icon i-32-24 i-light-grey i-field-email">')).append($('<div class="nx-menu-label">').text(Object(b.getLocale)().supportTicket)).appendTo(a).touch(() => {
                    s.close(),
                    trackEvent("GetSupport", "Click"),
                    Object(l.f)("GetSupport", "Click"),
                    NinoxDocumentInteraction.openBrowser("mailto:support@ninox.com")
                }),
                n && $('<div class="nx-menu-item">').append($('<div class="nx-menu-icon i-32-24 i-light-grey i-cloud-okay">')).append($('<div class="nx-menu-label">').text("Zapier Integrations")).appendTo(a).touch(() => {
                    s.close(),
                    trackEvent("ZapierIntegrations", "Click"),
                    Object(l.f)("ZapierIntegrations", "Click"),
                    t.openIntegrations()
                });
                const r = new b.util.SimpleModel(new b.schemas.TChoice(void 0, void 0, {
                    caption: Object(b.getLocale)().language,
                    required: !0,
                    values: {
                        auto: {
                            caption: Object(b.getLocale)().auto,
                            order: 1
                        },
                        en: {
                            caption: "English",
                            order: 2
                        },
                        fr: {
                            caption: "French (Français)",
                            order: 3
                        },
                        de: {
                            caption: "German (Deutsch)",
                            order: 4
                        },
                        it: {
                            caption: "Italian (Italiano)",
                            order: 5
                        },
                        es: {
                            caption: "Spanish (Español)",
                            order: 6
                        },
                        ca: {
                            caption: "Catalan (Català)",
                            order: 7
                        },
                        pl: {
                            caption: "Polish (Polski)",
                            order: 8
                        },
                        ru: {
                            caption: "Russian (Русский)",
                            order: 9
                        },
                        chs: {
                            caption: "Chinese simplified (简体中文)",
                            order: 10
                        },
                        cht: {
                            caption: "Chinese traditional (繁體中文)",
                            order: 11
                        }
                    }
                }));
                r.value = NinoxDocumentInteraction.getUserDefault("ui.language") || "auto";
                const c = new Ue.a(void 0, r, a);
                r.on("update", () => {
                    NinoxDocumentInteraction.setUserDefault("ui.language", r.value),
                    setTimeout(() => {
                        t.reload()
                    }, 0)
                }),
                c.el.css({
                    width: 240
                })
            }
            openIntegrations(e)
            {
                const t = $.popdown({}),
                    i = [];
                $('<div class="nx-section-head">').text(Object(b.getLocale)().zapierIntegration).appendTo(t.$pane);
                const o = $('<div class="root-backup-list">').css({
                        padding: "0 10px",
                        height: "75vh"
                    }).appendTo(t.$pane),
                    n = $('<table class="w-100">'),
                    s = $('<div class="api-keys-body">').append(n),
                    a = $('<button class="api-generate-btn pointer">' + Object(b.getLocale)().generate + "</button>").click((function() {
                        dbms.getRemoteConnection().generateAPIKey((e, t) => {
                            if (e)
                                return console.warn(e);
                            const o = r(t.token);
                            i[t.token] = o,
                            n.append(o)
                        })
                    }));
                function r(e) {
                    const t = $('<span class="nx-menu-icon i-32-24 i-light-grey i-close"></span>').click(() => {
                        return t = e, void dbms.getRemoteConnection().deleteAPIKey(t, (e, o) => {
                            if (e)
                                return console.warn(e);
                            const n = i[t];
                            n && (n.remove(), delete i[t])
                        });
                        var t
                    });
                    return $("<tr>").append($('<td class="api-data force-select"><span>' + e + "</span></td>")).append($('<td class="api-data text-right pointer" title="Delete Token">').append(t))
                }
                $('<div class="api-keys">').append($('<div class="api-keys-header"><div class="half"><span style="font-size: 1.1rem;">API Keys</span></div></div>').append($('<div class="half text-right">').append(a))).append(s).appendTo(o),
                dbms.getRemoteConnection().fetchAPIKeys((e, t) => {
                    if (e)
                        return console.warn(e);
                    t.forEach(e => {
                        const t = r(e.token);
                        i[e.token] = t,
                        n.append(t)
                    })
                }),
                $('<div id="zapier_embeds" style="padding:0 10px;height:520px"><script src="https://zapier.com/apps/embed/widget.js?services=ninox&html_id=zapier_embeds"/></div>').appendTo(o)
            }
            upgradePlan()
            {
                trackEvent("upgrade", "click"),
                Object(l.f)("Upgrade", "Open"),
                this.upgradePlan_CLEVERBRIDGE()
            }
            upgradePlan_APPLE()
            {
                new Store({})
            }
            upgradePlan_CLEVERBRIDGE()
            {
                const e = dbms.getRemoteConnection().getUpgradeURL();
                setTimeout(() => {
                    window.location.href = e
                }, 40)
            }
            ninoxCloudSignup()
            {
                const e = this;
                let t = !1;
                const i = !Object(c.f)(),
                    o = window.location.hash,
                    s = ke().error;
                if (/\#signup/.exec(o) && i && (t = !0), trackPageView(t ? "signup" : "login"), Object(l.f)(t ? "Signup" : "Login", "Open"), Object(c.g)()) {
                    const e = $.popdown({
                            head: Object(c.f)() ? Object(b.getLocale)().signinHead || "Ninox Login" : Object(b.getLocale)().signupHead
                        }),
                        t = Object(c.d)("settings") || {},
                        i = t.ssoButtonClasses,
                        o = t.ssoButtonText,
                        n = () => {
                            close(),
                            dbms.getRemoteConnection().samlLogin()
                        };
                    if ($.buttons({
                        classes: "root-sso-popup",
                        items: [{
                            caption: o || Object(b.getLocale)().ssoLogin || "SSO Login",
                            click: n,
                            cls: `blue${i ? ` ${i}` : ""}`
                        }],
                        $container: e.$pane
                    }), s) {
                        const t = decodeURI(s);
                        $('<div class="root-sso-error">' + htmlEscape(t) + "</div>").appendTo(e.$pane)
                    }
                } else {
                    const o = $.backplane({
                        close: function() {
                            n.unmountComponentAtNode(o[0])
                        },
                        scrollable: !0,
                        closable: !1
                    });
                    n.render(a.createElement(ko, {
                        canSignup: i,
                        wantsSignup: t,
                        close: () => o.close(),
                        afterLogin: () => e.afterLogin()
                    }), o[0])
                }
            }
            ninoxCloudLogout()
            {
                const e = dbms.getRemoteConnection();
                window.database ? dbms.closeDatabase(() => {
                    e.logout(e => {
                        ui && ui.handleLogout(() => {
                            be({
                                teamId: "default"
                            }),
                            window.location.reload()
                        })
                    })
                }) : e.logout(e => {
                    if (e)
                        return $.alert(e);
                    this.createAccount()
                })
            }
            handleOpenURL(e)
            {
                if (e)
                    if (/^ninox\:\/\/do\:/.test(e)) {
                        const t = /^ninox\:\/\/do\:([a-z\-]+)\:(.*)$/.exec(e);
                        if (t) {
                            const e = t[1],
                                i = t[2];
                            "set-server" === e ? NinoxDocumentInteraction.getUserDefault("nx.server") !== i && (NinoxDocumentInteraction.setUserDefault("nx.server", i), dbms.getRemoteConnection().clearSession(), window.location.reload()) : alert("Unknow command: " + e + ":" + i)
                        } else
                            alert("Invalid url: " + e)
                    } else {
                        if (/^ninox\:\/\//.test(e)) {
                            const t = e.substr(8);
                            if (!t)
                                return;
                            e = /^[a-z]+\:/i.test(t) ? t : "http://" + t
                        }
                        /\.ninox$/i.test(e) ? (be({
                            teamId: xe().teamId
                        }), ui.destroy(() => {
                            this.show(),
                            this.accountView ? this.accountView.importDatabase(e) : $.alert("No account selected.")
                        })) : new Ye({
                            url: e
                        })
                    }
            }
            reload()
            {
                window.location.reload()
            }
            renameDatabase(e, t)
            {
                this.accountView && this.accountView.renameDatabase(e, t)
            }
            duplicateDatabase(e, t)
            {
                this.accountView && this.accountView.duplicateDatabase(e, t)
            }
            reorganizeDatabase(e, t)
            {
                this.accountView && this.accountView.reorganizeDatabase(e, t)
            }
            saveDatabaseArchiveAs(e, t)
            {
                this.accountView && this.accountView.saveDatabaseArchiveAs(e, t)
            }
            createDatabase()
            {
                this.accountView && this.accountView.createDatabase()
            }
            importArchive(e)
            {
                this.accountView && this.accountView.importArchive(e)
            }
            removeDatabase(e, t)
            {
                this.accountView && this.accountView.removeDatabase(e, t)
            }
            trigger(e) {}
            installTemplate(e)
            {
                this.accountView && this.accountView.account && ($.loading(!0), this.accountView.account.loadArchive({
                    url: e
                }, e => {
                    $.loading(!1),
                    e && $.alert(e)
                }))
            }
            processSAMLToken(e)
            {
                if (!Object(c.f)())
                    return e();
                const {error: t, token: i} = ke();
                if (t || !i)
                    return e();
                dbms.getRemoteConnection().fetchSession(i, (t, i) => {
                    dbms.getRemoteConnection().saveSession(i),
                    dbms.getRemoteConnection().refresh(e)
                })
            }
        }
        var hn = o("./src/react/util/HorizontalScrollContainer/HorizontalScrollItem.tsx");
        o("./src/react/tableView/TabsRow.css");
        const pn = Object(Me.SortableContainer)(({children: e, className: t}) => a.createElement("div", {
                className: t
            }, e)),
            un = Object(Me.SortableElement)(({children: e}) => e);
        class fn extends a.Component {
            constructor(e)
            {
                super(e),
                K()(this, "handleScrollStateChange", e => {
                    this.props.onScrollStateChange(e),
                    this.setState({
                        isScrollable: e
                    })
                }),
                this.state = {
                    isScrollable: !1,
                    isSorting: !1
                }
            }
            render()
            {
                const e = this.props.views[this.props.selectedIndex],
                    t = null == e ? void 0 : e.id;
                return a.createElement("div", {
                    className: "TabsRow_root"
                }, a.createElement(si.a, {
                    controlsConfig: {
                        position: "AFTER_CHILD",
                        left: {
                            innerElement: this.getElementBeforeControls(),
                            visibility: window.TOUCH ? "NONE" : "AUTO",
                            containerClassName: "TabsRow_movementControlsContainer TabsRow_movementControlsContainerLeft"
                        },
                        right: {
                            containerClassName: "TabsRow_movementControlsContainer",
                            visibility: window.TOUCH ? "NONE" : "AUTO"
                        }
                    },
                    useExternalResizeListener: !0,
                    selectedItemId: t,
                    onScrollStateChange: this.handleScrollStateChange
                }, a.createElement(pn, {
                    onSortStart: () => this.setState({
                        isSorting: !0
                    }),
                    className: "TabsRow_tabsContainer",
                    helperClass: "TabsRow_helperClass",
                    distance: window.TOUCH ? 0 : 3,
                    pressDelay: window.TOUCH ? 200 : 0,
                    onSortEnd: e => this.onSortEnd(e.oldIndex, e.newIndex),
                    axis: "x"
                }, this.props.views.map((e, t) => a.createElement(un, {
                    key: e.id,
                    index: t
                }, a.createElement(hn.a, {
                    id: e.id,
                    className: this.getViewClass(t)
                }, a.createElement(ee.a, {
                    className: "TabsRow_view",
                    preventLongPress: !0,
                    onFastClick: e => this.props.onTabClick(e, t),
                    onFastContextMenu: e => this.props.onContext(e, t)
                }, e.caption || Object(b.getLocale)().unnamed)))))), this.getElementAfterControls())
            }
            getElementAfterControls()
            {
                return this.state.isScrollable ? a.createElement("div", {
                    className: "TabsRow_actionsContainer"
                }, a.createElement(ee.a, {
                    onFastClick: this.props.onShowMoreTabsClick,
                    className: "i-32-16 i-white i-items"
                })) : null
            }
            getElementBeforeControls()
            {
                return this.props.isAdmin ? a.createElement("div", {
                    className: "TabsRow_actionsContainer TabsRow_addContainer"
                }, a.createElement(ee.a, {
                    onFastClick: this.props.onNewViewClick,
                    className: "i-32-16 i-light-grey i-plus"
                })) : null
            }
            getViewClass(e)
            {
                let t = "TabsRow_viewContainer";
                return e === this.props.selectedIndex && (t += " TabsRow_viewSelected"), this.state.isSorting && (t += " TabsRow_viewSorting"), t
            }
            onSortEnd(e, t)
            {
                this.setState({
                    isSorting: !1
                }),
                this.props.onReorder(e, t)
            }
        }
        class mn extends a.Component {
            constructor(e)
            {
                super(e),
                K()(this, "handleTabClick", (e, t) => {
                    t === this.props.selectedIndex ? this.handleContextMenu(e, t) : this.props.onTabClick(t)
                }),
                K()(this, "handleContextMenu", (e, t) => {
                    const i = [{
                        text: Object(b.getLocale)().newView + "...",
                        onClick: this.props.onNewViewClick
                    }, {
                        text: Object(b.getLocale)().renameView + "...",
                        onClick: () => this.props.onRenameView(t)
                    }, {
                        text: Object(b.getLocale)().removeView,
                        onClick: () => this.handleRemoveView(t)
                    }];
                    t === this.props.selectedIndex && i.push({
                        text: Object(b.getLocale)().showHideColumns,
                        onClick: () => this.props.onEditColumns(t)
                    }),
                    this.displayContextMenu(e, t, i)
                }),
                K()(this, "displayContextMenu", (e, t, i) => {
                    this.setState({
                        target: ee.b.getTarget(e),
                        contextMenu: {
                            isOpen: !0,
                            content: i
                        }
                    })
                }),
                K()(this, "handleShowAllClicked", e => {
                    this.setState({
                        target: ee.b.getTarget(e),
                        isPopupMenuOpen: !0
                    })
                }),
                K()(this, "handleScrollStateChange", e => {
                    this.setState({
                        isScrollable: e,
                        isPopupMenuOpen: !1
                    })
                }),
                K()(this, "closeBackplane", () => {
                    this.setState(e => ({
                        killWhenTargetIsNull: !1,
                        isPopupMenuOpen: !1,
                        contextMenu: {
                            isOpen: !1,
                            content: e.contextMenu.content
                        }
                    }))
                }),
                this.state = {
                    target: null,
                    isScrollable: !1,
                    isPopupMenuOpen: !1,
                    contextMenu: {
                        isOpen: !1,
                        content: []
                    },
                    killWhenTargetIsNull: !1
                }
            }
            render()
            {
                return a.createElement("div", {
                    style: {
                        width: "100%"
                    }
                }, a.createElement(fn, {
                    isAdmin: this.props.isAdmin,
                    onContext: this.handleContextMenu,
                    onScrollStateChange: this.handleScrollStateChange,
                    onNewViewClick: this.props.onNewViewClick,
                    onReorder: this.props.onReorder,
                    onShowMoreTabsClick: this.handleShowAllClicked,
                    onTabClick: this.handleTabClick,
                    selectedIndex: this.props.selectedIndex,
                    views: this.props.views
                }), this.state.isScrollable ? a.createElement(ri.a, {
                    itemBackground: "OFF_WHITE",
                    items: this.getPopUpItems(),
                    clickTarget: this.state.target,
                    show: this.state.isPopupMenuOpen,
                    onClick: e => {
                        e !== this.props.selectedIndex && (null !== e && this.props.onTabClick(e), this.closeBackplane())
                    },
                    onReorder: this.props.onReorder
                }) : null, a.createElement(io, {
                    clickTarget: this.state.target,
                    killWhenTargetIsNull: this.state.killWhenTargetIsNull,
                    show: this.state.contextMenu.isOpen,
                    onClick: this.closeBackplane,
                    items: this.state.contextMenu.content
                }))
            }
            handleRemoveView(e)
            {
                this.setState({
                    target: null,
                    killWhenTargetIsNull: !0
                }),
                this.props.onRemoveView(e)
            }
            getPopUpItems()
            {
                return this.props.views.map((e, t) => {
                    let i = e.mode;
                    return "full" === e.mode ? i = "form" : "pivot" === e.mode || "table" === e.mode ? i = "setting-table" : "chart" === e.mode ? i = "setting-table-chart" : "cards" === e.mode && (i = "home"), {
                        id: e.id,
                        isSelected: t === this.props.selectedIndex,
                        text: e.caption,
                        iconClass: i ? "i-32-24 i-light-grey i-" + i : "i-32-24 i-light-grey i-setting-table"
                    }
                })
            }
        }
        o("./node_modules/assert/assert.js");
        function gn(e) {
            var t = e.type,
                i = $.backplane({}),
                o = $('<div style="position:absolute;left:' + ui.leftWidth + 'px;right:0;bottom:0;top:48px;background-color:#fff">').appendTo(i),
                n = $('<div style="position:absolute;left:0;top:0;right:0;bottom:48px;overflow:auto">').appendTo(o),
                s = (window.getWidth(), []);
            T.each(t.sorted, (function(e) {
                var i,
                    o,
                    a,
                    r,
                    l,
                    c,
                    d,
                    h;
                function p() {
                    l.setHidden("function" !== o.value),
                    d.el.setHidden("value" !== o.value)
                }
                vn(e) && (i = $('<div style="border-bottom:solid 1px #EFF1F9;display:flex;display:-webkit-flex">').append($('<div style="flex:0 0 auto;-webkit-flex:0 0 auto;width:150px;line-height:48px;overflow:hidden;white-space:nowrap;text-align:right;padding:0 8px">').text(e.caption || e.id)).appendTo(n), (o = new util.SimpleModel(new schemas.TChoice(void 0, void 0, {
                    caption: locale.updateMode,
                    required: !0,
                    width: 2,
                    values: {
                        ignore: {
                            caption: locale.updateModeDontChange,
                            order: 1
                        },
                        value: {
                            caption: locale.updateModeAssignValue,
                            order: 2
                        },
                        function: {
                            caption: locale.updateModeAssignFunction,
                            order: 3
                        },
                        null: {
                            caption: locale.updateModeAssignNull,
                            order: 4
                        }
                    }
                }))).value = "ignore", o.withoutLabel = !0, o.on("update", p), (a = new Ue.a(void 0, o, i)).el.css({
                    width: 200,
                    flex: "0 0 auto",
                    "-webkit-flex": "0 0 auto"
                }), l = $('<div class="editor" style="flex:1 1 auto;-webkit-flex:1 1 auto">').appendTo(i), r = $('<div class="input-text">').appendTo($('<div class="stringeditor">').appendTo(l)).click((function() {
                    new ft.a({
                        value: h.fn,
                        schema: database.schema,
                        type: t,
                        okay: function(e, t) {
                            h.fn = e || "",
                            h.exp = t,
                            r.text(t ? t.toHumanString() : "")
                        }
                    })
                })), (c = new util.SimpleModel(e)).withoutLabel = !0, (d = new Ue.a(void 0, c, i)).el.css({
                    flex: "1 1 auto",
                    "-webkit-flex": "1 1 auto"
                }), h = {
                    fn: "",
                    exp: void 0,
                    field: e,
                    updateMode: o,
                    updateModeField: a,
                    value: c
                }, s.push(h), p())
            }));
            var a = $('<div style="position:absolute;left:0;bottom:0;right:0;height:48px;background-color:#fff;display:flex;display:-webkit-flex;border-top:solid 1px #D4D9E9">').appendTo(o),
                r = new util.SimpleModel(new schemas.TChoice(void 0, void 0, {
                    caption: "",
                    required: !0,
                    width: 2,
                    values: {
                        visible: {
                            caption: locale.updateVisibleRecords,
                            order: 2
                        },
                        selected: {
                            caption: locale.updateSelectedRecords,
                            order: 3
                        }
                    }
                }));
            function l() {
                i.close()
            }
            r.value = T.isEmpty(e.midChoosen) ? "visible" : "selected",
            r.withoutLabel = "true",
            new Ue.a(void 0, r, a).el.css({
                width: 400
            }),
            $('<div class="nx-hspace-flex">').appendTo(a),
            $('<div class="nx-button-text grey" style="margin:8px">').text(locale.cancel).appendTo(a).touch(l),
            $('<div class="nx-button-text blue" style="margin:8px 8px 8px 0">').text(locale.next).appendTo(a).touch((function() {
                $.loading(!0);
                for (var i = "selected" === r.value ? T.keys(e.midChoosen) : T.keys(e.models), o = [], n = {}, a = 0; a < s.length; a++) {
                    var c = s[a];
                    "function" === c.updateMode.value && c.exp && queries.extendDependencies(n, c.exp.dependencies)
                }
                function d() {
                    let e = 1;
                    for (let n = 0; n < i.length; n++) {
                        const a = i[n],
                            r = database.loadNodeSync(a);
                        if (r) {
                            const i = {
                                _id: a
                            };
                            for (let o = 0; o < s.length; o++) {
                                const n = s[o],
                                    a = n.field,
                                    l = n.updateMode.value;
                                if ("function" === l && n.exp) {
                                    const o = n.exp;
                                    e++,
                                    o.evaluate(database, r, (function(e, n) {
                                        n && n._missingNodes ? console.log("ERR: Missing nodes: " + JSON.stringify(n._missingNodes)) : a.isReference && "nid" === o.returnType.base ? i[a.id] = database.ridOf(n) : i[a.id] = a.convert(n),
                                        t()
                                    }))
                                } else
                                    "value" === l ? i[a.id] = a.convert(n.value.value) : "null" === l && (i[a.id] = null)
                            }
                            o.push(i)
                        }
                    }
                    function t() {
                        e--,
                        0 === e && setTimeout(h, 0)
                    }
                    t()
                }
                function h() {
                    $.loading(!1);
                    var i = $('<div class="nx-backplane import-preview">').appendTo($(document.body)),
                        n = t.sorted,
                        s = $('<div style="position:absolute;left:0;bottom:0;right:0;padding:8px;background-color:#fff;border-top:solid 1px #D4D9E9;display:flex;display:-webkit-flex">').appendTo(i);
                    $('<div class="nx-hspace-flex">').appendTo(s),
                    $('<div class="nx-button-text grey">').text(locale.back).appendTo(s).touch((function() {
                        i.remove()
                    })),
                    $('<div class="nx-hspace-small">').appendTo(s),
                    $('<div class="nx-button-text red">').text(locale.executeUpdate).appendTo(s).touch((function() {
                        i.remove(),
                        $.loading(!0),
                        e.silent = !0,
                        database.updateNodes(o, (function(t) {
                            $.loading(!1),
                            e.silent = !1,
                            t && $.alert(t),
                            l(),
                            e.reload()
                        }))
                    }));
                    var a = $('<div style="position:absolute;left:0;top:20px;width:100%;padding:0 16px;box-sizing:border-box;-moz-box-sizing:border-box;text-align:right">').appendTo(i);
                    $('<div style="float:left;height:32px;line-height:32px">').text(locale.importPreview).appendTo(a),
                    a.button("prev", void 0, void 0, (function() {
                        --p < 0 && (p = u - 1);
                        f()
                    }));
                    var r = $('<div style="display:inline-block;height:32px;line-height:32px">').appendTo(a);
                    a.button("next", void 0, void 0, (function() {
                        ++p >= u && (p = 0);
                        f()
                    }));
                    var c = $('<div style="position:absolute;left:0;top:68px;width:100%;bottom:51px;overflow:auto">').appendTo(i),
                        d = window.getHeight() - 128,
                        h = Math.max(1, Math.floor(d / 33) - 1),
                        p = 0,
                        u = Math.ceil(o.length / h);
                    function f() {
                        r.text(locale.page + " " + (p + 1) + " / " + u);
                        for (var e = "<table><thead><tr><th>" + htmlEscape(locale.id) + "</th>", t = 0; t < n.length; t++) {
                            vn(m = n[t]) && (e += "<th>" + htmlEscape(m.caption) + "</th>")
                        }
                        e += "</tr></thead><tbody>";
                        for (var i = p * h, s = Math.min(i + h, o.length), a = i; a < s; a++) {
                            var l = o[a];
                            e += "<tr>";
                            var d = l._id,
                                f = database.loadNodeSync(d);
                            e += '<td style="text-align:right">' + htmlEscape(schemas.ridOf(d)) + "</td>";
                            for (t = 0; t < n.length; t++) {
                                var m;
                                if (vn(m = n[t])) {
                                    var g = l[m.id],
                                        v = f ? f[m.id] : void 0;
                                    e += '<td class="cell-' + m.base + '">',
                                    null != v && "" !== v && (e += '<div class="import-cell-old">' + htmlEscape(m.format(v)) + "</div>"),
                                    void 0 !== g && (e += null === g ? '<div class="import-cell-update">' + htmlEscape(locale.empty) + "</div>" : '<div class="import-cell-update">' + htmlEscape(m.format(g)) + "</div>"),
                                    e += "</td>"
                                }
                            }
                            e += "</tr>"
                        }
                        e += "</tbody></table>",
                        c.html(e)
                    }
                    f()
                }
                setTimeout((function() {
                    database.loadNodes2(i, n, (function(e) {
                        e && ($.loading(!1), $.alert(e)),
                        setTimeout(d, 0)
                    }))
                }), 0)
            }))
        }
        function vn(e) {
            return (e.isField && "fn" !== e.base || e.isReference) && database.canWrite(e)
        }
        function bn() {}
        bn.prototype.destroy = function() {
            this.hide(),
            this.el.remove()
        },
        bn.prototype.setVisible = function(e) {
            e ? this.show() : this.hide()
        },
        bn.prototype.show = function(e) {
            if (console.log("TableViewRenderer.show", e), !this.visible) {
                this.visible = !0,
                window.addEventListener("resize", this.resize),
                database.on("schema", void 0, this.schemaChanged, this),
                database.on("rename", void 0, this.nodeRenamed, this),
                database.on("remove", void 0, this.nodeRemoved, this),
                database.on("create", void 0, this.nodeCreated, this),
                database.on("admin", void 0, this.adminChanged, this),
                this.el.appendTo(ui.$body),
                $.pushInputHandler(this);
                var t = this.getSelectedNid();
                t && this.openEditor(t),
                ui.recordNavigation.pushController(this),
                this.didShow(e)
            }
        },
        bn.prototype.didShow = function(e) {},
        bn.prototype.schemaChanged = function(e, t, i) {},
        bn.prototype.hide = function() {
            console.log("TableViewRenderer.hide"),
            this.visible && (this.visible = !1, ui.recordNavigation.popController(this), window.removeEventListener("resize", this.resize), database.off("schema", void 0, this.schemaChanged, this), database.off("rename", void 0, this.nodeRenamed, this), database.off("remove", void 0, this.nodeRemoved, this), database.off("create", void 0, this.nodeCreated, this), database.off("admin", void 0, this.adminChanged, this), $.popInputHandler(this), this.closeEditor(!0), this.el.detach(), this.didHide())
        },
        bn.prototype.didHide = function() {},
        bn.prototype.resize = function() {},
        bn.prototype.updateUI = function() {},
        bn.prototype.menuNewViewEnabled = function() {
            return database.isAdmin()
        },
        bn.prototype.menuNewView = function() {
            database.isAdmin() && this.tableView.createView()
        },
        bn.prototype.menuRenameViewEnabled = function() {
            return database.isAdmin()
        },
        bn.prototype.menuRenameView = function() {
            database.isAdmin() && this.tableView.renameView()
        },
        bn.prototype.menuDeleteViewEnabled = function() {
            return database.isAdmin()
        },
        bn.prototype.menuDeleteView = function() {
            database.isAdmin() && this.tableView.removeView()
        },
        bn.prototype.menuEditColumnsEnabled = function() {
            return database.isAdmin()
        },
        bn.prototype.menuEditColumns = function() {
            database.isAdmin() && this.tableView.popupColumnMenu()
        },
        bn.prototype.menuShowViewAsFormEnabled = function() {
            return database.isAdmin()
        },
        bn.prototype.menuShowViewAsForm = function() {
            database.isAdmin() && this.tableView.showForm()
        },
        bn.prototype.menuShowViewAsTableEnabled = function() {
            return database.isAdmin()
        },
        bn.prototype.menuShowViewAsTable = function() {
            database.isAdmin() && this.tableView.showTable()
        },
        bn.prototype.menuShowViewAsChartEnabled = function() {
            return database.isAdmin()
        },
        bn.prototype.menuShowViewAsChart = function() {
            database.isAdmin() && this.tableView.showChart()
        },
        bn.prototype.hasNextRecord = function() {
            return this.getQuery().rows.length > 0
        },
        bn.prototype.nextRecord = function() {
            this.editorDown()
        },
        bn.prototype.hasPrevRecord = function() {
            return this.getQuery().rows.length > 0
        },
        bn.prototype.prevRecord = function() {
            this.editorUp()
        },
        bn.prototype.lastRecord = function() {
            this.editorLast()
        },
        bn.prototype.firstRecord = function() {
            this.editorFirst()
        },
        bn.prototype.hasAddRecord = function() {
            return !(!this.getQuery().type || !database.canCreate(this.getQuery().type))
        },
        bn.prototype.addRecord = function() {
            var e = this;
            Object(c.a)(this.getQuery().type, (function(t) {
                e.select(t)
            }))
        },
        bn.prototype.hasDuplicateRecord = function() {
            return !!(this.getSelectedNid() && this.getQuery().type && database.canCreate(this.getQuery().type))
        },
        bn.prototype.duplicateRecord = function() {
            var e = this;
            Object(c.b)(e.getSelectedNid(), (function(t) {
                e.select(t)
            }))
        },
        bn.prototype.hasRemoveRecord = function() {
            return !!(this.getSelectedNid() && this.getQuery().type && database.canDelete(this.getQuery().type))
        },
        bn.prototype.removeRecord = function() {
            Object(c.j)(this.getSelectedNid())
        },
        bn.prototype.hasPrintRecord = function() {
            return !(!this.getSelectedNid() || !1 === database.authorizationPrint)
        },
        bn.prototype.printRecord = function() {
            Object(c.i)(this.getSelectedNid())
        },
        bn.prototype.getSelectedNid = function() {
            return this.getQuery().getSelectedNid()
        },
        bn.prototype.getSelectedNids = function() {
            return []
        },
        bn.prototype.getSideEditorOptions = function() {
            return this.sideEditorOptions || (this.sideEditorOptions = {
                close: $.proxy(this.unselect, this),
                next: $.proxy(this.editorDown, this),
                prev: $.proxy(this.editorUp, this),
                first: $.proxy(this.editorFirst, this),
                last: $.proxy(this.editorLast, this),
                duplicate: $.proxy(this.duplicate, this),
                getSelectedNids: $.proxy(this.getSelectedNids, this)
            }), this.sideEditorOptions
        },
        bn.prototype.select = function(e) {
            e !== this.getSelectedNid() && this.getQuery().select(e)
        },
        bn.prototype.selectionChanged = function() {
            this.visible && (ui.recordNavigation.updateUI(), this.openEditor(this.getSelectedNid()), this.updateSelection())
        },
        bn.prototype.updateSelection = function() {},
        bn.prototype.unselect = function() {
            this.select(void 0)
        },
        bn.prototype.toggleGroup = function(e) {
            this.getQuery().toggle(e)
        },
        bn.prototype.editorDown = function() {
            this.getQuery().editorDown()
        },
        bn.prototype.editorUp = function() {
            this.getQuery().editorUp()
        },
        bn.prototype.editorLast = function() {
            this.getQuery().editorLast()
        },
        bn.prototype.editorFirst = function() {
            this.getQuery().editorFirst()
        },
        bn.prototype.getQuery = function() {
            return this.tableView.table
        },
        bn.prototype.openEditor = function(e) {
            this.visible && ui.sideEditor.open(e, this.getSideEditorOptions())
        },
        bn.prototype.closeEditor = function(e) {
            ui.sideEditor.close(e)
        },
        bn.prototype.queryChanged = function() {},
        bn.prototype.rowsChanged = function() {},
        bn.prototype.dataChanged = function() {},
        bn.prototype.nodeRemoved = function(e, t) {},
        bn.prototype.nodeRenamed = function(e, t, i) {},
        bn.prototype.nodeCreated = function(e, t) {},
        bn.prototype.adminChanged = function(e, t) {},
        bn.prototype.bodyResized = function() {},
        bn.prototype.keydown = function(e) {
            console.log("TableViewRenderer.keydown", e.which);
            var t = e.which,
                i = this.getQuery();
            switch (t) {
            case 27:
                i.selectNothing(),
                e.preventDefault();
                break;
            case 32:
                i.onlyChoosen ? i.showAll() : T.isEmpty(i.midChoosen) || i.showOnlyChoosen(),
                e.preventDefault();
                break;
            case 33:
                e.metaKey ? i.editorPrevGroup() : i.editorPageUp(),
                e.preventDefault();
                break;
            case 34:
                e.metaKey ? i.editorNextGroup() : i.editorPageDown(),
                e.preventDefault();
                break;
            case 35:
                i.editorLast(),
                e.preventDefault();
                break;
            case 36:
                i.editorFirst(),
                e.preventDefault();
                break;
            case 38:
                e.metaKey ? i.editorFirst(e.shiftKey) : e.altKey ? i.editorPageUp() : i.editorUp(e.shiftKey),
                e.preventDefault();
                break;
            case 40:
                e.metaKey ? i.editorLast(e.shiftKey) : e.altKey ? i.editorPageDown() : i.editorDown(e.shiftKey),
                e.preventDefault();
                break;
            default:
                (e.metaKey || e.ctrlKey) && 70 === t && (i.openFindMenu(), e.preventDefault())
            }
        },
        bn.prototype.openContextMenu = function(e) {
            this.getQuery().openContextMenu(e)
        };
        function yn(e) {
            this.visible = e.visible || !1,
            this.renderHTML = e.render,
            this.$pane = $('<div class="scrollpane" style="display:' + (this.visible ? "" : "none") + '">').appendTo(e.$parent),
            this.$body = $('<div class="scrollpane-body">').appendTo(this.$pane),
            this.$view = $('<div class="scrollpane-view">').appendTo(this.$body),
            e.head ? (this.$head = $('<div class="scrollpane-head" style="height:' + e.head.height + 'px">').appendTo(this.$pane), this.$headView = $('<div class="scrollpane-view">').appendTo(this.$head), this.$body.css("top", e.head.height), this.renderHeadHTML = e.head.render, this.headHeight = e.head.height) : this.headHeight = 0,
            e.foot ? (this.$foot = $('<div class="scrollpane-foot" style="height:' + e.foot.height + 'px">').appendTo(this.$pane), this.$footView = $('<div class="scrollpane-view">').appendTo(this.$foot), this.$body.css("bottom", e.foot.height), this.renderFootHTML = e.foot.render, this.footHeight = e.foot.height) : this.footHeight = 0,
            this.createScrollBars(),
            this.rows = [],
            this.rowOffsets = [],
            this.totalHeight = 0,
            this.totalWidth = 0,
            this.viewRow0 = 0,
            this.viewRow1 = 0,
            this.scrollY = 0,
            this.scrollX = 0,
            this.scrollYTarget = 0,
            this.scrollXTarget = 0,
            this.viewY0 = 0,
            this.viewY1 = 0,
            this.visibleWidth = 100,
            this.visibleHeight = 100,
            this.leftWidth = 0,
            this.scrollDoneTime = 0,
            this.scrollDoneTimeout = null,
            this.scrollDone = $.proxy(this.scrollDone, this),
            this.registerScrollListeners()
        }
        function wn(e) {
            var t = this;
            this.tableView = e,
            this.visible = !1,
            this.resize = $.proxy(this.resize, this),
            this.el = $('<div class="cards-container">').touch($.proxy(this.clicked, this)),
            this.scrollPane = new yn({
                $parent: this.el,
                render: function(e, i) {
                    return t.renderHTML(e, i)
                },
                head: {
                    height: 0,
                    render: function() {
                        return ""
                    }
                },
                foot: {
                    height: 0,
                    render: function() {
                        return ""
                    }
                },
                left: {
                    width: 0,
                    render: function(e, t) {
                        return ""
                    }
                },
                right: {
                    width: 0,
                    render: function(e, t) {
                        return ""
                    }
                }
            })
        }
        function xn(e) {
            var t = this;
            window.Chart.defaults.global.maintainAspectRatio = !1,
            this.visible = !1,
            this.loading = !1,
            this.tableView = e,
            this.el = $('<div style="position:absolute;top:0;left:0;width:100%;height:100%;background-color:#fff">'),
            this.$chart = $('<div style="position:absolute;top:16px;bottom:32px;left:16px;right:216px">').appendTo(this.el),
            this.$message = $('<div style="text-align:center;font-size:18px;padding:48px;color:#777">').appendTo(this.$chart),
            this.$canvas = $('<canvas style="position:absolute;top:0;left:0;width:100%;height:100%"></canvas>').appendTo(this.$chart),
            this.$pane = $('<div style="position:absolute;top:0;bottom:0;right:0;width:200px;background-color:#fff;border-left:solid 1px #D4D9E9">').appendTo(this.el),
            this.chartType = new util.SimpleModel(new schemas.TChoice(void 0, void 0, {
                choiceRenderer: "radio",
                caption: locale.chartType,
                formWidth: 1,
                required: !0,
                values: {
                    bar: {
                        id: "bar",
                        caption: locale.chartBar,
                        order: 1
                    },
                    line: {
                        id: "line",
                        caption: locale.chartLine,
                        order: 2
                    },
                    pie: {
                        id: "pie",
                        caption: locale.chartPie,
                        order: 3
                    },
                    doughnut: {
                        id: "doughnut",
                        caption: locale.chartDoughnut,
                        order: 4
                    },
                    polarArea: {
                        id: "polarArea",
                        caption: locale.chartPolarArea,
                        order: 5
                    },
                    radar: {
                        id: "radar",
                        caption: locale.chartRadar,
                        order: 6
                    },
                    bubble: {
                        id: "bubble",
                        caption: locale.chartBubble,
                        order: 7
                    }
                }
            })),
            this.chartType.on("update", (function() {
                t.settingsChanged()
            })),
            this.chartTypeField = new Ue.a(void 0, this.chartType, this.$pane),
            this.chartDatasets = new util.SimpleModel(new schemas.TChoice(void 0, void 0, {
                choiceRenderer: "radio",
                caption: locale.chartDatasets,
                formWidth: 1,
                required: !0,
                values: {
                    cols: {
                        id: "cols",
                        caption: locale.chartDatasetsCols,
                        order: 1
                    },
                    rows: {
                        id: "rows",
                        caption: locale.chartDatasetsRows,
                        order: 2
                    }
                }
            })),
            this.chartDatasets.on("update", (function() {
                t.settingsChanged()
            })),
            this.chartDatasetsField = new Ue.a(void 0, this.chartDatasets, this.$pane),
            this.chartStacked = new util.SimpleModel(new schemas.TBoolean(void 0, void 0, {
                booleanRenderer: "check",
                caption: locale.chartStacked,
                formWidth: 1,
                required: !0
            })),
            this.chartStacked.withoutLabel = !0,
            this.chartStacked.on("update", (function() {
                t.settingsChanged()
            })),
            this.chartStackedField = new Ue.a(void 0, this.chartStacked, this.$pane),
            this.chartLineTension = new util.SimpleModel(new schemas.TBoolean(void 0, void 0, {
                booleanRenderer: "check",
                caption: locale.chartLineTension,
                formWidth: 1,
                required: !0
            })),
            this.chartLineTension.withoutLabel = !0,
            this.chartLineTension.on("update", (function() {
                t.settingsChanged()
            })),
            this.chartLineTensionField = new Ue.a(void 0, this.chartLineTension, this.$pane),
            $('<div class="nx-button-text grey">').text(locale.showHideColumns).appendTo($('<div style="padding:0 12px">').appendTo(this.$pane)).touch((function() {
                e.popupColumnMenu()
            })),
            $('<div class="nx-button-text blue">').text(locale.saveImage + "...").appendTo($('<div style="padding:8px 12px 0px 12px">').appendTo(this.$pane)).click($.proxy(this.saveImage, this))
        }
        function Tn(e, t) {
            var i = Object.keys(e);
            if (Object.getOwnPropertySymbols) {
                var o = Object.getOwnPropertySymbols(e);
                t && (o = o.filter((function(t) {
                    return Object.getOwnPropertyDescriptor(e, t).enumerable
                }))),
                i.push.apply(i, o)
            }
            return i
        }
        function $n(e) {
            for (var t = 1; t < arguments.length; t++) {
                var i = null != arguments[t] ? arguments[t] : {};
                t % 2 ? Tn(Object(i), !0).forEach((function(t) {
                    K()(e, t, i[t])
                })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(i)) : Tn(Object(i)).forEach((function(t) {
                    Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(i, t))
                }))
            }
            return e
        }
        function Cn(e) {
            this.tableView = e,
            this.visible = !1,
            this.el = $('<div class="fullform">'),
            this.tabsEl = $('<div class="popupeditor2-tabs">').appendTo(this.el),
            this.editor = void 0
        }
        function kn(e) {
            var t = this;
            this.visible = e.visible || !1,
            this.renderHTML = e.render,
            this.leftWidth = 0,
            this.footHeight = 0,
            this.headHeight = 0,
            this.scrollDoneTime = 0,
            this.scrollDoneTimeout = null,
            this.scrollDone = $.proxy(this.scrollDone, this),
            this.$pane = $('<div class="scrollpane" style="display:' + (this.visible ? "" : "none") + '">').appendTo(e.$parent),
            this.$body = $('<div class="scrollpane-body">').appendTo(this.$pane),
            this.$view = $('<div class="scrollpane-view">').appendTo(this.$body),
            e.head && (this.$head = $('<div class="scrollpane-head" style="height:' + e.head.height + 'px">').appendTo(this.$pane), this.$headView = $('<div class="scrollpane-view">').appendTo(this.$head), this.$body.css("top", e.head.height), this.renderHeadHTML = e.head.render, this.headHeight = e.head.height),
            e.foot && (this.$foot = $('<div class="scrollpane-foot" style="height:' + e.foot.height + 'px">').appendTo(this.$pane), this.$footView = $('<div class="scrollpane-view">').appendTo(this.$foot), this.$body.css("bottom", e.foot.height), this.renderFootHTML = e.foot.render, this.footHeight = e.foot.height),
            e.left && (this.$left = $('<div class="scrollpane-left" style="width:' + e.left.width + 'px">').appendTo(this.$pane), this.$leftView = $('<div class="scrollpane-view">').appendTo(this.$left), this.$body.css("left", e.left.width), this.$head.css("left", e.left.width), this.$foot.css("left", e.left.width), this.renderLeftHTML = e.left.render, e.head && (this.renderLeftHeadHTML = e.left.renderHead, this.$left.css("top", e.head.height), this.$leftHead = $('<div class="scrollpane-left-head" style="width:' + e.left.width + "px;height:" + e.head.height + 'px">').appendTo(this.$pane), this.$leftHeadView = $('<div class="scrollpane-view">').appendTo(this.$leftHead)), e.foot && (this.renderLeftFootHTML = e.left.renderFoot, this.$left.css("bottom", e.foot.height), this.$leftFoot = $('<div class="scrollpane-left-foot" style="width:' + e.left.width + "px;height:" + e.foot.height + 'px">').appendTo(this.$pane), this.$leftFootView = $('<div class="scrollpane-view">').appendTo(this.$leftFoot)), this.leftWidth = e.left.width, !1 !== e.leftDivider && (this.$leftDivider = $('<div class="scrollpane-divider" style="left:' + e.left.width + 'px">').appendTo(this.$pane).nxdraggable({
                dragStart: function(e) {
                    this.w0 = t.leftWidth
                },
                drag: function(e) {
                    t.setLeftWidth(this.w0 + (e.x2 - e.x0))
                },
                dragEnd: function(e) {
                    t.leftWidthChanged()
                }
            }))),
            this.$scrollbarVContainer = $('<div class="t-scrollbar-v-container" style="top:0;bottom:0">').appendTo(this.$pane),
            this.$scrollbarV = $('<div class="t-scrollbar-v">').appendTo(this.$scrollbarVContainer),
            this.$scrollbarHContainer = $('<div class="t-scrollbar-h-container" style="left:0;bottom:0">').appendTo(this.$pane),
            this.$scrollbarH = $('<div class="t-scrollbar-h">').appendTo(this.$scrollbarHContainer),
            this.modX = e.modX,
            this.modY = e.modY,
            this.minX = 0,
            this.maxX = 0,
            this.minY = 0,
            this.maxY = 0,
            this.scrollX = 0,
            this.scrollY = 0,
            this.translateX = 0,
            this.translateY = 0,
            this.scrollXTarget = 0,
            this.scrollYTarget = 0,
            this.viewX0 = 0,
            this.viewX1 = 0,
            this.viewY0 = 0,
            this.viewY1 = 0,
            this.visibleWidth = 100,
            this.visibleHeight = 100,
            this.viewPaddingX = e.viewPaddingX || 200,
            this.viewPaddingY = e.viewPaddingY || 200,
            this.registerScrollListeners()
        }
        yn.prototype.hide = function() {
            this.visible && (this.visible = !1, this.$pane[0].style.display = "none")
        },
        yn.prototype.show = function() {
            this.visible || (this.visible = !0, this.$pane[0].style.display = "", this.rerender())
        },
        yn.prototype.destroy = function() {
            this.$pane.remove()
        },
        yn.prototype.setMetrics = function(e, t) {
            this.rows = e,
            this.totalWidth = t,
            this.updateRowOffsets(),
            this.visible && this.rerender()
        },
        yn.prototype.rerender = function() {
            this.resize(),
            this.renderHead(),
            this.renderFoot(),
            this.updateView(!0)
        },
        yn.prototype.resize = function() {
            var e = this.$body[0];
            this.visibleWidth = e.clientWidth,
            this.visibleHeight = e.clientHeight
        },
        yn.prototype.updateRowOffsets = function() {
            for (var e = this.rows, t = [], i = 0, o = 0; o < e.length; o++) {
                var n = e[o];
                t[o] = i,
                i += n
            }
            this.rowOffsets = t,
            this.totalHeight = i
        },
        yn.prototype.scrollTo = function(e, t) {
            this.scrollYTarget = Math.max(0, Math.min(t, this.totalHeight - this.visibleHeight)),
            this.scrollXTarget = null != this.totalWidth ? Math.max(0, Math.min(e, this.totalWidth - this.visibleWidth)) : e,
            this.startAnimation()
        },
        yn.prototype.startAnimation = function() {
            this.scrollX = this.scrollXTarget,
            this.scrollY = this.scrollYTarget,
            this.updateView(!1)
        },
        yn.prototype.updateView = function(e) {
            var t = this.visibleHeight,
                i = this.visibleWidth,
                o = this.totalHeight,
                n = this.totalWidth,
                s = this.viewY0,
                a = this.viewY1,
                r = this.scrollY,
                l = this.scrollX,
                c = r + t;
            null != n && l + i > n && (l = Math.max(0, n - i), this.scrollX = l),
            (e || r < s || c > a && c <= o) && (this.rerenderView(), s = this.viewY0, a = this.viewY1);
            var d = -l,
                h = -r + s;
            this.$view[0].style.transform = this.$view[0].style.webkitTransform = "translate3d(" + d + "px," + h + "px,0px)",
            this.$headView && (this.$headView[0].style.transform = this.$headView[0].style.webkitTransform = "translate3d(" + d + "px,0px,0px)"),
            this.$footView && (this.$footView[0].style.transform = this.$footView[0].style.webkitTransform = "translate3d(" + d + "px,0px,0px)"),
            this.updateScrollbar(!0)
        },
        yn.prototype.rerenderView = function() {
            this.rows;
            for (var e = this.rowOffsets, t = this.scrollY, i = t - 1e3, o = t + this.visibleHeight + 1e3, n = 0, s = e.length, a = 0; a < e.length; a++) {
                if (e[a] >= i) {
                    n = a;
                    break
                }
            }
            for (a = n; a < e.length; a++) {
                if (e[a] > o) {
                    s = a;
                    break
                }
            }
            this.viewRow0 = n,
            this.viewRow1 = s,
            this.viewY0 = e[n],
            this.viewY1 = s < e.length ? e[s] : this.totalHeight,
            this.renderView(n, s)
        },
        yn.prototype.renderView = async function(e, t) {
            this.$view[0].innerHTML = await this.renderHTML(e, t)
        },
        yn.prototype.renderHead = async function() {
            this.renderHeadHTML && (this.$headView[0].innerHTML = await this.renderHeadHTML())
        },
        yn.prototype.renderFoot = async function() {
            this.renderFootHTML && (this.$footView[0].innerHTML = await this.renderFootHTML())
        },
        yn.prototype.registerScrollListeners = function() {
            TOUCH ? (this.registerScrollTouchListeners(), this.registerScrollbarVTouchListeners()) : (this.registerScrollMouseListeners(), this.registerScrollbarVMouseListeners(), this.registerScrollbarHMouseListeners())
        },
        yn.prototype.registerScrollMouseListeners = function() {
            var e = this,
                t = e.$body[0];
            function i(t) {
                var i = Math.max(0, e.totalHeight - e.visibleHeight),
                    o = null != e.totalWidth ? Math.max(0, e.totalWidth - e.visibleWidth) : null,
                    n = (OSX_10_9_MODE ? -t.wheelDeltaY : t.deltaY) * (1 == t.deltaMode ? 32 : 2 == t.deltaMode ? window.getHeight() : 1),
                    s = OSX_10_9_MODE ? t.wheelDeltaX : -t.deltaX;
                Math.abs(s) > Math.abs(n) ? n = 0 : s = 0;
                var a = e.scrollY,
                    r = Math.min(Math.max(a + n, 0), i),
                    l = null != o ? Math.min(Math.max(0, e.scrollX - s), o) : e.scrollX - s;
                e.scrollTo(l, r),
                t.preventDefault()
            }
            OSX_10_9_MODE ? t.addEventListener("mousewheel", i, !1) : t.addEventListener("wheel", i, !1)
        },
        yn.prototype.registerScrollTouchListeners = function() {
            var e,
                t = this,
                i = 0,
                o = 0,
                n = 0,
                s = 0,
                a = 0,
                r = 0,
                l = 0,
                c = null,
                d = !1,
                h = 500 / 60,
                p = t.$body[0];
            function u() {
                if (d) {
                    var e = t.scrollY,
                        i = t.scrollX,
                        o = Math.max(0, t.totalHeight - t.visibleHeight);
                    if (e < 0) {
                        var n = e - 10 * e * h / 500;
                        Math.abs(n) < .1 && (n = 0),
                        t.scrollTo(i, n),
                        requestAnimationFrame(u)
                    } else if (0 === e)
                        d = !1;
                    else if (e > o) {
                        n = e - 10 * (e - o) * h / 500;
                        Math.abs(n - o) < .1 && (n = o),
                        t.scrollTo(i, n),
                        requestAnimationFrame(u)
                    } else if (e === o)
                        d = !1;
                    else if (l >= 500)
                        d = !1;
                    else {
                        var s = 1 - l * l / 25e4;
                        if (!isNaN(s)) {
                            var c = s * a,
                                p = s * r,
                                f = null != t.totalWidth ? Math.min(Math.max(0, i - c), Math.max(0, t.totalWidth - t.visibleWidth)) : i - c;
                            n = e - p;
                            t.scrollTo(f, n)
                        }
                        l += h,
                        requestAnimationFrame(u)
                    }
                }
            }
            p.addEventListener(EVENT_touchstart, (function(t) {
                1 === t.touches.length && (d = !1, i = n = t.touches[0].clientX, o = s = t.touches[0].clientY, e = (new Date).getTime(), c = null)
            })),
            p.addEventListener(EVENT_touchmove, (function(e) {
                if (e.touches && 1 === e.touches.length) {
                    d = !1;
                    var i = e.touches[0].clientX,
                        o = e.touches[0].clientY,
                        a = i - n,
                        r = o - s;
                    c || (c = Math.abs(a) > Math.abs(r) ? "H" : "V"),
                    "H" === c ? r = 0 : a = 0;
                    var l = null != t.totalWidth ? Math.min(Math.max(0, t.scrollX - a), Math.max(0, t.totalWidth - t.visibleWidth)) : t.scrollX - a,
                        h = t.scrollY - r;
                    t.scrollTo(l, h),
                    n = i,
                    s = o,
                    e.preventDefault()
                }
            })),
            p.addEventListener(EVENT_touchend, (function(p) {
                if (!p.touches || 0 === p.touches.length) {
                    var f = (new Date).getTime() - e;
                    a = "H" === c ? (n - i) * h / f : 0,
                    r = "V" === c ? t.scrollY < 0 ? 0 : (s - o) * h / f : 0,
                    l = 0,
                    d = !0,
                    requestAnimationFrame(u)
                }
            }))
        },
        yn.prototype.scrollDone = function() {
            var e = Date.now(),
                t = this.scrollDoneTime - e;
            t < 100 ? (this.$scrollbarV[0].className = "t-scrollbar-v", this.$scrollbarH[0].className = "t-scrollbar-h", this.scrollDoneTimeout = null) : this.scrollDoneTimeout = setTimeout(this.scrollDone, t)
        },
        yn.prototype.updateScrollbar = function(e) {
            var t = this.scrollY,
                i = this.scrollX,
                o = this.totalWidth,
                n = this.totalHeight - 0,
                s = o - 0,
                a = this.headHeight,
                r = (this.footHeight, this.leftWidth),
                l = this.visibleHeight,
                c = this.visibleWidth,
                d = n > l,
                h = s > c,
                p = l - (h ? 16 : 4),
                u = c - (d ? 24 : 12),
                f = Math.max(32, Math.min(p, Math.round(p * l / n))),
                m = Math.max(0, Math.min(p - f, Math.round((t - 0) / (n - l) * (p - f)))) + a + 2,
                g = Math.max(32, Math.min(u, Math.round(u * (c / s)))),
                v = Math.max(0, Math.min(u - g, Math.round((i - 0) / (s - c) * (u - g)))) + r + 10,
                b = this.$scrollbarV[0];
            b.style.top = m + "px",
            b.style.height = f + "px";
            var y = this.$scrollbarH[0];
            y.style.left = v + "px",
            y.style.width = g + "px",
            y.style.bottom = "2px",
            e && (b.className = d ? "t-scrollbar-v scrolling" : "t-scrollbar-v", y.className = h ? "t-scrollbar-h scrolling" : "t-scrollbar-h", this.scrollDoneTime = Date.now() + 1e3, this.scrollDoneTimeout || (this.scrollDoneTimeout = setTimeout(this.scrollDone, 1e3)))
        },
        yn.prototype.registerScrollbarVMouseListeners = function() {
            var e = this;
            this.$scrollbarV[0].addEventListener("mousedown", (function(t) {
                t.target;
                var i = t.clientY,
                    o = e.scrollY,
                    n = e.visibleHeight,
                    s = n - 4,
                    a = e.totalHeight - 0,
                    r = a / s;
                function l(t) {
                    var s = t.clientY - i;
                    e.scrollTo(e.scrollX, Math.max(0, Math.min(0 + a - n, Math.round(o + r * s)))),
                    t.preventDefault()
                }
                window.addEventListener("mouseup", (function e(t) {
                    window.removeEventListener("mousemove", l, !1),
                    window.removeEventListener("mouseup", e, !1),
                    t.preventDefault()
                }), !1),
                window.addEventListener("mousemove", l, !1),
                t.preventDefault()
            }), !1)
        },
        yn.prototype.registerScrollbarVTouchListeners = function() {
            var e = this;
            this.$scrollbarV[0].addEventListener(EVENT_touchstart, (function(t) {
                if (1 !== t.touches.length)
                    return;
                var i = t.touches[0].clientY,
                    o = e.scrollY,
                    n = e.visibleHeight,
                    s = n - 4,
                    a = e.totalHeight,
                    r = a - 0,
                    l = r / s;
                function c(t) {
                    if (1 === t.touches.length) {
                        var s = t.touches[0].clientY - i;
                        e.scrollTo(e.scrollY, Math.max(0, Math.min(0 + r - n, Math.round(o + l * s)))),
                        t.preventDefault()
                    }
                }
                EVENT_target(t).addEventListener(EVENT_touchmove, c, !1),
                EVENT_target(t).addEventListener(EVENT_touchend, (function e(t) {
                    0 === t.touches.length && (EVENT_target(t).removeEventListener(EVENT_touchmove, c, !1), EVENT_target(t).removeEventListener(EVENT_touchend, e, !1), t.preventDefault())
                }), !1)
            }), !1)
        },
        yn.prototype.registerScrollbarHMouseListeners = function() {
            var e = this;
            this.$scrollbarH[0].addEventListener("mousedown", (function(t) {
                var i = t.clientX,
                    o = e.scrollX,
                    n = e.visibleWidth,
                    s = n - 4,
                    a = e.totalWidth - 0,
                    r = a / s;
                function l(t) {
                    var s = t.clientX - i;
                    e.scrollTo(Math.max(0, Math.min(0 + a - n, Math.round(o + r * s))), e.scrollY),
                    t.preventDefault()
                }
                window.addEventListener("mouseup", (function e(t) {
                    window.removeEventListener("mousemove", l, !1),
                    window.removeEventListener("mouseup", e, !1),
                    t.preventDefault()
                }), !1),
                window.addEventListener("mousemove", l, !1),
                t.preventDefault()
            }), !1)
        },
        yn.prototype.createScrollBars = function() {
            this.$scrollbarVContainer = $('<div class="t-scrollbar-v-container" style="top:0;bottom:0">').appendTo(this.$pane),
            this.$scrollbarV = $('<div class="t-scrollbar-v">').appendTo(this.$scrollbarVContainer),
            this.$scrollbarHContainer = $('<div class="t-scrollbar-h-container" style="left:0;bottom:0">').appendTo(this.$pane),
            this.$scrollbarH = $('<div class="t-scrollbar-h">').appendTo(this.$scrollbarHContainer)
        },
        Object.assign(wn.prototype, bn.prototype),
        wn.prototype.isCards = !0,
        wn.prototype.mode = "cards",
        wn.prototype.didShow = function(e) {
            this.updateMetrics(),
            this.scrollPane.show(e)
        },
        wn.prototype.didHide = function(e) {
            this.scrollPane.hide()
        },
        wn.prototype.updateUI = function() {
            this.visible && this.scrollPane.updateView(!0)
        },
        wn.prototype.dataChanged = function() {
            this.visible && this.updateUI()
        },
        wn.prototype.rowsChanged = function() {
            this.visible && this.updateMetrics()
        },
        wn.prototype.renderHTML = async function(e, t) {
            var i = Date.now(),
                o = this.getSelectedNid(),
                n = this.getQuery();
            if (!n.ready)
                return "";
            var s = n.rows,
                a = n.cols,
                r = n.models,
                l = n.groups || {},
                c = n.cidxGroup,
                d = null != c ? a[c] : void 0;
            if (d && !d.isReadable)
                return '<h1 style="padding:16px;margin:0 auto">' + htmlEscape(locale.errorNotAuthorized) + "</h1>";
            for (var h = d && d.expression.returnType, p = this.cardsPerRow, u = this.cardMargin, f = this.cardHeight, m = this.cardWidth, g = (t + 1) * p, v = "", b = 0, y = e % 2 == 0 ? u : 0, w = e * p; w < g && w < s.length; w++) {
                var x = s[w],
                    T = r[x];
                if (T) {
                    var $ = "position:absolute;width:" + m + "px;height:" + f + "px;left:" + (u + b * (m + u)) + "px;top:" + y + "px",
                        C = x === o ? " selected" : "";
                    v += await this.renderCard(T, a, c, C, $, !1),
                    ++b === p && (b = 0, y += f + u)
                } else {
                    var k = l[x];
                    if (k) {
                        b > 0 && (b = 0, y += f + u);
                        var S = k.values[c],
                            E = this.getGroupColor(h, S),
                            _ = this.getGroupIcon(h, S),
                            D = !!n.expanded[x];
                        v += '<div class="card-group" style="position:absolute;left:' + u + "px;top:" + y + "px;width:" + (p * (m + u) - u) + "px;background-color:" + E.light + '" data-gid="' + encodeURIComponent(k.id) + '"><div class="card-group-expander i-white i-32-24 i-line-' + (D ? "down" : "right") + '"></div><div class="card-group-title">' + (_ ? '<div class="card-group-icon ic ic-' + _ + '"></div>' : "") + '<div class="card-group-label">' + htmlEscape(h.format(S)) + '</div></div><div class="card-group-right"></div></div>',
                        b = 0,
                        y += 32 + u
                    }
                }
            }
            var M = Date.now();
            return console.log("Cards.renderHTML in " + (M - i) + "ms"), v
        },
        wn.prototype.queryLoaded = function() {
            this.updateMetrics()
        },
        wn.prototype.updateMetrics = function() {
            if (this.visible) {
                var e = this.scrollPane.totalWidth > 0 ? this.scrollPane.scrollX / this.scrollPane.totalWidth : 0,
                    t = this.scrollPane.totalHeight > 0 ? this.scrollPane.scrollY / this.scrollPane.totalHeight : 0,
                    i = this.getQuery(),
                    o = i.rows,
                    n = i.cols,
                    s = (i.models, i.groups || {}),
                    a = i.cidxGroup,
                    r = 0;
                n.length > 0 && "file" === n[0].expression.returnType.base || (r += 16);
                for (var l = 0; l < n.length; l++) {
                    if (l !== a)
                        switch (n[l].expression.returnType.base) {
                        case "file":
                            r += 128;
                            break;
                        default:
                            r += 24
                        }
                }
                n.length > 0 && "file" === n[n.length - 1].expression.returnType.base || (r += 16);
                for (var c = ui.bodyWidth + (ui.rightVisible ? 0 : ui.rightWidth), d = this.el[0].clientHeight, h = Math.max(1, Math.floor((c - 16) / 212)), p = Math.max(196, Math.floor((c - 16 * (h + 1)) / h)), u = [], f = r + 16, m = 0, g = 0, v = 0; v < o.length; v++) {
                    s[o[v]] ? (m > 0 && (u[g] = f, g++, m = 0), u[g] = 48, g++, m = 0) : (0 === m && (u[g] = f), ++m === h && (m = 0, g++))
                }
                m > 0 && g++,
                u[g] = 16,
                this.width = c,
                this.cardMargin = 16,
                this.cardMinWidth = 196,
                this.cardWidth = p,
                this.cardHeight = r,
                this.cardsPerRow = h,
                this.viewRowHeights = u,
                this.groupRowHeight = 48,
                this.rowHeight = f,
                this.scrollPane.setMetrics(u, h * p + 16 * (h + 1));
                var b = Math.max(0, Math.min(this.scrollPane.totalWidth - c, Math.round(e * this.scrollPane.totalWidth))),
                    y = Math.max(0, Math.min(this.scrollPane.totalHeight - d, Math.round(t * this.scrollPane.totalHeight)));
                this.scrollPane.scrollTo(b, y)
            }
        },
        wn.prototype.bodyResized = function() {
            this.visible && this.updateMetrics()
        },
        wn.prototype.clicked = function(e) {
            var t = $(e.target).closest(".card").attr("data-nid");
            if (t)
                this.select(t);
            else {
                var i = $(e.target).closest(".card-group").attr("data-gid");
                i && (i = decodeURIComponent(i), this.toggleGroup(i), this.updateMetrics())
            }
        },
        wn.prototype.renderCard = async function(e, t, i, o, n, s) {
            var a = '<div class="card' + (o || "") + '" data-nid="' + e.id + '"' + (n ? ' style="' + n + '"' : "") + ">";
            t.length > 0 && "file" === t[0].expression.returnType.base && (e.values[0] || !s) || (a += '<div class="card-padding-top"></div>');
            for (var r = 0; r < t.length; r++)
                if (r !== i) {
                    var l = t[r];
                    if (l.isReadable) {
                        var c = l.field,
                            d = c.base,
                            h = e.values[r],
                            p = "",
                            u = "",
                            f = 0 === i ? 1 === r : 0 === r,
                            m = !f;
                        if (!s || null != h) {
                            switch (d) {
                            case "choice":
                            case "dchoice":
                                {
                                    m = !1;
                                    const t = await new Promise(t => c.loadValue(e.id, h, t));
                                    t && (p = '<div class="card-row-value multicombo-item" style="' + (t.color ? "background-color:" + t.color + ";color:" + util.contrastingTextColorTo(t.color) : "") + '">' + (t.icon ? '<div class="choice-symbol ic ic-' + t.icon + '"></div>' : "") + "<span>" + htmlEscape(t.caption || "") + "</span></div>");
                                    break
                                }case "multi":
                            case "dmulti":
                                m = !1;
                                var g = util.multiDecode(h);
                                if (g) {
                                    const t = await new Promise(t => c.loadValues(e.id, (e, i) => t(i || {})));
                                    g.sort((function(e, i) {
                                        var o = t[e],
                                            n = t[i];
                                        return o ? n ? o.order - n.order : -1 : 0
                                    }));
                                    for (var v = 0; v < g.length; v++) {
                                        var b = t[g[v]];
                                        b && (p += '<div class="card-row-value multicombo-item" style="margin:0 4px 0 0;' + (b.color ? "background-color:" + b.color + ";color:" + util.contrastingTextColorTo(b.color) : "") + '">' + (b.icon ? '<div class="choice-symbol ic ic-' + b.icon + '"></div>' : "") + "<span>" + htmlEscape(b.caption || "") + "</span></div>")
                                    }
                                }
                                break;
                            case "color":
                                m = !1,
                                h && (p = '<div class="card-row-value" style="width:20px;height:20px;border-radius:10px;margin:2px 0;background-color:' + h + '"></div>');
                                break;
                            case "icon":
                                m = !1,
                                h && (p = '<div class="choice-symbol ic ic-' + h + '"></div>');
                                break;
                            case "styled":
                                m = !1,
                                h && (p = '<div class="card-row-value multicombo-item" style="background-color:' + h.background + ";color:" + h.color + '">' + (h.icon ? '<div class="choice-symbol ic ic-' + h.icon + '"></div>' : "") + "<span>" + htmlEscape(h.text || "") + "</span></div>");
                                break;
                            case "file":
                                if (m = !1, h) {
                                    var y = database.thumb2URL1(h);
                                    y && (p = " ", u = "background-image:url('" + y + "')")
                                }
                                break;
                            default:
                                p = '<div class="card-row-value">' + htmlEscape(c.format(h)) + "</div>"
                            }
                            a += '<div class="card-row card-row-' + d + (f ? " card-header" : "") + '"' + (u ? ' style="' + u + '"' : "") + ">" + (m ? '<div class="card-row-label">' + htmlEscape(l.caption || l.expression.caption) + ": </div>" : "") + p + "</div>"
                        }
                    }
                }
            return t.length > 0 && "file" === t[t.length - 1].expression.returnType.base && (e.values[t.length - 1] || !s) || (a += '<div class="card-padding-bottom"></div>'), a += "</div>"
        },
        wn.prototype.getGroupColor = function(e, t) {
            var i = "#D4D5DB";
            if ("choice" === e.base) {
                var o = e.getValues()[t];
                o && o.color && (i = o.color)
            } else
                "styled" === e.base && t && t.background && (i = t.background);
            return {
                light: i,
                dark: util.darken(i, .9)
            }
        },
        wn.prototype.getGroupIcon = function(e, t) {
            if ("choice" === e.base) {
                var i = e.getValues()[t];
                return i && i.icon || void 0
            }
            return "styled" === e.base && t && t.icon || void 0
        },
        wn.prototype.updateSelection = function() {
            var e = this.getSelectedNid();
            this.scrollPane.$view.children(".selected").removeClass("selected"),
            this.scrollPane.$view.children('[data-nid="' + e + '"]').addClass("selected")
        },
        xn.prototype.isChart = !0,
        xn.prototype.mode = "chart",
        xn.prototype.destroy = function() {
            this.visible && (this.visible = !1, $.popInputHandler(this)),
            this.chart && (this.chart.destroy(), this.chart = void 0),
            this.el.remove()
        },
        xn.prototype.setVisible = function(e) {
            e ? this.show() : this.hide()
        },
        xn.prototype.show = function() {
            this.visible || (this.visible = !0, $.pushInputHandler(this), this.el.appendTo(ui.$body)),
            this.loadSettings(),
            this.updateControls(),
            this.updateUI()
        },
        xn.prototype.hide = function() {
            this.visible && (this.visible = !1, this.chart && (this.chart.destroy(), this.chart = void 0), $.popInputHandler(this), this.el.detach())
        },
        xn.prototype.loadSettings = function() {
            this.loading = !0,
            this.chartType.setValue(this.tableView.getViewProperty("chartType") || "bar"),
            this.chartDatasets.setValue(this.tableView.getViewProperty("chartDatasets") || "cols"),
            this.chartStacked.setValue(this.tableView.getViewProperty("chartStacked") || !1),
            this.chartLineTension.setValue(this.tableView.getViewProperty("chartLineTension") || !1),
            this.loading = !1
        },
        xn.prototype.saveSettings = function() {
            this.tableView.setViewProperties({
                chartType: this.chartType.value,
                chartDatasets: this.chartDatasets.value,
                chartStacked: this.chartStacked.value,
                chartLineTension: this.chartLineTension.value
            })
        },
        xn.prototype.settingsChanged = function() {
            this.loading || (this.saveSettings(), this.updateControls(), this.updateUI())
        },
        xn.prototype.updateControls = function() {
            var e = this.chartType.value;
            "bar" === e || "line" === e ? this.chartStackedField.show() : this.chartStackedField.hide(),
            "line" === e ? this.chartLineTensionField.show() : this.chartLineTensionField.hide(),
            "bubble" !== e ? this.chartDatasetsField.show() : this.chartDatasetsField.hide()
        },
        xn.prototype.updateUI = function() {
            if (this.visible) {
                this.chart && (this.chart.destroy(), this.chart = void 0),
                this.$message.text("");
                try {
                    this.chart = Ft({
                        query: this.tableView.table,
                        chartType: this.chartType.value,
                        chartDatasets: this.chartDatasets.value,
                        chartStacked: this.chartStacked.value,
                        chartLineTension: this.chartLineTension.value,
                        animationDuration: 1e3,
                        $canvas: this.$canvas
                    }),
                    this.chart.resize()
                } catch (e) {
                    this.$message.text(e)
                }
            }
        },
        xn.prototype.saveImage = async function() {
            var e,
                t = util.escapeFileName(this.tableView.table.type.caption + " " + this.tableView.getViewCaption());
            try {
                var i = this.$canvas[0].toDataURL();
                i || $.alert("Cannot render PNG");
                var o = i.indexOf(",");
                if (o < 0)
                    return $.alert("Cannot render PNG: Invalid data URL");
                e = i.substr(o + 1),
                NinoxDocumentInteraction.openFileWithServer(t, "image/png", e, !0, !0)
            } catch (e) {
                return void $.alert(e)
            }
        },
        xn.prototype.menuNewViewEnabled = function() {
            return database.isAdmin()
        },
        xn.prototype.menuNewView = function() {
            database.isAdmin() && this.tableView.createView()
        },
        xn.prototype.menuRenameViewEnabled = function() {
            return database.isAdmin()
        },
        xn.prototype.menuRenameView = function() {
            database.isAdmin() && this.tableView.renameView()
        },
        xn.prototype.menuDeleteViewEnabled = function() {
            return database.isAdmin()
        },
        xn.prototype.menuDeleteView = function() {
            database.isAdmin() && this.tableView.removeView()
        },
        xn.prototype.menuEditColumnsEnabled = function() {
            return database.isAdmin()
        },
        xn.prototype.menuEditColumns = function() {
            database.isAdmin() && this.tableView.popupColumnMenu()
        },
        xn.prototype.menuShowViewAsFormEnabled = function() {
            return database.isAdmin()
        },
        xn.prototype.menuShowViewAsForm = function() {
            database.isAdmin() && this.tableView.showForm()
        },
        xn.prototype.menuShowViewAsTableEnabled = function() {
            return database.isAdmin()
        },
        xn.prototype.menuShowViewAsTable = function() {
            database.isAdmin() && this.tableView.showTable()
        },
        xn.prototype.menuShowViewAsChartEnabled = function() {
            return database.isAdmin()
        },
        xn.prototype.menuShowViewAsChart = function() {
            database.isAdmin() && this.tableView.showChart()
        },
        xn.prototype.selectionChanged = function() {},
        xn.prototype.queryLoaded = function() {
            this.visible && this.updateUI()
        },
        xn.prototype.dataChanged = function() {
            this.visible && this.updateUI()
        },
        xn.prototype.rowsChanged = function() {
            this.visible && this.updateUI()
        },
        xn.prototype.bodyResized = function() {
            this.visible && this.chart && this.chart.resize()
        },
        Object.assign(Cn.prototype, bn.prototype),
        Cn.prototype.mode = "full",
        Cn.prototype.didShow = function() {
            this.updateTools(),
            ui.on("widgets.tools.updated", this.updateTools, this)
        },
        Cn.prototype.didHide = function(e) {
            ui.off("widgets.tools.updated", this.updateTools, this),
            this.updateTools(),
            this.editor && (this.editor.destroy(), this.editor = void 0)
        },
        Cn.prototype.nodeRenamed = function(e, t, i) {},
        Cn.prototype.nodeRemoved = function(e, t) {},
        Cn.prototype.schemaChanged = function(e, t, i) {
            this.visible && this.updateStructure()
        },
        Cn.prototype.adminChanged = function(e, t) {
            this.visible && this.updateStructure()
        },
        Cn.prototype.updateStructure = function() {
            if (this.visible) {
                var e = this;
                if (e.editor) {
                    e.editor.updateStructure();
                    var t = e.getSelectedNid();
                    t !== xe().nid && be($n({}, xe(), {
                        nid: t
                    })),
                    database.loadNode(t, (function(t, i) {
                        e.editor.bind(i)
                    }))
                }
                e.updateTools()
            }
        },
        Cn.prototype.updateBackground = function(e) {
            var t = util.luminosity(e) < .5;
            this.el.css("background-color", e || "#FFF"),
            this.el.toggleClass("darkmode", t)
        },
        Cn.prototype.createEditor = function(e) {
            this.editor && this.editor.tid !== e && (this.editor.destroy(), this.editor = void 0),
            this.editor || (this.editor = new ci(this, e, {}, void 0))
        },
        Cn.prototype.editorTabChanged = function(e) {
            const t = xe();
            t.tabId !== e && be($n({}, t, {
                tabId: e
            }))
        },
        Cn.prototype.destroyEditor = function() {
            console.log("FullForm.destroyEditor"),
            this.editor && (this.editor.destroy(), this.editor = void 0)
        },
        Cn.prototype.openEditor = function(e) {
            if (this.visible) {
                var t = this;
                if (e) {
                    var i = (t._loadingId || 0) + 1;
                    t._loadingId = i,
                    console.log("FullForm.openEditor: " + e, i),
                    $.loading(!0),
                    database.loadNode(e, (function(o, n) {
                        $.loading(!1),
                        console.log("FullForm.openEditor: " + e, i, " go on ", t._loadingId),
                        t._loadingId === i && (t.createEditor(schemas.tidOf(e)), e === t.getSelectedNid() && (n ? (t.editor.bind(n), e !== xe().nid && be($n({}, xe(), {
                            nid: e
                        }))) : t.destroyEditor()))
                    }))
                } else
                    t.destroyEditor()
            }
        },
        Cn.prototype.queryLoaded = function() {
            this.visible && (this.getSelectedNid() || this.editorFirst())
        },
        Cn.prototype.isOnTop = function() {
            return !widgets.popupEditorStack.length
        },
        Cn.prototype.showTools = fi.prototype.showTools,
        Cn.prototype.hideTools = fi.prototype.hideTools,
        Cn.prototype.updateTools = function() {
            database.adminMode && this.visible && this.isOnTop() ? this.showTools() : this.hideTools()
        },
        Object.assign(kn.prototype, util.events),
        kn.prototype.hide = function() {
            this.visible && (this.visible = !1, this.$pane[0].style.display = "none")
        },
        kn.prototype.show = function() {
            this.visible || (this.visible = !0, this.$pane[0].style.display = "", this.rerender())
        },
        kn.prototype.destroy = function() {
            this.$pane.remove()
        },
        kn.prototype.setMetrics = function(e, t, i, o) {
            this.minX = e,
            this.minY = t,
            this.maxX = i,
            this.maxY = o,
            this.visible && this.rerender()
        },
        kn.prototype.rerender = function() {
            this.resize(),
            this.updateView(!0)
        },
        kn.prototype.resize = function() {
            var e = this.$body[0];
            this.visibleWidth = e.clientWidth,
            this.visibleHeight = e.clientHeight,
            this.updateScrollbar(!0)
        },
        kn.prototype.scrollTo = function(e, t) {
            this.scrollXTarget = Math.max(this.minX, Math.min(e, this.maxX - this.visibleWidth)),
            this.scrollYTarget = Math.max(this.minY, Math.min(t, this.maxY - this.visibleHeight)),
            this.startAnimation()
        },
        kn.prototype.startAnimation = function() {
            this.scrollX = this.scrollXTarget,
            this.scrollY = this.scrollYTarget,
            this.updateView(!1)
        },
        kn.prototype.updateView = function(e) {
            this.scrollX < this.minX && (this.scrollX = this.minX),
            this.scrollX + this.visibleWidth > this.maxX && (this.scrollX = Math.max(this.minX, this.maxX - this.visibleWidth)),
            this.scrollY < this.minY && (this.scrollY = this.minY),
            this.scrollY + this.visibleHeight > this.maxY && (this.scrollY = Math.max(this.minY, this.maxY - this.visibleHeight)),
            (e || this.scrollY < this.viewY0 || this.scrollY + this.visibleHeight > this.viewY1 || this.scrollX < this.viewX0 || this.scrollX + this.visibleWidth > this.viewX1) && this.renderView();
            var t = -this.scrollX + this.viewX0,
                i = -this.scrollY + this.viewY0;
            this.translateX = t,
            this.translateY = i,
            this.$view[0].style.transform = this.$view[0].style.webkitTransform = "translate3d(" + t + "px," + i + "px,0px)",
            this.$headView && (this.$headView[0].style.transform = this.$headView[0].style.webkitTransform = "translate3d(" + t + "px,0px,0px)"),
            this.$footView && (this.$footView[0].style.transform = this.$footView[0].style.webkitTransform = "translate3d(" + t + "px,0px,0px)"),
            this.$leftView && (this.$leftView[0].style.transform = this.$leftView[0].style.webkitTransform = "translate3d(0px," + i + "px,0px)"),
            this.updateScrollbar(!0)
        },
        kn.prototype.renderView = async function() {
            var e = this.scrollX - this.viewPaddingX,
                t = this.scrollX + this.visibleWidth + this.viewPaddingX,
                i = this.scrollY - this.viewPaddingY,
                o = this.scrollY + this.visibleHeight + this.viewPaddingY;
            e -= e % this.modX,
            i -= i % this.modY,
            this.viewX0 = e,
            this.viewY0 = i,
            this.viewX1 = t,
            this.viewY1 = o,
            this.$view[0].innerHTML = await this.renderHTML(this.viewX0, this.viewY0, this.viewX1, this.viewY1),
            this.renderLeftHeadHTML && (this.$leftHeadView[0].innerHTML = await this.renderLeftHeadHTML()),
            this.renderLeftFootHTML && (this.$leftFootView[0].innerHTML = await this.renderLeftFootHTML()),
            this.renderLeftHTML && (this.$leftView[0].innerHTML = await this.renderLeftHTML(this.viewY0, this.viewY1)),
            this.renderHeadHTML && (this.$headView[0].innerHTML = await this.renderHeadHTML(this.viewX0, this.viewX1)),
            this.renderFootHTML && (this.$footView[0].innerHTML = await this.renderFootHTML(this.viewX0, this.viewX1))
        },
        kn.prototype.registerScrollListeners = function() {
            TOUCH ? (this.registerScrollTouchListeners(), this.registerScrollbarVTouchListeners()) : (this.registerScrollMouseListeners(), this.registerScrollbarVMouseListeners(), this.registerScrollbarHMouseListeners())
        },
        kn.prototype.registerScrollMouseListeners = function() {
            var e = this,
                t = e.$pane[0];
            function i(t) {
                var i = e.minX,
                    o = e.minY,
                    n = Math.max(e.minX, e.maxX - e.visibleWidth),
                    s = Math.max(e.minY, e.maxY - e.visibleHeight),
                    a = (OSX_10_9_MODE ? -t.wheelDeltaY : t.deltaY) * (1 == t.deltaMode ? 32 : 2 == t.deltaMode ? window.getHeight() : 1),
                    r = OSX_10_9_MODE ? -t.wheelDeltaX : t.deltaX;
                Math.abs(r) > Math.abs(a) ? a = 0 : r = 0;
                var l = e.scrollY,
                    c = Math.min(Math.max(l + a, o), s),
                    d = e.scrollX,
                    h = Math.min(Math.max(d + r, i), n);
                e.scrollTo(h, c),
                t.preventDefault()
            }
            OSX_10_9_MODE ? t.addEventListener("mousewheel", i, !1) : t.addEventListener("wheel", i, !1)
        },
        kn.prototype.registerScrollTouchListeners = function() {
            var e,
                t = this,
                i = 0,
                o = 0,
                n = 0,
                s = 0,
                a = 0,
                r = 0,
                l = 0,
                c = null,
                d = !1,
                h = 500 / 60,
                p = t.$pane[0];
            function u() {
                if (d) {
                    var e = t.scrollY,
                        i = t.scrollX,
                        o = Math.max(0, t.totalHeight - t.visibleHeight);
                    if (e < 0) {
                        var n = e - 10 * e * h / 500;
                        Math.abs(n) < .1 && (n = 0),
                        t.scrollTo(i, n),
                        requestAnimationFrame(u)
                    } else if (0 === e)
                        d = !1;
                    else if (e > o) {
                        n = e - 10 * (e - o) * h / 500;
                        Math.abs(n - o) < .1 && (n = o),
                        t.scrollTo(i, n),
                        requestAnimationFrame(u)
                    } else if (e === o)
                        d = !1;
                    else if (l >= 500)
                        d = !1;
                    else {
                        var s = 1 - l * l / 25e4;
                        if (!isNaN(s)) {
                            var c = s * a,
                                p = s * r,
                                f = null != t.totalWidth ? Math.min(Math.max(0, i - c), Math.max(0, t.totalWidth - t.visibleWidth)) : i - c;
                            n = e - p;
                            t.scrollTo(f, n)
                        }
                        l += h,
                        requestAnimationFrame(u)
                    }
                }
            }
            p.addEventListener(EVENT_touchstart, (function(t) {
                1 === t.touches.length && (d = !1, i = n = t.touches[0].clientX, o = s = t.touches[0].clientY, e = (new Date).getTime(), c = null)
            })),
            p.addEventListener(EVENT_touchmove, (function(e) {
                if (e.touches && 1 === e.touches.length) {
                    d = !1;
                    var i = e.touches[0].clientX,
                        o = e.touches[0].clientY,
                        a = i - n,
                        r = o - s;
                    c || (c = Math.abs(a) > Math.abs(r) ? "H" : "V"),
                    "H" === c ? r = 0 : a = 0;
                    var l = t.scrollX - a,
                        h = t.scrollY - r;
                    t.scrollTo(l, h),
                    n = i,
                    s = o,
                    e.preventDefault()
                }
            })),
            p.addEventListener(EVENT_touchend, (function(p) {
                if (!p.touches || 0 === p.touches.length) {
                    var f = (new Date).getTime() - e;
                    a = "H" === c ? (n - i) * h / f : 0,
                    r = "V" === c ? t.scrollY < 0 ? 0 : (s - o) * h / f : 0,
                    l = 0,
                    d = !0,
                    requestAnimationFrame(u)
                }
            }))
        },
        kn.prototype.setLeftWidth = function(e) {
            e > 32 && e < this.$pane[0].clientWidth - 32 && (this.leftWidth = e, this.$left.css("width", e), this.$leftHead.css("width", e), this.$leftFoot.css("width", e), this.$head.css("left", e), this.$foot.css("left", e), this.$body.css("left", e), this.$leftDivider && this.$leftDivider.css("left", e))
        },
        kn.prototype.leftWidthChanged = function() {
            this.trigger("leftWidthChanged")
        },
        kn.prototype.updateScrollbar = function(e) {
            var t = this.scrollY,
                i = this.scrollX,
                o = this.minX,
                n = this.minY,
                s = this.maxX,
                a = this.maxY - n,
                r = s - o,
                l = this.headHeight,
                c = (this.footHeight, this.leftWidth),
                d = this.visibleHeight,
                h = this.visibleWidth,
                p = a > d,
                u = r > h,
                f = d - 4,
                m = h - (p ? 24 : 12),
                g = Math.max(32, Math.min(f, Math.round(f * d / a))),
                v = Math.max(0, Math.min(f - g, Math.round((t - n) / (a - d) * (f - g)))) + l + 2,
                b = Math.max(32, Math.min(m, Math.round(m * (h / r)))),
                y = Math.max(0, Math.min(m - b, Math.round((i - o) / (r - h) * (m - b)))) + c + 10,
                w = this.$scrollbarV[0];
            w.style.top = v + "px",
            w.style.height = g + "px";
            var x = this.$scrollbarH[0];
            x.style.left = y + "px",
            x.style.width = b + "px",
            x.style.bottom = "2px",
            e && (w.className = p ? "t-scrollbar-v scrolling" : "t-scrollbar-v", x.className = u ? "t-scrollbar-h scrolling" : "t-scrollbar-h", this.scrollDoneTime = Date.now() + 1e3, this.scrollDoneTimeout || (this.scrollDoneTimeout = setTimeout(this.scrollDone, 1e3)))
        },
        kn.prototype.scrollDone = function() {
            var e = Date.now(),
                t = this.scrollDoneTime - e;
            t < 100 ? (this.$scrollbarV[0].className = "t-scrollbar-v", this.$scrollbarH[0].className = "t-scrollbar-h", this.scrollDoneTimeout = null) : this.scrollDoneTimeout = setTimeout(this.scrollDone, t)
        },
        kn.prototype.registerScrollbarVMouseListeners = function() {
            var e = this;
            this.$scrollbarV[0].addEventListener("mousedown", (function(t) {
                t.target;
                var i = t.clientY,
                    o = e.scrollY,
                    n = e.visibleHeight,
                    s = n - 4,
                    a = e.maxY,
                    r = e.minY,
                    l = a - r,
                    c = l / s;
                function d(t) {
                    var s = t.clientY - i;
                    e.scrollTo(e.scrollX, Math.max(r, Math.min(r + l - n, Math.round(o + c * s)))),
                    t.preventDefault()
                }
                window.addEventListener("mouseup", (function e(t) {
                    window.removeEventListener("mousemove", d, !1),
                    window.removeEventListener("mouseup", e, !1),
                    t.preventDefault()
                }), !1),
                window.addEventListener("mousemove", d, !1),
                t.preventDefault()
            }), !1)
        },
        kn.prototype.registerScrollbarVTouchListeners = function() {
            var e = this;
            this.$scrollbarV[0].addEventListener(EVENT_touchstart, (function(t) {
                if (1 !== t.touches.length)
                    return;
                var i = t.touches[0].clientY,
                    o = e.scrollY,
                    n = e.visibleHeight,
                    s = n - 4,
                    a = e.maxY,
                    r = e.minY,
                    l = a - r,
                    c = l / s;
                function d(t) {
                    if (1 === t.touches.length) {
                        var s = t.touches[0].clientY - i;
                        e.scrollTo(e.scrollY, Math.max(r, Math.min(r + l - n, Math.round(o + c * s)))),
                        t.preventDefault()
                    }
                }
                EVENT_target(t).addEventListener(EVENT_touchmove, d, !1),
                EVENT_target(t).addEventListener(EVENT_touchend, (function e(t) {
                    0 === t.touches.length && (EVENT_target(t).removeEventListener(EVENT_touchmove, d, !1), EVENT_target(t).removeEventListener(EVENT_touchend, e, !1), t.preventDefault())
                }), !1)
            }), !1)
        },
        kn.prototype.registerScrollbarHMouseListeners = function() {
            var e = this;
            this.$scrollbarH[0].addEventListener("mousedown", (function(t) {
                var i = t.clientX,
                    o = e.scrollX,
                    n = e.visibleWidth,
                    s = n - 4,
                    a = e.minX,
                    r = e.maxX - a,
                    l = r / s;
                function c(t) {
                    var s = t.clientX - i;
                    e.scrollTo(Math.max(a, Math.min(a + r - n, Math.round(o + l * s))), e.scrollY),
                    t.preventDefault()
                }
                window.addEventListener("mouseup", (function e(t) {
                    window.removeEventListener("mousemove", c, !1),
                    window.removeEventListener("mouseup", e, !1),
                    t.preventDefault()
                }), !1),
                window.addEventListener("mousemove", c, !1),
                t.preventDefault()
            }), !1)
        };
        const Sn = 6e4,
            En = 6048e5,
            _n = 2592e6,
            Dn = 31536e6;
        function Mn(e) {
            var t = this;
            this.tableView = e,
            this.visible = !1,
            this.resize = $.proxy(this.resize, this),
            this.el = $('<div class="gantt-container">'),
            this.$controls = $('<div class="hud-menu-group">'),
            this.$smallControlsContainer = $('<div class="gantt-controls">'),
            this.zoom = new util.SimpleModel(new schemas.TChoice(void 0, void 0, {
                caption: "Zoom",
                required: !0,
                choiceRenderer: "switch",
                values: {
                    hours: {
                        id: "hours",
                        caption: locale.hours,
                        order: 1
                    },
                    days: {
                        id: "days",
                        caption: locale.days,
                        order: 2
                    },
                    weeks: {
                        id: "weeks",
                        caption: locale.weeks,
                        order: 3
                    },
                    months: {
                        id: "months",
                        caption: locale.months,
                        order: 4
                    },
                    years: {
                        id: "years",
                        caption: locale.years,
                        order: 5
                    }
                }
            }), "years"),
            this.zoom.on("update", this.zoomUpdated, this),
            this.zoom.withoutLabel = !0,
            this.zoomField = new Ue.a(this, this.zoom, this.$controls),
            this.zoomField.el.css("width", ""),
            this.$pane = $('<div class="gantt-pane">').appendTo(this.el).touch($.proxy(this.clicked, this)),
            this.cidxMode = "date",
            this.cidxStart = -1,
            this.cidxEnd = -1,
            this.scale = void 0;
            var i = NinoxDocumentInteraction.getUserDefault("ui.gantt.leftWidth"),
                o = i ? parseInt(i) : 200;
            isNaN(o) && (o = 200),
            this.scrollPane = new kn({
                viewPaddingX: 400,
                viewPaddingY: 400,
                modX: 100,
                modY: 40,
                $parent: this.$pane,
                render: function(e, i, o, n) {
                    return t.renderHTML(e, i, o, n)
                },
                head: {
                    height: 40,
                    render: function(e, i) {
                        return t.renderHeadHTML(e, i)
                    }
                },
                foot: {
                    height: 0,
                    render: function() {
                        return ""
                    }
                },
                left: {
                    width: o,
                    render: function(e, i) {
                        return t.renderLeftHTML(e, i)
                    },
                    renderHead: function() {
                        return t.renderLeftHeadHTML()
                    }
                },
                right: {
                    width: 0,
                    render: function(e, t) {
                        return ""
                    }
                }
            }),
            this.scrollPane.$leftHeadView.nxdraggable({
                selector: ".t-head-resizer",
                dragStart: function(e) {
                    this.cidx = e.$el.closest(".t-head-cell").attr("data-cidx");
                    var i = t.getQuery().cols[this.cidx];
                    this.width0 = i.width
                },
                drag: function(e) {
                    t.getQuery().cols[this.cidx].width = Math.max(40, this.width0 + (e.x2 - e.x0)),
                    t.resizeColumns()
                }
            }),
            this.scrollPane.$leftHeadView.nxdraggable({
                selector: ".t-head-cell",
                dismiss: ".t-head-resizer",
                dragStart: function(e) {
                    this.cidx = e.$el.attr("data-cidx");
                    t.getQuery().cols[this.cidx]
                },
                drag: function(e) {
                    t.getQuery().cols[this.cidx]
                },
                click: function(e) {}
            }),
            this.scrollPane.$leftHeadView.touch((function(e) {
                var i = $(e.target);
                if (!i.is(".t-head-resizer"))
                    return i.closest(".t-head-cell").length ? (t.tableView.table.touchHead(e), !1) : i.is(".i-reload") ? (t.getQuery().reload(), !1) : void 0
            })),
            this.scrollPane.$view.nxdraggable({
                selector: TOUCH ? ".gantt-row-grab,.gantt-row-bar,.gantt-row-square" : void 0,
                dragStart: function(e) {
                    this.direction = void 0;
                    var i = e.$el.closest(".gantt-row");
                    if (i.length && (this.nid = i.attr("data-nid"), this.ridx = parseInt(i.attr("data-ridx")), this.nid)) {
                        var o = t.getQuery(),
                            n = o.models[this.nid];
                        if (n) {
                            if (this.startEditable = o.isEditable(t.cidxStart, this.ridx), this.endEditable = o.isEditable(t.cidxEnd, this.ridx), null == t.getStartValue(n) && null == t.getEndValue(n)) {
                                if (!this.startEditable || !this.endEditable)
                                    return;
                                this.direction = "create",
                                $('<div class="gantt-row-bar">').appendTo(i).css({
                                    left: e.x0 - t.scrollPane.$view.offset().left,
                                    width: 0
                                })
                            } else {
                                if (this.direction = this.startEditable && e.$el.is(".gantt-row-grab-left") ? "left" : this.endEditable && e.$el.is(".gantt-row-grab-right") ? "right" : (this.startEditable || this.endEditable) && e.$el.is(".gantt-row-bar,.gantt-row-arrow-right,.gantt-row-arrow-left") || (this.startEditable || this.endEditable) && e.$el.closest(".gantt-row-square").length ? "drag" : void 0, !this.direction)
                                    return;
                                i.find(".gantt-row-bar-label").css("display", "none")
                            }
                            var s = i.find(".gantt-row-bar,.gantt-row-square,.gantt-row-arrow-right,.gantt-row-arrow-left");
                            this.$bar = s,
                            this.left0 = parseInt(s.css("left")),
                            this.width0 = parseInt(s.css("width"))
                        }
                    }
                },
                drag: function(e) {
                    this.direction && ("left" === this.direction ? this.$bar.css({
                        left: this.left0 + e.x2 - e.x0,
                        width: this.width0 + e.x0 - e.x2
                    }) : "right" === this.direction ? this.$bar.css({
                        width: this.width0 + e.x2 - e.x0
                    }) : "drag" === this.direction ? this.$bar.css({
                        left: this.left0 + e.x2 - e.x0
                    }) : "create" === this.direction && this.$bar.css({
                        width: this.width0 + e.x2 - e.x0
                    }))
                },
                dragEnd: function(e) {
                    if (this.direction) {
                        e.$el.closest(".gantt-row").find(".gantt-row-bar-label").css("display", "");
                        var i = t.getQuery();
                        if ("drag" === this.direction) {
                            var o = (e.x2 - e.x0) / t.scale.timeZoom;
                            if (!(d = i.cols[t.cidxStart]) || !d.directFid)
                                return;
                            if (!(h = i.cols[t.cidxEnd]) || !h.directFid)
                                return;
                            if (!(p = i.models[this.nid]))
                                return;
                            var n = t.getStartValue(p),
                                s = t.getEndValue(p),
                                a = null != n ? n + o : void 0,
                                r = null != s ? s + o : void 0,
                                l = d.expression.returnType.base,
                                c = d.expression.returnType.base;
                            "date" === l && (a = On(a).getTime()),
                            "date" === c && (r = On(r).getTime()),
                            "appointment" === t.cidxMode ? database.update(this.nid, d.directFid, a + "/" + (r - a)) : (null == a || isNaN(a) || database.update(this.nid, d.directFid, a), null == r || isNaN(r) || database.update(this.nid, h.directFid, r))
                        } else if ("create" === this.direction) {
                            var d,
                                h;
                            if (!(d = i.cols[t.cidxStart]) || !d.directFid)
                                return;
                            if (!(h = i.cols[t.cidxEnd]) || !h.directFid)
                                return;
                            if (!(p = i.models[this.nid]))
                                return;
                            a = t.pixelToTime(e.x0),
                            r = t.pixelToTime(e.x2),
                            l = d.expression.returnType.base,
                            c = d.expression.returnType.base;
                            "date" === l && (a = On(a).getTime()),
                            "date" === c && (r = On(r).getTime()),
                            "appointment" === t.cidxMode ? database.update(this.nid, d.directFid, a + "/" + (r - a)) : (null == a || isNaN(a) || database.update(this.nid, d.directFid, a), null == r || isNaN(r) || database.update(this.nid, h.directFid, r))
                        } else if ("appointment" === t.cidxMode) {
                            var p,
                                u = t.cidxStart;
                            if (!(y = i.cols[u]) || !y.directFid)
                                return;
                            if (!(p = i.models[this.nid]))
                                return;
                            var f = p.values[u];
                            if (!f)
                                return;
                            var m = f.split("/"),
                                g = parseInt(m[0]),
                                v = g + parseInt(m[1]),
                                b = t.pixelToTime(e.x2);
                            "left" === this.direction ? b <= v ? database.update(this.nid, y.directFid, b + "/" + (v - b)) : database.update(this.nid, y.directFid, v + "/" + (b - v)) : "right" === this.direction && (b >= g ? database.update(this.nid, y.directFid, g + "/" + (b - g)) : database.update(this.nid, y.directFid, b + "/" + (g - b)))
                        } else {
                            var y;
                            u = "left" === this.direction ? t.cidxStart : t.cidxEnd;
                            if (!(y = i.cols[u]) || !y.directFid)
                                return;
                            var w = y.expression.returnType.base;
                            "date" === w ? b = t.pixelToDate(e.x2).getTime() : "appointment" === w || (b = t.pixelToTime(e.x2)),
                            null == b || isNaN(b) || database.update(this.nid, y.directFid, b)
                        }
                    }
                }
            }),
            TOUCH || (this.scrollPane.$body[0].addEventListener("mouseover", (function(e) {
                var i = t.scrollPane.$view[0].childNodes,
                    o = i[i.length - 2];
                o && (o.style.display = "")
            })), this.scrollPane.$body[0].addEventListener("mouseleave", (function(e) {
                var i = t.scrollPane.$view[0].childNodes,
                    o = i[i.length - 2];
                o && (o.style.display = "none")
            })), this.scrollPane.$body[0].addEventListener("mousemove", (function(e) {
                var i = t.scrollPane.$view[0].childNodes,
                    o = i[i.length - 2];
                o && (o.style.left = e.clientX - t.scrollPane.$view.offset().left + "px")
            }))),
            this.scrollPane.$body[0].addEventListener("contextmenu", $.proxy(this.openContextMenu, this), !1),
            this.scrollPane.$head[0].addEventListener("contextmenu", (function(e) {
                e.preventDefault()
            }), !1),
            this.scrollPane.$foot[0].addEventListener("contextmenu", (function(e) {
                e.preventDefault()
            }), !1),
            this.scrollPane.on("leftWidthChanged", (function() {
                NinoxDocumentInteraction.setUserDefault("ui.gantt.leftWidth", String(t.scrollPane.leftWidth))
            })),
            this.registerMouseListeners()
        }
        function Nn(e, t) {
            var i = In(new Date(e), t),
                o = Rn(i, t),
                n = i.getTime();
            return n / t + (e - n) / (o.getTime() - n)
        }
        function In(e, t) {
            switch (t) {
            case 1:
                return new Date(e.getTime());
            case 1e3:
                return new Date(1e3 * Math.floor(e.getTime() / 1e3));
            case Sn:
                return new Date(Math.floor(e.getTime() / Sn) * Sn);
            case 36e5:
                return new Date(36e5 * Math.floor(e.getTime() / 36e5));
            case 864e5:
                return new Date(e.getFullYear(), e.getMonth(), e.getDate());
            case En:
                return new Date(e.getFullYear(), e.getMonth(), e.getDate() - e.getDay() + locale.firstDayOfWeek);
            case _n:
                return new Date(e.getFullYear(), e.getMonth(), 1);
            case Dn:
                return new Date(e.getFullYear(), 0, 1);
            default:
                throw new Error("Illegal scale configuration.")
            }
        }
        function On(e, t) {
            var i = new Date(e);
            return new Date(i.getFullYear(), i.getMonth(), i.getDate() + (t || 0))
        }
        function Rn(e, t) {
            switch (t) {
            case 1:
                return new Date(e.getTime() + 1);
            case 1e3:
                return new Date(e.getTime() + 1e3);
            case Sn:
                return new Date(e.getTime() + Sn);
            case 36e5:
                return new Date(e.getTime() + 36e5);
            case 864e5:
                return new Date(e.getFullYear(), e.getMonth(), e.getDate() + 1);
            case En:
                return new Date(e.getFullYear(), e.getMonth(), e.getDate() + 7);
            case _n:
                return new Date(e.getFullYear(), e.getMonth() + 1, 1);
            case Dn:
                return new Date(e.getFullYear() + 1, 0, 1);
            default:
                throw new Error("Invalid state")
            }
        }
        function jn(e) {
            switch (this.scale) {
            case 1:
            case 1e3:
                return util.formatDate(e, "hh:mm:ss");
            case Sn:
            case 36e5:
                return util.formatDate(e, "hh:mm");
            case 864e5:
            case En:
                return util.formatDate(e, "ddd, DD.MM.YY");
            case _n:
                return util.formatDate(e, "MM / YYYY");
            case Dn:
                return util.formatDate(e, "YYYY");
            default:
                throw new Error("Invalid state")
            }
        }
        function Ln(e, t, i, o) {
            for (var n = 1 / 0, s = -1 / 0, a = !1, r = !1, l = 0; l < t.length; l++) {
                var c = e[t[l]];
                if (c) {
                    var d = c.values[i],
                        h = c.values[o];
                    null == d ? a = !0 : (d < n && (n = d), d > s && (s = d)),
                    null == h ? r = !0 : (h < n && (n = h), h > s && (s = h))
                }
            }
            return {
                min: n === 1 / 0 ? null : n,
                max: s === -1 / 0 ? null : s,
                hasStartNull: a,
                hasEndNull: r
            }
        }
        Object.assign(Mn.prototype, bn.prototype),
        Mn.prototype.isGantt = !0,
        Mn.prototype.mode = "gantt",
        Mn.prototype.destroy = function() {
            this.$controls.remove(),
            bn.prototype.destroy.call(this)
        },
        Mn.prototype.pixelToTime = function(e) {
            var t = this.scale,
                i = Nn(this.scrollPane.viewX0 / t.timeZoom, t.scale) * t.scale,
                o = e - this.scrollPane.$body.offset().left - this.scrollPane.translateX;
            return Math.round(i + o / t.timeZoom)
        },
        Mn.prototype.pixelToDate = function(e) {
            return On(this.pixelToTime(e))
        },
        Mn.prototype.resizeColumns = function() {
            for (var e = this.getQuery().cols, t = 44, i = this.scrollPane.$leftHeadView[0].childNodes, o = this.scrollPane.$leftView[0].childNodes, n = 0; n < e.length; n++) {
                var s = e[n],
                    a = i[n + 1];
                a && (a.style.left = t + "px", a.style.width = s.width + "px");
                for (var r = 0; r < o.length; r++) {
                    var l = o[r].childNodes[n + 1];
                    l && (l.style.left = t + "px", l.style.width = s.width + "px")
                }
                t += s.width
            }
            $(this.scrollPane.$leftView[0]).find(".t-selection").css("width", t)
        },
        Mn.prototype.didShow = function(e) {
            this.$controls.appendTo(ui.$menuCenter),
            this.updateMetrics(),
            this.scrollPane.show(e),
            this.bodyResized()
        },
        Mn.prototype.didHide = function(e) {
            this.$controls.detach(),
            this.scrollPane.hide()
        },
        Mn.prototype.zoomUpdated = function() {
            var e = {
                hours: [36e5, 60],
                days: [864e5, 192],
                weeks: [En, 112],
                months: [_n, 200],
                years: [Dn, 288]
            }[this.zoom.value];
            e && (this.scale = this.getScaleConfiguration(this.scale.date0, e[0], e[1]), this.updateMetrics())
        },
        Mn.prototype.updateUI = function() {
            this.visible && this.scrollPane.updateView(!0)
        },
        Mn.prototype.renderLeftHeadHTML = function() {
            if (!this.tableView.table.ready)
                return "";
            for (var e = this.tableView.table, t = e.cols, i = e.sortDescending, o = e.cidxGroup, n = e.cidxSort, s = '<div class="t-head-ruler i-16 i-light-grey i-reload"></div>', a = 44, r = 0; r < t.length; r++) {
                var l = t[r],
                    c = r === o,
                    d = r === n,
                    h = !!l.filter;
                s += '<div class="t-head-cell" data-cidx="' + r + '" style="left:' + a + "px;width:" + l.width + 'px"><div class="t-head-resizer"></div><span>' + htmlEscape(l.caption || l.expression.caption) + "</span>" + (h ? '<div class="i-40-16 i-light-grey i-setting-filter" style="width: 12px;"></div>' : "") + (c ? '<div class="i-40-18 i-light-grey i-table-group" style="width: 24px"></div>' : d ? i ? '<div class="i-40-12 i-light-grey i-line-down-thick"></div>' : '<div class="i-40-12 i-light-grey i-line-up-thick"></div>' : "") + "</div>",
                a += l.width
            }
            return s
        },
        Mn.prototype.renderLeftHTML = async function(e, t) {
            if (!this.tableView.table.ready)
                return "";
            for (var i = this.tableView.table, o = i.rows, n = i.cols, s = i.models, a = i.groups || {}, r = i.expanded || {}, l = (this.rowHeight, i.cidxGroup), c = (this.cidxStart, this.cidxEnd, ""), d = 0;; d++) {
                var h = e + 40 * d;
                if (h > t)
                    break;
                if (!((N = Math.floor(h / 40)) < 0) && !(N >= o.length)) {
                    var p = o[N],
                        u = s[p],
                        f = u ? void 0 : a[p],
                        m = u ? u.values : f.values,
                        g = !u,
                        v = g && r[p];
                    c += '<div class="t-row' + (g ? " group" : "") + (null == l && N % 2 == 0 ? " t-row-2nd" : " t-row-1st") + '" style="top:' + (h - e) + 'px"' + (g ? ' data-gid="' + encodeURIComponent(f.id) : ' data-nid="' + p) + '">',
                    c += '<div class="' + ("t-rowhead" + (N === o.length ? " icon-big-black icon-big-add-light" : N < 0 || N > o.length ? "empty" : g ? v ? " group i-40-24 i-light-grey i-line-down" : " group i-40-24 i-light-grey i-line-right" : "")) + '"><div class="t-rowhead-content">' + (g ? "" : N + 1) + "</div></div>";
                    for (var b = 44, y = 0; y < n.length; y++) {
                        var w = "",
                            x = "";
                        if ((M = n[y]).isReadable) {
                            var T = m[y];
                            if (g && M.agg && y !== l) {
                                null != (D = M.aggType.format(T)) && (w = tables.aggTypeToSymbol(M.agg, D))
                            } else {
                                var $ = M.field,
                                    C = $.base;
                                if ("choice" === C || "dchoice" === C) {
                                    const e = await new Promise(e => $.loadValue(p, T, e));
                                    e && (w += '<div class="multicombo-item" style="' + (e.color ? "background-color:" + e.color + ";color:" + e.textColor : "") + '">' + (e.icon ? '<div class="choice-symbol ic ic-' + e.icon + '"></div>' : "") + "<span>" + htmlEscape(e.caption || "") + "</span></div>")
                                } else if ("multi" === C || "dmulti" === C) {
                                    var k = util.multiDecode(T);
                                    if (k) {
                                        const e = await new Promise(e => $.loadValues(p, (t, i) => e(i || {})));
                                        k.sort((function(t, i) {
                                            var o = e[t],
                                                n = e[i];
                                            return o ? n ? o.order - n.order : -1 : 0
                                        }));
                                        for (var S = 0; S < k.length; S++) {
                                            var E = e[k[S]];
                                            E && (w += '<div class="multicombo-item" style="' + (E.color ? "background-color:" + E.color + ";color:" + E.textColor : "") + '">' + (E.icon ? '<div class="choice-symbol ic ic-' + E.icon + '"></div>' : "") + "<span>" + htmlEscape(E.caption || "") + "</span></div>")
                                        }
                                    }
                                } else if ("color" === C)
                                    T && (x = "background-color:" + T);
                                else if ("icon" === C)
                                    T && (w = '<div class="choice-symbol ic ic-' + T + '"></div>');
                                else if ("styled" === C)
                                    T && (w = '<div class="choice-symbol' + (T.icon ? " ic ic-" + T.icon : "") + '"></div><span style="color:' + (g ? "" : T.color) + '">' + htmlEscape(T.text) + "</span>", T.background && (x = "background-color:" + T.background));
                                else if ("file" === $.base) {
                                    if (T) {
                                        var _ = database.thumbURL1(T);
                                        _ && (w = '<img style="height:40px" src="' + _ + '">')
                                    }
                                } else {
                                    var D = $.format(T);
                                    w = htmlEscape(D)
                                }
                            }
                            c += '<div class="t-cell t-cell-' + M.field.base + '" style="left:' + b + "px;width:" + M.width + "px;" + x + '">' + w + "</div>",
                            b += M.width
                        } else
                            x = "backgroundColor:#f7f7f7";
                        c += "</dv>"
                    }
                    c += "</div>"
                }
            }
            for (b = 44, y = 0; y < n.length; y++) {
                var M;
                b += (M = n[y]).width
            }
            var N,
                I = 0,
                O = "none";
            return -1 !== (N = this.getSelectedNid() ? o.indexOf(this.getSelectedNid()) : -1) && (I = 40 * (N - e / 40), O = ""), c += '<div class="t-selection t-selection-row" style="display:' + O + ";top:" + I + "px;left:0;width:" + b + 'px;height:40px"></div>'
        },
        Mn.prototype.renderHeadHTML = function(e, t) {
            if (!this.tableView.table.ready)
                return "";
            for (var i, o = this.getScale(), n = Nn(e / o.timeZoom, o.scale) * o.scale, s = In(new Date(e / o.timeZoom), o.scale), a = "", r = 0; r < 100;) {
                i = Rn(s, o.scale);
                var l = (s.getTime() - n) * o.timeZoom,
                    c = (i.getTime() - n) * o.timeZoom;
                if (e + l > t)
                    break;
                a += '<div class="gantt-head-cell" style="left:' + l + "px;width:" + (c - l) + 'px">' + htmlEscape(o.formatScaleDate(s)) + "</div>",
                s = i,
                r++
            }
            return a
        },
        Mn.prototype.renderHTML = function(e, t, i, o) {
            if (!this.tableView.table.ready)
                return "";
            for (var n = this.tableView.table, s = n.rows, a = n.cols, r = n.models, l = n.groups || {}, c = n.cidxGroup, d = (this.rowHeight, this.cidxStart), h = this.cidxEnd, p = a[d], u = a[h], f = !!p && "date" === p.expression.returnType.base, m = !!u && "date" === u.expression.returnType.base, g = this.getScale(), v = Nn(e / g.timeZoom, g.scale) * g.scale, b = In(new Date(e / g.timeZoom), g.scale), y = g.ticks, w = i - e, x = o - t, T = "", $ = (this.scrollPane.visibleHeight, b), C = 0; C < 100;) {
                var k = Math.round(($.getTime() - v) * g.timeZoom),
                    S = Rn($, g.scale);
                if (k > w)
                    break;
                if (T += '<div class="gantt-grid-line" style="height:' + x + "px;left:" + k + 'px"></div>', null != y)
                    for (var E = (Math.round((S.getTime() - v) * g.timeZoom) - k) / y, _ = 1; _ < y; _++) {
                        T += '<div class="gantt-grid-line2" style="height:' + x + "px;left:" + (k + Math.round(_ * E)) + 'px"></div>'
                    }
                $ = S,
                C++
            }
            var D = (Date.now() - v) * g.timeZoom;
            for (C = 0;; C++) {
                var M = t + 40 * C;
                if (M > o)
                    break;
                if (!((Q = Math.floor(M / 40)) < 0) && !(Q >= s.length)) {
                    var N = s[Q],
                        I = r[N];
                    if (I) {
                        T += '<div class="gantt-row ' + (null == c && Q % 2 == 0 ? "gantt-row-1st" : "gantt-row-2nd") + '" style="left:0px;width:' + w + "px;top:" + (M - t) + 'px" data-ridx="' + Q + '" data-nid="' + N + '">';
                        var O = !1,
                            R = !1;
                        if (-1 !== d && (W = this.getStartValue(I), O = n.isEditable(d, Q)), -1 !== h && (B = this.getEndValue(I), R = n.isEditable(h, Q)), W !== B ? (null != W && f && (W = On(W).getTime()), null != B && m && (B = On(B, 1).getTime())) : W === B && null != W && f && (B = W = On(W, 1).getTime()), null != W || null != B) {
                            X = null == W ? null : Math.round((W - v) * g.timeZoom),
                            G = null == B ? null : Math.round((B - v) * g.timeZoom);
                            if (null != X && null != G && X > G) {
                                var j = G;
                                G = X,
                                X = j
                            }
                            for (var L = [], F = 0; F < a.length; F++)
                                if (F !== d && F !== h) {
                                    var A = a[F],
                                        H = I.values[F],
                                        P = A.expression.returnType.format(H);
                                    P && L.push(P)
                                }
                            var U = htmlEscape(L.join(" "));
                            if (W === B)
                                T += '<div class="gantt-row-square" style="left:' + (null == W ? G : X) + 'px"><div class="gantt-row-square-square"></div><div class="gantt-row-square-label">' + U + "</div>" + (O ? '<div class="gantt-row-grab gantt-row-grab-left"></div>' : "") + (R ? '<div class="gantt-row-grab gantt-row-grab-right"></div>' : "") + "</div>";
                            else
                                T += '<div class="' + (null == X ? "gantt-row-arrow-right" : null == G ? "gantt-row-arrow-left" : "gantt-row-bar") + '" style="left:' + (J = null == X ? G - 64 : X) + "px;width:" + (K = null == X || null == G ? 64 : G - X + 1) + 'px"><div class="gantt-row-bar-label" style="left:' + (K + 4) + 'px">' + U + "</div>" + (O ? '<div class="gantt-row-grab gantt-row-grab-left"></div>' : "") + (R ? '<div class="gantt-row-grab gantt-row-grab-right"></div>' : "") + "</div>"
                        }
                    } else {
                        var z = l[N];
                        if (z) {
                            T += '<div class="gantt-row gantt-group" style="left:0px;width:' + w + "px;top:" + (M - t) + 'px" data-ridx="' + Q + '" data-gid="' + encodeURIComponent(z.id) + '">';
                            var V = Ln(r, z.children, d, h),
                                W = V.min,
                                B = V.max,
                                q = V.hasStartNull,
                                Y = V.hasEndNull;
                            W !== B ? (null != W && f && (W = On(W).getTime()), null != B && m && (B = On(B, 1).getTime())) : W === B && null != W && f && (B = W = On(W, 1).getTime());
                            var X,
                                G,
                                J = X = null == W ? null : Math.round((W - v) * g.timeZoom),
                                K = (G = null == B ? null : Math.round((B - v) * g.timeZoom)) - X;
                            q && (J -= 64, K += 64),
                            Y && (K += 64),
                            null != W && null != B && (T += W !== B || q || Y ? '<div class="gantt-group-bar" style="left:' + J + "px;width:" + K + 'px">' + (q ? '<div class="gantt-group-bar-startopen"></div>' : '<div class="gantt-group-bar-start"></div>') + '<div class="gantt-group-bar-range"></div>' + (Y ? '<div class="gantt-group-bar-endopen"></div>' : '<div class="gantt-group-bar-end"></div>') + "</div>" : '<div class="gantt-group-square" style="left:' + J + 'px"><div class="gantt-group-square-square"></div></div>'),
                            T += "</div>"
                        }
                    }
                    T += "</div>"
                }
            }
            T += '<div class="gantt-grid-now" style="height:' + x + "px;left:" + D + 'px"></div>',
            T += '<div class="gantt-grid-indicator" style="height:' + x + "px;left:" + D + 'px;display:none"></div>';
            var Q,
                Z = 0,
                ee = "none";
            return -1 !== (Q = this.getSelectedNid() ? s.indexOf(this.getSelectedNid()) : -1) && (Z = 40 * (Q - t / 40), ee = ""), T += '<div class="t-selection t-selection-row" style="display:' + ee + ";top:" + Z + "px;left:0;width:" + w + 'px;height:40px"></div>'
        },
        Mn.prototype.selectionChanged = function() {
            this.visible && (this.openEditor(this.getSelectedNid()), this.updateMetrics())
        },
        Mn.prototype.udpateSelection = function() {},
        Mn.prototype.queryLoaded = function() {
            this.visible && this.updateMetrics()
        },
        Mn.prototype.dataChanged = function() {
            this.visible && this.updateUI()
        },
        Mn.prototype.rowsChanged = function() {
            this.visible && this.updateMetrics()
        },
        Mn.prototype.updateMetrics = function() {
            if (this.visible) {
                this.scrollPane.totalWidth > 0 && (this.scrollPane.scrollX, this.scrollPane.totalWidth),
                this.scrollPane.totalHeight > 0 && (this.scrollPane.scrollY, this.scrollPane.totalHeight);
                var e = this.getQuery(),
                    t = e.rows,
                    i = (e.cols, e.models),
                    o = (e.groups, this.el[0].clientWidth);
                this.el[0].clientHeight;
                this.width = o,
                this.rowHeight = 40,
                this.setupColumns();
                var n = this.getScale(),
                    s = n.date0Normalized.getTime(),
                    a = n.getNextDate(n.date0Normalized).getTime();
                for (var r in i)
                    if (i.hasOwnProperty(r)) {
                        var l = i[r];
                        if (l) {
                            var c = this.getStartValue(l),
                                d = this.getEndValue(l);
                            null != c && (c < s && (s = c), c > a && (a = c)),
                            null != d && (d < s && (s = d), d > a && (a = d))
                        }
                    }
                var h = 40 * t.length,
                    p = Math.round(s * n.timeZoom - o / 2) - 1,
                    u = Math.round(a * n.timeZoom + o / 2) + 1;
                this.scrollPane.setMetrics(p, 0, u, h)
            }
        },
        Mn.prototype.setupColumns = function() {
            var e = this.getQuery().cols,
                t = -1,
                i = -1,
                o = "date";
            e:
            for (var n = 0; n < e.length; n++) {
                switch (e[n].expression.returnType.base) {
                case "date":
                case "timestamp":
                    if (-1 === t)
                        t = n;
                    else if (-1 === i) {
                        i = n;
                        break e
                    }
                    break;
                case "appointment":
                    o = "appointment",
                    t = n,
                    i = n;
                    break e
                }
            }
            this.cidxMode = o,
            this.cidxStart = t,
            this.cidxEnd = i
        },
        Mn.prototype.getStartValue = function(e) {
            if (e) {
                var t = e.values[this.cidxStart];
                switch (this.cidxMode) {
                case "appointment":
                    var i = util.RE_APPOINTMENT.exec(t);
                    return i ? parseInt(i[1]) : void 0;
                default:
                    return t
                }
            }
        },
        Mn.prototype.getEndValue = function(e) {
            if (e) {
                var t = e.values[this.cidxEnd];
                switch (this.cidxMode) {
                case "appointment":
                    var i = util.RE_APPOINTMENT.exec(t);
                    return i ? parseInt(i[1]) + parseInt(i[2]) : void 0;
                default:
                    return t
                }
            }
        },
        Mn.prototype.bodyResized = function() {
            this.visible && (this.updateMetrics(), this.$controls.detach(), ui.fullWidth < 1171 ? (this.$smallControlsContainer.appendTo(this.el), this.$controls.appendTo(this.$smallControlsContainer)) : (this.$smallControlsContainer.detach(), this.$controls.appendTo(ui.$menuCenter)))
        },
        Mn.prototype.clicked = function(e) {
            var t = $(e.target).closest(".gantt-row").attr("data-nid"),
                i = $(e.target).closest(".t-row").attr("data-nid"),
                o = t || i;
            if (i)
                this.select(o);
            else {
                var n = $(e.target).closest(".gantt-row").attr("data-gid"),
                    s = $(e.target).closest(".t-row").attr("data-gid"),
                    a = n || s;
                a && (a = decodeURIComponent(a), this.tableView.table.toggle(a))
            }
        },
        Mn.prototype.registerMouseListeners = function() {
            var e,
                t;
            function i(e) {
                e.clientX;
                database.loadNodeSync(t) && (e.preventDefault(), e.stopPropagation())
            }
            function o(e) {
                window.removeEventListener("mousemove", i, !1),
                window.removeEventListener("mouseup", o, !1),
                e.preventDefault(),
                e.stopPropagation()
            }
            this.$pane[0].addEventListener("mousedown", (function(n) {
                if (e)
                    return;
                var s = $(n.target);
                (t = s.closest(".gantt-row").attr("data-nid")) && (s.is(".gantt-row-grab-left") ? e = "drag-left" : s.is(".gantt-row-grab-left") && (e = "drag-right"));
                e && (n.clientX, window.addEventListener("mousemove", i, !1), window.addEventListener("mouseup", o, !1), n.preventDefault(), n.stopPropagation())
            }), !1)
        },
        Mn.prototype.getScale = function() {
            return this.scale || (this.scale = this.getScaleConfiguration(new Date, Dn, 288)), this.scale
        },
        Mn.prototype.getScaleConfiguration = function(e, t, i) {
            var o = i / t;
            return {
                scale: t,
                width: i,
                date0: e,
                date0Normalized: In(e, t),
                ticks: t === Dn ? 12 : t === En ? 7 : 864e5 === t ? 4 : null,
                timeZoom: o,
                pixelPerScale: o / t,
                getNextDate: function(e) {
                    return Rn(e, this.scale)
                },
                formatScaleDate: jn
            }
        };
        var Fn = o("./src/js/widgets/editors/IconSelector.js");
        function An(e) {
            this.dontUpdateUI = !1,
            this.panes = [],
            this.tableView = e,
            this.visible = !1,
            this.resize = $.proxy(this.resize, this),
            this.el = $('<div class="kanban-container">').sortable({
                handle: ".kanban-head",
                cancel: ".not-draggable",
                update: $.proxy(this.userSortedPanes, this),
                zIndex: 999999,
                tolerance: "pointer"
            }),
            this.mousedown = $.proxy(this.mousedown, this),
            this.el[0].addEventListener(TOUCH ? EVENT_touchstart : "mousedown", this.mousedown, !1),
            this.el.touch($.proxy(this.clicked, this)),
            this.updateUI = util.debounceFast(this.updateUI, this)
        }
        Object.assign(An.prototype, bn.prototype),
        An.prototype.isKanban = !0,
        An.prototype.mode = "kanban",
        An.prototype.didShow = function(e) {},
        An.prototype.didHide = function(e) {},
        An.prototype.updateUI = async function() {
            if (!this.dontUpdateUI && this.visible) {
                var e = this.getQuery();
                if (e.ready) {
                    var t = e.cols,
                        i = e.models,
                        o = e.groups,
                        n = e.groupsSorted,
                        s = e.cidxGroup,
                        a = this.canCreateRecord(),
                        r = this.getSelectedNid(),
                        l = this.panes = this.getPanes(this.panes, t, s, o, n),
                        c = "";
                    if (null != s) {
                        var d = t[s];
                        if (d && !d.isReadable)
                            return void this.el.html('<h1 style="padding:16px;margin:0 auto">' + htmlEscape(locale.errorNotAuthorized) + "</h1>");
                        for (var h = 0; h < l.length; h++) {
                            if (h > 100) {
                                c += '<div class="kanban-pane not-draggable"><div class="kanban-head"><div class="kanban-head-label">' + htmlEscape(l.length - 100 + " more ...") + "</div></div></div>";
                                break
                            }
                            var p = l[h],
                                u = o[p.gid],
                                f = u && u.children || [],
                                m = p.icon;
                            c += '<div class="kanban-pane' + (null == p.value ? "  not-draggable" : "") + '" style="background-color:' + p.color.light + '" data-pane="' + p.index + '">',
                            c += '<div class="kanban-head" style="background-color:' + p.color.light + '">' + (m ? '<div class="kanban-head-icon ic ic-' + m + '"></div>' : "") + '<div class="kanban-head-label" style="color:' + util.contrastingTextColorTo(p.color.light) + '">' + htmlEscape(p.caption) + "</div></div>",
                            c += `<div class="kanban-cards" style="background-color: ${p.color.dark}">`;
                            for (var g = 0; g < f.length; g++) {
                                if (g > 1e3) {
                                    c += '<div class="card"><div class="card-padding-top"></div><div style="text-align:center">' + htmlEscape(f.length - 1e3 + " more ...") + '</div><div class="card-padding-bottom"></div></div>';
                                    break
                                }
                                var v = f[g],
                                    b = i[v],
                                    y = v === r;
                                c += await this.renderCard(b, t, s, y ? " selected" : "", void 0, !0)
                            }
                            c += "</div>",
                            a && (c += `<div class="kanban-bottom" style="background-color:${p.color.light};padding: 8px 8px 0 8px;">\n                        <div class="nx-button-text grey" style="border: none">\n                            <div class="kanban-bottom-icon i-32-24 i-light-grey i-setting-add" style="margin-top: 1px;"></div>\n                            <span class="kanban-bottom-label">${htmlEscape(locale.createRecord)}</span>\n                        </div>\n                    </div>`),
                            c += "</div>"
                        }
                        c += '<div class="kanban-add-pane not-draggable"><div class="kanban-add" data-action="add"><div class="kanban-add-label">+ ' + htmlEscape(locale.choiceAddValue) + "</div></div></div>"
                    } else {
                        c += '<div class="kanban-options">',
                        c += `<div class="kanban-options-head"><div style="width: 250px;">${htmlEscape(locale.kanbanRecommend)}</div></div>`;
                        var w = {};
                        for (let e = 0; e < t.length; e++) {
                            var x = t[e];
                            "choice" === x.expression.returnType.base && (c += '<div class="nx-button-text grey kanban-options-col" data-col="' + e + '">' + htmlEscape(x.caption || x.expression.caption) + "</div>", x.directFid && (w[x.directFid] = !0))
                        }
                        T.each(e.type.sorted, (function(e) {
                            "choice" !== e.base || w[e.id] || (c += '<div class="nx-button-text grey kanban-options-col" data-fid="' + e.id + '">' + htmlEscape(e.caption) + "</div>")
                        })),
                        database.isAdmin() && (c += '<div class="nx-button-text blue kanban-options-col blue" data-action="create-choice">+ ' + htmlEscape(locale.createChoiceField) + "</div>"),
                        c += '<div class="kanban-options-head">' + htmlEscape(locale.otherOptions + ":") + "</div>";
                        for (let e = 0; e < t.length; e++) {
                            const i = t[e];
                            "choice" !== i.expression.returnType.base && (c += '<div class="nx-button-text grey kanban-options-col" data-col="' + e + '">' + htmlEscape(i.caption || i.expression.caption) + "</div>")
                        }
                        c += "</div>"
                    }
                    this.el.html(c)
                }
            }
        },
        An.prototype.queryLoaded = function() {
            this.visible && (this.getQuery().expandAll(), this.updateUI())
        },
        An.prototype.rowsChanged = function() {
            this.visible && this.updateUI()
        },
        An.prototype.dataChanged = function() {
            this.visible && (this.getQuery().resort(), this.updateUI())
        },
        An.prototype.bodyResized = function() {
            this.visible
        },
        An.prototype.mousedown = function(e) {
            if (!TOUCH || 1 === e.touches.length) {
                var t = e.target,
                    i = $(t),
                    o = this,
                    n = o.getQuery(),
                    s = n.cols[n.cidxGroup];
                if (s) {
                    var a = i.closest(".card");
                    if (a.length) {
                        var r = a.attr("data-nid");
                        if (r) {
                            var l = database.loadNodeSync(r);
                            if (l) {
                                var c,
                                    d = s.directFid && n.type.fields[s.directFid],
                                    h = d && database.canWrite(d) && database.canWriteNodeField2(l, d),
                                    p = a.offset(),
                                    u = a.width(),
                                    f = a.height(),
                                    m = p.left,
                                    g = p.top,
                                    v = TOUCH ? e.touches[0].clientX : e.clientX,
                                    b = TOUCH ? e.touches[0].clientY : e.clientY,
                                    y = a.closest(".kanban-pane")[0],
                                    w = !1;
                                o.dontUpdateUI = !0;
                                var x = Date.now(),
                                    T = !1,
                                    C = window.NINOX_APP_TAB ? t : window;
                                TOUCH ? (C.addEventListener(EVENT_touchmove, k, !1), C.addEventListener(EVENT_touchend, S, !1)) : (window.addEventListener("mousemove", k, !1), window.addEventListener("mouseup", S, !1))
                            }
                        }
                    }
                }
            }
            function k(e) {
                if (console.log("mousemove"), !(TOUCH && 1 !== e.touches.length || T)) {
                    var t = Date.now(),
                        i = (TOUCH ? e.touches[0].clientX : e.clientX) - v,
                        n = (TOUCH ? e.touches[0].clientY : e.clientY) - b;
                    if (w) {
                        a.css({
                            left: m + i,
                            top: g + n
                        });
                        var s = o.findPaneAt(TOUCH ? e.touches[0].clientX : e.clientX, TOUCH ? e.touches[0].clientY : e.clientY),
                            r = s && s[0];
                        if (r !== y) {
                            if (y && $(y).removeClass("dropping").css("border-color", ""), r) {
                                const e = o.panes[$(r).attr("data-pane")] || {
                                    color: {}
                                };
                                $(r).addClass("dropping").css("border-color", e.color.light || "")
                            }
                            y = r
                        }
                    } else if (i * i + n * n > 10) {
                        if (TOUCH && t - x < 250)
                            return T = !0, C.removeEventListener(EVENT_touchmove, k, !1), C.removeEventListener(EVENT_touchend, S, !1), void (o.dontUpdateUI = !1);
                        if (h) {
                            w = !0,
                            c = $('<div class="kanban-cards-placeholder">').css({
                                width: u,
                                height: f
                            }).insertBefore(a),
                            a.detach().appendTo(document.body).css({
                                position: "absolute",
                                left: m + i,
                                top: g + n,
                                width: u,
                                height: f,
                                "box-shadow": "0 0 32px rgba(0,0,0,0.5)"
                            });
                            var l = o.panes[$(y).attr("data-pane")] || {
                                color: {}
                            };
                            $(y).addClass("dropping").css("border-color", l.color.light || "")
                        }
                    }
                    e.preventDefault()
                }
            }
            function S(e) {
                if (console.log("mouseup"), !(TOUCH && 0 !== e.touches.length || T)) {
                    if (w) {
                        a.css({
                            "box-shadow": "none"
                        });
                        var t = !0;
                        if (y) {
                            $(y).removeClass("dropping").css("border-color", "");
                            var i = $(y).attr("data-pane");
                            if (i) {
                                var s = o.panes[i];
                                s && (t = !1, a.remove(), c.remove(), $.loading(!0), database.update(r, d.id, s.value, (function(e) {
                                    $.loading(!1),
                                    e && $.alert(e),
                                    n.resort(),
                                    n.expandAll(),
                                    o.dontUpdateUI = !1,
                                    o.updateUI()
                                })))
                            }
                        }
                        t && (console.log("revertDrag"), a.detach().insertBefore(c).css({
                            position: "",
                            left: "",
                            top: "",
                            width: "",
                            height: "",
                            "box-shadow": ""
                        }), c.remove(), c = void 0)
                    } else
                        o.getQuery().expandAll(),
                        o.select(r);
                    o.dontUpdateUI = !1,
                    TOUCH ? (C.removeEventListener(EVENT_touchmove, k, !1), C.removeEventListener(EVENT_touchend, S, !1)) : (window.removeEventListener("mousemove", k, !1), window.removeEventListener("mouseup", S, !1)),
                    e.preventDefault()
                }
            }
        },
        An.prototype.setup = function(e) {
            var t = this,
                i = $(e.target).closest(".kanban-options-col"),
                o = this.getQuery();
            if ("create-choice" === i.attr("data-action")) {
                var n = o.type.schema.createField(o.type, o.type.createNewFieldName("choice"), "choice");
                const e = o.getConfig();
                e.cols.splice(0, 0, {
                    expression: n.id
                }),
                e.group = 0,
                e.sort && e.sort++,
                o.setConfig(e),
                o.load((function() {
                    t.updateUI()
                })),
                t.tableView.saveView()
            } else if (i.attr("data-fid")) {
                var s = i.attr("data-fid");
                const e = o.getConfig();
                e.cols.splice(0, 0, {
                    expression: s
                }),
                e.group = 0,
                e.sort && e.sort++,
                o.setConfig(e),
                o.load((function() {
                    t.updateUI()
                })),
                t.tableView.saveView()
            } else {
                var a = i.attr("data-col");
                a && (o.group(parseInt(a, 10)), this.updateUI()),
                t.tableView.saveView()
            }
        },
        An.prototype.clicked = function(e) {
            var t = $(e.target);
            t.closest(".kanban-options-col").length ? this.setup(e) : t.closest(".kanban-add").length ? this.popupCreateChoiceValue(e) : t.closest(".kanban-head").length ? this.popupChoiceValue(e) : t.closest(".kanban-bottom").length && this.createRecord(e)
        },
        An.prototype.createRecord = function(e) {
            if (this.canCreateRecord()) {
                var t = this,
                    i = $(e.target),
                    o = t.getQuery(),
                    n = t.getGroupField(),
                    s = i.closest(".kanban-pane").attr("data-pane");
                if (s) {
                    var a = t.panes[s];
                    if (a) {
                        $.loading(!0);
                        var r = {};
                        r[n.id] = a.value,
                        database.create(o.type.id, r, (function(e, i) {
                            $.loading(!1),
                            e && $.alert(e),
                            i && (t.getQuery().expandAll(), t.select(i._id))
                        }))
                    }
                }
            }
        },
        An.prototype.getPanes = function(e, t, i, o, n) {
            if (null == i)
                return [];
            var s = [],
                a = t[i].expression.returnType;
            if ("choice" === a.base || "boolean" === a.base) {
                var r = T.sortBy(a.getValues(), "order");
                a.required || r.unshift({
                    id: void 0,
                    value: null
                });
                for (let e = 0; e < r.length; e++) {
                    const t = r[e].id;
                    s.push({
                        caption: null == t ? locale.empty : a.format(t),
                        value: t,
                        index: e,
                        color: this.getGroupColor(a, t),
                        icon: this.getGroupIcon(a, t),
                        gid: "_group_" + (null == t ? "" : JSON.stringify(t))
                    })
                }
            } else
                for (let e = 0; e < n.length; e++) {
                    var l = o[n[e]];
                    if (l) {
                        var c = l.value;
                        s.push({
                            caption: null == c ? locale.empty : a.format(c),
                            value: c,
                            index: e,
                            color: this.getGroupColor(a, c),
                            icon: this.getGroupIcon(a, c),
                            gid: l.id
                        })
                    }
                }
            return s
        },
        An.prototype.renderCard = wn.prototype.renderCard,
        An.prototype.getGroupColor = wn.prototype.getGroupColor,
        An.prototype.getGroupIcon = wn.prototype.getGroupIcon,
        An.prototype.findPaneAt = function(e, t) {
            for (var i = this.el.children(), o = 0; o < i.length; o++) {
                var n = $(i[o]),
                    s = n.offset(),
                    a = n.width(),
                    r = n.height();
                if (e >= s.left && e <= s.left + a && t >= s.top && t <= s.top + r)
                    return n
            }
        },
        An.prototype.userSortedPanes = function(e, t) {
            if (this.canChangeStructure()) {
                var i = this.getQuery();
                if (i.ready) {
                    var o = i.cols[i.cidxGroup];
                    if (o) {
                        var n = o.expression.returnType;
                        if ("choice" === n.base) {
                            for (var s = n.values, a = this.panes, r = this.el.children(), l = 1, c = !1, d = 0; d < r.length; d++) {
                                console.log("  pane " + d);
                                var h = $(r[d]),
                                    p = a[parseInt(h.attr("data-pane"), 10)];
                                if (p) {
                                    var u = s[p.value];
                                    console.log("  pane " + d + " with value " + p.value + "=> " + u),
                                    u && (u.order != l && (console.log("  pane " + d + " with value " + p.value + "=> " + u + " changes order from " + u.order + " to " + l), u.order = l, c = !0), l++)
                                }
                            }
                            c && database.schema.trigger("change")
                        }
                    }
                }
            }
        },
        An.prototype.getGroupColumn = function() {
            var e = this.getQuery();
            return e.cols[e.cidxGroup]
        },
        An.prototype.getGroupField = function() {
            this.getQuery().cols;
            var e = this.getGroupColumn();
            if (e)
                return e.expression.returnType
        },
        An.prototype.getPaneInfo = function(e) {
            var t = $(e.target).closest(".kanban-pane");
            if (t.length) {
                var i = parseInt(t.attr("data-pane"), 10),
                    o = this.panes[i];
                if (o) {
                    var n = this.getGroupField();
                    if (n) {
                        var s = void 0,
                            a = void 0;
                        return "choice" === n.base && (a = (s = n.values)[o.value]), {
                            pane: o,
                            field: n,
                            fieldValues: s,
                            choice: a
                        }
                    }
                }
            }
        },
        An.prototype.popupCreateChoiceValue = function(e) {
            if (this.canChangeStructure()) {
                var t = this.getGroupField();
                if (t && "choice" === t.base) {
                    var i = {
                        icon: void 0,
                        color: void 0,
                        caption: ""
                    };
                    new this.inlineChoiceValueEditor({
                        $el: $(e.target).closest(".kanban-add"),
                        field: t,
                        updateUI: function() {},
                        closed: function() {
                            i.caption && t.createValue(i.caption, i.color, i.icon)
                        }
                    }, i)
                }
            }
        },
        An.prototype.popupChoiceValue = function(e) {
            if (this.canChangeStructure()) {
                var t = this.getPaneInfo(e);
                t && t.choice && new this.inlineChoiceValueEditor({
                    $el: $(e.target).closest(".kanban-head"),
                    field: t.field,
                    updateUI: function() {}
                }, t.choice)
            }
        },
        An.prototype.inlineChoiceValueEditor = function(e, t) {
            var i = $.backplane({
                    beforeClose: function() {
                        p(),
                        e.closed && e.closed()
                    }
                }),
                o = e.$el,
                n = o.offset(),
                s = o.width(),
                a = o.height(),
                r = $('<div class="inline-choice-value-editor">').css({
                    top: n.top,
                    left: n.left,
                    width: s,
                    height: a
                }).appendTo(i),
                l = $('<div class="inline-choice-value-editor-icon">').appendTo(r).touch((function() {
                    new Fn.a({
                        $el: l,
                        value: t.icon,
                        update: function(e) {
                            t.icon = e,
                            h(),
                            u()
                        }
                    })
                })),
                c = $('<input class="inline-choice-value-editor-input" type="text">').val(t.caption).appendTo(r).on("change", p),
                d = $('<div class="inline-choice-value-editor-color">').appendTo(r).touch((function() {
                    new Gt.a({
                        $el: d,
                        value: t.color,
                        update: function(e) {
                            t.color = e,
                            h(),
                            u()
                        }
                    })
                }));
            function h() {
                l.attr("class", "inline-choice-value-editor-icon" + (t.icon ? " ic ic-" + t.icon : "")),
                d.css("background-color", t.color || "#fff")
            }
            function p() {
                var e = c.val();
                e !== t.caption && (t.caption = e, u())
            }
            function u() {
                e.field.trigger("change"),
                e.field.schema.trigger("change"),
                e.updateUI()
            }
            h(),
            c.focus()
        },
        An.prototype.canCreateRecord = function() {
            var e = this.getQuery(),
                t = this.getGroupColumn();
            return null != t && t.directFid && database.canCreate(e.type) && database.canWrite(t.field)
        },
        An.prototype.canMoveRecord = function() {
            var e = this.getGroupColumn();
            return null != e && e.directFid && database.canWrite(e.field)
        },
        An.prototype.canChangeStructure = function() {
            return database.isAdmin()
        },
        An.prototype.updateSelection = function() {
            var e = this.getSelectedNid();
            this.el.find(".card.selected").removeClass("selected"),
            e && b.schemas.RE_NID.test(e) && this.el.find('.card[data-nid="' + e + '"]').addClass("selected")
        };
        function Hn(e) {
            this.dontUpdateUI = !1,
            this.panes = [],
            this.tableView = e,
            this.visible = !1,
            this.resize = $.proxy(this.resize, this),
            this.el = $('<div class="pivot-container">'),
            this.pivotCellCols = [],
            this.pivotRows = [],
            this.pivotCols = [],
            this.pivotCells = {},
            this.pivotRowValues = [],
            this.cellColsWidth = 0,
            this.mousedown = $.proxy(this.mousedown, this),
            this.el[0].addEventListener(TOUCH ? EVENT_touchstart : "mousedown", this.mousedown, !1);
            var t = this;
            this.scrollPane = new kn({
                viewPaddingX: 400,
                viewPaddingY: 400,
                modX: 100,
                modY: 40,
                $parent: this.el,
                leftDivider: !1,
                render: function(e, i, o, n) {
                    return t.renderHTML(e, i, o, n)
                },
                head: {
                    height: 80,
                    render: function(e, i) {
                        return t.renderHeadHTML(e, i)
                    }
                },
                foot: {
                    height: 40,
                    render: function(e, i) {
                        return t.renderFootHTML(e, i)
                    }
                },
                left: {
                    width: 40,
                    render: function(e, i) {
                        return t.renderLeftHTML(e, i)
                    },
                    renderHead: function() {
                        return t.renderLeftHeadHTML()
                    },
                    renderFoot: function() {
                        return t.renderLeftFootHTML()
                    }
                },
                right: {
                    width: 0,
                    render: function(e, t) {
                        return ""
                    }
                }
            }),
            this.scrollPane.$headView.nxdraggable({
                selector: ".t-head-resizer",
                dragStart: function(e) {
                    if (this.cidx = e.$el.closest(".t-head-cell").attr("data-cidx"), this.gidx = e.$el.closest(".t-head-cell").attr("data-gidx"), this.cidx) {
                        var i = t.getQuery().cols[this.cidx];
                        this.width0 = i.width
                    } else if (this.gidx) {
                        var o = t.getQuery().cols.slice(2);
                        this.colWidth0 = [];
                        for (var n = 0; n < o.length; n++) {
                            i = o[n];
                            this.colWidth0[n] = i.width
                        }
                        this.width0 = t.cellColsWidth
                    }
                },
                drag: function(e) {
                    if (this.cidx)
                        t.getQuery().cols[this.cidx].width = Math.max(40, this.width0 + (e.x2 - e.x0)),
                        t.resizeColumns();
                    else if (this.gidx) {
                        for (var i = t.getQuery().cols.slice(2), o = this.width0, n = Math.max(40 * i.length, o + (e.x2 - e.x0)), s = this.colWidth0, a = 0; a < i.length; a++) {
                            i[a].width = Math.round(s[a] * n / o)
                        }
                        t.resizeColumns()
                    }
                }
            }),
            this.scrollPane.$leftHeadView.nxdraggable({
                selector: ".t-head-resizer",
                dragStart: function(e) {
                    console.log("left drag start");
                    var i = t.getQuery().cols[0];
                    this.width0 = i.width
                },
                drag: function(e) {
                    console.log("left drag", this.width0, e.x2, e.x0),
                    t.getQuery().cols[0].width = Math.max(40, this.width0 + (e.x2 - e.x0)),
                    t.resizeColumns()
                }
            })
        }
        Object.assign(Hn.prototype, bn.prototype),
        Hn.prototype.isPivot = !0,
        Hn.prototype.mode = "pivot",
        Hn.prototype.didShow = function(e) {
            this.updateStructure(),
            this.scrollPane.show(e)
        },
        Hn.prototype.didHide = function(e) {
            this.scrollPane.hide()
        },
        Hn.prototype.updateUI = function() {
            this.visible && this.updateStructure()
        },
        Hn.prototype.updateStructure = function() {
            var e = this.getQuery(),
                t = e.rows,
                i = e.cols,
                o = e.models || {},
                n = e.groups || {},
                s = (i[0], i[1]),
                a = i.slice(2),
                r = [],
                l = [],
                c = {},
                d = {},
                h = {};
            if (i.length > 2) {
                if (e.ready) {
                    for (var p = 0; p < t.length; p++) {
                        var u = t[p],
                            f = o[u] || n[u];
                        if (f) {
                            var m = f.values[0],
                                g = JSON.stringify(m),
                                v = f.values[1],
                                b = JSON.stringify(v),
                                y = g + "#" + b;
                            if (d[g] || (d[g] = !0, r.push(m)), h[b] || (h[b] = !0, l.push(v)), !(T = c[y])) {
                                T = c[y] = {
                                    cellCols: [],
                                    cellAggs: []
                                };
                                for (var w = 2; w < i.length; w++)
                                    T.cellCols[w - 2] = []
                            }
                            for (w = 2; w < i.length; w++) {
                                var x = f.values[w];
                                null != x && T.cellCols[w - 2].push(x)
                            }
                        }
                    }
                    for (var y in c)
                        if (c.hasOwnProperty(y)) {
                            var T = c[y];
                            for (w = 2; w < i.length; w++) {
                                var $ = i[w],
                                    C = T.cellCols[w - 2];
                                $.agg && (T.cellAggs[w - 2] = this.aggregate($, C))
                            }
                        }
                }
                l.sort((function(e, t) {
                    return s.field.compare(e, t)
                }))
            }
            this.pivotCellCols = a,
            this.pivotRows = r,
            this.pivotCols = l,
            this.pivotCells = c,
            this.pivotRowValues = d,
            this.updateMetrics()
        },
        Hn.prototype.aggregate = function(e, t) {
            var o,
                n;
            switch (e.agg) {
            case "sum":
            case "cnt":
                o = 0;
                break;
            case "avg":
                o = [0, 0];
                break;
            case "min":
                o = 1 / 0;
                break;
            case "max":
                o = -1 / 0;
                break;
            case "first":
            case "last":
                o = null;
                break;
            case "concat":
                o = []
            }
            for (var s = 0; s < t.length; s++) {
                var a = t[s],
                    r = Number(a);
                switch (e.agg) {
                case "sum":
                    isNaN(r) || (o += r);
                    break;
                case "cnt":
                    null != a && !1 !== a && "" !== a && o++;
                    break;
                case "avg":
                    null == a || "number" != typeof a || isNaN(r) || (o[0] += r, o[1]++);
                    break;
                case "min":
                    null !== a && a < o && (o = a);
                    break;
                case "max":
                    null !== a && a > o && (o = a);
                    break;
                case "first":
                    0 === i && (o = a);
                    break;
                case "last":
                    i === t.length - 1 && (o = a);
                    break;
                case "concat":
                    null != a && (o.length < 20 ? o.push(e.field.format(a)) : 20 === o.length && o.push("..."))
                }
            }
            switch (e.agg) {
            case "sum":
            case "cnt":
                n = o;
                break;
            case "avg":
                n = o[1] > 0 ? o[0] / o[1] : void 0;
                break;
            case "min":
                n = o === 1 / 0 ? void 0 : o;
                break;
            case "max":
                n = o === -1 / 0 ? void 0 : o;
                break;
            case "first":
            case "last":
                n = o;
                break;
            case "concat":
                n = o.join(", ")
            }
            return n
        },
        Hn.prototype.updateMetrics = function() {
            for (var e = this.getQuery().cols, t = e[0], i = 0, o = 2; o < e.length; o++) {
                i += e[o].width
            }
            this.cellColsWidth = i;
            var n = i * this.pivotCols.length,
                s = 40 * this.pivotRows.length;
            this.scrollPane.setLeftWidth(t && t.width || 0),
            this.scrollPane.setMetrics(0, 0, n, s)
        },
        Hn.prototype.resizeColumns = function() {
            this.updateMetrics()
        },
        Hn.prototype.renderLeftHeadHTML = function() {
            var e = this.getQuery().cols,
                t = e[0],
                i = e[1];
            return '<div class="t-row" style="top:0"><div class="t-head-cell" style="left:0;width:' + (t && t.width || 0) + 'px"><div class="t-head-resizer"></div><span>' + htmlEscape(i && (i.caption || i.expression.caption) || "") + '</span></div><div class="t-row" style="top:40px"><div class="t-head-cell" style="left:0;width:' + (t && t.width || 0) + 'px"><div class="t-head-resizer"></div><span>' + htmlEscape(t && (t.caption || t.expression.caption) || "") + "</span></div>"
        },
        Hn.prototype.renderLeftHTML = function(e, t) {
            for (var i = this.getQuery().cols[0], o = i && i.width || 0, n = this.pivotRows, s = Math.floor(e / 40), a = Math.floor(t / 40), r = "", l = s; l <= a; l++) {
                var c = l % 2 == 0;
                if (r += '<div class="' + ("t-row" + (l >= 0 && l < n.length ? c ? " t-row-2nd" : " t-row-1st" : " t-row-empty")) + '" style="top:' + (40 * l - e) + 'px">', l >= 0 && l < n.length) {
                    var d = n[l];
                    r += '<div class="t-cell t-cell-emph" style="left:0;width:' + o + 'px">' + (i ? htmlEscape(i.field.format(d)) : "") + "</div>"
                } else
                    r += '<div class="t-cell t-cell-emph" style="left:0;width:' + o + 'px"></div>';
                r += "</div>"
            }
            return r
        },
        Hn.prototype.renderHTML = function(e, t, i, o) {
            for (var n = this.getQuery(), s = this.pivotRows, a = this.pivotCols, r = this.pivotCells, l = n.cols, c = Math.floor(t / 40), d = Math.floor(o / 40), h = "", p = c; p <= d; p++) {
                var u = p % 2 == 0,
                    f = 0;
                if (h += '<div class="' + ("t-row" + (p >= 0 && p < s.length ? u ? " t-row-2nd" : " t-row-1st" : " t-row-empty")) + '" style="top:' + (40 * p - t) + "px;left:" + -e + 'px">', p >= 0 && p < s.length)
                    for (var m = s[p], g = JSON.stringify(m), v = 0; v < a.length; v++)
                        for (var b = a[v], y = r[g + "#" + JSON.stringify(b)], w = 2; w < l.length; w++) {
                            h += '<div class="t-cell t-cell-' + ((x = l[w]).aggType && x.aggType.base || "number") + '" style="left:' + f + "px;width:" + x.width + 'px">',
                            y && x.aggType && (h += htmlEscape(x.aggType.format(y.cellAggs[w - 2]))),
                            h += "</div>",
                            f += x.width
                        }
                else
                    for (v = 0; v < a.length; v++)
                        for (w = 2; w < l.length; w++) {
                            var x;
                            h += '<div class="t-cell t-cell-empty" style="left:' + f + "px;width:" + (x = l[w]).width + 'px"></div>',
                            f += x.width
                        }
                h += "</div>"
            }
            return h
        },
        Hn.prototype.renderHeadHTML = function(e, t) {
            var i = this.getQuery().cols,
                o = i[1],
                n = this.pivotCols,
                s = this.cellColsWidth,
                a = "";
            a += '<div class="t-row" style="top:0;left:' + -e + 'px">';
            for (var r = 0, l = 0; l < n.length; l++)
                a += '<div class="t-head-cell" style="left:' + r + "px;width:" + s + 'px" data-gidx="' + l + '"><div class="t-head-resizer"></div><span>' + (o ? htmlEscape(o.expression.returnType.format(n[l])) : "") + "</span></div>",
                r += s;
            a += "</div>",
            r = 0,
            a += '<div class="t-row" style="top:40px;left:' + -e + 'px">';
            for (l = 0; l < n.length; l++)
                for (var c = 2; c < i.length; c++) {
                    var d = i[c];
                    a += '<div class="t-head-cell" style="left:' + r + "px;width:" + d.width + 'px" data-cidx="' + c + '"><div class="t-head-resizer"></div><span>' + htmlEscape(d.caption || d.expression.caption || "") + "</span></div>",
                    r += d.width
                }
            return a += "</div>"
        },
        Hn.prototype.renderLeftFootHTML = function() {
            var e = this.getQuery().cols[0];
            return '<div class="t-row"><div class="t-foot-cell" style="width:' + (e && e.width || 0) + 'px"></div></div>'
        },
        Hn.prototype.renderFootHTML = function(e, t) {
            var i = this.getQuery().cols,
                o = this.pivotCols,
                n = "",
                s = 0;
            n += '<div class="t-row" style="left:' + -e + 'px">';
            for (var a = 0; a < o.length; a++)
                for (var r = 2; r < i.length; r++) {
                    var l = i[r];
                    n += '<div class="t-foot-cell" style="left:' + s + "px;width:" + l.width + 'px"></div>',
                    s += l.width
                }
            return n += "</div>"
        },
        Hn.prototype.queryLoaded = function() {
            this.updateUI()
        },
        Hn.prototype.dataChanged = function() {
            this.updateUI()
        },
        Hn.prototype.rowsChanged = function() {
            this.updateUI()
        },
        Hn.prototype.bodyResized = function() {
            this.visible && this.scrollPane.resize()
        };
        var Pn = o("./src/js/admin/ViewEditor.js");
        const Un = {
            xlsUseFieldFormat: !1
        };
        function zn(e) {
            var t = e.$container;
            this.xlsUseFieldFormat = new util.SimpleModel(new schemas.TBoolean(void 0, void 0, {
                caption: "Maintain number and date formats",
                required: !0,
                formWidth: 1,
                booleanRenderer: "check"
            })),
            this.xlsUseFieldFormat.value = Un.xlsUseFieldFormat,
            this.xlsUseFieldFormat.onUpdate((function() {
                e.onUpdate && e.onUpdate()
            })),
            this.xlsUseFieldFormatField = new Ue.a(void 0, this.xlsUseFieldFormat, t)
        }
        function Vn(e) {
            if (!database.authorizationExport)
                return $.alert(locale.notAuthorized);
            this.table = e;
            var t = this.popdown = $.popdown({
                close: $.proxy(this.closed, this)
            });
            Object(l.f)("TableExportData", "Open"),
            $('<div class="nx-section-head">').text(locale.exportData).appendTo(t.$pane);
            var i = $('<div class="nx-switch-big">').appendTo(t.$pane),
                o = $('<div class="nx-switch-big-item selected">').text(locale.exportCSV).appendTo(i),
                n = $('<div class="nx-section-pane">').appendTo(t.$pane);
            this.exportCSVSettings = new We({
                $container: n
            });
            var s = $('<div class="nx-button-bar">').appendTo(n);
            $('<div class="nx-button-text grey">').text(locale.cancel).appendTo(s).touch($.proxy(this.destroy, this)),
            $('<div class="nx-hspace-flex">').appendTo(s),
            $('<div class="nx-button-text blue">').text(locale.csvExportOpen).appendTo(s).touch($.proxy(this.csvExportOpen_WEB, this));
            var a = $('<div class="nx-switch-big-item">').text(locale.exportXLS).appendTo(i),
                r = $('<div class="nx-section-pane">').hide().appendTo(t.$pane);
            this.exportXLSSettings = new zn({
                $container: r
            });
            var c = $('<div class="nx-button-bar">').appendTo(r);
            $('<div class="nx-button-text grey">').text(locale.cancel).appendTo(c).touch($.proxy(this.destroy, this)),
            $('<div class="nx-hspace-flex">').appendTo(c),
            $('<div class="nx-button-text blue">').text(locale.xlsExportOpen).appendTo(c).touch($.proxy(this.xlsExportOpen_WEB, this)),
            o.touch((function() {
                o.addClass("selected"),
                a.removeClass("selected"),
                n.show(),
                r.hide()
            })),
            a.touch((function() {
                a.addClass("selected"),
                o.removeClass("selected"),
                r.show(),
                n.hide()
            }))
        }
        zn.prototype.destroy = function() {
            this.xlsUseFieldFormatField.destroy()
        },
        zn.prototype.getXLSExportOptions = function() {
            return {
                useFieldFormat: this.xlsUseFieldFormat.value
            }
        },
        zn.prototype.saveXLSExportOptions = function() {
            Un.xlsUseFieldFormat = this.xlsUseFieldFormat.value
        },
        Vn.prototype.destroy = function() {
            this.popdown.close($.proxy(this.closed, this))
        },
        Vn.prototype.closed = function() {
            this.exportCSVSettings.destroy(),
            this.exportXLSSettings.destroy()
        },
        Vn.prototype.close = function() {
            this.destroy()
        },
        Vn.prototype.csvExportOpen = async function() {
            Object(l.f)("ExportData", "TableCSVOpen");
            this.exportCSVSettings.saveCSVExportOptions();
            this.exportCSVSettings.csvEncoding.value;
            var e = "data:text/csv;charset=utf-8," + this.renderCSV();
            window.open(e)
        },
        Vn.prototype.csvExportOpen_WEB = function() {
            Object(l.f)("ExportData", "TableCSVOpenWeb");
            this.exportCSVSettings.saveCSVExportOptions();
            this.exportCSVSettings.csvEncoding.value;
            var e = this.renderCSV(),
                t = this.suggestFileName() + ".csv";
            NinoxDocumentInteraction.openFileWithServer(t, "text/csv", e, !1, !0),
            this.destroy()
        },
        Vn.prototype.csvExportSaveAs = function() {
            Object(l.f)("ExportData", "TableCSVSaveAs")
        },
        Vn.prototype.suggestFileName = function() {
            var e = this.table,
                t = e.type && e.type.caption || locale.unnamed,
                i = e.container && e.container.getViewCaption() || void 0;
            i == locale.all && (i = void 0);
            var o = t + (i ? " - " + i : "");
            return util.escapeFileName(o)
        },
        Vn.prototype.csvExportSaveICloud = async function() {
            Object(l.f)("ExportData", "TableCSVSaveICloud")
        },
        Vn.prototype.renderCSV = function() {
            return util.renderCSV(database, this.table, this.exportCSVSettings.getCSVExportOptions())
        },
        Vn.prototype.xlsExportOpen = async function() {
            Object(l.f)("ExportData", "TableExcelOpen");
            this.exportXLSSettings.saveXLSExportOptions();
            this.renderXLS()
        },
        Vn.prototype.xlsExportOpen_WEB = function() {
            Object(l.f)("ExportData", "TableExcelOpenWeb");
            this.exportXLSSettings.saveXLSExportOptions();
            var e = this.renderXLS(),
                t = this.suggestFileName() + ".xlsx";
            NinoxDocumentInteraction.openFileWithServer(t, "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet", e, !0, !0),
            this.destroy()
        },
        Vn.prototype.xlsExportSaveAs = function() {
            Object(l.f)("ExportData", "TableExcelSaveAs")
        },
        Vn.prototype.xlsExportSaveICloud = async function() {
            Object(l.f)("ExportData", "TableExcelSaveICloud")
        },
        Vn.prototype.renderXLS = function() {
            var e = this.exportXLSSettings.getXLSExportOptions(),
                t = e && e.useFieldFormat,
                i = {},
                o = this.table,
                n = o.cols,
                s = o.rows,
                a = o.groups,
                r = o.models,
                l = [],
                c = [];
            l.push(c);
            for (var d = {}, h = 0; h < n.length; h++) {
                for (var p = n[h], u = util.escapeXLSColumnHead(p.caption || p.expression.caption, h), f = u, m = 2; d[f.toLocaleLowerCase()]; m++)
                    f = u + m;
                d[f.toLocaleLowerCase()] = !0,
                c[h] = {
                    value: f,
                    autoWidth: !0
                }
            }
            if (s.length)
                for (var g = 0; g < s.length; g++) {
                    var v = s[g],
                        b = a[v];
                    c = [];
                    if (l.push(c), b)
                        for (h = 0; h < n.length; h++) {
                            p = n[h];
                            database.canRead(p.expression) ? h === o.cidxGroup ? c[h] = x(p.field, b.values[h]) : p.aggType ? c[h] = x(p.aggType, b.values[h]) : c[h] = "" : c[h] = ""
                        }
                    else {
                        var y = r[v];
                        for (h = 0; h < n.length; h++) {
                            p = n[h];
                            database.canRead(p.expression) ? c[h] = x(p.field, y.values[h]) : c[h] = ""
                        }
                    }
                }
            else {
                var c = [];
                l.push(c);
                for (var h = 0; h < n.length; h++)
                    c[h] = ""
            }
            var w = {
                worksheets: [{
                    table: !0,
                    name: util.escapeFileName(o.type.caption).substr(0, 30),
                    data: l
                }]
            };
            return xlsx(w).base64;
            function x(e, i) {
                if (t)
                    switch (e.base) {
                    case "number":
                        return {
                            value: null == i ? "" : i,
                            formatCode: T(e.numberFormat)
                        };
                    case "date":
                    case "timestamp":
                        return null == i ? "" : new Date(i);
                    case "html":
                        return i ? String(i) : "";
                    default:
                        return e.format(i)
                    }
                else
                    switch (e.base) {
                    case "number":
                        return null == i ? "" : i;
                    case "date":
                    case "timestamp":
                        return null == i ? "" : new Date(i);
                    case "html":
                        return i ? String(i) : "";
                    default:
                        return e.format(i)
                    }
            }
            function T(e) {
                if (e) {
                    var t = i[e];
                    if (t)
                        return i[e];
                    var o = util.parseNumberFormat(e);
                    return t = $(o.prefix) + (o.group ? "#,##0" : "0") + (o.allDigits ? ".#" : o.trailingZeros ? "." + function(e, t) {
                        for (var i = "", o = 0; o < t; o++)
                            i += e;
                        return i
                    }("0", o.trailingZeros) : "") + $(o.suffix), i[e] = t, t
                }
            }
            function $(e) {
                return (e ? '"' + e.replace(/\"/g, '"\\""') + '"' : "").replace(/\"/g, "&quot;")
            }
        };
        var Wn,
            Bn = void 0;
        function qn(e) {
            var t = this;
            this.contextState = {},
            this._reloadId = 0,
            this._loadCallbacks = [],
            this.rowHeight = this.loadTableRowHeight(),
            this.headHeight = 40,
            this.footHeight = 40,
            this.leftWidth = 44,
            this.minColWidth = 32,
            this.rowHeadWidth = 44,
            this.container = e,
            this.models = {},
            this.groups = {},
            this.groupsSorted = [],
            this.rows = [],
            this.cols = [],
            this.ridxTop = 0,
            this.viewRows = [],
            this.removedIndex = {},
            this.selectionMode = void 0,
            this.selectionR0 = void 0,
            this.selectionC0 = void 0,
            this.selectionR1 = void 0,
            this.selectionC1 = void 0,
            this.selectionMid0 = void 0,
            this.selectionMid1 = void 0,
            this.selectionIsCreated = !1,
            this.extendSelectionUp = !1,
            this.extendSelectionLeft = !1,
            this.editor = void 0,
            this.midChoosen = {},
            this.expanded = {},
            this.cidxSort = 0,
            this.cidxGroup = void 0,
            this.sortDescending = !1,
            this.onlyChoosen = !1,
            this.ready = !1,
            this.visible = !1,
            this.silent = !1,
            this.mouseover = !1,
            this.scrollTop = 0,
            this.scrollLeft = 0,
            this.viewX = 0,
            this.viewY = 0,
            this.scrollDoneTimeout = null,
            this.scrollDoneTime = 0,
            this.scrollDone = $.proxy(this.scrollDone, this),
            this.viewTop = 0,
            this.viewLeft = 0,
            this.viewHeight = 0,
            this.viewWidth = 0,
            this.viewRows = 0,
            this.isMouseOver = !1,
            this.lastMouseDown = 0,
            this.recordController = {
                hasNextRecord: function() {
                    return t.rows.length > 0
                },
                nextRecord: function() {
                    t.editorDown()
                },
                hasPrevRecord: function() {
                    return t.rows.length > 0
                },
                prevRecord: function() {
                    t.editorUp()
                },
                lastRecord: function() {
                    t.editorLast()
                },
                firstRecord: function() {
                    t.editorFirst()
                },
                hasAddRecord: function() {
                    return !(!t.type || !database.canCreate(t.type))
                },
                addRecord: function() {
                    t.create()
                },
                hasDuplicateRecord: function() {
                    return !!(t.getSelectedNid() && t.type && database.canCreate(t.type))
                },
                duplicateRecord: function() {
                    t.duplicate()
                },
                hasRemoveRecord: function() {
                    return !!(t.getSelectedNid() && t.type && database.canDelete(t.type))
                },
                removeRecord: function() {
                    t.remove()
                },
                hasPrintRecord: function() {
                    return !(!t.getSelectedNid() || !1 === database.authorizationPrint)
                },
                printRecord: function() {
                    t.print()
                }
            },
            this.$container = $DIV("t-container"),
            this.$selectionContainer = void 0,
            this.$headSelectionContainer = void 0,
            this.$head = $DIV("t-head", this.$container),
            this.$foot = $DIV("t-foot", this.$container);
            this.$body = $DIV("t-body", this.$container);
            this.$content = $DIV("t-content --ul-table-content", this.$body),
            this.$view = $DIV("t-view", this.$content),
            this.$rowHeads = $DIV("t-rowheads", this.$view),
            this.$headRuler = $DIV("t-head-ruler i-16 i-light-grey i-reload", this.$container),
            $(this.$headRuler).touch($.proxy(this.reload, this)),
            this.$footRuler = $DIV("t-foot-ruler", this.$container),
            this.$scrollbarVContainer = $DIV("t-scrollbar-v-container", this.$container),
            this.$scrollbarV = $DIV("t-scrollbar-v", this.$scrollbarVContainer),
            this.$scrollbarHContainer = $DIV("t-scrollbar-h-container", this.$container),
            this.$scrollbarH = $DIV("t-scrollbar-h", this.$scrollbarHContainer),
            this.$scrollHIndicator = $DIV("t-scroll-h-indicator", this.$container),
            this.$scrollVIndicator = $DIV("t-scroll-v-indicator", this.$container),
            this.registerHeadResizeListeners(),
            this.registerHeadDragListeners(),
            this.registerScrollListeners(),
            this.registerBodyListeners(),
            this.$body.addEventListener("contextmenu", $.proxy(this.openContextMenu, this), !1),
            this.$head.addEventListener("contextmenu", (function(e) {
                e.preventDefault()
            }), !1),
            this.$foot.addEventListener("contextmenu", (function(e) {
                e.preventDefault()
            }), !1),
            this.resizeListener = T.debounce($.proxy(this.resizeListener, this), 100),
            this.sideEditorOptions = {
                close: $.proxy(this.unselect, this),
                next: $.proxy(this.editorDown, this),
                prev: $.proxy(this.editorUp, this),
                first: $.proxy(this.editorFirst, this),
                last: $.proxy(this.editorLast, this),
                duplicate: $.proxy(this.duplicate, this),
                getSelectedNids: $.proxy(this.getSelectedNids, this)
            },
            database.on("rename", void 0, this.nodeRenamed, this),
            database.on("create", void 0, this.nodeCreated, this),
            database.on("change", void 0, this.nodeChanged, this),
            database.on("remove", void 0, this.nodeRemoved, this),
            database.on("schema", void 0, this.schemaChanged, this)
        }
        function Yn(e, t) {
            var i = Object.keys(e);
            if (Object.getOwnPropertySymbols) {
                var o = Object.getOwnPropertySymbols(e);
                t && (o = o.filter((function(t) {
                    return Object.getOwnPropertyDescriptor(e, t).enumerable
                }))),
                i.push.apply(i, o)
            }
            return i
        }
        function Xn(e) {
            for (var t = 1; t < arguments.length; t++) {
                var i = null != arguments[t] ? arguments[t] : {};
                t % 2 ? Yn(Object(i), !0).forEach((function(t) {
                    K()(e, t, i[t])
                })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(i)) : Yn(Object(i)).forEach((function(t) {
                    Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(i, t))
                }))
            }
            return e
        }
        function Gn() {
            var e = this;
            this.popupTabsOpen = null,
            this.$controls = $('<div class="hud-menu-group" style="margin-left:12px">'),
            database.isAdmin() && $('<div class="hud-menu-button i-32-24 i-light-grey i-setting-filter" title="' + htmlEscape(locale.editColumns) + '" style="margin-right:2px">').appendTo(this.$controls).touch((function() {
                e.popupColumnMenu()
            })),
            this.$popupActions = $(`<div \n            class="hud-menu-button i-32-24 i-light-grey i-setting-settings" \n            title="${htmlEscape(locale.actions)}" \n         />\n        <div class="hud-menu-button i-24-12 i-light-grey i-line-down-thick table-head-settings-arrow"/>`).appendTo(this.$controls).touch((function() {
                e.popupActions()
            })),
            this.$searchContainer = $('<div class="hud-menu-search">').appendTo(this.$controls),
            this.$menuSmall = $('<span style="display: none">').appendTo(this.$controls),
            this.$popupContext = $('<div class="hud-menu-button i-24-24 i-light-grey i-column">').appendTo(this.$menuSmall).touch((function(t) {
                e.popupContextMenu(t)
            })),
            this.$searchPlaceholder = $('<div class="hud-menu-search-placeholder">').appendTo(this.$searchContainer),
            $('<div class="i-24-16 i-light-grey i-search table-head-search">').appendTo(this.$searchPlaceholder),
            this.$searchText = $('<div class="table-head-search-text">').appendTo(this.$searchPlaceholder),
            this.$search = $('<input type="text" class="hud-menu-search-input" style="display:none" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">').appendTo(this.$searchContainer).change($.proxy(this.searchChanged, this)),
            this.$searchCancel = $('<div class="i-32-16 i-light-grey i-close" style="margin-left:-32px;margin-top:4px;display:none">').appendTo($('<div style="width:0;flex:0 0 0px;-webkit-flex:0 0 0px">').appendTo(this.$searchContainer)).touch((function() {
                e.$search.val(""),
                e.searchChanged()
            })),
            this.$searchPlaceholder.touch((function() {
                e.$searchPlaceholder.css("display", "none"),
                e.$search.css("display", "").focus()
            })),
            this.$search.blur((function() {
                e.$searchPlaceholder.css("display", ""),
                e.$search.css("display", "none")
            })),
            this.$menuContainer = $("<div>"),
            this.$tabs = $('<div style="display:flex;display:-webkit-flex;align-items:center;-webkit-align-items:center;width:100%;">'),
            this.views = [],
            this.selectedView = {},
            this.navigationStateByTid = {},
            this.table = new qn(this),
            this.renderers = {
                chart: new xn(this),
                cards: new wn(this),
                gantt: new Mn(this),
                kanban: new An(this),
                full: new Cn(this),
                pivot: new Hn(this)
            },
            database.on("schema", void 0, this.schemaChanged, this),
            database.on("change", void 0, this.dataChanged, this),
            database.on("create", void 0, this.dataChanged, this),
            database.on("remove", void 0, this.dataChanged, this),
            database.on("view", void 0, this.viewsChanged, this)
        }
        function Jn(e, t) {
            var i = Object.keys(e);
            if (Object.getOwnPropertySymbols) {
                var o = Object.getOwnPropertySymbols(e);
                t && (o = o.filter((function(t) {
                    return Object.getOwnPropertyDescriptor(e, t).enumerable
                }))),
                i.push.apply(i, o)
            }
            return i
        }
        function Kn(e) {
            for (var t = 1; t < arguments.length; t++) {
                var i = null != arguments[t] ? arguments[t] : {};
                t % 2 ? Jn(Object(i), !0).forEach((function(t) {
                    K()(e, t, i[t])
                })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(i)) : Jn(Object(i)).forEach((function(t) {
                    Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(i, t))
                }))
            }
            return e
        }
        qn.prototype.mode = "table",
        qn.prototype.destroy = function() {
            database.off("rename", void 0, this.nodeRenamed, this),
            database.off("create", void 0, this.nodeCreated, this),
            database.off("change", void 0, this.nodeChanged, this),
            database.off("remove", void 0, this.nodeRemoved, this),
            database.off("schema", void 0, this.schemaChanged, this),
            this.hide(),
            this.$container.parentNode && this.$container.parentNode.removeChild(this.$container)
        },
        (Wn = qn).prototype.cutEnabled = function() {
            return "cell" === this.selectionMode || "block" === this.selectionMode
        },
        Wn.prototype.cut = function() {
            var e = this.getSelectedText();
            return this.editorDelete(), e
        },
        Wn.prototype.copyEnabled = function() {
            return !!this.selectionMode
        },
        Wn.prototype.copy = function() {
            return this.getSelectedText()
        },
        Wn.prototype.pasteEnabled = function() {
            var e = this.getSelectedColumn(),
                t = this.getSelectedRow();
            return null != e && null != t
        },
        Wn.prototype.paste = function(e) {
            var t = this,
                i = this.getSelectedColumn(),
                o = this.getSelectedRow();
            if (null == i || null == o)
                return !1;
            for (var n = util.parseTABDelimitedTable(e), s = this.type, a = s.id, r = this.rows, l = this.cols, c = this.models, d = (this.groups, null != this.cidxGroup), h = database.canCreate(s), p = [], u = i, f = o, m = 1, g = 0; g < n.length; g++) {
                var v = o + g,
                    b = n[g],
                    y = v >= r.length,
                    w = y ? void 0 : r[v],
                    x = y ? void 0 : c[w];
                if (y || x) {
                    var T = {};
                    y ? (T._type = a, T._clientId = m++) : T._id = w;
                    for (var C = 0; C < b.length; C++) {
                        var k = i + C,
                            S = b[C];
                        if (l[k]) {
                            var E = this.getWritableField(k);
                            if (E) {
                                var _ = E.id;
                                if ((y || database.canWriteNodeField(w, _)) && (!y || h)) {
                                    var D = y ? void 0 : x.values[_],
                                        M = E.parseClipboard(S);
                                    E.equals(D, M) || (T[_] = M)
                                }
                            }
                        }
                    }
                    p.push(T),
                    u = Math.max(u, i + b.length),
                    f++
                }
            }
            function N() {
                d ? (t.reload(), $.loading(!1)) : t.calc(t._reloadId, r, (function() {
                    $.loading(!1),
                    t.aggregate(),
                    t.updateRows(),
                    t.updateFoot(),
                    t.selectBlock(o, i, f - 1, u - 1)
                }))
            }
            p.length && ($.loading(!0), t.silent = !0, database.updateNodes(p, (function(e, i) {
                if (t.silent = !1, e)
                    return $.loading(!1), void $.alert(e);
                if (m > 1) {
                    r = r.slice();
                    for (var o = [], n = 1; n <= m; n++) {
                        var s = i[n];
                        s && (r.push(s), o.push(s))
                    }
                    database.loadNodes2(o, t.getDependencies(), (function(e) {
                        N()
                    }))
                } else
                    N()
            })))
        },
        Wn.prototype.getTextAtCell = function(e, t) {
            var i = this.rows,
                o = this.cols,
                n = this.models,
                s = this.groups,
                a = i[t];
            if (!a)
                return "";
            var r = n[a],
                l = s[a],
                c = o[e];
            return c ? r ? c.field.formatClipboard(r.values[e]) : l ? e === this.cidxGroup ? c.field.formatClipboard(l.values[e]) : c.agg ? c.aggType.formatClipboard(l.values[e]) : "" : "" : ""
        },
        Wn.prototype.getTextAtRange = function(e, t, i, o) {
            if (e > i) {
                var n = i;
                i = e,
                e = n
            }
            if (t > o) {
                var s = o;
                o = t,
                t = s
            }
            for (var a = this.rows, r = this.cols, l = this.models, c = this.groups, d = "", h = t; h <= o; h++) {
                for (var p = e; p <= i; p++) {
                    var u = "",
                        f = a[h];
                    if (f) {
                        var m = l[f],
                            g = c[f],
                            v = r[p];
                        v && (m ? u = v.field.formatClipboard(m.values[p]) : g && (p === this.cidxGroup ? u = v.field.formatClipboard(g.values[p]) : v.agg && (u = v.aggType.formatClipboard(g.values[p]))))
                    }
                    d += util.formatTABDelimitedCell(u),
                    p < i && (d += "\t")
                }
                h < o && (d += "\r\n")
            }
            return d
        },
        function(e) {
            e.prototype.isEditable = function(e, t) {
                var i = this.cols[e];
                if (!i)
                    return !1;
                if (!i.expression)
                    return !1;
                var o = i.expression.toString(),
                    n = this.type.fields[o];
                if (!n)
                    return !1;
                if ("file" === n.base || "html" === n.base)
                    return !1;
                if (!database.canWrite(n))
                    return !1;
                var s = this.rows[t];
                return !!s && (!!this.models[s] && !!database.canWriteNodeField(s, o))
            },
            e.prototype.startEdit = function(e, t) {
                if (null == e && (e = this.getSelectedColumn()), null == t && (t = this.getSelectedRow()), this.editor) {
                    if (this.editor.isCell(e, t))
                        return void this.editor.startEdit();
                    this.editor.destroy(),
                    this.editor = void 0
                }
                var i = this.cols[e];
                if (i && i.expression) {
                    var o = i.expression.toString(),
                        n = this.type.fields[o];
                    if (n && "file" !== n.base && "html" !== n.base && database.canWrite(n)) {
                        var s = this.rows[t];
                        s && this.models[s] && (this.editor = tables.createCellEditor(this, o, s, e, t), this.editor.startEdit())
                    }
                }
            },
            e.prototype.stopEdit = function(e) {
                this.editor && (this.editor.stopEdit(e), this.editor.destroy(), this.editor = void 0)
            },
            e.prototype.updateEditor = function() {
                this.editor && this.editor.update()
            },
            e.prototype.editorInsert = function(e) {
                var t = this,
                    i = !!this.editor;
                t.stopEdit(!0);
                var o = this.type;
                if (database.canCreate(o)) {
                    var n = this.getSelectedColumn(),
                        s = this.getSelectedRow(),
                        a = "start" === e ? 0 : "end" === e ? t.rows.length : "up" === e ? null != s ? s : 0 : "down" === e && null != s ? s + 1 : t.rows.length;
                    t.silent = !0,
                    $.loading(!0),
                    database.create(this.type.id, {}, (function(e, o) {
                        if (t.silent = !1, $.loading(!1), e)
                            return $.alert(e);
                        if (o) {
                            var s = o._id;
                            t.models[s] = {
                                id: s,
                                values: []
                            },
                            t.rows.splice(a, 0, s),
                            t.recalc(s, (function() {
                                t.aggregate(),
                                t.updateRows(),
                                t.updateFoot(),
                                t.selectCell(a, n),
                                i && t.startEdit(n, a)
                            }))
                        }
                    }))
                }
            },
            e.prototype.editorPageUp = function() {
                this.rows;
                var e = this.selectionR0 || 0,
                    t = Math.max(0, e - this.rowsPerPage() + 1);
                this.selectCell(t, this.selectionC0)
            },
            e.prototype.editorPageDown = function() {
                var e = this.rows.length - 1,
                    t = this.rowsPerPage(),
                    i = this.selectionR0 || 0,
                    o = Math.min(e, i + t),
                    n = Math.min(e, o + t - 1);
                this.scrollToCell(void 0, n),
                this.selectCell(o, this.selectionC0)
            },
            e.prototype.editorNextGroup = function() {
                if (null != this.cidxGroup)
                    for (var e = this.rows, t = this.groups, i = (null == this.selectionR0 ? -1 : this.selectionR0) + 1; i < e.length; i++)
                        if (t[e[i]])
                            return void this.selectCell(i, void 0)
            },
            e.prototype.editorPrevGroup = function() {
                if (null != this.cidxGroup)
                    for (var e = this.rows, t = this.groups, i = (this.selectionR0 || e.length) - 1; i >= 0; i--)
                        if (t[e[i]])
                            return void this.selectCell(i, void 0)
            },
            e.prototype.editorUp = function(e) {
                var t = this.cols,
                    i = this.rows,
                    o = !!this.editor;
                if (this.stopEdit(!0), t.length && i.length)
                    if (!e || "cell" !== this.selectionMode && "block" !== this.selectionMode) {
                        var n = void 0,
                            s = 0;
                        this.selectionMode ? (n = this.getSelectedColumn(), s = this.selectionR0 - 1) : s = i.length - 1,
                        s < 0 && (s = i.length - 1),
                        this.selectCell(s, n),
                        o && this.startEdit(n, s)
                    } else
                        this.selectionR0 === this.selectionR1 && (this.extendSelectionUp = !0),
                        this.extendSelectionUp ? this.selectBlock(this.selectionR1, this.selectionC0, Math.max(0, this.selectionR0 - 1), this.selectionC1) : this.selectBlock(this.selectionR0, this.selectionC0, Math.max(0, this.selectionR1 - 1), this.selectionC1),
                        this.scrollToCell(void 0, this.selectionR1)
            },
            e.prototype.editorDown = function(e) {
                var t = this.cols,
                    i = this.rows,
                    o = !!this.editor;
                if (this.stopEdit(!0), t.length && i.length)
                    if (!e || "cell" !== this.selectionMode && "block" !== this.selectionMode) {
                        var n = void 0,
                            s = 0;
                        this.selectionMode && (n = this.getSelectedColumn(), s = this.selectionR0 + 1),
                        s >= i.length && (s = 0),
                        this.selectCell(s, n),
                        o && this.startEdit(n, s)
                    } else
                        this.selectionR0 === this.selectionR1 && (this.extendSelectionUp = !1),
                        this.extendSelectionUp ? this.selectBlock(this.selectionR1, this.selectionC0, Math.min(i.length - 1, this.selectionR0 + 1), this.selectionC1) : this.selectBlock(this.selectionR0, this.selectionC0, Math.min(i.length - 1, this.selectionR1 + 1), this.selectionC1),
                        this.scrollToCell(void 0, this.selectionR1)
            },
            e.prototype.editorPrev = function(e) {
                if ("cell" === this.selectionMode || "block" === this.selectionMode) {
                    var t = !!this.editor;
                    this.stopEdit(!0);
                    var i = this.cols,
                        o = this.rows;
                    if (i.length && o.length)
                        if (!e || "cell" !== this.selectionMode && "block" !== this.selectionMode) {
                            var n = this.selectionC0 - 1,
                                s = this.selectionR0;
                            n < 0 && (n = i.length - 1, s--),
                            s < 0 && (s = o.length - 1),
                            this.selectCell(s, n),
                            t && this.startEdit(n, s)
                        } else
                            this.selectionC0 === this.selectionC1 && (this.extendSelectionLeft = !0),
                            this.extendSelectionLeft ? (this.selectBlock(this.selectionR0, this.selectionC1, this.selectionR1, Math.max(0, this.selectionC0 - 1)), this.scrollToCell(this.selectionC0, void 0)) : (this.selectBlock(this.selectionR0, this.selectionC0, this.selectionR1, Math.max(0, this.selectionC1 - 1)), this.scrollToCell(this.selectionC1, void 0))
                }
            },
            e.prototype.editorNext = function(e) {
                if ("cell" === this.selectionMode || "block" === this.selectionMode) {
                    var t = !!this.editor;
                    this.stopEdit(!0);
                    var i = this.cols,
                        o = this.rows;
                    if (i.length && o.length)
                        if (!e || "cell" !== this.selectionMode && "block" !== this.selectionMode) {
                            var n = this.selectionC0 + 1,
                                s = this.selectionR0;
                            n >= i.length && (n = 0, s++),
                            s >= o.length && (s = 0),
                            this.selectCell(s, n),
                            t && this.startEdit(n, s)
                        } else
                            this.selectionC0 === this.selectionC1 && (this.extendSelectionLeft = !1),
                            this.extendSelectionLeft ? (this.selectBlock(this.selectionR0, this.selectionC1, this.selectionR1, Math.min(this.selectionC0 + 1, i.length - 1)), this.scrollToCell(this.selectionC0, void 0)) : (this.selectBlock(this.selectionR0, this.selectionC0, this.selectionR1, Math.min(this.selectionC1 + 1, i.length - 1)), this.scrollToCell(this.selectionC1, void 0))
                }
            },
            e.prototype.editorFirst = function(e) {
                var t = !!this.editor;
                if (this.stopEdit(!0), !e || "cell" !== this.selectionMode && "block" !== this.selectionMode) {
                    var i = this.getSelectedColumn();
                    this.rows.length > 0 && (this.selectCell(0, i), t && this.startEdit(i, 0))
                } else
                    this.selectBlock(0, this.selectionC0, this.selectionR1, this.selectionC1)
            },
            e.prototype.editorLast = function(e) {
                var t = !!this.editor;
                if (this.stopEdit(!0), !e || "cell" !== this.selectionMode && "block" !== this.selectionMode) {
                    var i = this.getSelectedColumn(),
                        o = this.rows.length - 1;
                    o >= 0 && (this.selectCell(o, i), t && this.startEdit(i, o))
                } else
                    this.selectBlock(this.selectionR0, this.selectionC0, this.rows.length - 1, this.selectionC1)
            },
            e.prototype.editorDelete = function() {
                var e = this.type,
                    t = this.rows,
                    i = this.cols,
                    o = this.models,
                    n = this.selectionR0,
                    s = this.selectionR1,
                    a = this.selectionC0,
                    r = this.selectionC1,
                    l = this.selectionMode;
                if ("block" === l) {
                    for (var c = [], d = n; d <= s; d++) {
                        if (o[m = t[d]]) {
                            for (var h = 0, p = {
                                    _id: m
                                }, u = a; u <= r; u++) {
                                var f = i[u].expression.toString();
                                (g = e.fields[f]) && database.canWrite(g) && (p[f] = null, h++)
                            }
                            h > 0 && c.push(p)
                        }
                    }
                    c.length && ($.loading(!0), database.updateNodes(c, (function(e) {
                        $.loading(!1),
                        e && $.alert(e)
                    })))
                } else if ("cell" === l) {
                    var m;
                    if (o[m = t[n]]) {
                        var g;
                        f = i[a].expression.toString();
                        (g = e.fields[f]) && database.canWrite(g) && database.update(m, f, null)
                    }
                }
            },
            e.prototype.isEditing = function() {
                return !!this.editor
            }
        }(qn),
        function(e) {
            e.prototype.menuNextRecordEnabled = function() {
                return this.rows.length > 0
            },
            e.prototype.menuNextRecord = function() {
                this.editorDown()
            },
            e.prototype.menuPrevRecordEnabled = function() {
                return this.rows.length > 0
            },
            e.prototype.menuPrevRecord = function() {
                this.editorUp()
            },
            e.prototype.menuFirstRecordEnabled = function() {
                return this.rows.length > 0
            },
            e.prototype.menuFirstRecord = function() {
                this.editorFirst()
            },
            e.prototype.menuLastRecordEnabled = function() {
                return this.rows.length > 0
            },
            e.prototype.menuLastRecord = function() {
                this.editorLast()
            },
            e.prototype.menuCreateRecordEnabled = function() {
                return !(!this.type || !database.canCreate(this.type))
            },
            e.prototype.menuCreateRecord = function() {
                this.create()
            },
            e.prototype.menuDuplicateRecordEnabled = function() {
                return !!(this.getSelectedNid() && this.type && database.canCreate(this.type))
            },
            e.prototype.menuDuplicateRecord = function() {
                this.duplicate()
            },
            e.prototype.menuDeleteRecordEnabled = function() {
                return !!(this.getSelectedNid() && this.type && database.canDelete(this.type))
            },
            e.prototype.menuDeleteRecord = function() {
                this.remove()
            },
            e.prototype.menuPrintRecordEnabled = function() {
                return null != this.getSelectedNid() && !1 !== database.authorizationPrint
            },
            e.prototype.menuPrintRecord = function() {
                this.print()
            },
            e.prototype.menuCloseRecordEnabled = function() {
                return null != this.getSelectedNid()
            },
            e.prototype.menuCloseRecord = function() {
                this.unselect()
            },
            e.prototype.menuNewViewEnabled = function() {
                return database.isAdmin()
            },
            e.prototype.menuNewView = function() {
                database.isAdmin() && this.container.createView()
            },
            e.prototype.menuRenameViewEnabled = function() {
                return database.isAdmin()
            },
            e.prototype.menuRenameView = function() {
                database.isAdmin() && this.container.renameView()
            },
            e.prototype.menuDeleteViewEnabled = function() {
                return database.isAdmin()
            },
            e.prototype.menuDeleteView = function() {
                database.isAdmin() && this.container.removeView()
            },
            e.prototype.menuEditColumnsEnabled = function() {
                return database.isAdmin()
            },
            e.prototype.menuEditColumns = function() {
                database.isAdmin() && this.container.popupColumnMenu()
            },
            e.prototype.menuShowViewAsFormEnabled = function() {
                return database.isAdmin()
            },
            e.prototype.menuShowViewAsForm = function() {
                database.isAdmin() && this.container.showForm()
            },
            e.prototype.menuShowViewAsTableEnabled = function() {
                return database.isAdmin()
            },
            e.prototype.menuShowViewAsTable = function() {
                database.isAdmin() && this.container.showTable()
            },
            e.prototype.menuShowViewAsChartEnabled = function() {
                return database.isAdmin()
            },
            e.prototype.menuShowViewAsChart = function() {
                database.isAdmin() && this.container.showChart()
            },
            e.prototype.menuFindInViewEnabled = function() {
                return !0
            },
            e.prototype.menuFindInView = function() {
                this.openFindMenu()
            },
            e.prototype.menuSelectAllRecordsEnabled = function() {
                return !0
            },
            e.prototype.menuSelectAllRecords = function() {
                this.chooseAll()
            },
            e.prototype.menuClearSelectionEnabled = function() {
                return !T.isEmpty(this.midChoosen)
            },
            e.prototype.menuClearSelection = function() {
                this.clearChoosen()
            },
            e.prototype.menuToggleSelectionEnabled = function() {
                return !T.isEmpty(this.midChoosen)
            },
            e.prototype.menuToggleSelection = function() {
                this.toggleChoosen()
            },
            e.prototype.menuShowAllRecordsEnabled = function() {
                return !T.isEmpty(this.midChoosen)
            },
            e.prototype.menuShowAllRecords = function() {
                this.showAll()
            },
            e.prototype.menuShowSelectedRecordsEnabled = function() {
                return !T.isEmpty(this.midChoosen)
            },
            e.prototype.menuShowSelectedRecords = function() {
                this.showOnlyChoosen()
            },
            e.prototype.menuExpandAllGroupsEnabled = function() {
                return null != this.cidxGroup
            },
            e.prototype.menuExpandAllGroups = function() {
                this.expandAll()
            },
            e.prototype.menuCollapseAllGroupsEnabled = function() {
                return null != this.cidxGroup
            },
            e.prototype.menuCollapseAllGroups = function() {
                this.collapseAll()
            },
            e.prototype.menuPrintViewEnabled = function() {
                return !!database.authorizationPrint
            },
            e.prototype.menuPrintView = function() {
                database.authorizationPrint && Object(I.a)(this)
            },
            e.prototype.menuImportDataEnabled = function() {
                return !!database.authorizationImport
            },
            e.prototype.menuImportData = function() {
                database.authorizationImport && new Ye({
                    tid: this.type.id
                })
            },
            e.prototype.menuExportDataEnabled = function() {
                return !!database.authorizationExport
            },
            e.prototype.menuExportData = function() {
                database.authorizationExport && this.exportData((function(e) {
                    e && $.alert(e)
                }))
            },
            e.prototype.menuMassDataUpdateEnabled = function() {
                return !!database.authorizationMassDataUpdate
            },
            e.prototype.menuMassDataUpdate = function() {
                database.authorizationMassDataUpdate && new gn(this)
            },
            e.prototype.menuReloadViewEnabled = function() {
                return !0
            },
            e.prototype.menuReloadView = function() {
                this.reload()
            },
            e.prototype.menuNewTableEnabled = function() {
                return database.isAdminEnabled()
            },
            e.prototype.menuNewTable = function() {
                database.isAdminEnabled() && new _t({})
            },
            e.prototype.menuEditTableEnabled = function() {
                return database.isAdminEnabled()
            },
            e.prototype.menuEditTable = function() {
                database.isAdminEnabled() && new _t({
                    type: this.tid
                })
            },
            e.prototype.menuDeleteTableEnabled = function() {
                return database.isAdminEnabled()
            },
            e.prototype.menuDeleteTable = function() {
                var e = this;
                $.dialog({
                    closable: !0,
                    caption: locale.removeTable,
                    message: locale.confirmRemoveTable,
                    buttons: [{
                        color: "red",
                        caption: locale.removeTable,
                        callback: function() {
                            database.schema.removeType(e.type)
                        }
                    }]
                })
            },
            e.prototype.menuPageUpEnabled = function() {
                return this.rows.length > 0
            },
            e.prototype.menuPageUp = function() {
                this.editorPageUp()
            },
            e.prototype.menuPageDownEnabled = function() {
                return this.rows.length > 0
            },
            e.prototype.menuPageDown = function() {
                this.editorPageDown()
            },
            e.prototype.menuNextGroupEnabled = function() {
                return null != this.cidxGroup
            },
            e.prototype.menuNextGroup = function() {
                this.editorNextGroup()
            },
            e.prototype.menuPrevGroupEnabled = function() {
                return null != this.cidxGroup
            },
            e.prototype.menuPrevGroup = function() {
                this.editorPrevGroup()
            },
            e.prototype.menuExpandGroupEnabled = e.prototype.menuCollapseGroupEnabled = e.prototype.menuToggleGroupEnabled = function() {
                return !!this.groups[this.rows[this.selectionR0]]
            },
            e.prototype.menuExpandGroup = function() {
                this.expand(this.rows[this.selectionR0])
            },
            e.prototype.menuCollapseGroup = function() {
                this.collapse(this.rows[this.selectionR0])
            },
            e.prototype.menuToggleGroup = function() {
                this.toggle(this.rows[this.selectionR0])
            }
        }(qn),
        function(e) {
            e.prototype.registerScrollListeners = function() {
                TOUCH ? (this.registerScrollTouchListeners(), this.registerScrollbarVTouchListeners()) : (this.registerScrollMouseListeners(), this.registerScrollbarVMouseListeners(), this.registerScrollbarHMouseListeners()),
                this.registerRowResizeListeners()
            },
            e.prototype.registerRowResizeListeners = function() {
                var e = this;
                this.$view.addEventListener(TOUCH ? EVENT_touchstart : "mousedown", (function(t) {
                    if (TOUCH && 1 !== t.touches.length)
                        return;
                    var i = t.target;
                    if (!$(i).is(".t-rowhead-resizer"))
                        return;
                    var o = TOUCH ? t.touches[0].clientY : t.clientY,
                        n = e.rowHeight,
                        s = e.scrollTop;
                    TOUCH ? (EVENT_target(t).addEventListener(EVENT_touchend, r, !1), EVENT_target(t).addEventListener(EVENT_touchmove, a, !1)) : (window.addEventListener("mouseup", r, !1), window.addEventListener("mousemove", a, !1));
                    function a(t) {
                        if (!TOUCH || 1 === t.touches.length) {
                            var i = (TOUCH ? t.touches[0].clientY : t.clientY) - o;
                            n < 40 ? n + i > 40 && (i = Math.max(40 - n, i - 24)) : n + i < 40 && (i = Math.min(40 - n, i + 24));
                            var a = Math.min(120, Math.max(28, Math.round(n + i))),
                                r = a - n;
                            e.rowHeight = a,
                            e.scrollTop = s + s / n * r,
                            e.resizeRows(),
                            e.updateSelection(),
                            e.updateRows(),
                            t.preventDefault()
                        }
                    }
                    function r(t) {
                        TOUCH && 0 !== t.touches.length || (TOUCH ? (EVENT_target(t).removeEventListener(EVENT_touchend, r, !1), EVENT_target(t).removeEventListener(EVENT_touchmove, a, !1)) : (window.removeEventListener("mousemove", a, !1), window.removeEventListener("mouseup", r, !1)), t.preventDefault(), e.saveTableRowHeight(e.rowHeight))
                    }
                    t.preventDefault(),
                    t.stopPropagation()
                }), !1)
            },
            e.prototype.registerScrollbarVMouseListeners = function() {
                var e = this;
                this.$scrollbarV.addEventListener("mousedown", (function(t) {
                    t.target;
                    var i = t.clientY,
                        o = e.scrollTop,
                        n = e.rows.length + 1,
                        s = e.containerHeight() - e.headHeight - e.footHeight,
                        a = s - 4,
                        r = Math.max(s, (e.rowHeight + 0) * n),
                        l = r / a;
                    function c(t) {
                        var n = t.clientY - i;
                        e.scrollTo(e.scrollLeft, Math.max(0, Math.min(r - s, Math.round(o + l * n)))),
                        t.preventDefault()
                    }
                    window.addEventListener("mouseup", (function e(t) {
                        window.removeEventListener("mousemove", c, !1),
                        window.removeEventListener("mouseup", e, !1),
                        t.preventDefault()
                    }), !1),
                    window.addEventListener("mousemove", c, !1),
                    t.preventDefault()
                }), !1)
            },
            e.prototype.registerScrollbarVTouchListeners = function() {
                var e = this;
                this.$scrollbarV.addEventListener(EVENT_touchstart, (function(t) {
                    if (1 !== t.touches.length)
                        return;
                    var i = t.touches[0].clientY,
                        o = e.scrollTop,
                        n = e.rows.length + 1,
                        s = e.containerHeight() - e.headHeight - e.footHeight,
                        a = s - 4,
                        r = Math.max(s, (e.rowHeight + 0) * n),
                        l = r / a;
                    function c(t) {
                        if (1 === t.touches.length) {
                            var n = t.touches[0].clientY - i;
                            e.scrollTo(e.scrollLeft, Math.max(0, Math.min(r - s, Math.round(o + l * n)))),
                            t.preventDefault()
                        }
                    }
                    EVENT_target(t).addEventListener(EVENT_touchmove, c, !1),
                    EVENT_target(t).addEventListener(EVENT_touchend, (function e(t) {
                        0 === t.touches.length && (EVENT_target(t).removeEventListener(EVENT_touchmove, c, !1), EVENT_target(t).removeEventListener(EVENT_touchend, e, !1), t.preventDefault())
                    }), !1)
                }), !1)
            },
            e.prototype.registerScrollbarHMouseListeners = function() {
                var e = this;
                this.$scrollbarH.addEventListener("mousedown", (function(t) {
                    t.target;
                    var i = t.clientX,
                        o = e.scrollLeft,
                        n = e.$container.clientWidth,
                        s = n - 4,
                        a = e.viewWidth + 40,
                        r = a / s;
                    function l(t) {
                        var s = t.clientX - i;
                        e.scrollTo(Math.max(0, Math.min(a - n, Math.round(o + r * s))), e.scrollTop),
                        t.preventDefault()
                    }
                    window.addEventListener("mouseup", (function e(t) {
                        window.removeEventListener("mousemove", l, !1),
                        window.removeEventListener("mouseup", e, !1),
                        t.preventDefault()
                    }), !1),
                    window.addEventListener("mousemove", l, !1),
                    t.preventDefault()
                }), !1)
            },
            e.prototype.registerScrollMouseListeners = function() {
                var e = this;
                function t(t) {
                    var i = Math.max(0, (e.rows.length + 1) * (e.rowHeight + 0) - e.containerHeight() + e.headHeight + e.footHeight),
                        o = (OSX_10_9_MODE ? -t.wheelDeltaY : t.deltaY) * (1 == t.deltaMode ? e.rowHeight + 0 : 2 == t.deltaMode ? window.getHeight() : 1),
                        n = OSX_10_9_MODE ? t.wheelDeltaX : -t.deltaX;
                    Math.abs(n) > Math.abs(o) ? o = 0 : n = 0;
                    var s = e.scrollTop,
                        a = Math.min(Math.max(s + o, 0), i),
                        r = Math.min(Math.max(0, e.scrollLeft - n), Math.max(0, e.viewWidth + 40 - e.$container.clientWidth));
                    e.scrollTo(r, a),
                    t.preventDefault()
                }
                OSX_10_9_MODE ? e.$body.addEventListener("mousewheel", t, !1) : e.$body.addEventListener("wheel", t, !1)
            },
            e.prototype.registerScrollTouchListeners = function() {
                var e,
                    t = this,
                    i = 0,
                    o = 0,
                    n = 0,
                    s = 0,
                    a = 0,
                    r = 0,
                    l = 0,
                    c = null,
                    d = !1,
                    h = 500 / 60,
                    p = !1;
                function u(e) {
                    if (1 === e.touches.length) {
                        d = !1;
                        var i = e.touches[0].clientX,
                            o = e.touches[0].clientY,
                            a = i - n,
                            r = o - s;
                        if (!p) {
                            if (a * a + r * r <= 4)
                                return;
                            p = !0
                        }
                        c || (c = Math.abs(a) > Math.abs(r) ? "H" : "V"),
                        "H" === c ? r = 0 : a = 0;
                        var l = Math.min(Math.max(0, t.scrollLeft - a), Math.max(0, t.viewWidth + 40 - t.$container.clientWidth)),
                            h = t.scrollTop - r;
                        t.scrollTo(l, h),
                        n = i,
                        s = o,
                        e.preventDefault()
                    }
                }
                function f(g) {
                    if (0 === g.touches.length && (window.removeEventListener(EVENT_touchmove, u, !1), window.removeEventListener(EVENT_touchend, f, !1), p)) {
                        var v = (new Date).getTime() - e;
                        a = "H" === c ? (n - i) * h / v : 0,
                        r = "V" === c ? t.scrollTop < 0 ? 0 : (s - o) * h / v : 0,
                        l = 0,
                        d = !0,
                        requestAnimationFrame(m)
                    }
                }
                function m() {
                    if (d) {
                        var e = t.scrollTop,
                            i = t.scrollLeft,
                            o = Math.max(0, (t.rows.length + 1) * (t.rowHeight + 0) - t.containerHeight() + t.headHeight + t.footHeight);
                        if (e < 0) {
                            var n = e - 10 * e * h / 500;
                            Math.abs(n) < .1 && (n = 0),
                            t.scrollTo(i, n),
                            requestAnimationFrame(m)
                        } else if (0 === e)
                            d = !1;
                        else if (e > o) {
                            n = e - 10 * (e - o) * h / 500;
                            Math.abs(n - o) < .1 && (n = o),
                            t.scrollTo(i, n),
                            requestAnimationFrame(m)
                        } else if (e === o)
                            d = !1;
                        else if (l >= 500)
                            d = !1;
                        else {
                            var s = 1 - l * l / 25e4;
                            if (!isNaN(s)) {
                                var c = s * a,
                                    p = s * r,
                                    u = Math.min(Math.max(0, i - c), Math.max(0, t.viewWidth + 40 - t.$container.clientWidth));
                                n = e - p;
                                t.scrollTo(u, n)
                            }
                            l += h,
                            requestAnimationFrame(m)
                        }
                    }
                }
                t.$body.addEventListener(EVENT_touchstart, (function(t) {
                    if (1 !== t.touches.length)
                        return;
                    d = !1,
                    i = n = t.touches[0].clientX,
                    o = s = t.touches[0].clientY,
                    e = (new Date).getTime(),
                    c = null,
                    p = !1,
                    window.addEventListener(EVENT_touchmove, u, !1),
                    window.addEventListener(EVENT_touchend, f, !1)
                }), !1)
            },
            e.prototype.registerHeadResizeListeners = function() {
                var e = this;
                function t(t) {
                    if (!TOUCH || 1 === t.touches.length) {
                        var o = t.target;
                        if ("t-head-resizer" === o.className) {
                            var n = o.parentNode.getAttribute("data-cidx");
                            if (n) {
                                n = parseInt(n);
                                var s = e.cols[n];
                                if (s) {
                                    var a = s.width,
                                        r = TOUCH ? t.touches[0].clientX : t.clientX,
                                        l = TOUCH ? t.touches[0].clientY : t.clientY,
                                        c = !1;
                                    return TOUCH ? (EVENT_target(t).addEventListener(EVENT_touchmove, d, !1), EVENT_target(t).addEventListener(EVENT_touchend, h, !1)) : (document.addEventListener("mousemove", d, !1), document.addEventListener("mouseup", h, !1)), i(t), !1
                                }
                            }
                        }
                    }
                    function d(t) {
                        if (!TOUCH || 1 === t.touches.length) {
                            var o = TOUCH ? t.touches[0].clientX : t.clientX,
                                n = TOUCH ? t.touches[0].clientY : t.clientY,
                                d = o - r,
                                h = n - l,
                                p = Math.abs(d) > Math.abs(h) ? d : h;
                            if (Math.abs(p) > 1 && (c = !0), c) {
                                c = !0;
                                var u = Math.max(e.minColWidth, a + p);
                                s.width = u,
                                e.resizeColumns()
                            }
                            return i(t), !1
                        }
                    }
                    function h(t) {
                        if (!TOUCH || 0 === t.touches.length)
                            return TOUCH ? (EVENT_target(t).removeEventListener(EVENT_touchmove, d, !1), EVENT_target(t).removeEventListener(EVENT_touchend, h, !1)) : (document.removeEventListener("mousemove", d, !1), document.removeEventListener("mouseup", h, !1)), c ? e.setColumnWidth(n, a, s.width) : e.touchHead(t), e.saveView(), i(t), !1
                    }
                }
                function i(e) {
                    e.preventDefault(),
                    e.stopPropagation()
                }
                TOUCH ? e.$head.addEventListener(EVENT_touchstart, t, !1) : e.$head.addEventListener("mousedown", t, !1)
            },
            e.prototype.registerHeadDragListeners = function() {
                var e = this;
                function t(t) {
                    if (!TOUCH || 1 === t.touches.length) {
                        var i = t.target;
                        if ("t-head-resizer" !== i.className) {
                            for (; i && "t-head-cell" !== i.className;)
                                i = i.parentNode;
                            if (i)
                                if (i.getAttribute("data-action"))
                                    e.touchHead(t);
                                else {
                                    var o = i.getAttribute("data-cidx");
                                    if (o) {
                                        o = parseInt(o);
                                        var n = e.cols,
                                            s = n[o];
                                        if (s) {
                                            var a = e.$container.getBoundingClientRect(),
                                                r = s.left,
                                                l = TOUCH ? t.touches[0].clientX : t.clientX,
                                                c = (e.scrollLeft, !1),
                                                d = o,
                                                h = [];
                                            f(),
                                            TOUCH ? (EVENT_target(t).addEventListener(EVENT_touchmove, p, !0), EVENT_target(t).addEventListener(EVENT_touchend, u, !0)) : (window.addEventListener("mousemove", p, !0), window.addEventListener("mouseup", u, !0)),
                                            t.preventDefault(),
                                            t.stopPropagation()
                                        }
                                    }
                                }
                        }
                    }
                    function p(t) {
                        if (!TOUCH || 1 === t.touches.length) {
                            var i = TOUCH ? t.touches[0].clientX : t.clientX,
                                p = i - l;
                            if (Math.abs(p) > 3) {
                                c = !0,
                                s.$headCell.style.zIndex = "1",
                                s.$headCell.style.backgroundColor = "rgba(200,200,200,.5)",
                                s.$footCell.style.zIndex = "1",
                                s.$footCell.style.backgroundColor = "rgba(200,200,200,.5)";
                                for (var u = e.viewRows, m = 0; m < u.length; m++) {
                                    u[m].$cells[o].style.zIndex = 1
                                }
                            }
                            if (c) {
                                var g = r + p + "px";
                                s.$headCell.style.left = g,
                                s.$footCell.style.left = g;
                                for (u = e.viewRows, m = 0; m < u.length; m++)
                                    u[m].$cells[o].style.left = g;
                                for (var v = e.leftWidth + a.left, b = 0; b < h.length; b++) {
                                    var y = n[h[b]],
                                        w = v - e.scrollLeft,
                                        x = w + y.width / 3,
                                        T = w + 2 * y.width / 3,
                                        $ = w + y.width;
                                    if (b !== d) {
                                        if (w <= i && x > i) {
                                            d = b,
                                            f();
                                            break
                                        }
                                        if (T < i && $ >= i) {
                                            d = b + 1,
                                            f();
                                            break
                                        }
                                    }
                                    v += y.width
                                }
                            }
                            t.preventDefault(),
                            t.stopPropagation()
                        }
                    }
                    function u(t) {
                        if (!TOUCH || 0 === t.touches.length) {
                            if (TOUCH ? (EVENT_target(t).removeEventListener(EVENT_touchmove, p, !0), EVENT_target(t).removeEventListener(EVENT_touchend, u, !0)) : (window.removeEventListener("mousemove", p, !0), window.removeEventListener("mouseup", u, !0)), c) {
                                s.$headCell.style.zIndex = "",
                                s.$headCell.style.backgroundColor = "",
                                s.$footCell.style.zIndex = "",
                                s.$footCell.style.backgroundColor = "";
                                for (var i = e.viewRows, a = 0; a < i.length; a++) {
                                    i[a].$cells[o].style.zIndex = ""
                                }
                                if (o === d)
                                    e.resizeColumns();
                                else {
                                    var r = void 0 !== e.cidxSort ? n[e.cidxSort] : void 0,
                                        l = void 0 !== e.cidxSort ? n[e.cidxGroup] : void 0;
                                    xi(n, o, d),
                                    r && (e.cidxSort = n.indexOf(r)),
                                    l && (e.cidxGroup = n.indexOf(l));
                                    e.rows;
                                    var h = e.models,
                                        f = e.groups;
                                    for (var m in h) {
                                        if (h.hasOwnProperty(m))
                                            xi(h[m].values, o, d)
                                    }
                                    for (var g in f) {
                                        if (f.hasOwnProperty(g))
                                            xi(f[g].values, o, d)
                                    }
                                    xi(e.foot.values, o, d),
                                    e.createCells(),
                                    e.resizeColumns(),
                                    e.updateHead(),
                                    e.updateRows(),
                                    e.updateFoot(),
                                    e.saveView(),
                                    e.retainSelection()
                                }
                            } else
                                e.touchHead(t);
                            t.preventDefault(),
                            t.stopPropagation()
                        }
                    }
                    function f() {
                        h = [];
                        for (var t = 0; t < n.length; t++)
                            h[t] = t;
                        h.splice(o, 1),
                        h.splice(d, 0, o);
                        for (var i = e.leftWidth, s = e.viewRows, a = 0; a < s.length; a++) {
                            var r = s[a];
                            i = e.leftWidth;
                            for (t = 0; t < h.length; t++) {
                                var l = (c = n[h[t]]).width;
                                if (t !== d)
                                    r.$cells[h[t]].style.left = i + "px";
                                i += l
                            }
                        }
                        i = e.leftWidth;
                        for (t = 0; t < h.length; t++) {
                            var c;
                            l = (c = n[h[t]]).width;
                            if (t !== d)
                                c.$headCell.style.left = i + "px",
                                c.$footCell.style.left = i + "px";
                            i += l
                        }
                    }
                }
                TOUCH ? e.$head.addEventListener(EVENT_touchstart, t, !1) : e.$head.addEventListener("mousedown", t, !1)
            },
            e.prototype.registerBodyListeners = function() {
                TOUCH ? this.registerBodyListeners_TOUCH() : this.registerBodyListeners_NOTOUCH()
            },
            e.prototype.registerBodyListeners_TOUCH = function() {
                var e = this;
                e.$body.addEventListener(EVENT_touchstart, (function(t) {
                    if (1 !== t.touches.length)
                        return;
                    t.preventDefault(),
                    t.stopPropagation();
                    var i = e.cols,
                        o = e.$container.getBoundingClientRect(),
                        n = o.height,
                        s = (o.top, t.touches[0].clientX),
                        a = t.touches[0].clientY,
                        r = s,
                        c = a,
                        d = 0,
                        h = 0,
                        p = function(t) {
                            var n = o.left,
                                s = n + e.leftWidth;
                            if (t >= n && t <= s)
                                return -1;
                            for (var a = s - e.scrollLeft, r = 0; r < i.length; r++) {
                                var l = i[r];
                                if (t >= a && t <= a + l.width)
                                    return r;
                                a += l.width
                            }
                            return i.length - 1
                        }(s),
                        u = (v = a, b = o.top + e.headHeight, Math.floor((v + e.scrollTop - b) / (e.rowHeight + 0))),
                        f = !1,
                        m = e.rows[u],
                        g = e.groups[m];
                    var v,
                        b;
                    function y(e) {
                        1 === e.touches.length && (r = e.touches[0].clientX, c = e.touches[0].clientY, (d = r - s) * d + (h = c - c) * h > 4 && (f = !0))
                    }
                    EVENT_target(t).addEventListener(EVENT_touchmove, y, !1),
                    EVENT_target(t).addEventListener(EVENT_touchend, (function t(i) {
                        if (0 === i.touches.length && (EVENT_target(i).removeEventListener(EVENT_touchmove, y, !1), EVENT_target(i).removeEventListener(EVENT_touchend, t, !1), !f)) {
                            if (g)
                                return void e.toggle(m);
                            if (u > e.rows.length || u < 0)
                                return void e.selectNothing();
                            if (u === e.rows.length)
                                return e.create(), void Object(l.f)("Table", "CreateRecord");
                            if (-1 === p)
                                return void (e.isTableEditMode() ? e.selectRow(u) : e.toggleRowChoosen(u, i.shiftKey));
                            e.getSelectedRow() === u ? e.selectNothing() : e.selectRow(u)
                        }
                    }), !1)
                }), !1)
            },
            e.prototype.registerBodyListeners_NOTOUCH = function() {
                var e = this;
                e.$body.addEventListener(TOUCH ? EVENT_touchstart : "mousedown", (function(t) {
                    if (TOUCH && 1 !== t.touches.length)
                        return;
                    if (!TOUCH && 1 !== t.which)
                        return;
                    var i,
                        o,
                        n = e.cols,
                        s = e.$container.getBoundingClientRect(),
                        a = s.height,
                        r = s.top,
                        c = r + a,
                        d = TOUCH ? t.touches[0].clientX : t.clientX,
                        h = TOUCH ? t.touches[0].clientY : t.clientY,
                        p = d,
                        u = h,
                        f = 0,
                        m = 0,
                        g = R(d),
                        v = j(h),
                        b = g,
                        y = v,
                        w = null,
                        x = null,
                        T = 0,
                        $ = 0,
                        C = Date.now(),
                        k = Math.abs(C - e.lastMouseDown);
                    e.lastMouseDown = C;
                    var S = e.rows[v],
                        E = e.groups[S];
                    if (e.editor && g === e.editor.c && v === e.editor.r)
                        return;
                    if (e.stopEdit(!0), t.preventDefault(), t.stopPropagation(), E)
                        return void e.toggle(S);
                    if (v > e.rows.length || v < 0)
                        return void e.selectNothing();
                    if (v === e.rows.length)
                        return e.create(), void Object(l.f)("Table", "CreateRecord");
                    if (-1 === g)
                        return void (e.isTableEditMode() ? e.selectRow(v) : e.toggleRowChoosen(v, t.shiftKey));
                    if (k < 400 && !e.isTableEditMode())
                        return void e.selectCell(v, g);
                    if ("t-selection-drag" === t.target.className) {
                        if (i = e.getSelectedRow(), o = e.getSelectedColumn(), !e.getWritableField(o))
                            return;
                        w = "drag",
                        x = $DIV("t-drag", e.$view),
                        y = i,
                        M()
                    } else if (t.shiftKey)
                        return v = e.getSelectedRow(), g = e.getSelectedColumn(), null == v && (v = 0), null == g && (g = 0, b = n.length - 1), void e.selectBlock(v, g, y, b);
                    function _(t) {
                        if (!TOUCH || 1 === t.touches.length) {
                            p = TOUCH ? t.touches[0].clientX : t.clientX,
                            u = TOUCH ? t.touches[0].clientY : t.clientY,
                            f = p - d,
                            m = u - h;
                            var i = u - r,
                                o = u - c;
                            i < e.rowHeight + 0 ? N(i - (e.rowHeight + 0)) : o > -(e.rowHeight + 0) ? N(o + (e.rowHeight + 0)) : I(),
                            t.preventDefault(),
                            t.stopPropagation(),
                            D()
                        }
                    }
                    function D() {
                        (b = R(p)) < 0 && (b = 0),
                        (y = j(u)) < 0 && (y = 0),
                        y > e.rows.length && (y = e.rows.length - 1),
                        w ? "select" === w ? e.selectBlock(v, g, y, b) : "drag" === w && (y > e.rows.length - 1 && (y = e.rows.length - 1), M()) : f * f + m * m > 4 && (w = "select", e.selectBlock(v, g, y, b))
                    }
                    function M() {
                        if (i === y)
                            x.style.display = "none";
                        else {
                            var t = i < y ? i + 1 : y,
                                n = i < y ? y : i - 1;
                            x.style.display = "",
                            x.style.left = e.colX(o, o) + "px",
                            x.style.width = e.colW(o, o) + "px",
                            x.style.top = e.rowY(t, t) + "px",
                            x.style.height = e.rowHWithMargin(t, n) + "px"
                        }
                    }
                    function N(e) {
                        var t = Math.min(1, Math.max(-1, e / 80)),
                            i = Math.sign(t) * (Math.sin(t * Math.PI - Math.PI / 2) + 1) * 1024;
                        0 === T ? (T = i, $ = performance.now(), requestAnimationFrame(O)) : T = i
                    }
                    function I() {
                        T = 0
                    }
                    function O() {
                        if (0 !== T) {
                            var t = performance.now(),
                                i = Math.abs(t - $),
                                o = Math.round(T * i / 1e3),
                                n = e.scrollTop + o,
                                s = e.rows.length + 1,
                                a = e.containerHeight() - 2 * (e.rowHeight + 0),
                                r = Math.max(a, (e.rowHeight + 0) * (s - 1));
                            e.scrollTo(e.scrollLeft, Math.max(0, Math.min(r - a, n))),
                            $ = t,
                            D(),
                            requestAnimationFrame(O)
                        }
                    }
                    function R(t) {
                        var i = s.left,
                            o = i + e.leftWidth;
                        if (t >= i && t <= o)
                            return -1;
                        for (var a = o - e.scrollLeft, r = 0; r < n.length; r++) {
                            var l = n[r];
                            if (t >= a && t <= a + l.width)
                                return r;
                            a += l.width
                        }
                        return n.length - 1
                    }
                    function j(t) {
                        var i = s.top + e.headHeight;
                        return Math.floor((t + e.scrollTop - i) / (e.rowHeight + 0))
                    }
                    window.addEventListener(TOUCH ? EVENT_touchmove : "mousemove", _, !1),
                    window.addEventListener(TOUCH ? EVENT_touchend : "mouseup", (function t(n) {
                        TOUCH && 0 !== n.touches.length || (window.removeEventListener(TOUCH ? EVENT_touchmove : "mousemove", _, !1), window.removeEventListener(TOUCH ? EVENT_touchend : "mouseup", t, !1), I(), "select" === w ? g === b && v === y && (w = null) : "drag" === w && ($REMOVE(x), i !== y && e.dragValue(o, i, y < i ? y : i + 1, y < i ? i - 1 : y, n.shiftKey, y < i)), w || (e.isCellSelection() ? e.isCellSelected(v, g) ? e.startEdit(g, v) : e.selectCell(v, g) : e.isTableEditMode() ? e.selectCell(v, g) : e.isRowSelected(v) ? e.selectNothing() : e.selectRow(v)), w = null, n.preventDefault(), n.stopPropagation())
                    }), !1)
                }), !1)
            }
        }(qn),
        function(e) {
            e.prototype.selectLastRow = function() {
                this.selectRow(void 0 === this.lastSelectedRow ? 0 : this.lastSelectedRow, "row"),
                this.scrollToCell(0, this.lastSelectedRow)
            },
            e.prototype.isTableEditMode = function() {
                return "cell" === this.selectionMode || "block" === this.selectionMode
            },
            e.prototype.isRowSelection = function() {
                return "row" === this.selectionMode
            },
            e.prototype.isRowSelected = function(e) {
                return "row" === this.selectionMode && this.selectionR0 === e
            },
            e.prototype.isCellSelection = function() {
                return "cell" === this.selectionMode
            },
            e.prototype.isCellSelected = function(e, t) {
                return "cell" === this.selectionMode && this.selectionR0 === e && this.selectionC0 === t
            },
            e.prototype.getSelectedRow = function() {
                return this.selectionMode ? this.selectionR0 : void 0
            },
            e.prototype.getSelectedColumn = function() {
                var e = this.selectionMode;
                return "cell" === e || "block" === e ? this.selectionC0 : void 0
            },
            e.prototype.getSelectedNid = function() {
                return this.selectionMid0
            },
            e.prototype.selectNothing = function() {
                this.stopEdit(),
                this.setSelection(void 0, void 0, void 0, void 0, void 0, !1)
            },
            e.prototype.selectRow = function(e, t) {
                this.lastSelectedRow = e,
                this.stopEdit();
                var i = this.rows,
                    o = this.models;
                e >= 0 && e < i.length && o[i[e]] ? this.setSelection("row", e, void 0, e, void 0, !!t) : this.selectNothing()
            },
            e.prototype.selectCell = function(e, t, i) {
                this.lastSelectedRow = e;
                var o = this.rows,
                    n = this.cols;
                e >= 0 && e < o.length && (null == t || t >= 0 && t < n.length) ? (null != t ? this.setSelection("cell", e, t, e, t, !!i) : this.setSelection("row", e, void 0, e, void 0, !!i), this.scrollToCell(t, e)) : this.selectNothing()
            },
            e.prototype.selectBlock = function(e, t, i, o, n) {
                this.lastSelectedRow = e,
                this.stopEdit();
                var s = this.rows,
                    a = this.cols;
                e >= 0 && e < s.length && i >= 0 && i < s.length && t >= 0 && t < a.length && o >= 0 && o < a.length ? this.setSelection("block", Math.min(e, i), Math.min(t, o), Math.max(e, i), Math.max(t, o), !!n) : this.selectNothing()
            },
            e.prototype.setSelection = function(e, t, i, o, n, s) {
                var a = this.selectionMode !== e;
                if (a && this.removeSelection(), this.selectionMode = e, this.selectionR0 = t, this.selectionC0 = i, this.selectionR1 = o, this.selectionC1 = n, e) {
                    var r = this.rows;
                    this.selectionMid0 = r[t],
                    this.selectionMid1 = r[o]
                } else
                    this.selectionMid0 = void 0,
                    this.selectionMid1 = void 0;
                a && this.createSelection(),
                this.updateSelection(),
                this.retainSideEditor(s),
                this.container.selectionChanged()
            },
            e.prototype.createSelection = function() {
                if (!this.selectionIsCreated)
                    switch (this.selectionIsCreated = !0, this.selectionMode) {
                    case "row":
                        this.$selectionEl1 = $DIV("t-selection t-selection-row", this.$selectionContainer),
                        this.$headSelection = $DIV("t-selection t-selection-row-head", this.$headSelectionContainer);
                        break;
                    case "cell":
                        this.$selectionEl1 = $DIV("t-selection t-selection-cell-1", this.$selectionContainer),
                        this.$selectionElDrag = $DIV("t-selection-drag", this.$selectionContainer);
                        break;
                    case "block":
                        this.$selectionEl1 = $DIV("t-selection t-selection-block", this.$selectionContainer)
                    }
            },
            e.prototype.removeSelection = function() {
                if (this.selectionIsCreated)
                    switch (this.selectionIsCreated = !1, this.selectionMode) {
                    case "row":
                        $REMOVE(this.$selectionEl1),
                        $REMOVE(this.$headSelection),
                        this.$selectionEl1 = void 0;
                        break;
                    case "cell":
                        $REMOVE(this.$selectionEl1),
                        $REMOVE(this.$selectionElDrag),
                        this.$selectionEl1 = void 0,
                        this.$selectionElDrag = void 0;
                        break;
                    case "block":
                        $REMOVE(this.$selectionEl1),
                        this.$selectionEl1 = void 0
                    }
            },
            e.prototype.updateSelection = function() {
                const e = this.leftWidth;
                switch (this.selectionMode) {
                case "row":
                    var t = this.rowY(this.selectionR0, this.selectionR0),
                        i = this.rowH(this.selectionR0, this.selectionR0) - 1,
                        o = this.viewWidth,
                        n = this.$selectionEl1,
                        s = this.$headSelection;
                    s.style.left = "2px",
                    s.style.top = t + "px",
                    s.style.width = "40px",
                    s.style.height = i + "px",
                    n.style.left = e + 1 + "px",
                    n.style.top = t + "px",
                    n.style.width = o - e - 2 + "px",
                    n.style.height = i + "px";
                    break;
                case "cell":
                    n = this.$selectionEl1;
                    var a = this.$selectionElDrag,
                        r = this.selectionC0,
                        l = this.selectionR0,
                        c = (t = this.rowY(l, l), i = this.rowH(l, l) - 1, this.colX(r, r)),
                        d = c + this.colW(r, r) - 1;
                    this.viewWidth;
                    n.style.left = c + "px",
                    n.style.top = t + "px",
                    n.style.width = d - c + "px",
                    n.style.height = i + "px",
                    this.isEditable(r, l) ? n.className = "t-selection t-selection-cell-2 editable" : n.className = "t-selection t-selection-cell-2",
                    !!this.getWritableField(r) ? (a.style.display = "", a.style.left = d - 4 + "px", a.style.top = t + i - 5 + "px") : a.style.display = "none";
                    break;
                case "block":
                    var h = this.$selectionEl1,
                        p = this.selectionC0,
                        u = this.selectionC1,
                        f = this.selectionR0,
                        m = this.selectionR1,
                        g = this.colX(p, u);
                    o = this.colW(p, u) - 1,
                    t = this.rowY(f, m),
                    i = this.rowHWithMargin(f, m);
                    h.style.left = g + "px",
                    h.style.width = o + "px",
                    h.style.top = t + "px",
                    h.style.height = i + "px"
                }
            },
            e.prototype.getSelectedText = function() {
                switch (this.selectionMode) {
                case "row":
                    return this.getTextAtRange(0, this.selectionR0, this.cols.length - 1, this.selectionR0);
                case "cell":
                    return this.getTextAtCell(this.selectionC0, this.selectionR0);
                case "block":
                    return this.getTextAtRange(this.selectionC0, this.selectionR0, this.selectionC1, this.selectionR1);
                default:
                    return ""
                }
            },
            e.prototype.retainSelection = function(e) {
                if (console.log("Table.retainSelection"), this.selectionMode) {
                    var t = this.rows,
                        i = this.cols.length - 1,
                        o = t.indexOf(this.selectionMid0),
                        n = t.indexOf(this.selectionMid1);
                    if (-1 === o || -1 === n) {
                        let t = !1;
                        if (!e && null != this.cidxGroup)
                            for (const e in this.groups)
                                if (this.groups.hasOwnProperty(e) && -1 !== this.groups[e].children.indexOf(this.selectionMid0)) {
                                    this.expanded[e] || (this.expandSilently(e), this.updateRows(), this.rowsChanged()),
                                    t = !0;
                                    break
                                }
                        return t ? void this.select(this.selectionMid0) : void this.selectNothing()
                    }
                    this.selectionR0 = Math.min(o, n),
                    this.selectionR1 = Math.max(o, n),
                    null != this.selectionC0 && (this.selectionC0 = Math.min(i, Math.max(0, this.selectionC0)), null != this.selectionC1 && (this.selectionC1 = Math.min(i, Math.max(0, this.selectionC0, this.selectionC1)))),
                    this.updateSelection()
                }
                this.retainSideEditor(!1)
            },
            e.prototype.retainSideEditor = function(e) {
                if (this.visible) {
                    var t = this.selectionMid0;
                    t && !!this.models[t] && "row" === this.selectionMode ? ui.sideEditor.open(t, this.sideEditorOptions, !!e) : ui.sideEditor.close(!0),
                    ui.recordNavigation.updateUI()
                }
            }
        }(qn),
        qn.prototype.updateUI = function() {
            s.a.render(r.a.createElement(io, {
                items: this.contextState.items,
                clickTarget: this.contextState.target,
                onClick: () => {
                    this.contextState.target = null,
                    this.updateUI()
                },
                show: null !== this.contextState.target
            }), ui.$tableContextMenuContainer[0])
        },
        qn.prototype.setVisible = function(e) {
            e ? this.show() : this.hide()
        },
        qn.prototype.show = function() {
            this.visible || (this.visible = !0, $(this.$container).appendTo(ui.$body), window.addEventListener("resize", this.resizeListener, !1), $.pushInputHandler(this), ui.recordNavigation.pushController(this.recordController), this.resize(), this.scroll(!0, !1))
        },
        qn.prototype.hide = function() {
            this.visible && (this.visible = !1, ui.sideEditor.close(!0), s.a.unmountComponentAtNode(ui.$tableContextMenuContainer[0]), $(this.$container).detach(), window.removeEventListener("resize", this.resizeListener, !1), $.popInputHandler(this), ui.recordNavigation.popController(this.recordController))
        },
        qn.prototype.update = function() {},
        qn.prototype.addRow = function(e, t) {
            if (console.log("Table.addRow", e, t), !this.silent) {
                var i = this;
                i.models[e] || function(o) {
                    if (!t)
                        return o(!0);
                    database.loadNode(e, (function(e, t) {
                        if (!t)
                            return o(!1);
                        var n = i.getWhereExpression();
                        if (!n)
                            return o(!0);
                        n.evaluate(database, t, (function(e, t) {
                            o(t)
                        }))
                    }))
                }((function(t) {
                    t && database.filterReadable(i.type, [e], (function(t) {
                        if (t && 1 === t.length && !i.models[e]) {
                            var o = i.removedIndex[e];
                            i.models[e] = {
                                id: e,
                                values: []
                            },
                            null != o && o >= 0 && o < i.rows.length ? i.rows.splice(o, 0, e) : i.rows.push(e),
                            i.recalc(e, (function() {
                                i.aggregate(),
                                i.updateRows(),
                                i.updateFoot(),
                                i.rowsChanged()
                            }))
                        }
                    }))
                }))
            }
        },
        qn.prototype.nodeCreated = function(e, t, i) {
            this.ready && (this.silent || t === this.type.id && this.addRow(i, !0))
        },
        qn.prototype.nodeChanged = function(e, t) {
            if (this.ready && !this.silent) {
                var i = this,
                    o = i.models,
                    n = [],
                    s = {};
                !function e(t, i) {
                    if (i > 2 || s[t])
                        return;
                    s[t] = !0;
                    var a = database.loadNodeSync(t);
                    if (!a)
                        return;
                    o[t] && n.push(t);
                    var r = database.typeOf(t);
                    if (r) {
                        var l = r.fields;
                        if (l)
                            for (var c in l)
                                if (l.hasOwnProperty(c)) {
                                    var d = l[c];
                                    if (d.isReference) {
                                        if (f = a[c]) {
                                            var h = d.refType.id + f;
                                            e(h, i + 1)
                                        }
                                    } else if (d.isReverse) {
                                        var p = a[c];
                                        if (p)
                                            for (var u = 0; u < p.length; u++) {
                                                var f = p[u];
                                                h = d.refType.id + f;
                                                e(h, i + 1)
                                            }
                                    }
                                }
                    }
                }(t, 0),
                function() {
                    var e = n.length;
                    if (!e)
                        return;
                    for (var t = 0; t < n.length; t++)
                        i.recalc(n[t], (function() {
                            0 === --e && a()
                        }))
                }()
            }
            function a() {
                i.aggregate(),
                i.updateRows(),
                i.updateFoot()
            }
        },
        qn.prototype.nodeRemoved = function(e, t) {
            if (this.ready) {
                var i = this.models[t];
                if (delete this.midChoosen[t], i) {
                    delete this.models[t];
                    var o = this.rows.indexOf(t);
                    -1 !== o && this.rows.splice(o, 1),
                    this.removedIndex[t] = o;
                    var n = this.groups;
                    for (var s in n)
                        if (n.hasOwnProperty(s)) {
                            var a = n[s],
                                r = a.children.indexOf(t);
                            if (-1 !== r && (a.children.splice(r, 1), !a.children.length)) {
                                var l = this.rows.indexOf(s);
                                -1 !== l && this.rows.splice(l, 1)
                            }
                        }
                    this.aggregate(),
                    this.updateRows(),
                    this.updateFoot(),
                    this.retainSelection(),
                    this.rowsChanged()
                }
            }
        },
        qn.prototype.schemaChanged = function(e, t, i) {
            if (this.ready)
                if (!0 === t || !0 === i) {
                    var o = this.getConfiguration();
                    this.configureAndLoad(o)
                } else
                    this.reload()
        },
        qn.prototype.configureAndLoad = function(e) {
            this.setConfig(e),
            this.reload()
        },
        qn.prototype.reload = function() {
            this.load((function(e) {
                e && console.log(e)
            }))
        },
        qn.prototype.setConfig = function(e, t) {
            console.log("Table.setConfig: " + e.type),
            this.ready = !1;
            var i = e.type,
                o = database.schema.types[i];
            if (o) {
                this.config = e,
                this.type = o;
                var n = [];
                if (e.cols && 0 !== e.cols.length)
                    for (var s = 0; s < e.cols.length; s++) {
                        var a = e.cols[s],
                            r = a.expression,
                            l = (f = void 0, o.fields[r]);
                        l && l.isField && "fn" !== l.base && "file" !== l.base && "memory-global" !== l.binding && "memory-record" !== l.binding && (f = l.id);
                        try {
                            m = queries.parseSystem(database.schema, o, r, {}, !1)
                        } catch (e) {
                            console.warn(e, e.stack);
                            continue
                        }
                        if (m)
                            if (m.hasErrors())
                                console.log("Invalid expression at column " + s, m.errorMessage());
                            else if (!m.isMultiple() && !m.isUpdating()) {
                                var c = a.agg,
                                    d = c ? aggregations.aggType(c, m.returnType) : void 0;
                                g = {
                                    caption: a.caption,
                                    expression: m,
                                    field: m.returnType,
                                    width: a.width || m.returnType.columnWidth,
                                    agg: c,
                                    aggType: d,
                                    filter: a.filter,
                                    directFid: f,
                                    isReadable: database.canRead(m),
                                    conditionalStyling: a.conditionalStyling
                                };
                                n.push(g)
                            }
                    }
                else {
                    for (var h = o.sorted, p = 0; p < h.length && n.length < 8; p++) {
                        var u = h[p];
                        if (u.isField) {
                            var f = void 0;
                            "fn" !== u.base && "file" !== u.base && "memory-local" !== u.binding && "memory-record" !== u.binding && (f = u.id);
                            try {
                                var m;
                                if (!(m = queries.parseSystem(database.schema, o, u.id, {}, !1)).hasErrors() && !m.isMultiple() && !m.isUpdating()) {
                                    var g = {
                                        width: u.columnWidth,
                                        expression: m,
                                        field: m.returnType,
                                        agg: void 0,
                                        aggType: d,
                                        directFid: f,
                                        isReadable: database.canRead(u)
                                    };
                                    n.push(g)
                                }
                            } catch (e) {}
                        }
                    }
                    if (!n.length) {
                        var v = queries.parseSystem(database.schema, o, "_id", {});
                        n.push({
                            width: 50,
                            expression: v,
                            field: v.returnType,
                            agg: "cnt",
                            aggType: aggregations.aggType("cnt", v.returnType),
                            isReadable: !0
                        })
                    }
                }
                this.cols = n,
                this.tid = i,
                this.cidxSort = parseInt(e.sort),
                isNaN(this.cidxSort) && (this.cidxSort = 0),
                this.sortDescending = !0 === e.descending,
                this.cidxGroup = void 0 === e.group ? void 0 : parseInt(e.group),
                isNaN(this.cidxGroup) && (this.cidxGroup = void 0),
                this.midChoosen = e.choosen || {},
                this.onlyChoosen = !0 === e.onlyChoosen,
                t && (this.midChoosen = t.midChoosen || {}, this.onlyChoosen = !0 === t.onlyChoosen, this.expanded = t.expanded || {}, this.scrollTop = null == t.scrollTop ? 0 : t.scrollTop, this.scrollLeft = null == t.scrollLeft ? 0 : t.scrollLeft, this.removeSelection(), this.lastSelectedRow = t.selectionR0, this.selectionMode = t.selectionMode, this.selectionR0 = t.selectionR0, this.selectionR1 = t.selectionR1, this.selectionC0 = t.selectionC0, this.selectionC1 = t.selectionC1, this.selectionMid0 = t.selectionMid0, this.selectionMid1 = t.selectionMid1),
                this.createCells()
            }
        },
        qn.prototype.getNavigationState = function() {
            return {
                scrollLeft: this.scrollLeft,
                scrollTop: this.scrollTop,
                midChoosen: this.midChoosen,
                onlyChoosen: this.onlyChoosen,
                expanded: this.expanded,
                selectionMode: this.selectionMode,
                selectionR0: this.selectionR0,
                selectionR1: this.selectionR1,
                selectionC0: this.selectionC0,
                selectionC1: this.selectionC1,
                selectionMid0: this.selectionMid0,
                selectionMid1: this.selectionMid1
            }
        },
        qn.prototype.getConfig = qn.prototype.getConfiguration = function() {
            for (var e = this.cols, t = [], i = 0; i < e.length; i++) {
                var o = e[i],
                    n = {
                        caption: o.caption,
                        expression: o.expression.toString(),
                        width: o.width,
                        agg: o.agg,
                        filter: o.filter,
                        conditionalStyling: o.conditionalStyling
                    };
                t.push(n)
            }
            return {
                type: this.tid,
                cols: t,
                sort: this.cidxSort,
                descending: this.sortDescending,
                group: this.cidxGroup,
                choosen: this.midChoosen,
                onlyChoosen: this.onlyChoosen
            }
        },
        qn.prototype.showOnlyChoosen = function() {
            this.onlyChoosen = !0,
            this.reload()
        },
        qn.prototype.showAll = function() {
            this.onlyChoosen = !1,
            this.reload()
        },
        qn.prototype.clearChoosen = function() {
            this.midChoosen = {},
            this.updateRows(),
            this.aggregateFoot(),
            this.updateFoot()
        },
        qn.prototype.toggleChoosen = function() {
            var e = this.midChoosen,
                t = this.midChoosen = {},
                i = this.models;
            for (var o in i)
                i.hasOwnProperty(o) && (e[o] || (t[o] = !0));
            this.updateRows(),
            this.aggregateFoot(),
            this.updateFoot()
        },
        qn.prototype.chooseAll = function() {
            var e = this.midChoosen = {},
                t = this.models;
            for (var i in t)
                t.hasOwnProperty(i) && (e[i] = !0);
            this.updateRows(),
            this.aggregateFoot(),
            this.updateFoot()
        },
        qn.prototype.removeAllChoosen = function() {
            var e = this,
                t = this.type;
            if (!database.canDelete(t))
                return $.alert(locale.errorNotAuthorized);
            $.dialog({
                closable: !0,
                caption: locale.removeNRecords.replace("$", Object.keys(e.midChoosen).length),
                message: locale.confirmRemoveAllChoosen,
                buttons: [{
                    color: "red",
                    caption: locale.removeNRecords.replace("$", Object.keys(e.midChoosen).length),
                    callback: function() {
                        var t = e.midChoosen;
                        e.midChoosen = {},
                        database.removeAll(T.keys(t))
                    }
                }]
            })
        },
        qn.prototype.touchHead = function(e) {
            var t = $(e.target).closest(".t-head-cell");
            if (t.length) {
                var i = t.attr("data-cidx");
                i && this.popupColumnMenu(parseInt(i), e)
            }
        },
        qn.prototype.unselect = function() {
            this.selectNothing()
        },
        qn.prototype.select = function(e, t, i) {
            if (e) {
                null == i && (i = this.getSelectedColumn());
                var o = this.rows.indexOf(e);
                -1 !== o ? this.selectCell(o, i, t) : this.selectNothing()
            } else
                this.selectNothing()
        },
        qn.prototype.scrollToRow = function(e) {
            var t = this.scrollTop,
                i = this.bodyHeight(),
                o = e * (this.rowHeight + 0);
            o < t ? this.scrollTo(this.scrollLeft, o) : o > t + i - (this.headHeight + this.footHeight) && this.scrollTo(this.scrollLeft, o + (this.headHeight + this.footHeight) - i)
        },
        qn.prototype.scrollToCell = function(e, t) {
            var i = this.scrollLeft,
                o = this.scrollTop,
                n = this.bodyHeight(),
                s = this.$container.clientWidth - this.leftWidth,
                a = o;
            if (null != t) {
                var r = t * (this.rowHeight + 0);
                r < o ? a = r : r > o + n - (this.headHeight + this.footHeight) && (a = r + (this.headHeight + this.footHeight) - n)
            }
            var l = i;
            if (null != e) {
                var c = this.colX(e, e) - this.leftWidth,
                    d = c + this.colW(e, e);
                d > i + s && (l = Math.max(0, d - s)),
                c < i && (l = c)
            }
            a === o && l === i || this.scrollTo(l, a)
        },
        qn.prototype.scroll = function(e, t) {
            var i = this.scrollTop,
                o = this.scrollLeft,
                n = Math.floor(i / (this.rowHeight + 0)),
                s = this.ridxTop;
            n > this.ridxTop + 20 - 1 ? s = n : n < this.ridxTop && (s = n - 20 + 1),
            s !== this.ridxTop && (this.ridxTop = s, this.updateRows(), this.updateSelection(), this.updateEditor());
            var a = i % (this.rowHeight + 0);
            a < 0 && (a += this.rowHeight + 0);
            var r = -(a + (n - s) * (this.rowHeight + 0)),
                l = -o;
            this.$head.style.transform = this.$head.style.WebkitTransform = "translate3d(" + l + "px,0px,0px)",
            this.$rowHeads.style.transform = this.$rowHeads.style.WebkitTransform = "translate3d(" + Math.max(-l, 0) + "px,0px,0px)",
            this.$view.style.transform = this.$view.style.WebkitTransform = "translate3d(" + l + "px," + r + "px,0px)",
            this.viewX = l,
            this.viewY = r,
            this.updateFootPosition(),
            this.updateScrollbar(t)
        },
        qn.prototype.updateFootPosition = function() {
            var e = this.rows.length + 1,
                t = this.containerHeight() - 2 * (this.rowHeight + 0);
            Math.max(t, (this.rowHeight + 0) * e) > t ? (this.$foot.style.bottom = 0, this.$foot.style.top = "", this.$footRuler.style.bottom = 0, this.$footRuler.style.top = "", this.$foot.style.transform = this.$foot.style.WebkitTransform = "translate3d(" + this.viewX + "px,0px,0px)", this.$footRuler.style.transform = this.$footRuler.style.WebkitTransform = "") : (this.$scrollbarHContainer.style.bottom = 0, this.$footRuler.style.top = e * (this.rowHeight + 0) + this.headHeight + "px", this.$footRuler.style.bottom = "", this.$footRuler.style.zIndex = 1, this.$foot.style.top = e * (this.rowHeight + 0) + this.headHeight - 1 + "px", this.$foot.style.bottom = "", this.$foot.style.zIndex = 1, this.$foot.style.transform = this.$foot.style.WebkitTransform = "translate3d(" + this.viewX + "px," + -this.scrollTop + "px,0px)", this.$footRuler.style.transform = this.$footRuler.style.WebkitTransform = "translate3d(0px," + -this.scrollTop + "px,0px)")
        },
        qn.prototype.updateScrollbar = function(e) {
            var t = this.rows.length + 1,
                i = this.scrollTop,
                o = this.scrollLeft,
                n = this.containerHeight() - (this.headHeight + this.footHeight),
                s = Math.max(n, (this.rowHeight + 0) * t),
                a = this.viewWidth + 40,
                r = this.$container.clientWidth - this.rowHeadWidth,
                l = s > n,
                c = a > r + this.leftWidth,
                d = n,
                h = r,
                p = Math.max(40, Math.round(d * n / s)),
                u = Math.max(0, Math.min(d - p, Math.round(i / (s - n) * (d - p)))) + 2,
                f = Math.max(40, Math.min(h, Math.round(h * (r / a)))),
                m = Math.max(0, Math.min(h - f, Math.round(o / (a - 40 - r) * (h - f)))),
                g = this.$scrollbarV;
            g.style.top = u + "px",
            g.style.height = p + "px";
            var v = this.$scrollbarH;
            v.style.left = m + "px",
            v.style.width = f + "px",
            e && (this.scrollDoneTime = Date.now() + 1e3, this.scrollDoneTimeout || (l && (g.className = "t-scrollbar-v scrolling"), c && (v.className = "t-scrollbar-h scrolling"), this.scrollDoneTimeout = setTimeout(this.scrollDone, 1e3))),
            this.$scrollHIndicator.style.opacity = 0 != o ? 1 : 0,
            this.$scrollVIndicator.style.opacity = 0 != i ? 1 : 0
        },
        qn.prototype.scrollDone = function() {
            var e = Date.now(),
                t = this.scrollDoneTime - e;
            t < 100 ? (this.$scrollbarV.className = "t-scrollbar-v", this.$scrollbarH.className = "t-scrollbar-h", this.scrollDoneTimeout = null) : this.scrollDoneTimeout = setTimeout(this.scrollDone, t)
        },
        qn.prototype.scrollTo = function(e, t) {
            this.scrollTop = t,
            this.scrollLeft = e,
            this.scroll(!1, !0)
        },
        qn.prototype.scrollToVisible = function() {
            var e = this.scrollTop,
                t = this.bodyHeight(),
                i = Math.max(0, (this.rows.length + 1) * (this.rowHeight + 0) - t);
            e > i && (this.scrollTop = i),
            this.scroll(!0, !1)
        },
        qn.prototype.resizeListener = function() {
            this.resize()
        },
        qn.prototype.resize = function() {
            this.createCells(),
            this.updateHead(),
            this.updateRows(),
            this.updateFoot(),
            this.updateScrollbar(!1),
            this.updateSelection()
        },
        qn.prototype.rowsPerPage = function() {
            var e = this.bodyHeight();
            return Math.floor(e / (this.rowHeight + 0))
        },
        qn.prototype.createCells = function() {
            var e = this.$head,
                t = this.$foot,
                i = this.$view,
                o = (this.$body, this.cols);
            this.removeSelection(),
            $EMPTY(e),
            $EMPTY(t),
            $EMPTY(i);
            for (var n = 0; n < o.length; n++) {
                (p = o[n]).$headCell = $DIV("t-head-cell", e, {
                    "data-cidx": n
                }),
                $DIV("t-head-resizer", p.$headCell),
                $EL("span", p.$headCell).innerHTML = htmlEscape(p.caption || p.expression.caption),
                p.$footCell = $DIV("t-foot-cell t-foot-cell-" + p.field.base, t)
            }
            var s = this.$rowHeads = $DIV("t-rowheads");
            this.$selectionContainer = $DIV("t-selection-container"),
            this.$headSelectionContainer = $DIV("t-head-selection-container");
            for (var a = this.bodyHeight(), r = 20 + Math.ceil(a / (this.rowHeight + 0)), l = [], c = 0; c < r; c++) {
                var d = $DIV("t-row", i, {
                    "data-ridx": c
                });
                d.style.top = c * (this.rowHeight + 0) + "px",
                d.style.height = this.rowHeight + "px",
                (e = $DIV("t-rowhead", s, {
                    "data-ridx": c
                })).style.top = c * (this.rowHeight + 0) + "px",
                e.style.height = this.rowHeight + "px",
                $DIV("t-rowhead-content", e),
                $DIV("t-rowhead-resizer", e);
                var h = [];
                for (n = 0; n < o.length; n++) {
                    var p = o[n];
                    h[n] = $DIV("--ul-row-cell t-cell t-cell-" + p.field.base, d)
                }
                var u = {
                    $row: d,
                    $head: e,
                    $cells: h
                };
                l.push(u)
            }
            s.appendChild(this.$headSelectionContainer),
            i.appendChild(this.$selectionContainer),
            i.appendChild(s),
            this.viewRows = l,
            this.createSelection(),
            this.resizeColumns(),
            this.resizeRows()
        },
        qn.prototype.resizeRows = function() {
            for (var e = this.viewRows, t = 0; t < e.length; t++) {
                var i = e[t];
                i.$head.style.top = t * (this.rowHeight + 0) + "px",
                i.$head.style.height = this.rowHeight + "px",
                i.$row.style.top = t * (this.rowHeight + 0) + "px",
                i.$row.style.height = this.rowHeight + "px";
                for (var o = i.$cells, n = this.cols, s = this.rowHeight < 40 ? Math.floor((this.rowHeight - 18) / 2) + "px" : "", a = 0; a < n.length; a++)
                    o[a].style.paddingTop = s
            }
            this.$view.className = this.rowHeight <= "40" ? "t-view" : "t-view t-view-resized-rows"
        },
        qn.prototype.containerHeight = function() {
            return window.getHeight() - ui.headHeight - ui.footHeight - ui.topPadding
        },
        qn.prototype.bodyHeight = function() {
            return this.containerHeight() - (this.headHeight + this.footHeight)
        },
        qn.prototype.updateRows = function() {
            this._updateRowsId = (this._updateRowsId || 0) + 1;
            const e = this._updateRowsId;
            if (!this.visible)
                return;
            if (!this.ready)
                return;
            if (this.silent)
                return;
            const t = this.viewRows,
                i = this.midChoosen,
                o = this.expanded,
                n = this.models,
                s = this.groups,
                a = this.ridxTop,
                r = this.cidxGroup,
                l = this.rows,
                c = this.cols;
            this.updateFootPosition();
            let d = 0;
            for (let h = 0; h < t.length; h++) {
                const p = t[h],
                    u = p.$row,
                    f = p.$head,
                    m = h + a,
                    g = p.$cells;
                let v = !1,
                    b = !1,
                    y = !1;
                if (m < 0 || m >= l.length)
                    for (let e = 0; e < c.length; e++) {
                        c[e];
                        const t = g[e];
                        t.innerHTML = "",
                        t.style.backgroundColor = ""
                    }
                else {
                    const t = l[m],
                        a = s[t] || n[t];
                    if (a) {
                        const n = a.values;
                        v = !!i[t],
                        b = !!s[t],
                        y = b && !!o[t],
                        b ? d = 0 : d++;
                        for (let i = 0; i < c.length; i++) {
                            const o = c[i],
                                s = g[i];
                            if (o.isReadable) {
                                const a = n[i],
                                    l = s.innerHTML;
                                let c = "",
                                    d = "",
                                    h = !1;
                                if (b && o.agg && i !== r) {
                                    const e = o.aggType.format(a);
                                    null != e && (c = tables.aggTypeToSymbol(o.agg, e))
                                } else {
                                    const i = o.field,
                                        n = i.base;
                                    if ("choice" === n) {
                                        const e = i.getValues()[a];
                                        e && (c += `\n                                            <div \n                                                class="multicombo-item" \n                                                style="${e.color ? "background-color:" + e.color + ";color:" + util.contrastingTextColorTo(e.color) : ""}"\n                                            >\n                                                ${e.icon ? `<div class="choice-symbol ic ic-${e.icon}"></div>` : ""}\n                                                <span>${htmlEscape(e.caption || "")}</span>\n                                            </div>`)
                                    } else if ("dchoice" === n)
                                        h = !0,
                                        i.loadValue(t, a, t => {
                                            if (e === this._updateRowsId)
                                                if (t) {
                                                    const e = `\n                                                <div \n                                                    class="multicombo-item" \n                                                    style="${t.color ? "background-color:" + t.color + ";color:" + util.contrastingTextColorTo(t.color) : ""}"\n                                                >\n                                                    ${t.icon ? `<div class="choice-symbol ic ic-${t.icon}"></div>` : ""}\n                                                    <span>${htmlEscape(t.caption || "")}</span>\n                                                </div>`;
                                                    s.innerHTML = e,
                                                    s.style.background = ""
                                                } else
                                                    s.innerHTML = "",
                                                    s.style.background = ""
                                        });
                                    else if ("multi" === n) {
                                        const e = util.multiDecode(a);
                                        if (e) {
                                            const t = i.getValues();
                                            e.sort((function(e, i) {
                                                const o = t[e],
                                                    n = t[i];
                                                return o ? n ? o.order - n.order : -1 : 0
                                            }));
                                            for (let i = 0; i < e.length; i++) {
                                                const o = t[e[i]];
                                                o && (c += `\n                                            <div \n                                                class="multicombo-item" \n                                                style="${o.color ? "background-color:" + o.color + ";color:" + util.contrastingTextColorTo(o.color) : ""}"\n                                            >\n                                                ${o.icon ? `<div class="choice-symbol ic ic-${o.icon}"></div>` : ""}\n                                                <span>${htmlEscape(o.caption || "")}</span>\n                                            </div>`)
                                            }
                                        }
                                    } else if ("dmulti" === n) {
                                        const o = util.multiDecode(a);
                                        o && (h = !0, i.loadValues(t, (t, i) => {
                                            if (e === this._updateRowsId) {
                                                i = i || {};
                                                let e = "";
                                                o.sort((function(e, t) {
                                                    const o = i[e],
                                                        n = i[t];
                                                    return o ? n ? o.order - n.order : -1 : 0
                                                }));
                                                for (let t = 0; t < o.length; t++) {
                                                    const n = i[o[t]];
                                                    n && (e += `\n                                                    <div \n                                                        class="multicombo-item" \n                                                        style="${n.color ? "background-color:" + n.color + ";color:" + util.contrastingTextColorTo(n.color) : ""}"\n                                                    >\n                                                        ${n.icon ? `<div class="choice-symbol ic ic-${n.icon}"></div>` : ""}\n                                                        <span>${htmlEscape(n.caption || "")}</span>\n                                                    </div>`)
                                                }
                                                s.innerHTML = e,
                                                s.style.background = ""
                                            }
                                        }))
                                    } else if ("color" === n)
                                        a && (c += `<div\n                                        class="t-cell-content-colored" \n                                        style="background-color:${a}"></div>`);
                                    else if ("icon" === n)
                                        a && (c = '<div class="choice-symbol ic ic-' + a + '"></div>');
                                    else if (("number" === n || "string" === n) && null != o.conditionalStyling && o.conditionalStyling.length > 0) {
                                        let e = !1;
                                        for (let n = 0; n < o.conditionalStyling.length && !e; n++) {
                                            const s = o.conditionalStyling[n];
                                            switch (s.operand) {
                                            case "=":
                                                a === s.value && (e = !0);
                                                break;
                                            case ">":
                                                a > s.value && (e = !0);
                                                break;
                                            case ">=":
                                                a >= s.value && (e = !0);
                                                break;
                                            case "<":
                                                a < s.value && (e = !0);
                                                break;
                                            case "<=":
                                                a <= s.value && (e = !0);
                                                break;
                                            case "!=":
                                                null != a && a !== s.value && (e = !0);
                                                break;
                                            case "startsWith":
                                                null != a && String(a).startsWith(s.value) && (e = !0);
                                                break;
                                            case "endsWith":
                                                null != a && String(a).endsWith(s.value) && (e = !0);
                                                break;
                                            case "contains":
                                                null != a && String(a).includes(s.value) && (e = !0);
                                                break;
                                            case "f(x)":
                                                {
                                                    const i = database.loadNodeSync(t),
                                                        o = queries.parseSystem(database.schema, this.type, s.value, {});
                                                    if (i && o) {
                                                        o.evaluateSync(database, i) && (e = !0)
                                                    }
                                                    break
                                                }
                                            }
                                            e && (c = `\n                                            <div \n                                                class="multicombo-item" \n                                                style="${"background-color:" + (s.background || "") + ";color:" + s.color || !1}"\n                                            >\n                                                ${s.icon ? `<div class="choice-symbol ic ic-${s.icon}"></div>` : ""}\n                                                <span>${htmlEscape(i.format(a))}</span>\n                                            </div>`, d = s.cell || "")
                                        }
                                        e || (c = htmlEscape(i.format(a)))
                                    } else if ("styled" === n)
                                        a && (c += `<div \n                                        class="multicombo-item" \n                                        style="${a.background ? `background-color:${a.background};` : ""}${a.color ? `color:${a.color};` : ""}"\n                                    >\n                                        ${a.icon ? `<div class="choice-symbol ic ic-${a.icon}"></div>` : ""}\n                                        <span>${htmlEscape(a.text || "")}</span>\n                                    </div>`);
                                    else if ("file" === i.base) {
                                        if (a) {
                                            const e = database.thumbURL1(a);
                                            e && (c = '<img style="height:100%" src="' + e + '">')
                                        }
                                    } else {
                                        const e = i.format(a);
                                        c = htmlEscape(e)
                                    }
                                }
                                h || (l !== c && (s.innerHTML = c), s.style.background = d)
                            } else
                                s.innerHTML = "",
                                s.style.backgroundColor = "#f7f7f7"
                        }
                    }
                }
                const w = null == r && (h + a) % 2 == 0,
                    x = "t-row" + (m === l.length ? " new --ul-new-row" : m < 0 || m > l.length ? " empty" : (v ? " choosen" : b ? " group" : "") + (w ? " t-row-2nd" : " t-row-1st"));
                x !== u.className && (u.className = x),
                f.firstChild.innerHTML = m < 0 || m >= l.length || v || b ? "" : String(m + 1);
                const T = "t-rowhead" + (m === l.length ? " i-16 i-light-grey i-plus" : m < 0 || m > l.length ? "empty" : v ? " choosen i-16 i-blue i-check" : b ? y ? " group i-24 i-light-grey i-line-down" : " group i-24 i-light-grey i-line-right" : "");
                T !== f.className && (f.className = T)
            }
        },
        qn.prototype.resizeColumns = function() {
            for (var e = this.viewRows, t = this.cols, i = 0, o = 0; o < e.length; o++) {
                var n = e[o];
                i = this.leftWidth;
                for (var s = 0; s < t.length; s++) {
                    var a = (l = t[s]).width,
                        r = n.$cells[s];
                    r.style.left = i + "px",
                    r.style.width = a + "px",
                    i += a
                }
            }
            i = this.leftWidth;
            for (s = 0; s < t.length; s++) {
                var l;
                (l = t[s]).left = i;
                a = l.width;
                var c = l.$headCell;
                c.style.left = i + "px",
                c.style.width = a + "px";
                var d = l.$footCell;
                d.style.left = i + "px",
                d.style.width = a + "px",
                i += a
            }
            this.viewWidth = i,
            this.$head.style.width = i + "px",
            this.$foot.style.width = i + "px",
            this.updateScrollbar(),
            this.updateSelection(),
            this.updateEditor()
        },
        qn.prototype.toggle = function(e) {
            this.groups[e] && (this.expanded[e] ? this.collapse(e) : this.expand(e))
        },
        qn.prototype.expandSilently = function(e) {
            var t = this.groups[e];
            if (t && !this.expanded[e]) {
                var i = this.rows.indexOf(e);
                -1 !== i && (this.expanded[e] = !0, this.rows = this.rows.slice(0, i + 1).concat(t.children).concat(this.rows.slice(i + 1)))
            }
        },
        qn.prototype.expand = function(e) {
            this.expandSilently(e),
            this.updateRows(),
            this.rowsChanged(),
            this.retainSelection()
        },
        qn.prototype.expandAll = function() {
            var e = this.expanded,
                t = this.groups,
                i = this.rows,
                o = !1;
            for (var n in t)
                if (t.hasOwnProperty(n) && !e[n]) {
                    var s = t[n],
                        a = i.indexOf(n);
                    i = i.slice(0, a + 1).concat(s.children).concat(i.slice(a + 1)),
                    e[n] = !0,
                    o = !0
                }
            o && (this.rows = i, this.updateRows(), this.rowsChanged(), this.retainSelection())
        },
        qn.prototype.collapse = function(e) {
            var t = this.groups[e];
            if (t && this.expanded[e]) {
                delete this.expanded[e];
                var i = this.rows.indexOf(e);
                -1 !== i && (this.rows = this.rows.slice(0, i + 1).concat(this.rows.slice(i + 1 + t.children.length)), this.updateRows(), this.rowsChanged(), this.retainSelection(!0))
            }
        },
        qn.prototype.collapseAll = function() {
            var e = this.expanded,
                t = this.groups,
                i = this.rows,
                o = !1;
            for (var n in t)
                if (t.hasOwnProperty(n) && e[n]) {
                    var s = t[n],
                        a = i.indexOf(n);
                    i = i.slice(0, a + 1).concat(i.slice(a + 1 + s.children.length)),
                    delete e[n],
                    o = !0
                }
            o && (this.rows = i, this.updateRows(), this.rowsChanged(), this.retainSelection(!0))
        },
        qn.prototype.getDependencies = function() {
            for (var e = this.cols, t = {}, i = 0; i < e.length; i++) {
                var o = e[i];
                t = queries.extendDependencies(t, o.expression.dependencies)
            }
            return t
        },
        qn.prototype.load = function(e) {
            console.log("Table.load: " + this.tid);
            var t = this;
            t._loadCallbacks.push(e),
            t.ready = !1;
            var i = (t._reloadId || 0) + 1;
            t._reloadId = i;
            var o = database.schema.types[t.tid];
            if (!o)
                return l("Type not found " + t.tid);
            if (o.isNew)
                return l();
            var n,
                s = t.getWhereExpression(),
                a = t.getDependencies();
            function r(e) {
                database.loadNodes2(e, a, (function(n) {
                    if (i === t._reloadId)
                        return n ? l(n) : void database.filterReadable(o, e, (function(e) {
                            i === t._reloadId && t.calc(i, e, (function() {
                                i === t._reloadId && (t.resort(), t.scrollToVisible(), console.log("Table.load loaded: " + t.tid, t.rows), t.container.loaded(), l())
                            }))
                        }))
                }))
            }
            function l(e) {
                console.log("Table.load done: " + t.tid);
                var i = t._loadCallbacks;
                t._loadCallbacks = [];
                for (var o = 0; o < i.length; o++)
                    try {
                        i[o](e)
                    } catch (e) {
                        console.log(e)
                    }
            }
            database.selectFromTypeWhereSQL ? (n = t.getSQLFilter(), database.selectFromTypeWhereSQL(o.id, s, n, (function(e, o) {
                if (i === t._reloadId)
                    return e ? l(e) : void r(o)
            }))) : database.selectFromTypeWhere(o.id, s, (function(e, o) {
                if (i === t._reloadId) {
                    if (Date.now(), e)
                        return l(e);
                    r(o)
                }
            }))
        },
        qn.prototype.getSQLFilter = function() {
            this.type;
            for (var e = [], t = this.cols, i = 0; i < t.length; i++) {
                var o = t[i];
                if (o.filter && o.directFid && o.field.isSQLFilterable)
                    try {
                        var n = queries.parseFilter(o.filter);
                        n.isSQLFilterable && e.push(n.toSQLFilter("f_" + o.directFid))
                    } catch (e) {
                        console.warn(e)
                    }
            }
            return e.join(" AND ")
        },
        qn.prototype.getWhereExpression = function() {
            for (var e = [], t = this.cols, i = 0; i < t.length; i++) {
                var o = t[i];
                if (o.filter)
                    try {
                        var n = queries.parseFilter(o.filter);
                        n && e.push("(" + n.toQueryPart(o.expression.toString()) + ")")
                    } catch (e) {
                        console.warn(e)
                    }
            }
            if (e.length) {
                var s = e.join(" and ");
                return queries.parseSystem(database.schema, this.type, s, {})
            }
        },
        qn.prototype.calc = function(e, t, i) {
            for (var o = this, n = database.isSync, s = {}, a = [], r = o.cols, l = [], c = [], d = o.midChoosen, h = o.onlyChoosen, p = 1, u = 0; u < r.length; u++) {
                var f = (x = r[u]).expression;
                x.directFid ? (l[u] = x.directFid, c[u] = void 0) : (l[u] = void 0, n || f.isSync() ? c[u] = f.getSyncJS() : c[u] = void 0)
            }
            for (var m = 0; m < t.length; m++) {
                var g = t[m],
                    v = [],
                    b = database.loadNodeSync(g);
                if (b) {
                    var y = {
                        id: g,
                        values: v = []
                    };
                    s[g] = y,
                    h ? d[g] && a.push(g) : a.push(g);
                    for (u = 0; u < r.length; u++) {
                        var w = l[u];
                        if (w)
                            v[u] = b[w];
                        else {
                            var x,
                                T = c[u];
                            if (T)
                                v[u] = T(T.ctx, database, b);
                            else
                                $(f = (x = r[u]).expression, b, v, u)
                        }
                    }
                }
            }
            function $(t, i, n, s) {
                p++;
                var a = t.getAsyncJS();
                a(a.ctx, database, i, {}, (function(t) {
                    e === o._reloadId && (n[s] = t, 0 === --p && C())
                }))
            }
            function C() {
                if (e === o._reloadId) {
                    o.groups = {},
                    o.groupsSorted = [],
                    o.models = s,
                    o.rows = a,
                    o.removedIndex = {};
                    var t = o.midChoosen,
                        n = {};
                    for (var r in t)
                        t.hasOwnProperty(r) && s[r] && (n[r] = !0);
                    o.midChoosen = n,
                    i()
                }
            }
            0 === --p && C()
        },
        qn.prototype.recalc = function(e, t) {
            var i = 1,
                o = database.isSync,
                n = this.models[e];
            if (n) {
                var s = n.values,
                    a = database.loadNodeSync(e),
                    r = this.cols;
                if (a)
                    for (var l = 0; l < r.length; l++) {
                        var c = r[l],
                            d = c.expression,
                            h = c.directFid;
                        h ? s[l] = a[h] : o || d.isSync() ? s[l] = d.evaluateSync(database, a) : p(d, a, s, l)
                    }
                else {
                    console.warn("MISSING NODE", e);
                    for (l = 0; l < r.length; l++)
                        s[l] = void 0
                }
                0 === --i && u()
            }
            function p(e, t, o, n) {
                i++;
                var s = e.getAsyncJS();
                s(s.ctx, database, t, {}, (function(e) {
                    o[n] = e,
                    0 === --i && u()
                }))
            }
            function u() {
                t()
            }
        },
        qn.prototype.aggregate = function() {
            this.aggregateGroups(),
            this.aggregateFoot()
        },
        qn.prototype.aggregateGroups = function() {
            var e = this.groups,
                t = this.cols,
                i = this.cidxGroup;
            for (var o in e)
                if (e.hasOwnProperty(o))
                    for (var n = e[o], s = this._aggregate(n.children), a = 0; a < t.length; a++) {
                        if (a !== i)
                            t[a].agg ? n.values[a] = s[a] : n.values[a] = void 0
                    }
        },
        qn.prototype.aggregateFoot = function() {
            var e,
                t,
                i,
                o,
                n,
                s,
                a = this.rows,
                r = this.midChoosen,
                l = this.models,
                c = this.groups,
                d = this.expanded,
                h = [];
            if (null != this.cidxGroup) {
                if (T.isEmpty(r))
                    for (t = 0; t < a.length; t++)
                        l[i = a[t]] ? h.push(i) : (e = c[i]) && !d[i] && (h = h.concat(e.children));
                else
                    for (t = 0; t < a.length; t++)
                        if (l[i = a[t]] && r[i])
                            h.push(i);
                        else if ((e = c[i]) && !d[i])
                            for (n = e.children, o = 0; o < n.length; o++)
                                l[s = n[o]] && r[s] && h.push(s)
            } else if (T.isEmpty(r))
                for (t = 0; t < a.length; t++)
                    l[i = a[t]] && h.push(i);
            else
                for (t = 0; t < a.length; t++)
                    r[i = a[t]] && h.push(i);
            this.foot = {
                values: this._aggregate(h)
            }
        },
        qn.prototype._aggregate = function(e) {
            for (var t = this.cols, i = this.models, o = [], n = 0; n < t.length; n++) {
                switch ((h = t[n]).agg) {
                case "sum":
                case "cnt":
                    o[n] = 0;
                    break;
                case "avg":
                    o[n] = [0, 0];
                    break;
                case "min":
                    o[n] = 1 / 0;
                    break;
                case "max":
                    o[n] = -1 / 0;
                    break;
                case "first":
                case "last":
                    o[n] = null;
                    break;
                case "concat":
                    o[n] = []
                }
            }
            for (var s = 0; s < e.length; s++) {
                var a = i[e[s]];
                if (a) {
                    var r = a.values;
                    for (n = 0; n < t.length; n++) {
                        if ((h = t[n]).agg) {
                            var l = r[n],
                                c = Number(l);
                            switch (h.agg) {
                            case "sum":
                                isNaN(c) || (o[n] += c);
                                break;
                            case "cnt":
                                null != l && !1 !== l && "" !== l && o[n]++;
                                break;
                            case "avg":
                                null == l || "number" != typeof l || isNaN(c) || (o[n][0] += c, o[n][1]++);
                                break;
                            case "min":
                                null !== l && l < o[n] && (o[n] = l);
                                break;
                            case "max":
                                null !== l && l > o[n] && (o[n] = l);
                                break;
                            case "first":
                                0 === s && (o[n] = l);
                                break;
                            case "last":
                                s === e.length - 1 && (o[n] = l);
                                break;
                            case "concat":
                                null != l && (o[n].length < 20 ? o[n].push(h.field.format(l)) : 20 === o[n].length && o[n].push("..."))
                            }
                        }
                    }
                }
            }
            var d = [];
            for (n = 0; n < t.length; n++) {
                var h;
                switch ((h = t[n]).agg) {
                case "sum":
                case "cnt":
                    d[n] = o[n];
                    break;
                case "avg":
                    d[n] = o[n][1] > 0 ? o[n][0] / o[n][1] : void 0;
                    break;
                case "min":
                    d[n] = o[n] === 1 / 0 ? void 0 : o[n];
                    break;
                case "max":
                    d[n] = o[n] === -1 / 0 ? void 0 : o[n];
                    break;
                case "first":
                case "last":
                    d[n] = o[n];
                    break;
                case "concat":
                    d[n] = o[n].join(", ");
                    break;
                default:
                    d[n] = void 0
                }
            }
            return d
        },
        qn.prototype.updateHead = function() {
            for (var e = this.cols, t = this.sortDescending, i = this.cidxGroup, o = this.cidxSort, n = 0; n < e.length; n++) {
                var s = e[n],
                    a = s.$headCell,
                    r = n === i,
                    l = n === o,
                    c = !!s.filter,
                    d = '<div class="t-head-resizer"></div><span>' + htmlEscape(s.caption || s.expression.caption) + "</span>" + (c ? '<div class="i-40-16 i-light-grey i-setting-filter" style="width: 12px;"></div>' : "") + (r ? '<div class="i-40-18 i-light-grey i-table-group" style="width: 24px"></div>' : l ? t ? '<div class="i-40-12 i-light-grey i-line-down-thick" style="width: 12px;"></div>' : '<div class="i-40-12 i-light-grey i-line-up-thick" style="width: 12px;"></div>' : "");
                a.innerHTML = d
            }
        },
        qn.prototype.updateFoot = function() {
            if (this.visible && this.ready && !this.silent) {
                for (var e = this.cols, t = this.foot, i = 0; i < e.length; i++) {
                    var o = e[i];
                    if (o.isReadable)
                        if (o.agg) {
                            o.aggType.base;
                            var n = o.aggType.format(t.values[i]);
                            null == n && (n = "");
                            var s = tables.aggTypeToSymbol(o.agg, n);
                            o.$footCell.innerHTML = s
                        } else
                            o.$footCell.innerHTML = "";
                    else
                        o.$footCell.innerHTML = ""
                }
                T.isEmpty(this.midChoosen) && !this.onlyChoosen ? (this.$footRuler.className = "t-foot-ruler", this.$foot.className = "t-foot") : (this.$footRuler.className = "t-foot-ruler choosen", this.$foot.className = "t-foot choosen")
            }
        },
        qn.prototype.resort = function() {
            void 0 === this.cidxGroup ? this.sort(this.cidxSort, this.sortDescending) : this.group(this.cidxGroup, this.cidxSort, this.sortDescending)
        },
        qn.prototype.sort = function(e, t) {
            if (void 0 !== this.cidxGroup)
                return this.group(this.cidxGroup, e, t);
            var i = this.models,
                o = this.rows;
            this.removedIndex = {},
            this.groups = {},
            this.groupsSorted = [];
            var n = this.cols[e];
            if (n) {
                var s = n.field;
                this.cidxSort = e,
                this.cidxGroup = void 0,
                this.sortDescending = !0 === t;
                var a = this.sortDescending ? -1 : 1,
                    r = s.comparator;
                if (r) {
                    for (var l = [], c = 0; c < o.length; c++) {
                        var d = o[c],
                            h = i[d];
                        l[c] = [s.comparable(h.values[e]), d]
                    }
                    "string" === r ? l.sort((function(e, t) {
                        return a * e[0].localeCompare(t[0])
                    })) : "number" === r && l.sort((function(e, t) {
                        return a * (e[0] - t[0])
                    }));
                    for (c = 0; c < o.length; c++)
                        o[c] = l[c][1]
                }
            }
            this.aggregate(),
            this.ready = !0,
            this.updateRows(),
            this.updateHead(),
            this.updateFoot(),
            this.retainSelection()
        },
        qn.prototype.ungroup = function() {
            this.cidxGroup = void 0,
            this.expanded = {},
            this.rows = T.keys(this.models),
            this.sort(this.cidxSort, this.sortDescending)
        },
        qn.prototype.group = function(e, t, i) {
            i = this.sortDescending = !0 === i,
            t = this.cidxSort = void 0 === t ? this.cidxSort : t;
            var o = this.models,
                n = this.cols,
                s = n[e],
                a = n[t];
            if (!s)
                return this.cidxGroup = void 0, void this.sort(t, i);
            if (this.cidxGroup = e, this.removedIndex = {}, a || (this.cidxSort = 0, a = n[0]), a && s) {
                var r = s.field,
                    l = a.field,
                    c = {},
                    d = [];
                for (var h in o)
                    if (o.hasOwnProperty(h) && (!this.onlyChoosen || this.midChoosen[h])) {
                        var p = o[h].values[e],
                            u = "_group_" + (null == p ? "" : JSON.stringify(p));
                        (b = c[u]) || (b = {
                            id: u,
                            value: p,
                            children: [],
                            values: []
                        }, c[u] = b, b.values[e] = p, d.push(u)),
                        b.children.push(h)
                    }
                var f = this.sortDescending ? -1 : 1;
                for (var m in c) {
                    if (c.hasOwnProperty(m))
                        (b = c[m]).children.sort((function(e, i) {
                            var n = o[e],
                                s = o[i],
                                a = n.values[t],
                                r = s.values[t];
                            return f * l.compare(a, r)
                        }))
                }
                f = e === t && i ? -1 : 1,
                d.sort((function(e, t) {
                    var i = c[e],
                        o = c[t];
                    return f * r.compare(i.value, o.value)
                })),
                this.cidxGroup = e,
                this.groups = c,
                this.groupsSorted = d,
                this.rows = d;
                var g = this.expanded,
                    v = {};
                for (var m in g) {
                    var b;
                    if (g.hasOwnProperty(m))
                        if (b = c[m]) {
                            var y = this.rows.indexOf(m);
                            this.rows = this.rows.slice(0, y + 1).concat(b.children).concat(this.rows.slice(y + 1)),
                            v[m] = !0
                        }
                }
                this.expanded = v
            }
            this.aggregate(),
            this.ready = !0,
            this.updateRows(),
            this.updateHead(),
            this.updateFoot(),
            this.retainSelection()
        },
        qn.prototype.openFindMenu = function() {
            var e = this,
                t = $.backplane({}),
                i = $('<div class="nx-menu-popup grey find-popup-width" style="border-radius:4px">').appendTo(t);
            $("<h1>").text(locale.search).appendTo(i);
            var o = $.input({
                    $container: i,
                    enter: s,
                    escape: a
                }),
                n = [];
            function s() {
                var t = o.val();
                a(),
                e.applyFind(t)
            }
            function a() {
                t.close()
            }
            n.push({
                caption: locale.cancel,
                click: a
            }),
            n.push("-"),
            !e.onlyChoosen && T.isEmpty(e.midChoosen) || (n.push({
                caption: locale.showAll,
                click: function() {
                    a(),
                    e.clearFind()
                }
            }), n.push(" ")),
            n.push({
                caption: locale.search,
                click: s,
                cls: "blue"
            }),
            $.buttons({
                $container: i,
                items: n
            }),
            i.center(),
            o.focus()
        },
        qn.prototype.clearFind = function() {
            this.midChoosen = {},
            this.showAll()
        },
        qn.prototype.applyFind = function(e) {
            if (e && "string" == typeof e) {
                Object(l.f)("TableSearch", "Apply");
                var t = e.toLocaleLowerCase().trim().split(" ");
                if (!(t.length < 1)) {
                    for (var i = [], o = [], n = [], s = 0; s < t.length; s++) {
                        var a = t[s];
                        a.length > 0 && (i.push(a), o.push(Number(a)), n.push(util.containsRegExp(a)))
                    }
                    if (!(i.length < 1)) {
                        var r = {},
                            c = this.cols,
                            d = this.models;
                        for (var h in d) {
                            if (d.hasOwnProperty(h))
                                p(d[h]) && (r[h] = !0)
                        }
                        this.midChoosen = r,
                        this.showOnlyChoosen()
                    }
                }
            }
            function p(e) {
                var t,
                    s,
                    a,
                    r,
                    l,
                    d,
                    h = e.values,
                    p = !0;
                e:
                for (t = 0; t < n.length; t++) {
                    for (a = n[t], o[t], i[t], s = 0; s < c.length; s++)
                        if (r = c[s].field, null != (l = h[s]))
                            switch (r.base) {
                            case "string":
                            case "html":
                            case "file":
                            case "link":
                            case "email":
                                if (a.test(l))
                                    continue e;
                                break;
                            case "choice":
                                if ((d = r.values[l]) && a.test(d.caption))
                                    continue e;
                                break;
                            default:
                                if (a.test(r.format(l)))
                                    continue e
                            }
                    p = !1;
                    break e
                }
                return p
            }
        },
        qn.prototype.openContextMenu = function(e) {
            this.contextState = {
                target: {
                    getBoundingClientRect: () => ({
                        bottom: e.clientY,
                        height: 0,
                        left: e.clientX,
                        right: e.clientX,
                        top: e.clientY,
                        width: 0
                    })
                }
            },
            this.isTableEditMode() ? this.contextState.items = this.openContextMenu_TABLE(e) : this.contextState.items = this.openContextMenu_FORM(e),
            this.updateUI()
        },
        qn.prototype.openContextMenu_TABLE = function(e) {
            return e.preventDefault(), [{
                text: locale.cut,
                onClick: () => NinoxDocumentInteraction.execCut()
            }, {
                text: locale.copy,
                onClick: () => NinoxDocumentInteraction.execCopy()
            }, {
                text: locale.paste,
                onClick: () => NinoxDocumentInteraction.execPaste()
            }]
        },
        qn.prototype.openContextMenu_FORM = function(e) {
            var t = this.type,
                i = $(e.target).closest(".t-head-cell");
            if (i.length) {
                var o = parseInt(i.attr("data-cidx"));
                return null != o && this.popupColumnMenu(o, e), void e.preventDefault()
            }
            var n = !T.isEmpty(this.midChoosen),
                s = this;
            const a = [];
            return a.push({
                text: locale.clearSelection,
                onClick: () => s.clearChoosen(),
                disabled: !n
            }), a.push({
                text: locale.toggleSelection,
                onClick: () => s.toggleChoosen(),
                disabled: !n
            }), a.push({
                text: locale.selectAll,
                onClick: () => s.chooseAll()
            }), a.push({
                topBorder: !0,
                text: locale.showOnlyChoosen,
                onClick: () => s.showOnlyChoosen(),
                disabled: !n || s.onlyChoosen
            }), a.push({
                text: locale.showAll,
                onClick: () => s.showAll(),
                disabled: !s.onlyChoosen
            }), null != s.cidxGroup && (a.push({
                topBorder: !0,
                text: locale.expandAll,
                onClick: () => s.expandAll()
            }), a.push({
                text: locale.collapseAll,
                onClick: () => s.collapseAll()
            })), a.push({
                topBorder: !0,
                text: locale.removeAllChoosen,
                onClick: () => s.removeAllChoosen(),
                disabled: !n || n && !database.canDelete(t)
            }), e.preventDefault(), a
        },
        qn.prototype.exportData = function() {
            new Vn(this)
        },
        qn.prototype.setColumnWidth = function(e, t, i, o) {
            var n = this.cols[e];
            n && (null == t && (t = n.width), n.width = i, this.resizeColumns(), this.saveView(), o && o())
        },
        qn.prototype.duplicate = function() {
            var e = this;
            Object(c.b)(this.getSelectedNid(), (function(t) {
                e.addRow(t, !1),
                e.select(t, !0, void 0)
            }))
        },
        qn.prototype.create = function() {
            var e = this;
            Object(c.a)(this.type, (function(t) {
                e.addRow(t, !1),
                e.select(t, !0)
            }))
        },
        qn.prototype.remove = function() {
            Object(c.j)(this.getSelectedNid())
        },
        qn.prototype.print = function() {
            Object(c.i)(this.getSelectedNid(), this.getChoosenOrSelectedNids())
        },
        qn.prototype.popupColumnMenu = function(e, t) {
            var i = this,
                o = i.cols[e];
            if (!o)
                return;
            var n = $(t.target).closest(".t-head-cell").offset();
            t && null != t.clientX && (n.left = t.clientX);
            var s = e === i.cidxSort && !i.sortDescending,
                a = e === i.cidxSort && i.sortDescending,
                r = e === i.cidxGroup,
                l = $.backplane({
                    closed: function() {
                        v.destroy()
                    }
                });
            const c = "number" === o.expression.returnType.base ? "number" : "string" === o.expression.returnType.base ? "string" : null;
            var d = $('<div class="nx-menu-popup grey column-menu">').appendTo(l);
            if (database.isAdmin())
                var h = $('<div class="column-menu-section" style="display:flex;display:-webkit-flex;flex-direction:row;-webkit-flex-direction:row">').appendTo(d),
                    p = $('<div style="flex-grow:1;-webkit-flex-grow:1;width:48px">').appendTo(h),
                    u = ($('<div style="width:32px;padding:8px"><div class="nx-button-icon blue"><div class="type-symbol type-symbol-white type-symbol-fn"></div></div></div>').appendTo(h).click((function() {
                        new ft.a({
                            schema: i.type.schema,
                            type: i.type,
                            variables: {},
                            supportsCommands: !1,
                            value: o.expression.toString(),
                            okay: function(e, t) {
                                if (l.close(), e && t) {
                                    o.expression = t,
                                    o.field = t.returnType,
                                    o.agg && (-1 === t.returnType.aggregations.indexOf(o.agg) ? o.agg = void 0 : o.aggType = aggregations.aggType(o.agg, t.returnType));
                                    var n = i.type.fields[t.toString()];
                                    n && n.isField && "fn" !== n.base && "file" !== n.base ? o.directFid = n.id : o.directFid = void 0
                                }
                                i.reload(),
                                i.resize(),
                                i.saveView()
                            },
                            cancel: function() {}
                        })
                    })), $('<div class="component editor" style="width:100%">').appendTo(p)),
                    f = $('<input type="text">').val(o.caption).attr("placeholder", o.expression.caption).appendTo($('<div class="stringeditor">').appendTo(u)).change((function() {
                        o.caption = f.val() || void 0,
                        l.close(),
                        i.resize(),
                        i.saveView()
                    }));
            var m = $('<div class="column-menu-section">').appendTo(d),
                g = $('<div class="component editor" style="width:100%">').appendTo(m),
                v = tables.createFilterEditor({
                    updateFilter: function(e) {
                        e && l.close(),
                        o.filter = v.getFilter(),
                        i.reload(),
                        i.rowsChanged(),
                        i.saveView()
                    }
                }, g, o.field, o.filter),
                b = $('<div class="column-menu-section">').appendTo(d),
                y = $('<div class="component editor" style="width:100%;padding:0 8px">').appendTo(b),
                w = $('<div class="switch table-popup-sorting">').appendTo(y);
            $('<div class="switch-item' + (s ? " selected" : "") + '">').append($('<div class="icon i-32-12 i-light-grey i-line-up-thick inline-block">')).append($("<span>").text(locale.sortAscending)).appendTo(w).click((function() {
                l.close(),
                i.sort(e, !1),
                i.rowsChanged(),
                i.saveView()
            })),
            $('<div class="switch-item' + (a ? " selected" : "") + '">').append($('<div class="icon i-32-12 i-light-grey i-line-down-thick inline-block">')).append($("<span>").text(locale.sortDescending)).appendTo(w).click((function() {
                l.close(),
                i.sort(e, !0),
                i.rowsChanged(),
                i.saveView()
            })),
            $('<div class="switch-item' + (r ? " selected" : "") + '" style="margin-top: 4px;">').append($('<div class="icon i-32-16 i-light-grey i-table-group inline-block">')).append($("<span>").text(locale.grouped)).appendTo(w).click((function() {
                l.close(),
                r ? i.ungroup() : i.group(e),
                i.rowsChanged(),
                i.saveView()
            }));
            var x = o.field.aggregations;
            if (x && x.length) {
                var C = $('<div class="column-menu-section">').appendTo(d),
                    k = $('<div class="component editor" style="width:100%;padding:0 8px 8px 0">').appendTo(C),
                    S = $('<div class="switch">').appendTo(k);
                T.each(x, (function(e) {
                    $('<div class="switch-item' + (e === o.agg ? " selected" : "") + '">').text(locale.agg[e]).appendTo(S).click((function() {
                        l.close(),
                        e !== o.agg ? (o.agg = e, o.aggType = aggregations.aggType(e, o.field)) : (o.agg = void 0, o.aggType = void 0),
                        i.aggregate(),
                        i.updateRows(),
                        i.updateFoot(),
                        i.rowsChanged(),
                        i.saveView()
                    }))
                }))
            }
            if (null !== c && $('<div class="buttons">').appendTo(d).append(`<div class="root-help-link">${locale.conditionalStyling}...</div>`).touch((function() {
                l.close(),
                new wi(i.type, o, (function(t) {
                    const o = i.getConfig();
                    o.cols[e].conditionalStyling = t,
                    i.configureAndLoad(o),
                    i.saveView()
                }), c)
            })), "email" === o.field.base && $('<div class="buttons">').appendTo(d).append('<div class="nx-button-text grey">Send mail...</div>').touch((function() {
                l.close(),
                i.sendMailForColumn(o)
            })), database.isAdmin()) {
                var E = $('<div class="buttons">').appendTo(d);
                $('<div class="nx-button-text grey">').text(locale.hideColumn).appendTo(E).click((function() {
                    l.close(),
                    i.removeColumn(e)
                })),
                $('<div class="nx-hspace-flex">').appendTo(E),
                $('<div class="nx-button-text blue">').text(locale.showColumn + "...").appendTo(E).click((function() {
                    l.close(),
                    i.popupAddColumnMenu(e, void 0, t)
                }))
            }
            var _ = d.outerWidth(),
                D = d.outerHeight();
            n.left -= 8,
            n.top += this.rowHeight + 0,
            n.left + _ > window.getWidth() && (n.left = window.getWidth() - _),
            n.top + D > window.getHeight() && (n.top = window.getHeight() - D),
            d.offset(n)
        },
        qn.prototype.sendMailForColumn = function(e) {
            var t = this.cols.indexOf(e);
            if (-1 !== t) {
                for (var i = this.rows, o = this.models, n = {}, s = 0; s < i.length; s++) {
                    var a = o[i[s]];
                    if (a) {
                        var r = a.values[t];
                        r && util.isValidEmail(r) && (n[r] = 1)
                    }
                }
                var l = Object.keys(n);
                for (s = 0; s < l.length; s++)
                    l[s] = encodeURIComponent(l[s]);
                var c = "mailto:" + l.join(",");
                NinoxDocumentInteraction.openBrowser(c)
            }
        },
        qn.prototype.popupAddColumnMenu = function(e, t, i) {
            var o = this.cols;
            null == e && (e = o.length);
            o[e];
            var n = $(i.target).closest(".t-head-cell").offset();
            n.top += this.rowHeight + 0;
            var s = this;
            t || (t = [{
                type: this.type,
                path: "",
                multiple: !1
            }]);
            var a = [];
            for (var r = {}, l = 0; l < o.length; l++) {
                var c = o[l].expression;
                c && (r[c.toString()] = !0)
            }
            t.length > 1 ? a.push({
                icon: "i-32-24 i-light-grey i-arrow-solid-left",
                caption: locale.back,
                click: function() {
                    var o = t.slice(1);
                    s.popupAddColumnMenu(e, o, i)
                }
            }) : a.push({
                icon: "i-light-grey i-32-24 i-field-fn",
                caption: locale.function,
                click: function() {
                    new ft.a({
                        schema: s.type.schema,
                        type: s.type,
                        variables: {},
                        supportsCommands: !1,
                        value: "",
                        okay: function(t, i) {
                            t && i && s.addColumn(e + 1, t)
                        },
                        cancel: function() {}
                    })
                }
            });
            var d = t[0].type,
                h = t[0].path,
                p = t[0].multiple;
            r[h + "_id"] || a.push({
                icon: "i-32-24 i-light-grey i-field-number",
                caption: locale.id,
                field: d.field_id,
                click: g
            });
            var u = d.sorted;
            database.supports.authentication && (u = u.concat([d.field_cu, d.field_cd, d.field_mu, d.field_md]));
            for (var f = 0; f < u.length; f++) {
                var m = u[f];
                (m.isField || m.isReverse || m.isReference) && database.canRead(m) && (r[h + m.id] || a.push({
                    icon: "i-light-grey i-32-24 i-field-" + m.base,
                    caption: m.caption,
                    field: m,
                    click: g
                }))
            }
            function g() {
                var o = this.field;
                if (o.isReference) {
                    var a = [{
                        type: o.refType,
                        path: h + o.id + ".",
                        multiple: p
                    }].concat(t);
                    s.popupAddColumnMenu(e, a, i)
                } else if (o.isReverse) {
                    a = [{
                        type: o.refType,
                        path: h + o.id + ".",
                        multiple: !0
                    }].concat(t);
                    s.popupAddColumnMenu(e, a, i)
                } else if (o.isField)
                    if (p) {
                        for (var r = [{
                                icon: "i-32-24 i-light-grey i-arrow-solid-left",
                                caption: locale.back,
                                click: b
                            }], l = o.aggregations, c = 0; c < l.length; c++) {
                            var d = l[c];
                            r.push({
                                caption: locale.agg[d] + "(" + o.caption + ")",
                                field: o,
                                agg: d,
                                click: v
                            })
                        }
                        new bi({
                            offset: n,
                            head: {
                                caption: locale.showColumn
                            },
                            items: r
                        })
                    } else
                        s.addColumn(e + 1, h + o.id)
            }
            function v() {
                var t = this.agg,
                    i = this.field;
                s.addColumn(e + 1, t + "(" + h + i.id + ")")
            }
            function b() {
                s.popupAddColumnMenu(e, t, i)
            }
            new bi({
                offset: n,
                head: {
                    caption: locale.showColumn
                },
                items: a
            })
        },
        qn.prototype.removeColumn = function(e) {
            var t = this.getConfiguration();
            t.cols.splice(e, 1),
            e === t.sort ? t.sort = void 0 : e < t.sort && t.sort--,
            e === t.group && (t.group = void 0),
            e < t.group && t.group--,
            this.configureAndLoad(t),
            this.saveView()
        },
        qn.prototype.addColumn = function(e, t) {
            var i = this.getConfiguration();
            i.cols.splice(e, 0, {
                expression: t
            }),
            e <= i.sort && i.sort++,
            e <= i.group && i.group++,
            this.configureAndLoad(i),
            this.saveView()
        },
        qn.prototype.saveView = function() {
            this.container.saveView()
        },
        qn.prototype.getSelectedNids = function() {
            for (var e = this.rows, t = this.models, i = [], o = 0; o < e.length; o++) {
                var n = e[o];
                t[n] && i.push(n)
            }
            return i
        },
        qn.prototype.getChoosenNids = function() {
            for (var e = this.midChoosen, t = this.rows, i = this.models, o = [], n = 0; n < t.length; n++) {
                var s = t[n];
                i[s] && e[s] && o.push(s)
            }
            return o
        },
        qn.prototype.getChoosenOrSelectedNids = function() {
            return T.isEmpty(this.midChoosen) ? this.getSelectedNids() : this.getChoosenNids()
        },
        qn.prototype.dragValue = function(e, t, i, o, n, s) {
            var a = this,
                r = this.rows,
                l = this.models,
                c = this.getWritableField(e);
            if (c) {
                var d = c.base,
                    h = c.id,
                    p = n ? "date" === d ? E : "datx" === d ? function(e, t) {
                        if (null == e)
                            return null;
                        var i = new Date(e);
                        return i.setDate(i.getDate() + t), i.getTime()
                    } : "timestamp" === d ? E : "time" === d || "timeinterval" === d ? _ : "number" === d ? function(e, t) {
                        if (null == e)
                            return null;
                        return e + t
                    } : S : S,
                    u = r[t];
                if (u) {
                    var f = l[u];
                    if (f) {
                        var m = f.values[e];
                        void 0 === m && (m = null);
                        for (var g = [], v = s ? i - o - 1 : 1, b = i; b <= o; b++) {
                            var y = r[b];
                            if (y) {
                                var w = l[y];
                                if (w) {
                                    var x = p(m, v),
                                        T = w.values[e];
                                    if (!c.equals(x, T) && database.canWriteNodeField(y, h)) {
                                        var C = {
                                            _id: y
                                        };
                                        C[h] = x,
                                        g.push(C)
                                    }
                                    v++
                                }
                            }
                        }
                        g.length ? ($.loading(!0), a.silent = !0, database.updateNodes(g, (function(e) {
                            $.loading(!1),
                            a.silent = !1,
                            e && $.alert(e),
                            a.calc(a._reloadId, r, (function() {
                                a.aggregate(),
                                a.updateRows(),
                                a.updateFoot(),
                                k()
                            }))
                        }))) : k()
                    }
                }
            }
            function k() {
                a.selectBlock(Math.min(t, i, o), e, Math.max(t, i, o), e)
            }
            function S(e, t) {
                return null == e ? null : e
            }
            function E(e, t) {
                if (null == e)
                    return null;
                var i = new Date(e);
                return i.setDate(i.getDate() + t), i.getTime()
            }
            function _(e, t) {
                return null == e ? null : e + 36e5 * t
            }
        },
        qn.prototype.getWritableField = function(e) {
            var t = this.type,
                i = this.cols[e];
            if (i) {
                var o = i.expression ? i.expression.toString() : void 0,
                    n = t.fields[o];
                if (n && database.canWrite(n))
                    return n
            }
        },
        qn.prototype.toggleRowChoosen = function(e, t) {
            var i = this.rows,
                o = i[e];
            if (o) {
                var n = this.models;
                if (n[o]) {
                    var s,
                        a = this.midChoosen;
                    if (a[o]) {
                        if (delete a[o], !1, t)
                            if (null != (s = this.selectionR0)) {
                                s > e ? (l = s, s = e) : l = e;
                                for (var r = s; r <= l; r++) {
                                    n[c = i[r]] && delete a[c]
                                }
                            }
                    } else if (a[o] = !0, !0, t)
                        if (null != (s = this.selectionR0)) {
                            var l;
                            s > e ? (l = s, s = e) : l = e;
                            for (r = s; r <= l; r++) {
                                var c;
                                n[c = i[r]] && (a[c] = !0)
                            }
                        }
                    this.updateRows(),
                    this.aggregateFoot(),
                    this.updateFoot()
                }
            }
        },
        qn.prototype.colX = function(e, t) {
            var i = this.cols;
            return i[Math.max(0, Math.min(e, t, i.length - 1))].left
        },
        qn.prototype.colW = function(e, t) {
            var i = this.cols,
                o = i.length - 1;
            e >= 0 || (e = 0),
            t >= 0 || (t = 0),
            e <= o || (e = o),
            t <= o || (t = o);
            var n = i[Math.min(e, t)],
                s = i[Math.max(e, t)];
            return s.left + s.width - n.left
        },
        qn.prototype.rowY = function(e, t) {
            var i = e < t ? e : t;
            return (i - this.ridxTop) * this.rowHeight + 0 * (i - this.ridxTop)
        },
        qn.prototype.rowH = function(e, t) {
            return (Math.abs(t - e) + 1) * this.rowHeight
        },
        qn.prototype.rowHWithMargin = function(e, t) {
            return (Math.abs(t - e) + 1) * (this.rowHeight + 0) - 0
        },
        qn.prototype.keydown = function(e) {
            console.log("Table.keydown", e.which);
            var t = e.which,
                i = this.isEditing(),
                o = this.isTableEditMode();
            switch (t) {
            case 8:
                i || "cell" !== this.selectionMode && "block" !== this.selectionMode ? e.metaKey && !i && "row" === this.selectionMode && (T.isEmpty(this.midChoosen) ? this.remove() : this.removeAllChoosen(), e.preventDefault()) : (this.editorDelete(), e.preventDefault());
                break;
            case 9:
                o ? e.shiftKey ? this.editorPrev() : this.editorNext() : ui.sideEditor.focus(),
                e.preventDefault();
                break;
            case 13:
                if (e.shiftKey)
                    this.editorInsert("down");
                else {
                    var n = this.rows[this.selectionR0];
                    "row" === this.selectionMode && n && this.groups[n] ? this.toggle(n) : i ? this.editorDown() : this.startEdit()
                }
                e.preventDefault();
                break;
            case 27:
                i ? this.stopEdit(!1) : this.selectNothing(),
                e.preventDefault();
                break;
            case 32:
                this.onlyChoosen ? this.showAll() : T.isEmpty(this.midChoosen) || this.showOnlyChoosen(),
                e.preventDefault();
                break;
            case 33:
                e.metaKey ? this.editorPrevGroup() : this.editorPageUp(),
                e.preventDefault();
                break;
            case 34:
                e.metaKey ? this.editorNextGroup() : this.editorPageDown(),
                e.preventDefault();
                break;
            case 35:
                this.editorLast(),
                e.preventDefault();
                break;
            case 36:
                this.editorFirst(),
                e.preventDefault();
                break;
            case 37:
                n = this.rows[this.selectionR0];
                "row" === this.selectionMode && n && this.groups[n] ? this.collapse(n) : this.editorPrev(e.shiftKey),
                e.preventDefault();
                break;
            case 38:
                e.metaKey ? this.editorFirst(e.shiftKey) : e.altKey ? this.editorPageUp() : this.editorUp(e.shiftKey),
                e.preventDefault();
                break;
            case 39:
                n = this.rows[this.selectionR0];
                "row" === this.selectionMode && n && this.groups[n] ? this.expand(n) : this.editorNext(e.shiftKey),
                e.preventDefault();
                break;
            case 40:
                e.metaKey ? this.editorLast(e.shiftKey) : e.altKey ? this.editorPageDown() : this.editorDown(e.shiftKey),
                e.preventDefault();
                break;
            default:
                i || ((e.metaKey || e.ctrlKey) && 70 === t ? (this.openFindMenu(), e.preventDefault()) : !o || e.metaKey || e.ctrlKey || 8 === t || 16 === t || 17 === t || 18 === t || 91 === t || 93 === t || t >= 112 && t <= 123 || this.startEdit())
            }
        },
        qn.prototype.nodeRenamed = function(e, t, i) {
            var o = this,
                n = this.models[t];
            n && (n.id = i, delete this.models[t], this.models[i] = n);
            var s = this.rows.indexOf(t);
            -1 !== s && (this.rows[s] = i),
            this.midChoosen[t] && (delete this.midChoosen[t], this.midChoosen[i] = !0),
            (this.selectionMid0 = t) && (this.selectionMid0 = i),
            (this.selectionMid1 = t) && (this.selectionMid1 = i),
            o.recalc(i, (function() {
                o.aggregate(),
                o.updateRows(),
                o.updateFoot()
            }))
        },
        qn.prototype.rowsChanged = function() {
            this.container.rowsChanged()
        },
        qn.prototype.loadTableRowHeight = function() {
            if (void 0 === Bn) {
                Bn = 40;
                const e = NinoxDocumentInteraction.getUserDefault("ui.table.rowHeight");
                if (e) {
                    const t = parseInt(e);
                    t >= 28 && t <= 120 && (Bn = t)
                }
            }
            return Bn
        },
        qn.prototype.saveTableRowHeight = function(e) {
            Bn = e,
            NinoxDocumentInteraction.setUserDefault("ui.table.rowHeight", String(e))
        },
        Gn.prototype.base = "table",
        Gn.prototype.destroy = function() {
            return database.off("schema", void 0, this.schemaChanged, this), database.off("change", void 0, this.dataChanged, this), database.off("create", void 0, this.dataChanged, this), database.off("remove", void 0, this.dataChanged, this), database.off("view", void 0, this.viewsChanged, this), this.$controls.remove(), n.unmountComponentAtNode(this.$tabs[0]), this.$tabs.remove(), this.table.destroy(), T.each(this.renderers, (function(e) {
                e.destroy()
            })), !1
        },
        Gn.prototype.show = function() {
            this.visible || (ui.currentTab && ui.currentTab.hide(), this.visible = !0, ui.currentTab = this, this.$controls.appendTo(ui.$menuCenter), this.$tabs.appendTo(ui.$header), this.updateTabs(), this.reloadViews(), this.showView())
        },
        Gn.prototype.hide = function() {
            this.visible && (this.visible = !1, this.saveView(), this.$controls.detach(), n.unmountComponentAtNode(this.$tabs[0]), this.$tabs.detach(), this.hideView())
        },
        Gn.prototype.schemaChanged = function(e, t, i) {
            this.visible && (database.schema.types[this.tid] ? this.updateSwitch() : ui.openHome())
        },
        Gn.prototype.dataChanged = function(e) {
            this.visible && T.each(this.renderers, (function(e) {
                e.dataChanged()
            }))
        },
        Gn.prototype.viewsChanged = function(e, t, i) {
            this.visible && (this.reloadViews(), this.updateTabs(), this.showView())
        },
        Gn.prototype.reloadViews = function() {
            var e = this,
                t = this.tid;
            if (e.views = [], T.each(util.localeSortBy(T.filter(T.where(database.views, {
                type: t
            }), (function(e) {
                return database.canReadView(e)
            })), "caption"), (function(t) {
                t && (t.config && t.config.type !== t.type && (console.log("Correct view config"), t.config.type = t.type), e.views.push(t))
            })), 0 === this.views.length) {
                var i = {
                    id: util.createUUID(16),
                    type: t,
                    caption: locale.all,
                    order: 10,
                    config: {
                        type: t
                    }
                };
                this.views.push(i),
                database.saveView(i, (function() {}))
            } else {
                for (let e = 0; e < this.views.length; e++)
                    void 0 === this.views[e].order && (this.views[e].order = 10 * (e + 1));
                this.views = util.localeSortBy(this.views, "order")
            }
            this.updateSwitch()
        },
        Gn.prototype.reorderView = function(e, t, i) {
            const o = this.views[e];
            let n = null;
            this.selectedView[this.tid] === e && (n = t),
            e > t ? (null === n && this.selectedView[this.tid] <= e && this.selectedView[this.tid] >= t && (n = this.selectedView[this.tid] + 1), o.order = 0 === t ? this.views[0].order / 2 : (this.views[t - 1].order + this.views[t].order) / 2) : t > e && (null === n && this.selectedView[this.tid] >= e && this.selectedView[this.tid] <= t && (n = this.selectedView[this.tid] - 1), t === this.views.length - 1 ? o.order = this.views[this.views.length - 1].order + 10 : o.order = (this.views[t + 1].order + this.views[t].order) / 2),
            null !== n && (this.selectedView[this.tid] = n),
            this.views = util.localeSortBy(this.views, "order"),
            database.saveView(o, (function() {})),
            this.updateTabs(),
            this.popupTabsOpen && this.popupTabs(null, i)
        },
        Gn.prototype.updateTabs = function() {
            this.visible && (null == this.selectedView[this.tid] && 0 !== this.views.length || n.render(a.createElement(mn, {
                onReorder: (e, t) => this.reorderView(e, t),
                isAdmin: database.isAdmin(),
                selectedIndex: this.selectedView[this.tid],
                views: this.views,
                onNewViewClick: () => this.createView(),
                onTabClick: e => this.tabsClicked(e),
                onRemoveView: e => this.removeView(e),
                onRenameView: e => this.renameView(e),
                onEditColumns: e => this.popupColumnMenu(e)
            }), this.$tabs[0]))
        },
        Gn.prototype.updateSwitch = function() {
            var e = this.views[this.selectedView[this.tid]];
            e && e.mode;
            this.showSearch(),
            this.showSmallMenu();
            var t = e && e.searchString || "";
            this.$search.val(t),
            this.$searchText.text(t || locale.searchIn$.replace("$", database.schema.types[this.tid].caption)).css("color", t ? "" : "#676d82"),
            this.$searchCancel.css("display", t ? "" : "none")
        },
        Gn.prototype.showSearch = function() {
            ui.fullWidth - ui.leftWidth <= 510 ? this.$searchContainer.css("width", "162px") : this.$searchContainer.css("width", "236px")
        },
        Gn.prototype.showSmallMenu = function() {
            TOUCH || ui.fullWidth <= 640 ? this.$menuSmall.css("display", "flex") : this.$menuSmall.css("display", "none")
        },
        Gn.prototype.tabsClicked = function(e) {
            var t = this.views[e];
            t && ui.openTable(t.type, t.id)
        },
        Gn.prototype.showView = function() {
            var e = this.views[this.selectedView[this.tid]];
            if (e) {
                var t = e.mode,
                    i = this.renderers[t] ? t : "table";
                this.table.setVisible("table" === i),
                T.each(this.renderers, (function(e) {
                    e.setVisible(i === e.mode)
                })),
                this.updateSwitch()
            }
        },
        Gn.prototype.hideView = function() {
            this.table.hide(),
            T.each(this.renderers, (function(e) {
                e.hide()
            }))
        },
        Gn.prototype.removeView = function(e) {
            if (Object(l.f)("View", "Remove"), console.log("TableView.removeView"), null == e && (e = this.selectedView[this.tid]), null == e)
                return;
            const t = this.views[e];
            if (!t)
                return;
            const i = this.selectedView[this.tid],
                o = this.views[i] ? this.views[i].id : void 0,
                n = e === i ? i - 1 : i,
                s = this.views[n],
                a = s ? s.id : void 0;
            $.loading(!0),
            database.removeView(t.id, () => {
                this.selectedView[this.tid] = n,
                $.loading(!1),
                a === o ? (this.selectedView[this.tid] = e < i ? i - 1 : i, this.viewsChanged()) : ui.openTable(t.type, a)
            })
        },
        Gn.prototype.renameView = function(e) {
            Object(l.f)("View", "Rename");
            var t = this;
            null == e && (e = this.selectedView[this.tid]);
            var i = this.views[e];
            if (i) {
                var o = $.popdown({
                    cls: "small"
                });
                $('<div class="nx-section-head">').text(locale.renameView).appendTo(o.$pane);
                var n = $('<div class="nx-section-pane">').appendTo(o.$pane),
                    s = $('<div class="component editor editor-string" style="width:100%">').appendTo(n);
                $("<label>").text(locale.enterViewName).appendTo(s);
                var a = $('<input type="text">').val(i.caption || "").appendTo($('<div class="stringeditor">').appendTo(s)).keydown((function(e) {
                        13 === e.which && c(),
                        27 === e.which && d()
                    })),
                    r = $('<div class="nx-button-bar">').appendTo(n);
                $('<div class="nx-button-text grey">').text(locale.cancel).appendTo(r).click(d),
                $('<div class="nx-hspace-flex">').appendTo(r),
                $('<div class="nx-button-text blue">').text(locale.rename).appendTo(r).click(c),
                setTimeout((function() {
                    a.focus()
                }), 400)
            }
            function c() {
                var e = a.val().trim();
                e ? (Object(l.f)("View", "RenameConfirm"), d(), i.caption = e, database.saveView(i, (function() {})), t.selectedIndex = t.views.indexOf(i), t.updateTabs(), t.updateSwitch()) : a.focus()
            }
            function d() {
                o.close()
            }
        },
        Gn.prototype.createView = function() {
            if (database.isAdmin()) {
                Object(l.f)("View", "Create");
                var e = this,
                    t = this.tid,
                    i = this.views[this.selectedView[this.tid]];
                i || (i = {
                    type: t,
                    mode: "table",
                    config: {
                        type: t
                    }
                });
                var o = $.popdown({
                    cls: "small"
                });
                $('<div class="nx-section-head">').text(locale.newView).appendTo(o.$pane);
                var n = $('<div class="nx-section-pane">').appendTo(o.$pane),
                    s = $('<div class="component editor editor-string" style="width:100%">').appendTo(n),
                    a = $('<input type="text">').attr("placeholder", locale.enterViewName).appendTo($('<div class="stringeditor">').appendTo(s)).keydown((function(e) {
                        13 === e.which && d(),
                        27 === e.which && h()
                    })),
                    r = i.mode || "table";
                $.switchpane({
                    items: [{
                        id: "table",
                        caption: locale.table,
                        icon: "i-32-24 i-light-grey i-setting-table"
                    }, {
                        id: "full",
                        caption: locale.form,
                        icon: "i-32-24 i-light-grey i-form"
                    }, {
                        id: "chart",
                        caption: locale.chartView,
                        icon: "i-32-24 i-light-grey i-setting-table-chart"
                    }, {
                        id: "cards",
                        caption: locale.cards,
                        icon: "i-32-24 i-light-grey i-home"
                    }, {
                        id: "kanban",
                        caption: locale.kanban,
                        icon: " i-32-24 i-light-grey i-kanban"
                    }, {
                        id: "gantt",
                        caption: locale.gantt,
                        icon: "i-32-24 i-light-grey i-gantt"
                    }, {
                        id: "pivot",
                        caption: "Pivot",
                        icon: "i-32-24 i-light-grey i-setting-table"
                    }],
                    value: r,
                    update: function(e) {
                        r = e,
                        a.focus()
                    }
                }).appendTo(n);
                var c = $('<div class="nx-button-bar">').appendTo(n);
                $('<div class="nx-button-text grey">').text(locale.cancel).appendTo(c).click(h),
                $('<div class="nx-hspace-flex">').appendTo(c),
                $('<div class="nx-button-text blue">').text(locale.okay).appendTo(c).click(d),
                setTimeout((function() {
                    a.focus()
                }), 400)
            }
            function d() {
                Object(l.f)("View", "CreateConfirm", {
                    viewType: r
                });
                var t = a.val().trim();
                t || (t = {
                    table: locale.table,
                    chart: locale.chartView,
                    cards: "Cards",
                    kanban: "Kanban",
                    gantt: "GANTT",
                    calendar: "Calendar",
                    full: locale.form,
                    pivot: "Pivot"
                }[r]),
                h();
                var o = util.getPersistentView(i);
                let n;
                o.id = util.createUUID(16),
                o.mode = r,
                o.caption = t || locale.unnamed;
                const s = e.views[e.views.length - 1].order;
                n = void 0 !== s ? s + 10 : 10 * (e.views.length + 1),
                o.order = n,
                $.loading(!0),
                database.saveView(o, () => {
                    $.loading(!1),
                    e.reloadViews(),
                    ui.openTable(o.type, o.id)
                })
            }
            function h() {
                o.close()
            }
        },
        Gn.prototype.setViewMode = function(e) {
            var t = this.selectedView[this.tid],
                i = this.views[t];
            i && (i.mode = "form" === e ? "table" : e, this.saveView(), this.showView())
        },
        Gn.prototype.getViewCaption = function() {
            var e = this.selectedView[this.tid],
                t = this.views[e];
            if (t)
                return t.caption
        },
        Gn.prototype.getViewProperty = function(e) {
            var t = this.selectedView[this.tid],
                i = this.views[t];
            if (i)
                return i[e]
        },
        Gn.prototype.setViewProperties = function(e) {
            var t = this.selectedView[this.tid],
                i = this.views[t];
            if (i) {
                var o = !1;
                for (var n in e)
                    if (e.hasOwnProperty(n)) {
                        var s = e[n];
                        i[n] !== s && (i[n] = s, o = !0)
                    }
                o && this.saveView()
            }
        },
        Gn.prototype.showPrint = function() {
            Object(l.f)("Table", "PrintView"),
            Object(I.a)(this.table)
        },
        Gn.prototype.popupColumnMenu = function(e) {
            Object(l.f)("Table", "EditColumns"),
            null == e && (e = this.selectedView[this.tid]);
            var t = this,
                i = this.views[e];
            if (i) {
                var o = this.table;
                new Pn.a({
                    hasTop: !0,
                    caption: i.caption,
                    readRoles: i.readRoles,
                    config: o.getConfiguration(),
                    save: function(e) {
                        var n = e.config;
                        i.caption = e.caption,
                        i.readRoles = e.readRoles,
                        i.config = n,
                        database.saveView(i, (function() {})),
                        t.updateTabs(),
                        t.updateSwitch(),
                        o.setConfig(i.config),
                        t.showView(),
                        t.reload()
                    }
                })
            }
        },
        Gn.prototype.popupActions = function() {
            var e = this,
                t = this.tid,
                i = this.table,
                o = $.backplane(),
                n = $('<div class="nx-menu-popup" style="border-radius:4px">').appendTo(o);
            database.isAdminEnabled() && $('<div class="nx-menu-item">').append($('<div class="nx-menu-label">').text(locale.editFields + "...")).touch((function() {
                Object(l.f)("Table", "EditFields"),
                c(),
                new _t({
                    type: t
                })
            })).appendTo(n),
            database.authorizationMassDataUpdate && $('<div class="nx-menu-item">').append($('<div class="nx-menu-label">').text(locale.updateAssistant + "...")).appendTo(n).touch((function() {
                c(),
                new gn(i)
            })),
            database.authorizationImport && $('<div class="nx-menu-item">').append($('<div class="nx-menu-label">').text(locale.importData + "...")).appendTo(n).touch((function() {
                Object(l.f)("Table", "ImportData"),
                c(),
                new Ye({
                    tid: t
                })
            })),
            database.authorizationExport && $('<div class="nx-menu-item">').append($('<div class="nx-menu-label">').text(locale.exportData + "...")).appendTo(n).touch((function() {
                c(),
                Object(l.f)("Table", "ExportData"),
                i.exportData((function(e) {
                    e && $.alert(e)
                }))
            })),
            database.authorizationExport && database.supports.sharing && $('<div class="nx-menu-item">').append($('<div class="nx-menu-label">').text(locale.shareView + "...")).appendTo(n).touch((function() {
                c(),
                e.shareView()
            })),
            database.authorizationPrint && $('<div class="nx-menu-item">').append($('<div class="nx-menu-label">').text(locale.printView)).appendTo(n).touch((function() {
                c(),
                e.showPrint()
            }));
            var s = n.outerWidth(),
                a = n.outerHeight(),
                r = e.$popupActions.offset();
            function c() {
                o.close()
            }
            r.top += 32,
            r.left + s > window.getWidth() && (r.left = window.getWidth() - s),
            r.top + a > window.getHeight() && (r.top = window.getHeight() - a),
            n.offset(r)
        },
        Gn.prototype.saveView = function() {
            if (database.schema.types[this.tid]) {
                var e = this.selectedView[this.tid];
                if (null !== e) {
                    var t = this.views[e];
                    t && (t.config = this.table.getConfiguration(), database.saveView(t, (function() {})))
                }
            }
        },
        Gn.prototype.getNavigationState = function() {
            var e = this.views[this.selectedView[this.tid]],
                t = e ? e.id : void 0;
            return {
                base: "table",
                tid: this.tid,
                vid: t,
                table: this.table.getNavigationState()
            }
        },
        Gn.prototype.setNavigationState = function(e) {
            var t = this;
            console.log("TableView.setNavigationState", e);
            var i = e.tid,
                o = e.nid;
            const n = this.views[this.selectedView[i]];
            if (i !== this.tid) {
                if (this.navigationStateByTid[i] && (void 0 === e.nid || void 0 === e.tabId)) {
                    const e = this.navigationStateByTid[i];
                    console.log("TableView.setNavigationState => new state 1"),
                    be(Xn({}, xe(), {
                        nid: e.nid,
                        tabId: e.tabId
                    }))
                }
            } else if (n) {
                const t = xe(),
                    i = ui.getCurrentEditor();
                if (!(i && i.getSelectedTab() !== t.tabId || this.table.getSelectedNid() !== t.nid && "table" !== n.mode || e.vid !== n.id))
                    return void console.log("TableView.setNavigationState: no change")
            }
            this.selectedView[this.tid];
            var s = e.vid,
                a = e.tab,
                r = e.table || {};
            o && (r.selectionMid0 = o, r.selectionMid1 = o, r.selectionMode = "row"),
            this.tid = i,
            this.navigationStateByTid[i] = {
                nid: o,
                tabId: a
            },
            this.reloadViews();
            var l = 0;
            if ("default" === s)
                l = null != this.selectedView[i] ? this.selectedView[i] : 0;
            else
                for (var c = 0; c < this.views.length; c++) {
                    if (this.views[c].id === s) {
                        l = c;
                        break
                    }
                }
            var d = this.views[l];
            if (d) {
                this.selectedView[i] = d.id,
                s !== d.id && be(Xn({}, xe(), {
                    vid: d.id
                })),
                this.selectedView[i] = l,
                this.updateSwitch(),
                this.table.setConfig(d.config, r),
                this.selectionChanged(),
                this.visible ? this.showView() : this.show(),
                this._reloadId = (this._reloadId || 0) + 1;
                var h = this._reloadId;
                this.reload((function() {
                    if (t.visible && h === t._reloadId && (t.updateTabs(), o && !t.table.groups[o]))
                        if (t.table.models[o]) {
                            for (let e = 0; e < t.table.rows.length; e++)
                                if (t.table.rows[e] === o) {
                                    t.table.scrollToRow(e);
                                    break
                                }
                            if (a) {
                                const e = ui.getCurrentEditor();
                                null != e && e.selectTab(a)
                            }
                        } else
                            be(Xn({}, xe(), {
                                nid: void 0,
                                tab: void 0
                            }))
                }))
            } else
                $.alert("View not found.")
        },
        Gn.prototype.reload = function(e) {
            console.log("TableView.reload");
            $.loading(!0),
            this.table.load((function(t) {
                console.log("TableView.reload: done"),
                $.loading(!1),
                t && console.warn(t),
                e && e()
            }))
        },
        Gn.prototype.loaded = function() {
            T.each(this.renderers, (function(e) {
                e.queryLoaded()
            }))
        },
        Gn.prototype.rowsChanged = function() {
            this.visible && T.each(this.renderers, (function(e) {
                e.rowsChanged()
            }))
        },
        Gn.prototype.popupContextMenu = function(e) {
            var t = this.views[this.selectedView[this.tid]],
                i = t && "chart" !== t.mode || !1;
            this.table && i && this.table.openContextMenu(e)
        },
        Gn.prototype.shareView = function() {
            Object(l.f)("Table", "ShareView");
            var e = this.views[this.selectedView[this.tid]];
            e && ($.loading(!0), database.loadSharedView(e.id, (function(t, i) {
                if ($.loading(!1), t)
                    return $.alert(t);
                var o = !1,
                    n = $.popdown({
                        head: locale.shareView,
                        buttons: [{
                            caption: locale.cancel,
                            cls: "grey",
                            click: function() {
                                m()
                            }
                        }, "-", {
                            caption: locale.okay,
                            cls: "blue",
                            click: function() {
                                if (!o)
                                    return m();
                                f((function(e) {
                                    if (e)
                                        return $.alert(e);
                                    m()
                                }))
                            }
                        }],
                        closable: !1
                    }),
                    s = new util.SimpleModel(new schemas.TBoolean(void 0, void 0, {
                        caption: locale.activateSharing,
                        required: !0,
                        booleanRenderer: "switch",
                        width: 1
                    }));
                s.value = !!i.url,
                s.on("update", (function() {
                    s.value ? f((function(e) {
                        e && $.alert(e)
                    })) : function(t) {
                        $.loading(!0),
                        database.unshareView(e.id, (function(e) {
                            if ($.loading(!1), e)
                                return t(e);
                            i = {},
                            o = !1,
                            u(),
                            t()
                        }))
                    }((function(e) {
                        e && $.alert(e)
                    }))
                }));
                new Ue.a(void 0, s, n.$content);
                var a = new util.SimpleModel(new schemas.TLink(void 0, void 0, {
                    caption: locale.shareURL,
                    width: 3
                }));
                a.isWritable = function() {
                    return !1
                };
                var r = new Ue.a(void 0, a, n.$content),
                    l = new util.SimpleModel(new schemas.TChoice(void 0, void 0, {
                        caption: locale.showAs,
                        width: 4,
                        required: !0,
                        choiceRenderer: "switch",
                        values: {
                            html: {
                                id: "html",
                                caption: "HTML",
                                order: 1
                            },
                            pdf: {
                                id: "pdf",
                                caption: "PDF",
                                order: 2
                            },
                            xlsx: {
                                id: "xlsx",
                                caption: "Excel",
                                order: 3
                            },
                            csv: {
                                id: "csv",
                                caption: "CSV",
                                order: 4
                            },
                            json: {
                                id: "json",
                                caption: "JSON",
                                order: 5
                            }
                        }
                    }));
                l.value = i.options && i.options.contentType || "html",
                l.on("update", (function() {
                    p(),
                    u(),
                    f((function(e) {
                        e && $.alert(e)
                    }))
                }));
                var c = new Ue.a(void 0, l, n.$content),
                    d = $("<div>").appendTo(n.$content),
                    h = new We(Object.assign({}, i.csv, {
                        $container: d,
                        onUpdate: function() {
                            p(),
                            f((function(e) {
                                e && $.alert(e)
                            }))
                        }
                    }));
                function p() {
                    o = !0
                }
                function u() {
                    r.el.css("display", i.url ? "" : "none"),
                    c.el.css("display", i.url ? "" : "none"),
                    d.css("display", i.url && "csv" === l.value ? "" : "none"),
                    a.setValue(i.url || "")
                }
                function f(t) {
                    $.loading(!0),
                    database.shareView(e.id, {
                        contentType: l.value,
                        csv: h.getCSVExportOptions()
                    }, (function(e, n) {
                        if ($.loading(!1), e)
                            return t(e);
                        i = n,
                        o = !1,
                        u(),
                        t()
                    }))
                }
                function m() {
                    n.close((function() {
                        c.destroy(),
                        r.destroy(),
                        h.destroy()
                    }))
                }
                u()
            })))
        },
        Gn.prototype.bodyResized = function() {
            T.each(this.renderers, (function(e) {
                e.bodyResized()
            })),
            this.updateTabs(),
            this.showSearch(),
            this.showSmallMenu()
        },
        Gn.prototype.selectionChanged = function() {
            T.each(this.renderers, (function(e) {
                e.selectionChanged()
            }));
            const e = xe(),
                t = this.table.getSelectedNid();
            t !== e.nid && "form" === this.views[this.selectedView[this.tid]].mode && be(Xn({}, e, {
                nid: t
            }))
        },
        Gn.prototype.searchChanged = function(e) {
            var t = this.$search.val();
            this.$searchText.text(t || locale.searchIn$.replace("$", database.schema.types[this.tid].caption)).css("color", t ? "" : "#676d82"),
            this.$searchCancel.css("display", t ? "" : "none");
            var i = this.views[this.selectedView[this.tid]];
            i && (i.searchString = t),
            t ? this.table.applyFind(t) : this.table.clearFind()
        },
        Gn.prototype.hasLash = function() {
            var e = this.views[this.selectedView[this.tid]];
            return e && ("table" === e.mode || void 0 === e.mode)
        };
        function Qn(e) {
            let t,
                i = void 0,
                o = void 0,
                n = void 0,
                s = e.moduleId;
            switch (e.moduleId) {
            case "default":
                s = "home",
                t = "home";
                break;
            case "home":
            case "calendar":
            case "search":
                t = e.moduleId;
                break;
            default:
                let a = void 0;
                const r = Zn(!0);
                for (const t of r)
                    if (a = t.id === e.moduleId ? t : t.children.find(t => t.id === e.moduleId), a)
                        break;
                void 0 === a ? (s = "default", i = "default") : i = a.id,
                o = e.nid,
                n = e.tabId,
                t = "table"
            }
            return "default" === e.moduleId || "default" === i ? (be(Kn({}, e, {
                moduleId: s,
                vid: "default"
            })), Qn(Kn({}, e, {
                moduleId: s,
                vid: "default"
            }))) : {
                base: t,
                tid: i,
                vid: e.vid,
                nid: o,
                tab: n
            }
        }
        function Zn(e) {
            const t = b.util.localeSortBy(database.schema.types, "order").filter(t => es(t, e)),
                i = [];
            for (const o of t) {
                if (o.master)
                    continue;
                const t = o.getAllChildren().filter(t => es(t, e));
                o.children = b.util.localeSortBy(t, "order"),
                i.push(o)
            }
            return i
        }
        function es(e, t) {
            return database.canRead(e) && (t || !e.hidden) || database.adminMode && database.isAdminEnabled()
        }
        function ts() {
            ls(!0)
        }
        function is({shouldResetWidth: e}) {
            ui.isLeftOpenSaved = !0,
            e ? ns(ui.leftWidth || 180) : ls(),
            as()
        }
        function os() {
            ui.isLeftOpenSaved = !1,
            ls(),
            as()
        }
        function ns(e) {
            e = e < 20 ? 0 : ss(e, 180, 54, 640),
            ui.leftWidthSaved = e,
            ls()
        }
        function ss(e, t, i, o) {
            return e || (e = t), e = "number" != typeof e ? parseInt(e, 10) : Math.round(e), isNaN(e) && (e = t), e < i && (e = i), e > o && (e = o), e
        }
        function as() {
            NinoxDocumentInteraction.setUserDefault("ui.left.width", ui.leftWidthSaved),
            NinoxDocumentInteraction.setUserDefault("ui.right.width", ui.rightWidthSaved),
            NinoxDocumentInteraction.setUserDefault("ui.left.isOpen", ui.isLeftOpenSaved)
        }
        function rs(e) {
            e = ss(e, 672, 128, 2048),
            ui.rightWidthSaved = e,
            ls()
        }
        function ls(e) {
            0 === window.orientation || window.orientation;
            var t = ui.isLeftOpenSaved,
                i = ui.leftWidthSaved,
                o = ui.rightWidthSaved,
                n = window.getWidth(),
                s = n - (i = 0 === i || "0" === i ? 0 : Math.max(54, Math.min(Math.floor(n - 480), Math.floor(n / 3), i))) - (o = Math.max(320, Math.min(n - i, o)));
            ui.fullWidth !== n || ui.leftWidth !== i || ui.rightWidth !== o || ui.bodyWidth !== s || ui.isLeftOpen !== t ? (ui.fullWidth = n, ui.leftWidth = i, ui.rightWidth = o, ui.bodyWidth = s, ui.isLeftOpen = t, cs()) : e && ui.currentView && ui.currentView.bodyResized && ui.currentView.bodyResized(),
            ui.fullWidth <= 640 ? (ui.$foot[0].style.display = "", ui.footHeight = 48 + $.getDevicePadding().bottom) : (ui.$foot[0].style.display = "none", ui.footHeight = 0 + $.getDevicePadding().bottom),
            ui.$foot[0].style.height = ui.footHeight + "px",
            ui.$body[0].style.bottom = ui.footHeight + "px",
            ui.$right[0].style.bottom = ui.footHeight + "px",
            ui.$left[0].style.bottom = ui.footHeight + "px"
        }
        function cs() {
            var e = window.getWidth() <= 640,
                t = ui.isLeftOpen ? ui.leftWidth : 0,
                i = ui.rightVisible ? ui.rightWidth : 0;
            NinoxViewController.setLeftWidth && NinoxViewController.setLeftWidth(t),
            ui.$left[0].style.width = t + "px",
            ui.$body[0].style.left = t + "px",
            ui.$body[0].style.right = i + "px",
            ui.$head[0].style.left = t + "px",
            ui.$headerContainer[0].style.left = t + "px",
            ui.$menu[0].style.left = t + "px",
            ui.$head[0].style.top = ui.topPadding + 48 + "px",
            ui.$headerContainer[0].style.top = ui.topPadding + "px",
            ui.$menu[0].style.top = ui.topPadding + 48 + 8 + "px",
            ui.$menuRight[0].style.top = ui.topPadding + 48 + 8 + "px",
            ui.$left[0].style.top = ui.topPadding + "px",
            ui.$body[0].style.top = ui.topPadding + 48 + 48 + "px",
            e ? (ui.$right[0].style.top = "0", ui.$right[0].style.left = "0", ui.$right[0].style.right = "0", ui.$right[0].style.width = "", ui.$right[0].style.zIndex = 10, ui.rightDivider[0].style.display = "none") : (ui.saveSchemaDialog[0].style.top = ui.topPadding + 6 + "px", ui.$adminContainer[0].style.top = ui.topPadding + 8 + "px", ui.$right[0].style.top = ui.topPadding + 48 + 48 + "px", ui.$right[0].style.width = ui.rightWidth + "px", ui.$right[0].style.left = "", ui.$right[0].style.right = "", ui.$right[0].style.zIndex = "", ui.rightDivider[0].style.display = ""),
            ui.currentView && ui.currentView.bodyResized && ui.currentView.bodyResized(),
            ui.sideEditor && ui.sideEditor.resize(),
            ui.navigation && ui.navigation.resize(),
            ui.recordNavigation && ui.recordNavigation.resize(),
            function() {
                for (var e = ui.sideEditor.opened ? 1 : 0, t = widgets.popupEditorStack, i = t.length + e, o = ui.rightWidth, n = ui.leftWidth, s = ui.fullWidth - n - o, a = 32 * (i - 1), r = s < a ? o - a : o, l = s < a ? 0 : -Math.floor(s / i), c = r + "px", d = ui.footHeight + "px", h = 0; h < t.length; h++)
                    t[h].el[0].style.bottom = d,
                    ui.fullWidth > 640 ? (t[h].el[0].style.width = c, t[h].$backplane.css("z-index", 8), t[h].el[0].style.top = ui.topPadding + 88 + "px") : (t[h].el[0].style.width = ui.fullWidth + "px", t[h].$backplane.css("z-index", 10), t[h].el[0].style.top = ui.topPadding + "px");
                if (e) {
                    var p = l * (i - 1);
                    ui.$right[0].style.transition = "none",
                    ui.$right[0].style.transform = ui.$right[0].style.WebkitTransform = "translateX(" + p + "px)"
                }
                for (h = 0; h < t.length; h++) {
                    p = l * (i - h - 1 - e);
                    t[h].el[0].style.transition = "none",
                    t[h].el[0].style.transform = t[h].el[0].style.WebkitTransform = "translateX(" + p + "px)"
                }
                setTimeout((function() {
                    e && (ui.$right[0].style.transition = "");
                    for (var i = 0; i < t.length; i++)
                        t[i].el[0].style.transition = ""
                }), 0)
            }()
        }
        function ds(e) {
            ui.topPadding = 0 === e ? 0 : e,
            ui.isInitialized && cs()
        }
        function hs(e) {
            ks(e)
        }
        function ps() {
            Object(l.f)("Calendar", "Open"),
            ve(Kn({}, xe(), {
                moduleId: "calendar",
                vid: "default",
                nid: void 0,
                tabId: void 0
            }))
        }
        function us() {
            Object(l.f)("Search", "Open"),
            ve(Kn({}, xe(), {
                moduleId: "search",
                vid: "default",
                nid: void 0,
                tabId: void 0
            }))
        }
        function fs() {
            Object(l.f)("DatabaseHome", "Open"),
            ve(Kn({}, xe(), {
                moduleId: "home",
                vid: "default",
                nid: void 0,
                tabId: void 0
            }))
        }
        function ms(e, t, i, o) {
            Object(l.f)("Table", "Open"),
            ve(Kn({}, xe(), {
                moduleId: e,
                vid: t || "default",
                nid: i,
                tabId: o
            }))
        }
        function gs() {
            Object(l.f)("Table", "Create"),
            new _t({
                afterSaveType: function(e) {}
            })
        }
        function vs(e, t) {
            const i = ys(b.schemas.tidOf(e), t);
            ms(b.schemas.tidOf(e), void 0, e, i)
        }
        function bs(e, t) {
            const i = new Vi.PopupEditor(e),
                o = ys(b.schemas.tidOf(e), t);
            o && i.editor.selectTab(o)
        }
        function ys(e, t) {
            if (!t)
                return;
            const i = database.schema.types[e],
                o = i && i.sorted.find(e => "tab" === e.base && e.caption === t);
            return o && o.id
        }
        function ws() {
            widgets.popupEditorStack.length > 0 ? widgets.popupEditorStack[widgets.popupEditorStack.length - 1].close() : ui.sideEditor && ui.sideEditor.close()
        }
        function xs(e, t, i) {
            const o = new vo(e, t);
            ui.fullscreenStack.push(o);
            const n = ys(b.schemas.tidOf(e), t.tab || i);
            n && o.editor.selectTab(n)
        }
        function Ts() {
            var e = ui.fullscreenStack.pop();
            e && e.close()
        }
        function $s() {
            for (; widgets.popupEditorStack.length > 0;) {
                widgets.popupEditorStack[widgets.popupEditorStack.length - 1].close()
            }
            ui.sideEditor && ui.sideEditor.close()
        }
        function Cs() {
            return ui.currentView && "table" === ui.currentView.base && ui.currentView.renderers && ui.currentView.renderers.full && ui.currentView.renderers.full.visible ? ui.currentView.renderers.full.editor : ui.sideEditor.editor
        }
        function ks(e) {
            if (null !== e) {
                var t;
                if (ui.currentView) {
                    var i = ui.currentView.getNavigationState();
                    !function(e) {
                        switch (e.base) {
                        case "table":
                            ui.navigationStates["table:" + e.tid] = e,
                            ui.navigationStates["table:" + e.tid + ":" + e.vid] = e;
                            break;
                        default:
                            ui.navigationStates[e.base] = e
                        }
                    }(i),
                    (t = Ss(e)).base !== i.base ? (ui.currentView.hide(), ui.currentView = Es(t), ui.currentView.show()) : ui.currentView.setNavigationState(t)
                } else
                    t = Ss(e),
                    ui.currentView = Es(t),
                    ui.currentView.show();
                ui.navigation.updateState(t),
                trackPageView({
                    home: "database"
                }[e.base] || e.base),
                "home" === t.base && "history" === t.vid ? ui.$head.css("display", "") : ui.$head.css("display", {
                    table: 1,
                    calendar: 1,
                    search: 1
                }[t.base] ? "" : "none"),
                ui.currentView && ui.currentView.hasLash && ui.currentView.hasLash() ? ui.rightVisible || Ds() : Ms()
            }
        }
        function Ss(e) {
            switch (e.base) {
            case "table":
                return Object.assign({}, e.tid && e.vid && ui.navigationStates["table:" + e.tid + ":" + e.vid] || e.tid && ui.navigationStates["table:" + e.tid] || {}, e);
            default:
                return Object.assign(ui.navigationStates[e.base] || {}, e)
            }
        }
        function Es(e) {
            const t = ui.views[e.base];
            return null == t && be(Kn({}, xe(), {
                vid: "default"
            })), t.setNavigationState(e), t
        }
        function _s(e) {}
        function Ds() {
            ui.fullWidth > 640 && !TOUCH && (ui.$lashRight.show(), ui.$lashRight[0].style.transform = ui.$lashRight[0].style.WebkitTransform = "translateX(0)")
        }
        function Ms() {
            ui.$lashRight[0].style.transform = ui.$lashRight[0].style.WebkitTransform = "translateX(100%)",
            ui.$lashRight.hide()
        }
        function Ns() {
            Is(),
            ui.rightVisible || (Ms(), ui.rightVisible = !0, ui.$right[0].style.display = "", ui.rightAnimationTimeout = setTimeout((function() {
                ui.$right[0].style.transform = ui.$right[0].style.WebkitTransform = "translateX(0px)",
                ui.rightAnimationTimeout = setTimeout((function() {
                    cs()
                }), 400)
            }), 0))
        }
        function Is() {
            ui.rightAnimationTimeout && (clearTimeout(ui.rightAnimationTimeout), ui.rightAnimationTimeout = void 0),
            ui.rightHidingCallback && (ui.rightHidingCallback(), ui.rightHidingCallback = void 0)
        }
        function Os(e) {
            Is(),
            ui.rightVisible ? (ui.rightVisible = !1, ui.$right[0].style.transform = ui.$right[0].style.WebkitTransform = "translateX(100%)", cs(), ui.rightHidingCallback = e, ui.rightAnimationTimeout = setTimeout((function() {
                ui.rightHidingTimeout = void 0,
                ui.rightHidingCallback = void 0,
                ui.$right[0].style.display = "none",
                e && e()
            }), 400), Ds()) : e && e()
        }
        function Rs(e) {
            if (n.unmountComponentAtNode(ui.leftDivider[0]), n.unmountComponentAtNode(ui.rightDivider[0]), !ui.isInitialized)
                return e();
            window.removeEventListener("popstate", _s, !1),
            ui.views.home.destroy(),
            ui.views.calendar.destroy(),
            ui.views.search.destroy(),
            ui.views.table.destroy(),
            ui.views = {},
            ui.currentView = void 0,
            ui.rightDivider = void 0,
            ui.leftDivider = void 0,
            ui.$head = void 0,
            ui.$left = void 0,
            ui.$right = void 0,
            ui.$body = void 0,
            ui.$foot = void 0,
            ui.$header = void 0,
            ui.$menu = void 0,
            ui.$menuCenter = void 0,
            ui.$menuRight = void 0,
            ui.setIsInitialized(!1),
            ui.rightVisible = !1,
            ui.currentView = void 0,
            ui.$overlays = void 0,
            ui.$tableContextMenuContainer = void 0,
            ui.navigationStates = {},
            ui.undoManager = void 0,
            $(document.body).empty(),
            window.removeEventListener("resize", ts),
            dbms.closeDatabase(e)
        }
        function js(e) {
            ui.currentView && ui.currentView.updateBackground && ui.currentView.updateBackground(e)
        }
        function Ls() {
            ui.isInitialized && (ui.setIsInitialized(!1), window.removeEventListener("resize", ts))
        }
        function Fs() {
            Ls();
            const e = database.account.id;
            dbms.closeDatabase((function() {
                ve({
                    teamId: e
                }),
                ui.destroy(() => {}),
                window.location.reload()
            }))
        }
        function As(e) {
            Ls(),
            ui.destroy(() => e())
        }
        function Hs() {
            !function() {
                ui.leftDivider = $('<div class="hud-left-divider">').appendTo(ui.$left),
                TOUCH ? ui.leftDivider[0].addEventListener(EVENT_touchstart, n) : ui.leftDivider[0].addEventListener("mousedown", n);
                var e = 0,
                    t = 0,
                    i = 0,
                    o = !1;
                function n(n) {
                    if (TOUCH) {
                        if (1 !== n.touches.length)
                            return;
                        e = n.touches[0].clientX,
                        t = n.touches[0].clientY,
                        EVENT_target(n).addEventListener(EVENT_touchmove, s),
                        EVENT_target(n).addEventListener(EVENT_touchend, a),
                        EVENT_target(n).addEventListener("touchcancel", a)
                    } else
                        e = n.clientX,
                        t = n.clientY,
                        window.addEventListener("mousemove", s),
                        window.addEventListener("mouseup", a);
                    o = !1,
                    i = ui.leftWidth,
                    ui.leftDivider.addClass("selected"),
                    !1 !== n.cancelable && n.preventDefault()
                }
                function s(n) {
                    var s,
                        a;
                    if (TOUCH) {
                        if (1 !== n.touches.length)
                            return;
                        s = n.touches[0].clientX,
                        a = n.touches[0].clientY
                    } else
                        s = n.clientX,
                        a = n.clientY;
                    var r = s - e,
                        l = a - t;
                    o || r * r + l * l > 4 && (o = !0),
                    o && ns(i + r),
                    n.preventDefault()
                }
                function a(e) {
                    if (TOUCH) {
                        if (0 !== e.touches.length)
                            return;
                        EVENT_target(e).removeEventListener(EVENT_touchmove, s),
                        EVENT_target(e).removeEventListener(EVENT_touchend, a),
                        EVENT_target(e).removeEventListener("touchcancel", a)
                    } else
                        window.removeEventListener("mousemove", s),
                        window.removeEventListener("mouseup", a);
                    ui.leftDivider.removeClass("selected"),
                    as(),
                    e.preventDefault()
                }
            }(),
            function() {
                ui.rightDivider = $('<div class="hud-right-divider">').appendTo(ui.$right),
                TOUCH ? ui.rightDivider[0].addEventListener(EVENT_touchstart, o) : ui.rightDivider[0].addEventListener("mousedown", o);
                var e = 0,
                    t = 0,
                    i = 0;
                function o(o) {
                    var a = Date.now();
                    if (Math.abs(a - i) < 1e3)
                        rs(672),
                        as();
                    else {
                        if (i = Date.now(), TOUCH) {
                            if (1 !== o.touches.length)
                                return;
                            e = o.touches[0].clientX,
                            EVENT_target(o).addEventListener(EVENT_touchmove, n),
                            EVENT_target(o).addEventListener(EVENT_touchend, s),
                            EVENT_target(o).addEventListener("touchcancel", s)
                        } else
                            e = o.clientX,
                            window.addEventListener("mousemove", n),
                            window.addEventListener("mouseup", s);
                        t = ui.rightWidth,
                        ui.rightDivider.addClass("selected")
                    }
                    o.preventDefault()
                }
                function n(i) {
                    var o;
                    if (TOUCH) {
                        if (1 !== i.touches.length)
                            return;
                        o = i.touches[0].clientX
                    } else
                        o = i.clientX;
                    rs(t + (e - o)),
                    i.preventDefault()
                }
                function s(e) {
                    if (TOUCH) {
                        if (0 !== e.touches.length)
                            return;
                        EVENT_target(e).removeEventListener(EVENT_touchmove, n),
                        EVENT_target(e).removeEventListener(EVENT_touchend, s),
                        EVENT_target(e).removeEventListener("touchcancel", s)
                    } else
                        window.removeEventListener("mousemove", n),
                        window.removeEventListener("mouseup", s);
                    ui.rightDivider.removeClass("selected"),
                    as(),
                    e.preventDefault()
                }
            }(),
            Ps()
        }
        function Ps() {
            n.render(a.createElement(Se, {
                adminMode: database.adminMode
            }), ui.rightDivider[0]),
            n.render(a.createElement(Se, {
                adminMode: database.adminMode
            }), ui.leftDivider[0])
        }
        function Us() {
            if (ui.isInitialized)
                return;
            ui.setIsInitialized(!0),
            function() {
                const e = e => {
                    window.database && (e.teamId !== database.account.id || e.dbId !== database.id ? dbms.closeDatabase((function() {
                        window.location.reload()
                    })) : ks(Qn(e)))
                };
                Te("tab", e, null),
                Te("view", e, null),
                Te("team", e => {
                    window.database && dbms.closeDatabase((function() {
                        window.location.reload()
                    }))
                }, null)
            }(),
            window.addEventListener("popstate", _s, !1);
            const e = Object(c.d)("settings") || {},
                t = e.windowTitle ? e.windowTitle + " - " : "";
            NinoxDocumentInteraction.setWindowTitle(t + database.name + (database.accountName ? " | " + database.accountName : "")),
            ui.currentView = void 0,
            ui.navigationStates = {},
            ui.updateBackground(),
            ui.$left = $('<div class="hud-left">').appendTo($(document.body)),
            ui.$body = $('<div class="hud-body">').appendTo($(document.body)),
            ui.$foot = $('<div class="hud-foot" style="display:none;">').appendTo($(document.body)),
            ui.$right = $('<div class="hud-right" style="transform:translateX(100%);-webkit-transform:translateX(100%)">').hide().appendTo($(document.body)),
            ui.$lashRight = $('<div class="hud-right-lash"><div class="i-40-24 i-white i-line-left"/>').touch(() => ui.currentView.table.selectLastRow()).hide().appendTo($(document.body)),
            Ds(),
            $('<div class="hud-right-border">').appendTo(ui.$right),
            ui.$head = $('<div class="hud-title">').appendTo($(document.body)),
            ui.$overlays = $('<div style="z-index: 10">').appendTo($(document.body)),
            ui.$tableContextMenuContainer = $("<div>").appendTo($(document.body)),
            ui.$menu = $('<div class="hud-menu">').appendTo($(document.body)),
            ui.$menuCenter = $('<div class="hud-menu-center">').appendTo(ui.$menu),
            $('<div class="nx-hspace-flex">').appendTo(ui.$menu),
            ui.$menuRight = $('<div class="hud-menu-right">').appendTo($(document.body)),
            ui.$headerContainer = $('<div class="header">').appendTo($(document.body)),
            ui.navigation = new Ae,
            ui.$header = $('<div class="header-body">').appendTo(ui.$headerContainer),
            $('<div class="header-admin-placeholder">').appendTo(ui.$header),
            ui.$adminContainer = $('<div class="header-admin-container">').appendTo($(document.body)),
            new rn(ui.$adminContainer),
            database.adminEnabled && database.isAdmin() && new mt(ui.$adminContainer),
            function() {
                var e = NinoxDocumentInteraction.getUserDefault("ui.left.width");
                ui.leftWidthSaved = 0 === e || "0" === e ? 0 : ss(e, 180, 54, 640);
                var t = NinoxDocumentInteraction.getUserDefault("ui.left.isOpen");
                ui.isLeftOpenSaved = !("false" === t || !1 === t);
                var i = NinoxDocumentInteraction.getUserDefault("ui.right.width");
                ui.rightWidthSaved = ss(i, 672, 128, 2048)
            }(),
            ui.rightVisible = !1,
            Hs(),
            database.on("admin", void 0, Ws),
            ui.undoManager = new Ee,
            window.performUndo = function(e) {
                ui.undoManager && ui.undoManager.performUndo(e, (function() {}))
            },
            window.performRedo = function(e) {
                ui.undoManager && ui.undoManager.performUndo(e, (function() {}))
            },
            ui.recordNavigation = new He,
            ui.sideEditor = new fi,
            ui.saveSchemaDialog = $('<div class="admin-saveschema">').hide().appendTo($(document.body)),
            $('<div class="nx-button-text red admin-saveschema-button" style="margin-right: 2px;">').append($('<div class="i-24-16 i-red i-close admin-saveschema-icon">')).append($("<span>").text(locale.resetSchema)).appendTo(ui.saveSchemaDialog).touch((function() {
                $.loading(!0),
                database.resetSchema((function() {
                    Object(l.f)("Database", "RevertChanges"),
                    $.loading(!1),
                    ui.saveSchemaDialog.hide()
                }))
            })),
            $('<div class="nx-button-text blue --ul-save-schema-button admin-saveschema-button">').append($('<div class="i-24-16 i-white i-check admin-saveschema-icon">')).append($("<span>").text(locale.saveSchema)).appendTo(ui.saveSchemaDialog).touch((function() {
                $.loading(!0),
                ui.trigger("saveSchema"),
                database.saveSchema((function() {
                    Object(l.f)("Database", "SaveChanges"),
                    $.loading(!1),
                    ui.saveSchemaDialog.hide()
                }))
            })),
            database.on("schema", void 0, Vs),
            T.isEmpty(database.schema.types) && database.adminEnabled && database.setAdminMode(!0),
            ls(),
            ui.navigation.initialResize(),
            window.addEventListener("resize", ts),
            ui.views = {},
            ui.views.home = new eo,
            ui.views.calendar = new uo,
            ui.views.search = new go,
            ui.views.table = new Gn,
            wo(),
            window.Appcues && window.Appcues.page();
            const i = xe();
            i.moduleId && ks(Qn(i)),
            Object(c.c)(database.schema.afterOpen)
        }
        function zs(e) {
            ui.navigation && ui.navigation.setCloudSyncState(e)
        }
        function Vs(e, t, i) {
            !0 === t ? ui.saveSchemaDialog.show() : !1 === t && ui.saveSchemaDialog.hide()
        }
        function Ws() {
            Ps()
        }
        function Bs() {
            $.dialog({
                closable: !0,
                caption: locale.dropDatabase,
                message: locale.confirmDropDatabase,
                buttons: [{
                    color: "red",
                    caption: locale.dropDatabase,
                    callback: function() {
                        var e = database.descriptor();
                        Rs((function() {
                            root.removeDatabase(e, (function(e) {
                                e && alert(e),
                                be({
                                    teamId: xe().teamId
                                }),
                                window.location.reload()
                            }))
                        }))
                    }
                }]
            })
        }
        function qs(e) {
            database.saveEverything((function() {
                var t = database.descriptor();
                root.saveDatabaseArchiveAs(t, e)
            }))
        }
        function Ys() {
            database.saveEverything((function() {
                var e = database.descriptor();
                root.duplicateDatabase(e, (function(e, t) {
                    !e && t && (ve(Kn({}, xe(), {
                        dbId: t.id
                    })), window.location.reload())
                }))
            }))
        }
        function Xs() {
            database.saveEverything((function() {
                var e = database.descriptor();
                root.renameDatabase(e, (function(e, t) {
                    !e && t && (be(Kn({}, xe(), {
                        dbId: t.id
                    })), window.location.reload())
                }))
            }))
        }
        function Gs() {
            database.saveEverything((function() {
                var e = database.descriptor();
                Rs((function() {
                    root.evictDatabase(e, (function(e) {
                        window.location.reload()
                    }))
                }))
            }))
        }
        function Js() {
            database.saveEverything((function() {
                var e = database.descriptor();
                Rs((function() {
                    root.reorganizeDatabase(e, (function(e, t) {
                        !e && t ? (ve(Kn({}, xe(), {
                            dbId: t.id
                        })), window.location.reload()) : window.location.reload()
                    }))
                }))
            }))
        }
        function Ks() {
            ui.isInitialized ? database.saveEverything((function() {
                root.createDatabase()
            })) : root.createDatabase()
        }
        function Qs() {
            ui.isInitialized ? database.saveEverything((function() {
                root.importArchive()
            })) : root.importArchive()
        }
        function Zs(e, t, i, o) {
            i.base;
            this.parent = e,
            this.field = i,
            this.filter = o,
            this.silent = !1,
            this.el = $('<div style="margin:-8px">').appendTo(t),
            this.fromModel = new util.SimpleModel(new schemas.TTime(void 0, void 0, {
                caption: locale.fromDate,
                formWidth: .5
            })),
            this.fromModel.on("update", this.filtersChanged, this),
            this.fromField = new Ue.a(void 0, this.fromModel, this.el),
            this.toModel = new util.SimpleModel(new schemas.TTime(void 0, void 0, {
                caption: locale.toDate,
                formWidth: .5
            })),
            this.toModel.on("update", this.filtersChanged, this),
            this.toField = new Ue.a(void 0, this.toModel, this.el),
            this.updateUI()
        }
        function ea(e, t, i, o) {
            this.parent = e,
            this.value = o,
            this.field = i,
            this.el = $('<div class="stringeditor">').appendTo(t).touch($.proxy(this.popup, this)),
            this.text = $('<div class="input-text">').appendTo(this.el),
            $('<div class="choice-dropdown">').appendTo(this.el),
            this.updateUI()
        }
        function ta(e, t, i, o, n) {
            this.table = e,
            this.fid = t,
            this.nid = i,
            this.c = o,
            this.r = n,
            this.isEditing = !1,
            this.$input = void 0,
            this.val = void 0,
            this.str = void 0,
            this.stringMultiline = !1
        }
        function ia(e, t, i, o, n) {
            tables.editors.string.apply(this, arguments),
            this.$aux = void 0,
            this.orderedValues = [],
            this.visibleValues = [],
            this.selectedValueId = void 0,
            this.filterString = "",
            this.currentString = "",
            this.nid = i
        }
        function oa(e, t) {
            for (var i = 0; i < e.length; i++) {
                if (e[i].id === t)
                    return i
            }
            return -1
        }
        function na(e, t, i, o) {
            this.parent = e,
            this.field = i,
            this.filter = o,
            t.addClass("editor-choice"),
            this.el = $('<div class="stringeditor">').appendTo(t).touch($.proxy(this.popup, this)),
            this.text = $('<div class="input-text multicombo">').appendTo(this.el),
            $('<div class="choice-dropdown">').appendTo(this.el),
            this.updateUI()
        }
        function sa(e, t) {
            return "multi" === e.base || "dmulti" === e.base ? function(e, t) {
                var i = {},
                    o = /^\s*\>\s*\[\s*((?:[0-9]+(?:\s*\,\s*[0-9]+)*)?)\s*\]$/.exec(t);
                if (o)
                    for (var n = o[1].split(","), s = 0; s < n.length; s++)
                        i[parseInt(n[s].trim())] = !0;
                return i
            }(0, t) : function(e, t) {
                var i = {};
                if (t)
                    for (var o = t.split(" or "), n = 0; n < o.length; n++) {
                        var s = /=\s*(?:([0-9]+|true|false|null)|\"([a-zA-Z0-9\.\_\-]+)\")/.exec(o[n]);
                        s && (i[null != s[1] ? s[1] : s[2]] = !0)
                    }
                return i
            }(0, t)
        }
        function aa(e) {
            return /^[0-9]+|true|false|null$/.test(e) ? String(e) : '"' + String(e) + '"'
        }
        function ra(e, t, i, o) {
            var n = this,
                s = i.base;
            this.parent = e,
            this.field = i,
            this.filter = o,
            this.silent = !1,
            this.el = $('<div style="margin:-8px">').appendTo(t);
            var a = $('<div class="switch">').appendTo(this.el);
            this.$switchRange = $('<div class="switch-item selected">').text(locale.filter).appendTo(a).touch((function() {
                "range" !== util.getFilterDateRange(n.filter).mode && n.updateModel("")
            })),
            this.$switchEmpty = $('<div class="switch-item">').text(locale.empty).appendTo(a).touch((function() {
                "empty" !== util.getFilterDateRange(n.filter).mode ? n.updateModel("=null") : n.updateModel(null)
            })),
            this.$switchNotEmpty = $('<div class="switch-item">').text(locale.notEmpty).appendTo(a).touch((function() {
                "not-empty" !== util.getFilterDateRange(n.filter).mode ? n.updateModel("!=null") : n.updateModel(null)
            })),
            this.$range = $("<div>").appendTo(this.el),
            this.fromModel = "date" === s ? new util.SimpleModel(new schemas.TDate(void 0, void 0, {
                caption: locale.fromDate,
                formWidth: .5
            })) : "datx" === s ? new util.SimpleModel(new schemas.TDatx(void 0, void 0, {
                caption: locale.fromDate,
                formWidth: .5
            })) : new util.SimpleModel(new schemas.TTimestamp(void 0, void 0, {
                caption: locale.fromDate,
                formWidth: .5
            })),
            this.fromModel.on("update", this.filtersChanged, this),
            this.fromField = new Ue.a(void 0, this.fromModel, this.$range),
            this.toModel = "date" === s ? new util.SimpleModel(new schemas.TDate(void 0, void 0, {
                caption: locale.toDate,
                formWidth: .5
            })) : "datx" === s ? new util.SimpleModel(new schemas.TDatx(void 0, void 0, {
                caption: locale.toDate,
                formWidth: .5
            })) : new util.SimpleModel(new schemas.TTimestamp(void 0, void 0, {
                caption: locale.toDate,
                formWidth: .5
            })),
            this.toModel.on("update", this.filtersChanged, this),
            this.toField = new Ue.a(void 0, this.toModel, this.$range),
            this.updateUI()
        }
        function la(e, t, i, o) {
            this.parent = e,
            this.parentEl = t,
            this.value = o,
            this.el = $('<div class="stringeditor">').appendTo(t),
            this.input = $('<input type="text" tabindex="-1" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">').attr("placeholder", locale.filter).appendTo(this.el).val(this.value || "").change($.proxy(this.updateModel, this)),
            this.button = $('<div class="stringeditor-button"><div class="icon-big-black icon-big-close2"></div></div>').appendTo(this.el).touch($.proxy(this.clear, this)),
            this.updateUI()
        }
        function ca(e, t, i, o, n) {
            var s = e.type.fields[t];
            return new (tables.editors[s.base] || tables.editors.string)(e, t, i, o, n)
        }
        function da(e, t, i, o) {
            switch (i.base) {
            case "boolean":
                return new ea(e, t, i, o);
            case "user":
            case "choice":
            case "multi":
            case "dchoice":
            case "dmulti":
                return new na(e, t, i, o);
            case "date":
            case "datx":
            case "timestamp":
            case "appointment":
                return new ra(e, t, i, o);
            case "time":
                return new Zs(e, t, i, o);
            case "number":
            case "string":
            default:
                return new la(e, t, i, o)
            }
        }
        function ha(e, t) {
            var i = {
                sum: "Σ",
                first: "⤒",
                last: "⤓",
                avg: "Ø",
                cnt: "#",
                min: "⬇",
                max: "⬆"
            }[e];
            return (i ? '<span class="table-summary-agg">' + i + "</span> " : "") + "<span>" + htmlEscape(t) + "</span>"
        }
        if (Zs.prototype.destroy = function() {
            this.fromField.destroy(),
            this.toField.destroy(),
            this.el.remove(),
            this.menu.remove()
        }, Zs.prototype.updateModel = function(e) {
            this.filter = e,
            this.updateUI(),
            this.parent.updateFilter(!1)
        }, Zs.prototype.filtersChanged = function() {
            if (!this.silent) {
                this.field.base;
                var e = this.fromModel.value,
                    t = this.toModel.value;
                if (null != e && null != t && t < e) {
                    var i = e;
                    e = t,
                    t = i
                }
                this.updateModel(util.getTimeRangeFilter({
                    from: e,
                    to: t
                }))
            }
        }, Zs.prototype.updateUI = function() {
            this.field.base;
            var e = this.filter,
                t = util.getFilterTimeRange(e) || {},
                i = t.from,
                o = t.to;
            this.silent = !0,
            this.fromModel.setValue(i),
            this.toModel.setValue(o),
            this.silent = !1
        }, Zs.prototype.setFilter = function(e) {
            this.filter = e,
            this.updateUI()
        }, Zs.prototype.getFilter = function() {
            return this.filter
        }, Zs.prototype.show = function() {
            this.el.show()
        }, Zs.prototype.hide = function() {
            this.el.hide()
        }, ea.prototype.destroy = function() {
            this.el.remove()
        }, ea.prototype.updateModel = function(e) {
            this.value = e,
            this.updateUI(),
            this.parent.updateFilter(!0)
        }, ea.prototype.updateUI = function() {
            var e = this.value,
                t = "";
            t = e ? /^\s*\=\s*null\s*$/.test(e) ? "<span>" + htmlEscape(locale.empty) + "</span>" : /^\s*\!\=\s*null\s*$/.test(e) ? "<span>" + htmlEscape(locale.notEmpty) + "</span>" : /^\s*\=\s*true\s*$/.test(e) ? "<span>" + htmlEscape(locale.yes) + "</span>" : /^\s*\=\s*false\s*$/.test(e) ? "<span>" + htmlEscape(locale.no) + "</span>" : '<span color="#f00">' + htmlEscape(e) + "</span>" : '<span style="color:#999">' + htmlEscape(locale.filter) + "</span>",
            this.text.html(t)
        }, ea.prototype.setFilter = function(e) {
            this.value = e,
            this.updateUI()
        }, ea.prototype.show = function() {
            this.el.show()
        }, ea.prototype.hide = function() {
            this.el.hide()
        }, ea.prototype.getFilter = function() {
            return this.value
        }, ea.prototype.popup = function() {
            var e = this,
                t = this.value,
                i = $.backplane({}),
                o = $('<div class="choice-menu">').css({
                    "min-width": this.el.width()
                }).appendTo(i),
                n = $('<div class="choice-menu-head">').appendTo(o);
            $('<div class="choice-menu-item"><div class="choice-label">' + locale.all + "</div></div>").click((function() {
                e.updateModel(void 0),
                i.close()
            })).appendTo(n),
            $('<div class="choice-menu-item"><div class="choice-label">' + locale.empty + "</div></div>").touch((function() {
                i.close(),
                e.updateModel("=null")
            })).appendTo(n),
            $('<div class="choice-menu-item"><div class="choice-label">' + locale.notEmpty + "</div></div>").touch((function() {
                i.close(),
                e.updateModel("!=null")
            })).appendTo(n),
            $('<div class="choice-menu-item"><div class="choice-indicator' + ("=true" === t ? " selected" : "") + '"></div><div class="choice-symbol"></div><div class="choice-label">' + locale.yes + "</div></div>").click((function() {
                e.updateModel("=true"),
                i.close()
            })).appendTo(o),
            $('<div class="choice-menu-item"><div class="choice-indicator' + ("=false" === t ? " selected" : "") + '"></div><div class="choice-symbol"></div><div class="choice-label">' + locale.no + "</div></div>").click((function() {
                e.updateModel("=false"),
                i.close()
            })).appendTo(o);
            var s = o.outerWidth(),
                a = o.outerHeight(),
                r = this.el.offset();
            r.top += 32,
            r.left + s > window.getWidth() && (r.left = window.getWidth() - s),
            r.top + a > window.getHeight() && (r.top = window.getHeight() - a),
            o.offset(r)
        }, ta.prototype.showAux = function() {}, ta.prototype.hideAux = function() {}, ta.prototype.updateAux = function() {}, ta.prototype.keyupCallback = function() {}, ta.prototype.keydownCallback = function() {}, ta.prototype.destroy = function() {
            this.stopEdit(!1)
        }, ta.prototype.getNid = function() {
            return this.nid
        }, ta.prototype.isCell = function(e, t) {
            return this.c === e && this.r === t
        }, ta.prototype.getRow = function() {
            return this.r
        }, ta.prototype.getColumn = function() {
            return this.c
        }, ta.prototype.keydown = function(e) {
            if (!1 !== this.keydownCallback(e)) {
                var t = this.table,
                    i = this.stringMultiline;
                switch (e.which) {
                case 9:
                    e.shiftKey ? (t.stopEdit(!0), t.editorPrev()) : (t.stopEdit(!0), t.editorNext()),
                    e.preventDefault();
                    break;
                case 13:
                    i || (e.shiftKey ? t.editorInsert("down") : (t.stopEdit(!0), t.editorDown()), e.preventDefault());
                    break;
                case 27:
                    t.stopEdit(!1),
                    e.preventDefault()
                }
            }
        }, ta.prototype.keyup = function(e) {
            this.keyupCallback(e)
        }, ta.prototype.blur = function(e) {
            this.isEditing && this.table.stopEdit()
        }, ta.prototype.startEdit = function() {
            if (!this.isEditing && this.isWritable()) {
                var e = this.table,
                    t = this.nid,
                    i = this.fid,
                    o = e.type.fields[i];
                if (o) {
                    var n = database.loadNodeSync(t);
                    n && (this.val = n[i], this.str = o.formatEditor(this.val), this.isEditing = !0, o.stringMultiline ? (this.$input = $EL("textarea", "t-editor-textarea", e.$view), this.stringMultiline = !0) : (o.base, this.$input = $EL("input", "t-editor-input", e.$view, {
                        type: "text",
                        autocomplete: "off",
                        autocorrect: "off",
                        spellcheck: "false"
                    }), this.stringMultiline = !1), this.$input.addEventListener("keydown", $.proxy(this.keydown, this), !1), this.$input.addEventListener("keyup", $.proxy(this.keyup, this), !1), this.$input.addEventListener("blur", $.proxy(this.blur, this), !1), this.update(), this.$input.value = this.str, this.$input.focus(), this.$input.select(), this.showAux())
                }
            }
        }, ta.prototype.isWritable = function() {
            return database.canWriteNodeField(this.nid, this.fid)
        }, ta.prototype.stopEdit = function(e) {
            if (this.isEditing) {
                this.isEditing = !1,
                this.hideAux();
                var t = this.$input;
                this.$input = void 0;
                var i = t.value;
                if ($REMOVE(t), e && i !== this.str) {
                    var o = this.table,
                        n = (this.nid, this.fid),
                        s = o.type.fields[n];
                    if (!s)
                        return;
                    var a = s.parseEditor(i);
                    this.str = i,
                    this.val = a,
                    this.saveValue(a, (function(e) {
                        e && $.alert(e)
                    }))
                }
            }
        }, ta.prototype.saveValue = function(e, t) {
            database.update(this.nid, this.fid, e, t)
        }, ta.prototype.update = function() {
            if (this.isEditing) {
                var e = this.c,
                    t = this.r,
                    i = this.table,
                    o = this.$input;
                o.style.left = i.colX(e, e) - 1 + "px",
                o.style.top = i.rowY(t, t) + "px",
                o.style.width = i.colW(e, e) + 2 + "px",
                o.style.height = i.rowH(t, t) + "px",
                this.updateAux()
            }
        }, Object.assign(ia.prototype, ta.prototype), ia.prototype.showAux = function() {
            if (!this.$aux) {
                var e = this,
                    t = this.table.type.fields[this.fid];
                t.loadValuesSorted(this.getNid(), e => {
                    this.selectedValueId = null == this.val ? "###NULL###" : this.val,
                    this.orderedValues = e,
                    this.filterString = "",
                    this.currentString = this.$input.value || "",
                    this.visibleValues = [],
                    this.$aux = $('<div class="choice-menu" style="min-width:' + this.$input.clientWidth + 'px;overflow:auto;z-index:12">').appendTo($(document.body)).on(TOUCH ? EVENT_touchstart : "mousedown", (function(e) {
                        var o = $(e.target).closest(".choice-menu-item").attr("data-id");
                        null != o && i("###NULL###" === o ? null : t.convert(o))
                    })),
                    this.updateAux()
                })
            }
            function i(t) {
                e.saveValue(t, (function(t) {
                    e.table.stopEdit(!1)
                }))
            }
        }, ia.prototype.hideAux = function() {
            this.$aux && (this.$aux.remove(), this.$aux = null, this.orderedValues = [], this.visibleValues = [], this.selectedValueId = void 0)
        }, ia.prototype.updateAux = function() {
            var e = this,
                t = this.$aux,
                i = this.table.type.fields[this.fid];
            if (t) {
                var o = 0,
                    n = "",
                    s = this.filterString,
                    a = !s,
                    r = this.selectedValueId,
                    l = this.visibleValues = [];
                if (!i.required && a)
                    l.push({
                        id: "###NULL###",
                        caption: ""
                    }),
                    n += '<div class="choice-menu-item" data-id="###NULL###"><div class="choice-indicator' + ("###NULL###" === r ? " selected" : "") + '"></div><div class="choice-label">' + htmlEscape(locale.empty) + "</div></div>",
                    o++;
                T.each(this.orderedValues, (function(e) {
                    if (a || 0 === (e.caption || "").toLocaleLowerCase().indexOf(s)) {
                        l.push(e);
                        var t = e.id === r;
                        n += '<div data-id="' + e.id + '" class="choice-menu-item" style="' + (e.color ? "background-color:" + e.color + ";color:" + e.textColor : "") + '"><div class="choice-indicator' + (t ? " selected" : "") + '"></div><div class="multicombo-item" style="background-color:transparent;color:' + e.textColor + '">' + (e.icon ? '<div class="choice-symbol ic ic-' + e.icon + '"></div>' : "") + "<span>" + htmlEscape(e.caption || "") + "</span></div></div>",
                        o++
                    }
                })),
                t.html(n),
                function() {
                    var i = $(e.$input).offset(),
                        n = window.getWidth(),
                        s = window.getHeight(),
                        a = i.left,
                        r = i.top + 36,
                        l = t.outerWidth(),
                        c = 32 * o;
                    c > s - r && (s - r >= i.top - 4 ? c = s - r : (c = Math.min(i.top - 4, c), r = i.top - 4 - c));
                    a + l > n && (a = n - l);
                    t.css({
                        left: a,
                        top: r,
                        height: c
                    });
                    var d = t.children(".selected");
                    if (d.length) {
                        var h = d.offset().top,
                            p = h + 32;
                        h < r ? t.scrollTop(t.scrollTop() + h - r) : p > r + c && t.scrollTop(t.scrollTop() + p - r - c)
                    }
                }()
            }
        }, ia.prototype.keyupCallback = function(e) {
            switch (e.which) {
            case 38:
            case 40:
                return e.preventDefault(), e.stopPropagation(), this.updateAux(), !1;
            default:
                var t = this.$input.value || "";
                return t !== this.currentString && (this.filterString = t.toLocaleLowerCase(), this.currentString = t, this.updateAux()), !0
            }
        }, ia.prototype.keydownCallback = function(e) {
            switch (e.which) {
            case 38:
                if ((i = this.visibleValues) && i.length) {
                    if (-1 === (o = oa(i, this.selectedValueId))) {
                        var t = i[i.length - 1];
                        this.selectedValueId = t.id,
                        this.$input.value = t.caption
                    } else if (o > 0) {
                        t = i[o - 1];
                        this.selectedValueId = t.id,
                        this.$input.value = t.caption
                    }
                } else
                    this.selectedValueId = void 0;
                return this.updateAux(), e.preventDefault(), e.stopPropagation(), !1;
            case 40:
                var i,
                    o;
                if ((i = this.visibleValues) && i.length) {
                    if (-1 === (o = oa(i, this.selectedValueId))) {
                        t = i[0];
                        this.selectedValueId = t.id,
                        this.$input.value = t.caption
                    } else if (o < i.length - 1) {
                        t = i[o + 1];
                        this.selectedValueId = t.id,
                        this.$input.value = t.caption
                    }
                } else
                    this.selectedValueId = void 0;
                return this.updateAux(), e.preventDefault(), e.stopPropagation(), !1
            }
        }, na.prototype.destroy = function() {
            this.el.remove()
        }, na.prototype.updateModel = function(e, t) {
            this.filter = e,
            this.updateUI(),
            this.parent.updateFilter(t)
        }, na.prototype.updateUI = function() {
            const e = this.field;
            null == this.filter ? this.text.html('<span style="color:#999">' + htmlEscape(locale.filter) + "</span>") : /^\s*\=\s*null\s*$/.test(this.filter) ? this.text.html('<div class="multicombo-item"><span>' + htmlEscape(locale.empty) + "</span></div>") : /^\s*\!\=\s*null\s*$/.test(this.filter) ? this.text.html('<div class="multicombo-item"><span>' + htmlEscape(locale.notEmpty) + "</span></div>") : e.loadValuesSorted(void 0, e => {
                const t = sa(this.field, this.filter);
                let i = "";
                for (var o = 0; o < e.length; o++) {
                    var n = e[o];
                    t[n.id] && (i += '<div class="multicombo-item" style="' + (n.color ? "background-color:" + n.color + ";color:" + n.textColor : "") + '" data-id="' + n.id + '">' + (n.icon ? '<div class="choice-symbol ic ic-' + n.icon + '"></div>' : "") + "<span>" + htmlEscape(n.caption || "") + "</span></div>")
                }
                this.text.html(i)
            })
        }, na.prototype.setFilter = function(e) {
            this.filter = e,
            this.updateUI()
        }, na.prototype.getFilter = function() {
            return this.filter
        }, na.prototype.show = function() {
            this.el.show()
        }, na.prototype.hide = function() {
            this.el.hide()
        }, na.prototype.popup = function() {
            var e = this,
                t = this.field,
                i = {
                    "=null": 1,
                    "!=null": 1
                }[this.filter] ? {} : sa(t, this.filter),
                o = $.backplane({}),
                n = $('<div class="choice-menu" style="min-width:' + this.el.width() + "px;max-height:" + (window.getHeight() - 64) + 'px;overflow:auto">').appendTo(o).touch((function(e) {
                    var o = $(e.target).closest(".choice-menu-item").attr("data-id");
                    o && ("#all" === o ? (i = {}, c(void 0, !0)) : "#empty" === o ? (i = {}, c("=null", !0)) : "#full" === o ? (i = {}, c("!=null", !0)) : c(function(e) {
                        return i[e] = !i[e], l(), function(e, t) {
                            return "multi" === e.base || "dmulti" === e.base ? function(e, t) {
                                var i = ">[",
                                    o = 0;
                                for (var n in t)
                                    t.hasOwnProperty(n) && t[n] && (i += (o > 0 ? "," : "") + n, o++);
                                return i += "]", o > 0 ? i : ""
                            }(0, t) : function(e, t) {
                                var i = "";
                                for (var o in t)
                                    t.hasOwnProperty(o) && t[o] && (i += (i ? " or " : "") + "=" + aa(o));
                                return i
                            }(0, t)
                        }(t, i)
                    }(o), !1))
                }));
            l();
            var s = n.outerWidth(),
                a = n.outerHeight(),
                r = this.el.offset();
            function l() {
                t.loadValuesSorted(void 0, e => {
                    var t = '<div class="choice-menu-head">';
                    t += '<div data-id="#all" class="choice-menu-item"><div class="choice-label">' + htmlEscape(locale.all) + "</div></div>",
                    t += '<div data-id="#empty" class="choice-menu-item"><div class="choice-label">' + htmlEscape(locale.empty) + "</div></div>",
                    t += '<div data-id="#full" class="choice-menu-item"><div class="choice-label">' + htmlEscape(locale.notEmpty) + "</div></div>",
                    t += "</div>",
                    e.forEach(e => {
                        t += '<div data-id="' + e.id + '" class="choice-menu-item"><div class="choice-indicator' + (i[e.id] ? " selected" : "") + '"></div><div class="multicombo-item" style="' + (e.color ? "background-color:" + e.color + ";color:" + e.textColor : "") + '" data-id="' + e.id + '">' + (e.icon ? '<div class="choice-symbol ic ic-' + e.icon + '"></div>' : "") + "<span>" + htmlEscape(e.caption || "") + "</span></div></div>"
                    }),
                    n.html(t)
                })
            }
            function c(t, i) {
                i && o.close(),
                e.updateModel(t, !1)
            }
            r.top += 32,
            r.left + s > window.getWidth() && (r.left = window.getWidth() - s),
            r.top + a > window.getHeight() && (r.top = window.getHeight() - a),
            n.offset(r)
        }, ra.prototype.destroy = function() {
            this.fromField.destroy(),
            this.toField.destroy(),
            this.el.remove()
        }, ra.prototype.updateModel = function(e) {
            this.filter = e,
            this.updateUI(),
            this.parent.updateFilter(!1)
        }, ra.prototype.filtersChanged = function() {
            if (!this.silent) {
                var e = this.field.base,
                    t = this.fromModel.value,
                    i = this.toModel.value;
                if (null != t && null != i && i < t) {
                    var o = t;
                    t = i,
                    i = o
                }
                if ("date" === e) {
                    if (null != t) {
                        var n = new Date(t);
                        t = new Date(n.getFullYear(), n.getMonth(), n.getDate()).getTime()
                    }
                    if (null != i) {
                        var s = new Date(i);
                        i = new Date(s.getFullYear(), s.getMonth(), s.getDate() + 1).getTime()
                    }
                } else if ("datx" === e) {
                    if (null != t) {
                        n = new Date(t);
                        t = Date.UTC(n.getUTCFullYear(), n.getUTCMonth(), n.getUTCDate())
                    }
                    if (null != i) {
                        s = new Date(i);
                        i = Date.UTC(s.getUTCFullYear(), s.getUTCMonth(), s.getUTCDate() + 1)
                    }
                }
                this.updateModel(util.getDateRangeFilter({
                    from: t,
                    to: i
                }))
            }
        }, ra.prototype.updateUI = function() {
            var e = this.field.base,
                t = this.filter,
                i = util.getFilterDateRange(t),
                o = i.from,
                n = i.to;
            if ("date" === e) {
                if (null != o) {
                    var s = new Date(o);
                    o = new Date(s.getFullYear(), s.getMonth(), s.getDate()).getTime()
                }
                if (null != n) {
                    var a = new Date(n);
                    n = new Date(a.getFullYear(), a.getMonth(), a.getDate() - 1).getTime()
                }
            } else if ("datx" === e) {
                if (null != o) {
                    s = new Date(o);
                    o = Date.UTC(s.getUTCFullYear(), s.getUTCMonth(), s.getUTCDate())
                }
                if (null != n) {
                    a = new Date(n);
                    n = Date.UTC(a.getUTCFullYear(), a.getUTCMonth(), a.getUTCDate() - 1)
                }
            }
            this.silent = !0,
            this.fromModel.setValue(o),
            this.toModel.setValue(n),
            this.silent = !1;
            var r = "empty" !== i.mode && "not-empty" !== i.mode;
            this.$range.css("display", r ? "" : "none"),
            this.$switchRange.toggleClass("selected", r),
            this.$switchEmpty.toggleClass("selected", "empty" === i.mode),
            this.$switchNotEmpty.toggleClass("selected", "not-empty" === i.mode)
        }, ra.prototype.setFilter = function(e) {
            this.filter = e,
            this.updateUI()
        }, ra.prototype.getFilter = function() {
            return this.filter
        }, ra.prototype.show = function() {
            this.el.show()
        }, ra.prototype.hide = function() {
            this.el.hide()
        }, la.prototype.updateModel = function() {
            try {
                var e = (this.input.val() || "").trim();
                0 === e.length ? this.value = void 0 : (queries.parseFilter(e), this.parentEl.removeClass("error"), this.value = e)
            } catch (e) {
                log(e),
                this.parentEl.addClass("error"),
                this.value = void 0
            }
            this.updateUI(),
            this.parent.updateFilter(!0)
        }, la.prototype.getFilter = function() {
            return this.value
        }, la.prototype.setFilter = function(e) {
            this.value = e,
            this.input.val(e || ""),
            this.updateUI()
        }, la.prototype.destroy = function() {
            this.el.remove()
        }, la.prototype.show = function() {
            this.el.show()
        }, la.prototype.hide = function() {
            this.el.hide()
        }, la.prototype.updateUI = function() {
            this.button.css("display", this.value ? "" : "none")
        }, la.prototype.clear = function() {
            this.input.val(""),
            this.updateModel()
        }, $.browser.msie)
            throw document.body.innerHTML = "", n.render(a.createElement(G, {}), document.body), new Error("your browser is not supported, please use the current version of any modern browser instead");
        window.dbms = new M,
        window.dbms.RemoteConnection = w,
        window.dbms.SessionInfo = h,
        window.dbms.MessageService = C,
        window.dbms.AccountRemote = D,
        window.dbms.HTTPServer = S,
        window.dbms.RemoteDB = _.a,
        $,
        function() {
            var e,
                t,
                i;
            function o() {
                return window.getSelection && "None" !== window.getSelection().type && "" !== window.getSelection().toString()
            }
            window.htmlEscape = function(e) {
                return null == e ? "" : "string" != typeof e ? String(e) : e.replace(/[&<>'"]/g, (function(e) {
                    return {
                        "&": "&amp;",
                        "<": "&lt;",
                        ">": "&gt;",
                        "'": "&apos;",
                        '"': "&quot;"
                    }[e]
                }))
            },
            window.$EL = function(e, t, i, o, n) {
                var s = document.createElement(e);
                if (t && (s.className = t), o)
                    for (var a in o)
                        o.hasOwnProperty(a) && s.setAttribute(a, o[a]);
                if (n)
                    for (var a in n)
                        n.hasOwnProperty(a) && (s.style[a] = n[a]);
                return i && i.appendChild(s), s
            },
            window.$DIV = function(e, t, i, o) {
                return $EL("div", e, t, i, o)
            },
            window.$EMPTY = function(e) {
                return e.innerHTML = "", e
            },
            window.$REMOVE = function(e) {
                var t = e.parentNode;
                t && t.removeChild(e)
            },
            e = [],
            t = [],
            i = !1,
            window.addEventListener("message", (function(o) {
                for (var n, s, a, r; e.length;)
                    for (n = e, e = [], a = 0, r = n.length; a < r; a++)
                        (s = n[a])[0].apply(void 0, s.slice(1));
                for (; t.length;)
                    for (n = t, t = [], a = 0, r = n.length; a < r; a++)
                        (s = n[a])[0].apply(void 0, s.slice(1));
                i = !1
            }), !1),
            window.setImmediate = function() {
                for (var t = [], o = 0; o < arguments.length; o++)
                    t[o] = arguments[o];
                e[e.length] = t,
                i || (i = !0, postMessage("si", "*"))
            },
            window.setFinally = function() {
                for (var e = [], o = 0, n = arguments.length; o < n; o++)
                    e[o] = arguments[o];
                t[t.length] = e,
                i || (i = !0, postMessage("si", "*"))
            },
            function() {
                var e = 0,
                    t = void 0,
                    i = {},
                    n = null;
                $.chooseFile = function(e, t) {
                    var i = document.getElementById("NinoxDocumentInteraction-file");
                    i && i.parentNode.removeChild(i),
                    (i = document.createElement("input")).id = "NinoxDocumentInteraction-file",
                    i.type = "file",
                    i.style.display = "none",
                    i.style.position = "absolute",
                    i.style.left = (e.clientX || 0) + "px",
                    i.style.top = (e.clientY || 0) + "px",
                    document.body.appendChild(i),
                    i.addEventListener("change", $.fileChoosen),
                    n = t,
                    i.value = null,
                    i.click()
                },
                $.chooseFileWithExtensions = function(e, t) {
                    var i = document.getElementById("NinoxDocumentInteraction-file");
                    i && i.parentNode.removeChild(i),
                    (i = document.createElement("input")).id = "NinoxDocumentInteraction-file",
                    i.type = "file",
                    i.style.display = "none";
                    for (var o = "", s = 0; s < e.length; s++)
                        o += (s > 0 ? "," : "") + "." + e[s];
                    i.accept = o,
                    document.body.appendChild(i),
                    i.addEventListener("change", $.fileChoosen),
                    n = t,
                    i.value = null,
                    i.click()
                },
                $.fileChoosen = function(e) {
                    var t = document.getElementById("NinoxDocumentInteraction-file");
                    if (t) {
                        var i = n;
                        if (n = null, i) {
                            var o = t.files;
                            o && 1 === o.length && i(void 0, o[0])
                        }
                    }
                },
                $.loading = function(o) {
                    o ? (0 === e && ($.pushInputHandler(i), t = $('<div class="nx-backplane nx-backplane-loading"><div class="spinner" style="position:absolute;left:50%;top:50%;margin:-24px 0 0 -24px"></div></div>').appendTo($(document.body))), e++) : 0 == --e && ($.popInputHandler(i), t.remove(), t = void 0)
                },
                $.backplane = function(e) {
                    var t = !1,
                        i = (e = e || {}).inputHandler || {
                            keydown: function(t) {
                                switch (t.which) {
                                case 27:
                                    e.escape ? e.escape(t) : !1 !== e.closable && (n(), t.preventDefault());
                                    break;
                                case 13:
                                    e.enter ? e.enter(t) : !1 !== e.closable && (n(), t.preventDefault())
                                }
                            }
                        };
                    $.pushInputHandler(i);
                    var o = $('<div class="nx-backplane nx-anim-fade-hidden' + (e.scrollable ? " nx-vscrollable" : "") + (e.cls ? " " + e.cls : "") + '">').appendTo($(document.body));
                    return !1 !== e.closable && o.on(TOUCH ? EVENT_touchstart : "mousedown", (function(e) {
                        var t = $(e.target);
                        (t.is(".nx-backplane") || t.is(".nx-popdown-container")) && n()
                    })), null != e.zIndex && o.css("z-index", e.zIndex), setTimeout((function() {
                        o.addClass("nx-anim-fade-in"),
                        setTimeout((function() {
                            o.removeClass("nx-anim-fade-hidden nx-anim-fade-in")
                        }), 300)
                    }), 0), o.close = n, o;
                    function n(n) {
                        t || (t = !0, e.beforeClose && e.beforeClose(), $.popInputHandler(i), o.addClass("nx-anim-fade-out"), setTimeout((function() {
                            o.remove(),
                            e.close && e.close(),
                            n && n()
                        }), 300))
                    }
                },
                $.progress = function(e) {
                    var t = $.backplane({
                            closable: !1
                        }),
                        i = 48 + (e.caption ? 32 : 0) + (e.cancel ? 48 : 0),
                        o = 16 + (e.caption ? 32 : 0),
                        n = $('<div style="position:absolute;top:50%;left:50%;width:320px;height:' + i + "px;margin-left:-160px;margin-top:-" + i / 2 + 'px;background-color:#000;border-radius:8px">').appendTo(t);
                    e.caption && $('<div style="color:#ccc;text-align:center;position:absolute;top:8px;left:8px;right:8px;overflow:hidden;line-height:32px">').text(e.caption).appendTo(n),
                    $('<div style="position:absolute;left:16px;width:288px;height:16px;top:' + o + 'px;background-color:#555;border-radius:4px">').appendTo(n);
                    var s = $('<div style="position:absolute;left:16px;width:0px;height:16px;top:' + o + 'px;background-color:#fff;border-radius:4px">').appendTo(n);
                    function a() {
                        t.close()
                    }
                    return e.cancel && $('<div style="position:absolute;bottom:16px;right:16px;padding:0 16px;line-height:32px;height:32px;border-radius:4px;background-color:#aaa">').text(locale.cancel).appendTo(n).touch((function() {
                        a(),
                        e.cancel && e.cancel()
                    })), {
                        update: function(e) {
                            s[0].style.width = Math.floor(288 * e) + "px"
                        },
                        close: a
                    }
                },
                $.fn.animFadeIn = function(e) {
                    var t = this;
                    return t.addClass("nx-anim-fade-hidden"), setTimeout((function() {
                        t.addClass("nx-anim-fade-in"),
                        setTimeout((function() {
                            t.removeClass("nx-anim-fade-hidden nx-anim-fade-in"),
                            e && e()
                        }), 300)
                    }), 0), this
                },
                $.fn.animFadeOut = function(e) {
                    var t = this;
                    return t.addClass("nx-anim-fade-out"), setTimeout((function() {
                        t.removeClass("nx-anim-fade-out"),
                        e && e()
                    }), 300), this
                },
                $.popdown = function(e) {
                    e = e || {};
                    var t = {};
                    $.pushInputHandler(t);
                    var i = $('<div class="nx-backplane">').appendTo($(document.body)).on(TOUCH ? EVENT_touchstart : "mousedown", (function(t) {
                            if (!1 !== e.closable) {
                                var i = $(t.target);
                                (i.is(".nx-backplane") || i.is(".nx-popdown-container")) && d()
                            }
                        })),
                        o = $('<div class="nx-popdown-container">').appendTo(i),
                        n = $('<div class="nx-popdown ' + (e.cls || "large") + ' nx-anim-hidden-up">').appendTo(o),
                        s = void 0,
                        a = void 0,
                        r = void 0;
                    if (e.head && $('<div class="nx-section-head">').text(e.head).appendTo(n), e.buttons) {
                        s = $('<div class="nx-section-pane">').appendTo(n),
                        a = $("<div>").appendTo(s),
                        r = $('<div class="nx-button-bar">').appendTo(s);
                        for (var l = 0; l < e.buttons.length; l++) {
                            var c = e.buttons[l];
                            " " === c ? $('<div class="nx-hspace-small">').appendTo(r) : "-" === c ? $('<div class="nx-hspace-flex">').appendTo(r) : "cancel" === c ? $('<div class="nx-button-text grey">').text(locale.cancel).touch(d).appendTo(r) : "okay" === c ? $('<div class="nx-button-text blue">').text(locale.okay).touch(d).appendTo(r) : $('<div class="nx-button-text ' + (c.cls || "grey") + '">').text(c.caption).touch(c.click).appendTo(r)
                        }
                    }
                    return setTimeout((function() {
                        n.addClass("nx-anim-show-down"),
                        setTimeout((function() {
                            requestAnimationFrame((function() {
                                n.removeClass("nx-anim-hidden-up nx-anim-hidden-up")
                            }))
                        }), 300)
                    }), 0), {
                        $backplane: i,
                        $container: o,
                        $pane: n,
                        $section: s,
                        $content: a,
                        $buttons: r,
                        close: h
                    };
                    function d() {
                        h(e.close)
                    }
                    function h(e) {
                        n.addClass("nx-anim-hide-up"),
                        setTimeout((function() {
                            $.popInputHandler(t),
                            i.remove(),
                            e && e()
                        }), 300)
                    }
                },
                $.buttons = function(e) {
                    var t = (e = e || {}).items || [],
                        i = e.style || "",
                        o = e.classes ? " " + e.classes : "",
                        n = $('<div class="nx-button-bar' + o + '" style="' + i + '">');
                    e.$container && n.appendTo(e.$container);
                    for (var s = 0; s < t.length; s++) {
                        var a = t[s];
                        " " === a ? $('<div class="nx-hspace-small">').appendTo(n) : "-" === a ? $('<div class="nx-hspace-flex">').appendTo(n) : $('<div class="nx-button-text ' + (a.cls || "grey") + '">').text(a.caption).touch(a.click).appendTo(n)
                    }
                    return {
                        $pane: n
                    }
                },
                $.input = function(e) {
                    (e = e || {}).type;
                    var t = $('<div class="component editor editor-string" style="width:' + (e.width || "100%") + '">');
                    e.caption && $("<label>").text(e.caption).appendTo(t);
                    var i = $('<input type="' + (e.type || "text") + '">').appendTo($('<div class="stringeditor">').appendTo(t));
                    return e.val && i.val(e.val), e.placeholder && i.attr("placeholder", e.placeholder), e.$container && t.appendTo(e.$container), e.focus && setTimeout((function() {
                        i.focus()
                    }), 400), i.keypress((function(t) {
                        13 === t.which && e.enter && e.enter(),
                        27 === t.which && e.escape && e.escape()
                    })), {
                        $el: t,
                        $input: i,
                        val: $.proxy(i.val, i),
                        focus: function() {
                            i.focus()
                        }
                    }
                },
                $.field = function(e) {
                    (e = e || {}).type;
                    var t = $('<div class="component editor editor-string" style="width:' + (e.width || "100%") + '">');
                    e.caption && $("<label>").text(e.caption).appendTo(t);
                    var i = $('<div class="input-text">').text(e.val).appendTo($('<div class="stringeditor stringeditor-fn">').appendTo(t));
                    return e.$container && t.appendTo(e.$container), e.touch && i.css("cursor", "pointer").touch(e.touch), {
                        $el: t,
                        val: function(e) {
                            i.text(e)
                        }
                    }
                },
                $.tabs = function(e) {
                    for (var t = $("<div>").appendTo(e.$parent), i = $('<div class="nx-switch-big">').appendTo(t), o = e.selected || 0, n = [], s = e.tabs || [], a = 0; a < s.length; a++) {
                        var r = s[a],
                            l = $('<div class="nx-switch-big-item" data-index="' + a + '">').text(r.caption).appendTo(i),
                            c = $('<div class="nx-section-pane">').appendTo(t);
                        a === o ? l.addClass("selected") : c.hide(),
                        n.push({
                            index: a,
                            $tab: l,
                            $pane: c
                        })
                    }
                    function d(t) {
                        t != o && (n[o].$tab.removeClass("selected"), n[o].$pane.hide(), n[t].$tab.addClass("selected"), n[t].$pane.show(), o = t, e.onSelect && e.onSelect(t))
                    }
                    return i.touch((function(e) {
                        var t = $(e.target).closest(".nx-switch-big-item").attr("data-index");
                        t && d(parseInt(t))
                    })), {
                        $pane: t,
                        tabs: n,
                        select: d
                    }
                },
                $.switchpane = function(e) {
                    var t = $('<div class="nx-switchpane">').touch((function(t) {
                            var n = $(t.target).closest(".nx-switchpane-item").attr("data-id");
                            n && n !== i && (null != i && o[i].removeClass("selected"), o[i = n].addClass("selected"), e.update(i))
                        })),
                        i = e.value,
                        o = {};
                    return T.each(e.items, (function(e) {
                        var n = $('<div class="nx-switchpane-item">').append($('<div class="nx-switchpane-item-pane">').append($('<div class="nx-switchpane-item-pane-icon ' + e.icon + '">'))).append($('<div class="nx-switchpane-item-label">').text(e.caption)).appendTo(t).attr("data-id", e.id);
                        o[e.id] = n,
                        i === e.id && n.addClass("selected")
                    })), t
                },
                $.alert = function(e) {
                    $("#nx-alert-backplane").remove();
                    var t = $('<div class="nx-backplane nx-backplane-dark" id="nx-alert-backplane">').click((function(e) {
                            $(e.target).is(".nx-backplane") && n()
                        })),
                        i = $('<div class="nx-alert">').appendTo(t);
                    $('<div class="nx-alert-pane">').text(String(e)).appendTo(i);
                    var o = $('<div class="nx-alert-buttons">').appendTo(i);
                    function n() {
                        t.remove()
                    }
                    $('<div class="nx-hspace-flex">').appendTo(o),
                    $('<div class="nx-button-text blue">').text(locale.okay).appendTo(o).touch(n),
                    t.appendTo($(document.body))
                },
                $.notify = function(e) {
                    "string" == typeof e && (e = {
                        message: e
                    }),
                    $(".notification").remove();
                    var t = $('<div class="notification">').append($('<div class="notification-message">').text(e.message)).appendTo($(document.body)).css({
                        opacity: 0,
                        transition: "opacity .5s",
                        zIndex: 999999
                    }).on("touchstart mousedown", o);
                    setTimeout((function() {
                        t.css({
                            opacity: 1
                        })
                    }), 100);
                    var i = !1;
                    function o() {
                        i || (i = !0, t.css({
                            opacity: 0
                        }), setTimeout((function() {
                            t.remove()
                        }), 500))
                    }
                    setTimeout(o, 1500)
                },
                $.fn.button = function(e, t, i, o) {
                    var n = $('<div class="button">').appendTo(this).touch(o).keypress((function(e) {
                        32 !== e.which && 13 !== e.which || o()
                    }));
                    return e && (i ? $('<div class="icon-big-white icon-big-' + e + '">').appendTo(n) : $('<div class="icon-big-black icon-big-' + e + '">').appendTo(n)), t && (n.addClass("text"), $("<span>").text(t).appendTo(n)), i && n.addClass(i), this
                },
                $.fn.button2 = function(e, t) {
                    return this.append($.button(e))
                },
                $.button = function(e) {
                    var t = $('<div class="button">').touch(e.click).keypress((function(e) {
                        32 !== e.which && 13 !== e.which || callback()
                    }));
                    return e.icon && $("<div>").addClass(e.icon).appendTo(t), e.caption && (t.addClass("text"), $("<span>").text(e.caption).appendTo(t)), e.color && t.addClass(e.color), e.cls && t.addClass(e.cls), e.tip && t.attr("title", e.tip), t
                },
                $.contextmenu = function(e, t) {
                    for (var i = $.backplane({}), o = $('<div class="nx-menu-popup" style="overflow:auto">').appendTo(i), n = t.items, s = "", a = 0; a < n.length; a++) {
                        var r = n[a];
                        s += "-" === r ? "<hr>" : '<div class="nx-menu-item" data-index="' + a + '">' + (r.icon ? '<div class="nx-menu-icon ' + r.icon + '"></div>' : "") + '<div class="nx-menu-label">' + htmlEscape(r.caption) + "</div></div>"
                    }
                    o.html(s),
                    o.touch((function(e) {
                        var t = $(e.target).closest(".nx-menu-item").attr("data-index");
                        if (null != t) {
                            var o = n[parseInt(t)];
                            o && o.click && (i.close(), o.click())
                        }
                    }));
                    var l = window.getWidth(),
                        c = window.getHeight(),
                        d = o.outerWidth(),
                        h = o.outerHeight();
                    const p = ui.fullWidth <= 640 ? 48 + ui.footHeight : 48;
                    h + 14 > c - p - 20 && (h = c - p - 14 - 20, o.outerHeight(h));
                    let u = e.clientX,
                        f = e.clientY;
                    TOUCH && (u = e.changedTouches[0].clientX, f = e.changedTouches[0].clientY);
                    var m = {
                        left: u,
                        top: f
                    };
                    m.left + d > l && (m.left = l - d),
                    m.top + h + 14 > c && (m.top = c - h - p - 14),
                    o.offset(m),
                    $(`<div\n            style="width: 0;\n                   height: 0;\n                   border-left: 17px solid transparent;\n                   border-right: 17px solid transparent;\n                   border-top: 17px solid #ececec;\n                   top: ${m.top + (h - 3)}px;\n                   left: ${u + 1}px;\n                   position: absolute;"\n               >\n        `).appendTo(i),
                    e.preventDefault()
                },
                $.dialog = function(e) {
                    var t = {
                        keydown: function(t) {
                            switch (t.which) {
                            case 13:
                                e.buttons && e.buttons.length && (a(), e.buttons[e.buttons.length - 1].callback && e.buttons[e.buttons.length - 1].callback(), t.preventDefault());
                                break;
                            case 27:
                                e.closable && (a(), t.preventDefault())
                            }
                        }
                    };
                    $.pushInputHandler(t);
                    var i = $('<div class="nx-backplane nx-backplane-dark">').appendTo($(document.body)),
                        o = $('<div class="nx-alert">').appendTo(i);
                    e.closable && i.touch((function(e) {
                        $(e.target).is(".nx-backplane") && a()
                    })),
                    e.caption && $('<div class="nx-alert-head">').text(e.caption).appendTo(o),
                    $('<div class="nx-alert-pane">').html(e.message).appendTo(o);
                    var n = $('<div class="nx-alert-buttons">').appendTo(o),
                        s = !0;
                    function a() {
                        i.remove(),
                        $.popInputHandler(t)
                    }
                    $('<div class="nx-hspace-flex">').appendTo(n),
                    e.closable && ($('<div class="nx-button-text grey">').text(locale.cancel).appendTo(n).touch((function() {
                        a()
                    })), s = !1),
                    T.each(e.buttons, (function(e) {
                        s || $('<div class="nx-hspace-small">').appendTo(n),
                        s = !1,
                        $('<div class="nx-button-text ' + (e.color || "grey") + '">').text(e.caption).appendTo(n).touch((function() {
                            a(),
                            e.callback && e.callback()
                        }))
                    }))
                },
                $.clearSelection = function() {
                    window.getSelection ? window.getSelection().empty ? window.getSelection().empty() : window.getSelection().removeAllRanges && window.getSelection().removeAllRanges() : document.selection && document.selection.empty()
                },
                $.fn.nxdraggable = function(e) {
                    e = e || {};
                    for (var t = 0; t < this.length; t++)
                        this[t].addEventListener(TOUCH ? EVENT_touchstart : "mousedown", i);
                    return this;
                    function i(t) {
                        if (!TOUCH || 1 === t.touches.length) {
                            var i = $(t.target);
                            if (!e.dismiss || !i.is(e.dismiss)) {
                                var o = e.selector ? i.closest(e.selector) : i;
                                if (o.length) {
                                    var n = TOUCH ? t.touches[0].clientX : t.clientX,
                                        s = TOUCH ? t.touches[0].clientY : t.clientY,
                                        a = n,
                                        r = s,
                                        l = !1;
                                    TOUCH ? (EVENT_target(t).addEventListener(EVENT_touchmove, c, !1), EVENT_target(t).addEventListener(EVENT_touchend, d, !1)) : (window.addEventListener("mousemove", c, !0), window.addEventListener("mouseup", d, !0)),
                                    t.preventDefault(),
                                    t.stopPropagation()
                                }
                            }
                        }
                        function c(t) {
                            if (!TOUCH || 1 === t.touches.length) {
                                var i = TOUCH ? t.touches[0].clientX : t.clientX,
                                    c = TOUCH ? t.touches[0].clientY : t.clientY,
                                    d = i - n,
                                    h = c - s;
                                l ? e.drag && e.drag({
                                    $el: o,
                                    x0: n,
                                    y0: s,
                                    x1: a,
                                    y1: r,
                                    x2: i,
                                    y2: c
                                }) : d * d + h * h > 10 && (l = !0, e.dragStart && e.dragStart({
                                    $el: o,
                                    x0: n,
                                    y0: s,
                                    x1: a,
                                    y1: r,
                                    x2: i,
                                    y2: c
                                })),
                                a = i,
                                r = c,
                                t.preventDefault(),
                                t.stopPropagation()
                            }
                        }
                        function d(t) {
                            TOUCH && 0 !== t.touches.length || (TOUCH ? (EVENT_target(t).removeEventListener(EVENT_touchmove, c, !1), EVENT_target(t).removeEventListener(EVENT_touchend, d, !1)) : (window.removeEventListener("mousemove", c, !0), window.removeEventListener("mouseup", d, !0)), t.preventDefault(), t.stopPropagation(), l ? e.dragEnd && e.dragEnd({
                                $el: o,
                                x0: n,
                                y0: s,
                                x1: a,
                                y1: r,
                                x2: a,
                                y2: r
                            }) : e.click && e.click({
                                $el: o,
                                x0: n,
                                y0: s
                            }))
                        }
                    }
                },
                $.event.special.destroyed = {
                    remove: function(e) {
                        e.handler && e.handler()
                    }
                };
                var s = [];
                $(window).on("resize", (function() {
                    var e = s;
                    s = [],
                    T.each(e, (function(e) {
                        var t = document.getElementById(e);
                        if (t) {
                            s.push(e);
                            var i = $(t),
                                o = i.offset,
                                n = Math.max(20, (window.getHeight() - i.outerHeight()) / 3);
                            n > o.top && (n = o.top);
                            var a = Math.max(0, (window.getWidth() - i.outerWidth()) / 2);
                            i.css("transition", "top .5s"),
                            i.offset({
                                top: n,
                                left: a
                            })
                        }
                    }))
                })),
                window.NINOX_IE && $(window).on("click", (function() {
                    document.activeElement ? document.activeElement.focus() : window.focus()
                })),
                $.fn.setHidden = function(e) {
                    return e ? this.css("display", "none") : this.css("display", ""), this
                },
                $.fn.center = function() {
                    var e = this.uniqueId().attr("id");
                    -1 === s.indexOf(e) && s.push(e);
                    var t = Math.max(20, (window.getHeight() - $(this).outerHeight() - (TOUCH ? 352 : 0)) / 3),
                        i = Math.max(0, (window.getWidth() - $(this).outerWidth()) / 2);
                    return this.offset({
                        top: t,
                        left: i
                    }), this
                };
                var a = [];
                function r(e) {
                    if (!e)
                        return !1;
                    var t = e.localName;
                    if ("input" === t || "textarea" === t)
                        return !0;
                    for (; e && e !== document.body;) {
                        if ("true" == e.contentEditable)
                            return !0;
                        e = e.parentNode
                    }
                    return !1
                }
                function l(e) {
                    if (a.length) {
                        var t = a[0];
                        if (t.keydown && !r(e.target))
                            return t.keydown(e)
                    }
                }
                function d(e) {
                    if (a.length) {
                        var t = a[0];
                        if (t.keyup)
                            return t.keyup(e)
                    }
                }
                function h(e) {
                    if (a.length) {
                        var t = a[0];
                        if (t.keypress)
                            return t.keypress(e)
                    }
                }
                window.addEventListener("cut", (function(e) {
                    if (console.log("EVENT: cut()"), !o() && !r(e.target)) {
                        console.log("EVENT: cut() - not an editor");
                        const t = a[0];
                        if (t && t.cut) {
                            console.log("EVENT: cut() - got a handler");
                            const i = t.cut();
                            i && (console.log("EVENT: cut() - have some data", i), e.clipboardData.setData("text/plain", i), console.log("EVENT: cut() - stored the data"), e.preventDefault())
                        }
                    }
                })),
                window.addEventListener("copy", (function(e) {
                    if (console.log("EVENT: copy()"), !o() && !r(e.target)) {
                        console.log("EVENT: copy() - not an editor");
                        const t = a[0];
                        if (t && t.copy) {
                            console.log("EVENT: copy() - got a handler");
                            const i = t.copy();
                            i && (console.log("EVENT: copy() - have some data", i), e.clipboardData.setData("text/plain", i), console.log("EVENT: copy() - stored the data"), e.preventDefault())
                        }
                    }
                })),
                window.addEventListener("paste", (function(e) {
                    if (console.log("EVENT: paste()"), !o() && !r(e.target)) {
                        console.log("EVENT: paste() - not an editor");
                        const t = a[0];
                        if (t && t.paste) {
                            console.log("EVENT: copy() - got a handler");
                            const i = e.clipboardData.getData("text/plain");
                            i && (t.paste(i), e.preventDefault())
                        }
                    }
                })),
                $.pushInputHandler = function(e) {
                    a = [e].concat(a),
                    Object(c.l)()
                },
                $.popInputHandler = function(e) {
                    var t = a.indexOf(e);
                    t >= 0 ? a = a.slice(0, t).concat(a.slice(t + 1)) : console.log("Unbalanced push/pop keydown listener"),
                    Object(c.l)()
                },
                $.currentInputHandler = function() {
                    return a[0]
                },
                $.fn.replaceSelectedText = function(e) {
                    var t,
                        i,
                        o,
                        n;
                    return 1 === this.length && (t = this[0], i = e, o = function(e) {
                        var t,
                            i,
                            o,
                            n,
                            s,
                            a = 0,
                            r = 0;
                        return "number" == typeof e.selectionStart && "number" == typeof e.selectionEnd ? (a = e.selectionStart, r = e.selectionEnd) : (i = document.selection.createRange()) && i.parentElement() == e && (n = e.value.length, t = e.value.replace(/\r\n/g, "\n"), (o = e.createTextRange()).moveToBookmark(i.getBookmark()), (s = e.createTextRange()).collapse(!1), o.compareEndPoints("StartToEnd", s) > -1 ? a = r = n : (a = -o.moveStart("character", -n), a += t.slice(0, a).split("\n").length - 1, o.compareEndPoints("EndToEnd", s) > -1 ? r = n : (r = -o.moveEnd("character", -n), r += t.slice(0, r).split("\n").length - 1))), {
                            start: a,
                            end: r
                        }
                    }(t), n = t.value, t.value = n.slice(0, o.start) + i + n.slice(o.end)), this
                },
                $((function() {
                    window.addEventListener("keydown", l, !1),
                    window.addEventListener("keyup", d, !1),
                    window.addEventListener("keypress", h, !1)
                }))
            }()
        }(),
        $.fn.nxmenu = function(e) {
            var t = this;
            return this.addClass("nx-menu-button").click((function() {
                t.addClass("nx-selected");
                var i = $('<div class="nx-backplane nx-backplane-dark">').appendTo($(document.body)).click((function() {
                        i.remove(),
                        t.removeClass("nx-selected")
                    })),
                    o = $('<div class="nx-menu-popup">').appendTo(i);
                T.each(e.items, (function(t) {
                    if ("string" == typeof t)
                        "-" === t ? $("<hr>").appendTo(o) : $("<h1>").text(t).appendTo(o);
                    else if ("object" == typeof t) {
                        var i = $('<div class="nx-menu-item">').appendTo(o);
                        e.icon && $('<div class="nx-menu-icon">').addClass(e.icon).appendTo(i),
                        $('<div class="nx-menu-label">').text(t.caption).appendTo(i),
                        i.click(t.click)
                    }
                }));
                var n = o.outerWidth(),
                    s = o.outerHeight(),
                    a = t.offset();
                return a.top += t.outerHeight() + 16, a.left -= 16, a.left + n > window.innerWidth && (a.left = window.innerWidth - n), a.top + s > window.innerHeight && (a.top = window.innerHeight - s), o.offset(a), !1
            })), this
        },
        window.ui = function() {
            const e = {};
            return window.log = yo, Object.assign(e, b.util.events), e.Views = {
                home: eo,
                calendar: uo,
                search: go
            }, e.leftDivider = void 0, e.rightDivider = void 0, e.$head = void 0, e.$left = void 0, e.$right = void 0, e.$body = void 0, e.$overlays = void 0, e.$tableContextMenuContainer = void 0, e.$foot = void 0, e.$header = void 0, e.$menu = void 0, e.$menuCenter = void 0, e.$menuRight = void 0, e.setIsInitialized = t => {
                e.isInitialized = t
            }, e.setIsInitialized(!1), e.topPadding = 0, e.planInfo = void 0, e.$planInfo = void 0, e.setTopPadding = ds, e.currentView = void 0, e.navigationStates = {}, e.destroy = Rs, e.backToRoot = Fs, e.handleLogout = As, e.init = Us, e.updateBackground = js, e.showRight = Ns, e.hideRight = Os, e.getAvailableTypes = Zn, e.openTable = ms, e.createTable = gs, e.openCalendar = ps, e.openSearch = us, e.openHome = fs, e.openRecord = vs, e.popupRecord = bs, e.openFullscreen = xs, e.closeFullscreen = Ts, e.closeRecord = ws, e.closeAllRecords = $s, e.navigate = hs, e.getCurrentEditor = Cs, e.dropDatabase = Bs, e.saveArchiveAs = qs, e.duplicateDatabase = Ys, e.renameDatabase = Xs, e.evictDatabase = Gs, e.reorganizeDatabase = Js, e.createDatabase = Ks, e.importArchive = Qs, e.showLeftPanel = is, e.hideLeftPanel = os, e.setCloudSyncState = zs, e.views = {}, e.fullscreenStack = [], e.rightVisible = !1, e.fullWidth = 0, e.bodyWidth = 0, e.leftWidth = 180, e.isLeftOpen = !0, e.isLeftOpenSaved = !0, e.isLeftOpenVerticalSaved = !0, e.rightWidth = 672, e.leftWidthSaved = 180, e.rightWidthSaved = 672, e.leftWidthVerticalSaved = 180, e.rightWidthVerticalSaved = 672, e.footHeight = 0, e.headHeight = 96, e.initRoot = function() {
                window.root = new dn
            }, e
        }(),
        window.widgets = Object(Bt.a)(),
        window.tables = function() {
            const e = {};
            return e.editors = {
                choice: ia,
                dchoice: ia,
                string: ta
            }, e.createFilterEditor = da, e.createCellEditor = ca, e.aggTypeToSymbol = ha, e
        }(),
        window.printer = function() {
            const e = {
                printNode: N.a,
                printTable: I.a,
                renderNodeHTML: O.a,
                renderTableHTML: R.a
            };
            return e.aggSymbol = j, e.cellTypeAlign = L, e.DPI = 72, e.MM = .0393700787 * e.DPI, e
        }(),
        window.reports = function() {
            const e = {
                ActionMenu: F.a,
                ColorMenu: B.a,
                Designer: A.a,
                ObjectMenu: q.a,
                PaperMenu: Y.a,
                TextMenu: X.a,
                RDHTML: H.a,
                RDImage: P.a,
                RDImageField: U.a,
                RDObject: z.a,
                RDReverse: V.a,
                RDText: W.a,
                printAllRecords: !1,
                designer: void 0,
                openDesigner: function(e) {
                    if (e.nid) {
                        var t = database.typeOf(e.nid);
                        if (t) {
                            var i = e.reportName,
                                o = e.reportId;
                            if (null === o) {
                                var n = new A.a({
                                    tid: t.id,
                                    caption: e.caption
                                }, {
                                    nid: e.nid,
                                    empty: e.empty,
                                    nids: e.nids
                                });
                                NinoxDocumentInteraction.setUserDefault("ui.report.id:" + database.id + "/" + t.id, n.id)
                            } else
                                database.listReports((function(n, s) {
                                    if (n)
                                        return $.alert(n);
                                    if (i)
                                        for (var a in s) {
                                            if ((d = s[a]).caption == i && d.tid === t.id) {
                                                o = a;
                                                break
                                            }
                                        }
                                    var r = s[o || NinoxDocumentInteraction.getUserDefault("ui.report.id:" + database.id + "/" + t.id)];
                                    if (r && r.tid !== t.id && (r = void 0), !r)
                                        for (var l = util.localeSortBy(s, "caption"), c = 0; c < l.length; c++) {
                                            var d;
                                            if ((d = l[c]).tid === t.id) {
                                                r = d;
                                                break
                                            }
                                        }
                                    r || (r = {
                                        tid: t.id,
                                        caption: e.caption
                                    });
                                    var h = new A.a(r, {
                                        nid: e.nid,
                                        nids: e.nids,
                                        printOneAndClose: e.printOneAndClose,
                                        printAllAndClose: e.printAllAndClose,
                                        saveToFileAndClose: e.saveToFileAndClose
                                    });
                                    NinoxDocumentInteraction.setUserDefault("ui.report.id:" + database.id + "/" + t.id, h.id)
                                }))
                        }
                    }
                }
            };
            return e
        }(),
        function() {
            function e(e) {
                return this
            }
            window.ninox_init = async function() {
                window.database = null;
                l.d(),
                l.e({
                    device: "web"
                });
                try {
                    ga((function(e) {
                        e.get("clientId")
                    }))
                } catch (e) {
                    console.log(e)
                }
                function t(e) {
                    ga("send", "pageview", "/web/" + e)
                }
                function i(e, t, i) {
                    ga("send", "event", e, t, "web", i)
                }
                String.prototype.normalize || (String.prototype.normalize = e),
                function() {
                    window.console || (window.console = {});
                    console.log || (console.log = function() {}),
                    console.warn || (console.warn = function() {})
                }(),
                function() {
                    var e = /^([a-z]+)(?:\-([a-z]+))?$/i.exec(navigator.language);
                    if (e) {
                        var t = (e[1] || "").toLowerCase(),
                            i = (e[2] || "").toUpperCase(),
                            o = $.datepicker.regional[t + "-" + i] || $.datepicker.regional[t];
                        o && $.datepicker.setDefaults(o),
                        locale.weekStartMonday = 1 === $.datepicker._defaults.firstDay,
                        locale.firstDayOfWeek = locale.weekStartMonday ? 1 : 0
                    }
                    $.datepicker.formatDate = function(e, t, i) {
                        return t ? b.util.moment(t).format(locale.dateFormat) : ""
                    },
                    $.datepicker.parseDate = function(e, t, i) {
                        if (t)
                            return b.util.moment(t, locale.dateFormat).toDate()
                    }
                }(),
                window.trackPageView = t,
                window.trackEvent = i,
                $.loading(!0),
                setTimeout((function() {
                    dbms.bootstrap((function(e) {
                        if ($.loading(!1), e)
                            return $.alert(String(e));
                        Object(c.k)(() => {
                            const e = Object(c.d)("settings") || {},
                                t = Object(c.d)("passwordPolicy") || {},
                                i = e.localeOverrides;
                            i && (Object(b.overrideLocales)(i), window.locale = Object(b.getLocale)(), window.LOCALE = Object(b.getUserLanguage)()),
                            $(document.head).find("title").text(window.database && window.database.name || "Ninox Database"),
                            t.idleTimeoutInMinutes && Object(c.e)(60 * t.idleTimeoutInMinutes * 1e3),
                            async function() {
                                if (he(), await localFileSystem.cachedURL("https://ninox.com/api/templates", 864e5), Object(c.f)()) {
                                    const e = NinoxDocumentInteraction.getUserDefault("nx.server"),
                                        t = (e ? "https://" + e : "") + "/_custom/custom.css",
                                        i = document.createElement("link");
                                    i.rel = "stylesheet",
                                    i.href = await localFileSystem.cachedURL(t, 6e4) || t,
                                    document.head.appendChild(i);
                                    const o = (e ? "https://" + e : "") + "/_custom/custom.js",
                                        n = document.createElement("script");
                                    n.type = "text/javascript",
                                    n.src = await localFileSystem.cachedURL(o, 6e4) || o,
                                    document.head.appendChild(n)
                                }
                                ui.initRoot && ui.initRoot(),
                                setTimeout((function() {
                                    $("#bootscreen").addClass("fade-out"),
                                    setTimeout((function() {
                                        $("#bootscreen").remove()
                                    }), 300)
                                }), 100),
                                new se(dbms.messageService)
                            }()
                        })
                    }))
                }), 0)
            };
            var t = {};
            t["-M-PL0jBisit-PCFunUO"] = {
                init: function(e) {
                    console.log("Appcues flow Enter Data: init"),
                    database && database.on("update", this.onUpdate, this)
                },
                reset: function(e) {
                    console.log("Appcues flow Enter Data: reset"),
                    database && database.off("update", this.onUpdate, this)
                },
                onUpdate: function(e) {
                    console.log("Appcues flow Enter Data: record updated"),
                    Appcues.track("Record Modified", {})
                }
            },
            window.getWidth = function() {
                return window.innerWidth
            },
            window.getHeight = function() {
                return window.innerHeight
            },
            window.ninox_barcode = function(e) {},
            window.ninox_openURL = function(e) {
                NinoxViewController.clearLaunchURL(),
                root.handleOpenURL(e)
            },
            window.ninox_saveListeners = [],
            window.registerSaveListener = function(e) {
                ninox_saveListeners = ninox_saveListeners.concat(e)
            },
            window.unregisterSaveListener = function(e) {
                var t = ninox_saveListeners.indexOf(e);
                t >= 0 && (ninox_saveListeners = ninox_saveListeners.slice(0, t).concat(ninox_saveListeners.slice(t + 1)))
            },
            window.ninox_saveEverything = function() {
                for (var e = ninox_saveListeners, t = 0; t < e.length; t++)
                    e[t]();
                window.database ? window.database.saveEverything((function(e) {
                    e && console.log("ninox_saveEverything database err", e),
                    NinoxViewController.everythingSaved()
                })) : NinoxViewController.everythingSaved()
            },
            window.ninox_cutEnabled = function() {
                var e = $.currentInputHandler();
                return e && e.cutEnabled && e.cutEnabled() || !1
            },
            window.ninox_copyEnabled = function() {
                var e = $.currentInputHandler();
                return e && e.copyEnabled && e.copyEnabled() || !1
            },
            window.ninox_pasteEnabled = function() {
                var e = $.currentInputHandler();
                return e && e.pasteEnabled && e.pasteEnabled() || !1
            },
            window.ninox_cut = function() {
                var e = $.currentInputHandler();
                return e && e.cut && e.cut() || ""
            },
            window.ninox_copy = function() {
                var e = $.currentInputHandler();
                return e && e.copy && e.copy() || ""
            },
            window.ninox_paste = function(e) {
                var t = $.currentInputHandler();
                t && t.paste && t.paste(e)
            },
            window.ninox_menuEnabled = function(e) {
                switch (e) {
                case "menuNewDatabase":
                case "menuImportArchive":
                    return !ui.isInitialized;
                case "menuSaveArchiveAs":
                case "menuDuplicateDatabase":
                    return !!ui.isInitialized && window.database && !window.database.sql;
                case "menuRenameDatabase":
                    return !!ui.isInitialized;
                case "menuReorganizeDatabase":
                    return !!(ui.isInitialized && window.database && database.cloud);
                case "menuDeleteDatabase":
                case "menuCloseDatabase":
                    return !!ui.isInitialized;
                default:
                    var t = $.currentInputHandler();
                    return !(!t || "function" != typeof t[e + "Enabled"]) && t[e + "Enabled"]()
                }
            },
            window.ninox_menuAction = function(e) {
                switch (e) {
                case "menuNewDatabase":
                    ui.createDatabase();
                    break;
                case "menuImportArchive":
                    ui.importArchive();
                    break;
                case "menuSaveArchiveAs":
                    ui.isInitialized && ui.saveArchiveAs({});
                    break;
                case "menuDuplicateDatabase":
                    ui.isInitialized && ui.duplicateDatabase();
                    break;
                case "menuRenameDatabase":
                    ui.isInitialized && ui.renameDatabase();
                    break;
                case "menuReorganizeDatabase":
                    ui.isInitialized && database.cloud && ui.reorganizeDatabase();
                    break;
                case "menuDeleteDatabase":
                    ui.isInitialized && ui.dropDatabase();
                    break;
                case "menuCloseDatabase":
                    ui.isInitialized && ui.backToRoot();
                    break;
                default:
                    var t = $.currentInputHandler();
                    t && "function" == typeof t[e] && t[e]()
                }
                setTimeout(() => Object(c.l)(), 10)
            },
            window.ninox_undoChanged = function() {
                ui.recordNavigation && ui.recordNavigation.updateUndo()
            },
            window.ninox_decrypt = function(e, t) {
                console.log("ninox_decrypt", e, t);
                var i = b.util.AESDecrypt(e, t);
                return console.log("ninox_decrypt > ", i), i
            },
            window.samlLoginCallback = function(e, t) {
                if (console.log("samlLoginCallback", e, t), e)
                    return $.alert(e);
                dbms.getRemoteConnection().isLoggedIn() || dbms.getRemoteConnection().fetchSession(t, (function(e, t) {
                    if (e)
                        return $.alert(e);
                    t && dbms.getRemoteConnection().saveSession(t),
                    dbms.getRemoteConnection().refresh(() => {
                        root.afterLogin()
                    })
                }))
            }
        }(),
        window.ninox_init()
    },
    "./src/init_lib.js": function(e, t, i) {
        "use strict";
        i.r(t);
        i("./node_modules/core-js/stable/index.js"),
        i("./node_modules/regenerator-runtime/runtime.js"),
        i("./node_modules/script-loader/index.js!./node_modules/jquery/dist/jquery.min.js"),
        i("./node_modules/core-js/modules/es.string.replace.js");
        !function(e, t) {
            var i,
                o,
                n = 0,
                s = /^ui-id-\d+$/;
            function a(t, i) {
                var o,
                    n,
                    s,
                    a = t.nodeName.toLowerCase();
                return "area" === a ? (n = (o = t.parentNode).name, !(!t.href || !n || "map" !== o.nodeName.toLowerCase()) && (!!(s = e("img[usemap=#" + n + "]")[0]) && r(s))) : (/input|select|textarea|button|object/.test(a) ? !t.disabled : "a" === a && t.href || i) && r(t)
            }
            function r(t) {
                return e.expr.filters.visible(t) && !e(t).parents().addBack().filter((function() {
                        return "hidden" === e.css(this, "visibility")
                    })).length
            }
            e.ui = e.ui || {},
            e.extend(e.ui, {
                version: "1.10.4",
                keyCode: {
                    BACKSPACE: 8,
                    COMMA: 188,
                    DELETE: 46,
                    DOWN: 40,
                    END: 35,
                    ENTER: 13,
                    ESCAPE: 27,
                    HOME: 36,
                    LEFT: 37,
                    NUMPAD_ADD: 107,
                    NUMPAD_DECIMAL: 110,
                    NUMPAD_DIVIDE: 111,
                    NUMPAD_ENTER: 108,
                    NUMPAD_MULTIPLY: 106,
                    NUMPAD_SUBTRACT: 109,
                    PAGE_DOWN: 34,
                    PAGE_UP: 33,
                    PERIOD: 190,
                    RIGHT: 39,
                    SPACE: 32,
                    TAB: 9,
                    UP: 38
                }
            }),
            e.fn.extend({
                focus: (i = e.fn.focus, function(t, o) {
                    return "number" == typeof t ? this.each((function() {
                        var i = this;
                        setTimeout((function() {
                            e(i).focus(),
                            o && o.call(i)
                        }), t)
                    })) : i.apply(this, arguments)
                }),
                scrollParent: function() {
                    var t;
                    return t = e.ui.ie && /(static|relative)/.test(this.css("position")) || /absolute/.test(this.css("position")) ? this.parents().filter((function() {
                        return /(relative|absolute|fixed)/.test(e.css(this, "position")) && /(auto|scroll)/.test(e.css(this, "overflow") + e.css(this, "overflow-y") + e.css(this, "overflow-x"))
                    })).eq(0) : this.parents().filter((function() {
                        return /(auto|scroll)/.test(e.css(this, "overflow") + e.css(this, "overflow-y") + e.css(this, "overflow-x"))
                    })).eq(0), /fixed/.test(this.css("position")) || !t.length ? e(document) : t
                },
                zIndex: function(t) {
                    if (void 0 !== t)
                        return this.css("zIndex", t);
                    if (this.length)
                        for (var i, o, n = e(this[0]); n.length && n[0] !== document;) {
                            if (("absolute" === (i = n.css("position")) || "relative" === i || "fixed" === i) && (o = parseInt(n.css("zIndex"), 10), !isNaN(o) && 0 !== o))
                                return o;
                            n = n.parent()
                        }
                    return 0
                },
                uniqueId: function() {
                    return this.each((function() {
                        this.id || (this.id = "ui-id-" + ++n)
                    }))
                },
                removeUniqueId: function() {
                    return this.each((function() {
                        s.test(this.id) && e(this).removeAttr("id")
                    }))
                }
            }),
            e.extend(e.expr[":"], {
                data: e.expr.createPseudo ? e.expr.createPseudo((function(t) {
                    return function(i) {
                        return !!e.data(i, t)
                    }
                })) : function(t, i, o) {
                    return !!e.data(t, o[3])
                },
                focusable: function(t) {
                    return a(t, !isNaN(e.attr(t, "tabindex")))
                },
                tabbable: function(t) {
                    var i = e.attr(t, "tabindex"),
                        o = isNaN(i);
                    return (o || i >= 0) && a(t, !o)
                }
            }),
            e("<a>").outerWidth(1).jquery || e.each(["Width", "Height"], (function(t, i) {
                var o = "Width" === i ? ["Left", "Right"] : ["Top", "Bottom"],
                    n = i.toLowerCase(),
                    s = {
                        innerWidth: e.fn.innerWidth,
                        innerHeight: e.fn.innerHeight,
                        outerWidth: e.fn.outerWidth,
                        outerHeight: e.fn.outerHeight
                    };
                function a(t, i, n, s) {
                    return e.each(o, (function() {
                        i -= parseFloat(e.css(t, "padding" + this)) || 0,
                        n && (i -= parseFloat(e.css(t, "border" + this + "Width")) || 0),
                        s && (i -= parseFloat(e.css(t, "margin" + this)) || 0)
                    })), i
                }
                e.fn["inner" + i] = function(t) {
                    return void 0 === t ? s["inner" + i].call(this) : this.each((function() {
                        e(this).css(n, a(this, t) + "px")
                    }))
                },
                e.fn["outer" + i] = function(t, o) {
                    return "number" != typeof t ? s["outer" + i].call(this, t) : this.each((function() {
                        e(this).css(n, a(this, t, !0, o) + "px")
                    }))
                }
            })),
            e.fn.addBack || (e.fn.addBack = function(e) {
                return this.add(null == e ? this.prevObject : this.prevObject.filter(e))
            }),
            e("<a>").data("a-b", "a").removeData("a-b").data("a-b") && (e.fn.removeData = (o = e.fn.removeData, function(t) {
                return arguments.length ? o.call(this, e.camelCase(t)) : o.call(this)
            })),
            e.ui.ie = !!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),
            e.support.selectstart = "onselectstart" in document.createElement("div"),
            e.fn.extend({
                disableSelection: function() {
                    return this.bind((e.support.selectstart ? "selectstart" : "mousedown") + ".ui-disableSelection", (function(e) {
                        e.preventDefault()
                    }))
                },
                enableSelection: function() {
                    return this.unbind(".ui-disableSelection")
                }
            }),
            e.extend(e.ui, {
                plugin: {
                    add: function(t, i, o) {
                        var n,
                            s = e.ui[t].prototype;
                        for (n in o)
                            s.plugins[n] = s.plugins[n] || [],
                            s.plugins[n].push([i, o[n]])
                    },
                    call: function(e, t, i) {
                        var o,
                            n = e.plugins[t];
                        if (n && e.element[0].parentNode && 11 !== e.element[0].parentNode.nodeType)
                            for (o = 0; o < n.length; o++)
                                e.options[n[o][0]] && n[o][1].apply(e.element, i)
                    }
                },
                hasScroll: function(t, i) {
                    if ("hidden" === e(t).css("overflow"))
                        return !1;
                    var o,
                        n = i && "left" === i ? "scrollLeft" : "scrollTop";
                    return t[n] > 0 || (t[n] = 1, o = t[n] > 0, t[n] = 0, o)
                }
            })
        }(jQuery),
        function(e, t) {
            var i = 0,
                o = Array.prototype.slice,
                n = e.cleanData;
            e.cleanData = function(t) {
                for (var i, o = 0; null != (i = t[o]); o++)
                    try {
                        e(i).triggerHandler("remove")
                    } catch (e) {}
                n(t)
            },
            e.widget = function(t, i, o) {
                var n,
                    s,
                    a,
                    r,
                    l = {},
                    c = t.split(".")[0];
                t = t.split(".")[1],
                n = c + "-" + t,
                o || (o = i, i = e.Widget),
                e.expr[":"][n.toLowerCase()] = function(t) {
                    return !!e.data(t, n)
                },
                e[c] = e[c] || {},
                s = e[c][t],
                a = e[c][t] = function(e, t) {
                    if (!this._createWidget)
                        return new a(e, t);
                    arguments.length && this._createWidget(e, t)
                },
                e.extend(a, s, {
                    version: o.version,
                    _proto: e.extend({}, o),
                    _childConstructors: []
                }),
                (r = new i).options = e.widget.extend({}, r.options),
                e.each(o, (function(t, o) {
                    var n,
                        s;
                    e.isFunction(o) ? l[t] = (n = function() {
                        return i.prototype[t].apply(this, arguments)
                    }, s = function(e) {
                        return i.prototype[t].apply(this, e)
                    }, function() {
                        var e,
                            t = this._super,
                            i = this._superApply;
                        return this._super = n, this._superApply = s, e = o.apply(this, arguments), this._super = t, this._superApply = i, e
                    }) : l[t] = o
                })),
                a.prototype = e.widget.extend(r, {
                    widgetEventPrefix: s && r.widgetEventPrefix || t
                }, l, {
                    constructor: a,
                    namespace: c,
                    widgetName: t,
                    widgetFullName: n
                }),
                s ? (e.each(s._childConstructors, (function(t, i) {
                    var o = i.prototype;
                    e.widget(o.namespace + "." + o.widgetName, a, i._proto)
                })), delete s._childConstructors) : i._childConstructors.push(a),
                e.widget.bridge(t, a)
            },
            e.widget.extend = function(t) {
                for (var i, n, s = o.call(arguments, 1), a = 0, r = s.length; a < r; a++)
                    for (i in s[a])
                        n = s[a][i],
                        s[a].hasOwnProperty(i) && void 0 !== n && (e.isPlainObject(n) ? t[i] = e.isPlainObject(t[i]) ? e.widget.extend({}, t[i], n) : e.widget.extend({}, n) : t[i] = n);
                return t
            },
            e.widget.bridge = function(t, i) {
                var n = i.prototype.widgetFullName || t;
                e.fn[t] = function(s) {
                    var a = "string" == typeof s,
                        r = o.call(arguments, 1),
                        l = this;
                    return s = !a && r.length ? e.widget.extend.apply(null, [s].concat(r)) : s, a ? this.each((function() {
                        var i,
                            o = e.data(this, n);
                        return o ? e.isFunction(o[s]) && "_" !== s.charAt(0) ? (i = o[s].apply(o, r)) !== o && void 0 !== i ? (l = i && i.jquery ? l.pushStack(i.get()) : i, !1) : void 0 : e.error("no such method '" + s + "' for " + t + " widget instance") : e.error("cannot call methods on " + t + " prior to initialization; attempted to call method '" + s + "'")
                    })) : this.each((function() {
                        var t = e.data(this, n);
                        t ? t.option(s || {})._init() : e.data(this, n, new i(s, this))
                    })), l
                }
            },
            e.Widget = function() {},
            e.Widget._childConstructors = [],
            e.Widget.prototype = {
                widgetName: "widget",
                widgetEventPrefix: "",
                defaultElement: "<div>",
                options: {
                    disabled: !1,
                    create: null
                },
                _createWidget: function(t, o) {
                    o = e(o || this.defaultElement || this)[0],
                    this.element = e(o),
                    this.uuid = i++,
                    this.eventNamespace = "." + this.widgetName + this.uuid,
                    this.options = e.widget.extend({}, this.options, this._getCreateOptions(), t),
                    this.bindings = e(),
                    this.hoverable = e(),
                    this.focusable = e(),
                    o !== this && (e.data(o, this.widgetFullName, this), this._on(!0, this.element, {
                        remove: function(e) {
                            e.target === o && this.destroy()
                        }
                    }), this.document = e(o.style ? o.ownerDocument : o.document || o), this.window = e(this.document[0].defaultView || this.document[0].parentWindow)),
                    this._create(),
                    this._trigger("create", null, this._getCreateEventData()),
                    this._init()
                },
                _getCreateOptions: e.noop,
                _getCreateEventData: e.noop,
                _create: e.noop,
                _init: e.noop,
                destroy: function() {
                    this._destroy(),
                    this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),
                    this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName + "-disabled ui-state-disabled"),
                    this.bindings.unbind(this.eventNamespace),
                    this.hoverable.removeClass("ui-state-hover"),
                    this.focusable.removeClass("ui-state-focus")
                },
                _destroy: e.noop,
                widget: function() {
                    return this.element
                },
                option: function(t, i) {
                    var o,
                        n,
                        s,
                        a = t;
                    if (0 === arguments.length)
                        return e.widget.extend({}, this.options);
                    if ("string" == typeof t)
                        if (a = {}, o = t.split("."), t = o.shift(), o.length) {
                            for (n = a[t] = e.widget.extend({}, this.options[t]), s = 0; s < o.length - 1; s++)
                                n[o[s]] = n[o[s]] || {},
                                n = n[o[s]];
                            if (t = o.pop(), 1 === arguments.length)
                                return void 0 === n[t] ? null : n[t];
                            n[t] = i
                        } else {
                            if (1 === arguments.length)
                                return void 0 === this.options[t] ? null : this.options[t];
                            a[t] = i
                        }
                    return this._setOptions(a), this
                },
                _setOptions: function(e) {
                    var t;
                    for (t in e)
                        this._setOption(t, e[t]);
                    return this
                },
                _setOption: function(e, t) {
                    return this.options[e] = t, "disabled" === e && (this.widget().toggleClass(this.widgetFullName + "-disabled ui-state-disabled", !!t).attr("aria-disabled", t), this.hoverable.removeClass("ui-state-hover"), this.focusable.removeClass("ui-state-focus")), this
                },
                enable: function() {
                    return this._setOption("disabled", !1)
                },
                disable: function() {
                    return this._setOption("disabled", !0)
                },
                _on: function(t, i, o) {
                    var n,
                        s = this;
                    "boolean" != typeof t && (o = i, i = t, t = !1),
                    o ? (i = n = e(i), this.bindings = this.bindings.add(i)) : (o = i, i = this.element, n = this.widget()),
                    e.each(o, (function(o, a) {
                        function r() {
                            if (t || !0 !== s.options.disabled && !e(this).hasClass("ui-state-disabled"))
                                return ("string" == typeof a ? s[a] : a).apply(s, arguments)
                        }
                        "string" != typeof a && (r.guid = a.guid = a.guid || r.guid || e.guid++);
                        var l = o.match(/^(\w+)\s*(.*)$/),
                            c = l[1] + s.eventNamespace,
                            d = l[2];
                        d ? n.delegate(d, c, r) : i.bind(c, r)
                    }))
                },
                _off: function(e, t) {
                    t = (t || "").split(" ").join(this.eventNamespace + " ") + this.eventNamespace,
                    e.unbind(t).undelegate(t)
                },
                _delay: function(e, t) {
                    var i = this;
                    return setTimeout((function() {
                        return ("string" == typeof e ? i[e] : e).apply(i, arguments)
                    }), t || 0)
                },
                _hoverable: function(t) {
                    this.hoverable = this.hoverable.add(t),
                    this._on(t, {
                        mouseenter: function(t) {
                            e(t.currentTarget).addClass("ui-state-hover")
                        },
                        mouseleave: function(t) {
                            e(t.currentTarget).removeClass("ui-state-hover")
                        }
                    })
                },
                _focusable: function(t) {
                    this.focusable = this.focusable.add(t),
                    this._on(t, {
                        focusin: function(t) {
                            e(t.currentTarget).addClass("ui-state-focus")
                        },
                        focusout: function(t) {
                            e(t.currentTarget).removeClass("ui-state-focus")
                        }
                    })
                },
                _trigger: function(t, i, o) {
                    var n,
                        s,
                        a = this.options[t];
                    if (o = o || {}, (i = e.Event(i)).type = (t === this.widgetEventPrefix ? t : this.widgetEventPrefix + t).toLowerCase(), i.target = this.element[0], s = i.originalEvent)
                        for (n in s)
                            n in i || (i[n] = s[n]);
                    return this.element.trigger(i, o), !(e.isFunction(a) && !1 === a.apply(this.element[0], [i].concat(o)) || i.isDefaultPrevented())
                }
            },
            e.each({
                show: "fadeIn",
                hide: "fadeOut"
            }, (function(t, i) {
                e.Widget.prototype["_" + t] = function(o, n, s) {
                    "string" == typeof n && (n = {
                        effect: n
                    });
                    var a,
                        r = n ? !0 === n || "number" == typeof n ? i : n.effect || i : t;
                    "number" == typeof (n = n || {}) && (n = {
                        duration: n
                    }),
                    a = !e.isEmptyObject(n),
                    n.complete = s,
                    n.delay && o.delay(n.delay),
                    a && e.effects && e.effects.effect[r] ? o[t](n) : r !== t && o[r] ? o[r](n.duration, n.easing, s) : o.queue((function(i) {
                        e(this)[t](),
                        s && s.call(o[0]),
                        i()
                    }))
                }
            }))
        }(jQuery),
        function(e, t) {
            var i = !1;
            e(document).mouseup((function() {
                i = !1
            })),
            e.widget("ui.mouse", {
                version: "1.10.4",
                options: {
                    cancel: "input,textarea,button,select,option",
                    distance: 1,
                    delay: 0
                },
                _mouseInit: function() {
                    var t = this;
                    this.element.bind("mousedown." + this.widgetName, (function(e) {
                        return t._mouseDown(e)
                    })).bind("click." + this.widgetName, (function(i) {
                        if (!0 === e.data(i.target, t.widgetName + ".preventClickEvent"))
                            return e.removeData(i.target, t.widgetName + ".preventClickEvent"), i.stopImmediatePropagation(), !1
                    })),
                    this.started = !1
                },
                _mouseDestroy: function() {
                    this.element.unbind("." + this.widgetName),
                    this._mouseMoveDelegate && e(document).unbind("mousemove." + this.widgetName, this._mouseMoveDelegate).unbind("mouseup." + this.widgetName, this._mouseUpDelegate)
                },
                _mouseDown: function(t) {
                    if (!i) {
                        this._mouseStarted && this._mouseUp(t),
                        this._mouseDownEvent = t;
                        var o = this,
                            n = 1 === t.which,
                            s = !("string" != typeof this.options.cancel || !t.target.nodeName) && e(t.target).closest(this.options.cancel).length;
                        return !(n && !s && this._mouseCapture(t)) || (this.mouseDelayMet = !this.options.delay, this.mouseDelayMet || (this._mouseDelayTimer = setTimeout((function() {
                                o.mouseDelayMet = !0
                            }), this.options.delay)), this._mouseDistanceMet(t) && this._mouseDelayMet(t) && (this._mouseStarted = !1 !== this._mouseStart(t), !this._mouseStarted) ? (t.preventDefault(), !0) : (!0 === e.data(t.target, this.widgetName + ".preventClickEvent") && e.removeData(t.target, this.widgetName + ".preventClickEvent"), this._mouseMoveDelegate = function(e) {
                                return o._mouseMove(e)
                            }, this._mouseUpDelegate = function(e) {
                                return o._mouseUp(e)
                            }, e(document).bind("mousemove." + this.widgetName, this._mouseMoveDelegate).bind("mouseup." + this.widgetName, this._mouseUpDelegate), t.preventDefault(), i = !0, !0))
                    }
                },
                _mouseMove: function(t) {
                    return e.ui.ie && (!document.documentMode || document.documentMode < 9) && !t.button ? this._mouseUp(t) : this._mouseStarted ? (this._mouseDrag(t), t.preventDefault()) : (this._mouseDistanceMet(t) && this._mouseDelayMet(t) && (this._mouseStarted = !1 !== this._mouseStart(this._mouseDownEvent, t), this._mouseStarted ? this._mouseDrag(t) : this._mouseUp(t)), !this._mouseStarted)
                },
                _mouseUp: function(t) {
                    return e(document).unbind("mousemove." + this.widgetName, this._mouseMoveDelegate).unbind("mouseup." + this.widgetName, this._mouseUpDelegate), this._mouseStarted && (this._mouseStarted = !1, t.target === this._mouseDownEvent.target && e.data(t.target, this.widgetName + ".preventClickEvent", !0), this._mouseStop(t)), !1
                },
                _mouseDistanceMet: function(e) {
                    return Math.max(Math.abs(this._mouseDownEvent.pageX - e.pageX), Math.abs(this._mouseDownEvent.pageY - e.pageY)) >= this.options.distance
                },
                _mouseDelayMet: function() {
                    return this.mouseDelayMet
                },
                _mouseStart: function() {},
                _mouseDrag: function() {},
                _mouseStop: function() {},
                _mouseCapture: function() {
                    return !0
                }
            })
        }(jQuery),
        function(e, t) {
            e.ui = e.ui || {};
            var i,
                o = Math.max,
                n = Math.abs,
                s = Math.round,
                a = /left|center|right/,
                r = /top|center|bottom/,
                l = /[\+\-]\d+(\.[\d]+)?%?/,
                c = /^\w+/,
                d = /%$/,
                h = e.fn.position;
            function p(e, t, i) {
                return [parseFloat(e[0]) * (d.test(e[0]) ? t / 100 : 1), parseFloat(e[1]) * (d.test(e[1]) ? i / 100 : 1)]
            }
            function u(t, i) {
                return parseInt(e.css(t, i), 10) || 0
            }
            function f(t) {
                var i = t[0];
                return 9 === i.nodeType ? {
                    width: t.width(),
                    height: t.height(),
                    offset: {
                        top: 0,
                        left: 0
                    }
                } : e.isWindow(i) ? {
                    width: t.width(),
                    height: t.height(),
                    offset: {
                        top: t.scrollTop(),
                        left: t.scrollLeft()
                    }
                } : i.preventDefault ? {
                    width: 0,
                    height: 0,
                    offset: {
                        top: i.pageY,
                        left: i.pageX
                    }
                } : {
                    width: t.outerWidth(),
                    height: t.outerHeight(),
                    offset: t.offset()
                }
            }
            e.position = {
                scrollbarWidth: function() {
                    if (void 0 !== i)
                        return i;
                    var t,
                        o,
                        n = e("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),
                        s = n.children()[0];
                    return e("body").append(n), t = s.offsetWidth, n.css("overflow", "scroll"), t === (o = s.offsetWidth) && (o = n[0].clientWidth), n.remove(), i = t - o
                },
                getScrollInfo: function(t) {
                    var i = t.isWindow || t.isDocument ? "" : t.element.css("overflow-x"),
                        o = t.isWindow || t.isDocument ? "" : t.element.css("overflow-y"),
                        n = "scroll" === i || "auto" === i && t.width < t.element[0].scrollWidth;
                    return {
                        width: "scroll" === o || "auto" === o && t.height < t.element[0].scrollHeight ? e.position.scrollbarWidth() : 0,
                        height: n ? e.position.scrollbarWidth() : 0
                    }
                },
                getWithinInfo: function(t) {
                    var i = e(t || window),
                        o = e.isWindow(i[0]);
                    return {
                        element: i,
                        isWindow: o,
                        isDocument: !!i[0] && 9 === i[0].nodeType,
                        offset: i.offset() || {
                            left: 0,
                            top: 0
                        },
                        scrollLeft: i.scrollLeft(),
                        scrollTop: i.scrollTop(),
                        width: o ? i.width() : i.outerWidth(),
                        height: o ? i.height() : i.outerHeight()
                    }
                }
            },
            e.fn.position = function(t) {
                if (!t || !t.of)
                    return h.apply(this, arguments);
                t = e.extend({}, t);
                var i,
                    d,
                    m,
                    g,
                    v,
                    b,
                    y = e(t.of),
                    w = e.position.getWithinInfo(t.within),
                    x = e.position.getScrollInfo(w),
                    T = (t.collision || "flip").split(" "),
                    $ = {};
                return b = f(y), y[0].preventDefault && (t.at = "left top"), d = b.width, m = b.height, g = b.offset, v = e.extend({}, g), e.each(["my", "at"], (function() {
                    var e,
                        i,
                        o = (t[this] || "").split(" ");
                    1 === o.length && (o = a.test(o[0]) ? o.concat(["center"]) : r.test(o[0]) ? ["center"].concat(o) : ["center", "center"]),
                    o[0] = a.test(o[0]) ? o[0] : "center",
                    o[1] = r.test(o[1]) ? o[1] : "center",
                    e = l.exec(o[0]),
                    i = l.exec(o[1]),
                    $[this] = [e ? e[0] : 0, i ? i[0] : 0],
                    t[this] = [c.exec(o[0])[0], c.exec(o[1])[0]]
                })), 1 === T.length && (T[1] = T[0]), "right" === t.at[0] ? v.left += d : "center" === t.at[0] && (v.left += d / 2), "bottom" === t.at[1] ? v.top += m : "center" === t.at[1] && (v.top += m / 2), i = p($.at, d, m), v.left += i[0], v.top += i[1], this.each((function() {
                    var a,
                        r,
                        l = e(this),
                        c = l.outerWidth(),
                        h = l.outerHeight(),
                        f = u(this, "marginLeft"),
                        b = u(this, "marginTop"),
                        C = c + f + u(this, "marginRight") + x.width,
                        k = h + b + u(this, "marginBottom") + x.height,
                        S = e.extend({}, v),
                        E = p($.my, l.outerWidth(), l.outerHeight());
                    "right" === t.my[0] ? S.left -= c : "center" === t.my[0] && (S.left -= c / 2),
                    "bottom" === t.my[1] ? S.top -= h : "center" === t.my[1] && (S.top -= h / 2),
                    S.left += E[0],
                    S.top += E[1],
                    e.support.offsetFractions || (S.left = s(S.left), S.top = s(S.top)),
                    a = {
                        marginLeft: f,
                        marginTop: b
                    },
                    e.each(["left", "top"], (function(o, n) {
                        e.ui.position[T[o]] && e.ui.position[T[o]][n](S, {
                            targetWidth: d,
                            targetHeight: m,
                            elemWidth: c,
                            elemHeight: h,
                            collisionPosition: a,
                            collisionWidth: C,
                            collisionHeight: k,
                            offset: [i[0] + E[0], i[1] + E[1]],
                            my: t.my,
                            at: t.at,
                            within: w,
                            elem: l
                        })
                    })),
                    t.using && (r = function(e) {
                        var i = g.left - S.left,
                            s = i + d - c,
                            a = g.top - S.top,
                            r = a + m - h,
                            p = {
                                target: {
                                    element: y,
                                    left: g.left,
                                    top: g.top,
                                    width: d,
                                    height: m
                                },
                                element: {
                                    element: l,
                                    left: S.left,
                                    top: S.top,
                                    width: c,
                                    height: h
                                },
                                horizontal: s < 0 ? "left" : i > 0 ? "right" : "center",
                                vertical: r < 0 ? "top" : a > 0 ? "bottom" : "middle"
                            };
                        d < c && n(i + s) < d && (p.horizontal = "center"),
                        m < h && n(a + r) < m && (p.vertical = "middle"),
                        o(n(i), n(s)) > o(n(a), n(r)) ? p.important = "horizontal" : p.important = "vertical",
                        t.using.call(this, e, p)
                    }),
                    l.offset(e.extend(S, {
                        using: r
                    }))
                }))
            },
            e.ui.position = {
                fit: {
                    left: function(e, t) {
                        var i,
                            n = t.within,
                            s = n.isWindow ? n.scrollLeft : n.offset.left,
                            a = n.width,
                            r = e.left - t.collisionPosition.marginLeft,
                            l = s - r,
                            c = r + t.collisionWidth - a - s;
                        t.collisionWidth > a ? l > 0 && c <= 0 ? (i = e.left + l + t.collisionWidth - a - s, e.left += l - i) : e.left = c > 0 && l <= 0 ? s : l > c ? s + a - t.collisionWidth : s : l > 0 ? e.left += l : c > 0 ? e.left -= c : e.left = o(e.left - r, e.left)
                    },
                    top: function(e, t) {
                        var i,
                            n = t.within,
                            s = n.isWindow ? n.scrollTop : n.offset.top,
                            a = t.within.height,
                            r = e.top - t.collisionPosition.marginTop,
                            l = s - r,
                            c = r + t.collisionHeight - a - s;
                        t.collisionHeight > a ? l > 0 && c <= 0 ? (i = e.top + l + t.collisionHeight - a - s, e.top += l - i) : e.top = c > 0 && l <= 0 ? s : l > c ? s + a - t.collisionHeight : s : l > 0 ? e.top += l : c > 0 ? e.top -= c : e.top = o(e.top - r, e.top)
                    }
                },
                flip: {
                    left: function(e, t) {
                        var i,
                            o,
                            s = t.within,
                            a = s.offset.left + s.scrollLeft,
                            r = s.width,
                            l = s.isWindow ? s.scrollLeft : s.offset.left,
                            c = e.left - t.collisionPosition.marginLeft,
                            d = c - l,
                            h = c + t.collisionWidth - r - l,
                            p = "left" === t.my[0] ? -t.elemWidth : "right" === t.my[0] ? t.elemWidth : 0,
                            u = "left" === t.at[0] ? t.targetWidth : "right" === t.at[0] ? -t.targetWidth : 0,
                            f = -2 * t.offset[0];
                        d < 0 ? ((i = e.left + p + u + f + t.collisionWidth - r - a) < 0 || i < n(d)) && (e.left += p + u + f) : h > 0 && ((o = e.left - t.collisionPosition.marginLeft + p + u + f - l) > 0 || n(o) < h) && (e.left += p + u + f)
                    },
                    top: function(e, t) {
                        var i,
                            o,
                            s = t.within,
                            a = s.offset.top + s.scrollTop,
                            r = s.height,
                            l = s.isWindow ? s.scrollTop : s.offset.top,
                            c = e.top - t.collisionPosition.marginTop,
                            d = c - l,
                            h = c + t.collisionHeight - r - l,
                            p = "top" === t.my[1] ? -t.elemHeight : "bottom" === t.my[1] ? t.elemHeight : 0,
                            u = "top" === t.at[1] ? t.targetHeight : "bottom" === t.at[1] ? -t.targetHeight : 0,
                            f = -2 * t.offset[1];
                        d < 0 ? (o = e.top + p + u + f + t.collisionHeight - r - a, e.top + p + u + f > d && (o < 0 || o < n(d)) && (e.top += p + u + f)) : h > 0 && (i = e.top - t.collisionPosition.marginTop + p + u + f - l, e.top + p + u + f > h && (i > 0 || n(i) < h) && (e.top += p + u + f))
                    }
                },
                flipfit: {
                    left: function() {
                        e.ui.position.flip.left.apply(this, arguments),
                        e.ui.position.fit.left.apply(this, arguments)
                    },
                    top: function() {
                        e.ui.position.flip.top.apply(this, arguments),
                        e.ui.position.fit.top.apply(this, arguments)
                    }
                }
            },
            function() {
                var t,
                    i,
                    o,
                    n,
                    s,
                    a = document.getElementsByTagName("body")[0],
                    r = document.createElement("div");
                for (s in t = document.createElement(a ? "div" : "body"), o = {
                    visibility: "hidden",
                    width: 0,
                    height: 0,
                    border: 0,
                    margin: 0,
                    background: "none"
                }, a && e.extend(o, {
                    position: "absolute",
                    left: "-1000px",
                    top: "-1000px"
                }), o)
                    t.style[s] = o[s];
                t.appendChild(r),
                (i = a || document.documentElement).insertBefore(t, i.firstChild),
                r.style.cssText = "position: absolute; left: 10.7432222px;",
                n = e(r).offset().left,
                e.support.offsetFractions = n > 10 && n < 11,
                t.innerHTML = "",
                i.removeChild(t)
            }()
        }(jQuery),
        function(e, t) {
            e.widget("ui.draggable", e.ui.mouse, {
                version: "1.10.4",
                widgetEventPrefix: "drag",
                options: {
                    addClasses: !0,
                    appendTo: "parent",
                    axis: !1,
                    connectToSortable: !1,
                    containment: !1,
                    cursor: "auto",
                    cursorAt: !1,
                    grid: !1,
                    handle: !1,
                    helper: "original",
                    iframeFix: !1,
                    opacity: !1,
                    refreshPositions: !1,
                    revert: !1,
                    revertDuration: 500,
                    scope: "default",
                    scroll: !0,
                    scrollSensitivity: 20,
                    scrollSpeed: 20,
                    snap: !1,
                    snapMode: "both",
                    snapTolerance: 20,
                    stack: !1,
                    zIndex: !1,
                    drag: null,
                    start: null,
                    stop: null
                },
                _create: function() {
                    "original" !== this.options.helper || /^(?:r|a|f)/.test(this.element.css("position")) || (this.element[0].style.position = "relative"),
                    this.options.addClasses && this.element.addClass("ui-draggable"),
                    this.options.disabled && this.element.addClass("ui-draggable-disabled"),
                    this._mouseInit()
                },
                _destroy: function() {
                    this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),
                    this._mouseDestroy()
                },
                _mouseCapture: function(t) {
                    var i = this.options;
                    return !(this.helper || i.disabled || e(t.target).closest(".ui-resizable-handle").length > 0) && (this.handle = this._getHandle(t), !!this.handle && (e(!0 === i.iframeFix ? "iframe" : i.iframeFix).each((function() {
                            e("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({
                                width: this.offsetWidth + "px",
                                height: this.offsetHeight + "px",
                                position: "absolute",
                                opacity: "0.001",
                                zIndex: 1e3
                            }).css(e(this).offset()).appendTo("body")
                        })), !0))
                },
                _mouseStart: function(t) {
                    var i = this.options;
                    return this.helper = this._createHelper(t), this.helper.addClass("ui-draggable-dragging"), this._cacheHelperProportions(), e.ui.ddmanager && (e.ui.ddmanager.current = this), this._cacheMargins(), this.cssPosition = this.helper.css("position"), this.scrollParent = this.helper.scrollParent(), this.offsetParent = this.helper.offsetParent(), this.offsetParentCssPosition = this.offsetParent.css("position"), this.offset = this.positionAbs = this.element.offset(), this.offset = {
                        top: this.offset.top - this.margins.top,
                        left: this.offset.left - this.margins.left
                    }, this.offset.scroll = !1, e.extend(this.offset, {
                        click: {
                            left: t.pageX - this.offset.left,
                            top: t.pageY - this.offset.top
                        },
                        parent: this._getParentOffset(),
                        relative: this._getRelativeOffset()
                    }), this.originalPosition = this.position = this._generatePosition(t), this.originalPageX = t.pageX, this.originalPageY = t.pageY, i.cursorAt && this._adjustOffsetFromHelper(i.cursorAt), this._setContainment(), !1 === this._trigger("start", t) ? (this._clear(), !1) : (this._cacheHelperProportions(), e.ui.ddmanager && !i.dropBehaviour && e.ui.ddmanager.prepareOffsets(this, t), this._mouseDrag(t, !0), e.ui.ddmanager && e.ui.ddmanager.dragStart(this, t), !0)
                },
                _mouseDrag: function(t, i) {
                    if ("fixed" === this.offsetParentCssPosition && (this.offset.parent = this._getParentOffset()), this.position = this._generatePosition(t), this.positionAbs = this._convertPositionTo("absolute"), !i) {
                        var o = this._uiHash();
                        if (!1 === this._trigger("drag", t, o))
                            return this._mouseUp({}), !1;
                        this.position = o.position
                    }
                    return this.options.axis && "y" === this.options.axis || (this.helper[0].style.left = this.position.left + "px"), this.options.axis && "x" === this.options.axis || (this.helper[0].style.top = this.position.top + "px"), e.ui.ddmanager && e.ui.ddmanager.drag(this, t), !1
                },
                _mouseStop: function(t) {
                    var i = this,
                        o = !1;
                    return e.ui.ddmanager && !this.options.dropBehaviour && (o = e.ui.ddmanager.drop(this, t)), this.dropped && (o = this.dropped, this.dropped = !1), !("original" === this.options.helper && !e.contains(this.element[0].ownerDocument, this.element[0])) && ("invalid" === this.options.revert && !o || "valid" === this.options.revert && o || !0 === this.options.revert || e.isFunction(this.options.revert) && this.options.revert.call(this.element, o) ? e(this.helper).animate(this.originalPosition, parseInt(this.options.revertDuration, 10), (function() {
                        !1 !== i._trigger("stop", t) && i._clear()
                    })) : !1 !== this._trigger("stop", t) && this._clear(), !1)
                },
                _mouseUp: function(t) {
                    return e("div.ui-draggable-iframeFix").each((function() {
                        this.parentNode.removeChild(this)
                    })), e.ui.ddmanager && e.ui.ddmanager.dragStop(this, t), e.ui.mouse.prototype._mouseUp.call(this, t)
                },
                cancel: function() {
                    return this.helper.is(".ui-draggable-dragging") ? this._mouseUp({}) : this._clear(), this
                },
                _getHandle: function(t) {
                    return !this.options.handle || !!e(t.target).closest(this.element.find(this.options.handle)).length
                },
                _createHelper: function(t) {
                    var i = this.options,
                        o = e.isFunction(i.helper) ? e(i.helper.apply(this.element[0], [t])) : "clone" === i.helper ? this.element.clone().removeAttr("id") : this.element;
                    return o.parents("body").length || o.appendTo("parent" === i.appendTo ? this.element[0].parentNode : i.appendTo), o[0] === this.element[0] || /(fixed|absolute)/.test(o.css("position")) || o.css("position", "absolute"), o
                },
                _adjustOffsetFromHelper: function(t) {
                    "string" == typeof t && (t = t.split(" ")),
                    e.isArray(t) && (t = {
                        left: +t[0],
                        top: +t[1] || 0
                    }),
                    "left" in t && (this.offset.click.left = t.left + this.margins.left),
                    "right" in t && (this.offset.click.left = this.helperProportions.width - t.right + this.margins.left),
                    "top" in t && (this.offset.click.top = t.top + this.margins.top),
                    "bottom" in t && (this.offset.click.top = this.helperProportions.height - t.bottom + this.margins.top)
                },
                _getParentOffset: function() {
                    var t = this.offsetParent.offset();
                    return "absolute" === this.cssPosition && this.scrollParent[0] !== document && e.contains(this.scrollParent[0], this.offsetParent[0]) && (t.left += this.scrollParent.scrollLeft(), t.top += this.scrollParent.scrollTop()), (this.offsetParent[0] === document.body || this.offsetParent[0].tagName && "html" === this.offsetParent[0].tagName.toLowerCase() && e.ui.ie) && (t = {
                        top: 0,
                        left: 0
                    }), {
                        top: t.top + (parseInt(this.offsetParent.css("borderTopWidth"), 10) || 0),
                        left: t.left + (parseInt(this.offsetParent.css("borderLeftWidth"), 10) || 0)
                    }
                },
                _getRelativeOffset: function() {
                    if ("relative" === this.cssPosition) {
                        var e = this.element.position();
                        return {
                            top: e.top - (parseInt(this.helper.css("top"), 10) || 0) + this.scrollParent.scrollTop(),
                            left: e.left - (parseInt(this.helper.css("left"), 10) || 0) + this.scrollParent.scrollLeft()
                        }
                    }
                    return {
                        top: 0,
                        left: 0
                    }
                },
                _cacheMargins: function() {
                    this.margins = {
                        left: parseInt(this.element.css("marginLeft"), 10) || 0,
                        top: parseInt(this.element.css("marginTop"), 10) || 0,
                        right: parseInt(this.element.css("marginRight"), 10) || 0,
                        bottom: parseInt(this.element.css("marginBottom"), 10) || 0
                    }
                },
                _cacheHelperProportions: function() {
                    this.helperProportions = {
                        width: this.helper.outerWidth(),
                        height: this.helper.outerHeight()
                    }
                },
                _setContainment: function() {
                    var t,
                        i,
                        o,
                        n = this.options;
                    n.containment ? "window" !== n.containment ? "document" !== n.containment ? n.containment.constructor !== Array ? ("parent" === n.containment && (n.containment = this.helper[0].parentNode), (o = (i = e(n.containment))[0]) && (t = "hidden" !== i.css("overflow"), this.containment = [(parseInt(i.css("borderLeftWidth"), 10) || 0) + (parseInt(i.css("paddingLeft"), 10) || 0), (parseInt(i.css("borderTopWidth"), 10) || 0) + (parseInt(i.css("paddingTop"), 10) || 0), (t ? Math.max(o.scrollWidth, o.offsetWidth) : o.offsetWidth) - (parseInt(i.css("borderRightWidth"), 10) || 0) - (parseInt(i.css("paddingRight"), 10) || 0) - this.helperProportions.width - this.margins.left - this.margins.right, (t ? Math.max(o.scrollHeight, o.offsetHeight) : o.offsetHeight) - (parseInt(i.css("borderBottomWidth"), 10) || 0) - (parseInt(i.css("paddingBottom"), 10) || 0) - this.helperProportions.height - this.margins.top - this.margins.bottom], this.relative_container = i)) : this.containment = n.containment : this.containment = [0, 0, e(document).width() - this.helperProportions.width - this.margins.left, (e(document).height() || document.body.parentNode.scrollHeight) - this.helperProportions.height - this.margins.top] : this.containment = [e(window).scrollLeft() - this.offset.relative.left - this.offset.parent.left, e(window).scrollTop() - this.offset.relative.top - this.offset.parent.top, e(window).scrollLeft() + e(window).width() - this.helperProportions.width - this.margins.left, e(window).scrollTop() + (e(window).height() || document.body.parentNode.scrollHeight) - this.helperProportions.height - this.margins.top] : this.containment = null
                },
                _convertPositionTo: function(t, i) {
                    i || (i = this.position);
                    var o = "absolute" === t ? 1 : -1,
                        n = "absolute" !== this.cssPosition || this.scrollParent[0] !== document && e.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent;
                    return this.offset.scroll || (this.offset.scroll = {
                        top: n.scrollTop(),
                        left: n.scrollLeft()
                    }), {
                        top: i.top + this.offset.relative.top * o + this.offset.parent.top * o - ("fixed" === this.cssPosition ? -this.scrollParent.scrollTop() : this.offset.scroll.top) * o,
                        left: i.left + this.offset.relative.left * o + this.offset.parent.left * o - ("fixed" === this.cssPosition ? -this.scrollParent.scrollLeft() : this.offset.scroll.left) * o
                    }
                },
                _generatePosition: function(t) {
                    var i,
                        o,
                        n,
                        s,
                        a = this.options,
                        r = "absolute" !== this.cssPosition || this.scrollParent[0] !== document && e.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent,
                        l = t.pageX,
                        c = t.pageY;
                    return this.offset.scroll || (this.offset.scroll = {
                        top: r.scrollTop(),
                        left: r.scrollLeft()
                    }), this.originalPosition && (this.containment && (this.relative_container ? (o = this.relative_container.offset(), i = [this.containment[0] + o.left, this.containment[1] + o.top, this.containment[2] + o.left, this.containment[3] + o.top]) : i = this.containment, t.pageX - this.offset.click.left < i[0] && (l = i[0] + this.offset.click.left), t.pageY - this.offset.click.top < i[1] && (c = i[1] + this.offset.click.top), t.pageX - this.offset.click.left > i[2] && (l = i[2] + this.offset.click.left), t.pageY - this.offset.click.top > i[3] && (c = i[3] + this.offset.click.top)), a.grid && (n = a.grid[1] ? this.originalPageY + Math.round((c - this.originalPageY) / a.grid[1]) * a.grid[1] : this.originalPageY, c = i ? n - this.offset.click.top >= i[1] || n - this.offset.click.top > i[3] ? n : n - this.offset.click.top >= i[1] ? n - a.grid[1] : n + a.grid[1] : n, s = a.grid[0] ? this.originalPageX + Math.round((l - this.originalPageX) / a.grid[0]) * a.grid[0] : this.originalPageX, l = i ? s - this.offset.click.left >= i[0] || s - this.offset.click.left > i[2] ? s : s - this.offset.click.left >= i[0] ? s - a.grid[0] : s + a.grid[0] : s)), {
                        top: c - this.offset.click.top - this.offset.relative.top - this.offset.parent.top + ("fixed" === this.cssPosition ? -this.scrollParent.scrollTop() : this.offset.scroll.top),
                        left: l - this.offset.click.left - this.offset.relative.left - this.offset.parent.left + ("fixed" === this.cssPosition ? -this.scrollParent.scrollLeft() : this.offset.scroll.left)
                    }
                },
                _clear: function() {
                    this.helper.removeClass("ui-draggable-dragging"),
                    this.helper[0] === this.element[0] || this.cancelHelperRemoval || this.helper.remove(),
                    this.helper = null,
                    this.cancelHelperRemoval = !1
                },
                _trigger: function(t, i, o) {
                    return o = o || this._uiHash(), e.ui.plugin.call(this, t, [i, o]), "drag" === t && (this.positionAbs = this._convertPositionTo("absolute")), e.Widget.prototype._trigger.call(this, t, i, o)
                },
                plugins: {},
                _uiHash: function() {
                    return {
                        helper: this.helper,
                        position: this.position,
                        originalPosition: this.originalPosition,
                        offset: this.positionAbs
                    }
                }
            }),
            e.ui.plugin.add("draggable", "connectToSortable", {
                start: function(t, i) {
                    var o = e(this).data("ui-draggable"),
                        n = o.options,
                        s = e.extend({}, i, {
                            item: o.element
                        });
                    o.sortables = [],
                    e(n.connectToSortable).each((function() {
                        var i = e.data(this, "ui-sortable");
                        i && !i.options.disabled && (o.sortables.push({
                            instance: i,
                            shouldRevert: i.options.revert
                        }), i.refreshPositions(), i._trigger("activate", t, s))
                    }))
                },
                stop: function(t, i) {
                    var o = e(this).data("ui-draggable"),
                        n = e.extend({}, i, {
                            item: o.element
                        });
                    e.each(o.sortables, (function() {
                        this.instance.isOver ? (this.instance.isOver = 0, o.cancelHelperRemoval = !0, this.instance.cancelHelperRemoval = !1, this.shouldRevert && (this.instance.options.revert = this.shouldRevert), this.instance._mouseStop(t), this.instance.options.helper = this.instance.options._helper, "original" === o.options.helper && this.instance.currentItem.css({
                            top: "auto",
                            left: "auto"
                        })) : (this.instance.cancelHelperRemoval = !1, this.instance._trigger("deactivate", t, n))
                    }))
                },
                drag: function(t, i) {
                    var o = e(this).data("ui-draggable"),
                        n = this;
                    e.each(o.sortables, (function() {
                        var s = !1,
                            a = this;
                        this.instance.positionAbs = o.positionAbs,
                        this.instance.helperProportions = o.helperProportions,
                        this.instance.offset.click = o.offset.click,
                        this.instance._intersectsWith(this.instance.containerCache) && (s = !0, e.each(o.sortables, (function() {
                            return this.instance.positionAbs = o.positionAbs, this.instance.helperProportions = o.helperProportions, this.instance.offset.click = o.offset.click, this !== a && this.instance._intersectsWith(this.instance.containerCache) && e.contains(a.instance.element[0], this.instance.element[0]) && (s = !1), s
                        }))),
                        s ? (this.instance.isOver || (this.instance.isOver = 1, this.instance.currentItem = e(n).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item", !0), this.instance.options._helper = this.instance.options.helper, this.instance.options.helper = function() {
                            return i.helper[0]
                        }, t.target = this.instance.currentItem[0], this.instance._mouseCapture(t, !0), this.instance._mouseStart(t, !0, !0), this.instance.offset.click.top = o.offset.click.top, this.instance.offset.click.left = o.offset.click.left, this.instance.offset.parent.left -= o.offset.parent.left - this.instance.offset.parent.left, this.instance.offset.parent.top -= o.offset.parent.top - this.instance.offset.parent.top, o._trigger("toSortable", t), o.dropped = this.instance.element, o.currentItem = o.element, this.instance.fromOutside = o), this.instance.currentItem && this.instance._mouseDrag(t)) : this.instance.isOver && (this.instance.isOver = 0, this.instance.cancelHelperRemoval = !0, this.instance.options.revert = !1, this.instance._trigger("out", t, this.instance._uiHash(this.instance)), this.instance._mouseStop(t, !0), this.instance.options.helper = this.instance.options._helper, this.instance.currentItem.remove(), this.instance.placeholder && this.instance.placeholder.remove(), o._trigger("fromSortable", t), o.dropped = !1)
                    }))
                }
            }),
            e.ui.plugin.add("draggable", "cursor", {
                start: function() {
                    var t = e("body"),
                        i = e(this).data("ui-draggable").options;
                    t.css("cursor") && (i._cursor = t.css("cursor")),
                    t.css("cursor", i.cursor)
                },
                stop: function() {
                    var t = e(this).data("ui-draggable").options;
                    t._cursor && e("body").css("cursor", t._cursor)
                }
            }),
            e.ui.plugin.add("draggable", "opacity", {
                start: function(t, i) {
                    var o = e(i.helper),
                        n = e(this).data("ui-draggable").options;
                    o.css("opacity") && (n._opacity = o.css("opacity")),
                    o.css("opacity", n.opacity)
                },
                stop: function(t, i) {
                    var o = e(this).data("ui-draggable").options;
                    o._opacity && e(i.helper).css("opacity", o._opacity)
                }
            }),
            e.ui.plugin.add("draggable", "scroll", {
                start: function() {
                    var t = e(this).data("ui-draggable");
                    t.scrollParent[0] !== document && "HTML" !== t.scrollParent[0].tagName && (t.overflowOffset = t.scrollParent.offset())
                },
                drag: function(t) {
                    var i = e(this).data("ui-draggable"),
                        o = i.options,
                        n = !1;
                    i.scrollParent[0] !== document && "HTML" !== i.scrollParent[0].tagName ? (o.axis && "x" === o.axis || (i.overflowOffset.top + i.scrollParent[0].offsetHeight - t.pageY < o.scrollSensitivity ? i.scrollParent[0].scrollTop = n = i.scrollParent[0].scrollTop + o.scrollSpeed : t.pageY - i.overflowOffset.top < o.scrollSensitivity && (i.scrollParent[0].scrollTop = n = i.scrollParent[0].scrollTop - o.scrollSpeed)), o.axis && "y" === o.axis || (i.overflowOffset.left + i.scrollParent[0].offsetWidth - t.pageX < o.scrollSensitivity ? i.scrollParent[0].scrollLeft = n = i.scrollParent[0].scrollLeft + o.scrollSpeed : t.pageX - i.overflowOffset.left < o.scrollSensitivity && (i.scrollParent[0].scrollLeft = n = i.scrollParent[0].scrollLeft - o.scrollSpeed))) : (o.axis && "x" === o.axis || (t.pageY - e(document).scrollTop() < o.scrollSensitivity ? n = e(document).scrollTop(e(document).scrollTop() - o.scrollSpeed) : e(window).height() - (t.pageY - e(document).scrollTop()) < o.scrollSensitivity && (n = e(document).scrollTop(e(document).scrollTop() + o.scrollSpeed))), o.axis && "y" === o.axis || (t.pageX - e(document).scrollLeft() < o.scrollSensitivity ? n = e(document).scrollLeft(e(document).scrollLeft() - o.scrollSpeed) : e(window).width() - (t.pageX - e(document).scrollLeft()) < o.scrollSensitivity && (n = e(document).scrollLeft(e(document).scrollLeft() + o.scrollSpeed)))),
                    !1 !== n && e.ui.ddmanager && !o.dropBehaviour && e.ui.ddmanager.prepareOffsets(i, t)
                }
            }),
            e.ui.plugin.add("draggable", "snap", {
                start: function() {
                    var t = e(this).data("ui-draggable"),
                        i = t.options;
                    t.snapElements = [],
                    e(i.snap.constructor !== String ? i.snap.items || ":data(ui-draggable)" : i.snap).each((function() {
                        var i = e(this),
                            o = i.offset();
                        this !== t.element[0] && t.snapElements.push({
                            item: this,
                            width: i.outerWidth(),
                            height: i.outerHeight(),
                            top: o.top,
                            left: o.left
                        })
                    }))
                },
                drag: function(t, i) {
                    var o,
                        n,
                        s,
                        a,
                        r,
                        l,
                        c,
                        d,
                        h,
                        p,
                        u = e(this).data("ui-draggable"),
                        f = u.options,
                        m = f.snapTolerance,
                        g = i.offset.left,
                        v = g + u.helperProportions.width,
                        b = i.offset.top,
                        y = b + u.helperProportions.height;
                    for (h = u.snapElements.length - 1; h >= 0; h--)
                        l = (r = u.snapElements[h].left) + u.snapElements[h].width,
                        d = (c = u.snapElements[h].top) + u.snapElements[h].height,
                        v < r - m || g > l + m || y < c - m || b > d + m || !e.contains(u.snapElements[h].item.ownerDocument, u.snapElements[h].item) ? (u.snapElements[h].snapping && u.options.snap.release && u.options.snap.release.call(u.element, t, e.extend(u._uiHash(), {
                            snapItem: u.snapElements[h].item
                        })), u.snapElements[h].snapping = !1) : ("inner" !== f.snapMode && (o = Math.abs(c - y) <= m, n = Math.abs(d - b) <= m, s = Math.abs(r - v) <= m, a = Math.abs(l - g) <= m, o && (i.position.top = u._convertPositionTo("relative", {
                            top: c - u.helperProportions.height,
                            left: 0
                        }).top - u.margins.top), n && (i.position.top = u._convertPositionTo("relative", {
                            top: d,
                            left: 0
                        }).top - u.margins.top), s && (i.position.left = u._convertPositionTo("relative", {
                            top: 0,
                            left: r - u.helperProportions.width
                        }).left - u.margins.left), a && (i.position.left = u._convertPositionTo("relative", {
                            top: 0,
                            left: l
                        }).left - u.margins.left)), p = o || n || s || a, "outer" !== f.snapMode && (o = Math.abs(c - b) <= m, n = Math.abs(d - y) <= m, s = Math.abs(r - g) <= m, a = Math.abs(l - v) <= m, o && (i.position.top = u._convertPositionTo("relative", {
                            top: c,
                            left: 0
                        }).top - u.margins.top), n && (i.position.top = u._convertPositionTo("relative", {
                            top: d - u.helperProportions.height,
                            left: 0
                        }).top - u.margins.top), s && (i.position.left = u._convertPositionTo("relative", {
                            top: 0,
                            left: r
                        }).left - u.margins.left), a && (i.position.left = u._convertPositionTo("relative", {
                            top: 0,
                            left: l - u.helperProportions.width
                        }).left - u.margins.left)), !u.snapElements[h].snapping && (o || n || s || a || p) && u.options.snap.snap && u.options.snap.snap.call(u.element, t, e.extend(u._uiHash(), {
                            snapItem: u.snapElements[h].item
                        })), u.snapElements[h].snapping = o || n || s || a || p)
                }
            }),
            e.ui.plugin.add("draggable", "stack", {
                start: function() {
                    var t,
                        i = this.data("ui-draggable").options,
                        o = e.makeArray(e(i.stack)).sort((function(t, i) {
                            return (parseInt(e(t).css("zIndex"), 10) || 0) - (parseInt(e(i).css("zIndex"), 10) || 0)
                        }));
                    o.length && (t = parseInt(e(o[0]).css("zIndex"), 10) || 0, e(o).each((function(i) {
                        e(this).css("zIndex", t + i)
                    })), this.css("zIndex", t + o.length))
                }
            }),
            e.ui.plugin.add("draggable", "zIndex", {
                start: function(t, i) {
                    var o = e(i.helper),
                        n = e(this).data("ui-draggable").options;
                    o.css("zIndex") && (n._zIndex = o.css("zIndex")),
                    o.css("zIndex", n.zIndex)
                },
                stop: function(t, i) {
                    var o = e(this).data("ui-draggable").options;
                    o._zIndex && e(i.helper).css("zIndex", o._zIndex)
                }
            })
        }(jQuery),
        function(e, t) {
            function i(e, t, i) {
                return e > t && e < t + i
            }
            e.widget("ui.droppable", {
                version: "1.10.4",
                widgetEventPrefix: "drop",
                options: {
                    accept: "*",
                    activeClass: !1,
                    addClasses: !0,
                    greedy: !1,
                    hoverClass: !1,
                    scope: "default",
                    tolerance: "intersect",
                    activate: null,
                    deactivate: null,
                    drop: null,
                    out: null,
                    over: null
                },
                _create: function() {
                    var t,
                        i = this.options,
                        o = i.accept;
                    this.isover = !1,
                    this.isout = !0,
                    this.accept = e.isFunction(o) ? o : function(e) {
                        return e.is(o)
                    },
                    this.proportions = function() {
                        if (!arguments.length)
                            return t || (t = {
                                    width: this.element[0].offsetWidth,
                                    height: this.element[0].offsetHeight
                                });
                        t = arguments[0]
                    },
                    e.ui.ddmanager.droppables[i.scope] = e.ui.ddmanager.droppables[i.scope] || [],
                    e.ui.ddmanager.droppables[i.scope].push(this),
                    i.addClasses && this.element.addClass("ui-droppable")
                },
                _destroy: function() {
                    for (var t = 0, i = e.ui.ddmanager.droppables[this.options.scope]; t < i.length; t++)
                        i[t] === this && i.splice(t, 1);
                    this.element.removeClass("ui-droppable ui-droppable-disabled")
                },
                _setOption: function(t, i) {
                    "accept" === t && (this.accept = e.isFunction(i) ? i : function(e) {
                        return e.is(i)
                    }),
                    e.Widget.prototype._setOption.apply(this, arguments)
                },
                _activate: function(t) {
                    var i = e.ui.ddmanager.current;
                    this.options.activeClass && this.element.addClass(this.options.activeClass),
                    i && this._trigger("activate", t, this.ui(i))
                },
                _deactivate: function(t) {
                    var i = e.ui.ddmanager.current;
                    this.options.activeClass && this.element.removeClass(this.options.activeClass),
                    i && this._trigger("deactivate", t, this.ui(i))
                },
                _over: function(t) {
                    var i = e.ui.ddmanager.current;
                    i && (i.currentItem || i.element)[0] !== this.element[0] && this.accept.call(this.element[0], i.currentItem || i.element) && (this.options.hoverClass && this.element.addClass(this.options.hoverClass), this._trigger("over", t, this.ui(i)))
                },
                _out: function(t) {
                    var i = e.ui.ddmanager.current;
                    i && (i.currentItem || i.element)[0] !== this.element[0] && this.accept.call(this.element[0], i.currentItem || i.element) && (this.options.hoverClass && this.element.removeClass(this.options.hoverClass), this._trigger("out", t, this.ui(i)))
                },
                _drop: function(t, i) {
                    var o = i || e.ui.ddmanager.current,
                        n = !1;
                    return !(!o || (o.currentItem || o.element)[0] === this.element[0]) && (this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each((function() {
                            var t = e.data(this, "ui-droppable");
                            if (t.options.greedy && !t.options.disabled && t.options.scope === o.options.scope && t.accept.call(t.element[0], o.currentItem || o.element) && e.ui.intersect(o, e.extend(t, {
                                offset: t.element.offset()
                            }), t.options.tolerance))
                                return n = !0, !1
                        })), !n && (!!this.accept.call(this.element[0], o.currentItem || o.element) && (this.options.activeClass && this.element.removeClass(this.options.activeClass), this.options.hoverClass && this.element.removeClass(this.options.hoverClass), this._trigger("drop", t, this.ui(o)), this.element)))
                },
                ui: function(e) {
                    return {
                        draggable: e.currentItem || e.element,
                        helper: e.helper,
                        position: e.position,
                        offset: e.positionAbs
                    }
                }
            }),
            e.ui.intersect = function(e, t, o) {
                if (!t.offset)
                    return !1;
                var n,
                    s = (e.positionAbs || e.position.absolute).left,
                    a = (e.positionAbs || e.position.absolute).top,
                    r = s + e.helperProportions.width,
                    l = a + e.helperProportions.height,
                    c = t.offset.left,
                    d = t.offset.top,
                    h = c + t.proportions().width,
                    p = d + t.proportions().height;
                switch (o) {
                case "fit":
                    return c <= s && r <= h && d <= a && l <= p;
                case "intersect":
                    return c < s + e.helperProportions.width / 2 && r - e.helperProportions.width / 2 < h && d < a + e.helperProportions.height / 2 && l - e.helperProportions.height / 2 < p;
                case "pointer":
                    return n = (e.positionAbs || e.position.absolute).left + (e.clickOffset || e.offset.click).left, i((e.positionAbs || e.position.absolute).top + (e.clickOffset || e.offset.click).top, d, t.proportions().height) && i(n, c, t.proportions().width);
                case "touch":
                    return (a >= d && a <= p || l >= d && l <= p || a < d && l > p) && (s >= c && s <= h || r >= c && r <= h || s < c && r > h);
                default:
                    return !1
                }
            },
            e.ui.ddmanager = {
                current: null,
                droppables: {
                    default: []
                },
                prepareOffsets: function(t, i) {
                    var o,
                        n,
                        s = e.ui.ddmanager.droppables[t.options.scope] || [],
                        a = i ? i.type : null,
                        r = (t.currentItem || t.element).find(":data(ui-droppable)").addBack();
                    e:
                    for (o = 0; o < s.length; o++)
                        if (!(s[o].options.disabled || t && !s[o].accept.call(s[o].element[0], t.currentItem || t.element))) {
                            for (n = 0; n < r.length; n++)
                                if (r[n] === s[o].element[0]) {
                                    s[o].proportions().height = 0;
                                    continue e
                                }
                            s[o].visible = "none" !== s[o].element.css("display"),
                            s[o].visible && ("mousedown" === a && s[o]._activate.call(s[o], i), s[o].offset = s[o].element.offset(), s[o].proportions({
                                width: s[o].element[0].offsetWidth,
                                height: s[o].element[0].offsetHeight
                            }))
                        }
                },
                drop: function(t, i) {
                    var o = !1;
                    return e.each((e.ui.ddmanager.droppables[t.options.scope] || []).slice(), (function() {
                        this.options && (!this.options.disabled && this.visible && e.ui.intersect(t, this, this.options.tolerance) && (o = this._drop.call(this, i) || o), !this.options.disabled && this.visible && this.accept.call(this.element[0], t.currentItem || t.element) && (this.isout = !0, this.isover = !1, this._deactivate.call(this, i)))
                    })), o
                },
                dragStart: function(t, i) {
                    t.element.parentsUntil("body").bind("scroll.droppable", (function() {
                        t.options.refreshPositions || e.ui.ddmanager.prepareOffsets(t, i)
                    }))
                },
                drag: function(t, i) {
                    t.options.refreshPositions && e.ui.ddmanager.prepareOffsets(t, i),
                    e.each(e.ui.ddmanager.droppables[t.options.scope] || [], (function() {
                        if (!this.options.disabled && !this.greedyChild && this.visible) {
                            var o,
                                n,
                                s,
                                a = e.ui.intersect(t, this, this.options.tolerance),
                                r = !a && this.isover ? "isout" : a && !this.isover ? "isover" : null;
                            r && (this.options.greedy && (n = this.options.scope, (s = this.element.parents(":data(ui-droppable)").filter((function() {
                                return e.data(this, "ui-droppable").options.scope === n
                            }))).length && ((o = e.data(s[0], "ui-droppable")).greedyChild = "isover" === r)), o && "isover" === r && (o.isover = !1, o.isout = !0, o._out.call(o, i)), this[r] = !0, this["isout" === r ? "isover" : "isout"] = !1, this["isover" === r ? "_over" : "_out"].call(this, i), o && "isout" === r && (o.isout = !1, o.isover = !0, o._over.call(o, i)))
                        }
                    }))
                },
                dragStop: function(t, i) {
                    t.element.parentsUntil("body").unbind("scroll.droppable"),
                    t.options.refreshPositions || e.ui.ddmanager.prepareOffsets(t, i)
                }
            }
        }(jQuery),
        function(e, t) {
            function i(e) {
                return parseInt(e, 10) || 0
            }
            function o(e) {
                return !isNaN(parseInt(e, 10))
            }
            e.widget("ui.resizable", e.ui.mouse, {
                version: "1.10.4",
                widgetEventPrefix: "resize",
                options: {
                    alsoResize: !1,
                    animate: !1,
                    animateDuration: "slow",
                    animateEasing: "swing",
                    aspectRatio: !1,
                    autoHide: !1,
                    containment: !1,
                    ghost: !1,
                    grid: !1,
                    handles: "e,s,se",
                    helper: !1,
                    maxHeight: null,
                    maxWidth: null,
                    minHeight: 10,
                    minWidth: 10,
                    zIndex: 90,
                    resize: null,
                    start: null,
                    stop: null
                },
                _create: function() {
                    var t,
                        i,
                        o,
                        n,
                        s = this,
                        a = this.options;
                    if (this.element.addClass("ui-resizable"), e.extend(this, {
                        _aspectRatio: !!a.aspectRatio,
                        aspectRatio: a.aspectRatio,
                        originalElement: this.element,
                        _proportionallyResizeElements: [],
                        _helper: a.helper || a.ghost || a.animate ? a.helper || "ui-resizable-helper" : null
                    }), this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i) && (this.element.wrap(e("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({
                        position: this.element.css("position"),
                        width: this.element.outerWidth(),
                        height: this.element.outerHeight(),
                        top: this.element.css("top"),
                        left: this.element.css("left")
                    })), this.element = this.element.parent().data("ui-resizable", this.element.data("ui-resizable")), this.elementIsWrapper = !0, this.element.css({
                        marginLeft: this.originalElement.css("marginLeft"),
                        marginTop: this.originalElement.css("marginTop"),
                        marginRight: this.originalElement.css("marginRight"),
                        marginBottom: this.originalElement.css("marginBottom")
                    }), this.originalElement.css({
                        marginLeft: 0,
                        marginTop: 0,
                        marginRight: 0,
                        marginBottom: 0
                    }), this.originalResizeStyle = this.originalElement.css("resize"), this.originalElement.css("resize", "none"), this._proportionallyResizeElements.push(this.originalElement.css({
                        position: "static",
                        zoom: 1,
                        display: "block"
                    })), this.originalElement.css({
                        margin: this.originalElement.css("margin")
                    }), this._proportionallyResize()), this.handles = a.handles || (e(".ui-resizable-handle", this.element).length ? {
                        n: ".ui-resizable-n",
                        e: ".ui-resizable-e",
                        s: ".ui-resizable-s",
                        w: ".ui-resizable-w",
                        se: ".ui-resizable-se",
                        sw: ".ui-resizable-sw",
                        ne: ".ui-resizable-ne",
                        nw: ".ui-resizable-nw"
                    } : "e,s,se"), this.handles.constructor === String)
                        for ("all" === this.handles && (this.handles = "n,e,s,w,se,sw,ne,nw"), t = this.handles.split(","), this.handles = {}, i = 0; i < t.length; i++)
                            o = e.trim(t[i]),
                            (n = e("<div class='ui-resizable-handle " + ("ui-resizable-" + o) + "'></div>")).css({
                                zIndex: a.zIndex
                            }),
                            "se" === o && n.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),
                            this.handles[o] = ".ui-resizable-" + o,
                            this.element.append(n);
                    this._renderAxis = function(t) {
                        var i,
                            o,
                            n,
                            s;
                        for (i in t = t || this.element, this.handles)
                            this.handles[i].constructor === String && (this.handles[i] = e(this.handles[i], this.element).show()),
                            this.elementIsWrapper && this.originalElement[0].nodeName.match(/textarea|input|select|button/i) && (o = e(this.handles[i], this.element), s = /sw|ne|nw|se|n|s/.test(i) ? o.outerHeight() : o.outerWidth(), n = ["padding", /ne|nw|n/.test(i) ? "Top" : /se|sw|s/.test(i) ? "Bottom" : /^e$/.test(i) ? "Right" : "Left"].join(""), t.css(n, s), this._proportionallyResize()),
                            e(this.handles[i]).length
                    },
                    this._renderAxis(this.element),
                    this._handles = e(".ui-resizable-handle", this.element).disableSelection(),
                    this._handles.mouseover((function() {
                        s.resizing || (this.className && (n = this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)), s.axis = n && n[1] ? n[1] : "se")
                    })),
                    a.autoHide && (this._handles.hide(), e(this.element).addClass("ui-resizable-autohide").mouseenter((function() {
                        a.disabled || (e(this).removeClass("ui-resizable-autohide"), s._handles.show())
                    })).mouseleave((function() {
                        a.disabled || s.resizing || (e(this).addClass("ui-resizable-autohide"), s._handles.hide())
                    }))),
                    this._mouseInit()
                },
                _destroy: function() {
                    this._mouseDestroy();
                    var t,
                        i = function(t) {
                            e(t).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()
                        };
                    return this.elementIsWrapper && (i(this.element), t = this.element, this.originalElement.css({
                        position: t.css("position"),
                        width: t.outerWidth(),
                        height: t.outerHeight(),
                        top: t.css("top"),
                        left: t.css("left")
                    }).insertAfter(t), t.remove()), this.originalElement.css("resize", this.originalResizeStyle), i(this.originalElement), this
                },
                _mouseCapture: function(t) {
                    var i,
                        o,
                        n = !1;
                    for (i in this.handles)
                        ((o = e(this.handles[i])[0]) === t.target || e.contains(o, t.target)) && (n = !0);
                    return !this.options.disabled && n
                },
                _mouseStart: function(t) {
                    var o,
                        n,
                        s,
                        a = this.options,
                        r = this.element.position(),
                        l = this.element;
                    return this.resizing = !0, /absolute/.test(l.css("position")) ? l.css({
                        position: "absolute",
                        top: l.css("top"),
                        left: l.css("left")
                    }) : l.is(".ui-draggable") && l.css({
                        position: "absolute",
                        top: r.top,
                        left: r.left
                    }), this._renderProxy(), o = i(this.helper.css("left")), n = i(this.helper.css("top")), a.containment && (o += e(a.containment).scrollLeft() || 0, n += e(a.containment).scrollTop() || 0), this.offset = this.helper.offset(), this.position = {
                        left: o,
                        top: n
                    }, this.size = this._helper ? {
                        width: this.helper.width(),
                        height: this.helper.height()
                    } : {
                        width: l.width(),
                        height: l.height()
                    }, this.originalSize = this._helper ? {
                        width: l.outerWidth(),
                        height: l.outerHeight()
                    } : {
                        width: l.width(),
                        height: l.height()
                    }, this.originalPosition = {
                        left: o,
                        top: n
                    }, this.sizeDiff = {
                        width: l.outerWidth() - l.width(),
                        height: l.outerHeight() - l.height()
                    }, this.originalMousePosition = {
                        left: t.pageX,
                        top: t.pageY
                    }, this.aspectRatio = "number" == typeof a.aspectRatio ? a.aspectRatio : this.originalSize.width / this.originalSize.height || 1, s = e(".ui-resizable-" + this.axis).css("cursor"), e("body").css("cursor", "auto" === s ? this.axis + "-resize" : s), l.addClass("ui-resizable-resizing"), this._propagate("start", t), !0
                },
                _mouseDrag: function(t) {
                    var i,
                        o = this.helper,
                        n = {},
                        s = this.originalMousePosition,
                        a = this.axis,
                        r = this.position.top,
                        l = this.position.left,
                        c = this.size.width,
                        d = this.size.height,
                        h = t.pageX - s.left || 0,
                        p = t.pageY - s.top || 0,
                        u = this._change[a];
                    return !!u && (i = u.apply(this, [t, h, p]), this._updateVirtualBoundaries(t.shiftKey), (this._aspectRatio || t.shiftKey) && (i = this._updateRatio(i, t)), i = this._respectSize(i, t), this._updateCache(i), this._propagate("resize", t), this.position.top !== r && (n.top = this.position.top + "px"), this.position.left !== l && (n.left = this.position.left + "px"), this.size.width !== c && (n.width = this.size.width + "px"), this.size.height !== d && (n.height = this.size.height + "px"), o.css(n), !this._helper && this._proportionallyResizeElements.length && this._proportionallyResize(), e.isEmptyObject(n) || this._trigger("resize", t, this.ui()), !1)
                },
                _mouseStop: function(t) {
                    this.resizing = !1;
                    var i,
                        o,
                        n,
                        s,
                        a,
                        r,
                        l,
                        c = this.options;
                    return this._helper && (n = (o = (i = this._proportionallyResizeElements).length && /textarea/i.test(i[0].nodeName)) && e.ui.hasScroll(i[0], "left") ? 0 : this.sizeDiff.height, s = o ? 0 : this.sizeDiff.width, a = {
                        width: this.helper.width() - s,
                        height: this.helper.height() - n
                    }, r = parseInt(this.element.css("left"), 10) + (this.position.left - this.originalPosition.left) || null, l = parseInt(this.element.css("top"), 10) + (this.position.top - this.originalPosition.top) || null, c.animate || this.element.css(e.extend(a, {
                        top: l,
                        left: r
                    })), this.helper.height(this.size.height), this.helper.width(this.size.width), this._helper && !c.animate && this._proportionallyResize()), e("body").css("cursor", "auto"), this.element.removeClass("ui-resizable-resizing"), this._propagate("stop", t), this._helper && this.helper.remove(), !1
                },
                _updateVirtualBoundaries: function(e) {
                    var t,
                        i,
                        n,
                        s,
                        a,
                        r = this.options;
                    a = {
                        minWidth: o(r.minWidth) ? r.minWidth : 0,
                        maxWidth: o(r.maxWidth) ? r.maxWidth : 1 / 0,
                        minHeight: o(r.minHeight) ? r.minHeight : 0,
                        maxHeight: o(r.maxHeight) ? r.maxHeight : 1 / 0
                    },
                    (this._aspectRatio || e) && (t = a.minHeight * this.aspectRatio, n = a.minWidth / this.aspectRatio, i = a.maxHeight * this.aspectRatio, s = a.maxWidth / this.aspectRatio, t > a.minWidth && (a.minWidth = t), n > a.minHeight && (a.minHeight = n), i < a.maxWidth && (a.maxWidth = i), s < a.maxHeight && (a.maxHeight = s)),
                    this._vBoundaries = a
                },
                _updateCache: function(e) {
                    this.offset = this.helper.offset(),
                    o(e.left) && (this.position.left = e.left),
                    o(e.top) && (this.position.top = e.top),
                    o(e.height) && (this.size.height = e.height),
                    o(e.width) && (this.size.width = e.width)
                },
                _updateRatio: function(e) {
                    var t = this.position,
                        i = this.size,
                        n = this.axis;
                    return o(e.height) ? e.width = e.height * this.aspectRatio : o(e.width) && (e.height = e.width / this.aspectRatio), "sw" === n && (e.left = t.left + (i.width - e.width), e.top = null), "nw" === n && (e.top = t.top + (i.height - e.height), e.left = t.left + (i.width - e.width)), e
                },
                _respectSize: function(e) {
                    var t = this._vBoundaries,
                        i = this.axis,
                        n = o(e.width) && t.maxWidth && t.maxWidth < e.width,
                        s = o(e.height) && t.maxHeight && t.maxHeight < e.height,
                        a = o(e.width) && t.minWidth && t.minWidth > e.width,
                        r = o(e.height) && t.minHeight && t.minHeight > e.height,
                        l = this.originalPosition.left + this.originalSize.width,
                        c = this.position.top + this.size.height,
                        d = /sw|nw|w/.test(i),
                        h = /nw|ne|n/.test(i);
                    return a && (e.width = t.minWidth), r && (e.height = t.minHeight), n && (e.width = t.maxWidth), s && (e.height = t.maxHeight), a && d && (e.left = l - t.minWidth), n && d && (e.left = l - t.maxWidth), r && h && (e.top = c - t.minHeight), s && h && (e.top = c - t.maxHeight), e.width || e.height || e.left || !e.top ? e.width || e.height || e.top || !e.left || (e.left = null) : e.top = null, e
                },
                _proportionallyResize: function() {
                    if (this._proportionallyResizeElements.length) {
                        var e,
                            t,
                            i,
                            o,
                            n,
                            s = this.helper || this.element;
                        for (e = 0; e < this._proportionallyResizeElements.length; e++) {
                            if (n = this._proportionallyResizeElements[e], !this.borderDif)
                                for (this.borderDif = [], i = [n.css("borderTopWidth"), n.css("borderRightWidth"), n.css("borderBottomWidth"), n.css("borderLeftWidth")], o = [n.css("paddingTop"), n.css("paddingRight"), n.css("paddingBottom"), n.css("paddingLeft")], t = 0; t < i.length; t++)
                                    this.borderDif[t] = (parseInt(i[t], 10) || 0) + (parseInt(o[t], 10) || 0);
                            n.css({
                                height: s.height() - this.borderDif[0] - this.borderDif[2] || 0,
                                width: s.width() - this.borderDif[1] - this.borderDif[3] || 0
                            })
                        }
                    }
                },
                _renderProxy: function() {
                    var t = this.element,
                        i = this.options;
                    this.elementOffset = t.offset(),
                    this._helper ? (this.helper = this.helper || e("<div style='overflow:hidden;'></div>"), this.helper.addClass(this._helper).css({
                        width: this.element.outerWidth() - 1,
                        height: this.element.outerHeight() - 1,
                        position: "absolute",
                        left: this.elementOffset.left + "px",
                        top: this.elementOffset.top + "px",
                        zIndex: ++i.zIndex
                    }), this.helper.appendTo("body").disableSelection()) : this.helper = this.element
                },
                _change: {
                    e: function(e, t) {
                        return {
                            width: this.originalSize.width + t
                        }
                    },
                    w: function(e, t) {
                        var i = this.originalSize;
                        return {
                            left: this.originalPosition.left + t,
                            width: i.width - t
                        }
                    },
                    n: function(e, t, i) {
                        var o = this.originalSize;
                        return {
                            top: this.originalPosition.top + i,
                            height: o.height - i
                        }
                    },
                    s: function(e, t, i) {
                        return {
                            height: this.originalSize.height + i
                        }
                    },
                    se: function(t, i, o) {
                        return e.extend(this._change.s.apply(this, arguments), this._change.e.apply(this, [t, i, o]))
                    },
                    sw: function(t, i, o) {
                        return e.extend(this._change.s.apply(this, arguments), this._change.w.apply(this, [t, i, o]))
                    },
                    ne: function(t, i, o) {
                        return e.extend(this._change.n.apply(this, arguments), this._change.e.apply(this, [t, i, o]))
                    },
                    nw: function(t, i, o) {
                        return e.extend(this._change.n.apply(this, arguments), this._change.w.apply(this, [t, i, o]))
                    }
                },
                _propagate: function(t, i) {
                    e.ui.plugin.call(this, t, [i, this.ui()]),
                    "resize" !== t && this._trigger(t, i, this.ui())
                },
                plugins: {},
                ui: function() {
                    return {
                        originalElement: this.originalElement,
                        element: this.element,
                        helper: this.helper,
                        position: this.position,
                        size: this.size,
                        originalSize: this.originalSize,
                        originalPosition: this.originalPosition
                    }
                }
            }),
            e.ui.plugin.add("resizable", "animate", {
                stop: function(t) {
                    var i = e(this).data("ui-resizable"),
                        o = i.options,
                        n = i._proportionallyResizeElements,
                        s = n.length && /textarea/i.test(n[0].nodeName),
                        a = s && e.ui.hasScroll(n[0], "left") ? 0 : i.sizeDiff.height,
                        r = s ? 0 : i.sizeDiff.width,
                        l = {
                            width: i.size.width - r,
                            height: i.size.height - a
                        },
                        c = parseInt(i.element.css("left"), 10) + (i.position.left - i.originalPosition.left) || null,
                        d = parseInt(i.element.css("top"), 10) + (i.position.top - i.originalPosition.top) || null;
                    i.element.animate(e.extend(l, d && c ? {
                        top: d,
                        left: c
                    } : {}), {
                        duration: o.animateDuration,
                        easing: o.animateEasing,
                        step: function() {
                            var o = {
                                width: parseInt(i.element.css("width"), 10),
                                height: parseInt(i.element.css("height"), 10),
                                top: parseInt(i.element.css("top"), 10),
                                left: parseInt(i.element.css("left"), 10)
                            };
                            n && n.length && e(n[0]).css({
                                width: o.width,
                                height: o.height
                            }),
                            i._updateCache(o),
                            i._propagate("resize", t)
                        }
                    })
                }
            }),
            e.ui.plugin.add("resizable", "containment", {
                start: function() {
                    var t,
                        o,
                        n,
                        s,
                        a,
                        r,
                        l,
                        c = e(this).data("ui-resizable"),
                        d = c.options,
                        h = c.element,
                        p = d.containment,
                        u = p instanceof e ? p.get(0) : /parent/.test(p) ? h.parent().get(0) : p;
                    u && (c.containerElement = e(u), /document/.test(p) || p === document ? (c.containerOffset = {
                        left: 0,
                        top: 0
                    }, c.containerPosition = {
                        left: 0,
                        top: 0
                    }, c.parentData = {
                        element: e(document),
                        left: 0,
                        top: 0,
                        width: e(document).width(),
                        height: e(document).height() || document.body.parentNode.scrollHeight
                    }) : (t = e(u), o = [], e(["Top", "Right", "Left", "Bottom"]).each((function(e, n) {
                        o[e] = i(t.css("padding" + n))
                    })), c.containerOffset = t.offset(), c.containerPosition = t.position(), c.containerSize = {
                        height: t.innerHeight() - o[3],
                        width: t.innerWidth() - o[1]
                    }, n = c.containerOffset, s = c.containerSize.height, a = c.containerSize.width, r = e.ui.hasScroll(u, "left") ? u.scrollWidth : a, l = e.ui.hasScroll(u) ? u.scrollHeight : s, c.parentData = {
                        element: u,
                        left: n.left,
                        top: n.top,
                        width: r,
                        height: l
                    }))
                },
                resize: function(t) {
                    var i,
                        o,
                        n,
                        s,
                        a = e(this).data("ui-resizable"),
                        r = a.options,
                        l = a.containerOffset,
                        c = a.position,
                        d = a._aspectRatio || t.shiftKey,
                        h = {
                            top: 0,
                            left: 0
                        },
                        p = a.containerElement;
                    p[0] !== document && /static/.test(p.css("position")) && (h = l),
                    c.left < (a._helper ? l.left : 0) && (a.size.width = a.size.width + (a._helper ? a.position.left - l.left : a.position.left - h.left), d && (a.size.height = a.size.width / a.aspectRatio), a.position.left = r.helper ? l.left : 0),
                    c.top < (a._helper ? l.top : 0) && (a.size.height = a.size.height + (a._helper ? a.position.top - l.top : a.position.top), d && (a.size.width = a.size.height * a.aspectRatio), a.position.top = a._helper ? l.top : 0),
                    a.offset.left = a.parentData.left + a.position.left,
                    a.offset.top = a.parentData.top + a.position.top,
                    i = Math.abs((a._helper, a.offset.left - h.left + a.sizeDiff.width)),
                    o = Math.abs((a._helper ? a.offset.top - h.top : a.offset.top - l.top) + a.sizeDiff.height),
                    n = a.containerElement.get(0) === a.element.parent().get(0),
                    s = /relative|absolute/.test(a.containerElement.css("position")),
                    n && s && (i -= Math.abs(a.parentData.left)),
                    i + a.size.width >= a.parentData.width && (a.size.width = a.parentData.width - i, d && (a.size.height = a.size.width / a.aspectRatio)),
                    o + a.size.height >= a.parentData.height && (a.size.height = a.parentData.height - o, d && (a.size.width = a.size.height * a.aspectRatio))
                },
                stop: function() {
                    var t = e(this).data("ui-resizable"),
                        i = t.options,
                        o = t.containerOffset,
                        n = t.containerPosition,
                        s = t.containerElement,
                        a = e(t.helper),
                        r = a.offset(),
                        l = a.outerWidth() - t.sizeDiff.width,
                        c = a.outerHeight() - t.sizeDiff.height;
                    t._helper && !i.animate && /relative/.test(s.css("position")) && e(this).css({
                        left: r.left - n.left - o.left,
                        width: l,
                        height: c
                    }),
                    t._helper && !i.animate && /static/.test(s.css("position")) && e(this).css({
                        left: r.left - n.left - o.left,
                        width: l,
                        height: c
                    })
                }
            }),
            e.ui.plugin.add("resizable", "alsoResize", {
                start: function() {
                    var t = e(this).data("ui-resizable").options,
                        i = function(t) {
                            e(t).each((function() {
                                var t = e(this);
                                t.data("ui-resizable-alsoresize", {
                                    width: parseInt(t.width(), 10),
                                    height: parseInt(t.height(), 10),
                                    left: parseInt(t.css("left"), 10),
                                    top: parseInt(t.css("top"), 10)
                                })
                            }))
                        };
                    "object" != typeof t.alsoResize || t.alsoResize.parentNode ? i(t.alsoResize) : t.alsoResize.length ? (t.alsoResize = t.alsoResize[0], i(t.alsoResize)) : e.each(t.alsoResize, (function(e) {
                        i(e)
                    }))
                },
                resize: function(t, i) {
                    var o = e(this).data("ui-resizable"),
                        n = o.options,
                        s = o.originalSize,
                        a = o.originalPosition,
                        r = {
                            height: o.size.height - s.height || 0,
                            width: o.size.width - s.width || 0,
                            top: o.position.top - a.top || 0,
                            left: o.position.left - a.left || 0
                        },
                        l = function(t, o) {
                            e(t).each((function() {
                                var t = e(this),
                                    n = e(this).data("ui-resizable-alsoresize"),
                                    s = {},
                                    a = o && o.length ? o : t.parents(i.originalElement[0]).length ? ["width", "height"] : ["width", "height", "top", "left"];
                                e.each(a, (function(e, t) {
                                    var i = (n[t] || 0) + (r[t] || 0);
                                    i && i >= 0 && (s[t] = i || null)
                                })),
                                t.css(s)
                            }))
                        };
                    "object" != typeof n.alsoResize || n.alsoResize.nodeType ? l(n.alsoResize) : e.each(n.alsoResize, (function(e, t) {
                        l(e, t)
                    }))
                },
                stop: function() {
                    e(this).removeData("resizable-alsoresize")
                }
            }),
            e.ui.plugin.add("resizable", "ghost", {
                start: function() {
                    var t = e(this).data("ui-resizable"),
                        i = t.options,
                        o = t.size;
                    t.ghost = t.originalElement.clone(),
                    t.ghost.css({
                        opacity: .25,
                        display: "block",
                        position: "relative",
                        height: o.height,
                        width: o.width,
                        margin: 0,
                        left: 0,
                        top: 0
                    }).addClass("ui-resizable-ghost").addClass("string" == typeof i.ghost ? i.ghost : ""),
                    t.ghost.appendTo(t.helper)
                },
                resize: function() {
                    var t = e(this).data("ui-resizable");
                    t.ghost && t.ghost.css({
                        position: "relative",
                        height: t.size.height,
                        width: t.size.width
                    })
                },
                stop: function() {
                    var t = e(this).data("ui-resizable");
                    t.ghost && t.helper && t.helper.get(0).removeChild(t.ghost.get(0))
                }
            }),
            e.ui.plugin.add("resizable", "grid", {
                resize: function() {
                    var t = e(this).data("ui-resizable"),
                        i = t.options,
                        o = t.size,
                        n = t.originalSize,
                        s = t.originalPosition,
                        a = t.axis,
                        r = "number" == typeof i.grid ? [i.grid, i.grid] : i.grid,
                        l = r[0] || 1,
                        c = r[1] || 1,
                        d = Math.round((o.width - n.width) / l) * l,
                        h = Math.round((o.height - n.height) / c) * c,
                        p = n.width + d,
                        u = n.height + h,
                        f = i.maxWidth && i.maxWidth < p,
                        m = i.maxHeight && i.maxHeight < u,
                        g = i.minWidth && i.minWidth > p,
                        v = i.minHeight && i.minHeight > u;
                    i.grid = r,
                    g && (p += l),
                    v && (u += c),
                    f && (p -= l),
                    m && (u -= c),
                    /^(se|s|e)$/.test(a) ? (t.size.width = p, t.size.height = u) : /^(ne)$/.test(a) ? (t.size.width = p, t.size.height = u, t.position.top = s.top - h) : /^(sw)$/.test(a) ? (t.size.width = p, t.size.height = u, t.position.left = s.left - d) : (u - c > 0 ? (t.size.height = u, t.position.top = s.top - h) : (t.size.height = c, t.position.top = s.top + n.height - c), p - l > 0 ? (t.size.width = p, t.position.left = s.left - d) : (t.size.width = l, t.position.left = s.left + n.width - l))
                }
            })
        }(jQuery),
        function(e, t) {
            e.widget("ui.selectable", e.ui.mouse, {
                version: "1.10.4",
                options: {
                    appendTo: "body",
                    autoRefresh: !0,
                    distance: 0,
                    filter: "*",
                    tolerance: "touch",
                    selected: null,
                    selecting: null,
                    start: null,
                    stop: null,
                    unselected: null,
                    unselecting: null
                },
                _create: function() {
                    var t,
                        i = this;
                    this.element.addClass("ui-selectable"),
                    this.dragged = !1,
                    this.refresh = function() {
                        (t = e(i.options.filter, i.element[0])).addClass("ui-selectee"),
                        t.each((function() {
                            var t = e(this),
                                i = t.offset();
                            e.data(this, "selectable-item", {
                                element: this,
                                $element: t,
                                left: i.left,
                                top: i.top,
                                right: i.left + t.outerWidth(),
                                bottom: i.top + t.outerHeight(),
                                startselected: !1,
                                selected: t.hasClass("ui-selected"),
                                selecting: t.hasClass("ui-selecting"),
                                unselecting: t.hasClass("ui-unselecting")
                            })
                        }))
                    },
                    this.refresh(),
                    this.selectees = t.addClass("ui-selectee"),
                    this._mouseInit(),
                    this.helper = e("<div class='ui-selectable-helper'></div>")
                },
                _destroy: function() {
                    this.selectees.removeClass("ui-selectee").removeData("selectable-item"),
                    this.element.removeClass("ui-selectable ui-selectable-disabled"),
                    this._mouseDestroy()
                },
                _mouseStart: function(t) {
                    var i = this,
                        o = this.options;
                    this.opos = [t.pageX, t.pageY],
                    this.options.disabled || (this.selectees = e(o.filter, this.element[0]), this._trigger("start", t), e(o.appendTo).append(this.helper), this.helper.css({
                        left: t.pageX,
                        top: t.pageY,
                        width: 0,
                        height: 0
                    }), o.autoRefresh && this.refresh(), this.selectees.filter(".ui-selected").each((function() {
                        var o = e.data(this, "selectable-item");
                        o.startselected = !0,
                        t.metaKey || t.ctrlKey || (o.$element.removeClass("ui-selected"), o.selected = !1, o.$element.addClass("ui-unselecting"), o.unselecting = !0, i._trigger("unselecting", t, {
                            unselecting: o.element
                        }))
                    })), e(t.target).parents().addBack().each((function() {
                        var o,
                            n = e.data(this, "selectable-item");
                        if (n)
                            return o = !t.metaKey && !t.ctrlKey || !n.$element.hasClass("ui-selected"), n.$element.removeClass(o ? "ui-unselecting" : "ui-selected").addClass(o ? "ui-selecting" : "ui-unselecting"), n.unselecting = !o, n.selecting = o, n.selected = o, o ? i._trigger("selecting", t, {
                                selecting: n.element
                            }) : i._trigger("unselecting", t, {
                                unselecting: n.element
                            }), !1
                    })))
                },
                _mouseDrag: function(t) {
                    if (this.dragged = !0, !this.options.disabled) {
                        var i,
                            o = this,
                            n = this.options,
                            s = this.opos[0],
                            a = this.opos[1],
                            r = t.pageX,
                            l = t.pageY;
                        return s > r && (i = r, r = s, s = i), a > l && (i = l, l = a, a = i), this.helper.css({
                            left: s,
                            top: a,
                            width: r - s,
                            height: l - a
                        }), this.selectees.each((function() {
                            var i = e.data(this, "selectable-item"),
                                c = !1;
                            i && i.element !== o.element[0] && ("touch" === n.tolerance ? c = !(i.left > r || i.right < s || i.top > l || i.bottom < a) : "fit" === n.tolerance && (c = i.left > s && i.right < r && i.top > a && i.bottom < l), c ? (i.selected && (i.$element.removeClass("ui-selected"), i.selected = !1), i.unselecting && (i.$element.removeClass("ui-unselecting"), i.unselecting = !1), i.selecting || (i.$element.addClass("ui-selecting"), i.selecting = !0, o._trigger("selecting", t, {
                                selecting: i.element
                            }))) : (i.selecting && ((t.metaKey || t.ctrlKey) && i.startselected ? (i.$element.removeClass("ui-selecting"), i.selecting = !1, i.$element.addClass("ui-selected"), i.selected = !0) : (i.$element.removeClass("ui-selecting"), i.selecting = !1, i.startselected && (i.$element.addClass("ui-unselecting"), i.unselecting = !0), o._trigger("unselecting", t, {
                                unselecting: i.element
                            }))), i.selected && (t.metaKey || t.ctrlKey || i.startselected || (i.$element.removeClass("ui-selected"), i.selected = !1, i.$element.addClass("ui-unselecting"), i.unselecting = !0, o._trigger("unselecting", t, {
                                unselecting: i.element
                            })))))
                        })), !1
                    }
                },
                _mouseStop: function(t) {
                    var i = this;
                    return this.dragged = !1, e(".ui-unselecting", this.element[0]).each((function() {
                        var o = e.data(this, "selectable-item");
                        o.$element.removeClass("ui-unselecting"),
                        o.unselecting = !1,
                        o.startselected = !1,
                        i._trigger("unselected", t, {
                            unselected: o.element
                        })
                    })), e(".ui-selecting", this.element[0]).each((function() {
                        var o = e.data(this, "selectable-item");
                        o.$element.removeClass("ui-selecting").addClass("ui-selected"),
                        o.selecting = !1,
                        o.selected = !0,
                        o.startselected = !0,
                        i._trigger("selected", t, {
                            selected: o.element
                        })
                    })), this._trigger("stop", t), this.helper.remove(), !1
                }
            })
        }(jQuery),
        function(e, t) {
            function i(e, t, i) {
                return e > t && e < t + i
            }
            function o(e) {
                return /left|right/.test(e.css("float")) || /inline|table-cell/.test(e.css("display"))
            }
            e.widget("ui.sortable", e.ui.mouse, {
                version: "1.10.4",
                widgetEventPrefix: "sort",
                ready: !1,
                options: {
                    appendTo: "parent",
                    axis: !1,
                    connectWith: !1,
                    containment: !1,
                    cursor: "auto",
                    cursorAt: !1,
                    dropOnEmpty: !0,
                    forcePlaceholderSize: !1,
                    forceHelperSize: !1,
                    grid: !1,
                    handle: !1,
                    helper: "original",
                    items: "> *",
                    opacity: !1,
                    placeholder: !1,
                    revert: !1,
                    scroll: !0,
                    scrollSensitivity: 20,
                    scrollSpeed: 20,
                    scope: "default",
                    tolerance: "intersect",
                    zIndex: 1e3,
                    activate: null,
                    beforeStop: null,
                    change: null,
                    deactivate: null,
                    out: null,
                    over: null,
                    receive: null,
                    remove: null,
                    sort: null,
                    start: null,
                    stop: null,
                    update: null
                },
                _create: function() {
                    var e = this.options;
                    this.containerCache = {},
                    this.element.addClass("ui-sortable"),
                    this.refresh(),
                    this.floating = !!this.items.length && ("x" === e.axis || o(this.items[0].item)),
                    this.offset = this.element.offset(),
                    this._mouseInit(),
                    this.ready = !0
                },
                _destroy: function() {
                    this.element.removeClass("ui-sortable ui-sortable-disabled"),
                    this._mouseDestroy();
                    for (var e = this.items.length - 1; e >= 0; e--)
                        this.items[e].item.removeData(this.widgetName + "-item");
                    return this
                },
                _setOption: function(t, i) {
                    "disabled" === t ? (this.options[t] = i, this.widget().toggleClass("ui-sortable-disabled", !!i)) : e.Widget.prototype._setOption.apply(this, arguments)
                },
                _mouseCapture: function(t, i) {
                    var o = null,
                        n = !1,
                        s = this;
                    return !this.reverting && (!this.options.disabled && "static" !== this.options.type && (this._refreshItems(t), e(t.target).parents().each((function() {
                            if (e.data(this, s.widgetName + "-item") === s)
                                return o = e(this), !1
                        })), e.data(t.target, s.widgetName + "-item") === s && (o = e(t.target)), !!o && (!(this.options.handle && !i && (e(this.options.handle, o).find("*").addBack().each((function() {
                            this === t.target && (n = !0)
                        })), !n)) && (this.currentItem = o, this._removeCurrentsFromItems(), !0))))
                },
                _mouseStart: function(t, i, o) {
                    var n,
                        s,
                        a = this.options;
                    if (this.currentContainer = this, this.refreshPositions(), this.helper = this._createHelper(t), this._cacheHelperProportions(), this._cacheMargins(), this.scrollParent = this.helper.scrollParent(), this.offset = this.currentItem.offset(), this.offset = {
                        top: this.offset.top - this.margins.top,
                        left: this.offset.left - this.margins.left
                    }, e.extend(this.offset, {
                        click: {
                            left: t.pageX - this.offset.left,
                            top: t.pageY - this.offset.top
                        },
                        parent: this._getParentOffset(),
                        relative: this._getRelativeOffset()
                    }), this.helper.css("position", "absolute"), this.cssPosition = this.helper.css("position"), this.originalPosition = this._generatePosition(t), this.originalPageX = t.pageX, this.originalPageY = t.pageY, a.cursorAt && this._adjustOffsetFromHelper(a.cursorAt), this.domPosition = {
                        prev: this.currentItem.prev()[0],
                        parent: this.currentItem.parent()[0]
                    }, this.helper[0] !== this.currentItem[0] && this.currentItem.hide(), this._createPlaceholder(), a.containment && this._setContainment(), a.cursor && "auto" !== a.cursor && (s = this.document.find("body"), this.storedCursor = s.css("cursor"), s.css("cursor", a.cursor), this.storedStylesheet = e("<style>*{ cursor: " + a.cursor + " !important; }</style>").appendTo(s)), a.opacity && (this.helper.css("opacity") && (this._storedOpacity = this.helper.css("opacity")), this.helper.css("opacity", a.opacity)), a.zIndex && (this.helper.css("zIndex") && (this._storedZIndex = this.helper.css("zIndex")), this.helper.css("zIndex", a.zIndex)), this.scrollParent[0] !== document && "HTML" !== this.scrollParent[0].tagName && (this.overflowOffset = this.scrollParent.offset()), this._trigger("start", t, this._uiHash()), this._preserveHelperProportions || this._cacheHelperProportions(), !o)
                        for (n = this.containers.length - 1; n >= 0; n--)
                            this.containers[n]._trigger("activate", t, this._uiHash(this));
                    return e.ui.ddmanager && (e.ui.ddmanager.current = this), e.ui.ddmanager && !a.dropBehaviour && e.ui.ddmanager.prepareOffsets(this, t), this.dragging = !0, this.helper.addClass("ui-sortable-helper"), this._mouseDrag(t), !0
                },
                _mouseDrag: function(t) {
                    var i,
                        o,
                        n,
                        s,
                        a = this.options,
                        r = !1;
                    for (this.position = this._generatePosition(t), this.positionAbs = this._convertPositionTo("absolute"), this.lastPositionAbs || (this.lastPositionAbs = this.positionAbs), this.options.scroll && (this.scrollParent[0] !== document && "HTML" !== this.scrollParent[0].tagName ? (this.overflowOffset.top + this.scrollParent[0].offsetHeight - t.pageY < a.scrollSensitivity ? this.scrollParent[0].scrollTop = r = this.scrollParent[0].scrollTop + a.scrollSpeed : t.pageY - this.overflowOffset.top < a.scrollSensitivity && (this.scrollParent[0].scrollTop = r = this.scrollParent[0].scrollTop - a.scrollSpeed), this.overflowOffset.left + this.scrollParent[0].offsetWidth - t.pageX < a.scrollSensitivity ? this.scrollParent[0].scrollLeft = r = this.scrollParent[0].scrollLeft + a.scrollSpeed : t.pageX - this.overflowOffset.left < a.scrollSensitivity && (this.scrollParent[0].scrollLeft = r = this.scrollParent[0].scrollLeft - a.scrollSpeed)) : (t.pageY - e(document).scrollTop() < a.scrollSensitivity ? r = e(document).scrollTop(e(document).scrollTop() - a.scrollSpeed) : e(window).height() - (t.pageY - e(document).scrollTop()) < a.scrollSensitivity && (r = e(document).scrollTop(e(document).scrollTop() + a.scrollSpeed)), t.pageX - e(document).scrollLeft() < a.scrollSensitivity ? r = e(document).scrollLeft(e(document).scrollLeft() - a.scrollSpeed) : e(window).width() - (t.pageX - e(document).scrollLeft()) < a.scrollSensitivity && (r = e(document).scrollLeft(e(document).scrollLeft() + a.scrollSpeed))), !1 !== r && e.ui.ddmanager && !a.dropBehaviour && e.ui.ddmanager.prepareOffsets(this, t)), this.positionAbs = this._convertPositionTo("absolute"), this.options.axis && "y" === this.options.axis || (this.helper[0].style.left = this.position.left + "px"), this.options.axis && "x" === this.options.axis || (this.helper[0].style.top = this.position.top + "px"), i = this.items.length - 1; i >= 0; i--)
                        if (n = (o = this.items[i]).item[0], (s = this._intersectsWithPointer(o)) && o.instance === this.currentContainer && !(n === this.currentItem[0] || this.placeholder[1 === s ? "next" : "prev"]()[0] === n || e.contains(this.placeholder[0], n) || "semi-dynamic" === this.options.type && e.contains(this.element[0], n))) {
                            if (this.direction = 1 === s ? "down" : "up", "pointer" !== this.options.tolerance && !this._intersectsWithSides(o))
                                break;
                            this._rearrange(t, o),
                            this._trigger("change", t, this._uiHash());
                            break
                        }
                    return this._contactContainers(t), e.ui.ddmanager && e.ui.ddmanager.drag(this, t), this._trigger("sort", t, this._uiHash()), this.lastPositionAbs = this.positionAbs, !1
                },
                _mouseStop: function(t, i) {
                    if (t) {
                        if (e.ui.ddmanager && !this.options.dropBehaviour && e.ui.ddmanager.drop(this, t), this.options.revert) {
                            var o = this,
                                n = this.placeholder.offset(),
                                s = this.options.axis,
                                a = {};
                            s && "x" !== s || (a.left = n.left - this.offset.parent.left - this.margins.left + (this.offsetParent[0] === document.body ? 0 : this.offsetParent[0].scrollLeft)),
                            s && "y" !== s || (a.top = n.top - this.offset.parent.top - this.margins.top + (this.offsetParent[0] === document.body ? 0 : this.offsetParent[0].scrollTop)),
                            this.reverting = !0,
                            e(this.helper).animate(a, parseInt(this.options.revert, 10) || 500, (function() {
                                o._clear(t)
                            }))
                        } else
                            this._clear(t, i);
                        return !1
                    }
                },
                cancel: function() {
                    if (this.dragging) {
                        this._mouseUp({
                            target: null
                        }),
                        "original" === this.options.helper ? this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper") : this.currentItem.show();
                        for (var t = this.containers.length - 1; t >= 0; t--)
                            this.containers[t]._trigger("deactivate", null, this._uiHash(this)),
                            this.containers[t].containerCache.over && (this.containers[t]._trigger("out", null, this._uiHash(this)), this.containers[t].containerCache.over = 0)
                    }
                    return this.placeholder && (this.placeholder[0].parentNode && this.placeholder[0].parentNode.removeChild(this.placeholder[0]), "original" !== this.options.helper && this.helper && this.helper[0].parentNode && this.helper.remove(), e.extend(this, {
                        helper: null,
                        dragging: !1,
                        reverting: !1,
                        _noFinalSort: null
                    }), this.domPosition.prev ? e(this.domPosition.prev).after(this.currentItem) : e(this.domPosition.parent).prepend(this.currentItem)), this
                },
                serialize: function(t) {
                    var i = this._getItemsAsjQuery(t && t.connected),
                        o = [];
                    return t = t || {}, e(i).each((function() {
                        var i = (e(t.item || this).attr(t.attribute || "id") || "").match(t.expression || /(.+)[\-=_](.+)/);
                        i && o.push((t.key || i[1] + "[]") + "=" + (t.key && t.expression ? i[1] : i[2]))
                    })), !o.length && t.key && o.push(t.key + "="), o.join("&")
                },
                toArray: function(t) {
                    var i = this._getItemsAsjQuery(t && t.connected),
                        o = [];
                    return t = t || {}, i.each((function() {
                        o.push(e(t.item || this).attr(t.attribute || "id") || "")
                    })), o
                },
                _intersectsWith: function(e) {
                    var t = this.positionAbs.left,
                        i = t + this.helperProportions.width,
                        o = this.positionAbs.top,
                        n = o + this.helperProportions.height,
                        s = e.left,
                        a = s + e.width,
                        r = e.top,
                        l = r + e.height,
                        c = this.offset.click.top,
                        d = this.offset.click.left,
                        h = "x" === this.options.axis || o + c > r && o + c < l,
                        p = "y" === this.options.axis || t + d > s && t + d < a,
                        u = h && p;
                    return "pointer" === this.options.tolerance || this.options.forcePointerForContainers || "pointer" !== this.options.tolerance && this.helperProportions[this.floating ? "width" : "height"] > e[this.floating ? "width" : "height"] ? u : s < t + this.helperProportions.width / 2 && i - this.helperProportions.width / 2 < a && r < o + this.helperProportions.height / 2 && n - this.helperProportions.height / 2 < l
                },
                _intersectsWithPointer: function(e) {
                    var t = "x" === this.options.axis || i(this.positionAbs.top + this.offset.click.top, e.top, e.height),
                        o = "y" === this.options.axis || i(this.positionAbs.left + this.offset.click.left, e.left, e.width),
                        n = t && o,
                        s = this._getDragVerticalDirection(),
                        a = this._getDragHorizontalDirection();
                    return !!n && (this.floating ? a && "right" === a || "down" === s ? 2 : 1 : s && ("down" === s ? 2 : 1))
                },
                _intersectsWithSides: function(e) {
                    var t = i(this.positionAbs.top + this.offset.click.top, e.top + e.height / 2, e.height),
                        o = i(this.positionAbs.left + this.offset.click.left, e.left + e.width / 2, e.width),
                        n = this._getDragVerticalDirection(),
                        s = this._getDragHorizontalDirection();
                    return this.floating && s ? "right" === s && o || "left" === s && !o : n && ("down" === n && t || "up" === n && !t)
                },
                _getDragVerticalDirection: function() {
                    var e = this.positionAbs.top - this.lastPositionAbs.top;
                    return 0 !== e && (e > 0 ? "down" : "up")
                },
                _getDragHorizontalDirection: function() {
                    var e = this.positionAbs.left - this.lastPositionAbs.left;
                    return 0 !== e && (e > 0 ? "right" : "left")
                },
                refresh: function(e) {
                    return this._refreshItems(e), this.refreshPositions(), this
                },
                _connectWith: function() {
                    var e = this.options;
                    return e.connectWith.constructor === String ? [e.connectWith] : e.connectWith
                },
                _getItemsAsjQuery: function(t) {
                    var i,
                        o,
                        n,
                        s,
                        a = [],
                        r = [],
                        l = this._connectWith();
                    if (l && t)
                        for (i = l.length - 1; i >= 0; i--)
                            for (o = (n = e(l[i])).length - 1; o >= 0; o--)
                                (s = e.data(n[o], this.widgetFullName)) && s !== this && !s.options.disabled && r.push([e.isFunction(s.options.items) ? s.options.items.call(s.element) : e(s.options.items, s.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"), s]);
                    function c() {
                        a.push(this)
                    }
                    for (r.push([e.isFunction(this.options.items) ? this.options.items.call(this.element, null, {
                        options: this.options,
                        item: this.currentItem
                    }) : e(this.options.items, this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"), this]), i = r.length - 1; i >= 0; i--)
                        r[i][0].each(c);
                    return e(a)
                },
                _removeCurrentsFromItems: function() {
                    var t = this.currentItem.find(":data(" + this.widgetName + "-item)");
                    this.items = e.grep(this.items, (function(e) {
                        for (var i = 0; i < t.length; i++)
                            if (t[i] === e.item[0])
                                return !1;
                        return !0
                    }))
                },
                _refreshItems: function(t) {
                    this.items = [],
                    this.containers = [this];
                    var i,
                        o,
                        n,
                        s,
                        a,
                        r,
                        l,
                        c,
                        d = this.items,
                        h = [[e.isFunction(this.options.items) ? this.options.items.call(this.element[0], t, {
                            item: this.currentItem
                        }) : e(this.options.items, this.element), this]],
                        p = this._connectWith();
                    if (p && this.ready)
                        for (i = p.length - 1; i >= 0; i--)
                            for (o = (n = e(p[i])).length - 1; o >= 0; o--)
                                (s = e.data(n[o], this.widgetFullName)) && s !== this && !s.options.disabled && (h.push([e.isFunction(s.options.items) ? s.options.items.call(s.element[0], t, {
                                    item: this.currentItem
                                }) : e(s.options.items, s.element), s]), this.containers.push(s));
                    for (i = h.length - 1; i >= 0; i--)
                        for (a = h[i][1], o = 0, c = (r = h[i][0]).length; o < c; o++)
                            (l = e(r[o])).data(this.widgetName + "-item", a),
                            d.push({
                                item: l,
                                instance: a,
                                width: 0,
                                height: 0,
                                left: 0,
                                top: 0
                            })
                },
                refreshPositions: function(t) {
                    var i,
                        o,
                        n,
                        s;
                    for (this.offsetParent && this.helper && (this.offset.parent = this._getParentOffset()), i = this.items.length - 1; i >= 0; i--)
                        (o = this.items[i]).instance !== this.currentContainer && this.currentContainer && o.item[0] !== this.currentItem[0] || (n = this.options.toleranceElement ? e(this.options.toleranceElement, o.item) : o.item, t || (o.width = n.outerWidth(), o.height = n.outerHeight()), s = n.offset(), o.left = s.left, o.top = s.top);
                    if (this.options.custom && this.options.custom.refreshContainers)
                        this.options.custom.refreshContainers.call(this);
                    else
                        for (i = this.containers.length - 1; i >= 0; i--)
                            s = this.containers[i].element.offset(),
                            this.containers[i].containerCache.left = s.left,
                            this.containers[i].containerCache.top = s.top,
                            this.containers[i].containerCache.width = this.containers[i].element.outerWidth(),
                            this.containers[i].containerCache.height = this.containers[i].element.outerHeight();
                    return this
                },
                _createPlaceholder: function(t) {
                    var i,
                        o = (t = t || this).options;
                    o.placeholder && o.placeholder.constructor !== String || (i = o.placeholder, o.placeholder = {
                        element: function() {
                            var o = t.currentItem[0].nodeName.toLowerCase(),
                                n = e("<" + o + ">", t.document[0]).addClass(i || t.currentItem[0].className + " ui-sortable-placeholder").removeClass("ui-sortable-helper");
                            return "tr" === o ? t.currentItem.children().each((function() {
                                e("<td>&#160;</td>", t.document[0]).attr("colspan", e(this).attr("colspan") || 1).appendTo(n)
                            })) : "img" === o && n.attr("src", t.currentItem.attr("src")), i || n.css("visibility", "hidden"), n
                        },
                        update: function(e, n) {
                            i && !o.forcePlaceholderSize || (n.height() || n.height(t.currentItem.innerHeight() - parseInt(t.currentItem.css("paddingTop") || 0, 10) - parseInt(t.currentItem.css("paddingBottom") || 0, 10)), n.width() || n.width(t.currentItem.innerWidth() - parseInt(t.currentItem.css("paddingLeft") || 0, 10) - parseInt(t.currentItem.css("paddingRight") || 0, 10)))
                        }
                    }),
                    t.placeholder = e(o.placeholder.element.call(t.element, t.currentItem)),
                    t.currentItem.after(t.placeholder),
                    o.placeholder.update(t, t.placeholder)
                },
                _contactContainers: function(t) {
                    var n,
                        s,
                        a,
                        r,
                        l,
                        c,
                        d,
                        h,
                        p,
                        u,
                        f = null,
                        m = null;
                    for (n = this.containers.length - 1; n >= 0; n--)
                        if (!e.contains(this.currentItem[0], this.containers[n].element[0]))
                            if (this._intersectsWith(this.containers[n].containerCache)) {
                                if (f && e.contains(this.containers[n].element[0], f.element[0]))
                                    continue;
                                f = this.containers[n],
                                m = n
                            } else
                                this.containers[n].containerCache.over && (this.containers[n]._trigger("out", t, this._uiHash(this)), this.containers[n].containerCache.over = 0);
                    if (f)
                        if (1 === this.containers.length)
                            this.containers[m].containerCache.over || (this.containers[m]._trigger("over", t, this._uiHash(this)), this.containers[m].containerCache.over = 1);
                        else {
                            for (a = 1e4, r = null, l = (u = f.floating || o(this.currentItem)) ? "left" : "top", c = u ? "width" : "height", d = this.positionAbs[l] + this.offset.click[l], s = this.items.length - 1; s >= 0; s--)
                                e.contains(this.containers[m].element[0], this.items[s].item[0]) && this.items[s].item[0] !== this.currentItem[0] && (u && !i(this.positionAbs.top + this.offset.click.top, this.items[s].top, this.items[s].height) || (h = this.items[s].item.offset()[l], p = !1, Math.abs(h - d) > Math.abs(h + this.items[s][c] - d) && (p = !0, h += this.items[s][c]), Math.abs(h - d) < a && (a = Math.abs(h - d), r = this.items[s], this.direction = p ? "up" : "down")));
                            if (!r && !this.options.dropOnEmpty)
                                return;
                            if (this.currentContainer === this.containers[m])
                                return;
                            r ? this._rearrange(t, r, null, !0) : this._rearrange(t, null, this.containers[m].element, !0),
                            this._trigger("change", t, this._uiHash()),
                            this.containers[m]._trigger("change", t, this._uiHash(this)),
                            this.currentContainer = this.containers[m],
                            this.options.placeholder.update(this.currentContainer, this.placeholder),
                            this.containers[m]._trigger("over", t, this._uiHash(this)),
                            this.containers[m].containerCache.over = 1
                        }
                },
                _createHelper: function(t) {
                    var i = this.options,
                        o = e.isFunction(i.helper) ? e(i.helper.apply(this.element[0], [t, this.currentItem])) : "clone" === i.helper ? this.currentItem.clone() : this.currentItem;
                    return o.parents("body").length || e("parent" !== i.appendTo ? i.appendTo : this.currentItem[0].parentNode)[0].appendChild(o[0]), o[0] === this.currentItem[0] && (this._storedCSS = {
                        width: this.currentItem[0].style.width,
                        height: this.currentItem[0].style.height,
                        position: this.currentItem.css("position"),
                        top: this.currentItem.css("top"),
                        left: this.currentItem.css("left")
                    }), o[0].style.width && !i.forceHelperSize || o.width(this.currentItem.width()), o[0].style.height && !i.forceHelperSize || o.height(this.currentItem.height()), o
                },
                _adjustOffsetFromHelper: function(t) {
                    "string" == typeof t && (t = t.split(" ")),
                    e.isArray(t) && (t = {
                        left: +t[0],
                        top: +t[1] || 0
                    }),
                    "left" in t && (this.offset.click.left = t.left + this.margins.left),
                    "right" in t && (this.offset.click.left = this.helperProportions.width - t.right + this.margins.left),
                    "top" in t && (this.offset.click.top = t.top + this.margins.top),
                    "bottom" in t && (this.offset.click.top = this.helperProportions.height - t.bottom + this.margins.top)
                },
                _getParentOffset: function() {
                    this.offsetParent = this.helper.offsetParent();
                    var t = this.offsetParent.offset();
                    return "absolute" === this.cssPosition && this.scrollParent[0] !== document && e.contains(this.scrollParent[0], this.offsetParent[0]) && (t.left += this.scrollParent.scrollLeft(), t.top += this.scrollParent.scrollTop()), (this.offsetParent[0] === document.body || this.offsetParent[0].tagName && "html" === this.offsetParent[0].tagName.toLowerCase() && e.ui.ie) && (t = {
                        top: 0,
                        left: 0
                    }), {
                        top: t.top + (parseInt(this.offsetParent.css("borderTopWidth"), 10) || 0),
                        left: t.left + (parseInt(this.offsetParent.css("borderLeftWidth"), 10) || 0)
                    }
                },
                _getRelativeOffset: function() {
                    if ("relative" === this.cssPosition) {
                        var e = this.currentItem.position();
                        return {
                            top: e.top - (parseInt(this.helper.css("top"), 10) || 0) + this.scrollParent.scrollTop(),
                            left: e.left - (parseInt(this.helper.css("left"), 10) || 0) + this.scrollParent.scrollLeft()
                        }
                    }
                    return {
                        top: 0,
                        left: 0
                    }
                },
                _cacheMargins: function() {
                    this.margins = {
                        left: parseInt(this.currentItem.css("marginLeft"), 10) || 0,
                        top: parseInt(this.currentItem.css("marginTop"), 10) || 0
                    }
                },
                _cacheHelperProportions: function() {
                    this.helperProportions = {
                        width: this.helper.outerWidth(),
                        height: this.helper.outerHeight()
                    }
                },
                _setContainment: function() {
                    var t,
                        i,
                        o,
                        n = this.options;
                    "parent" === n.containment && (n.containment = this.helper[0].parentNode),
                    "document" !== n.containment && "window" !== n.containment || (this.containment = [0 - this.offset.relative.left - this.offset.parent.left, 0 - this.offset.relative.top - this.offset.parent.top, e("document" === n.containment ? document : window).width() - this.helperProportions.width - this.margins.left, (e("document" === n.containment ? document : window).height() || document.body.parentNode.scrollHeight) - this.helperProportions.height - this.margins.top]),
                    /^(document|window|parent)$/.test(n.containment) || (t = e(n.containment)[0], i = e(n.containment).offset(), o = "hidden" !== e(t).css("overflow"), this.containment = [i.left + (parseInt(e(t).css("borderLeftWidth"), 10) || 0) + (parseInt(e(t).css("paddingLeft"), 10) || 0) - this.margins.left, i.top + (parseInt(e(t).css("borderTopWidth"), 10) || 0) + (parseInt(e(t).css("paddingTop"), 10) || 0) - this.margins.top, i.left + (o ? Math.max(t.scrollWidth, t.offsetWidth) : t.offsetWidth) - (parseInt(e(t).css("borderLeftWidth"), 10) || 0) - (parseInt(e(t).css("paddingRight"), 10) || 0) - this.helperProportions.width - this.margins.left, i.top + (o ? Math.max(t.scrollHeight, t.offsetHeight) : t.offsetHeight) - (parseInt(e(t).css("borderTopWidth"), 10) || 0) - (parseInt(e(t).css("paddingBottom"), 10) || 0) - this.helperProportions.height - this.margins.top])
                },
                _convertPositionTo: function(t, i) {
                    i || (i = this.position);
                    var o = "absolute" === t ? 1 : -1,
                        n = "absolute" !== this.cssPosition || this.scrollParent[0] !== document && e.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent,
                        s = /(html|body)/i.test(n[0].tagName);
                    return {
                        top: i.top + this.offset.relative.top * o + this.offset.parent.top * o - ("fixed" === this.cssPosition ? -this.scrollParent.scrollTop() : s ? 0 : n.scrollTop()) * o,
                        left: i.left + this.offset.relative.left * o + this.offset.parent.left * o - ("fixed" === this.cssPosition ? -this.scrollParent.scrollLeft() : s ? 0 : n.scrollLeft()) * o
                    }
                },
                _generatePosition: function(t) {
                    var i,
                        o,
                        n = this.options,
                        s = t.pageX,
                        a = t.pageY,
                        r = "absolute" !== this.cssPosition || this.scrollParent[0] !== document && e.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent,
                        l = /(html|body)/i.test(r[0].tagName);
                    return "relative" !== this.cssPosition || this.scrollParent[0] !== document && this.scrollParent[0] !== this.offsetParent[0] || (this.offset.relative = this._getRelativeOffset()), this.originalPosition && (this.containment && (t.pageX - this.offset.click.left < this.containment[0] && (s = this.containment[0] + this.offset.click.left), t.pageY - this.offset.click.top < this.containment[1] && (a = this.containment[1] + this.offset.click.top), t.pageX - this.offset.click.left > this.containment[2] && (s = this.containment[2] + this.offset.click.left), t.pageY - this.offset.click.top > this.containment[3] && (a = this.containment[3] + this.offset.click.top)), n.grid && (i = this.originalPageY + Math.round((a - this.originalPageY) / n.grid[1]) * n.grid[1], a = this.containment ? i - this.offset.click.top >= this.containment[1] && i - this.offset.click.top <= this.containment[3] ? i : i - this.offset.click.top >= this.containment[1] ? i - n.grid[1] : i + n.grid[1] : i, o = this.originalPageX + Math.round((s - this.originalPageX) / n.grid[0]) * n.grid[0], s = this.containment ? o - this.offset.click.left >= this.containment[0] && o - this.offset.click.left <= this.containment[2] ? o : o - this.offset.click.left >= this.containment[0] ? o - n.grid[0] : o + n.grid[0] : o)), {
                        top: a - this.offset.click.top - this.offset.relative.top - this.offset.parent.top + ("fixed" === this.cssPosition ? -this.scrollParent.scrollTop() : l ? 0 : r.scrollTop()),
                        left: s - this.offset.click.left - this.offset.relative.left - this.offset.parent.left + ("fixed" === this.cssPosition ? -this.scrollParent.scrollLeft() : l ? 0 : r.scrollLeft())
                    }
                },
                _rearrange: function(e, t, i, o) {
                    i ? i[0].appendChild(this.placeholder[0]) : t.item[0].parentNode.insertBefore(this.placeholder[0], "down" === this.direction ? t.item[0] : t.item[0].nextSibling),
                    this.counter = this.counter ? ++this.counter : 1;
                    var n = this.counter;
                    this._delay((function() {
                        n === this.counter && this.refreshPositions(!o)
                    }))
                },
                _clear: function(e, t) {
                    this.reverting = !1;
                    var i,
                        o = [];
                    if (!this._noFinalSort && this.currentItem.parent().length && this.placeholder.before(this.currentItem), this._noFinalSort = null, this.helper[0] === this.currentItem[0]) {
                        for (i in this._storedCSS)
                            "auto" !== this._storedCSS[i] && "static" !== this._storedCSS[i] || (this._storedCSS[i] = "");
                        this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")
                    } else
                        this.currentItem.show();
                    function n(e, t, i) {
                        return function(o) {
                            i._trigger(e, o, t._uiHash(t))
                        }
                    }
                    for (this.fromOutside && !t && o.push((function(e) {
                        this._trigger("receive", e, this._uiHash(this.fromOutside))
                    })), !this.fromOutside && this.domPosition.prev === this.currentItem.prev().not(".ui-sortable-helper")[0] && this.domPosition.parent === this.currentItem.parent()[0] || t || o.push((function(e) {
                        this._trigger("update", e, this._uiHash())
                    })), this !== this.currentContainer && (t || (o.push((function(e) {
                        this._trigger("remove", e, this._uiHash())
                    })), o.push(function(e) {
                        return function(t) {
                            e._trigger("receive", t, this._uiHash(this))
                        }
                    }.call(this, this.currentContainer)), o.push(function(e) {
                        return function(t) {
                            e._trigger("update", t, this._uiHash(this))
                        }
                    }.call(this, this.currentContainer)))), i = this.containers.length - 1; i >= 0; i--)
                        t || o.push(n("deactivate", this, this.containers[i])),
                        this.containers[i].containerCache.over && (o.push(n("out", this, this.containers[i])), this.containers[i].containerCache.over = 0);
                    if (this.storedCursor && (this.document.find("body").css("cursor", this.storedCursor), this.storedStylesheet.remove()), this._storedOpacity && this.helper.css("opacity", this._storedOpacity), this._storedZIndex && this.helper.css("zIndex", "auto" === this._storedZIndex ? "" : this._storedZIndex), this.dragging = !1, this.cancelHelperRemoval) {
                        if (!t) {
                            for (this._trigger("beforeStop", e, this._uiHash()), i = 0; i < o.length; i++)
                                o[i].call(this, e);
                            this._trigger("stop", e, this._uiHash())
                        }
                        return this.fromOutside = !1, !1
                    }
                    if (t || this._trigger("beforeStop", e, this._uiHash()), this.placeholder[0].parentNode.removeChild(this.placeholder[0]), this.helper[0] !== this.currentItem[0] && this.helper.remove(), this.helper = null, !t) {
                        for (i = 0; i < o.length; i++)
                            o[i].call(this, e);
                        this._trigger("stop", e, this._uiHash())
                    }
                    return this.fromOutside = !1, !0
                },
                _trigger: function() {
                    !1 === e.Widget.prototype._trigger.apply(this, arguments) && this.cancel()
                },
                _uiHash: function(t) {
                    var i = t || this;
                    return {
                        helper: i.helper,
                        placeholder: i.placeholder || e([]),
                        position: i.position,
                        originalPosition: i.originalPosition,
                        offset: i.positionAbs,
                        item: i.currentItem,
                        sender: t ? t.element : null
                    }
                }
            })
        }(jQuery),
        function(e, t) {
            var i = 0,
                o = {},
                n = {};
            o.height = o.paddingTop = o.paddingBottom = o.borderTopWidth = o.borderBottomWidth = "hide",
            n.height = n.paddingTop = n.paddingBottom = n.borderTopWidth = n.borderBottomWidth = "show",
            e.widget("ui.accordion", {
                version: "1.10.4",
                options: {
                    active: 0,
                    animate: {},
                    collapsible: !1,
                    event: "click",
                    header: "> li > :first-child,> :not(li):even",
                    heightStyle: "auto",
                    icons: {
                        activeHeader: "ui-icon-triangle-1-s",
                        header: "ui-icon-triangle-1-e"
                    },
                    activate: null,
                    beforeActivate: null
                },
                _create: function() {
                    var t = this.options;
                    this.prevShow = this.prevHide = e(),
                    this.element.addClass("ui-accordion ui-widget ui-helper-reset").attr("role", "tablist"),
                    t.collapsible || !1 !== t.active && null != t.active || (t.active = 0),
                    this._processPanels(),
                    t.active < 0 && (t.active += this.headers.length),
                    this._refresh()
                },
                _getCreateEventData: function() {
                    return {
                        header: this.active,
                        panel: this.active.length ? this.active.next() : e(),
                        content: this.active.length ? this.active.next() : e()
                    }
                },
                _createIcons: function() {
                    var t = this.options.icons;
                    t && (e("<span>").addClass("ui-accordion-header-icon ui-icon " + t.header).prependTo(this.headers), this.active.children(".ui-accordion-header-icon").removeClass(t.header).addClass(t.activeHeader), this.headers.addClass("ui-accordion-icons"))
                },
                _destroyIcons: function() {
                    this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()
                },
                _destroy: function() {
                    var e;
                    this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"),
                    this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").each((function() {
                        /^ui-accordion/.test(this.id) && this.removeAttribute("id")
                    })),
                    this._destroyIcons(),
                    e = this.headers.next().css("display", "").removeAttr("role").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").each((function() {
                        /^ui-accordion/.test(this.id) && this.removeAttribute("id")
                    })),
                    "content" !== this.options.heightStyle && e.css("height", "")
                },
                _setOption: function(e, t) {
                    "active" !== e ? ("event" === e && (this.options.event && this._off(this.headers, this.options.event), this._setupEvents(t)), this._super(e, t), "collapsible" !== e || t || !1 !== this.options.active || this._activate(0), "icons" === e && (this._destroyIcons(), t && this._createIcons()), "disabled" === e && this.headers.add(this.headers.next()).toggleClass("ui-state-disabled", !!t)) : this._activate(t)
                },
                _keydown: function(t) {
                    if (!t.altKey && !t.ctrlKey) {
                        var i = e.ui.keyCode,
                            o = this.headers.length,
                            n = this.headers.index(t.target),
                            s = !1;
                        switch (t.keyCode) {
                        case i.RIGHT:
                        case i.DOWN:
                            s = this.headers[(n + 1) % o];
                            break;
                        case i.LEFT:
                        case i.UP:
                            s = this.headers[(n - 1 + o) % o];
                            break;
                        case i.SPACE:
                        case i.ENTER:
                            this._eventHandler(t);
                            break;
                        case i.HOME:
                            s = this.headers[0];
                            break;
                        case i.END:
                            s = this.headers[o - 1]
                        }
                        s && (e(t.target).attr("tabIndex", -1), e(s).attr("tabIndex", 0), s.focus(), t.preventDefault())
                    }
                },
                _panelKeyDown: function(t) {
                    t.keyCode === e.ui.keyCode.UP && t.ctrlKey && e(t.currentTarget).prev().focus()
                },
                refresh: function() {
                    var t = this.options;
                    this._processPanels(),
                    !1 === t.active && !0 === t.collapsible || !this.headers.length ? (t.active = !1, this.active = e()) : !1 === t.active ? this._activate(0) : this.active.length && !e.contains(this.element[0], this.active[0]) ? this.headers.length === this.headers.find(".ui-state-disabled").length ? (t.active = !1, this.active = e()) : this._activate(Math.max(0, t.active - 1)) : t.active = this.headers.index(this.active),
                    this._destroyIcons(),
                    this._refresh()
                },
                _processPanels: function() {
                    this.headers = this.element.find(this.options.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all"),
                    this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").filter(":not(.ui-accordion-content-active)").hide()
                },
                _refresh: function() {
                    var t,
                        o = this.options,
                        n = o.heightStyle,
                        s = this.element.parent(),
                        a = this.accordionId = "ui-accordion-" + (this.element.attr("id") || ++i);
                    this.active = this._findActive(o.active).addClass("ui-accordion-header-active ui-state-active ui-corner-top").removeClass("ui-corner-all"),
                    this.active.next().addClass("ui-accordion-content-active").show(),
                    this.headers.attr("role", "tab").each((function(t) {
                        var i = e(this),
                            o = i.attr("id"),
                            n = i.next(),
                            s = n.attr("id");
                        o || (o = a + "-header-" + t, i.attr("id", o)),
                        s || (s = a + "-panel-" + t, n.attr("id", s)),
                        i.attr("aria-controls", s),
                        n.attr("aria-labelledby", o)
                    })).next().attr("role", "tabpanel"),
                    this.headers.not(this.active).attr({
                        "aria-selected": "false",
                        "aria-expanded": "false",
                        tabIndex: -1
                    }).next().attr({
                        "aria-hidden": "true"
                    }).hide(),
                    this.active.length ? this.active.attr({
                        "aria-selected": "true",
                        "aria-expanded": "true",
                        tabIndex: 0
                    }).next().attr({
                        "aria-hidden": "false"
                    }) : this.headers.eq(0).attr("tabIndex", 0),
                    this._createIcons(),
                    this._setupEvents(o.event),
                    "fill" === n ? (t = s.height(), this.element.siblings(":visible").each((function() {
                        var i = e(this),
                            o = i.css("position");
                        "absolute" !== o && "fixed" !== o && (t -= i.outerHeight(!0))
                    })), this.headers.each((function() {
                        t -= e(this).outerHeight(!0)
                    })), this.headers.next().each((function() {
                        e(this).height(Math.max(0, t - e(this).innerHeight() + e(this).height()))
                    })).css("overflow", "auto")) : "auto" === n && (t = 0, this.headers.next().each((function() {
                        t = Math.max(t, e(this).css("height", "").height())
                    })).height(t))
                },
                _activate: function(t) {
                    var i = this._findActive(t)[0];
                    i !== this.active[0] && (i = i || this.active[0], this._eventHandler({
                        target: i,
                        currentTarget: i,
                        preventDefault: e.noop
                    }))
                },
                _findActive: function(t) {
                    return "number" == typeof t ? this.headers.eq(t) : e()
                },
                _setupEvents: function(t) {
                    var i = {
                        keydown: "_keydown"
                    };
                    t && e.each(t.split(" "), (function(e, t) {
                        i[t] = "_eventHandler"
                    })),
                    this._off(this.headers.add(this.headers.next())),
                    this._on(this.headers, i),
                    this._on(this.headers.next(), {
                        keydown: "_panelKeyDown"
                    }),
                    this._hoverable(this.headers),
                    this._focusable(this.headers)
                },
                _eventHandler: function(t) {
                    var i = this.options,
                        o = this.active,
                        n = e(t.currentTarget),
                        s = n[0] === o[0],
                        a = s && i.collapsible,
                        r = a ? e() : n.next(),
                        l = o.next(),
                        c = {
                            oldHeader: o,
                            oldPanel: l,
                            newHeader: a ? e() : n,
                            newPanel: r
                        };
                    t.preventDefault(),
                    s && !i.collapsible || !1 === this._trigger("beforeActivate", t, c) || (i.active = !a && this.headers.index(n), this.active = s ? e() : n, this._toggle(c), o.removeClass("ui-accordion-header-active ui-state-active"), i.icons && o.children(".ui-accordion-header-icon").removeClass(i.icons.activeHeader).addClass(i.icons.header), s || (n.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"), i.icons && n.children(".ui-accordion-header-icon").removeClass(i.icons.header).addClass(i.icons.activeHeader), n.next().addClass("ui-accordion-content-active")))
                },
                _toggle: function(t) {
                    var i = t.newPanel,
                        o = this.prevShow.length ? this.prevShow : t.oldPanel;
                    this.prevShow.add(this.prevHide).stop(!0, !0),
                    this.prevShow = i,
                    this.prevHide = o,
                    this.options.animate ? this._animate(i, o, t) : (o.hide(), i.show(), this._toggleComplete(t)),
                    o.attr({
                        "aria-hidden": "true"
                    }),
                    o.prev().attr("aria-selected", "false"),
                    i.length && o.length ? o.prev().attr({
                        tabIndex: -1,
                        "aria-expanded": "false"
                    }) : i.length && this.headers.filter((function() {
                        return 0 === e(this).attr("tabIndex")
                    })).attr("tabIndex", -1),
                    i.attr("aria-hidden", "false").prev().attr({
                        "aria-selected": "true",
                        tabIndex: 0,
                        "aria-expanded": "true"
                    })
                },
                _animate: function(e, t, i) {
                    var s,
                        a,
                        r,
                        l = this,
                        c = 0,
                        d = e.length && (!t.length || e.index() < t.index()),
                        h = this.options.animate || {},
                        p = d && h.down || h,
                        u = function() {
                            l._toggleComplete(i)
                        };
                    return "number" == typeof p && (r = p), "string" == typeof p && (a = p), a = a || p.easing || h.easing, r = r || p.duration || h.duration, t.length ? e.length ? (s = e.show().outerHeight(), t.animate(o, {
                        duration: r,
                        easing: a,
                        step: function(e, t) {
                            t.now = Math.round(e)
                        }
                    }), void e.hide().animate(n, {
                        duration: r,
                        easing: a,
                        complete: u,
                        step: function(e, i) {
                            i.now = Math.round(e),
                            "height" !== i.prop ? c += i.now : "content" !== l.options.heightStyle && (i.now = Math.round(s - t.outerHeight() - c), c = 0)
                        }
                    })) : t.animate(o, r, a, u) : e.animate(n, r, a, u)
                },
                _toggleComplete: function(e) {
                    var t = e.oldPanel;
                    t.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all"),
                    t.length && (t.parent()[0].className = t.parent()[0].className),
                    this._trigger("activate", null, e)
                }
            })
        }(jQuery),
        function(e, t) {
            e.widget("ui.autocomplete", {
                version: "1.10.4",
                defaultElement: "<input>",
                options: {
                    appendTo: null,
                    autoFocus: !1,
                    delay: 300,
                    minLength: 1,
                    position: {
                        my: "left top",
                        at: "left bottom",
                        collision: "none"
                    },
                    source: null,
                    change: null,
                    close: null,
                    focus: null,
                    open: null,
                    response: null,
                    search: null,
                    select: null
                },
                requestIndex: 0,
                pending: 0,
                _create: function() {
                    var t,
                        i,
                        o,
                        n = this.element[0].nodeName.toLowerCase(),
                        s = "textarea" === n,
                        a = "input" === n;
                    this.isMultiLine = !!s || !a && this.element.prop("isContentEditable"),
                    this.valueMethod = this.element[s || a ? "val" : "text"],
                    this.isNewMenu = !0,
                    this.element.addClass("ui-autocomplete-input").attr("autocomplete", "off"),
                    this._on(this.element, {
                        keydown: function(n) {
                            if (this.element.prop("readOnly"))
                                return t = !0, o = !0, void (i = !0);
                            t = !1,
                            o = !1,
                            i = !1;
                            var s = e.ui.keyCode;
                            switch (n.keyCode) {
                            case s.PAGE_UP:
                                t = !0,
                                this._move("previousPage", n);
                                break;
                            case s.PAGE_DOWN:
                                t = !0,
                                this._move("nextPage", n);
                                break;
                            case s.UP:
                                t = !0,
                                this._keyEvent("previous", n);
                                break;
                            case s.DOWN:
                                t = !0,
                                this._keyEvent("next", n);
                                break;
                            case s.ENTER:
                            case s.NUMPAD_ENTER:
                                this.menu.active && (t = !0, n.preventDefault(), this.menu.select(n));
                                break;
                            case s.TAB:
                                this.menu.active && this.menu.select(n);
                                break;
                            case s.ESCAPE:
                                this.menu.element.is(":visible") && (this._value(this.term), this.close(n), n.preventDefault());
                                break;
                            default:
                                i = !0,
                                this._searchTimeout(n)
                            }
                        },
                        keypress: function(o) {
                            if (t)
                                return t = !1, void (this.isMultiLine && !this.menu.element.is(":visible") || o.preventDefault());
                            if (!i) {
                                var n = e.ui.keyCode;
                                switch (o.keyCode) {
                                case n.PAGE_UP:
                                    this._move("previousPage", o);
                                    break;
                                case n.PAGE_DOWN:
                                    this._move("nextPage", o);
                                    break;
                                case n.UP:
                                    this._keyEvent("previous", o);
                                    break;
                                case n.DOWN:
                                    this._keyEvent("next", o)
                                }
                            }
                        },
                        input: function(e) {
                            if (o)
                                return o = !1, void e.preventDefault();
                            this._searchTimeout(e)
                        },
                        focus: function() {
                            this.selectedItem = null,
                            this.previous = this._value()
                        },
                        blur: function(e) {
                            this.cancelBlur ? delete this.cancelBlur : (clearTimeout(this.searching), this.close(e), this._change(e))
                        }
                    }),
                    this._initSource(),
                    this.menu = e("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({
                        role: null
                    }).hide().data("ui-menu"),
                    this._on(this.menu.element, {
                        mousedown: function(t) {
                            t.preventDefault(),
                            this.cancelBlur = !0,
                            this._delay((function() {
                                delete this.cancelBlur
                            }));
                            var i = this.menu.element[0];
                            e(t.target).closest(".ui-menu-item").length || this._delay((function() {
                                var t = this;
                                this.document.one("mousedown", (function(o) {
                                    o.target === t.element[0] || o.target === i || e.contains(i, o.target) || t.close()
                                }))
                            }))
                        },
                        menufocus: function(t, i) {
                            if (this.isNewMenu && (this.isNewMenu = !1, t.originalEvent && /^mouse/.test(t.originalEvent.type)))
                                return this.menu.blur(), void this.document.one("mousemove", (function() {
                                    e(t.target).trigger(t.originalEvent)
                                }));
                            var o = i.item.data("ui-autocomplete-item");
                            !1 !== this._trigger("focus", t, {
                                item: o
                            }) ? t.originalEvent && /^key/.test(t.originalEvent.type) && this._value(o.value) : this.liveRegion.text(o.value)
                        },
                        menuselect: function(e, t) {
                            var i = t.item.data("ui-autocomplete-item"),
                                o = this.previous;
                            this.element[0] !== this.document[0].activeElement && (this.element.focus(), this.previous = o, this._delay((function() {
                                this.previous = o,
                                this.selectedItem = i
                            }))),
                            !1 !== this._trigger("select", e, {
                                item: i
                            }) && this._value(i.value),
                            this.term = this._value(),
                            this.close(e),
                            this.selectedItem = i
                        }
                    }),
                    this.liveRegion = e("<span>", {
                        role: "status",
                        "aria-live": "polite"
                    }).addClass("ui-helper-hidden-accessible").insertBefore(this.element),
                    this._on(this.window, {
                        beforeunload: function() {
                            this.element.removeAttr("autocomplete")
                        }
                    })
                },
                _destroy: function() {
                    clearTimeout(this.searching),
                    this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),
                    this.menu.element.remove(),
                    this.liveRegion.remove()
                },
                _setOption: function(e, t) {
                    this._super(e, t),
                    "source" === e && this._initSource(),
                    "appendTo" === e && this.menu.element.appendTo(this._appendTo()),
                    "disabled" === e && t && this.xhr && this.xhr.abort()
                },
                _appendTo: function() {
                    var t = this.options.appendTo;
                    return t && (t = t.jquery || t.nodeType ? e(t) : this.document.find(t).eq(0)), t || (t = this.element.closest(".ui-front")), t.length || (t = this.document[0].body), t
                },
                _initSource: function() {
                    var t,
                        i,
                        o = this;
                    e.isArray(this.options.source) ? (t = this.options.source, this.source = function(i, o) {
                        o(e.ui.autocomplete.filter(t, i.term))
                    }) : "string" == typeof this.options.source ? (i = this.options.source, this.source = function(t, n) {
                        o.xhr && o.xhr.abort(),
                        o.xhr = e.ajax({
                            url: i,
                            data: t,
                            dataType: "json",
                            success: function(e) {
                                n(e)
                            },
                            error: function() {
                                n([])
                            }
                        })
                    }) : this.source = this.options.source
                },
                _searchTimeout: function(e) {
                    clearTimeout(this.searching),
                    this.searching = this._delay((function() {
                        this.term !== this._value() && (this.selectedItem = null, this.search(null, e))
                    }), this.options.delay)
                },
                search: function(e, t) {
                    return e = null != e ? e : this._value(), this.term = this._value(), e.length < this.options.minLength ? this.close(t) : !1 !== this._trigger("search", t) ? this._search(e) : void 0
                },
                _search: function(e) {
                    this.pending++,
                    this.element.addClass("ui-autocomplete-loading"),
                    this.cancelSearch = !1,
                    this.source({
                        term: e
                    }, this._response())
                },
                _response: function() {
                    var t = ++this.requestIndex;
                    return e.proxy((function(e) {
                        t === this.requestIndex && this.__response(e),
                        this.pending--,
                        this.pending || this.element.removeClass("ui-autocomplete-loading")
                    }), this)
                },
                __response: function(e) {
                    e && (e = this._normalize(e)),
                    this._trigger("response", null, {
                        content: e
                    }),
                    !this.options.disabled && e && e.length && !this.cancelSearch ? (this._suggest(e), this._trigger("open")) : this._close()
                },
                close: function(e) {
                    this.cancelSearch = !0,
                    this._close(e)
                },
                _close: function(e) {
                    this.menu.element.is(":visible") && (this.menu.element.hide(), this.menu.blur(), this.isNewMenu = !0, this._trigger("close", e))
                },
                _change: function(e) {
                    this.previous !== this._value() && this._trigger("change", e, {
                        item: this.selectedItem
                    })
                },
                _normalize: function(t) {
                    return t.length && t[0].label && t[0].value ? t : e.map(t, (function(t) {
                        return "string" == typeof t ? {
                            label: t,
                            value: t
                        } : e.extend({
                            label: t.label || t.value,
                            value: t.value || t.label
                        }, t)
                    }))
                },
                _suggest: function(t) {
                    var i = this.menu.element.empty();
                    this._renderMenu(i, t),
                    this.isNewMenu = !0,
                    this.menu.refresh(),
                    i.show(),
                    this._resizeMenu(),
                    i.position(e.extend({
                        of: this.element
                    }, this.options.position)),
                    this.options.autoFocus && this.menu.next()
                },
                _resizeMenu: function() {
                    var e = this.menu.element;
                    e.outerWidth(Math.max(e.width("").outerWidth() + 1, this.element.outerWidth()))
                },
                _renderMenu: function(t, i) {
                    var o = this;
                    e.each(i, (function(e, i) {
                        o._renderItemData(t, i)
                    }))
                },
                _renderItemData: function(e, t) {
                    return this._renderItem(e, t).data("ui-autocomplete-item", t)
                },
                _renderItem: function(t, i) {
                    return e("<li>").append(e("<a>").text(i.label)).appendTo(t)
                },
                _move: function(e, t) {
                    if (this.menu.element.is(":visible"))
                        return this.menu.isFirstItem() && /^previous/.test(e) || this.menu.isLastItem() && /^next/.test(e) ? (this._value(this.term), void this.menu.blur()) : void this.menu[e](t);
                    this.search(null, t)
                },
                widget: function() {
                    return this.menu.element
                },
                _value: function() {
                    return this.valueMethod.apply(this.element, arguments)
                },
                _keyEvent: function(e, t) {
                    this.isMultiLine && !this.menu.element.is(":visible") || (this._move(e, t), t.preventDefault())
                }
            }),
            e.extend(e.ui.autocomplete, {
                escapeRegex: function(e) {
                    return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g, "\\$&")
                },
                filter: function(t, i) {
                    var o = new RegExp(e.ui.autocomplete.escapeRegex(i), "i");
                    return e.grep(t, (function(e) {
                        return o.test(e.label || e.value || e)
                    }))
                }
            }),
            e.widget("ui.autocomplete", e.ui.autocomplete, {
                options: {
                    messages: {
                        noResults: "No search results.",
                        results: function(e) {
                            return e + (e > 1 ? " results are" : " result is") + " available, use up and down arrow keys to navigate."
                        }
                    }
                },
                __response: function(e) {
                    var t;
                    this._superApply(arguments),
                    this.options.disabled || this.cancelSearch || (t = e && e.length ? this.options.messages.results(e.length) : this.options.messages.noResults, this.liveRegion.text(t))
                }
            })
        }(jQuery),
        function(e, t) {
            var i,
                o = "ui-button ui-widget ui-state-default ui-corner-all",
                n = "ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",
                s = function() {
                    var t = e(this);
                    setTimeout((function() {
                        t.find(":ui-button").button("refresh")
                    }), 1)
                },
                a = function(t) {
                    var i = t.name,
                        o = t.form,
                        n = e([]);
                    return i && (i = i.replace(/'/g, "\\'"), n = o ? e(o).find("[name='" + i + "']") : e("[name='" + i + "']", t.ownerDocument).filter((function() {
                        return !this.form
                    }))), n
                };
            e.widget("ui.button", {
                version: "1.10.4",
                defaultElement: "<button>",
                options: {
                    disabled: null,
                    text: !0,
                    label: null,
                    icons: {
                        primary: null,
                        secondary: null
                    }
                },
                _create: function() {
                    this.element.closest("form").unbind("reset" + this.eventNamespace).bind("reset" + this.eventNamespace, s),
                    "boolean" != typeof this.options.disabled ? this.options.disabled = !!this.element.prop("disabled") : this.element.prop("disabled", this.options.disabled),
                    this._determineButtonType(),
                    this.hasTitle = !!this.buttonElement.attr("title");
                    var t = this,
                        n = this.options,
                        r = "checkbox" === this.type || "radio" === this.type,
                        l = r ? "" : "ui-state-active";
                    null === n.label && (n.label = "input" === this.type ? this.buttonElement.val() : this.buttonElement.html()),
                    this._hoverable(this.buttonElement),
                    this.buttonElement.addClass(o).attr("role", "button").bind("mouseenter" + this.eventNamespace, (function() {
                        n.disabled || this === i && e(this).addClass("ui-state-active")
                    })).bind("mouseleave" + this.eventNamespace, (function() {
                        n.disabled || e(this).removeClass(l)
                    })).bind("click" + this.eventNamespace, (function(e) {
                        n.disabled && (e.preventDefault(), e.stopImmediatePropagation())
                    })),
                    this._on({
                        focus: function() {
                            this.buttonElement.addClass("ui-state-focus")
                        },
                        blur: function() {
                            this.buttonElement.removeClass("ui-state-focus")
                        }
                    }),
                    r && this.element.bind("change" + this.eventNamespace, (function() {
                        t.refresh()
                    })),
                    "checkbox" === this.type ? this.buttonElement.bind("click" + this.eventNamespace, (function() {
                        if (n.disabled)
                            return !1
                    })) : "radio" === this.type ? this.buttonElement.bind("click" + this.eventNamespace, (function() {
                        if (n.disabled)
                            return !1;
                        e(this).addClass("ui-state-active"),
                        t.buttonElement.attr("aria-pressed", "true");
                        var i = t.element[0];
                        a(i).not(i).map((function() {
                            return e(this).button("widget")[0]
                        })).removeClass("ui-state-active").attr("aria-pressed", "false")
                    })) : (this.buttonElement.bind("mousedown" + this.eventNamespace, (function() {
                        if (n.disabled)
                            return !1;
                        e(this).addClass("ui-state-active"),
                        i = this,
                        t.document.one("mouseup", (function() {
                            i = null
                        }))
                    })).bind("mouseup" + this.eventNamespace, (function() {
                        if (n.disabled)
                            return !1;
                        e(this).removeClass("ui-state-active")
                    })).bind("keydown" + this.eventNamespace, (function(t) {
                        if (n.disabled)
                            return !1;
                        t.keyCode !== e.ui.keyCode.SPACE && t.keyCode !== e.ui.keyCode.ENTER || e(this).addClass("ui-state-active")
                    })).bind("keyup" + this.eventNamespace + " blur" + this.eventNamespace, (function() {
                        e(this).removeClass("ui-state-active")
                    })), this.buttonElement.is("a") && this.buttonElement.keyup((function(t) {
                        t.keyCode === e.ui.keyCode.SPACE && e(this).click()
                    }))),
                    this._setOption("disabled", n.disabled),
                    this._resetButton()
                },
                _determineButtonType: function() {
                    var e,
                        t,
                        i;
                    this.element.is("[type=checkbox]") ? this.type = "checkbox" : this.element.is("[type=radio]") ? this.type = "radio" : this.element.is("input") ? this.type = "input" : this.type = "button",
                    "checkbox" === this.type || "radio" === this.type ? (e = this.element.parents().last(), t = "label[for='" + this.element.attr("id") + "']", this.buttonElement = e.find(t), this.buttonElement.length || (e = e.length ? e.siblings() : this.element.siblings(), this.buttonElement = e.filter(t), this.buttonElement.length || (this.buttonElement = e.find(t))), this.element.addClass("ui-helper-hidden-accessible"), (i = this.element.is(":checked")) && this.buttonElement.addClass("ui-state-active"), this.buttonElement.prop("aria-pressed", i)) : this.buttonElement = this.element
                },
                widget: function() {
                    return this.buttonElement
                },
                _destroy: function() {
                    this.element.removeClass("ui-helper-hidden-accessible"),
                    this.buttonElement.removeClass(o + " ui-state-active " + n).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),
                    this.hasTitle || this.buttonElement.removeAttr("title")
                },
                _setOption: function(e, t) {
                    if (this._super(e, t), "disabled" === e)
                        return this.element.prop("disabled", !!t), void (t && this.buttonElement.removeClass("ui-state-focus"));
                    this._resetButton()
                },
                refresh: function() {
                    var t = this.element.is("input, button") ? this.element.is(":disabled") : this.element.hasClass("ui-button-disabled");
                    t !== this.options.disabled && this._setOption("disabled", t),
                    "radio" === this.type ? a(this.element[0]).each((function() {
                        e(this).is(":checked") ? e(this).button("widget").addClass("ui-state-active").attr("aria-pressed", "true") : e(this).button("widget").removeClass("ui-state-active").attr("aria-pressed", "false")
                    })) : "checkbox" === this.type && (this.element.is(":checked") ? this.buttonElement.addClass("ui-state-active").attr("aria-pressed", "true") : this.buttonElement.removeClass("ui-state-active").attr("aria-pressed", "false"))
                },
                _resetButton: function() {
                    if ("input" !== this.type) {
                        var t = this.buttonElement.removeClass(n),
                            i = e("<span></span>", this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(t.empty()).text(),
                            o = this.options.icons,
                            s = o.primary && o.secondary,
                            a = [];
                        o.primary || o.secondary ? (this.options.text && a.push("ui-button-text-icon" + (s ? "s" : o.primary ? "-primary" : "-secondary")), o.primary && t.prepend("<span class='ui-button-icon-primary ui-icon " + o.primary + "'></span>"), o.secondary && t.append("<span class='ui-button-icon-secondary ui-icon " + o.secondary + "'></span>"), this.options.text || (a.push(s ? "ui-button-icons-only" : "ui-button-icon-only"), this.hasTitle || t.attr("title", e.trim(i)))) : a.push("ui-button-text-only"),
                        t.addClass(a.join(" "))
                    } else
                        this.options.label && this.element.val(this.options.label)
                }
            }),
            e.widget("ui.buttonset", {
                version: "1.10.4",
                options: {
                    items: "button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"
                },
                _create: function() {
                    this.element.addClass("ui-buttonset")
                },
                _init: function() {
                    this.refresh()
                },
                _setOption: function(e, t) {
                    "disabled" === e && this.buttons.button("option", e, t),
                    this._super(e, t)
                },
                refresh: function() {
                    var t = "rtl" === this.element.css("direction");
                    this.buttons = this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map((function() {
                        return e(this).button("widget")[0]
                    })).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(t ? "ui-corner-right" : "ui-corner-left").end().filter(":last").addClass(t ? "ui-corner-left" : "ui-corner-right").end().end()
                },
                _destroy: function() {
                    this.element.removeClass("ui-buttonset"),
                    this.buttons.map((function() {
                        return e(this).button("widget")[0]
                    })).removeClass("ui-corner-left ui-corner-right").end().button("destroy")
                }
            })
        }(jQuery),
        function(e, t) {
            e.extend(e.ui, {
                datepicker: {
                    version: "1.10.4"
                }
            });
            var i,
                o = "datepicker";
            function n() {
                this._curInst = null,
                this._keyEvent = !1,
                this._disabledInputs = [],
                this._datepickerShowing = !1,
                this._inDialog = !1,
                this._mainDivId = "ui-datepicker-div",
                this._inlineClass = "ui-datepicker-inline",
                this._appendClass = "ui-datepicker-append",
                this._triggerClass = "ui-datepicker-trigger",
                this._dialogClass = "ui-datepicker-dialog",
                this._disableClass = "ui-datepicker-disabled",
                this._unselectableClass = "ui-datepicker-unselectable",
                this._currentClass = "ui-datepicker-current-day",
                this._dayOverClass = "ui-datepicker-days-cell-over",
                this.regional = [],
                this.regional[""] = {
                    closeText: "Done",
                    prevText: "Prev",
                    nextText: "Next",
                    currentText: "Today",
                    monthNames: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],
                    monthNamesShort: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
                    dayNames: ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"],
                    dayNamesShort: ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"],
                    dayNamesMin: ["Su", "Mo", "Tu", "We", "Th", "Fr", "Sa"],
                    weekHeader: "Wk",
                    dateFormat: "mm/dd/yy",
                    firstDay: 0,
                    isRTL: !1,
                    showMonthAfterYear: !1,
                    yearSuffix: ""
                },
                this._defaults = {
                    showOn: "focus",
                    showAnim: "fadeIn",
                    showOptions: {},
                    defaultDate: null,
                    appendText: "",
                    buttonText: "...",
                    buttonImage: "",
                    buttonImageOnly: !1,
                    hideIfNoPrevNext: !1,
                    navigationAsDateFormat: !1,
                    gotoCurrent: !1,
                    changeMonth: !1,
                    changeYear: !1,
                    yearRange: "c-10:c+10",
                    showOtherMonths: !1,
                    selectOtherMonths: !1,
                    showWeek: !1,
                    calculateWeek: this.iso8601Week,
                    shortYearCutoff: "+10",
                    minDate: null,
                    maxDate: null,
                    duration: "fast",
                    beforeShowDay: null,
                    beforeShow: null,
                    onSelect: null,
                    onChangeMonthYear: null,
                    onClose: null,
                    numberOfMonths: 1,
                    showCurrentAtPos: 0,
                    stepMonths: 1,
                    stepBigMonths: 12,
                    altField: "",
                    altFormat: "",
                    constrainInput: !0,
                    showButtonPanel: !1,
                    autoSize: !1,
                    disabled: !1
                },
                e.extend(this._defaults, this.regional[""]),
                this.dpDiv = s(e("<div id='" + this._mainDivId + "' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))
            }
            function s(t) {
                var o = "button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";
                return t.delegate(o, "mouseout", (function() {
                    e(this).removeClass("ui-state-hover"),
                    -1 !== this.className.indexOf("ui-datepicker-prev") && e(this).removeClass("ui-datepicker-prev-hover"),
                    -1 !== this.className.indexOf("ui-datepicker-next") && e(this).removeClass("ui-datepicker-next-hover")
                })).delegate(o, "mouseover", (function() {
                    e.datepicker._isDisabledDatepicker(i.inline ? t.parent()[0] : i.input[0]) || (e(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"), e(this).addClass("ui-state-hover"), -1 !== this.className.indexOf("ui-datepicker-prev") && e(this).addClass("ui-datepicker-prev-hover"), -1 !== this.className.indexOf("ui-datepicker-next") && e(this).addClass("ui-datepicker-next-hover"))
                }))
            }
            function a(t, i) {
                for (var o in e.extend(t, i), i)
                    null == i[o] && (t[o] = i[o]);
                return t
            }
            e.extend(n.prototype, {
                markerClassName: "hasDatepicker",
                maxRows: 4,
                _widgetDatepicker: function() {
                    return this.dpDiv
                },
                setDefaults: function(e) {
                    return a(this._defaults, e || {}), this
                },
                _attachDatepicker: function(t, i) {
                    var o,
                        n,
                        s;
                    n = "div" === (o = t.nodeName.toLowerCase()) || "span" === o,
                    t.id || (this.uuid += 1, t.id = "dp" + this.uuid),
                    (s = this._newInst(e(t), n)).settings = e.extend({}, i || {}),
                    "input" === o ? this._connectDatepicker(t, s) : n && this._inlineDatepicker(t, s)
                },
                _newInst: function(t, i) {
                    return {
                        id: t[0].id.replace(/([^A-Za-z0-9_\-])/g, "\\\\$1"),
                        input: t,
                        selectedDay: 0,
                        selectedMonth: 0,
                        selectedYear: 0,
                        drawMonth: 0,
                        drawYear: 0,
                        inline: i,
                        dpDiv: i ? s(e("<div class='" + this._inlineClass + " ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")) : this.dpDiv
                    }
                },
                _connectDatepicker: function(t, i) {
                    var n = e(t);
                    i.append = e([]),
                    i.trigger = e([]),
                    n.hasClass(this.markerClassName) || (this._attachments(n, i), n.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp), this._autoSize(i), e.data(t, o, i), i.settings.disabled && this._disableDatepicker(t))
                },
                _attachments: function(t, i) {
                    var o,
                        n,
                        s,
                        a = this._get(i, "appendText"),
                        r = this._get(i, "isRTL");
                    i.append && i.append.remove(),
                    a && (i.append = e("<span class='" + this._appendClass + "'>" + a + "</span>"), t[r ? "before" : "after"](i.append)),
                    t.unbind("focus", this._showDatepicker),
                    i.trigger && i.trigger.remove(),
                    "focus" !== (o = this._get(i, "showOn")) && "both" !== o || t.focus(this._showDatepicker),
                    "button" !== o && "both" !== o || (n = this._get(i, "buttonText"), s = this._get(i, "buttonImage"), i.trigger = e(this._get(i, "buttonImageOnly") ? e("<img/>").addClass(this._triggerClass).attr({
                        src: s,
                        alt: n,
                        title: n
                    }) : e("<button type='button'></button>").addClass(this._triggerClass).html(s ? e("<img/>").attr({
                        src: s,
                        alt: n,
                        title: n
                    }) : n)), t[r ? "before" : "after"](i.trigger), i.trigger.click((function() {
                        return e.datepicker._datepickerShowing && e.datepicker._lastInput === t[0] ? e.datepicker._hideDatepicker() : e.datepicker._datepickerShowing && e.datepicker._lastInput !== t[0] ? (e.datepicker._hideDatepicker(), e.datepicker._showDatepicker(t[0])) : e.datepicker._showDatepicker(t[0]), !1
                    })))
                },
                _autoSize: function(e) {
                    if (this._get(e, "autoSize") && !e.inline) {
                        var t,
                            i,
                            o,
                            n,
                            s = new Date(2009, 11, 20),
                            a = this._get(e, "dateFormat");
                        a.match(/[DM]/) && (t = function(e) {
                            for (i = 0, o = 0, n = 0; n < e.length; n++)
                                e[n].length > i && (i = e[n].length, o = n);
                            return o
                        }, s.setMonth(t(this._get(e, a.match(/MM/) ? "monthNames" : "monthNamesShort"))), s.setDate(t(this._get(e, a.match(/DD/) ? "dayNames" : "dayNamesShort")) + 20 - s.getDay())),
                        e.input.attr("size", this._formatDate(e, s).length)
                    }
                },
                _inlineDatepicker: function(t, i) {
                    var n = e(t);
                    n.hasClass(this.markerClassName) || (n.addClass(this.markerClassName).append(i.dpDiv), e.data(t, o, i), this._setDate(i, this._getDefaultDate(i), !0), this._updateDatepicker(i), this._updateAlternate(i), i.settings.disabled && this._disableDatepicker(t), i.dpDiv.css("display", "block"))
                },
                _dialogDatepicker: function(t, i, n, s, r) {
                    var l,
                        c,
                        d,
                        h,
                        p,
                        u = this._dialogInst;
                    return u || (this.uuid += 1, l = "dp" + this.uuid, this._dialogInput = e("<input type='text' id='" + l + "' style='position: absolute; top: -100px; width: 0px;'/>"), this._dialogInput.keydown(this._doKeyDown), e("body").append(this._dialogInput), (u = this._dialogInst = this._newInst(this._dialogInput, !1)).settings = {}, e.data(this._dialogInput[0], o, u)), a(u.settings, s || {}), i = i && i.constructor === Date ? this._formatDate(u, i) : i, this._dialogInput.val(i), this._pos = r ? r.length ? r : [r.pageX, r.pageY] : null, this._pos || (c = document.documentElement.clientWidth, d = document.documentElement.clientHeight, h = document.documentElement.scrollLeft || document.body.scrollLeft, p = document.documentElement.scrollTop || document.body.scrollTop, this._pos = [c / 2 - 100 + h, d / 2 - 150 + p]), this._dialogInput.css("left", this._pos[0] + 20 + "px").css("top", this._pos[1] + "px"), u.settings.onSelect = n, this._inDialog = !0, this.dpDiv.addClass(this._dialogClass), this._showDatepicker(this._dialogInput[0]), e.blockUI && e.blockUI(this.dpDiv), e.data(this._dialogInput[0], o, u), this
                },
                _destroyDatepicker: function(t) {
                    var i,
                        n = e(t),
                        s = e.data(t, o);
                    n.hasClass(this.markerClassName) && (i = t.nodeName.toLowerCase(), e.removeData(t, o), "input" === i ? (s.append.remove(), s.trigger.remove(), n.removeClass(this.markerClassName).unbind("focus", this._showDatepicker).unbind("keydown", this._doKeyDown).unbind("keypress", this._doKeyPress).unbind("keyup", this._doKeyUp)) : "div" !== i && "span" !== i || n.removeClass(this.markerClassName).empty())
                },
                _enableDatepicker: function(t) {
                    var i,
                        n,
                        s = e(t),
                        a = e.data(t, o);
                    s.hasClass(this.markerClassName) && ("input" === (i = t.nodeName.toLowerCase()) ? (t.disabled = !1, a.trigger.filter("button").each((function() {
                        this.disabled = !1
                    })).end().filter("img").css({
                        opacity: "1.0",
                        cursor: ""
                    })) : "div" !== i && "span" !== i || ((n = s.children("." + this._inlineClass)).children().removeClass("ui-state-disabled"), n.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled", !1)), this._disabledInputs = e.map(this._disabledInputs, (function(e) {
                        return e === t ? null : e
                    })))
                },
                _disableDatepicker: function(t) {
                    var i,
                        n,
                        s = e(t),
                        a = e.data(t, o);
                    s.hasClass(this.markerClassName) && ("input" === (i = t.nodeName.toLowerCase()) ? (t.disabled = !0, a.trigger.filter("button").each((function() {
                        this.disabled = !0
                    })).end().filter("img").css({
                        opacity: "0.5",
                        cursor: "default"
                    })) : "div" !== i && "span" !== i || ((n = s.children("." + this._inlineClass)).children().addClass("ui-state-disabled"), n.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled", !0)), this._disabledInputs = e.map(this._disabledInputs, (function(e) {
                        return e === t ? null : e
                    })), this._disabledInputs[this._disabledInputs.length] = t)
                },
                _isDisabledDatepicker: function(e) {
                    if (!e)
                        return !1;
                    for (var t = 0; t < this._disabledInputs.length; t++)
                        if (this._disabledInputs[t] === e)
                            return !0;
                    return !1
                },
                _getInst: function(t) {
                    try {
                        return e.data(t, o)
                    } catch (e) {
                        throw "Missing instance data for this datepicker"
                    }
                },
                _optionDatepicker: function(t, i, o) {
                    var n,
                        s,
                        r,
                        l,
                        c = this._getInst(t);
                    if (2 === arguments.length && "string" == typeof i)
                        return "defaults" === i ? e.extend({}, e.datepicker._defaults) : c ? "all" === i ? e.extend({}, c.settings) : this._get(c, i) : null;
                    n = i || {},
                    "string" == typeof i && ((n = {})[i] = o),
                    c && (this._curInst === c && this._hideDatepicker(), s = this._getDateDatepicker(t, !0), r = this._getMinMaxDate(c, "min"), l = this._getMinMaxDate(c, "max"), a(c.settings, n), null !== r && void 0 !== n.dateFormat && void 0 === n.minDate && (c.settings.minDate = this._formatDate(c, r)), null !== l && void 0 !== n.dateFormat && void 0 === n.maxDate && (c.settings.maxDate = this._formatDate(c, l)), "disabled" in n && (n.disabled ? this._disableDatepicker(t) : this._enableDatepicker(t)), this._attachments(e(t), c), this._autoSize(c), this._setDate(c, s), this._updateAlternate(c), this._updateDatepicker(c))
                },
                _changeDatepicker: function(e, t, i) {
                    this._optionDatepicker(e, t, i)
                },
                _refreshDatepicker: function(e) {
                    var t = this._getInst(e);
                    t && this._updateDatepicker(t)
                },
                _setDateDatepicker: function(e, t) {
                    var i = this._getInst(e);
                    i && (this._setDate(i, t), this._updateDatepicker(i), this._updateAlternate(i))
                },
                _getDateDatepicker: function(e, t) {
                    var i = this._getInst(e);
                    return i && !i.inline && this._setDateFromField(i, t), i ? this._getDate(i) : null
                },
                _doKeyDown: function(t) {
                    var i,
                        o,
                        n,
                        s = e.datepicker._getInst(t.target),
                        a = !0,
                        r = s.dpDiv.is(".ui-datepicker-rtl");
                    if (s._keyEvent = !0, e.datepicker._datepickerShowing)
                        switch (t.keyCode) {
                        case 9:
                            e.datepicker._hideDatepicker(),
                            a = !1;
                            break;
                        case 13:
                            return (n = e("td." + e.datepicker._dayOverClass + ":not(." + e.datepicker._currentClass + ")", s.dpDiv))[0] && e.datepicker._selectDay(t.target, s.selectedMonth, s.selectedYear, n[0]), (i = e.datepicker._get(s, "onSelect")) ? (o = e.datepicker._formatDate(s), i.apply(s.input ? s.input[0] : null, [o, s])) : e.datepicker._hideDatepicker(), !1;
                        case 27:
                            e.datepicker._hideDatepicker();
                            break;
                        case 33:
                            e.datepicker._adjustDate(t.target, t.ctrlKey ? -e.datepicker._get(s, "stepBigMonths") : -e.datepicker._get(s, "stepMonths"), "M");
                            break;
                        case 34:
                            e.datepicker._adjustDate(t.target, t.ctrlKey ? +e.datepicker._get(s, "stepBigMonths") : +e.datepicker._get(s, "stepMonths"), "M");
                            break;
                        case 35:
                            (t.ctrlKey || t.metaKey) && e.datepicker._clearDate(t.target),
                            a = t.ctrlKey || t.metaKey;
                            break;
                        case 36:
                            (t.ctrlKey || t.metaKey) && e.datepicker._gotoToday(t.target),
                            a = t.ctrlKey || t.metaKey;
                            break;
                        case 37:
                            (t.ctrlKey || t.metaKey) && e.datepicker._adjustDate(t.target, r ? 1 : -1, "D"),
                            a = t.ctrlKey || t.metaKey,
                            t.originalEvent.altKey && e.datepicker._adjustDate(t.target, t.ctrlKey ? -e.datepicker._get(s, "stepBigMonths") : -e.datepicker._get(s, "stepMonths"), "M");
                            break;
                        case 38:
                            (t.ctrlKey || t.metaKey) && e.datepicker._adjustDate(t.target, -7, "D"),
                            a = t.ctrlKey || t.metaKey;
                            break;
                        case 39:
                            (t.ctrlKey || t.metaKey) && e.datepicker._adjustDate(t.target, r ? -1 : 1, "D"),
                            a = t.ctrlKey || t.metaKey,
                            t.originalEvent.altKey && e.datepicker._adjustDate(t.target, t.ctrlKey ? +e.datepicker._get(s, "stepBigMonths") : +e.datepicker._get(s, "stepMonths"), "M");
                            break;
                        case 40:
                            (t.ctrlKey || t.metaKey) && e.datepicker._adjustDate(t.target, 7, "D"),
                            a = t.ctrlKey || t.metaKey;
                            break;
                        default:
                            a = !1
                        }
                    else
                        36 === t.keyCode && t.ctrlKey ? e.datepicker._showDatepicker(this) : a = !1;
                    a && (t.preventDefault(), t.stopPropagation())
                },
                _doKeyPress: function(t) {
                    var i,
                        o,
                        n = e.datepicker._getInst(t.target);
                    if (e.datepicker._get(n, "constrainInput"))
                        return i = e.datepicker._possibleChars(e.datepicker._get(n, "dateFormat")), o = String.fromCharCode(null == t.charCode ? t.keyCode : t.charCode), t.ctrlKey || t.metaKey || o < " " || !i || i.indexOf(o) > -1
                },
                _doKeyUp: function(t) {
                    var i = e.datepicker._getInst(t.target);
                    if (i.input.val() !== i.lastVal)
                        try {
                            e.datepicker.parseDate(e.datepicker._get(i, "dateFormat"), i.input ? i.input.val() : null, e.datepicker._getFormatConfig(i)) && (e.datepicker._setDateFromField(i), e.datepicker._updateAlternate(i), e.datepicker._updateDatepicker(i))
                        } catch (e) {}
                    return !0
                },
                _showDatepicker: function(t) {
                    var i,
                        o,
                        n,
                        s,
                        r,
                        l,
                        c;
                    ("input" !== (t = t.target || t).nodeName.toLowerCase() && (t = e("input", t.parentNode)[0]), e.datepicker._isDisabledDatepicker(t) || e.datepicker._lastInput === t) || (i = e.datepicker._getInst(t), e.datepicker._curInst && e.datepicker._curInst !== i && (e.datepicker._curInst.dpDiv.stop(!0, !0), i && e.datepicker._datepickerShowing && e.datepicker._hideDatepicker(e.datepicker._curInst.input[0])), !1 !== (n = (o = e.datepicker._get(i, "beforeShow")) ? o.apply(t, [t, i]) : {}) && (a(i.settings, n), i.lastVal = null, e.datepicker._lastInput = t, e.datepicker._setDateFromField(i), e.datepicker._inDialog && (t.value = ""), e.datepicker._pos || (e.datepicker._pos = e.datepicker._findPos(t), e.datepicker._pos[1] += t.offsetHeight), s = !1, e(t).parents().each((function() {
                        return !(s |= "fixed" === e(this).css("position"))
                    })), r = {
                        left: e.datepicker._pos[0],
                        top: e.datepicker._pos[1]
                    }, e.datepicker._pos = null, i.dpDiv.empty(), i.dpDiv.css({
                        position: "absolute",
                        display: "block",
                        top: "-1000px"
                    }), e.datepicker._updateDatepicker(i), r = e.datepicker._checkOffset(i, r, s), i.dpDiv.css({
                        position: e.datepicker._inDialog && e.blockUI ? "static" : s ? "fixed" : "absolute",
                        display: "none",
                        left: r.left + "px",
                        top: r.top + "px"
                    }), i.inline || (l = e.datepicker._get(i, "showAnim"), c = e.datepicker._get(i, "duration"), i.dpDiv.zIndex(e(t).zIndex() + 1), e.datepicker._datepickerShowing = !0, e.effects && e.effects.effect[l] ? i.dpDiv.show(l, e.datepicker._get(i, "showOptions"), c) : i.dpDiv[l || "show"](l ? c : null), e.datepicker._shouldFocusInput(i) && i.input.focus(), e.datepicker._curInst = i)))
                },
                _updateDatepicker: function(t) {
                    this.maxRows = 4,
                    i = t,
                    t.dpDiv.empty().append(this._generateHTML(t)),
                    this._attachHandlers(t),
                    t.dpDiv.find("." + this._dayOverClass + " a").mouseover();
                    var o,
                        n = this._getNumberOfMonths(t),
                        s = n[1];
                    t.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),
                    s > 1 && t.dpDiv.addClass("ui-datepicker-multi-" + s).css("width", 17 * s + "em"),
                    t.dpDiv[(1 !== n[0] || 1 !== n[1] ? "add" : "remove") + "Class"]("ui-datepicker-multi"),
                    t.dpDiv[(this._get(t, "isRTL") ? "add" : "remove") + "Class"]("ui-datepicker-rtl"),
                    t === e.datepicker._curInst && e.datepicker._datepickerShowing && e.datepicker._shouldFocusInput(t) && t.input.focus(),
                    t.yearshtml && (o = t.yearshtml, setTimeout((function() {
                        o === t.yearshtml && t.yearshtml && t.dpDiv.find("select.ui-datepicker-year:first").replaceWith(t.yearshtml),
                        o = t.yearshtml = null
                    }), 0))
                },
                _shouldFocusInput: function(e) {
                    return e.input && e.input.is(":visible") && !e.input.is(":disabled") && !e.input.is(":focus")
                },
                _checkOffset: function(t, i, o) {
                    var n = t.dpDiv.outerWidth(),
                        s = t.dpDiv.outerHeight(),
                        a = t.input ? t.input.outerWidth() : 0,
                        r = t.input ? t.input.outerHeight() : 0,
                        l = document.documentElement.clientWidth + (o ? 0 : e(document).scrollLeft()),
                        c = document.documentElement.clientHeight + (o ? 0 : e(document).scrollTop());
                    return i.left -= this._get(t, "isRTL") ? n - a : 0, i.left -= o && i.left === t.input.offset().left ? e(document).scrollLeft() : 0, i.top -= o && i.top === t.input.offset().top + r ? e(document).scrollTop() : 0, i.left -= Math.min(i.left, i.left + n > l && l > n ? Math.abs(i.left + n - l) : 0), i.top -= Math.min(i.top, i.top + s > c && c > s ? Math.abs(s + r) : 0), i
                },
                _findPos: function(t) {
                    for (var i, o = this._getInst(t), n = this._get(o, "isRTL"); t && ("hidden" === t.type || 1 !== t.nodeType || e.expr.filters.hidden(t));)
                        t = t[n ? "previousSibling" : "nextSibling"];
                    return [(i = e(t).offset()).left, i.top]
                },
                _hideDatepicker: function(t) {
                    var i,
                        n,
                        s,
                        a,
                        r = this._curInst;
                    !r || t && r !== e.data(t, o) || this._datepickerShowing && (i = this._get(r, "showAnim"), n = this._get(r, "duration"), s = function() {
                        e.datepicker._tidyDialog(r)
                    }, e.effects && (e.effects.effect[i] || e.effects[i]) ? r.dpDiv.hide(i, e.datepicker._get(r, "showOptions"), n, s) : r.dpDiv["slideDown" === i ? "slideUp" : "fadeIn" === i ? "fadeOut" : "hide"](i ? n : null, s), i || s(), this._datepickerShowing = !1, (a = this._get(r, "onClose")) && a.apply(r.input ? r.input[0] : null, [r.input ? r.input.val() : "", r]), this._lastInput = null, this._inDialog && (this._dialogInput.css({
                        position: "absolute",
                        left: "0",
                        top: "-100px"
                    }), e.blockUI && (e.unblockUI(), e("body").append(this.dpDiv))), this._inDialog = !1)
                },
                _tidyDialog: function(e) {
                    e.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")
                },
                _checkExternalClick: function(t) {
                    if (e.datepicker._curInst) {
                        var i = e(t.target),
                            o = e.datepicker._getInst(i[0]);
                        (i[0].id === e.datepicker._mainDivId || 0 !== i.parents("#" + e.datepicker._mainDivId).length || i.hasClass(e.datepicker.markerClassName) || i.closest("." + e.datepicker._triggerClass).length || !e.datepicker._datepickerShowing || e.datepicker._inDialog && e.blockUI) && (!i.hasClass(e.datepicker.markerClassName) || e.datepicker._curInst === o) || e.datepicker._hideDatepicker()
                    }
                },
                _adjustDate: function(t, i, o) {
                    var n = e(t),
                        s = this._getInst(n[0]);
                    this._isDisabledDatepicker(n[0]) || (this._adjustInstDate(s, i + ("M" === o ? this._get(s, "showCurrentAtPos") : 0), o), this._updateDatepicker(s))
                },
                _gotoToday: function(t) {
                    var i,
                        o = e(t),
                        n = this._getInst(o[0]);
                    this._get(n, "gotoCurrent") && n.currentDay ? (n.selectedDay = n.currentDay, n.drawMonth = n.selectedMonth = n.currentMonth, n.drawYear = n.selectedYear = n.currentYear) : (i = new Date, n.selectedDay = i.getDate(), n.drawMonth = n.selectedMonth = i.getMonth(), n.drawYear = n.selectedYear = i.getFullYear()),
                    this._notifyChange(n),
                    this._adjustDate(o)
                },
                _selectMonthYear: function(t, i, o) {
                    var n = e(t),
                        s = this._getInst(n[0]);
                    s["selected" + ("M" === o ? "Month" : "Year")] = s["draw" + ("M" === o ? "Month" : "Year")] = parseInt(i.options[i.selectedIndex].value, 10),
                    this._notifyChange(s),
                    this._adjustDate(n)
                },
                _selectDay: function(t, i, o, n) {
                    var s,
                        a = e(t);
                    e(n).hasClass(this._unselectableClass) || this._isDisabledDatepicker(a[0]) || ((s = this._getInst(a[0])).selectedDay = s.currentDay = e("a", n).html(), s.selectedMonth = s.currentMonth = i, s.selectedYear = s.currentYear = o, this._selectDate(t, this._formatDate(s, s.currentDay, s.currentMonth, s.currentYear)))
                },
                _clearDate: function(t) {
                    var i = e(t);
                    this._selectDate(i, "")
                },
                _selectDate: function(t, i) {
                    var o,
                        n = e(t),
                        s = this._getInst(n[0]);
                    i = null != i ? i : this._formatDate(s),
                    s.input && s.input.val(i),
                    this._updateAlternate(s),
                    (o = this._get(s, "onSelect")) ? o.apply(s.input ? s.input[0] : null, [i, s]) : s.input && s.input.trigger("change"),
                    s.inline ? this._updateDatepicker(s) : (this._hideDatepicker(), this._lastInput = s.input[0], "object" != typeof s.input[0] && s.input.focus(), this._lastInput = null)
                },
                _updateAlternate: function(t) {
                    var i,
                        o,
                        n,
                        s = this._get(t, "altField");
                    s && (i = this._get(t, "altFormat") || this._get(t, "dateFormat"), o = this._getDate(t), n = this.formatDate(i, o, this._getFormatConfig(t)), e(s).each((function() {
                        e(this).val(n)
                    })))
                },
                noWeekends: function(e) {
                    var t = e.getDay();
                    return [t > 0 && t < 6, ""]
                },
                iso8601Week: function(e) {
                    var t,
                        i = new Date(e.getTime());
                    return i.setDate(i.getDate() + 4 - (i.getDay() || 7)), t = i.getTime(), i.setMonth(0), i.setDate(1), Math.floor(Math.round((t - i) / 864e5) / 7) + 1
                },
                parseDate: function(t, i, o) {
                    if (null == t || null == i)
                        throw "Invalid arguments";
                    if ("" === (i = "object" == typeof i ? i.toString() : i + ""))
                        return null;
                    var n,
                        s,
                        a,
                        r,
                        l = 0,
                        c = (o ? o.shortYearCutoff : null) || this._defaults.shortYearCutoff,
                        d = "string" != typeof c ? c : (new Date).getFullYear() % 100 + parseInt(c, 10),
                        h = (o ? o.dayNamesShort : null) || this._defaults.dayNamesShort,
                        p = (o ? o.dayNames : null) || this._defaults.dayNames,
                        u = (o ? o.monthNamesShort : null) || this._defaults.monthNamesShort,
                        f = (o ? o.monthNames : null) || this._defaults.monthNames,
                        m = -1,
                        g = -1,
                        v = -1,
                        b = -1,
                        y = !1,
                        w = function(e) {
                            var i = n + 1 < t.length && t.charAt(n + 1) === e;
                            return i && n++, i
                        },
                        x = function(e) {
                            var t = w(e),
                                o = new RegExp("^\\d{1," + ("@" === e ? 14 : "!" === e ? 20 : "y" === e && t ? 4 : "o" === e ? 3 : 2) + "}"),
                                n = i.substring(l).match(o);
                            if (!n)
                                throw "Missing number at position " + l;
                            return l += n[0].length, parseInt(n[0], 10)
                        },
                        T = function(t, o, n) {
                            var s = -1,
                                a = e.map(w(t) ? n : o, (function(e, t) {
                                    return [[t, e]]
                                })).sort((function(e, t) {
                                    return -(e[1].length - t[1].length)
                                }));
                            if (e.each(a, (function(e, t) {
                                var o = t[1];
                                if (i.substr(l, o.length).toLowerCase() === o.toLowerCase())
                                    return s = t[0], l += o.length, !1
                            })), -1 !== s)
                                return s + 1;
                            throw "Unknown name at position " + l
                        },
                        $ = function() {
                            if (i.charAt(l) !== t.charAt(n))
                                throw "Unexpected literal at position " + l;
                            l++
                        };
                    for (n = 0; n < t.length; n++)
                        if (y)
                            "'" !== t.charAt(n) || w("'") ? $() : y = !1;
                        else
                            switch (t.charAt(n)) {
                            case "d":
                                v = x("d");
                                break;
                            case "D":
                                T("D", h, p);
                                break;
                            case "o":
                                b = x("o");
                                break;
                            case "m":
                                g = x("m");
                                break;
                            case "M":
                                g = T("M", u, f);
                                break;
                            case "y":
                                m = x("y");
                                break;
                            case "@":
                                m = (r = new Date(x("@"))).getFullYear(),
                                g = r.getMonth() + 1,
                                v = r.getDate();
                                break;
                            case "!":
                                m = (r = new Date((x("!") - this._ticksTo1970) / 1e4)).getFullYear(),
                                g = r.getMonth() + 1,
                                v = r.getDate();
                                break;
                            case "'":
                                w("'") ? $() : y = !0;
                                break;
                            default:
                                $()
                            }
                    if (l < i.length && (a = i.substr(l), !/^\s+/.test(a)))
                        throw "Extra/unparsed characters found in date: " + a;
                    if (-1 === m ? m = (new Date).getFullYear() : m < 100 && (m += (new Date).getFullYear() - (new Date).getFullYear() % 100 + (m <= d ? 0 : -100)), b > -1)
                        for (g = 1, v = b;;) {
                            if (v <= (s = this._getDaysInMonth(m, g - 1)))
                                break;
                            g++,
                            v -= s
                        }
                    if ((r = this._daylightSavingAdjust(new Date(m, g - 1, v))).getFullYear() !== m || r.getMonth() + 1 !== g || r.getDate() !== v)
                        throw "Invalid date";
                    return r
                },
                ATOM: "yy-mm-dd",
                COOKIE: "D, dd M yy",
                ISO_8601: "yy-mm-dd",
                RFC_822: "D, d M y",
                RFC_850: "DD, dd-M-y",
                RFC_1036: "D, d M y",
                RFC_1123: "D, d M yy",
                RFC_2822: "D, d M yy",
                RSS: "D, d M y",
                TICKS: "!",
                TIMESTAMP: "@",
                W3C: "yy-mm-dd",
                _ticksTo1970: 24 * (718685 + Math.floor(492.5) - Math.floor(19.7) + Math.floor(4.925)) * 60 * 60 * 1e7,
                formatDate: function(e, t, i) {
                    if (!t)
                        return "";
                    var o,
                        n = (i ? i.dayNamesShort : null) || this._defaults.dayNamesShort,
                        s = (i ? i.dayNames : null) || this._defaults.dayNames,
                        a = (i ? i.monthNamesShort : null) || this._defaults.monthNamesShort,
                        r = (i ? i.monthNames : null) || this._defaults.monthNames,
                        l = function(t) {
                            var i = o + 1 < e.length && e.charAt(o + 1) === t;
                            return i && o++, i
                        },
                        c = function(e, t, i) {
                            var o = "" + t;
                            if (l(e))
                                for (; o.length < i;)
                                    o = "0" + o;
                            return o
                        },
                        d = function(e, t, i, o) {
                            return l(e) ? o[t] : i[t]
                        },
                        h = "",
                        p = !1;
                    if (t)
                        for (o = 0; o < e.length; o++)
                            if (p)
                                "'" !== e.charAt(o) || l("'") ? h += e.charAt(o) : p = !1;
                            else
                                switch (e.charAt(o)) {
                                case "d":
                                    h += c("d", t.getDate(), 2);
                                    break;
                                case "D":
                                    h += d("D", t.getDay(), n, s);
                                    break;
                                case "o":
                                    h += c("o", Math.round((new Date(t.getFullYear(), t.getMonth(), t.getDate()).getTime() - new Date(t.getFullYear(), 0, 0).getTime()) / 864e5), 3);
                                    break;
                                case "m":
                                    h += c("m", t.getMonth() + 1, 2);
                                    break;
                                case "M":
                                    h += d("M", t.getMonth(), a, r);
                                    break;
                                case "y":
                                    h += l("y") ? t.getFullYear() : (t.getYear() % 100 < 10 ? "0" : "") + t.getYear() % 100;
                                    break;
                                case "@":
                                    h += t.getTime();
                                    break;
                                case "!":
                                    h += 1e4 * t.getTime() + this._ticksTo1970;
                                    break;
                                case "'":
                                    l("'") ? h += "'" : p = !0;
                                    break;
                                default:
                                    h += e.charAt(o)
                                }
                    return h
                },
                _possibleChars: function(e) {
                    var t,
                        i = "",
                        o = !1,
                        n = function(i) {
                            var o = t + 1 < e.length && e.charAt(t + 1) === i;
                            return o && t++, o
                        };
                    for (t = 0; t < e.length; t++)
                        if (o)
                            "'" !== e.charAt(t) || n("'") ? i += e.charAt(t) : o = !1;
                        else
                            switch (e.charAt(t)) {
                            case "d":
                            case "m":
                            case "y":
                            case "@":
                                i += "0123456789";
                                break;
                            case "D":
                            case "M":
                                return null;
                            case "'":
                                n("'") ? i += "'" : o = !0;
                                break;
                            default:
                                i += e.charAt(t)
                            }
                    return i
                },
                _get: function(e, t) {
                    return void 0 !== e.settings[t] ? e.settings[t] : this._defaults[t]
                },
                _setDateFromField: function(e, t) {
                    if (e.input.val() !== e.lastVal) {
                        var i = this._get(e, "dateFormat"),
                            o = e.lastVal = e.input ? e.input.val() : null,
                            n = this._getDefaultDate(e),
                            s = n,
                            a = this._getFormatConfig(e);
                        try {
                            s = this.parseDate(i, o, a) || n
                        } catch (e) {
                            o = t ? "" : o
                        }
                        e.selectedDay = s.getDate(),
                        e.drawMonth = e.selectedMonth = s.getMonth(),
                        e.drawYear = e.selectedYear = s.getFullYear(),
                        e.currentDay = o ? s.getDate() : 0,
                        e.currentMonth = o ? s.getMonth() : 0,
                        e.currentYear = o ? s.getFullYear() : 0,
                        this._adjustInstDate(e)
                    }
                },
                _getDefaultDate: function(e) {
                    return this._restrictMinMax(e, this._determineDate(e, this._get(e, "defaultDate"), new Date))
                },
                _determineDate: function(t, i, o) {
                    var n = null == i || "" === i ? o : "string" == typeof i ? function(i) {
                        try {
                            return e.datepicker.parseDate(e.datepicker._get(t, "dateFormat"), i, e.datepicker._getFormatConfig(t))
                        } catch (e) {}
                        for (var o = (i.toLowerCase().match(/^c/) ? e.datepicker._getDate(t) : null) || new Date, n = o.getFullYear(), s = o.getMonth(), a = o.getDate(), r = /([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g, l = r.exec(i); l;) {
                            switch (l[2] || "d") {
                            case "d":
                            case "D":
                                a += parseInt(l[1], 10);
                                break;
                            case "w":
                            case "W":
                                a += 7 * parseInt(l[1], 10);
                                break;
                            case "m":
                            case "M":
                                s += parseInt(l[1], 10),
                                a = Math.min(a, e.datepicker._getDaysInMonth(n, s));
                                break;
                            case "y":
                            case "Y":
                                n += parseInt(l[1], 10),
                                a = Math.min(a, e.datepicker._getDaysInMonth(n, s))
                            }
                            l = r.exec(i)
                        }
                        return new Date(n, s, a)
                    }(i) : "number" == typeof i ? isNaN(i) ? o : function(e) {
                        var t = new Date;
                        return t.setDate(t.getDate() + e), t
                    }(i) : new Date(i.getTime());
                    return (n = n && "Invalid Date" === n.toString() ? o : n) && (n.setHours(0), n.setMinutes(0), n.setSeconds(0), n.setMilliseconds(0)), this._daylightSavingAdjust(n)
                },
                _daylightSavingAdjust: function(e) {
                    return e ? (e.setHours(e.getHours() > 12 ? e.getHours() + 2 : 0), e) : null
                },
                _setDate: function(e, t, i) {
                    var o = !t,
                        n = e.selectedMonth,
                        s = e.selectedYear,
                        a = this._restrictMinMax(e, this._determineDate(e, t, new Date));
                    e.selectedDay = e.currentDay = a.getDate(),
                    e.drawMonth = e.selectedMonth = e.currentMonth = a.getMonth(),
                    e.drawYear = e.selectedYear = e.currentYear = a.getFullYear(),
                    n === e.selectedMonth && s === e.selectedYear || i || this._notifyChange(e),
                    this._adjustInstDate(e),
                    e.input && e.input.val(o ? "" : this._formatDate(e))
                },
                _getDate: function(e) {
                    return !e.currentYear || e.input && "" === e.input.val() ? null : this._daylightSavingAdjust(new Date(e.currentYear, e.currentMonth, e.currentDay))
                },
                _attachHandlers: function(t) {
                    var i = this._get(t, "stepMonths"),
                        o = "#" + t.id.replace(/\\\\/g, "\\");
                    t.dpDiv.find("[data-handler]").map((function() {
                        var t = {
                            prev: function() {
                                e.datepicker._adjustDate(o, -i, "M")
                            },
                            next: function() {
                                e.datepicker._adjustDate(o, +i, "M")
                            },
                            hide: function() {
                                e.datepicker._hideDatepicker()
                            },
                            today: function() {
                                e.datepicker._gotoToday(o)
                            },
                            selectDay: function() {
                                return e.datepicker._selectDay(o, +this.getAttribute("data-month"), +this.getAttribute("data-year"), this), !1
                            },
                            selectMonth: function() {
                                return e.datepicker._selectMonthYear(o, this, "M"), !1
                            },
                            selectYear: function() {
                                return e.datepicker._selectMonthYear(o, this, "Y"), !1
                            }
                        };
                        e(this).bind(this.getAttribute("data-event"), t[this.getAttribute("data-handler")])
                    }))
                },
                _generateHTML: function(e) {
                    var t,
                        i,
                        o,
                        n,
                        s,
                        a,
                        r,
                        l,
                        c,
                        d,
                        h,
                        p,
                        u,
                        f,
                        m,
                        g,
                        v,
                        b,
                        y,
                        w,
                        x,
                        T,
                        $,
                        C,
                        k,
                        S,
                        E,
                        _,
                        D,
                        M,
                        N,
                        I,
                        O,
                        R,
                        j,
                        L,
                        F,
                        A,
                        H,
                        P = new Date,
                        U = this._daylightSavingAdjust(new Date(P.getFullYear(), P.getMonth(), P.getDate())),
                        z = this._get(e, "isRTL"),
                        V = this._get(e, "showButtonPanel"),
                        W = this._get(e, "hideIfNoPrevNext"),
                        B = this._get(e, "navigationAsDateFormat"),
                        q = this._getNumberOfMonths(e),
                        Y = this._get(e, "showCurrentAtPos"),
                        X = this._get(e, "stepMonths"),
                        G = 1 !== q[0] || 1 !== q[1],
                        J = this._daylightSavingAdjust(e.currentDay ? new Date(e.currentYear, e.currentMonth, e.currentDay) : new Date(9999, 9, 9)),
                        K = this._getMinMaxDate(e, "min"),
                        Q = this._getMinMaxDate(e, "max"),
                        Z = e.drawMonth - Y,
                        ee = e.drawYear;
                    if (Z < 0 && (Z += 12, ee--), Q)
                        for (t = this._daylightSavingAdjust(new Date(Q.getFullYear(), Q.getMonth() - q[0] * q[1] + 1, Q.getDate())), t = K && t < K ? K : t; this._daylightSavingAdjust(new Date(ee, Z, 1)) > t;)
                            --Z < 0 && (Z = 11, ee--);
                    for (e.drawMonth = Z, e.drawYear = ee, i = this._get(e, "prevText"), i = B ? this.formatDate(i, this._daylightSavingAdjust(new Date(ee, Z - X, 1)), this._getFormatConfig(e)) : i, o = this._canAdjustMonth(e, -1, ee, Z) ? "<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='" + i + "'><span class='ui-icon ui-icon-circle-triangle-" + (z ? "e" : "w") + "'>" + i + "</span></a>" : W ? "" : "<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='" + i + "'><span class='ui-icon ui-icon-circle-triangle-" + (z ? "e" : "w") + "'>" + i + "</span></a>", n = this._get(e, "nextText"), n = B ? this.formatDate(n, this._daylightSavingAdjust(new Date(ee, Z + X, 1)), this._getFormatConfig(e)) : n, s = this._canAdjustMonth(e, 1, ee, Z) ? "<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='" + n + "'><span class='ui-icon ui-icon-circle-triangle-" + (z ? "w" : "e") + "'>" + n + "</span></a>" : W ? "" : "<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='" + n + "'><span class='ui-icon ui-icon-circle-triangle-" + (z ? "w" : "e") + "'>" + n + "</span></a>", a = this._get(e, "currentText"), r = this._get(e, "gotoCurrent") && e.currentDay ? J : U, a = B ? this.formatDate(a, r, this._getFormatConfig(e)) : a, l = e.inline ? "" : "<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>" + this._get(e, "closeText") + "</button>", c = V ? "<div class='ui-datepicker-buttonpane ui-widget-content'>" + (z ? l : "") + (this._isInRange(e, r) ? "<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>" + a + "</button>" : "") + (z ? "" : l) + "</div>" : "", d = parseInt(this._get(e, "firstDay"), 10), d = isNaN(d) ? 0 : d, h = this._get(e, "showWeek"), p = this._get(e, "dayNames"), u = this._get(e, "dayNamesMin"), f = this._get(e, "monthNames"), m = this._get(e, "monthNamesShort"), g = this._get(e, "beforeShowDay"), v = this._get(e, "showOtherMonths"), b = this._get(e, "selectOtherMonths"), y = this._getDefaultDate(e), w = "", T = 0; T < q[0]; T++) {
                        for ($ = "", this.maxRows = 4, C = 0; C < q[1]; C++) {
                            if (k = this._daylightSavingAdjust(new Date(ee, Z, e.selectedDay)), S = " ui-corner-all", E = "", G) {
                                if (E += "<div class='ui-datepicker-group", q[1] > 1)
                                    switch (C) {
                                    case 0:
                                        E += " ui-datepicker-group-first",
                                        S = " ui-corner-" + (z ? "right" : "left");
                                        break;
                                    case q[1] - 1:
                                        E += " ui-datepicker-group-last",
                                        S = " ui-corner-" + (z ? "left" : "right");
                                        break;
                                    default:
                                        E += " ui-datepicker-group-middle",
                                        S = ""
                                    }
                                E += "'>"
                            }
                            for (E += "<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix" + S + "'>" + (/all|left/.test(S) && 0 === T ? z ? s : o : "") + (/all|right/.test(S) && 0 === T ? z ? o : s : "") + this._generateMonthYearHeader(e, Z, ee, K, Q, T > 0 || C > 0, f, m) + "</div><table class='ui-datepicker-calendar'><thead><tr>", _ = h ? "<th class='ui-datepicker-week-col'>" + this._get(e, "weekHeader") + "</th>" : "", x = 0; x < 7; x++)
                                _ += "<th" + ((x + d + 6) % 7 >= 5 ? " class='ui-datepicker-week-end'" : "") + "><span title='" + p[D = (x + d) % 7] + "'>" + u[D] + "</span></th>";
                            for (E += _ + "</tr></thead><tbody>", M = this._getDaysInMonth(ee, Z), ee === e.selectedYear && Z === e.selectedMonth && (e.selectedDay = Math.min(e.selectedDay, M)), N = (this._getFirstDayOfMonth(ee, Z) - d + 7) % 7, I = Math.ceil((N + M) / 7), O = G && this.maxRows > I ? this.maxRows : I, this.maxRows = O, R = this._daylightSavingAdjust(new Date(ee, Z, 1 - N)), j = 0; j < O; j++) {
                                for (E += "<tr>", L = h ? "<td class='ui-datepicker-week-col'>" + this._get(e, "calculateWeek")(R) + "</td>" : "", x = 0; x < 7; x++)
                                    F = g ? g.apply(e.input ? e.input[0] : null, [R]) : [!0, ""],
                                    H = (A = R.getMonth() !== Z) && !b || !F[0] || K && R < K || Q && R > Q,
                                    L += "<td class='" + ((x + d + 6) % 7 >= 5 ? " ui-datepicker-week-end" : "") + (A ? " ui-datepicker-other-month" : "") + (R.getTime() === k.getTime() && Z === e.selectedMonth && e._keyEvent || y.getTime() === R.getTime() && y.getTime() === k.getTime() ? " " + this._dayOverClass : "") + (H ? " " + this._unselectableClass + " ui-state-disabled" : "") + (A && !v ? "" : " " + F[1] + (R.getTime() === J.getTime() ? " " + this._currentClass : "") + (R.getTime() === U.getTime() ? " ui-datepicker-today" : "")) + "'" + (A && !v || !F[2] ? "" : " title='" + F[2].replace(/'/g, "&#39;") + "'") + (H ? "" : " data-handler='selectDay' data-event='click' data-month='" + R.getMonth() + "' data-year='" + R.getFullYear() + "'") + ">" + (A && !v ? "&#xa0;" : H ? "<span class='ui-state-default'>" + R.getDate() + "</span>" : "<a class='ui-state-default" + (R.getTime() === U.getTime() ? " ui-state-highlight" : "") + (R.getTime() === J.getTime() ? " ui-state-active" : "") + (A ? " ui-priority-secondary" : "") + "' href='#'>" + R.getDate() + "</a>") + "</td>",
                                    R.setDate(R.getDate() + 1),
                                    R = this._daylightSavingAdjust(R);
                                E += L + "</tr>"
                            }
                            ++Z > 11 && (Z = 0, ee++),
                            $ += E += "</tbody></table>" + (G ? "</div>" + (q[0] > 0 && C === q[1] - 1 ? "<div class='ui-datepicker-row-break'></div>" : "") : "")
                        }
                        w += $
                    }
                    return w += c, e._keyEvent = !1, w
                },
                _generateMonthYearHeader: function(e, t, i, o, n, s, a, r) {
                    var l,
                        c,
                        d,
                        h,
                        p,
                        u,
                        f,
                        m,
                        g = this._get(e, "changeMonth"),
                        v = this._get(e, "changeYear"),
                        b = this._get(e, "showMonthAfterYear"),
                        y = "<div class='ui-datepicker-title'>",
                        w = "";
                    if (s || !g)
                        w += "<span class='ui-datepicker-month'>" + a[t] + "</span>";
                    else {
                        for (l = o && o.getFullYear() === i, c = n && n.getFullYear() === i, w += "<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>", d = 0; d < 12; d++)
                            (!l || d >= o.getMonth()) && (!c || d <= n.getMonth()) && (w += "<option value='" + d + "'" + (d === t ? " selected='selected'" : "") + ">" + r[d] + "</option>");
                        w += "</select>"
                    }
                    if (b || (y += w + (!s && g && v ? "" : "&#xa0;")), !e.yearshtml)
                        if (e.yearshtml = "", s || !v)
                            y += "<span class='ui-datepicker-year'>" + i + "</span>";
                        else {
                            for (h = this._get(e, "yearRange").split(":"), p = (new Date).getFullYear(), f = (u = function(e) {
                                var t = e.match(/c[+\-].*/) ? i + parseInt(e.substring(1), 10) : e.match(/[+\-].*/) ? p + parseInt(e, 10) : parseInt(e, 10);
                                return isNaN(t) ? p : t
                            })(h[0]), m = Math.max(f, u(h[1] || "")), f = o ? Math.max(f, o.getFullYear()) : f, m = n ? Math.min(m, n.getFullYear()) : m, e.yearshtml += "<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>"; f <= m; f++)
                                e.yearshtml += "<option value='" + f + "'" + (f === i ? " selected='selected'" : "") + ">" + f + "</option>";
                            e.yearshtml += "</select>",
                            y += e.yearshtml,
                            e.yearshtml = null
                        }
                    return y += this._get(e, "yearSuffix"), b && (y += (!s && g && v ? "" : "&#xa0;") + w), y += "</div>"
                },
                _adjustInstDate: function(e, t, i) {
                    var o = e.drawYear + ("Y" === i ? t : 0),
                        n = e.drawMonth + ("M" === i ? t : 0),
                        s = Math.min(e.selectedDay, this._getDaysInMonth(o, n)) + ("D" === i ? t : 0),
                        a = this._restrictMinMax(e, this._daylightSavingAdjust(new Date(o, n, s)));
                    e.selectedDay = a.getDate(),
                    e.drawMonth = e.selectedMonth = a.getMonth(),
                    e.drawYear = e.selectedYear = a.getFullYear(),
                    "M" !== i && "Y" !== i || this._notifyChange(e)
                },
                _restrictMinMax: function(e, t) {
                    var i = this._getMinMaxDate(e, "min"),
                        o = this._getMinMaxDate(e, "max"),
                        n = i && t < i ? i : t;
                    return o && n > o ? o : n
                },
                _notifyChange: function(e) {
                    var t = this._get(e, "onChangeMonthYear");
                    t && t.apply(e.input ? e.input[0] : null, [e.selectedYear, e.selectedMonth + 1, e])
                },
                _getNumberOfMonths: function(e) {
                    var t = this._get(e, "numberOfMonths");
                    return null == t ? [1, 1] : "number" == typeof t ? [1, t] : t
                },
                _getMinMaxDate: function(e, t) {
                    return this._determineDate(e, this._get(e, t + "Date"), null)
                },
                _getDaysInMonth: function(e, t) {
                    return 32 - this._daylightSavingAdjust(new Date(e, t, 32)).getDate()
                },
                _getFirstDayOfMonth: function(e, t) {
                    return new Date(e, t, 1).getDay()
                },
                _canAdjustMonth: function(e, t, i, o) {
                    var n = this._getNumberOfMonths(e),
                        s = this._daylightSavingAdjust(new Date(i, o + (t < 0 ? t : n[0] * n[1]), 1));
                    return t < 0 && s.setDate(this._getDaysInMonth(s.getFullYear(), s.getMonth())), this._isInRange(e, s)
                },
                _isInRange: function(e, t) {
                    var i,
                        o,
                        n = this._getMinMaxDate(e, "min"),
                        s = this._getMinMaxDate(e, "max"),
                        a = null,
                        r = null,
                        l = this._get(e, "yearRange");
                    return l && (i = l.split(":"), o = (new Date).getFullYear(), a = parseInt(i[0], 10), r = parseInt(i[1], 10), i[0].match(/[+\-].*/) && (a += o), i[1].match(/[+\-].*/) && (r += o)), (!n || t.getTime() >= n.getTime()) && (!s || t.getTime() <= s.getTime()) && (!a || t.getFullYear() >= a) && (!r || t.getFullYear() <= r)
                },
                _getFormatConfig: function(e) {
                    var t = this._get(e, "shortYearCutoff");
                    return {
                        shortYearCutoff: t = "string" != typeof t ? t : (new Date).getFullYear() % 100 + parseInt(t, 10),
                        dayNamesShort: this._get(e, "dayNamesShort"),
                        dayNames: this._get(e, "dayNames"),
                        monthNamesShort: this._get(e, "monthNamesShort"),
                        monthNames: this._get(e, "monthNames")
                    }
                },
                _formatDate: function(e, t, i, o) {
                    t || (e.currentDay = e.selectedDay, e.currentMonth = e.selectedMonth, e.currentYear = e.selectedYear);
                    var n = t ? "object" == typeof t ? t : this._daylightSavingAdjust(new Date(o, i, t)) : this._daylightSavingAdjust(new Date(e.currentYear, e.currentMonth, e.currentDay));
                    return this.formatDate(this._get(e, "dateFormat"), n, this._getFormatConfig(e))
                }
            }),
            e.fn.datepicker = function(t) {
                if (!this.length)
                    return this;
                e.datepicker.initialized || (e(document).mousedown(e.datepicker._checkExternalClick), e.datepicker.initialized = !0),
                0 === e("#" + e.datepicker._mainDivId).length && e("body").append(e.datepicker.dpDiv);
                var i = Array.prototype.slice.call(arguments, 1);
                return "string" != typeof t || "isDisabled" !== t && "getDate" !== t && "widget" !== t ? "option" === t && 2 === arguments.length && "string" == typeof arguments[1] ? e.datepicker["_" + t + "Datepicker"].apply(e.datepicker, [this[0]].concat(i)) : this.each((function() {
                    "string" == typeof t ? e.datepicker["_" + t + "Datepicker"].apply(e.datepicker, [this].concat(i)) : e.datepicker._attachDatepicker(this, t)
                })) : e.datepicker["_" + t + "Datepicker"].apply(e.datepicker, [this[0]].concat(i))
            },
            e.datepicker = new n,
            e.datepicker.initialized = !1,
            e.datepicker.uuid = (new Date).getTime(),
            e.datepicker.version = "1.10.4"
        }(jQuery),
        function(e, t) {
            var i = {
                    buttons: !0,
                    height: !0,
                    maxHeight: !0,
                    maxWidth: !0,
                    minHeight: !0,
                    minWidth: !0,
                    width: !0
                },
                o = {
                    maxHeight: !0,
                    maxWidth: !0,
                    minHeight: !0,
                    minWidth: !0
                };
            e.widget("ui.dialog", {
                version: "1.10.4",
                options: {
                    appendTo: "body",
                    autoOpen: !0,
                    buttons: [],
                    closeOnEscape: !0,
                    closeText: "close",
                    dialogClass: "",
                    draggable: !0,
                    hide: null,
                    height: "auto",
                    maxHeight: null,
                    maxWidth: null,
                    minHeight: 150,
                    minWidth: 150,
                    modal: !1,
                    position: {
                        my: "center",
                        at: "center",
                        of: window,
                        collision: "fit",
                        using: function(t) {
                            var i = e(this).css(t).offset().top;
                            i < 0 && e(this).css("top", t.top - i)
                        }
                    },
                    resizable: !0,
                    show: null,
                    title: null,
                    width: 300,
                    beforeClose: null,
                    close: null,
                    drag: null,
                    dragStart: null,
                    dragStop: null,
                    focus: null,
                    open: null,
                    resize: null,
                    resizeStart: null,
                    resizeStop: null
                },
                _create: function() {
                    this.originalCss = {
                        display: this.element[0].style.display,
                        width: this.element[0].style.width,
                        minHeight: this.element[0].style.minHeight,
                        maxHeight: this.element[0].style.maxHeight,
                        height: this.element[0].style.height
                    },
                    this.originalPosition = {
                        parent: this.element.parent(),
                        index: this.element.parent().children().index(this.element)
                    },
                    this.originalTitle = this.element.attr("title"),
                    this.options.title = this.options.title || this.originalTitle,
                    this._createWrapper(),
                    this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog),
                    this._createTitlebar(),
                    this._createButtonPane(),
                    this.options.draggable && e.fn.draggable && this._makeDraggable(),
                    this.options.resizable && e.fn.resizable && this._makeResizable(),
                    this._isOpen = !1
                },
                _init: function() {
                    this.options.autoOpen && this.open()
                },
                _appendTo: function() {
                    var t = this.options.appendTo;
                    return t && (t.jquery || t.nodeType) ? e(t) : this.document.find(t || "body").eq(0)
                },
                _destroy: function() {
                    var e,
                        t = this.originalPosition;
                    this._destroyOverlay(),
                    this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach(),
                    this.uiDialog.stop(!0, !0).remove(),
                    this.originalTitle && this.element.attr("title", this.originalTitle),
                    (e = t.parent.children().eq(t.index)).length && e[0] !== this.element[0] ? e.before(this.element) : t.parent.append(this.element)
                },
                widget: function() {
                    return this.uiDialog
                },
                disable: e.noop,
                enable: e.noop,
                close: function(t) {
                    var i,
                        o = this;
                    if (this._isOpen && !1 !== this._trigger("beforeClose", t)) {
                        if (this._isOpen = !1, this._destroyOverlay(), !this.opener.filter(":focusable").focus().length)
                            try {
                                (i = this.document[0].activeElement) && "body" !== i.nodeName.toLowerCase() && e(i).blur()
                            } catch (e) {}
                        this._hide(this.uiDialog, this.options.hide, (function() {
                            o._trigger("close", t)
                        }))
                    }
                },
                isOpen: function() {
                    return this._isOpen
                },
                moveToTop: function() {
                    this._moveToTop()
                },
                _moveToTop: function(e, t) {
                    var i = !!this.uiDialog.nextAll(":visible").insertBefore(this.uiDialog).length;
                    return i && !t && this._trigger("focus", e), i
                },
                open: function() {
                    var t = this;
                    this._isOpen ? this._moveToTop() && this._focusTabbable() : (this._isOpen = !0, this.opener = e(this.document[0].activeElement), this._size(), this._position(), this._createOverlay(), this._moveToTop(null, !0), this._show(this.uiDialog, this.options.show, (function() {
                        t._focusTabbable(),
                        t._trigger("focus")
                    })), this._trigger("open"))
                },
                _focusTabbable: function() {
                    var e = this.element.find("[autofocus]");
                    e.length || (e = this.element.find(":tabbable")),
                    e.length || (e = this.uiDialogButtonPane.find(":tabbable")),
                    e.length || (e = this.uiDialogTitlebarClose.filter(":tabbable")),
                    e.length || (e = this.uiDialog),
                    e.eq(0).focus()
                },
                _keepFocus: function(t) {
                    function i() {
                        var t = this.document[0].activeElement;
                        this.uiDialog[0] === t || e.contains(this.uiDialog[0], t) || this._focusTabbable()
                    }
                    t.preventDefault(),
                    i.call(this),
                    this._delay(i)
                },
                _createWrapper: function() {
                    this.uiDialog = e("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front " + this.options.dialogClass).hide().attr({
                        tabIndex: -1,
                        role: "dialog"
                    }).appendTo(this._appendTo()),
                    this._on(this.uiDialog, {
                        keydown: function(t) {
                            if (this.options.closeOnEscape && !t.isDefaultPrevented() && t.keyCode && t.keyCode === e.ui.keyCode.ESCAPE)
                                return t.preventDefault(), void this.close(t);
                            if (t.keyCode === e.ui.keyCode.TAB) {
                                var i = this.uiDialog.find(":tabbable"),
                                    o = i.filter(":first"),
                                    n = i.filter(":last");
                                t.target !== n[0] && t.target !== this.uiDialog[0] || t.shiftKey ? t.target !== o[0] && t.target !== this.uiDialog[0] || !t.shiftKey || (n.focus(1), t.preventDefault()) : (o.focus(1), t.preventDefault())
                            }
                        },
                        mousedown: function(e) {
                            this._moveToTop(e) && this._focusTabbable()
                        }
                    }),
                    this.element.find("[aria-describedby]").length || this.uiDialog.attr({
                        "aria-describedby": this.element.uniqueId().attr("id")
                    })
                },
                _createTitlebar: function() {
                    var t;
                    this.uiDialogTitlebar = e("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog),
                    this._on(this.uiDialogTitlebar, {
                        mousedown: function(t) {
                            e(t.target).closest(".ui-dialog-titlebar-close") || this.uiDialog.focus()
                        }
                    }),
                    this.uiDialogTitlebarClose = e("<button type='button'></button>").button({
                        label: this.options.closeText,
                        icons: {
                            primary: "ui-icon-closethick"
                        },
                        text: !1
                    }).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar),
                    this._on(this.uiDialogTitlebarClose, {
                        click: function(e) {
                            e.preventDefault(),
                            this.close(e)
                        }
                    }),
                    t = e("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar),
                    this._title(t),
                    this.uiDialog.attr({
                        "aria-labelledby": t.attr("id")
                    })
                },
                _title: function(e) {
                    this.options.title || e.html("&#160;"),
                    e.text(this.options.title)
                },
                _createButtonPane: function() {
                    this.uiDialogButtonPane = e("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),
                    this.uiButtonSet = e("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane),
                    this._createButtons()
                },
                _createButtons: function() {
                    var t = this,
                        i = this.options.buttons;
                    this.uiDialogButtonPane.remove(),
                    this.uiButtonSet.empty(),
                    e.isEmptyObject(i) || e.isArray(i) && !i.length ? this.uiDialog.removeClass("ui-dialog-buttons") : (e.each(i, (function(i, o) {
                        var n,
                            s;
                        o = e.isFunction(o) ? {
                            click: o,
                            text: i
                        } : o,
                        o = e.extend({
                            type: "button"
                        }, o),
                        n = o.click,
                        o.click = function() {
                            n.apply(t.element[0], arguments)
                        },
                        s = {
                            icons: o.icons,
                            text: o.showText
                        },
                        delete o.icons,
                        delete o.showText,
                        e("<button></button>", o).button(s).appendTo(t.uiButtonSet)
                    })), this.uiDialog.addClass("ui-dialog-buttons"), this.uiDialogButtonPane.appendTo(this.uiDialog))
                },
                _makeDraggable: function() {
                    var t = this,
                        i = this.options;
                    function o(e) {
                        return {
                            position: e.position,
                            offset: e.offset
                        }
                    }
                    this.uiDialog.draggable({
                        cancel: ".ui-dialog-content, .ui-dialog-titlebar-close",
                        handle: ".ui-dialog-titlebar",
                        containment: "document",
                        start: function(i, n) {
                            e(this).addClass("ui-dialog-dragging"),
                            t._blockFrames(),
                            t._trigger("dragStart", i, o(n))
                        },
                        drag: function(e, i) {
                            t._trigger("drag", e, o(i))
                        },
                        stop: function(n, s) {
                            i.position = [s.position.left - t.document.scrollLeft(), s.position.top - t.document.scrollTop()],
                            e(this).removeClass("ui-dialog-dragging"),
                            t._unblockFrames(),
                            t._trigger("dragStop", n, o(s))
                        }
                    })
                },
                _makeResizable: function() {
                    var t = this,
                        i = this.options,
                        o = i.resizable,
                        n = this.uiDialog.css("position"),
                        s = "string" == typeof o ? o : "n,e,s,w,se,sw,ne,nw";
                    function a(e) {
                        return {
                            originalPosition: e.originalPosition,
                            originalSize: e.originalSize,
                            position: e.position,
                            size: e.size
                        }
                    }
                    this.uiDialog.resizable({
                        cancel: ".ui-dialog-content",
                        containment: "document",
                        alsoResize: this.element,
                        maxWidth: i.maxWidth,
                        maxHeight: i.maxHeight,
                        minWidth: i.minWidth,
                        minHeight: this._minHeight(),
                        handles: s,
                        start: function(i, o) {
                            e(this).addClass("ui-dialog-resizing"),
                            t._blockFrames(),
                            t._trigger("resizeStart", i, a(o))
                        },
                        resize: function(e, i) {
                            t._trigger("resize", e, a(i))
                        },
                        stop: function(o, n) {
                            i.height = e(this).height(),
                            i.width = e(this).width(),
                            e(this).removeClass("ui-dialog-resizing"),
                            t._unblockFrames(),
                            t._trigger("resizeStop", o, a(n))
                        }
                    }).css("position", n)
                },
                _minHeight: function() {
                    var e = this.options;
                    return "auto" === e.height ? e.minHeight : Math.min(e.minHeight, e.height)
                },
                _position: function() {
                    var e = this.uiDialog.is(":visible");
                    e || this.uiDialog.show(),
                    this.uiDialog.position(this.options.position),
                    e || this.uiDialog.hide()
                },
                _setOptions: function(t) {
                    var n = this,
                        s = !1,
                        a = {};
                    e.each(t, (function(e, t) {
                        n._setOption(e, t),
                        e in i && (s = !0),
                        e in o && (a[e] = t)
                    })),
                    s && (this._size(), this._position()),
                    this.uiDialog.is(":data(ui-resizable)") && this.uiDialog.resizable("option", a)
                },
                _setOption: function(e, t) {
                    var i,
                        o,
                        n = this.uiDialog;
                    "dialogClass" === e && n.removeClass(this.options.dialogClass).addClass(t),
                    "disabled" !== e && (this._super(e, t), "appendTo" === e && this.uiDialog.appendTo(this._appendTo()), "buttons" === e && this._createButtons(), "closeText" === e && this.uiDialogTitlebarClose.button({
                        label: "" + t
                    }), "draggable" === e && ((i = n.is(":data(ui-draggable)")) && !t && n.draggable("destroy"), !i && t && this._makeDraggable()), "position" === e && this._position(), "resizable" === e && ((o = n.is(":data(ui-resizable)")) && !t && n.resizable("destroy"), o && "string" == typeof t && n.resizable("option", "handles", t), o || !1 === t || this._makeResizable()), "title" === e && this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))
                },
                _size: function() {
                    var e,
                        t,
                        i,
                        o = this.options;
                    this.element.show().css({
                        width: "auto",
                        minHeight: 0,
                        maxHeight: "none",
                        height: 0
                    }),
                    o.minWidth > o.width && (o.width = o.minWidth),
                    e = this.uiDialog.css({
                        height: "auto",
                        width: o.width
                    }).outerHeight(),
                    t = Math.max(0, o.minHeight - e),
                    i = "number" == typeof o.maxHeight ? Math.max(0, o.maxHeight - e) : "none",
                    "auto" === o.height ? this.element.css({
                        minHeight: t,
                        maxHeight: i,
                        height: "auto"
                    }) : this.element.height(Math.max(0, o.height - e)),
                    this.uiDialog.is(":data(ui-resizable)") && this.uiDialog.resizable("option", "minHeight", this._minHeight())
                },
                _blockFrames: function() {
                    this.iframeBlocks = this.document.find("iframe").map((function() {
                        var t = e(this);
                        return e("<div>").css({
                            position: "absolute",
                            width: t.outerWidth(),
                            height: t.outerHeight()
                        }).appendTo(t.parent()).offset(t.offset())[0]
                    }))
                },
                _unblockFrames: function() {
                    this.iframeBlocks && (this.iframeBlocks.remove(), delete this.iframeBlocks)
                },
                _allowInteraction: function(t) {
                    return !!e(t.target).closest(".ui-dialog").length || !!e(t.target).closest(".ui-datepicker").length
                },
                _createOverlay: function() {
                    if (this.options.modal) {
                        var t = this,
                            i = this.widgetFullName;
                        e.ui.dialog.overlayInstances || this._delay((function() {
                            e.ui.dialog.overlayInstances && this.document.bind("focusin.dialog", (function(o) {
                                t._allowInteraction(o) || (o.preventDefault(), e(".ui-dialog:visible:last .ui-dialog-content").data(i)._focusTabbable())
                            }))
                        })),
                        this.overlay = e("<div>").addClass("ui-widget-overlay ui-front").appendTo(this._appendTo()),
                        this._on(this.overlay, {
                            mousedown: "_keepFocus"
                        }),
                        e.ui.dialog.overlayInstances++
                    }
                },
                _destroyOverlay: function() {
                    this.options.modal && this.overlay && (e.ui.dialog.overlayInstances--, e.ui.dialog.overlayInstances || this.document.unbind("focusin.dialog"), this.overlay.remove(), this.overlay = null)
                }
            }),
            e.ui.dialog.overlayInstances = 0,
            !1 !== e.uiBackCompat && e.widget("ui.dialog", e.ui.dialog, {
                _position: function() {
                    var t,
                        i = this.options.position,
                        o = [],
                        n = [0, 0];
                    i ? (("string" == typeof i || "object" == typeof i && "0" in i) && (1 === (o = i.split ? i.split(" ") : [i[0], i[1]]).length && (o[1] = o[0]), e.each(["left", "top"], (function(e, t) {
                        +o[e] === o[e] && (n[e] = o[e], o[e] = t)
                    })), i = {
                        my: o[0] + (n[0] < 0 ? n[0] : "+" + n[0]) + " " + o[1] + (n[1] < 0 ? n[1] : "+" + n[1]),
                        at: o.join(" ")
                    }), i = e.extend({}, e.ui.dialog.prototype.options.position, i)) : i = e.ui.dialog.prototype.options.position,
                    (t = this.uiDialog.is(":visible")) || this.uiDialog.show(),
                    this.uiDialog.position(i),
                    t || this.uiDialog.hide()
                }
            })
        }(jQuery),
        function(e, t) {
            e.widget("ui.menu", {
                version: "1.10.4",
                defaultElement: "<ul>",
                delay: 300,
                options: {
                    icons: {
                        submenu: "ui-icon-carat-1-e"
                    },
                    menus: "ul",
                    position: {
                        my: "left top",
                        at: "right top"
                    },
                    role: "menu",
                    blur: null,
                    focus: null,
                    select: null
                },
                _create: function() {
                    this.activeMenu = this.element,
                    this.mouseHandled = !1,
                    this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content ui-corner-all").toggleClass("ui-menu-icons", !!this.element.find(".ui-icon").length).attr({
                        role: this.options.role,
                        tabIndex: 0
                    }).bind("click" + this.eventNamespace, e.proxy((function(e) {
                        this.options.disabled && e.preventDefault()
                    }), this)),
                    this.options.disabled && this.element.addClass("ui-state-disabled").attr("aria-disabled", "true"),
                    this._on({
                        "mousedown .ui-menu-item > a": function(e) {
                            e.preventDefault()
                        },
                        "click .ui-state-disabled > a": function(e) {
                            e.preventDefault()
                        },
                        "click .ui-menu-item:has(a)": function(t) {
                            var i = e(t.target).closest(".ui-menu-item");
                            !this.mouseHandled && i.not(".ui-state-disabled").length && (this.select(t), t.isPropagationStopped() || (this.mouseHandled = !0), i.has(".ui-menu").length ? this.expand(t) : !this.element.is(":focus") && e(this.document[0].activeElement).closest(".ui-menu").length && (this.element.trigger("focus", [!0]), this.active && 1 === this.active.parents(".ui-menu").length && clearTimeout(this.timer)))
                        },
                        "mouseenter .ui-menu-item": function(t) {
                            var i = e(t.currentTarget);
                            i.siblings().children(".ui-state-active").removeClass("ui-state-active"),
                            this.focus(t, i)
                        },
                        mouseleave: "collapseAll",
                        "mouseleave .ui-menu": "collapseAll",
                        focus: function(e, t) {
                            var i = this.active || this.element.children(".ui-menu-item").eq(0);
                            t || this.focus(e, i)
                        },
                        blur: function(t) {
                            this._delay((function() {
                                e.contains(this.element[0], this.document[0].activeElement) || this.collapseAll(t)
                            }))
                        },
                        keydown: "_keydown"
                    }),
                    this.refresh(),
                    this._on(this.document, {
                        click: function(t) {
                            e(t.target).closest(".ui-menu").length || this.collapseAll(t),
                            this.mouseHandled = !1
                        }
                    })
                },
                _destroy: function() {
                    this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all ui-menu-icons").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),
                    this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").children("a").removeUniqueId().removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each((function() {
                        var t = e(this);
                        t.data("ui-menu-submenu-carat") && t.remove()
                    })),
                    this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")
                },
                _keydown: function(t) {
                    var i,
                        o,
                        n,
                        s,
                        a,
                        r = !0;
                    function l(e) {
                        return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g, "\\$&")
                    }
                    switch (t.keyCode) {
                    case e.ui.keyCode.PAGE_UP:
                        this.previousPage(t);
                        break;
                    case e.ui.keyCode.PAGE_DOWN:
                        this.nextPage(t);
                        break;
                    case e.ui.keyCode.HOME:
                        this._move("first", "first", t);
                        break;
                    case e.ui.keyCode.END:
                        this._move("last", "last", t);
                        break;
                    case e.ui.keyCode.UP:
                        this.previous(t);
                        break;
                    case e.ui.keyCode.DOWN:
                        this.next(t);
                        break;
                    case e.ui.keyCode.LEFT:
                        this.collapse(t);
                        break;
                    case e.ui.keyCode.RIGHT:
                        this.active && !this.active.is(".ui-state-disabled") && this.expand(t);
                        break;
                    case e.ui.keyCode.ENTER:
                    case e.ui.keyCode.SPACE:
                        this._activate(t);
                        break;
                    case e.ui.keyCode.ESCAPE:
                        this.collapse(t);
                        break;
                    default:
                        r = !1,
                        o = this.previousFilter || "",
                        n = String.fromCharCode(t.keyCode),
                        s = !1,
                        clearTimeout(this.filterTimer),
                        n === o ? s = !0 : n = o + n,
                        a = new RegExp("^" + l(n), "i"),
                        i = this.activeMenu.children(".ui-menu-item").filter((function() {
                            return a.test(e(this).children("a").text())
                        })),
                        (i = s && -1 !== i.index(this.active.next()) ? this.active.nextAll(".ui-menu-item") : i).length || (n = String.fromCharCode(t.keyCode), a = new RegExp("^" + l(n), "i"), i = this.activeMenu.children(".ui-menu-item").filter((function() {
                            return a.test(e(this).children("a").text())
                        }))),
                        i.length ? (this.focus(t, i), i.length > 1 ? (this.previousFilter = n, this.filterTimer = this._delay((function() {
                            delete this.previousFilter
                        }), 1e3)) : delete this.previousFilter) : delete this.previousFilter
                    }
                    r && t.preventDefault()
                },
                _activate: function(e) {
                    this.active.is(".ui-state-disabled") || (this.active.children("a[aria-haspopup='true']").length ? this.expand(e) : this.select(e))
                },
                refresh: function() {
                    var t,
                        i = this.options.icons.submenu,
                        o = this.element.find(this.options.menus);
                    this.element.toggleClass("ui-menu-icons", !!this.element.find(".ui-icon").length),
                    o.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").hide().attr({
                        role: this.options.role,
                        "aria-hidden": "true",
                        "aria-expanded": "false"
                    }).each((function() {
                        var t = e(this),
                            o = t.prev("a"),
                            n = e("<span>").addClass("ui-menu-icon ui-icon " + i).data("ui-menu-submenu-carat", !0);
                        o.attr("aria-haspopup", "true").prepend(n),
                        t.attr("aria-labelledby", o.attr("id"))
                    })),
                    (t = o.add(this.element)).children(":not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role", "presentation").children("a").uniqueId().addClass("ui-corner-all").attr({
                        tabIndex: -1,
                        role: this._itemRole()
                    }),
                    t.children(":not(.ui-menu-item)").each((function() {
                        var t = e(this);
                        /[^\-\u2014\u2013\s]/.test(t.text()) || t.addClass("ui-widget-content ui-menu-divider")
                    })),
                    t.children(".ui-state-disabled").attr("aria-disabled", "true"),
                    this.active && !e.contains(this.element[0], this.active[0]) && this.blur()
                },
                _itemRole: function() {
                    return {
                        menu: "menuitem",
                        listbox: "option"
                    }[this.options.role]
                },
                _setOption: function(e, t) {
                    "icons" === e && this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(t.submenu),
                    this._super(e, t)
                },
                focus: function(e, t) {
                    var i,
                        o;
                    this.blur(e, e && "focus" === e.type),
                    this._scrollIntoView(t),
                    this.active = t.first(),
                    o = this.active.children("a").addClass("ui-state-focus"),
                    this.options.role && this.element.attr("aria-activedescendant", o.attr("id")),
                    this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active"),
                    e && "keydown" === e.type ? this._close() : this.timer = this._delay((function() {
                        this._close()
                    }), this.delay),
                    (i = t.children(".ui-menu")).length && e && /^mouse/.test(e.type) && this._startOpening(i),
                    this.activeMenu = t.parent(),
                    this._trigger("focus", e, {
                        item: t
                    })
                },
                _scrollIntoView: function(t) {
                    var i,
                        o,
                        n,
                        s,
                        a,
                        r;
                    this._hasScroll() && (i = parseFloat(e.css(this.activeMenu[0], "borderTopWidth")) || 0, o = parseFloat(e.css(this.activeMenu[0], "paddingTop")) || 0, n = t.offset().top - this.activeMenu.offset().top - i - o, s = this.activeMenu.scrollTop(), a = this.activeMenu.height(), r = t.height(), n < 0 ? this.activeMenu.scrollTop(s + n) : n + r > a && this.activeMenu.scrollTop(s + n - a + r))
                },
                blur: function(e, t) {
                    t || clearTimeout(this.timer),
                    this.active && (this.active.children("a").removeClass("ui-state-focus"), this.active = null, this._trigger("blur", e, {
                        item: this.active
                    }))
                },
                _startOpening: function(e) {
                    clearTimeout(this.timer),
                    "true" === e.attr("aria-hidden") && (this.timer = this._delay((function() {
                        this._close(),
                        this._open(e)
                    }), this.delay))
                },
                _open: function(t) {
                    var i = e.extend({
                        of: this.active
                    }, this.options.position);
                    clearTimeout(this.timer),
                    this.element.find(".ui-menu").not(t.parents(".ui-menu")).hide().attr("aria-hidden", "true"),
                    t.show().removeAttr("aria-hidden").attr("aria-expanded", "true").position(i)
                },
                collapseAll: function(t, i) {
                    clearTimeout(this.timer),
                    this.timer = this._delay((function() {
                        var o = i ? this.element : e(t && t.target).closest(this.element.find(".ui-menu"));
                        o.length || (o = this.element),
                        this._close(o),
                        this.blur(t),
                        this.activeMenu = o
                    }), this.delay)
                },
                _close: function(e) {
                    e || (e = this.active ? this.active.parent() : this.element),
                    e.find(".ui-menu").hide().attr("aria-hidden", "true").attr("aria-expanded", "false").end().find("a.ui-state-active").removeClass("ui-state-active")
                },
                collapse: function(e) {
                    var t = this.active && this.active.parent().closest(".ui-menu-item", this.element);
                    t && t.length && (this._close(), this.focus(e, t))
                },
                expand: function(e) {
                    var t = this.active && this.active.children(".ui-menu ").children(".ui-menu-item").first();
                    t && t.length && (this._open(t.parent()), this._delay((function() {
                        this.focus(e, t)
                    })))
                },
                next: function(e) {
                    this._move("next", "first", e)
                },
                previous: function(e) {
                    this._move("prev", "last", e)
                },
                isFirstItem: function() {
                    return this.active && !this.active.prevAll(".ui-menu-item").length
                },
                isLastItem: function() {
                    return this.active && !this.active.nextAll(".ui-menu-item").length
                },
                _move: function(e, t, i) {
                    var o;
                    this.active && (o = "first" === e || "last" === e ? this.active["first" === e ? "prevAll" : "nextAll"](".ui-menu-item").eq(-1) : this.active[e + "All"](".ui-menu-item").eq(0)),
                    o && o.length && this.active || (o = this.activeMenu.children(".ui-menu-item")[t]()),
                    this.focus(i, o)
                },
                nextPage: function(t) {
                    var i,
                        o,
                        n;
                    this.active ? this.isLastItem() || (this._hasScroll() ? (o = this.active.offset().top, n = this.element.height(), this.active.nextAll(".ui-menu-item").each((function() {
                        return (i = e(this)).offset().top - o - n < 0
                    })), this.focus(t, i)) : this.focus(t, this.activeMenu.children(".ui-menu-item")[this.active ? "last" : "first"]())) : this.next(t)
                },
                previousPage: function(t) {
                    var i,
                        o,
                        n;
                    this.active ? this.isFirstItem() || (this._hasScroll() ? (o = this.active.offset().top, n = this.element.height(), this.active.prevAll(".ui-menu-item").each((function() {
                        return (i = e(this)).offset().top - o + n > 0
                    })), this.focus(t, i)) : this.focus(t, this.activeMenu.children(".ui-menu-item").first())) : this.next(t)
                },
                _hasScroll: function() {
                    return this.element.outerHeight() < this.element.prop("scrollHeight")
                },
                select: function(t) {
                    this.active = this.active || e(t.target).closest(".ui-menu-item");
                    var i = {
                        item: this.active
                    };
                    this.active.has(".ui-menu").length || this.collapseAll(t, !0),
                    this._trigger("select", t, i)
                }
            })
        }(jQuery),
        function(e, t) {
            e.widget("ui.progressbar", {
                version: "1.10.4",
                options: {
                    max: 100,
                    value: 0,
                    change: null,
                    complete: null
                },
                min: 0,
                _create: function() {
                    this.oldValue = this.options.value = this._constrainedValue(),
                    this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({
                        role: "progressbar",
                        "aria-valuemin": this.min
                    }),
                    this.valueDiv = e("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element),
                    this._refreshValue()
                },
                _destroy: function() {
                    this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),
                    this.valueDiv.remove()
                },
                value: function(e) {
                    if (void 0 === e)
                        return this.options.value;
                    this.options.value = this._constrainedValue(e),
                    this._refreshValue()
                },
                _constrainedValue: function(e) {
                    return void 0 === e && (e = this.options.value), this.indeterminate = !1 === e, "number" != typeof e && (e = 0), !this.indeterminate && Math.min(this.options.max, Math.max(this.min, e))
                },
                _setOptions: function(e) {
                    var t = e.value;
                    delete e.value,
                    this._super(e),
                    this.options.value = this._constrainedValue(t),
                    this._refreshValue()
                },
                _setOption: function(e, t) {
                    "max" === e && (t = Math.max(this.min, t)),
                    this._super(e, t)
                },
                _percentage: function() {
                    return this.indeterminate ? 100 : 100 * (this.options.value - this.min) / (this.options.max - this.min)
                },
                _refreshValue: function() {
                    var t = this.options.value,
                        i = this._percentage();
                    this.valueDiv.toggle(this.indeterminate || t > this.min).toggleClass("ui-corner-right", t === this.options.max).width(i.toFixed(0) + "%"),
                    this.element.toggleClass("ui-progressbar-indeterminate", this.indeterminate),
                    this.indeterminate ? (this.element.removeAttr("aria-valuenow"), this.overlayDiv || (this.overlayDiv = e("<div class='ui-progressbar-overlay'></div>").appendTo(this.valueDiv))) : (this.element.attr({
                        "aria-valuemax": this.options.max,
                        "aria-valuenow": t
                    }), this.overlayDiv && (this.overlayDiv.remove(), this.overlayDiv = null)),
                    this.oldValue !== t && (this.oldValue = t, this._trigger("change")),
                    t === this.options.max && this._trigger("complete")
                }
            })
        }(jQuery),
        function(e, t) {
            e.widget("ui.slider", e.ui.mouse, {
                version: "1.10.4",
                widgetEventPrefix: "slide",
                options: {
                    animate: !1,
                    distance: 0,
                    max: 100,
                    min: 0,
                    orientation: "horizontal",
                    range: !1,
                    step: 1,
                    value: 0,
                    values: null,
                    change: null,
                    slide: null,
                    start: null,
                    stop: null
                },
                _create: function() {
                    this._keySliding = !1,
                    this._mouseSliding = !1,
                    this._animateOff = !0,
                    this._handleIndex = null,
                    this._detectOrientation(),
                    this._mouseInit(),
                    this.element.addClass("ui-slider ui-slider-" + this.orientation + " ui-widget ui-widget-content ui-corner-all"),
                    this._refresh(),
                    this._setOption("disabled", this.options.disabled),
                    this._animateOff = !1
                },
                _refresh: function() {
                    this._createRange(),
                    this._createHandles(),
                    this._setupEvents(),
                    this._refreshValue()
                },
                _createHandles: function() {
                    var t,
                        i,
                        o = this.options,
                        n = this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),
                        s = [];
                    for (i = o.values && o.values.length || 1, n.length > i && (n.slice(i).remove(), n = n.slice(0, i)), t = n.length; t < i; t++)
                        s.push("<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>");
                    this.handles = n.add(e(s.join("")).appendTo(this.element)),
                    this.handle = this.handles.eq(0),
                    this.handles.each((function(t) {
                        e(this).data("ui-slider-handle-index", t)
                    }))
                },
                _createRange: function() {
                    var t = this.options,
                        i = "";
                    t.range ? (!0 === t.range && (t.values ? t.values.length && 2 !== t.values.length ? t.values = [t.values[0], t.values[0]] : e.isArray(t.values) && (t.values = t.values.slice(0)) : t.values = [this._valueMin(), this._valueMin()]), this.range && this.range.length ? this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({
                        left: "",
                        bottom: ""
                    }) : (this.range = e("<div></div>").appendTo(this.element), i = "ui-slider-range ui-widget-header ui-corner-all"), this.range.addClass(i + ("min" === t.range || "max" === t.range ? " ui-slider-range-" + t.range : ""))) : (this.range && this.range.remove(), this.range = null)
                },
                _setupEvents: function() {
                    var e = this.handles.add(this.range).filter("a");
                    this._off(e),
                    this._on(e, this._handleEvents),
                    this._hoverable(e),
                    this._focusable(e)
                },
                _destroy: function() {
                    this.handles.remove(),
                    this.range && this.range.remove(),
                    this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),
                    this._mouseDestroy()
                },
                _mouseCapture: function(t) {
                    var i,
                        o,
                        n,
                        s,
                        a,
                        r,
                        l,
                        c = this,
                        d = this.options;
                    return !d.disabled && (this.elementSize = {
                            width: this.element.outerWidth(),
                            height: this.element.outerHeight()
                        }, this.elementOffset = this.element.offset(), i = {
                            x: t.pageX,
                            y: t.pageY
                        }, o = this._normValueFromMouse(i), n = this._valueMax() - this._valueMin() + 1, this.handles.each((function(t) {
                            var i = Math.abs(o - c.values(t));
                            (n > i || n === i && (t === c._lastChangedValue || c.values(t) === d.min)) && (n = i, s = e(this), a = t)
                        })), !1 !== this._start(t, a) && (this._mouseSliding = !0, this._handleIndex = a, s.addClass("ui-state-active").focus(), r = s.offset(), l = !e(t.target).parents().addBack().is(".ui-slider-handle"), this._clickOffset = l ? {
                            left: 0,
                            top: 0
                        } : {
                            left: t.pageX - r.left - s.width() / 2,
                            top: t.pageY - r.top - s.height() / 2 - (parseInt(s.css("borderTopWidth"), 10) || 0) - (parseInt(s.css("borderBottomWidth"), 10) || 0) + (parseInt(s.css("marginTop"), 10) || 0)
                        }, this.handles.hasClass("ui-state-hover") || this._slide(t, a, o), this._animateOff = !0, !0))
                },
                _mouseStart: function() {
                    return !0
                },
                _mouseDrag: function(e) {
                    var t = {
                            x: e.pageX,
                            y: e.pageY
                        },
                        i = this._normValueFromMouse(t);
                    return this._slide(e, this._handleIndex, i), !1
                },
                _mouseStop: function(e) {
                    return this.handles.removeClass("ui-state-active"), this._mouseSliding = !1, this._stop(e, this._handleIndex), this._change(e, this._handleIndex), this._handleIndex = null, this._clickOffset = null, this._animateOff = !1, !1
                },
                _detectOrientation: function() {
                    this.orientation = "vertical" === this.options.orientation ? "vertical" : "horizontal"
                },
                _normValueFromMouse: function(e) {
                    var t,
                        i,
                        o,
                        n,
                        s;
                    return "horizontal" === this.orientation ? (t = this.elementSize.width, i = e.x - this.elementOffset.left - (this._clickOffset ? this._clickOffset.left : 0)) : (t = this.elementSize.height, i = e.y - this.elementOffset.top - (this._clickOffset ? this._clickOffset.top : 0)), (o = i / t) > 1 && (o = 1), o < 0 && (o = 0), "vertical" === this.orientation && (o = 1 - o), n = this._valueMax() - this._valueMin(), s = this._valueMin() + o * n, this._trimAlignValue(s)
                },
                _start: function(e, t) {
                    var i = {
                        handle: this.handles[t],
                        value: this.value()
                    };
                    return this.options.values && this.options.values.length && (i.value = this.values(t), i.values = this.values()), this._trigger("start", e, i)
                },
                _slide: function(e, t, i) {
                    var o,
                        n,
                        s;
                    this.options.values && this.options.values.length ? (o = this.values(t ? 0 : 1), 2 === this.options.values.length && !0 === this.options.range && (0 === t && i > o || 1 === t && i < o) && (i = o), i !== this.values(t) && ((n = this.values())[t] = i, s = this._trigger("slide", e, {
                        handle: this.handles[t],
                        value: i,
                        values: n
                    }), o = this.values(t ? 0 : 1), !1 !== s && this.values(t, i))) : i !== this.value() && !1 !== (s = this._trigger("slide", e, {
                        handle: this.handles[t],
                        value: i
                    })) && this.value(i)
                },
                _stop: function(e, t) {
                    var i = {
                        handle: this.handles[t],
                        value: this.value()
                    };
                    this.options.values && this.options.values.length && (i.value = this.values(t), i.values = this.values()),
                    this._trigger("stop", e, i)
                },
                _change: function(e, t) {
                    if (!this._keySliding && !this._mouseSliding) {
                        var i = {
                            handle: this.handles[t],
                            value: this.value()
                        };
                        this.options.values && this.options.values.length && (i.value = this.values(t), i.values = this.values()),
                        this._lastChangedValue = t,
                        this._trigger("change", e, i)
                    }
                },
                value: function(e) {
                    return arguments.length ? (this.options.value = this._trimAlignValue(e), this._refreshValue(), void this._change(null, 0)) : this._value()
                },
                values: function(t, i) {
                    var o,
                        n,
                        s;
                    if (arguments.length > 1)
                        return this.options.values[t] = this._trimAlignValue(i), this._refreshValue(), void this._change(null, t);
                    if (!arguments.length)
                        return this._values();
                    if (!e.isArray(arguments[0]))
                        return this.options.values && this.options.values.length ? this._values(t) : this.value();
                    for (o = this.options.values, n = arguments[0], s = 0; s < o.length; s += 1)
                        o[s] = this._trimAlignValue(n[s]),
                        this._change(null, s);
                    this._refreshValue()
                },
                _setOption: function(t, i) {
                    var o,
                        n = 0;
                    switch ("range" === t && !0 === this.options.range && ("min" === i ? (this.options.value = this._values(0), this.options.values = null) : "max" === i && (this.options.value = this._values(this.options.values.length - 1), this.options.values = null)), e.isArray(this.options.values) && (n = this.options.values.length), e.Widget.prototype._setOption.apply(this, arguments), t) {
                    case "orientation":
                        this._detectOrientation(),
                        this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-" + this.orientation),
                        this._refreshValue();
                        break;
                    case "value":
                        this._animateOff = !0,
                        this._refreshValue(),
                        this._change(null, 0),
                        this._animateOff = !1;
                        break;
                    case "values":
                        for (this._animateOff = !0, this._refreshValue(), o = 0; o < n; o += 1)
                            this._change(null, o);
                        this._animateOff = !1;
                        break;
                    case "min":
                    case "max":
                        this._animateOff = !0,
                        this._refreshValue(),
                        this._animateOff = !1;
                        break;
                    case "range":
                        this._animateOff = !0,
                        this._refresh(),
                        this._animateOff = !1
                    }
                },
                _value: function() {
                    var e = this.options.value;
                    return e = this._trimAlignValue(e)
                },
                _values: function(e) {
                    var t,
                        i,
                        o;
                    if (arguments.length)
                        return t = this.options.values[e], t = this._trimAlignValue(t);
                    if (this.options.values && this.options.values.length) {
                        for (i = this.options.values.slice(), o = 0; o < i.length; o += 1)
                            i[o] = this._trimAlignValue(i[o]);
                        return i
                    }
                    return []
                },
                _trimAlignValue: function(e) {
                    if (e <= this._valueMin())
                        return this._valueMin();
                    if (e >= this._valueMax())
                        return this._valueMax();
                    var t = this.options.step > 0 ? this.options.step : 1,
                        i = (e - this._valueMin()) % t,
                        o = e - i;
                    return 2 * Math.abs(i) >= t && (o += i > 0 ? t : -t), parseFloat(o.toFixed(5))
                },
                _valueMin: function() {
                    return this.options.min
                },
                _valueMax: function() {
                    return this.options.max
                },
                _refreshValue: function() {
                    var t,
                        i,
                        o,
                        n,
                        s,
                        a = this.options.range,
                        r = this.options,
                        l = this,
                        c = !this._animateOff && r.animate,
                        d = {};
                    this.options.values && this.options.values.length ? this.handles.each((function(o) {
                        i = (l.values(o) - l._valueMin()) / (l._valueMax() - l._valueMin()) * 100,
                        d["horizontal" === l.orientation ? "left" : "bottom"] = i + "%",
                        e(this).stop(1, 1)[c ? "animate" : "css"](d, r.animate),
                        !0 === l.options.range && ("horizontal" === l.orientation ? (0 === o && l.range.stop(1, 1)[c ? "animate" : "css"]({
                            left: i + "%"
                        }, r.animate), 1 === o && l.range[c ? "animate" : "css"]({
                            width: i - t + "%"
                        }, {
                            queue: !1,
                            duration: r.animate
                        })) : (0 === o && l.range.stop(1, 1)[c ? "animate" : "css"]({
                            bottom: i + "%"
                        }, r.animate), 1 === o && l.range[c ? "animate" : "css"]({
                            height: i - t + "%"
                        }, {
                            queue: !1,
                            duration: r.animate
                        }))),
                        t = i
                    })) : (o = this.value(), n = this._valueMin(), s = this._valueMax(), i = s !== n ? (o - n) / (s - n) * 100 : 0, d["horizontal" === this.orientation ? "left" : "bottom"] = i + "%", this.handle.stop(1, 1)[c ? "animate" : "css"](d, r.animate), "min" === a && "horizontal" === this.orientation && this.range.stop(1, 1)[c ? "animate" : "css"]({
                        width: i + "%"
                    }, r.animate), "max" === a && "horizontal" === this.orientation && this.range[c ? "animate" : "css"]({
                        width: 100 - i + "%"
                    }, {
                        queue: !1,
                        duration: r.animate
                    }), "min" === a && "vertical" === this.orientation && this.range.stop(1, 1)[c ? "animate" : "css"]({
                        height: i + "%"
                    }, r.animate), "max" === a && "vertical" === this.orientation && this.range[c ? "animate" : "css"]({
                        height: 100 - i + "%"
                    }, {
                        queue: !1,
                        duration: r.animate
                    }))
                },
                _handleEvents: {
                    keydown: function(t) {
                        var i,
                            o,
                            n,
                            s = e(t.target).data("ui-slider-handle-index");
                        switch (t.keyCode) {
                        case e.ui.keyCode.HOME:
                        case e.ui.keyCode.END:
                        case e.ui.keyCode.PAGE_UP:
                        case e.ui.keyCode.PAGE_DOWN:
                        case e.ui.keyCode.UP:
                        case e.ui.keyCode.RIGHT:
                        case e.ui.keyCode.DOWN:
                        case e.ui.keyCode.LEFT:
                            if (t.preventDefault(), !this._keySliding && (this._keySliding = !0, e(t.target).addClass("ui-state-active"), !1 === this._start(t, s)))
                                return
                        }
                        switch (n = this.options.step, i = o = this.options.values && this.options.values.length ? this.values(s) : this.value(), t.keyCode) {
                        case e.ui.keyCode.HOME:
                            o = this._valueMin();
                            break;
                        case e.ui.keyCode.END:
                            o = this._valueMax();
                            break;
                        case e.ui.keyCode.PAGE_UP:
                            o = this._trimAlignValue(i + (this._valueMax() - this._valueMin()) / 5);
                            break;
                        case e.ui.keyCode.PAGE_DOWN:
                            o = this._trimAlignValue(i - (this._valueMax() - this._valueMin()) / 5);
                            break;
                        case e.ui.keyCode.UP:
                        case e.ui.keyCode.RIGHT:
                            if (i === this._valueMax())
                                return;
                            o = this._trimAlignValue(i + n);
                            break;
                        case e.ui.keyCode.DOWN:
                        case e.ui.keyCode.LEFT:
                            if (i === this._valueMin())
                                return;
                            o = this._trimAlignValue(i - n)
                        }
                        this._slide(t, s, o)
                    },
                    click: function(e) {
                        e.preventDefault()
                    },
                    keyup: function(t) {
                        var i = e(t.target).data("ui-slider-handle-index");
                        this._keySliding && (this._keySliding = !1, this._stop(t, i), this._change(t, i), e(t.target).removeClass("ui-state-active"))
                    }
                }
            })
        }(jQuery),
        function(e) {
            function t(e) {
                return function() {
                    var t = this.element.val();
                    e.apply(this, arguments),
                    this._refresh(),
                    t !== this.element.val() && this._trigger("change")
                }
            }
            e.widget("ui.spinner", {
                version: "1.10.4",
                defaultElement: "<input>",
                widgetEventPrefix: "spin",
                options: {
                    culture: null,
                    icons: {
                        down: "ui-icon-triangle-1-s",
                        up: "ui-icon-triangle-1-n"
                    },
                    incremental: !0,
                    max: null,
                    min: null,
                    numberFormat: null,
                    page: 10,
                    step: 1,
                    change: null,
                    spin: null,
                    start: null,
                    stop: null
                },
                _create: function() {
                    this._setOption("max", this.options.max),
                    this._setOption("min", this.options.min),
                    this._setOption("step", this.options.step),
                    "" !== this.value() && this._value(this.element.val(), !0),
                    this._draw(),
                    this._on(this._events),
                    this._refresh(),
                    this._on(this.window, {
                        beforeunload: function() {
                            this.element.removeAttr("autocomplete")
                        }
                    })
                },
                _getCreateOptions: function() {
                    var t = {},
                        i = this.element;
                    return e.each(["min", "max", "step"], (function(e, o) {
                        var n = i.attr(o);
                        void 0 !== n && n.length && (t[o] = n)
                    })), t
                },
                _events: {
                    keydown: function(e) {
                        this._start(e) && this._keydown(e) && e.preventDefault()
                    },
                    keyup: "_stop",
                    focus: function() {
                        this.previous = this.element.val()
                    },
                    blur: function(e) {
                        this.cancelBlur ? delete this.cancelBlur : (this._stop(), this._refresh(), this.previous !== this.element.val() && this._trigger("change", e))
                    },
                    mousewheel: function(e, t) {
                        if (t) {
                            if (!this.spinning && !this._start(e))
                                return !1;
                            this._spin((t > 0 ? 1 : -1) * this.options.step, e),
                            clearTimeout(this.mousewheelTimer),
                            this.mousewheelTimer = this._delay((function() {
                                this.spinning && this._stop(e)
                            }), 100),
                            e.preventDefault()
                        }
                    },
                    "mousedown .ui-spinner-button": function(t) {
                        var i;
                        function o() {
                            this.element[0] === this.document[0].activeElement || (this.element.focus(), this.previous = i, this._delay((function() {
                                this.previous = i
                            })))
                        }
                        i = this.element[0] === this.document[0].activeElement ? this.previous : this.element.val(),
                        t.preventDefault(),
                        o.call(this),
                        this.cancelBlur = !0,
                        this._delay((function() {
                            delete this.cancelBlur,
                            o.call(this)
                        })),
                        !1 !== this._start(t) && this._repeat(null, e(t.currentTarget).hasClass("ui-spinner-up") ? 1 : -1, t)
                    },
                    "mouseup .ui-spinner-button": "_stop",
                    "mouseenter .ui-spinner-button": function(t) {
                        if (e(t.currentTarget).hasClass("ui-state-active"))
                            return !1 !== this._start(t) && void this._repeat(null, e(t.currentTarget).hasClass("ui-spinner-up") ? 1 : -1, t)
                    },
                    "mouseleave .ui-spinner-button": "_stop"
                },
                _draw: function() {
                    var e = this.uiSpinner = this.element.addClass("ui-spinner-input").attr("autocomplete", "off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());
                    this.element.attr("role", "spinbutton"),
                    this.buttons = e.find(".ui-spinner-button").attr("tabIndex", -1).button().removeClass("ui-corner-all"),
                    this.buttons.height() > Math.ceil(.5 * e.height()) && e.height() > 0 && e.height(e.height()),
                    this.options.disabled && this.disable()
                },
                _keydown: function(t) {
                    var i = this.options,
                        o = e.ui.keyCode;
                    switch (t.keyCode) {
                    case o.UP:
                        return this._repeat(null, 1, t), !0;
                    case o.DOWN:
                        return this._repeat(null, -1, t), !0;
                    case o.PAGE_UP:
                        return this._repeat(null, i.page, t), !0;
                    case o.PAGE_DOWN:
                        return this._repeat(null, -i.page, t), !0
                    }
                    return !1
                },
                _uiSpinnerHtml: function() {
                    return "<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>"
                },
                _buttonHtml: function() {
                    return "<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon " + this.options.icons.up + "'>&#9650;</span></a><a class='ui-spinner-button ui-spinner-down ui-corner-br'><span class='ui-icon " + this.options.icons.down + "'>&#9660;</span></a>"
                },
                _start: function(e) {
                    return !(!this.spinning && !1 === this._trigger("start", e)) && (this.counter || (this.counter = 1), this.spinning = !0, !0)
                },
                _repeat: function(e, t, i) {
                    e = e || 500,
                    clearTimeout(this.timer),
                    this.timer = this._delay((function() {
                        this._repeat(40, t, i)
                    }), e),
                    this._spin(t * this.options.step, i)
                },
                _spin: function(e, t) {
                    var i = this.value() || 0;
                    this.counter || (this.counter = 1),
                    i = this._adjustValue(i + e * this._increment(this.counter)),
                    this.spinning && !1 === this._trigger("spin", t, {
                        value: i
                    }) || (this._value(i), this.counter++)
                },
                _increment: function(t) {
                    var i = this.options.incremental;
                    return i ? e.isFunction(i) ? i(t) : Math.floor(t * t * t / 5e4 - t * t / 500 + 17 * t / 200 + 1) : 1
                },
                _precision: function() {
                    var e = this._precisionOf(this.options.step);
                    return null !== this.options.min && (e = Math.max(e, this._precisionOf(this.options.min))), e
                },
                _precisionOf: function(e) {
                    var t = e.toString(),
                        i = t.indexOf(".");
                    return -1 === i ? 0 : t.length - i - 1
                },
                _adjustValue: function(e) {
                    var t,
                        i,
                        o = this.options;
                    return i = e - (t = null !== o.min ? o.min : 0), e = t + (i = Math.round(i / o.step) * o.step), e = parseFloat(e.toFixed(this._precision())), null !== o.max && e > o.max ? o.max : null !== o.min && e < o.min ? o.min : e
                },
                _stop: function(e) {
                    this.spinning && (clearTimeout(this.timer), clearTimeout(this.mousewheelTimer), this.counter = 0, this.spinning = !1, this._trigger("stop", e))
                },
                _setOption: function(e, t) {
                    if ("culture" === e || "numberFormat" === e) {
                        var i = this._parse(this.element.val());
                        return this.options[e] = t, void this.element.val(this._format(i))
                    }
                    "max" !== e && "min" !== e && "step" !== e || "string" == typeof t && (t = this._parse(t)),
                    "icons" === e && (this.buttons.first().find(".ui-icon").removeClass(this.options.icons.up).addClass(t.up), this.buttons.last().find(".ui-icon").removeClass(this.options.icons.down).addClass(t.down)),
                    this._super(e, t),
                    "disabled" === e && (t ? (this.element.prop("disabled", !0), this.buttons.button("disable")) : (this.element.prop("disabled", !1), this.buttons.button("enable")))
                },
                _setOptions: t((function(e) {
                    this._super(e),
                    this._value(this.element.val())
                })),
                _parse: function(e) {
                    return "string" == typeof e && "" !== e && (e = window.Globalize && this.options.numberFormat ? Globalize.parseFloat(e, 10, this.options.culture) : +e), "" === e || isNaN(e) ? null : e
                },
                _format: function(e) {
                    return "" === e ? "" : window.Globalize && this.options.numberFormat ? Globalize.format(e, this.options.numberFormat, this.options.culture) : e
                },
                _refresh: function() {
                    this.element.attr({
                        "aria-valuemin": this.options.min,
                        "aria-valuemax": this.options.max,
                        "aria-valuenow": this._parse(this.element.val())
                    })
                },
                _value: function(e, t) {
                    var i;
                    "" !== e && null !== (i = this._parse(e)) && (t || (i = this._adjustValue(i)), e = this._format(i)),
                    this.element.val(e),
                    this._refresh()
                },
                _destroy: function() {
                    this.element.removeClass("ui-spinner-input").prop("disabled", !1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),
                    this.uiSpinner.replaceWith(this.element)
                },
                stepUp: t((function(e) {
                    this._stepUp(e)
                })),
                _stepUp: function(e) {
                    this._start() && (this._spin((e || 1) * this.options.step), this._stop())
                },
                stepDown: t((function(e) {
                    this._stepDown(e)
                })),
                _stepDown: function(e) {
                    this._start() && (this._spin((e || 1) * -this.options.step), this._stop())
                },
                pageUp: t((function(e) {
                    this._stepUp((e || 1) * this.options.page)
                })),
                pageDown: t((function(e) {
                    this._stepDown((e || 1) * this.options.page)
                })),
                value: function(e) {
                    if (!arguments.length)
                        return this._parse(this.element.val());
                    t(this._value).call(this, e)
                },
                widget: function() {
                    return this.uiSpinner
                }
            })
        }(jQuery),
        function(e, t) {
            var i = 0,
                o = /#.*$/;
            function n(e) {
                return (e = e.cloneNode(!1)).hash.length > 1 && decodeURIComponent(e.href.replace(o, "")) === decodeURIComponent(location.href.replace(o, ""))
            }
            e.widget("ui.tabs", {
                version: "1.10.4",
                delay: 300,
                options: {
                    active: null,
                    collapsible: !1,
                    event: "click",
                    heightStyle: "content",
                    hide: null,
                    show: null,
                    activate: null,
                    beforeActivate: null,
                    beforeLoad: null,
                    load: null
                },
                _create: function() {
                    var t = this,
                        i = this.options;
                    this.running = !1,
                    this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible", i.collapsible).delegate(".ui-tabs-nav > li", "mousedown" + this.eventNamespace, (function(t) {
                        e(this).is(".ui-state-disabled") && t.preventDefault()
                    })).delegate(".ui-tabs-anchor", "focus" + this.eventNamespace, (function() {
                        e(this).closest("li").is(".ui-state-disabled") && this.blur()
                    })),
                    this._processTabs(),
                    i.active = this._initialActive(),
                    e.isArray(i.disabled) && (i.disabled = e.unique(i.disabled.concat(e.map(this.tabs.filter(".ui-state-disabled"), (function(e) {
                        return t.tabs.index(e)
                    })))).sort()),
                    !1 !== this.options.active && this.anchors.length ? this.active = this._findActive(i.active) : this.active = e(),
                    this._refresh(),
                    this.active.length && this.load(i.active)
                },
                _initialActive: function() {
                    var t = this.options.active,
                        i = this.options.collapsible,
                        o = location.hash.substring(1);
                    return null === t && (o && this.tabs.each((function(i, n) {
                        if (e(n).attr("aria-controls") === o)
                            return t = i, !1
                    })), null === t && (t = this.tabs.index(this.tabs.filter(".ui-tabs-active"))), null !== t && -1 !== t || (t = !!this.tabs.length && 0)), !1 !== t && -1 === (t = this.tabs.index(this.tabs.eq(t))) && (t = !i && 0), !i && !1 === t && this.anchors.length && (t = 0), t
                },
                _getCreateEventData: function() {
                    return {
                        tab: this.active,
                        panel: this.active.length ? this._getPanelForTab(this.active) : e()
                    }
                },
                _tabKeydown: function(t) {
                    var i = e(this.document[0].activeElement).closest("li"),
                        o = this.tabs.index(i),
                        n = !0;
                    if (!this._handlePageNav(t)) {
                        switch (t.keyCode) {
                        case e.ui.keyCode.RIGHT:
                        case e.ui.keyCode.DOWN:
                            o++;
                            break;
                        case e.ui.keyCode.UP:
                        case e.ui.keyCode.LEFT:
                            n = !1,
                            o--;
                            break;
                        case e.ui.keyCode.END:
                            o = this.anchors.length - 1;
                            break;
                        case e.ui.keyCode.HOME:
                            o = 0;
                            break;
                        case e.ui.keyCode.SPACE:
                            return t.preventDefault(), clearTimeout(this.activating), void this._activate(o);
                        case e.ui.keyCode.ENTER:
                            return t.preventDefault(), clearTimeout(this.activating), void this._activate(o !== this.options.active && o);
                        default:
                            return
                        }
                        t.preventDefault(),
                        clearTimeout(this.activating),
                        o = this._focusNextTab(o, n),
                        t.ctrlKey || (i.attr("aria-selected", "false"), this.tabs.eq(o).attr("aria-selected", "true"), this.activating = this._delay((function() {
                            this.option("active", o)
                        }), this.delay))
                    }
                },
                _panelKeydown: function(t) {
                    this._handlePageNav(t) || t.ctrlKey && t.keyCode === e.ui.keyCode.UP && (t.preventDefault(), this.active.focus())
                },
                _handlePageNav: function(t) {
                    return t.altKey && t.keyCode === e.ui.keyCode.PAGE_UP ? (this._activate(this._focusNextTab(this.options.active - 1, !1)), !0) : t.altKey && t.keyCode === e.ui.keyCode.PAGE_DOWN ? (this._activate(this._focusNextTab(this.options.active + 1, !0)), !0) : void 0
                },
                _findNextTab: function(t, i) {
                    var o = this.tabs.length - 1;
                    for (; -1 !== e.inArray((t > o && (t = 0), t < 0 && (t = o), t), this.options.disabled);)
                        t = i ? t + 1 : t - 1;
                    return t
                },
                _focusNextTab: function(e, t) {
                    return e = this._findNextTab(e, t), this.tabs.eq(e).focus(), e
                },
                _setOption: function(e, t) {
                    "active" !== e ? "disabled" !== e ? (this._super(e, t), "collapsible" === e && (this.element.toggleClass("ui-tabs-collapsible", t), t || !1 !== this.options.active || this._activate(0)), "event" === e && this._setupEvents(t), "heightStyle" === e && this._setupHeightStyle(t)) : this._setupDisabled(t) : this._activate(t)
                },
                _tabId: function(e) {
                    return e.attr("aria-controls") || "ui-tabs-" + ++i
                },
                _sanitizeSelector: function(e) {
                    return e ? e.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g, "\\$&") : ""
                },
                refresh: function() {
                    var t = this.options,
                        i = this.tablist.children(":has(a[href])");
                    t.disabled = e.map(i.filter(".ui-state-disabled"), (function(e) {
                        return i.index(e)
                    })),
                    this._processTabs(),
                    !1 !== t.active && this.anchors.length ? this.active.length && !e.contains(this.tablist[0], this.active[0]) ? this.tabs.length === t.disabled.length ? (t.active = !1, this.active = e()) : this._activate(this._findNextTab(Math.max(0, t.active - 1), !1)) : t.active = this.tabs.index(this.active) : (t.active = !1, this.active = e()),
                    this._refresh()
                },
                _refresh: function() {
                    this._setupDisabled(this.options.disabled),
                    this._setupEvents(this.options.event),
                    this._setupHeightStyle(this.options.heightStyle),
                    this.tabs.not(this.active).attr({
                        "aria-selected": "false",
                        tabIndex: -1
                    }),
                    this.panels.not(this._getPanelForTab(this.active)).hide().attr({
                        "aria-expanded": "false",
                        "aria-hidden": "true"
                    }),
                    this.active.length ? (this.active.addClass("ui-tabs-active ui-state-active").attr({
                        "aria-selected": "true",
                        tabIndex: 0
                    }), this._getPanelForTab(this.active).show().attr({
                        "aria-expanded": "true",
                        "aria-hidden": "false"
                    })) : this.tabs.eq(0).attr("tabIndex", 0)
                },
                _processTabs: function() {
                    var t = this;
                    this.tablist = this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role", "tablist"),
                    this.tabs = this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({
                        role: "tab",
                        tabIndex: -1
                    }),
                    this.anchors = this.tabs.map((function() {
                        return e("a", this)[0]
                    })).addClass("ui-tabs-anchor").attr({
                        role: "presentation",
                        tabIndex: -1
                    }),
                    this.panels = e(),
                    this.anchors.each((function(i, o) {
                        var s,
                            a,
                            r,
                            l = e(o).uniqueId().attr("id"),
                            c = e(o).closest("li"),
                            d = c.attr("aria-controls");
                        n(o) ? (s = o.hash, a = t.element.find(t._sanitizeSelector(s))) : (s = "#" + (r = t._tabId(c)), (a = t.element.find(s)).length || (a = t._createPanel(r)).insertAfter(t.panels[i - 1] || t.tablist), a.attr("aria-live", "polite")),
                        a.length && (t.panels = t.panels.add(a)),
                        d && c.data("ui-tabs-aria-controls", d),
                        c.attr({
                            "aria-controls": s.substring(1),
                            "aria-labelledby": l
                        }),
                        a.attr("aria-labelledby", l)
                    })),
                    this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role", "tabpanel")
                },
                _getList: function() {
                    return this.tablist || this.element.find("ol,ul").eq(0)
                },
                _createPanel: function(t) {
                    return e("<div>").attr("id", t).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy", !0)
                },
                _setupDisabled: function(t) {
                    e.isArray(t) && (t.length ? t.length === this.anchors.length && (t = !0) : t = !1);
                    for (var i, o = 0; i = this.tabs[o]; o++)
                        !0 === t || -1 !== e.inArray(o, t) ? e(i).addClass("ui-state-disabled").attr("aria-disabled", "true") : e(i).removeClass("ui-state-disabled").removeAttr("aria-disabled");
                    this.options.disabled = t
                },
                _setupEvents: function(t) {
                    var i = {
                        click: function(e) {
                            e.preventDefault()
                        }
                    };
                    t && e.each(t.split(" "), (function(e, t) {
                        i[t] = "_eventHandler"
                    })),
                    this._off(this.anchors.add(this.tabs).add(this.panels)),
                    this._on(this.anchors, i),
                    this._on(this.tabs, {
                        keydown: "_tabKeydown"
                    }),
                    this._on(this.panels, {
                        keydown: "_panelKeydown"
                    }),
                    this._focusable(this.tabs),
                    this._hoverable(this.tabs)
                },
                _setupHeightStyle: function(t) {
                    var i,
                        o = this.element.parent();
                    "fill" === t ? (i = o.height(), i -= this.element.outerHeight() - this.element.height(), this.element.siblings(":visible").each((function() {
                        var t = e(this),
                            o = t.css("position");
                        "absolute" !== o && "fixed" !== o && (i -= t.outerHeight(!0))
                    })), this.element.children().not(this.panels).each((function() {
                        i -= e(this).outerHeight(!0)
                    })), this.panels.each((function() {
                        e(this).height(Math.max(0, i - e(this).innerHeight() + e(this).height()))
                    })).css("overflow", "auto")) : "auto" === t && (i = 0, this.panels.each((function() {
                        i = Math.max(i, e(this).height("").height())
                    })).height(i))
                },
                _eventHandler: function(t) {
                    var i = this.options,
                        o = this.active,
                        n = e(t.currentTarget).closest("li"),
                        s = n[0] === o[0],
                        a = s && i.collapsible,
                        r = a ? e() : this._getPanelForTab(n),
                        l = o.length ? this._getPanelForTab(o) : e(),
                        c = {
                            oldTab: o,
                            oldPanel: l,
                            newTab: a ? e() : n,
                            newPanel: r
                        };
                    t.preventDefault(),
                    n.hasClass("ui-state-disabled") || n.hasClass("ui-tabs-loading") || this.running || s && !i.collapsible || !1 === this._trigger("beforeActivate", t, c) || (i.active = !a && this.tabs.index(n), this.active = s ? e() : n, this.xhr && this.xhr.abort(), l.length || r.length || e.error("jQuery UI Tabs: Mismatching fragment identifier."), r.length && this.load(this.tabs.index(n), t), this._toggle(t, c))
                },
                _toggle: function(t, i) {
                    var o = this,
                        n = i.newPanel,
                        s = i.oldPanel;
                    function a() {
                        o.running = !1,
                        o._trigger("activate", t, i)
                    }
                    function r() {
                        i.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),
                        n.length && o.options.show ? o._show(n, o.options.show, a) : (n.show(), a())
                    }
                    this.running = !0,
                    s.length && this.options.hide ? this._hide(s, this.options.hide, (function() {
                        i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),
                        r()
                    })) : (i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"), s.hide(), r()),
                    s.attr({
                        "aria-expanded": "false",
                        "aria-hidden": "true"
                    }),
                    i.oldTab.attr("aria-selected", "false"),
                    n.length && s.length ? i.oldTab.attr("tabIndex", -1) : n.length && this.tabs.filter((function() {
                        return 0 === e(this).attr("tabIndex")
                    })).attr("tabIndex", -1),
                    n.attr({
                        "aria-expanded": "true",
                        "aria-hidden": "false"
                    }),
                    i.newTab.attr({
                        "aria-selected": "true",
                        tabIndex: 0
                    })
                },
                _activate: function(t) {
                    var i,
                        o = this._findActive(t);
                    o[0] !== this.active[0] && (o.length || (o = this.active), i = o.find(".ui-tabs-anchor")[0], this._eventHandler({
                        target: i,
                        currentTarget: i,
                        preventDefault: e.noop
                    }))
                },
                _findActive: function(t) {
                    return !1 === t ? e() : this.tabs.eq(t)
                },
                _getIndex: function(e) {
                    return "string" == typeof e && (e = this.anchors.index(this.anchors.filter("[href$='" + e + "']"))), e
                },
                _destroy: function() {
                    this.xhr && this.xhr.abort(),
                    this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"),
                    this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"),
                    this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId(),
                    this.tabs.add(this.panels).each((function() {
                        e.data(this, "ui-tabs-destroy") ? e(this).remove() : e(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")
                    })),
                    this.tabs.each((function() {
                        var t = e(this),
                            i = t.data("ui-tabs-aria-controls");
                        i ? t.attr("aria-controls", i).removeData("ui-tabs-aria-controls") : t.removeAttr("aria-controls")
                    })),
                    this.panels.show(),
                    "content" !== this.options.heightStyle && this.panels.css("height", "")
                },
                enable: function(t) {
                    var i = this.options.disabled;
                    !1 !== i && (void 0 === t ? i = !1 : (t = this._getIndex(t), i = e.isArray(i) ? e.map(i, (function(e) {
                        return e !== t ? e : null
                    })) : e.map(this.tabs, (function(e, i) {
                        return i !== t ? i : null
                    }))), this._setupDisabled(i))
                },
                disable: function(t) {
                    var i = this.options.disabled;
                    if (!0 !== i) {
                        if (void 0 === t)
                            i = !0;
                        else {
                            if (t = this._getIndex(t), -1 !== e.inArray(t, i))
                                return;
                            i = e.isArray(i) ? e.merge([t], i).sort() : [t]
                        }
                        this._setupDisabled(i)
                    }
                },
                load: function(t, i) {
                    t = this._getIndex(t);
                    var o = this,
                        s = this.tabs.eq(t),
                        a = s.find(".ui-tabs-anchor"),
                        r = this._getPanelForTab(s),
                        l = {
                            tab: s,
                            panel: r
                        };
                    n(a[0]) || (this.xhr = e.ajax(this._ajaxSettings(a, i, l)), this.xhr && "canceled" !== this.xhr.statusText && (s.addClass("ui-tabs-loading"), r.attr("aria-busy", "true"), this.xhr.success((function(e) {
                        setTimeout((function() {
                            r.html(e),
                            o._trigger("load", i, l)
                        }), 1)
                    })).complete((function(e, t) {
                        setTimeout((function() {
                            "abort" === t && o.panels.stop(!1, !0),
                            s.removeClass("ui-tabs-loading"),
                            r.removeAttr("aria-busy"),
                            e === o.xhr && delete o.xhr
                        }), 1)
                    }))))
                },
                _ajaxSettings: function(t, i, o) {
                    var n = this;
                    return {
                        url: t.attr("href"),
                        beforeSend: function(t, s) {
                            return n._trigger("beforeLoad", i, e.extend({
                                jqXHR: t,
                                ajaxSettings: s
                            }, o))
                        }
                    }
                },
                _getPanelForTab: function(t) {
                    var i = e(t).attr("aria-controls");
                    return this.element.find(this._sanitizeSelector("#" + i))
                }
            })
        }(jQuery),
        function(e) {
            var t = 0;
            e.widget("ui.tooltip", {
                version: "1.10.4",
                options: {
                    content: function() {
                        var t = e(this).attr("title") || "";
                        return e("<a>").text(t).html()
                    },
                    hide: !0,
                    items: "[title]:not([disabled])",
                    position: {
                        my: "left top+15",
                        at: "left bottom",
                        collision: "flipfit flip"
                    },
                    show: !0,
                    tooltipClass: null,
                    track: !1,
                    close: null,
                    open: null
                },
                _create: function() {
                    this._on({
                        mouseover: "open",
                        focusin: "open"
                    }),
                    this.tooltips = {},
                    this.parents = {},
                    this.options.disabled && this._disable()
                },
                _setOption: function(t, i) {
                    var o = this;
                    if ("disabled" === t)
                        return this[i ? "_disable" : "_enable"](), void (this.options[t] = i);
                    this._super(t, i),
                    "content" === t && e.each(this.tooltips, (function(e, t) {
                        o._updateContent(t)
                    }))
                },
                _disable: function() {
                    var t = this;
                    e.each(this.tooltips, (function(i, o) {
                        var n = e.Event("blur");
                        n.target = n.currentTarget = o[0],
                        t.close(n, !0)
                    })),
                    this.element.find(this.options.items).addBack().each((function() {
                        var t = e(this);
                        t.is("[title]") && t.data("ui-tooltip-title", t.attr("title")).attr("title", "")
                    }))
                },
                _enable: function() {
                    this.element.find(this.options.items).addBack().each((function() {
                        var t = e(this);
                        t.data("ui-tooltip-title") && t.attr("title", t.data("ui-tooltip-title"))
                    }))
                },
                open: function(t) {
                    var i = this,
                        o = e(t ? t.target : this.element).closest(this.options.items);
                    o.length && !o.data("ui-tooltip-id") && (o.attr("title") && o.data("ui-tooltip-title", o.attr("title")), o.data("ui-tooltip-open", !0), t && "mouseover" === t.type && o.parents().each((function() {
                        var t,
                            o = e(this);
                        o.data("ui-tooltip-open") && ((t = e.Event("blur")).target = t.currentTarget = this, i.close(t, !0)),
                        o.attr("title") && (o.uniqueId(), i.parents[this.id] = {
                            element: this,
                            title: o.attr("title")
                        }, o.attr("title", ""))
                    })), this._updateContent(o, t))
                },
                _updateContent: function(e, t) {
                    var i,
                        o = this.options.content,
                        n = this,
                        s = t ? t.type : null;
                    if ("string" == typeof o)
                        return this._open(t, e, o);
                    (i = o.call(e[0], (function(i) {
                        e.data("ui-tooltip-open") && n._delay((function() {
                            t && (t.type = s),
                            this._open(t, e, i)
                        }))
                    }))) && this._open(t, e, i)
                },
                _open: function(t, i, o) {
                    var n,
                        s,
                        a,
                        r,
                        l,
                        c,
                        d = e.extend({}, this.options.position);
                    o && ((n = this._find(i)).length ? n.find(".ui-tooltip-content").html(o) : (i.is("[title]") && (t && "mouseover" === t.type ? i.attr("title", "") : i.removeAttr("title")), n = this._tooltip(i), r = i, l = n.attr("id"), (c = (r.attr("aria-describedby") || "").split(/\s+/)).push(l), r.data("ui-tooltip-id", l).attr("aria-describedby", e.trim(c.join(" "))), n.find(".ui-tooltip-content").html(o), this.options.track && t && /^mouse/.test(t.type) ? (this._on(this.document, {
                        mousemove: h
                    }), h(t)) : n.position(e.extend({
                        of: i
                    }, this.options.position)), n.hide(), this._show(n, this.options.show), this.options.show && this.options.show.delay && (a = this.delayedShow = setInterval((function() {
                        n.is(":visible") && (h(d.of), clearInterval(a))
                    }), e.fx.interval)), this._trigger("open", t, {
                        tooltip: n
                    }), s = {
                        keyup: function(t) {
                            if (t.keyCode === e.ui.keyCode.ESCAPE) {
                                var o = e.Event(t);
                                o.currentTarget = i[0],
                                this.close(o, !0)
                            }
                        },
                        remove: function() {
                            this._removeTooltip(n)
                        }
                    }, t && "mouseover" !== t.type || (s.mouseleave = "close"), t && "focusin" !== t.type || (s.focusout = "close"), this._on(!0, i, s)));
                    function h(e) {
                        d.of = e,
                        n.is(":hidden") || n.position(d)
                    }
                },
                close: function(t) {
                    var i,
                        o,
                        n,
                        s,
                        a = this,
                        r = e(t ? t.currentTarget : this.element),
                        l = this._find(r);
                    this.closing || (clearInterval(this.delayedShow), r.data("ui-tooltip-title") && r.attr("title", r.data("ui-tooltip-title")), o = (i = r).data("ui-tooltip-id"), n = (i.attr("aria-describedby") || "").split(/\s+/), -1 !== (s = e.inArray(o, n)) && n.splice(s, 1), i.removeData("ui-tooltip-id"), (n = e.trim(n.join(" "))) ? i.attr("aria-describedby", n) : i.removeAttr("aria-describedby"), l.stop(!0), this._hide(l, this.options.hide, (function() {
                        a._removeTooltip(e(this))
                    })), r.removeData("ui-tooltip-open"), this._off(r, "mouseleave focusout keyup"), r[0] !== this.element[0] && this._off(r, "remove"), this._off(this.document, "mousemove"), t && "mouseleave" === t.type && e.each(this.parents, (function(t, i) {
                        e(i.element).attr("title", i.title),
                        delete a.parents[t]
                    })), this.closing = !0, this._trigger("close", t, {
                        tooltip: l
                    }), this.closing = !1)
                },
                _tooltip: function(i) {
                    var o = "ui-tooltip-" + t++,
                        n = e("<div>").attr({
                            id: o,
                            role: "tooltip"
                        }).addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content " + (this.options.tooltipClass || ""));
                    return e("<div>").addClass("ui-tooltip-content").appendTo(n), n.appendTo(this.document[0].body), this.tooltips[o] = i, n
                },
                _find: function(t) {
                    var i = t.data("ui-tooltip-id");
                    return i ? e("#" + i) : e()
                },
                _removeTooltip: function(e) {
                    e.remove(),
                    delete this.tooltips[e.attr("id")]
                },
                _destroy: function() {
                    var t = this;
                    e.each(this.tooltips, (function(i, o) {
                        var n = e.Event("blur");
                        n.target = n.currentTarget = o[0],
                        t.close(n, !0),
                        e("#" + i).remove(),
                        o.data("ui-tooltip-title") && (o.attr("title", o.data("ui-tooltip-title")), o.removeData("ui-tooltip-title"))
                    }))
                }
            })
        }(jQuery),
        function(e, t) {
            var i;
            e.effects = {
                effect: {}
            },
            function(e, t) {
                var i,
                    o = /^([\-+])=\s*(\d+\.?\d*)/,
                    n = [{
                        re: /rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,
                        parse: function(e) {
                            return [e[1], e[2], e[3], e[4]]
                        }
                    }, {
                        re: /rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,
                        parse: function(e) {
                            return [2.55 * e[1], 2.55 * e[2], 2.55 * e[3], e[4]]
                        }
                    }, {
                        re: /#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,
                        parse: function(e) {
                            return [parseInt(e[1], 16), parseInt(e[2], 16), parseInt(e[3], 16)]
                        }
                    }, {
                        re: /#([a-f0-9])([a-f0-9])([a-f0-9])/,
                        parse: function(e) {
                            return [parseInt(e[1] + e[1], 16), parseInt(e[2] + e[2], 16), parseInt(e[3] + e[3], 16)]
                        }
                    }, {
                        re: /hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,
                        space: "hsla",
                        parse: function(e) {
                            return [e[1], e[2] / 100, e[3] / 100, e[4]]
                        }
                    }],
                    s = e.Color = function(t, i, o, n) {
                        return new e.Color.fn.parse(t, i, o, n)
                    },
                    a = {
                        rgba: {
                            props: {
                                red: {
                                    idx: 0,
                                    type: "byte"
                                },
                                green: {
                                    idx: 1,
                                    type: "byte"
                                },
                                blue: {
                                    idx: 2,
                                    type: "byte"
                                }
                            }
                        },
                        hsla: {
                            props: {
                                hue: {
                                    idx: 0,
                                    type: "degrees"
                                },
                                saturation: {
                                    idx: 1,
                                    type: "percent"
                                },
                                lightness: {
                                    idx: 2,
                                    type: "percent"
                                }
                            }
                        }
                    },
                    r = {
                        byte: {
                            floor: !0,
                            max: 255
                        },
                        percent: {
                            max: 1
                        },
                        degrees: {
                            mod: 360,
                            floor: !0
                        }
                    },
                    l = s.support = {},
                    c = e("<p>")[0],
                    d = e.each;
                function h(e, t, i) {
                    var o = r[t.type] || {};
                    return null == e ? i || !t.def ? null : t.def : (e = o.floor ? ~~e : parseFloat(e), isNaN(e) ? t.def : o.mod ? (e + o.mod) % o.mod : 0 > e ? 0 : o.max < e ? o.max : e)
                }
                function p(t) {
                    var o = s(),
                        r = o._rgba = [];
                    return t = t.toLowerCase(), d(n, (function(e, i) {
                        var n,
                            s = i.re.exec(t),
                            l = s && i.parse(s),
                            c = i.space || "rgba";
                        if (l)
                            return n = o[c](l), o[a[c].cache] = n[a[c].cache], r = o._rgba = n._rgba, !1
                    })), r.length ? ("0,0,0,0" === r.join() && e.extend(r, i.transparent), o) : i[t]
                }
                function u(e, t, i) {
                    return 6 * (i = (i + 1) % 1) < 1 ? e + (t - e) * i * 6 : 2 * i < 1 ? t : 3 * i < 2 ? e + (t - e) * (2 / 3 - i) * 6 : e
                }
                c.style.cssText = "background-color:rgba(1,1,1,.5)",
                l.rgba = c.style.backgroundColor.indexOf("rgba") > -1,
                d(a, (function(e, t) {
                    t.cache = "_" + e,
                    t.props.alpha = {
                        idx: 3,
                        type: "percent",
                        def: 1
                    }
                })),
                s.fn = e.extend(s.prototype, {
                    parse: function(t, o, n, r) {
                        if (void 0 === t)
                            return this._rgba = [null, null, null, null], this;
                        (t.jquery || t.nodeType) && (t = e(t).css(o), o = void 0);
                        var l = this,
                            c = e.type(t),
                            u = this._rgba = [];
                        return void 0 !== o && (t = [t, o, n, r], c = "array"), "string" === c ? this.parse(p(t) || i._default) : "array" === c ? (d(a.rgba.props, (function(e, i) {
                            u[i.idx] = h(t[i.idx], i)
                        })), this) : "object" === c ? (d(a, t instanceof s ? function(e, i) {
                            t[i.cache] && (l[i.cache] = t[i.cache].slice())
                        } : function(i, o) {
                            var n = o.cache;
                            d(o.props, (function(e, i) {
                                if (!l[n] && o.to) {
                                    if ("alpha" === e || null == t[e])
                                        return;
                                    l[n] = o.to(l._rgba)
                                }
                                l[n][i.idx] = h(t[e], i, !0)
                            })),
                            l[n] && e.inArray(null, l[n].slice(0, 3)) < 0 && (l[n][3] = 1, o.from && (l._rgba = o.from(l[n])))
                        }), this) : void 0
                    },
                    is: function(e) {
                        var t = s(e),
                            i = !0,
                            o = this;
                        return d(a, (function(e, n) {
                            var s,
                                a = t[n.cache];
                            return a && (s = o[n.cache] || n.to && n.to(o._rgba) || [], d(n.props, (function(e, t) {
                                if (null != a[t.idx])
                                    return i = a[t.idx] === s[t.idx]
                            }))), i
                        })), i
                    },
                    _space: function() {
                        var e = [],
                            t = this;
                        return d(a, (function(i, o) {
                            t[o.cache] && e.push(i)
                        })), e.pop()
                    },
                    transition: function(e, t) {
                        var i = s(e),
                            o = i._space(),
                            n = a[o],
                            l = 0 === this.alpha() ? s("transparent") : this,
                            c = l[n.cache] || n.to(l._rgba),
                            p = c.slice();
                        return i = i[n.cache], d(n.props, (function(e, o) {
                            var n = o.idx,
                                s = c[n],
                                a = i[n],
                                l = r[o.type] || {};
                            null !== a && (null === s ? p[n] = a : (l.mod && (a - s > l.mod / 2 ? s += l.mod : s - a > l.mod / 2 && (s -= l.mod)), p[n] = h((a - s) * t + s, o)))
                        })), this[o](p)
                    },
                    blend: function(t) {
                        if (1 === this._rgba[3])
                            return this;
                        var i = this._rgba.slice(),
                            o = i.pop(),
                            n = s(t)._rgba;
                        return s(e.map(i, (function(e, t) {
                            return (1 - o) * n[t] + o * e
                        })))
                    },
                    toRgbaString: function() {
                        var t = "rgba(",
                            i = e.map(this._rgba, (function(e, t) {
                                return null == e ? t > 2 ? 1 : 0 : e
                            }));
                        return 1 === i[3] && (i.pop(), t = "rgb("), t + i.join() + ")"
                    },
                    toHslaString: function() {
                        var t = "hsla(",
                            i = e.map(this.hsla(), (function(e, t) {
                                return null == e && (e = t > 2 ? 1 : 0), t && t < 3 && (e = Math.round(100 * e) + "%"), e
                            }));
                        return 1 === i[3] && (i.pop(), t = "hsl("), t + i.join() + ")"
                    },
                    toHexString: function(t) {
                        var i = this._rgba.slice(),
                            o = i.pop();
                        return t && i.push(~~(255 * o)), "#" + e.map(i, (function(e) {
                            return 1 === (e = (e || 0).toString(16)).length ? "0" + e : e
                        })).join("")
                    },
                    toString: function() {
                        return 0 === this._rgba[3] ? "transparent" : this.toRgbaString()
                    }
                }),
                s.fn.parse.prototype = s.fn,
                a.hsla.to = function(e) {
                    if (null == e[0] || null == e[1] || null == e[2])
                        return [null, null, null, e[3]];
                    var t,
                        i,
                        o = e[0] / 255,
                        n = e[1] / 255,
                        s = e[2] / 255,
                        a = e[3],
                        r = Math.max(o, n, s),
                        l = Math.min(o, n, s),
                        c = r - l,
                        d = r + l,
                        h = .5 * d;
                    return t = l === r ? 0 : o === r ? 60 * (n - s) / c + 360 : n === r ? 60 * (s - o) / c + 120 : 60 * (o - n) / c + 240, i = 0 === c ? 0 : h <= .5 ? c / d : c / (2 - d), [Math.round(t) % 360, i, h, null == a ? 1 : a]
                },
                a.hsla.from = function(e) {
                    if (null == e[0] || null == e[1] || null == e[2])
                        return [null, null, null, e[3]];
                    var t = e[0] / 360,
                        i = e[1],
                        o = e[2],
                        n = e[3],
                        s = o <= .5 ? o * (1 + i) : o + i - o * i,
                        a = 2 * o - s;
                    return [Math.round(255 * u(a, s, t + 1 / 3)), Math.round(255 * u(a, s, t)), Math.round(255 * u(a, s, t - 1 / 3)), n]
                },
                d(a, (function(t, i) {
                    var n = i.props,
                        a = i.cache,
                        r = i.to,
                        l = i.from;
                    s.fn[t] = function(t) {
                        if (r && !this[a] && (this[a] = r(this._rgba)), void 0 === t)
                            return this[a].slice();
                        var i,
                            o = e.type(t),
                            c = "array" === o || "object" === o ? t : arguments,
                            p = this[a].slice();
                        return d(n, (function(e, t) {
                            var i = c["object" === o ? e : t.idx];
                            null == i && (i = p[t.idx]),
                            p[t.idx] = h(i, t)
                        })), l ? ((i = s(l(p)))[a] = p, i) : s(p)
                    },
                    d(n, (function(i, n) {
                        s.fn[i] || (s.fn[i] = function(s) {
                            var a,
                                r = e.type(s),
                                l = "alpha" === i ? this._hsla ? "hsla" : "rgba" : t,
                                c = this[l](),
                                d = c[n.idx];
                            return "undefined" === r ? d : ("function" === r && (s = s.call(this, d), r = e.type(s)), null == s && n.empty ? this : ("string" === r && (a = o.exec(s)) && (s = d + parseFloat(a[2]) * ("+" === a[1] ? 1 : -1)), c[n.idx] = s, this[l](c)))
                        })
                    }))
                })),
                s.hook = function(t) {
                    var i = t.split(" ");
                    d(i, (function(t, i) {
                        e.cssHooks[i] = {
                            set: function(t, o) {
                                var n,
                                    a,
                                    r = "";
                                if ("transparent" !== o && ("string" !== e.type(o) || (n = p(o)))) {
                                    if (o = s(n || o), !l.rgba && 1 !== o._rgba[3]) {
                                        for (a = "backgroundColor" === i ? t.parentNode : t; ("" === r || "transparent" === r) && a && a.style;)
                                            try {
                                                r = e.css(a, "backgroundColor"),
                                                a = a.parentNode
                                            } catch (e) {}
                                        o = o.blend(r && "transparent" !== r ? r : "_default")
                                    }
                                    o = o.toRgbaString()
                                }
                                try {
                                    t.style[i] = o
                                } catch (e) {}
                            }
                        },
                        e.fx.step[i] = function(t) {
                            t.colorInit || (t.start = s(t.elem, i), t.end = s(t.end), t.colorInit = !0),
                            e.cssHooks[i].set(t.elem, t.start.transition(t.end, t.pos))
                        }
                    }))
                },
                s.hook("backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor"),
                e.cssHooks.borderColor = {
                    expand: function(e) {
                        var t = {};
                        return d(["Top", "Right", "Bottom", "Left"], (function(i, o) {
                            t["border" + o + "Color"] = e
                        })), t
                    }
                },
                i = e.Color.names = {
                    aqua: "#00ffff",
                    black: "#000000",
                    blue: "#0000ff",
                    fuchsia: "#ff00ff",
                    gray: "#808080",
                    green: "#008000",
                    lime: "#00ff00",
                    maroon: "#800000",
                    navy: "#000080",
                    olive: "#808000",
                    purple: "#800080",
                    red: "#ff0000",
                    silver: "#c0c0c0",
                    teal: "#008080",
                    white: "#ffffff",
                    yellow: "#ffff00",
                    transparent: [null, null, null, 0],
                    _default: "#ffffff"
                }
            }(jQuery),
            function() {
                var t,
                    i = ["add", "remove", "toggle"],
                    o = {
                        border: 1,
                        borderBottom: 1,
                        borderColor: 1,
                        borderLeft: 1,
                        borderRight: 1,
                        borderTop: 1,
                        borderWidth: 1,
                        margin: 1,
                        padding: 1
                    };
                function n(t) {
                    var i,
                        o,
                        n = t.ownerDocument.defaultView ? t.ownerDocument.defaultView.getComputedStyle(t, null) : t.currentStyle,
                        s = {};
                    if (n && n.length && n[0] && n[n[0]])
                        for (o = n.length; o--;)
                            "string" == typeof n[i = n[o]] && (s[e.camelCase(i)] = n[i]);
                    else
                        for (i in n)
                            "string" == typeof n[i] && (s[i] = n[i]);
                    return s
                }
                e.each(["borderLeftStyle", "borderRightStyle", "borderBottomStyle", "borderTopStyle"], (function(t, i) {
                    e.fx.step[i] = function(e) {
                        ("none" !== e.end && !e.setAttr || 1 === e.pos && !e.setAttr) && (jQuery.style(e.elem, i, e.end), e.setAttr = !0)
                    }
                })),
                e.fn.addBack || (e.fn.addBack = function(e) {
                    return this.add(null == e ? this.prevObject : this.prevObject.filter(e))
                }),
                e.effects.animateClass = function(t, s, a, r) {
                    var l = e.speed(s, a, r);
                    return this.queue((function() {
                        var s,
                            a = e(this),
                            r = a.attr("class") || "",
                            c = l.children ? a.find("*").addBack() : a;
                        c = c.map((function() {
                            return {
                                el: e(this),
                                start: n(this)
                            }
                        })),
                        (s = function() {
                            e.each(i, (function(e, i) {
                                t[i] && a[i + "Class"](t[i])
                            }))
                        })(),
                        c = c.map((function() {
                            return this.end = n(this.el[0]), this.diff = function(t, i) {
                                var n,
                                    s,
                                    a = {};
                                for (n in i)
                                    s = i[n],
                                    t[n] !== s && (o[n] || !e.fx.step[n] && isNaN(parseFloat(s)) || (a[n] = s));
                                return a
                            }(this.start, this.end), this
                        })),
                        a.attr("class", r),
                        c = c.map((function() {
                            var t = this,
                                i = e.Deferred(),
                                o = e.extend({}, l, {
                                    queue: !1,
                                    complete: function() {
                                        i.resolve(t)
                                    }
                                });
                            return this.el.animate(this.diff, o), i.promise()
                        })),
                        e.when.apply(e, c.get()).done((function() {
                            s(),
                            e.each(arguments, (function() {
                                var t = this.el;
                                e.each(this.diff, (function(e) {
                                    t.css(e, "")
                                }))
                            })),
                            l.complete.call(a[0])
                        }))
                    }))
                },
                e.fn.extend({
                    addClass: (t = e.fn.addClass, function(i, o, n, s) {
                        return o ? e.effects.animateClass.call(this, {
                            add: i
                        }, o, n, s) : t.apply(this, arguments)
                    }),
                    removeClass: function(t) {
                        return function(i, o, n, s) {
                            return arguments.length > 1 ? e.effects.animateClass.call(this, {
                                remove: i
                            }, o, n, s) : t.apply(this, arguments)
                        }
                    }(e.fn.removeClass),
                    toggleClass: function(t) {
                        return function(i, o, n, s, a) {
                            return "boolean" == typeof o || void 0 === o ? n ? e.effects.animateClass.call(this, o ? {
                                add: i
                            } : {
                                remove: i
                            }, n, s, a) : t.apply(this, arguments) : e.effects.animateClass.call(this, {
                                toggle: i
                            }, o, n, s)
                        }
                    }(e.fn.toggleClass),
                    switchClass: function(t, i, o, n, s) {
                        return e.effects.animateClass.call(this, {
                            add: i,
                            remove: t
                        }, o, n, s)
                    }
                })
            }(),
            function() {
                function t(t, i, o, n) {
                    return e.isPlainObject(t) && (i = t, t = t.effect), t = {
                        effect: t
                    }, null == i && (i = {}), e.isFunction(i) && (n = i, o = null, i = {}), ("number" == typeof i || e.fx.speeds[i]) && (n = o, o = i, i = {}), e.isFunction(o) && (n = o, o = null), i && e.extend(t, i), o = o || i.duration, t.duration = e.fx.off ? 0 : "number" == typeof o ? o : o in e.fx.speeds ? e.fx.speeds[o] : e.fx.speeds._default, t.complete = n || i.complete, t
                }
                function i(t) {
                    return !(t && "number" != typeof t && !e.fx.speeds[t]) || ("string" == typeof t && !e.effects.effect[t] || (!!e.isFunction(t) || "object" == typeof t && !t.effect))
                }
                var o;
                e.extend(e.effects, {
                    version: "1.10.4",
                    save: function(e, t) {
                        for (var i = 0; i < t.length; i++)
                            null !== t[i] && e.data("ui-effects-" + t[i], e[0].style[t[i]])
                    },
                    restore: function(e, t) {
                        var i,
                            o;
                        for (o = 0; o < t.length; o++)
                            null !== t[o] && (void 0 === (i = e.data("ui-effects-" + t[o])) && (i = ""), e.css(t[o], i))
                    },
                    setMode: function(e, t) {
                        return "toggle" === t && (t = e.is(":hidden") ? "show" : "hide"), t
                    },
                    getBaseline: function(e, t) {
                        var i,
                            o;
                        switch (e[0]) {
                        case "top":
                            i = 0;
                            break;
                        case "middle":
                            i = .5;
                            break;
                        case "bottom":
                            i = 1;
                            break;
                        default:
                            i = e[0] / t.height
                        }
                        switch (e[1]) {
                        case "left":
                            o = 0;
                            break;
                        case "center":
                            o = .5;
                            break;
                        case "right":
                            o = 1;
                            break;
                        default:
                            o = e[1] / t.width
                        }
                        return {
                            x: o,
                            y: i
                        }
                    },
                    createWrapper: function(t) {
                        if (t.parent().is(".ui-effects-wrapper"))
                            return t.parent();
                        var i = {
                                width: t.outerWidth(!0),
                                height: t.outerHeight(!0),
                                float: t.css("float")
                            },
                            o = e("<div></div>").addClass("ui-effects-wrapper").css({
                                fontSize: "100%",
                                background: "transparent",
                                border: "none",
                                margin: 0,
                                padding: 0
                            }),
                            n = {
                                width: t.width(),
                                height: t.height()
                            },
                            s = document.activeElement;
                        try {
                            s.id
                        } catch (e) {
                            s = document.body
                        }
                        return t.wrap(o), (t[0] === s || e.contains(t[0], s)) && e(s).focus(), o = t.parent(), "static" === t.css("position") ? (o.css({
                            position: "relative"
                        }), t.css({
                            position: "relative"
                        })) : (e.extend(i, {
                            position: t.css("position"),
                            zIndex: t.css("z-index")
                        }), e.each(["top", "left", "bottom", "right"], (function(e, o) {
                            i[o] = t.css(o),
                            isNaN(parseInt(i[o], 10)) && (i[o] = "auto")
                        })), t.css({
                            position: "relative",
                            top: 0,
                            left: 0,
                            right: "auto",
                            bottom: "auto"
                        })), t.css(n), o.css(i).show()
                    },
                    removeWrapper: function(t) {
                        var i = document.activeElement;
                        return t.parent().is(".ui-effects-wrapper") && (t.parent().replaceWith(t), (t[0] === i || e.contains(t[0], i)) && e(i).focus()), t
                    },
                    setTransition: function(t, i, o, n) {
                        return n = n || {}, e.each(i, (function(e, i) {
                            var s = t.cssUnit(i);
                            s[0] > 0 && (n[i] = s[0] * o + s[1])
                        })), n
                    }
                }),
                e.fn.extend({
                    effect: function() {
                        var i = t.apply(this, arguments),
                            o = i.mode,
                            n = i.queue,
                            s = e.effects.effect[i.effect];
                        if (e.fx.off || !s)
                            return o ? this[o](i.duration, i.complete) : this.each((function() {
                                i.complete && i.complete.call(this)
                            }));
                        function a(t) {
                            var o = e(this),
                                n = i.complete,
                                a = i.mode;
                            function r() {
                                e.isFunction(n) && n.call(o[0]),
                                e.isFunction(t) && t()
                            }
                            (o.is(":hidden") ? "hide" === a : "show" === a) ? (o[a](), r()) : s.call(o[0], i, r)
                        }
                        return !1 === n ? this.each(a) : this.queue(n || "fx", a)
                    },
                    show: (o = e.fn.show, function(e) {
                        if (i(e))
                            return o.apply(this, arguments);
                        var n = t.apply(this, arguments);
                        return n.mode = "show", this.effect.call(this, n)
                    }),
                    hide: function(e) {
                        return function(o) {
                            if (i(o))
                                return e.apply(this, arguments);
                            var n = t.apply(this, arguments);
                            return n.mode = "hide", this.effect.call(this, n)
                        }
                    }(e.fn.hide),
                    toggle: function(e) {
                        return function(o) {
                            if (i(o) || "boolean" == typeof o)
                                return e.apply(this, arguments);
                            var n = t.apply(this, arguments);
                            return n.mode = "toggle", this.effect.call(this, n)
                        }
                    }(e.fn.toggle),
                    cssUnit: function(t) {
                        var i = this.css(t),
                            o = [];
                        return e.each(["em", "px", "%", "pt"], (function(e, t) {
                            i.indexOf(t) > 0 && (o = [parseFloat(i), t])
                        })), o
                    }
                })
            }(),
            i = {},
            e.each(["Quad", "Cubic", "Quart", "Quint", "Expo"], (function(e, t) {
                i[t] = function(t) {
                    return Math.pow(t, e + 2)
                }
            })),
            e.extend(i, {
                Sine: function(e) {
                    return 1 - Math.cos(e * Math.PI / 2)
                },
                Circ: function(e) {
                    return 1 - Math.sqrt(1 - e * e)
                },
                Elastic: function(e) {
                    return 0 === e || 1 === e ? e : -Math.pow(2, 8 * (e - 1)) * Math.sin((80 * (e - 1) - 7.5) * Math.PI / 15)
                },
                Back: function(e) {
                    return e * e * (3 * e - 2)
                },
                Bounce: function(e) {
                    for (var t, i = 4; e < ((t = Math.pow(2, --i)) - 1) / 11;)
                        ;
                    return 1 / Math.pow(4, 3 - i) - 7.5625 * Math.pow((3 * t - 2) / 22 - e, 2)
                }
            }),
            e.each(i, (function(t, i) {
                e.easing["easeIn" + t] = i,
                e.easing["easeOut" + t] = function(e) {
                    return 1 - i(1 - e)
                },
                e.easing["easeInOut" + t] = function(e) {
                    return e < .5 ? i(2 * e) / 2 : 1 - i(-2 * e + 2) / 2
                }
            }))
        }(jQuery),
        function(e, t) {
            var i = /up|down|vertical/,
                o = /up|left|vertical|horizontal/;
            e.effects.effect.blind = function(t, n) {
                var s,
                    a,
                    r,
                    l = e(this),
                    c = ["position", "top", "bottom", "left", "right", "height", "width"],
                    d = e.effects.setMode(l, t.mode || "hide"),
                    h = t.direction || "up",
                    p = i.test(h),
                    u = p ? "height" : "width",
                    f = p ? "top" : "left",
                    m = o.test(h),
                    g = {},
                    v = "show" === d;
                l.parent().is(".ui-effects-wrapper") ? e.effects.save(l.parent(), c) : e.effects.save(l, c),
                l.show(),
                a = (s = e.effects.createWrapper(l).css({
                    overflow: "hidden"
                }))[u](),
                r = parseFloat(s.css(f)) || 0,
                g[u] = v ? a : 0,
                m || (l.css(p ? "bottom" : "right", 0).css(p ? "top" : "left", "auto").css({
                    position: "absolute"
                }), g[f] = v ? r : a + r),
                v && (s.css(u, 0), m || s.css(f, r + a)),
                s.animate(g, {
                    duration: t.duration,
                    easing: t.easing,
                    queue: !1,
                    complete: function() {
                        "hide" === d && l.hide(),
                        e.effects.restore(l, c),
                        e.effects.removeWrapper(l),
                        n()
                    }
                })
            }
        }(jQuery),
        function(e, t) {
            e.effects.effect.bounce = function(t, i) {
                var o,
                    n,
                    s,
                    a = e(this),
                    r = ["position", "top", "bottom", "left", "right", "height", "width"],
                    l = e.effects.setMode(a, t.mode || "effect"),
                    c = "hide" === l,
                    d = "show" === l,
                    h = t.direction || "up",
                    p = t.distance,
                    u = t.times || 5,
                    f = 2 * u + (d || c ? 1 : 0),
                    m = t.duration / f,
                    g = t.easing,
                    v = "up" === h || "down" === h ? "top" : "left",
                    b = "up" === h || "left" === h,
                    y = a.queue(),
                    w = y.length;
                for ((d || c) && r.push("opacity"), e.effects.save(a, r), a.show(), e.effects.createWrapper(a), p || (p = a["top" === v ? "outerHeight" : "outerWidth"]() / 3), d && ((s = {
                    opacity: 1
                })[v] = 0, a.css("opacity", 0).css(v, b ? 2 * -p : 2 * p).animate(s, m, g)), c && (p /= Math.pow(2, u - 1)), (s = {})[v] = 0, o = 0; o < u; o++)
                    (n = {})[v] = (b ? "-=" : "+=") + p,
                    a.animate(n, m, g).animate(s, m, g),
                    p = c ? 2 * p : p / 2;
                c && ((n = {
                    opacity: 0
                })[v] = (b ? "-=" : "+=") + p, a.animate(n, m, g)),
                a.queue((function() {
                    c && a.hide(),
                    e.effects.restore(a, r),
                    e.effects.removeWrapper(a),
                    i()
                })),
                w > 1 && y.splice.apply(y, [1, 0].concat(y.splice(w, f + 1))),
                a.dequeue()
            }
        }(jQuery),
        function(e, t) {
            e.effects.effect.clip = function(t, i) {
                var o,
                    n,
                    s,
                    a = e(this),
                    r = ["position", "top", "bottom", "left", "right", "height", "width"],
                    l = "show" === e.effects.setMode(a, t.mode || "hide"),
                    c = "vertical" === (t.direction || "vertical"),
                    d = c ? "height" : "width",
                    h = c ? "top" : "left",
                    p = {};
                e.effects.save(a, r),
                a.show(),
                o = e.effects.createWrapper(a).css({
                    overflow: "hidden"
                }),
                s = (n = "IMG" === a[0].tagName ? o : a)[d](),
                l && (n.css(d, 0), n.css(h, s / 2)),
                p[d] = l ? s : 0,
                p[h] = l ? 0 : s / 2,
                n.animate(p, {
                    queue: !1,
                    duration: t.duration,
                    easing: t.easing,
                    complete: function() {
                        l || a.hide(),
                        e.effects.restore(a, r),
                        e.effects.removeWrapper(a),
                        i()
                    }
                })
            }
        }(jQuery),
        function(e, t) {
            e.effects.effect.drop = function(t, i) {
                var o,
                    n = e(this),
                    s = ["position", "top", "bottom", "left", "right", "opacity", "height", "width"],
                    a = e.effects.setMode(n, t.mode || "hide"),
                    r = "show" === a,
                    l = t.direction || "left",
                    c = "up" === l || "down" === l ? "top" : "left",
                    d = "up" === l || "left" === l ? "pos" : "neg",
                    h = {
                        opacity: r ? 1 : 0
                    };
                e.effects.save(n, s),
                n.show(),
                e.effects.createWrapper(n),
                o = t.distance || n["top" === c ? "outerHeight" : "outerWidth"](!0) / 2,
                r && n.css("opacity", 0).css(c, "pos" === d ? -o : o),
                h[c] = (r ? "pos" === d ? "+=" : "-=" : "pos" === d ? "-=" : "+=") + o,
                n.animate(h, {
                    queue: !1,
                    duration: t.duration,
                    easing: t.easing,
                    complete: function() {
                        "hide" === a && n.hide(),
                        e.effects.restore(n, s),
                        e.effects.removeWrapper(n),
                        i()
                    }
                })
            }
        }(jQuery),
        function(e, t) {
            e.effects.effect.explode = function(t, i) {
                var o,
                    n,
                    s,
                    a,
                    r,
                    l,
                    c = t.pieces ? Math.round(Math.sqrt(t.pieces)) : 3,
                    d = c,
                    h = e(this),
                    p = "show" === e.effects.setMode(h, t.mode || "hide"),
                    u = h.show().css("visibility", "hidden").offset(),
                    f = Math.ceil(h.outerWidth() / d),
                    m = Math.ceil(h.outerHeight() / c),
                    g = [];
                function v() {
                    g.push(this),
                    g.length === c * d && function() {
                        h.css({
                            visibility: "visible"
                        }),
                        e(g).remove(),
                        p || h.hide();
                        i()
                    }()
                }
                for (o = 0; o < c; o++)
                    for (a = u.top + o * m, l = o - (c - 1) / 2, n = 0; n < d; n++)
                        s = u.left + n * f,
                        r = n - (d - 1) / 2,
                        h.clone().appendTo("body").wrap("<div></div>").css({
                            position: "absolute",
                            visibility: "visible",
                            left: -n * f,
                            top: -o * m
                        }).parent().addClass("ui-effects-explode").css({
                            position: "absolute",
                            overflow: "hidden",
                            width: f,
                            height: m,
                            left: s + (p ? r * f : 0),
                            top: a + (p ? l * m : 0),
                            opacity: p ? 0 : 1
                        }).animate({
                            left: s + (p ? 0 : r * f),
                            top: a + (p ? 0 : l * m),
                            opacity: p ? 1 : 0
                        }, t.duration || 500, t.easing, v)
            }
        }(jQuery),
        function(e, t) {
            e.effects.effect.fade = function(t, i) {
                var o = e(this),
                    n = e.effects.setMode(o, t.mode || "toggle");
                o.animate({
                    opacity: n
                }, {
                    queue: !1,
                    duration: t.duration,
                    easing: t.easing,
                    complete: i
                })
            }
        }(jQuery),
        function(e, t) {
            e.effects.effect.fold = function(t, i) {
                var o,
                    n,
                    s = e(this),
                    a = ["position", "top", "bottom", "left", "right", "height", "width"],
                    r = e.effects.setMode(s, t.mode || "hide"),
                    l = "show" === r,
                    c = "hide" === r,
                    d = t.size || 15,
                    h = /([0-9]+)%/.exec(d),
                    p = !!t.horizFirst,
                    u = l !== p,
                    f = u ? ["width", "height"] : ["height", "width"],
                    m = t.duration / 2,
                    g = {},
                    v = {};
                e.effects.save(s, a),
                s.show(),
                o = e.effects.createWrapper(s).css({
                    overflow: "hidden"
                }),
                n = u ? [o.width(), o.height()] : [o.height(), o.width()],
                h && (d = parseInt(h[1], 10) / 100 * n[c ? 0 : 1]),
                l && o.css(p ? {
                    height: 0,
                    width: d
                } : {
                    height: d,
                    width: 0
                }),
                g[f[0]] = l ? n[0] : d,
                v[f[1]] = l ? n[1] : 0,
                o.animate(g, m, t.easing).animate(v, m, t.easing, (function() {
                    c && s.hide(),
                    e.effects.restore(s, a),
                    e.effects.removeWrapper(s),
                    i()
                }))
            }
        }(jQuery),
        function(e, t) {
            e.effects.effect.highlight = function(t, i) {
                var o = e(this),
                    n = ["backgroundImage", "backgroundColor", "opacity"],
                    s = e.effects.setMode(o, t.mode || "show"),
                    a = {
                        backgroundColor: o.css("backgroundColor")
                    };
                "hide" === s && (a.opacity = 0),
                e.effects.save(o, n),
                o.show().css({
                    backgroundImage: "none",
                    backgroundColor: t.color || "#ffff99"
                }).animate(a, {
                    queue: !1,
                    duration: t.duration,
                    easing: t.easing,
                    complete: function() {
                        "hide" === s && o.hide(),
                        e.effects.restore(o, n),
                        i()
                    }
                })
            }
        }(jQuery),
        function(e, t) {
            e.effects.effect.pulsate = function(t, i) {
                var o,
                    n = e(this),
                    s = e.effects.setMode(n, t.mode || "show"),
                    a = "show" === s,
                    r = "hide" === s,
                    l = a || "hide" === s,
                    c = 2 * (t.times || 5) + (l ? 1 : 0),
                    d = t.duration / c,
                    h = 0,
                    p = n.queue(),
                    u = p.length;
                for (!a && n.is(":visible") || (n.css("opacity", 0).show(), h = 1), o = 1; o < c; o++)
                    n.animate({
                        opacity: h
                    }, d, t.easing),
                    h = 1 - h;
                n.animate({
                    opacity: h
                }, d, t.easing),
                n.queue((function() {
                    r && n.hide(),
                    i()
                })),
                u > 1 && p.splice.apply(p, [1, 0].concat(p.splice(u, c + 1))),
                n.dequeue()
            }
        }(jQuery),
        function(e, t) {
            e.effects.effect.puff = function(t, i) {
                var o = e(this),
                    n = e.effects.setMode(o, t.mode || "hide"),
                    s = "hide" === n,
                    a = parseInt(t.percent, 10) || 150,
                    r = a / 100,
                    l = {
                        height: o.height(),
                        width: o.width(),
                        outerHeight: o.outerHeight(),
                        outerWidth: o.outerWidth()
                    };
                e.extend(t, {
                    effect: "scale",
                    queue: !1,
                    fade: !0,
                    mode: n,
                    complete: i,
                    percent: s ? a : 100,
                    from: s ? l : {
                        height: l.height * r,
                        width: l.width * r,
                        outerHeight: l.outerHeight * r,
                        outerWidth: l.outerWidth * r
                    }
                }),
                o.effect(t)
            },
            e.effects.effect.scale = function(t, i) {
                var o = e(this),
                    n = e.extend(!0, {}, t),
                    s = e.effects.setMode(o, t.mode || "effect"),
                    a = parseInt(t.percent, 10) || (0 === parseInt(t.percent, 10) || "hide" === s ? 0 : 100),
                    r = t.direction || "both",
                    l = t.origin,
                    c = {
                        height: o.height(),
                        width: o.width(),
                        outerHeight: o.outerHeight(),
                        outerWidth: o.outerWidth()
                    },
                    d = "horizontal" !== r ? a / 100 : 1,
                    h = "vertical" !== r ? a / 100 : 1;
                n.effect = "size",
                n.queue = !1,
                n.complete = i,
                "effect" !== s && (n.origin = l || ["middle", "center"], n.restore = !0),
                n.from = t.from || ("show" === s ? {
                    height: 0,
                    width: 0,
                    outerHeight: 0,
                    outerWidth: 0
                } : c),
                n.to = {
                    height: c.height * d,
                    width: c.width * h,
                    outerHeight: c.outerHeight * d,
                    outerWidth: c.outerWidth * h
                },
                n.fade && ("show" === s && (n.from.opacity = 0, n.to.opacity = 1), "hide" === s && (n.from.opacity = 1, n.to.opacity = 0)),
                o.effect(n)
            },
            e.effects.effect.size = function(t, i) {
                var o,
                    n,
                    s,
                    a = e(this),
                    r = ["position", "top", "bottom", "left", "right", "width", "height", "overflow", "opacity"],
                    l = ["width", "height", "overflow"],
                    c = ["fontSize"],
                    d = ["borderTopWidth", "borderBottomWidth", "paddingTop", "paddingBottom"],
                    h = ["borderLeftWidth", "borderRightWidth", "paddingLeft", "paddingRight"],
                    p = e.effects.setMode(a, t.mode || "effect"),
                    u = t.restore || "effect" !== p,
                    f = t.scale || "both",
                    m = t.origin || ["middle", "center"],
                    g = a.css("position"),
                    v = u ? r : ["position", "top", "bottom", "left", "right", "overflow", "opacity"],
                    b = {
                        height: 0,
                        width: 0,
                        outerHeight: 0,
                        outerWidth: 0
                    };
                "show" === p && a.show(),
                o = {
                    height: a.height(),
                    width: a.width(),
                    outerHeight: a.outerHeight(),
                    outerWidth: a.outerWidth()
                },
                "toggle" === t.mode && "show" === p ? (a.from = t.to || b, a.to = t.from || o) : (a.from = t.from || ("show" === p ? b : o), a.to = t.to || ("hide" === p ? b : o)),
                s = {
                    from: {
                        y: a.from.height / o.height,
                        x: a.from.width / o.width
                    },
                    to: {
                        y: a.to.height / o.height,
                        x: a.to.width / o.width
                    }
                },
                "box" !== f && "both" !== f || (s.from.y !== s.to.y && (v = v.concat(d), a.from = e.effects.setTransition(a, d, s.from.y, a.from), a.to = e.effects.setTransition(a, d, s.to.y, a.to)), s.from.x !== s.to.x && (v = v.concat(h), a.from = e.effects.setTransition(a, h, s.from.x, a.from), a.to = e.effects.setTransition(a, h, s.to.x, a.to))),
                "content" !== f && "both" !== f || s.from.y !== s.to.y && (v = v.concat(c).concat(l), a.from = e.effects.setTransition(a, c, s.from.y, a.from), a.to = e.effects.setTransition(a, c, s.to.y, a.to)),
                e.effects.save(a, v),
                a.show(),
                e.effects.createWrapper(a),
                a.css("overflow", "hidden").css(a.from),
                m && (n = e.effects.getBaseline(m, o), a.from.top = (o.outerHeight - a.outerHeight()) * n.y, a.from.left = (o.outerWidth - a.outerWidth()) * n.x, a.to.top = (o.outerHeight - a.to.outerHeight) * n.y, a.to.left = (o.outerWidth - a.to.outerWidth) * n.x),
                a.css(a.from),
                "content" !== f && "both" !== f || (d = d.concat(["marginTop", "marginBottom"]).concat(c), h = h.concat(["marginLeft", "marginRight"]), l = r.concat(d).concat(h), a.find("*[width]").each((function() {
                    var i = e(this),
                        o = i.height(),
                        n = i.width(),
                        a = i.outerHeight(),
                        r = i.outerWidth();
                    u && e.effects.save(i, l),
                    i.from = {
                        height: o * s.from.y,
                        width: n * s.from.x,
                        outerHeight: a * s.from.y,
                        outerWidth: r * s.from.x
                    },
                    i.to = {
                        height: o * s.to.y,
                        width: n * s.to.x,
                        outerHeight: o * s.to.y,
                        outerWidth: n * s.to.x
                    },
                    s.from.y !== s.to.y && (i.from = e.effects.setTransition(i, d, s.from.y, i.from), i.to = e.effects.setTransition(i, d, s.to.y, i.to)),
                    s.from.x !== s.to.x && (i.from = e.effects.setTransition(i, h, s.from.x, i.from), i.to = e.effects.setTransition(i, h, s.to.x, i.to)),
                    i.css(i.from),
                    i.animate(i.to, t.duration, t.easing, (function() {
                        u && e.effects.restore(i, l)
                    }))
                }))),
                a.animate(a.to, {
                    queue: !1,
                    duration: t.duration,
                    easing: t.easing,
                    complete: function() {
                        0 === a.to.opacity && a.css("opacity", a.from.opacity),
                        "hide" === p && a.hide(),
                        e.effects.restore(a, v),
                        u || ("static" === g ? a.css({
                            position: "relative",
                            top: a.to.top,
                            left: a.to.left
                        }) : e.each(["top", "left"], (function(e, t) {
                            a.css(t, (function(t, i) {
                                var o = parseInt(i, 10),
                                    n = e ? a.to.left : a.to.top;
                                return "auto" === i ? n + "px" : o + n + "px"
                            }))
                        }))),
                        e.effects.removeWrapper(a),
                        i()
                    }
                })
            }
        }(jQuery),
        function(e, t) {
            e.effects.effect.shake = function(t, i) {
                var o,
                    n = e(this),
                    s = ["position", "top", "bottom", "left", "right", "height", "width"],
                    a = e.effects.setMode(n, t.mode || "effect"),
                    r = t.direction || "left",
                    l = t.distance || 20,
                    c = t.times || 3,
                    d = 2 * c + 1,
                    h = Math.round(t.duration / d),
                    p = "up" === r || "down" === r ? "top" : "left",
                    u = "up" === r || "left" === r,
                    f = {},
                    m = {},
                    g = {},
                    v = n.queue(),
                    b = v.length;
                for (e.effects.save(n, s), n.show(), e.effects.createWrapper(n), f[p] = (u ? "-=" : "+=") + l, m[p] = (u ? "+=" : "-=") + 2 * l, g[p] = (u ? "-=" : "+=") + 2 * l, n.animate(f, h, t.easing), o = 1; o < c; o++)
                    n.animate(m, h, t.easing).animate(g, h, t.easing);
                n.animate(m, h, t.easing).animate(f, h / 2, t.easing).queue((function() {
                    "hide" === a && n.hide(),
                    e.effects.restore(n, s),
                    e.effects.removeWrapper(n),
                    i()
                })),
                b > 1 && v.splice.apply(v, [1, 0].concat(v.splice(b, d + 1))),
                n.dequeue()
            }
        }(jQuery),
        function(e, t) {
            e.effects.effect.slide = function(t, i) {
                var o,
                    n = e(this),
                    s = ["position", "top", "bottom", "left", "right", "width", "height"],
                    a = e.effects.setMode(n, t.mode || "show"),
                    r = "show" === a,
                    l = t.direction || "left",
                    c = "up" === l || "down" === l ? "top" : "left",
                    d = "up" === l || "left" === l,
                    h = {};
                e.effects.save(n, s),
                n.show(),
                o = t.distance || n["top" === c ? "outerHeight" : "outerWidth"](!0),
                e.effects.createWrapper(n).css({
                    overflow: "hidden"
                }),
                r && n.css(c, d ? isNaN(o) ? "-" + o : -o : o),
                h[c] = (r ? d ? "+=" : "-=" : d ? "-=" : "+=") + o,
                n.animate(h, {
                    queue: !1,
                    duration: t.duration,
                    easing: t.easing,
                    complete: function() {
                        "hide" === a && n.hide(),
                        e.effects.restore(n, s),
                        e.effects.removeWrapper(n),
                        i()
                    }
                })
            }
        }(jQuery),
        function(e, t) {
            e.effects.effect.transfer = function(t, i) {
                var o = e(this),
                    n = e(t.to),
                    s = "fixed" === n.css("position"),
                    a = e("body"),
                    r = s ? a.scrollTop() : 0,
                    l = s ? a.scrollLeft() : 0,
                    c = n.offset(),
                    d = {
                        top: c.top - r,
                        left: c.left - l,
                        height: n.innerHeight(),
                        width: n.innerWidth()
                    },
                    h = o.offset(),
                    p = e("<div class='ui-effects-transfer'></div>").appendTo(document.body).addClass(t.className).css({
                        top: h.top - r,
                        left: h.left - l,
                        height: o.innerHeight(),
                        width: o.innerWidth(),
                        position: s ? "fixed" : "absolute"
                    }).animate(d, t.duration, t.easing, (function() {
                        p.remove(),
                        i()
                    }))
            }
        }(jQuery);
        i("./node_modules/script-loader/index.js!./src/lib/jqueryui/jquery-ui-i18n.js"),
        i("./node_modules/script-loader/index.js!./src/lib/jqueryui/jquery.ui.touch-punch.min.js"),
        i("./src/lib/excel/jszip.js");
        i("./src/init_touch.js");
        const o = {
                previewPDFDocument_PREPARE: function() {},
                previewPDFDocumentRich: function(e) {
                    if (!database.printRich)
                        return $.alert("Printing is only supported on Ninox Cloud databases.");
                    database.printRich(e, (async function(t, i) {
                        if (t)
                            return $.alert(t + " - " + i);
                        var o = i.id;
                        NinoxDocumentInteraction.executeURL(database.loadFileURL(o, e.name, "application/pdf", !0))
                    }))
                },
                savePDFDocumentRich: function(e, t) {
                    database.printRich(e, (function(i, o) {
                        if (i)
                            return t(i);
                        t(void 0, database.loadFileURL(o.id, e.name, "application/pdf", !1))
                    }))
                },
                previewPDFDocument: function(e) {
                    if (!database.printSimple)
                        return $.alert("Printing is only supported on Ninox Cloud databases.");
                    o.previewPDFDocument_PREPARE(),
                    database.printSimple(e, (function(t, i) {
                        if (t)
                            $.alert(t + " - " + i);
                        else {
                            var o = i.id;
                            NinoxDocumentInteraction.executeURL(database.loadFileURL(o, e.name, "application/pdf", !0))
                        }
                    }))
                }
            },
            n = {
                type: "WebApp",
                availableFontFamilies: function() {
                    return ["Avenir", "Avenir Next", "Courier", "Courier New", "Helvetica", "HelveticaNeue", "Times", "Times New Roman", "Verdana"]
                },
                setWindowTitle: function(e) {
                    document.title = e
                },
                getUserDefault: function(e) {
                    try {
                        return window.localStorage ? window.localStorage[e] : void 0
                    } catch (t) {
                        return void console.log("Cannot get user default", e, t)
                    }
                },
                setUserDefault: function(e, t) {
                    try {
                        window.localStorage && (window.localStorage[e] = t)
                    } catch (i) {
                        console.log("Cannot store user default", e, t, i)
                    }
                },
                defaultDecimalSymbolIsComma: function() {
                    return "de" === LOCALE
                },
                saveFile: function(e, t, i) {},
                openBrowser: function(e) {
                    /^(mailto|tel)\:/.test(e) && !$.browser.chrome ? n.executeURL(e) : window.open(e)
                },
                previewDocument: function(e, t) {
                    try {
                        window.open(e)
                    } catch (e) {
                        console.warn(e)
                    }
                    t()
                },
                chooseFile: function(e) {
                    $.chooseFile({
                        clientX: 0,
                        clientY: 0
                    }, e)
                },
                chooseFileWithExtensions: function(e, t) {
                    $.chooseFileWithExtensions(e, t)
                }
            };
        n.openMap = function(e, t) {
            !function(e) {
                if (window.google)
                    return console.info("Google maps included already"), e();
                var t,
                    i = /^([A-Z]+)(?:\-([A-Z]+))?$/i.exec(navigator.language);
                i && (t = (i[2] || i[1]).toUpperCase());
                var o = document.createElement("script");
                o.src = "https://maps.googleapis.com/maps/api/js?key=AIzaSyBXwXuSRu4AR3-gB6o1mv8ifEBwROKdNYE&libraries=geometry,places" + (t ? "&region=" + t : ""),
                o.onload = function() {
                    e && e()
                },
                o.onerror = function() {
                    this.mapLoadErrors = !0
                },
                document.body.appendChild(o)
            }((function() {
                var i = $.backplane(),
                    o = new google.maps.Geocoder,
                    n = "Berlin, Germany",
                    s = 52.5200066,
                    a = 13.404954;
                new google.maps.LatLng(s, a),
                $('<div id="map-container" >').append($('<div id="map">')).append($('<div class="search-container"> ').append($("<div class='i-32-24 i-light-grey i-search controls search-icon'></div>"))).append($('<div class="controls-container">').append($('<button class="btn-cancel">Cancel</button>').on("touchstart click", r)).append($('<button class="btn-save">Save</button>').on("touchstart click", (function() {
                    t(null, e),
                    r()
                })))).append($('<input class="search-box" id="pac-input" type="text" placeholder="Search">')).appendTo(i);
                function r() {
                    i.close()
                }
                function l(e, t, i) {
                    o.geocode({
                        location: {
                            lat: e,
                            lng: t
                        }
                    }, (function(e, t) {
                        if ("OK" === t) {
                            var o = function e(t, i) {
                                if (t && (!/^(Unnamed Road)/.test(t) || !i.length))
                                    return t;
                                var o;
                                if (!(o = (o = i.splice(0, 1))[0]))
                                    return t || "";
                                return e(o, i)
                            }(null, e.map((function(e) {
                                return e.formatted_address
                            })));
                            i(null, o)
                        } else
                            i(!0)
                    }))
                }
                function c(t, i, o, r) {
                    if (null == e ? ((e = {}).latitude = t, e.longitude = i, e.title = o) : (e.latitude = t, e.longitude = i), "function" != typeof o || r || (r = o, o = void 0), s = t, a = i, new google.maps.LatLng(s, a), o)
                        return n = o, e.title = n, !r || r();
                    l(s, a, (function(t, i) {
                        if (n = i, e.title = n, r)
                            return r()
                    }))
                }
                function d() {
                    !function(e) {
                        var t = new google.maps.Map(document.getElementById("map"), {
                            center: {
                                lat: s,
                                lng: a
                            },
                            zoom: 15,
                            fullscreenControl: !1
                        });
                        e(null, t)
                    }((function(e, t) {
                        t.controls[google.maps.ControlPosition.TOP_LEFT].push(document.getElementById("pac-input"));
                        var i = new google.maps.Marker({
                                position: {
                                    lat: s,
                                    lng: a
                                },
                                map: t
                            }),
                            o = new google.maps.places.SearchBox(document.getElementById("pac-input")),
                            n = new google.maps.places.Autocomplete(document.getElementById("pac-input"));
                        t.addListener("click", (function(e) {
                            e.latLng && c(e.latLng.lat(), e.latLng.lng(), (function() {
                                i && i.setMap(null),
                                i = new google.maps.Marker({
                                    position: {
                                        lat: s,
                                        lng: a
                                    },
                                    map: t
                                })
                            }))
                        })),
                        n.addListener("place_changed", (function(e) {
                            var o = n.getPlace();
                            o.geometry && c(o.geometry.location.lat(), o.geometry.location.lng(), o.formatted_address, (function() {
                                o.geometry.viewport ? t.fitBounds(o.geometry.viewport) : (t.setCenter(o.geometry.location), t.setZoom(17)),
                                i && i.setMap(null),
                                i = new google.maps.Marker({
                                    position: {
                                        lat: s,
                                        lng: a
                                    },
                                    map: t
                                })
                            }))
                        })),
                        o.addListener("places_changed", (function(e) {
                            var n = o.getPlaces();
                            if (n.length) {
                                var r = n[0];
                                c(r.geometry.location.lat(), r.geometry.location.lng(), r.formatted_address, (function() {
                                    r.geometry.viewport ? t.fitBounds(r.geometry.viewport) : (t.setCenter(r.geometry.location), t.setZoom(17)),
                                    i && i.setMap(null),
                                    i = new google.maps.Marker({
                                        position: {
                                            lat: s,
                                            lng: a
                                        },
                                        map: t
                                    })
                                }))
                            }
                        }))
                    }))
                }
                e ? e.latitude && e.longitude ? c(util.parseNumber(e.latitude) || s, util.parseNumber(e.longitude) || a, d) : d() : function(e) {
                    if (!("geolocation" in navigator))
                        return e(!0);
                    navigator.geolocation.getCurrentPosition((function(t) {
                        e(!1, {
                            latitude: t.coords.latitude,
                            longitude: t.coords.longitude
                        })
                    }), (function() {
                        return e(!0)
                    }))
                }((function(e, t) {
                    return t ? c(t.latitude, t.longitude, d) : d()
                }))
            }))
        },
        n.openFileWithServer = function(e, t, i, o, s) {
            var a = s && !0,
                r = !a && !0,
                l = void 0;
            r && (l = window.open("about:blank"));
            var c = database.saveFileURL(e, t, o);
            $.ajax({
                type: "POST",
                url: c,
                data: i,
                xhrFields: {
                    withCredentials: !0
                },
                contentType: "application/octet-stream",
                processData: !1,
                cache: !1,
                success: function(i, o, s) {
                    var c = database.loadFileURL(i, e, t, a);
                    a ? n.executeURL(c) : r && (l.location.href = c)
                },
                error: function(e, t, i) {
                    $.alert("Failed to export file")
                }
            })
        },
        n.executeURL = function(e) {
            var t = document.getElementById("NX-Download-Helper");
            t && t.parentNode.removeChild(t),
            (t = document.createElement("iframe")).id = "NX-Download-Helper",
            t.style.display = "none",
            document.body.appendChild(t),
            t.src = e
        },
        n.execCut = function() {
            document.execCommand("cut")
        },
        n.execCopy = function() {
            document.execCommand("copy")
        },
        n.execPaste = function() {
            document.execCommand("paste")
        },
        n.coordinatesForAddress = function(e, t) {
            t()
        },
        n.isOnline = function() {
            return !0
        },
        n.barcodeScan = function(e) {
            e(null, "")
        };
        const s = {
                enableCalendarSync: function(e) {
                    e("Not supported.")
                },
                calendarForDatabase: function(e) {},
                removeEvents: function(e, t, i) {},
                addEvent: function(e, t, i, o, n) {},
                addEvent2: function(e, t, i, o, n, s) {},
                addReminder2: function() {},
                commit: function(e) {
                    e()
                },
                getSources: function() {
                    return []
                },
                loadCalendar: function(e, t, i) {
                    i()
                },
                getEventCalendar: function(e) {},
                getReminderCalendar: function(e) {}
            },
            a = {
                isBarcodeScannerActive: function() {
                    return !1
                },
                enableBarcodeScanner: function() {},
                disableBarcodeScanner: function() {},
                initializationDone: function() {},
                clearLaunchURL: function() {},
                everythingSaved: function() {},
                setNavigationProperty: function(e, t) {},
                getNavigationProperty: function(e) {},
                clearNavigation: function() {}
            },
            r = {
                cachedURL: function(e, t) {
                    return e
                }
            };
        !function() {
            if ("undefined" == typeof console && (console = {
                log: function() {},
                info: function() {},
                warn: function() {},
                error: function() {},
                trace: function() {}
            }), String.prototype.trim || (String.prototype.trim = function() {
                return this.replace(/^\s+|\s+$/g, "")
            }), $.uaMatch = function(e) {
                e = e.toLowerCase();
                var t = /(chrome)[ \/]([\w.]+)/.exec(e) || /(webkit)[ \/]([\w.]+)/.exec(e) || /(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e) || /(msie) ([\w.]+)/.exec(e) || e.indexOf("compatible") < 0 && /(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e) || [];
                return {
                    browser: t[1] || "",
                    version: t[2] || "0"
                }
            }, !$.browser) {
                var e = $.uaMatch(navigator.userAgent),
                    t = {};
                e.browser && (t[e.browser] = !0, t.version = e.version),
                t.chrome ? t.webkit = !0 : t.webkit && (t.safari = !0),
                $.browser = t
            }
            var i = window.navigator.userAgent,
                o = /Safari/.test(i),
                n = /iPad/i.test(i) || o && document.documentElement && null != document.documentElement.ontouchstart,
                s = /iPhone/i.test(i),
                a = /Trident/.test(i),
                r = /Android/.test(i);
            window.NINOX_ANDROID = r,
            window.NINOX_IOS = n || s,
            window.NINOX_IPAD = n,
            window.NINOX_IPHONE = s,
            window.NINOX_IE = a,
            window.OSX_10_9_MODE = /OS X 10_9/.test(i),
            $.initTouchHandlers = function() {},
            $.getDevicePadding = function() {
                var e,
                    t = !1,
                    i = document.createElement("div");
                if (window.CSS && window.CSS.supports("padding-bottom: env(safe-area-inset-bottom)") ? (i.style.paddingBottom = "env(safe-area-inset-bottom)", i.style.paddingLeft = "env(safe-area-inset-left)", i.style.paddingRight = "env(safe-area-inset-right)", i.style.paddingTop = "env(safe-area-inset-top)", t = !0) : window.CSS && window.CSS.supports("padding-bottom: constant(safe-area-inset-bottom)") && (i.style.paddingBottom = "constant(safe-area-inset-bottom)", i.style.paddingLeft = "constant(safe-area-inset-left)", i.style.paddingRight = "constant(safe-area-inset-right)", i.style.paddingTop = "constant(safe-area-inset-top)", t = !0), t) {
                    document.body.appendChild(i);
                    var o = window.getComputedStyle(i);
                    e = {
                        top: parseInt(o.paddingTop),
                        left: parseInt(o.paddingLeft),
                        right: parseInt(o.paddingRight),
                        bottom: parseInt(o.paddingBottom)
                    },
                    document.body.removeChild(i)
                } else
                    e = {
                        top: 0,
                        left: 0,
                        right: 0,
                        bottom: 0
                    };
                return e
            },
            window.TOUCH = window.NINOX_IOS || window.NINOX_ANDROID || "MacIntel" === navigator.platform && navigator.maxTouchPoints > 1,
            $.initTouchHandlers(),
            $.fn.touch = $.fn.click,
            TOUCH ? ($(document.documentElement).addClass("touch"), $.fn.select = function() {
                if (this[0].setSelectionRange)
                    try {
                        this[0].setSelectionRange(0, 9999)
                    } catch (e) {
                        console.warn(e)
                    }
                return this
            }) : $(document.documentElement).addClass("no-touch"),
            $(document).keydown((function(e) {
                13 === e.which && setTimeout((function() {
                    var t = $(e.target);
                    t.is("input") && t.blur()
                }), 0)
            })),
            window.devicePadding = $.getDevicePadding()
        }();
        i("./node_modules/script-loader/index.js!./node_modules/codemirror/lib/codemirror.js"),
        i("./node_modules/script-loader/index.js!./node_modules/codemirror/addon/mode/simple.js");
        var l = i("./node_modules/@ninox/ninox-core/dist/ninox-core.es5.js"),
            c = i("./src/js/printer/printTable.js");
        window.NINOX_VERSION = "3.3.1",
        window.NINOX_WEB = !0,
        window.NINOX_APP = !1,
        window.NINOX_APP_MAC = !1,
        window.NINOX_APP_IOS = !1,
        window.NINOX_APP_IPHONE = !1,
        window.NINOX_APP_IPAD = !1,
        window.NINOX_PRODUCT = "web",
        window.NINOX_APP_ANDROID = !1,
        window.NINOX_APP_TAB = !1,
        window.NINOX_IOS = !1,
        window.NINOX_ENV = "prod",
        window.xlsx = function(e) {
            var t,
                i,
                o,
                n,
                s,
                a,
                r,
                l,
                c,
                d,
                h,
                p,
                u,
                f,
                m,
                g,
                v,
                b,
                y,
                w,
                x,
                T,
                $,
                C,
                k,
                S,
                E,
                _,
                D,
                M,
                N,
                I,
                O,
                R,
                j,
                L,
                F = new JSZip,
                A = [[], []],
                H = [],
                P = [],
                U = [],
                z = ["General", "0", "0.00", "#,##0", "#,##0.00", , , , , "0%", "0.00%", "0.00E+00", "# ?/?", "# ??/??", "mm-dd-yy", "d-mmm-yy", "d-mmm", "mmm-yy", "h:mm AM/PM", "h:mm:ss AM/PM", "h:mm", "h:mm:ss", "m/d/yy h:mm", , , , , , , , , , , , , , , "#,##0 ;(#,##0)", "#,##0 ;[Red](#,##0)", "#,##0.00;(#,##0.00)", "#,##0.00;[Red](#,##0.00)", , , , , "mm:ss", "[h]:mm:ss", "mmss.0", "##0.0E+0", "@"],
                V = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
            function W(e) {
                var t = Math.floor(e / 26) - 1;
                return (t > -1 ? W(t) : "") + V.charAt(e % 26)
            }
            function B(e) {
                var t = 0;
                return 2 === e.length && (t = B(e.charAt(0)) + 1), 26 * t + V.indexOf(e.substr(-1))
            }
            function q(e) {
                var t = new Date(1900, 0, 0),
                    i = "object" == typeof e,
                    o = 6e4 * ((i ? e.getTimezoneOffset() : (new Date).getTimezoneOffset()) - t.getTimezoneOffset());
                return i ? (e - t - o) / 864e5 + 1 : new Date(+t - o + 864e5 * (e - 1))
            }
            function Y(e, t) {
                return (e = e.substr(e.indexOf(t + '="') + t.length + 2)).substring(0, e.indexOf('"'))
            }
            function X(e) {
                return "string" == typeof e ? e.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;") : ""
            }
            function G(e) {
                return "string" == typeof e ? e.replace(/&amp;/g, "&").replace(/&lt;/g, "<").replace(/&gt;/g, ">").replace(/&quot;/g, '"').replace(/&#x27;/g, "'") : ""
            }
            if ("string" == typeof e) {
                if (i = Date.now(), F = F.load(e, {
                    base64: !0
                }), t = {
                    worksheets: [],
                    zipTime: Date.now() - i
                }, o = Date.now(), p = [], u = [], n = F.file("xl/sharedStrings.xml"))
                    for (a = (n = n.asText().split(/<t.*?>/g)).length; --a;)
                        p[a - 1] = G(n[a].substring(0, n[a].indexOf("</t>")));
                if ((n = F.file("docProps/core.xml")) && (n = (n = n.asText()).substr(n.indexOf("<dc:creator>") + 12), t.creator = n.substring(0, n.indexOf("</dc:creator>")), n = n.substr(n.indexOf("<cp:lastModifiedBy>") + 19), t.lastModifiedBy = n.substring(0, n.indexOf("</cp:lastModifiedBy>")), n = n.substr(n.indexOf('<dcterms:created xsi:type="dcterms:W3CDTF">') + 43), t.created = new Date(n.substring(0, n.indexOf("</dcterms:created>"))), n = n.substr(n.indexOf('<dcterms:modified xsi:type="dcterms:W3CDTF">') + 44), t.modified = new Date(n.substring(0, n.indexOf("</dcterms:modified>")))), n = F.file("xl/workbook.xml"))
                    for ((f = (n = n.asText()).indexOf('activeTab="')) > 0 ? (n = n.substr(f + 11), t.activeWorksheet = +n.substring(0, n.indexOf('"'))) : t.activeWorksheet = 0, a = (n = n.split("<sheet ")).length; --a;)
                        _ = n[a].substr(n[a].indexOf('name="') + 6),
                        t.worksheets.unshift({
                            name: _.substring(0, _.indexOf('"')),
                            data: []
                        });
                if (n = F.file("xl/styles.xml")) {
                    for (a = (n = n.asText().split("<numFmt ")).length; --a;)
                        z[+Y(d = n[a], "numFmtId")] = Y(d, "formatCode");
                    for (a = (n = (n = n[n.length - 1]).substr(n.indexOf("cellXfs")).split("<xf ")).length; --a;)
                        d = (s = z[_ = Y(n[a], "numFmtId")]).indexOf("m") > -1 ? "date" : s.indexOf("0") > -1 ? "number" : "@" === s ? "string" : "unknown",
                        u.unshift({
                            formatCode: s,
                            type: d
                        })
                }
                for (a = t.worksheets.length; a--;)
                    for (n = F.file("xl/worksheets/sheet" + (a + 1) + ".xml").asText().split("<row "), (h = t.worksheets[a]).table = n[0].indexOf("<tableParts ") > 0, d = (d = Y(n[0].substr(n[0].indexOf("<dimension")), "ref")).substr(d.indexOf(":") + 1), h.maxCol = B(d.match(/[a-zA-Z]*/g)[0]) + 1, h.maxRow = +d.match(/\d*/g).join(""), h = h.data, r = n.length; --r;)
                        for (O = h[+Y(n[r], "r") - 1] = [], l = (D = n[r].split("<c ")).length; --l;) {
                            switch (s = u[+Y(I = D[l], "s")] || {
                                type: "General",
                                formatCode: "General"
                            }, d = Y(I, "t") || s.type, g = (g = I.substring(I.indexOf("<v>") + 3, I.indexOf("</v>"))) ? +g : "", d) {
                            case "s":
                                g = p[g];
                                break;
                            case "b":
                                g = 1 === g;
                                break;
                            case "date":
                                g = q(g)
                            }
                            O[B(Y(I, "r").match(/[a-zA-Z]*/g)[0])] = {
                                value: g,
                                formatCode: s.formatCode
                            }
                        }
                t.processTime = Date.now() - o
            } else {
                o = Date.now(),
                p = [];
                var J = {};
                for (F.folder("_rels").file(".rels", '<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId3" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties" Target="docProps/app.xml"/><Relationship Id="rId2" Type="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties" Target="docProps/core.xml"/><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml"/></Relationships>'), C = F.folder("docProps"), (k = F.folder("xl")).folder("theme").file("theme1.xml", '<?xml version="1.0" encoding="UTF-8" standalone="yes"?><a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme"><a:themeElements><a:clrScheme name="Office"><a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1><a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1><a:dk2><a:srgbClr val="1F497D"/></a:dk2><a:lt2><a:srgbClr val="EEECE1"/></a:lt2><a:accent1><a:srgbClr val="4F81BD"/></a:accent1><a:accent2><a:srgbClr val="C0504D"/></a:accent2><a:accent3><a:srgbClr val="9BBB59"/></a:accent3><a:accent4><a:srgbClr val="8064A2"/></a:accent4><a:accent5><a:srgbClr val="4BACC6"/></a:accent5><a:accent6><a:srgbClr val="F79646"/></a:accent6><a:hlink><a:srgbClr val="0000FF"/></a:hlink><a:folHlink><a:srgbClr val="800080"/></a:folHlink></a:clrScheme><a:fontScheme name="Office"><a:majorFont><a:latin typeface="Cambria"/><a:ea typeface=""/><a:cs typeface=""/><a:font script="Jpan" typeface="MS P????"/><a:font script="Hang" typeface="?? ??"/><a:font script="Hans" typeface="??"/><a:font script="Hant" typeface="????"/><a:font script="Arab" typeface="Times New Roman"/><a:font script="Hebr" typeface="Times New Roman"/><a:font script="Thai" typeface="Tahoma"/><a:font script="Ethi" typeface="Nyala"/><a:font script="Beng" typeface="Vrinda"/><a:font script="Gujr" typeface="Shruti"/><a:font script="Khmr" typeface="MoolBoran"/><a:font script="Knda" typeface="Tunga"/><a:font script="Guru" typeface="Raavi"/><a:font script="Cans" typeface="Euphemia"/><a:font script="Cher" typeface="Plantagenet Cherokee"/><a:font script="Yiii" typeface="Microsoft Yi Baiti"/><a:font script="Tibt" typeface="Microsoft Himalaya"/><a:font script="Thaa" typeface="MV Boli"/><a:font script="Deva" typeface="Mangal"/><a:font script="Telu" typeface="Gautami"/><a:font script="Taml" typeface="Latha"/><a:font script="Syrc" typeface="Estrangelo Edessa"/><a:font script="Orya" typeface="Kalinga"/><a:font script="Mlym" typeface="Kartika"/><a:font script="Laoo" typeface="DokChampa"/><a:font script="Sinh" typeface="Iskoola Pota"/><a:font script="Mong" typeface="Mongolian Baiti"/><a:font script="Viet" typeface="Times New Roman"/><a:font script="Uigh" typeface="Microsoft Uighur"/><a:font script="Geor" typeface="Sylfaen"/></a:majorFont><a:minorFont><a:latin typeface="Calibri"/><a:ea typeface=""/><a:cs typeface=""/><a:font script="Jpan" typeface="MS P????"/><a:font script="Hang" typeface="?? ??"/><a:font script="Hans" typeface="??"/><a:font script="Hant" typeface="????"/><a:font script="Arab" typeface="Arial"/><a:font script="Hebr" typeface="Arial"/><a:font script="Thai" typeface="Tahoma"/><a:font script="Ethi" typeface="Nyala"/><a:font script="Beng" typeface="Vrinda"/><a:font script="Gujr" typeface="Shruti"/><a:font script="Khmr" typeface="DaunPenh"/><a:font script="Knda" typeface="Tunga"/><a:font script="Guru" typeface="Raavi"/><a:font script="Cans" typeface="Euphemia"/><a:font script="Cher" typeface="Plantagenet Cherokee"/><a:font script="Yiii" typeface="Microsoft Yi Baiti"/><a:font script="Tibt" typeface="Microsoft Himalaya"/><a:font script="Thaa" typeface="MV Boli"/><a:font script="Deva" typeface="Mangal"/><a:font script="Telu" typeface="Gautami"/><a:font script="Taml" typeface="Latha"/><a:font script="Syrc" typeface="Estrangelo Edessa"/><a:font script="Orya" typeface="Kalinga"/><a:font script="Mlym" typeface="Kartika"/><a:font script="Laoo" typeface="DokChampa"/><a:font script="Sinh" typeface="Iskoola Pota"/><a:font script="Mong" typeface="Mongolian Baiti"/><a:font script="Viet" typeface="Arial"/><a:font script="Uigh" typeface="Microsoft Uighur"/><a:font script="Geor" typeface="Sylfaen"/></a:minorFont></a:fontScheme><a:fmtScheme name="Office"><a:fillStyleLst><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs><a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs></a:gsLst><a:lin ang="16200000" scaled="1"/></a:gradFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:shade val="51000"/><a:satMod val="130000"/></a:schemeClr></a:gs><a:gs pos="80000"><a:schemeClr val="phClr"><a:shade val="93000"/><a:satMod val="130000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="94000"/><a:satMod val="135000"/></a:schemeClr></a:gs></a:gsLst><a:lin ang="16200000" scaled="0"/></a:gradFill></a:fillStyleLst><a:lnStyleLst><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln><a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln><a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln></a:lnStyleLst><a:effectStyleLst><a:effectStyle><a:effectLst><a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw></a:effectLst><a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d><a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d></a:effectStyle></a:effectStyleLst><a:bgFillStyleLst><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs><a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs></a:gsLst><a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path></a:gradFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs></a:gsLst><a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path></a:gradFill></a:bgFillStyleLst></a:fmtScheme></a:themeElements><a:objectDefaults/><a:extraClrSchemeLst/></a:theme>'), S = k.folder("worksheets"), C.file("core.xml", '<?xml version="1.0" encoding="UTF-8" standalone="yes"?><cp:coreProperties xmlns:cp="http://schemas.openxmlformats.org/package/2006/metadata/core-properties" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" xmlns:dcmitype="http://purl.org/dc/dcmitype/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><dc:creator>' + (e.creator || "XLSX.js") + "</dc:creator><cp:lastModifiedBy>" + (e.lastModifiedBy || "XLSX.js") + '</cp:lastModifiedBy><dcterms:created xsi:type="dcterms:W3CDTF">' + (e.created || new Date).toISOString() + '</dcterms:created><dcterms:modified xsi:type="dcterms:W3CDTF">' + (e.modified || new Date).toISOString() + "</dcterms:modified></cp:coreProperties>"), u = new Array(1), b = new Array(1), x = new Array(1), h = e.worksheets.length; h--;) {
                    for (_ = h + 1, n = "", D = [], R = [], a = -1, c = (m = (E = e.worksheets[h]).data).length; ++a < c;) {
                        for (r = -1, l = m[a].length, n += '<row r="' + (a + 1) + '" x14ac:dyDescent="0.25">'; ++r < l;) {
                            if (g = (I = m[a][r]).hasOwnProperty("value") ? I.value : I, d = "", v = {
                                borders: I.borders,
                                hAlign: I.hAlign,
                                vAlign: I.vAlign,
                                bold: I.bold,
                                italic: I.italic,
                                fontName: I.fontName,
                                fontSize: I.fontSize,
                                formatCode: I.formatCode || "General"
                            }, N = 0, g && "string" == typeof g ? (void 0 === (f = J[g = X(g)]) && (f = p.length, p.push(g), J[g] = f), N = g.length, g = f, d = "s") : "boolean" == typeof g ? (g = g ? 1 : 0, d = "b", N = 1) : "date" === (L = g, {}.toString.call(L).match(/\s([a-zA-Z]+)/)[1].toLowerCase()) ? (g = q(g), v.formatCode = I.formatCode || "mm-dd-yy", N = g.length) : "object" == typeof g ? g = null : N = ("" + g).length, v = JSON.stringify(v), v = (f = u.indexOf(v)) < 0 ? u.push(v) - 1 : f, null == D[r] && (D[r] = {
                                autoWidth: !1,
                                max: 0
                            }), I.autoWidth && (D[r].autoWidth = !0), N > D[r].max && (D[r].max = N), I.colSpan > 1) {
                                R.push([W(r) + (a + 1), W(r + I.colSpan - 1) + (a + 1)]),
                                j = [r, 0];
                                for (var K = 0; K < I.colSpan - 1; K++)
                                    j.push(I);
                                m[a].splice.apply(m[a], j),
                                l += I.colSpan - 1
                            } else if (I.rowSpan > 1) {
                                for (K = 1; K < I.rowSpan; K++) {
                                    if (!m[a + K]) {
                                        I.rowSpan = K;
                                        break
                                    }
                                    m[a + K].splice(r, 0, I)
                                }
                                R.push([W(r) + (a + 1), W(r) + (a + I.rowSpan)])
                            }
                            (I.rowSpan > 1 || I.colSpan > 1) && (delete I.value, delete I.rowSpan, delete I.colSpan),
                            n += '<c r="' + W(r) + (a + 1) + '"' + (v ? ' s="' + v + '"' : "") + (d ? ' t="' + d + '"' : ""),
                            n += null != g ? ">" + (I.formula ? "<f>" + I.formula + "</f>" : "") + "<v>" + g + "</v></c>" : "/>"
                        }
                        n += "</row>"
                    }
                    for (M = [], a = 0; a < D.length; a++)
                        D[a].autoWidth && M.push('<col min="', a + 1, '" max="', a + 1, '" width="', D[a].max, '" bestFit="1"/>');
                    if (M.length > 0 && (M = ["<cols>"].concat(M, ["</cols>"]).join("")), n = '<?xml version="1.0" encoding="UTF-8" standalone="yes"?><worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"><dimension ref="A1:' + W(m[0].length - 1) + m.length + '"/><sheetViews><sheetView ' + (h === e.activeWorksheet ? 'tabSelected="1" ' : "") + ' workbookViewId="0"/></sheetViews><sheetFormatPr defaultRowHeight="15" x14ac:dyDescent="0.25"/>' + M + "<sheetData>" + n + "</sheetData>", R.length > 0) {
                        for (n += '<mergeCells count="' + R.length + '">', a = 0; a < R.length; a++)
                            n += '<mergeCell ref="' + R[a].join(":") + '"/>';
                        n += "</mergeCells>"
                    }
                    if (n += '<pageMargins left="0.7" right="0.7" top="0.75" bottom="0.75" header="0.3" footer="0.3"/>', E.table && (n += '<tableParts count="1"><tablePart r:id="rId1"/></tableParts>'), S.file("sheet" + _ + ".xml", n + "</worksheet>"), E.table) {
                        for (a = -1, c = m[0].length, n = '<?xml version="1.0" encoding="UTF-8" standalone="yes"?><table xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" id="' + _ + '" name="Table' + _ + '" displayName="Table' + _ + '" ref="A1:' + (d = W(m[0].length - 1) + m.length) + '" totalsRowShown="0"><autoFilter ref="A1:' + d + '"/><tableColumns count="' + m[0].length + '">'; ++a < c;)
                            n += '<tableColumn id="' + (a + 1) + '" name="' + (m[0][a].hasOwnProperty("value") ? m[0][a].value : m[0][a]) + '"/>';
                        n += '</tableColumns><tableStyleInfo name="TableStyleMedium2" showFirstColumn="0" showLastColumn="0" showRowStripes="1" showColumnStripes="0"/></table>',
                        k.folder("tables").file("table" + _ + ".xml", n),
                        S.folder("_rels").file("sheet" + _ + ".xml.rels", '<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/table" Target="../tables/table' + _ + '.xml"/></Relationships>'),
                        A[1].unshift('<Override PartName="/xl/tables/table' + _ + '.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml"/>')
                    }
                    A[0].unshift('<Override PartName="/xl/worksheets/sheet' + _ + '.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"/>'),
                    H.unshift(X(E.name) || "Sheet" + _),
                    P.unshift('<Relationship Id="rId' + _ + '" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet' + _ + '.xml"/>'),
                    U.unshift('<sheet name="' + (X(E.name) || "Sheet" + _) + '" sheetId="' + _ + '" r:id="rId' + _ + '"/>')
                }
                for (a = u.length, d = []; --a;) {
                    if ("General" !== (v = JSON.parse(u[a])).formatCode ? ((f = z.indexOf(v.formatCode)) < 0 && (f = 164 + d.length, d.push('<numFmt formatCode="' + v.formatCode + '" numFmtId="' + f + '"/>')), v.formatCode = f) : v.formatCode = 0, w = 0, v.borders) {
                        for (var Q in y = ["<border>"], {
                            left: 0,
                            right: 0,
                            top: 0,
                            bottom: 0,
                            diagonal: 0
                        })
                            if (v.borders[Q]) {
                                var Z = v.borders[Q];
                                6 === Z.length && (Z = "FF" + Z),
                                y.push("<", Q, ' style="thin">', '<color rgb="', v.borders[Q], '"/></', Q, ">")
                            } else
                                y.push("<", Q, "/>");
                        y.push("</border>"),
                        y = y.join(""),
                        (w = b.indexOf(y)) < 0 && (w = b.push(y) - 1)
                    }
                    $ = 0,
                    (v.bold || v.italic || v.fontSize || v.fontName) && (T = ["<font>"], v.bold && T.push("<b/>"), v.italic && T.push("<i/>"), T.push('<sz val="', v.fontSize || 11, '"/>'), T.push('<color theme="1"/>'), T.push('<name val="', v.fontName || "Calibri", '"/>'), T.push('<family val="2"/>', "</font>"), T = T.join(""), ($ = x.indexOf(T)) < 0 && ($ = x.push(T) - 1)),
                    u[a] = ['<xf xfId="0" fillId="0" borderId="', w, '" fontId="', $, '" numFmtId="', v.formatCode, '" ', v.hAlign || v.vAlign ? 'applyAlignment="1" ' : " ", v.formatCode > 0 ? 'applyNumberFormat="1" ' : " ", w > 0 ? 'applyBorder="1" ' : " ", $ > 0 ? 'applyFont="1" ' : " ", ">"],
                    (v.hAlign || v.vAlign) && (u[a].push("<alignment"), v.hAlign && u[a].push(' horizontal="', v.hAlign, '"'), v.vAlign && u[a].push(' vertical="', v.vAlign, '"'), u[a].push("/>")),
                    u[a].push("</xf>"),
                    u[a] = u[a].join("")
                }
                d = d.length ? '<numFmts count="' + d.length + '">' + d.join("") + "</numFmts>" : "",
                k.file("styles.xml", '<?xml version="1.0" encoding="UTF-8" standalone="yes"?><styleSheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac">' + d + '<fonts count="' + x.length + '" x14ac:knownFonts="1"><font><sz val="11"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font>' + x.join("") + '</fonts><fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills><borders count="' + b.length + '"><border><left/><right/><top/><bottom/><diagonal/></border>' + b.join("") + '</borders><cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs><cellXfs count="' + u.length + '"><xf numFmtId="0" fontId="0" fillId="0" borderId="0" xfId="0"/>' + u.join("") + '</cellXfs><cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles><dxfs count="0"/><tableStyles count="0" defaultTableStyle="TableStyleMedium2" defaultPivotStyle="PivotStyleLight16"/><extLst><ext uri="{EB79DEF2-80B8-43e5-95BD-54CBDDF9020C}" xmlns:x14="http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"><x14:slicerStyles defaultSlicerStyle="SlicerStyleLight1"/></ext></extLst></styleSheet>'),
                F.file("[Content_Types].xml", '<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types"><Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml"/><Default Extension="xml" ContentType="application/xml"/><Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"/>' + A[0].join("") + '<Override PartName="/xl/theme/theme1.xml" ContentType="application/vnd.openxmlformats-officedocument.theme+xml"/><Override PartName="/xl/styles.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"/><Override PartName="/xl/sharedStrings.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"/>' + A[1].join("") + '<Override PartName="/docProps/core.xml" ContentType="application/vnd.openxmlformats-package.core-properties+xml"/><Override PartName="/docProps/app.xml" ContentType="application/vnd.openxmlformats-officedocument.extended-properties+xml"/></Types>'),
                C.file("app.xml", '<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Properties xmlns="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties" xmlns:vt="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"><Application>XLSX.js</Application><DocSecurity>0</DocSecurity><ScaleCrop>false</ScaleCrop><HeadingPairs><vt:vector size="2" baseType="variant"><vt:variant><vt:lpstr>Worksheets</vt:lpstr></vt:variant><vt:variant><vt:i4>' + e.worksheets.length + '</vt:i4></vt:variant></vt:vector></HeadingPairs><TitlesOfParts><vt:vector size="' + H.length + '" baseType="lpstr"><vt:lpstr>' + H.join("</vt:lpstr><vt:lpstr>") + "</vt:lpstr></vt:vector></TitlesOfParts><Manager></Manager><Company>Microsoft Corporation</Company><LinksUpToDate>false</LinksUpToDate><SharedDoc>false</SharedDoc><HyperlinksChanged>false</HyperlinksChanged><AppVersion>1.0</AppVersion></Properties>"),
                k.folder("_rels").file("workbook.xml.rels", '<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">' + P.join("") + '<Relationship Id="rId' + (P.length + 1) + '" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings" Target="sharedStrings.xml"/><Relationship Id="rId' + (P.length + 2) + '" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" Target="styles.xml"/><Relationship Id="rId' + (P.length + 3) + '" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme" Target="theme/theme1.xml"/></Relationships>'),
                k.file("sharedStrings.xml", '<?xml version="1.0" encoding="UTF-8" standalone="yes"?><sst xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" count="' + p.length + '" uniqueCount="' + p.length + '"><si><t>' + p.join("</t></si><si><t>") + "</t></si></sst>"),
                k.file("workbook.xml", '<?xml version="1.0" encoding="UTF-8" standalone="yes"?><workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"><fileVersion appName="xl" lastEdited="5" lowestEdited="5" rupBuild="9303"/><workbookPr defaultThemeVersion="124226"/><bookViews><workbookView ' + (e.activeWorksheet ? 'activeTab="' + e.activeWorksheet + '" ' : "") + 'xWindow="480" yWindow="60" windowWidth="18195" windowHeight="8505"/></bookViews><sheets>' + U.join("") + '</sheets><calcPr fullCalcOnLoad="1"/></workbook>'),
                o = Date.now() - o,
                i = Date.now(),
                t = {
                    base64: F.generate({
                        compression: "DEFLATE"
                    }),
                    zipTime: Date.now() - i,
                    processTime: o,
                    href: function() {
                        return "data:application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;base64," + this.base64
                    }
                }
            }
            return t
        },
        window.locale = {},
        window.NinoxPrint = o,
        window.localFileSystem = r,
        window.NinoxDocumentInteraction = n,
        window.NinoxCalendar = s,
        window.NinoxViewController = a,
        function(e, t, i, o, n, s, a) {
            e.UserlaneCommandObject = n,
            e[n] = e[n] || function() {
                (e[n].q = e[n].q || []).push(arguments)
            },
            s = t.createElement(i),
            a = t.getElementsByTagName(i)[0],
            s.async = 1,
            s.src = "https://cdn.userlane.com/userlane.js",
            a.parentNode.insertBefore(s, a)
        }(window, document, "script", 0, "Userlane"),
        function(e, t, i, o, n, s, a) {
            e.GoogleAnalyticsObject = n,
            e.ga = e.ga || function() {
                (e.ga.q = e.ga.q || []).push(arguments)
            },
            e.ga.l = 1 * new Date,
            s = t.createElement(i),
            a = t.getElementsByTagName(i)[0],
            s.async = 1,
            s.src = "https://www.google-analytics.com/analytics.js",
            a.parentNode.insertBefore(s, a)
        }(window, document, "script", 0, "ga"),
        ga("create", "UA-46256641-1", "auto");
        const d = {
            userEnvName: "web",
            alert: (e, t) => $.alert(e, t),
            loading: e => $.loading(e),
            dialog: (e, t, i, o) => {
                $.dialog({
                    caption: e,
                    message: t,
                    buttons: i,
                    zIndex: void 0
                })
            },
            openRecord: (e, t) => ui.openRecord(e, t),
            popupRecord: (e, t) => ui.popupRecord(e, t),
            openTable: (e, t, i, o) => ui.openTable(e, t, i, o),
            closeRecord: () => ui.closeRecord(),
            closeAllRecords: () => ui.closeAllRecords(),
            openFullScreen: (e, t, i) => ui.openFullscreen(e, t, i),
            closeFullScreen: () => ui.closeFullscreen(),
            openDesigner: e => {
                "undefined" != typeof reports && reports.openDesigner(e)
            },
            printTable: e => Object(c.a)(e),
            sendEmail: (e, t) => {
                database.sendEmail ? database.sendEmail(e, e => {
                    e && $.alert(e),
                    t(e ? String(e) : void 0)
                }) : t("Not supported on client side")
            },
            previewDocument: n.previewDocument.bind(n),
            barcodeScan: n.barcodeScan ? n.barcodeScan.bind(n) : e => "function" == typeof e ? e(null, "") : void 0,
            addCalendarEvent: s.addEvent2.bind(s),
            addCalendarReminder: s.addReminder2.bind(s),
            httpProvider: (e, t) => {
                $.ajax({
                    type: e.method,
                    url: e.url,
                    processData: !1,
                    data: JSON.stringify(e.body),
                    headers: e.headers,
                    xhrFields: {
                        withCredentials: !(!e.headers || !e.headers.Authorization)
                    },
                    success: function(e, i, o) {
                        t(void 0, i, e)
                    },
                    error: function(e, i, o) {
                        t("Request failed: " + i + " - " + o, i, void 0)
                    }
                })
            },
            ninoxDocumentInteraction: n,
            vault: {
                get: () => {}
            },
            parseXML: e => {
                try {
                    return (new window.DOMParser).parseFromString(e, "text/xml")
                } catch (e) {
                    return console.warn(e), ""
                }
            },
            getAppURL: () => window.location.protocol + "//" + window.location.host
        };
        (async () => {
            n.initWithNative && await n.initWithNative(),
            void 0 !== r && r.initWithNative && await r.initWithNative(),
            "undefined" != typeof cloudFileSystem && cloudFileSystem.initWithNative && await cloudFileSystem.initWithNative(),
            l.coreInit(d),
            window.ninoxCore = l,
            window.locale = l.getLocale(),
            window.LOCALE = l.getUserLanguage(),
            i("./src/init.js")
        })()
    },
    "./src/init_styles.js": function(e, t, i) {
        "use strict";
        i.r(t);
        i("./node_modules/codemirror/lib/codemirror.css"),
        i("./src/css/base.css"),
        i("./src/css/icons.css"),
        i("./src/css/iconset.css"),
        i("./src/css/database-icons.css"),
        i("./src/css/ui.css"),
        i("./src/css/navigation.css"),
        i("./src/css/widgets.css"),
        i("./src/css/calendar.css"),
        i("./src/css/charts.css"),
        i("./src/css/tables.css"),
        i("./src/css/admin.css"),
        i("./src/css/home.css"),
        i("./src/css/root_2.css"),
        i("./src/css/reports.css"),
        i("./node_modules/@zhyabs1314/react-image-lightbox/style.css"),
        i("./src/lib/jqueryui/ui-lightness/jquery-ui-1.10.4.custom.min.css"),
        i("./src/css/web.css"),
        i("./src/css/browser-not-supported-view.scss"),
        i("./src/assets/allIcons/icons-facelift.css"),
        i("./src/lib/nxwidgets/nxwidgets.css")
    },
    "./src/init_touch.js": function(e, t, i) {
        window.EVENT_touchstart = "touchstart",
        window.EVENT_touchmove = "touchmove",
        window.EVENT_touchend = "touchend",
        window.EVENT_target = function(e) {
            return e.target
        },
        "undefined" != typeof TouchEvent && (Object.defineProperty(TouchEvent.prototype, "clientX", {
            get: function() {
                return this.touches.length ? this.touches[0].clientX : this.changedTouches.length ? this.changedTouches[0].clientX : 0
            }
        }), Object.defineProperty(TouchEvent.prototype, "clientY", {
            get: function() {
                return this.touches.length ? this.touches[0].clientY : this.changedTouches.length ? this.changedTouches[0].clientY : 0
            }
        }), Object.defineProperty(TouchEvent.prototype, "pageX", {
            get: function() {
                return this.touches.length ? this.touches[0].pageX : this.changedTouches.length ? this.changedTouches[0].pageX : 0
            }
        }), Object.defineProperty(TouchEvent.prototype, "pageY", {
            get: function() {
                return this.touches.length ? this.touches[0].pageY : this.changedTouches.length ? this.changedTouches[0].pageY : 0
            }
        }))
    },
    "./src/js/admin/AdminField.js": function(e, t, i) {
        "use strict";
        i.d(t, "a", (function() {
            return C
        }));
        var o = i("./node_modules/react/index.js"),
            n = i("./node_modules/react-dom/index.js"),
            s = i("./node_modules/@babel/runtime/helpers/defineProperty.js"),
            a = i.n(s),
            r = i("./node_modules/@ninox/ninox-core/dist/ninox-core.es5.js"),
            l = i("./node_modules/react-sortable-hoc/dist/react-sortable-hoc.umd.js"),
            c = i("./node_modules/seamless-scroll-polyfill/dist/es5/seamless.js"),
            d = (i("./src/react/ChoiceEditorList.css"), i("./src/react/util/commons.ts")),
            h = i("./src/react/util/FastClickContainer.tsx"),
            p = i("./src/react/util/PositionedBackplane.tsx");
        const u = Object(l.SortableHandle)(() => o.createElement("div", {
                style: {
                    position: "relative"
                }
            }, o.createElement("div", {
                className: "i-32-24 i-lighter-grey i-drag-handle"
            }))),
            f = Object(l.SortableElement)(({id: e, children: t}) => o.createElement("div", {
                id: e
            }, t)),
            m = Object(l.SortableContainer)(({className: e, innerRef: t, children: i}) => o.createElement("div", {
                ref: t,
                className: e
            }, i));
        class g extends o.Component {
            constructor(e)
            {
                super(e),
                a()(this, "container", void 0),
                a()(this, "handleReorder", e => {
                    e.newIndex !== e.oldIndex && this.props.onReorder(e.oldIndex, e.newIndex)
                }),
                a()(this, "handleRowChange", () => {
                    "NEW_INDEX" !== this.state.selectedIndex && null !== this.state.selectedIndex && this.props.onRowChange(this.state.currentText, this.state.selectedIndex)
                }),
                a()(this, "handleCreateValue", () => {
                    this.props.onCreateValue(this.state.currentText)
                }),
                a()(this, "keydown", (e, t) => {
                    if (null !== this.state.selectedIndex)
                        switch (e.key) {
                        case "Tab":
                            "NEW_INDEX" !== this.state.selectedIndex && (e.preventDefault(), t(), this.moveToNextElement(this.state.selectedIndex));
                            break;
                        case "Enter":
                            e.preventDefault(),
                            this.setState({
                                selectedIndex: null
                            }),
                            t();
                            break;
                        case "Escape":
                            e.preventDefault(),
                            this.setState({
                                selectedIndex: null
                            });
                            break;
                        case "ArrowUp":
                            "NEW_INDEX" !== this.state.selectedIndex && (e.preventDefault(), t(), this.moveToPreviousElement(this.state.selectedIndex));
                            break;
                        case "ArrowDown":
                            "NEW_INDEX" !== this.state.selectedIndex && (e.preventDefault(), this.moveToNextElement(this.state.selectedIndex), t())
                        }
                }),
                a()(this, "handleDeleteClick", () => {
                    "NEW_INDEX" !== this.state.selectedIndex && null !== this.state.selectedIndex && this.props.onDeleteValueClick(this.props.rows[this.state.selectedIndex].id),
                    this.setState({
                        selectedIndex: null
                    })
                }),
                a()(this, "handleAddItem", e => {
                    this.setState({
                        selectedIndex: "NEW_INDEX",
                        currentText: "",
                        selectedElement: h.b.getTarget(e)
                    })
                }),
                this.state = {
                    selectedIndex: null,
                    currentText: "",
                    selectedElement: null
                },
                this.container = o.createRef()
            }
            componentDidUpdate(e)
            {
                this.props.rows.length > e.rows.length && c.elementScrollBy(this.container.current, {
                    top: this.container.current.scrollHeight,
                    behavior: "smooth"
                })
            }
            render()
            {
                return o.createElement(o.Fragment, null, o.createElement("div", {
                    className: "ChoiceEditorList_root"
                }, o.createElement(m, {
                    innerRef: this.container,
                    useDragHandle: !0,
                    axis: "y",
                    lockAxis: "y",
                    lockToContainerEdges: !0,
                    onSortEnd: this.handleReorder,
                    helperClass: "ChoiceEditorList_helperClass",
                    className: "ChoiceEditorList_listContainer"
                }, r.util.localeSortBy(this.props.rows, "order").map((e, t) => o.createElement(f, {
                    key: e.id,
                    index: t,
                    id: g.TARGET_ID + t
                }, o.createElement(h.a, {
                    onFastClick: i => {
                        const o = h.b.getTarget(i);
                        this.setState({
                            selectedIndex: t,
                            currentText: e.caption,
                            selectedElement: o.closest("#" + g.TARGET_ID + t)
                        })
                    },
                    className: "choiceeditor-item"
                }, o.createElement(h.a, {
                    onFastClick: t => {
                        this.props.onColorClick(t, e)
                    },
                    className: "choiceeditor-item-color ",
                    style: {
                        background: e.color ? e.color : void 0,
                        color: e.textColor ? e.textColor : void 0
                    }
                }), o.createElement(h.a, {
                    onFastClick: t => this.props.onIconClick(t, e),
                    className: "choiceeditor-item-icon " + (e.icon ? "ic ic-" + e.icon : "")
                }), o.createElement("div", {
                    className: "choiceeditor-item-label"
                }, e.caption || ""), o.createElement("div", {
                    className: "choiceeditor-item-id"
                }, e.id), o.createElement(u, null))))), this.newValBackplane(), o.createElement("div", {
                    className: "ChoiceEditorList_buttonContainer",
                    style: {
                        padding: 4
                    }
                }, o.createElement(h.a, {
                    className: "ChoiceEditorList_addButton button text blue float-left",
                    onFastClick: this.handleAddItem,
                    style: {
                        margin: 0,
                        width: this.props.rows.length > 1 ? "" : "100%",
                        textAlign: "center"
                    }
                }, o.createElement("div", {
                    className: "icon-big-white icon-big-add"
                }), o.createElement("span", null, Object(r.getLocale)().choiceAddValue)))), this.props.rows.length > 1 ? o.createElement("div", {
                    className: "ChoiceEditorList_sortButtonContainer"
                }, o.createElement(h.a, {
                    className: "button",
                    onFastClick: this.props.onSortAscClick
                }, o.createElement("div", {
                    className: "icon-big-black icon-big-sort-asc"
                })), o.createElement(h.a, {
                    className: "button",
                    onFastClick: this.props.onSortDescClick
                }, o.createElement("div", {
                    className: "icon-big-black icon-big-sort-desc"
                }))) : null)
            }
            resetState()
            {
                this.setState({
                    selectedIndex: null,
                    currentText: ""
                })
            }
            newValBackplane()
            {
                return o.createElement(p.a, {
                    show: null !== this.state.selectedIndex,
                    clickTarget: this.state.selectedElement,
                    settings: "NEW_INDEX" === this.state.selectedIndex ? {
                        style: "tooltip",
                        arrowColor: "white"
                    } : {
                        style: "overlay"
                    },
                    className: "ChoiceEditorList_editContainer",
                    onClick: () => {
                        "NEW_INDEX" === this.state.selectedIndex ? "" !== this.state.currentText && this.props.onCreateValue(this.state.currentText) : this.handleRowChange(),
                        this.resetState()
                    }
                }, "NEW_INDEX" !== this.state.selectedIndex ? this.editRow(this.handleRowChange) : this.editRow(this.handleCreateValue))
            }
            moveToNextElement(e)
            {
                const t = e + 1;
                t < this.props.rows.length && this.setState(e => {
                    const i = null === e.selectedElement ? null : Object(d.c)(e.selectedElement, g.TARGET_ID + t);
                    return this.scrollToSibling(i), {
                        selectedIndex: t,
                        currentText: this.props.rows[t].caption,
                        selectedElement: i
                    }
                })
            }
            moveToPreviousElement(e)
            {
                const t = e - 1;
                t >= 0 && this.setState(e => {
                    const i = null === e.selectedElement ? null : Object(d.d)(e.selectedElement, g.TARGET_ID + t);
                    return this.scrollToSibling(i), {
                        selectedIndex: t,
                        currentText: this.props.rows[t].caption,
                        selectedElement: i
                    }
                })
            }
            scrollToSibling(e)
            {
                null !== e && c.elementScrollIntoView(e, {
                    block: "nearest",
                    behavior: "auto"
                })
            }
            editRow(e)
            {
                return o.createElement("div", {
                    className: "ChoiceEditorList_inputContainer " + ("NEW_INDEX" === this.state.selectedIndex ? "ChoiceEditorList_inputContainerNewRow" : "")
                }, o.createElement("input", {
                    className: "ChoiceEditorList_input",
                    tabIndex: 0,
                    onKeyDown: t => this.keydown(t, e),
                    type: "text",
                    value: this.state.currentText,
                    autoFocus: !0,
                    onChange: e => {
                        this.setState({
                            currentText: e.target.value
                        })
                    }
                }), o.createElement(h.a, {
                    className: "ChoiceEditorList_trashIcon i-32-24 i-grey i-setting-trash",
                    onFastClick: this.handleDeleteClick
                }))
            }
        }
        a()(g, "TARGET_ID", "ChoiceEditorList_backplaneTarget");
        i("./node_modules/underscore/underscore.js");
        var v = i("./src/js/widgets/editors/ColorSelector.js"),
            b = i("./src/js/widgets/editors/IconSelector.js");
        function y(e, t, i) {
            this.field = t,
            $('<label class="choiceeditor-values-label">').text(locale.choiceValues).appendTo(i),
            this.$values = $('<div class="choiceeditor-values">').appendTo(i),
            this.updateUI()
        }
        y.prototype.resizeHeight = function(e) {
            this.$values.css("height", e - 72)
        },
        y.prototype.destroy = function() {},
        y.prototype.updateUI = function() {
            const e = util.sortBy(this.field.getValues(), "order");
            n.render(o.createElement(g, {
                rows: e,
                onCreateValue: e => {
                    this.field.createValue().caption = e,
                    this.changed()
                },
                onDeleteValueClick: e => this.confirmRemove(e),
                onRowChange: (t, i) => {
                    const o = e[i];
                    t !== o.caption && (o.caption = t, this.changed())
                },
                onIconClick: (e, t) => this.pickIcon(e, t),
                onColorClick: (e, t) => this.pickColor(e, t),
                onReorder: (e, t) => this.sorted(e, t),
                onSortAscClick: () => this.sortAsc(),
                onSortDescClick: () => this.sortDesc()
            }), this.$values[0])
        },
        y.prototype.confirmRemove = function(e) {
            $.dialog({
                closable: !0,
                caption: locale.remove,
                message: locale.confirmRemoveChoiceValue,
                buttons: [{
                    color: "red",
                    caption: locale.remove,
                    callback: () => this.remove(e)
                }]
            })
        },
        y.prototype.remove = function(e) {
            delete this.field.values[e],
            this.field.trigger("change"),
            this.field.schema.trigger("change"),
            this.updateUI()
        },
        y.prototype.pickColor = function(e, t) {
            new v.a({
                $el: $(h.b.getTarget(e)),
                value: t.color,
                update: e => {
                    t.color = e,
                    this.changed()
                }
            })
        },
        y.prototype.pickIcon = function(e, t) {
            new b.a({
                $el: $(h.b.getTarget(e)),
                value: t.icon,
                update: e => {
                    t.icon = e,
                    this.changed()
                }
            })
        },
        y.prototype.changed = function() {
            this.field.trigger("change"),
            this.field.schema.trigger("change"),
            this.updateUI()
        },
        y.prototype.sorted = function(e, t) {
            const i = util.sortBy(this.field.getValues(), "order"),
                o = i[t].order;
            if (t > e)
                for (let o = t - 1; o >= e; o--)
                    i[o + 1].order = i[o].order;
            else if (e > t)
                for (let o = t + 1; o <= e; o++)
                    i[o - 1].order = i[o].order;
            i[e].order = o,
            this.field.trigger("change"),
            this.field.schema.trigger("change"),
            this.updateUI()
        },
        y.prototype.sortAsc = function() {
            for (var e = util.localeSortBy(this.field.values, "caption"), t = 0; t < e.length; t++)
                e[t].order = t;
            this.field.trigger("change"),
            this.field.schema.trigger("change"),
            this.updateUI()
        },
        y.prototype.sortDesc = function() {
            for (var e = util.localeSortBy(this.field.values, "caption"), t = 0; t < e.length; t++)
                e[t].order = e.length - 1 - t;
            this.field.trigger("change"),
            this.field.schema.trigger("change"),
            this.updateUI()
        };
        var w = i("./src/js/admin/ViewEditor.js"),
            x = i("./src/js/widgets/Field.js");
        let T = !1;
        class C {
            constructor(e, t, i)
            {
                var o = this;
                this.field = t,
                this.components = [],
                this.$backplane = $.backplane({
                    close: $.proxy(this.destroy, this),
                    scrollable: !0
                });
                var n,
                    s,
                    a = "choice" === t.base || "multi" === t.base,
                    r = $('<div class="fieldeditor fieldeditor-' + (a ? "choice" : t.base) + '">').appendTo(this.$backplane).draggable({
                        handle: ".head"
                    }),
                    l = $('<div class="head">').mousedown(() => l.css("background-color", "rgba(199, 199, 199, 0.6)")).mouseup(() => l.css("background-color", "transparent")).appendTo(r);
                if (a) {
                    o.$paneContainer = $('<div class="Field_paneContainer">').appendTo(r);
                    const e = window.getHeight() - 200;
                    n = $('<div class="pane" style="overflow:auto;max-height: ' + (e - 16) + 'px">').appendTo(o.$paneContainer),
                    s = $('<div class="pane2 component editor choiceeditor" style="padding-bottom: 32px; display: flex;display: -webkit-flex; flex-direction: column; -webkit-flex-direction: column; height:' + e + 'px">').appendTo(o.$paneContainer)
                } else
                    n = $('<div class="pane">').appendTo(r);
                var c,
                    d = $('<div class="buttons">').appendTo(r);
                let h,
                    p,
                    u,
                    f;
                $('<div class="nx-button-text red">').text(locale.removeField).appendTo(d).touch((function() {
                    t.isUI ? (t.type.schema.removeUI(t), o.$backplane.close((function() {
                        o.destroy()
                    }))) : $.dialog({
                        closable: !0,
                        caption: locale.removeField,
                        message: locale.removeFieldConfirm,
                        buttons: [{
                            color: "red",
                            caption: locale.remove,
                            callback: function() {
                                t.type.schema.removeField(t),
                                o.$backplane.close((function() {
                                    o.destroy()
                                }))
                            }
                        }]
                    })
                })),
                (t.isReverse || t.isReference) && ($('<div class="nx-hspace-small">').appendTo(d), $('<div class="nx-button-text grey">').text(locale.editColumns).appendTo(d).touch((function() {
                    new w.a({
                        config: {
                            type: t.refType.id,
                            cols: t.viewConfig.cols || [],
                            sort: t.viewConfig.sort,
                            descending: t.viewConfig.descending,
                            group: t.viewConfig.group
                        },
                        save: function(e) {
                            var i = e.config;
                            t.viewConfig.cols = i.cols,
                            t.viewConfig.sort = i.sort,
                            t.viewConfig.descending = i.descending,
                            t.viewConfig.group = i.group,
                            t.cachedViewConfig && (t.cachedViewConfig = void 0),
                            t.type.schema.trigger("change")
                        }
                    })
                }))),
                "view" !== t.base && "chart" !== t.base || ($('<div class="nx-hspace-small">').appendTo(d), $('<div class="nx-button-text grey">').text(locale.editColumns).appendTo(d).touch((function() {
                    var e = t.exp && t.exp.returnType;
                    return e ? ("nid" !== e.base && "rid" !== e.base || (e = e.type), e.isNodeType ? t.exp.isMultiple() ? void new w.a({
                        config: {
                            type: e,
                            cols: t.viewConfig.cols || [],
                            sort: t.viewConfig.sort,
                            descending: t.viewConfig.descending,
                            group: t.viewConfig.group
                        },
                        save: function(e) {
                            var i = e.config;
                            t.viewConfig.cols = i.cols,
                            t.viewConfig.sort = i.sort,
                            t.viewConfig.descending = i.descending,
                            t.viewConfig.group = i.group,
                            t.type.schema.trigger("change")
                        }
                    }) : $.alert("Expression does not return multiple records.") : $.alert("Expression does not return records.")) : $.alert("Please define a valid function.")
                }))),
                $('<div class="nx-hspace-flex">').appendTo(d),
                $('<div class="nx-button-text blue">').text(locale.okay).appendTo(d).touch($.proxy(this.close, this)),
                c = "ref" === t.base ? locale.referenceLabelFrom + " " + t.type.caption + " " + locale.referenceLabelTo + " " + t.refType.caption + " " + locale.referenceLabelN1 : "rev" === t.base ? locale.referenceLabelFrom + " " + t.type.caption + " " + locale.referenceLabelTo + " " + t.refType.caption + " " + locale.referenceLabel1N : locale.types[t.base],
                l.append($('<div class="type-symbol-grey i-32-24 i-light-grey i-field-' + t.base + '">')).append($("<span>").text(c)),
                l.append($('<div class="i-32-24 i-lighter-grey i-drag-handle" style="cursor: move;position: absolute;top:21px;left:22px;">')),
                t.getCaptionModel && (this.caption = this.createField(t.getCaptionModel(), n)),
                t.getLabelPositionModel && this.createField(t.getLabelPositionModel(), n),
                t.getFunctionModel && this.createField(t.getFunctionModel(), n),
                t.getStyleModel && this.createField(t.getStyleModel(), n),
                t.getBGColorModel && this.createField(t.getBGColorModel(), n),
                t.getButtonColorModel && this.createField(t.getButtonColorModel(), n),
                (t.isField && "fn" !== t.base || t.isReference) && this.createField(t.getRequiredModel(), n),
                t.getStringDefaultModel && this.createField(t.getStringDefaultModel(), n),
                t.getStringMinLengthModel && this.createField(t.getStringMinLengthModel(), n),
                t.getStringMaxLengthModel && this.createField(t.getStringMaxLengthModel(), n),
                t.getNumberDefaultModel && this.createField(t.getNumberDefaultModel(), n),
                t.getNumberMinModel && this.createField(t.getNumberMinModel(), n),
                t.getNumberMaxModel && this.createField(t.getNumberMaxModel(), n),
                t.getNumberFormatModel && this.createField(t.getNumberFormatModel(), n),
                t.getTimeFormatModel && this.createField(t.getTimeFormatModel(), n),
                t.getDateDefaultModel && this.createField(t.getDateDefaultModel(), n),
                t.getDateCalendarModel && ($("<div>").appendTo(n), this.createField(t.getDateCalendarModel(), n)),
                t.getDateCalendarColorModel && this.createField(t.getDateCalendarColorModel(), n),
                t.getDateCalendarFormatModel && this.createField(t.getDateCalendarFormatModel(), n),
                t.getDateYearlyModel && this.createField(t.getDateYearlyModel(), n),
                t.getTimestampDefaultModel && this.createField(t.getTimestampDefaultModel(), n),
                t.getTimeDefaultModel && this.createField(t.getTimeDefaultModel(), n),
                t.getTimeintervalDefaultModel && this.createField(t.getTimeintervalDefaultModel(), n),
                t.getTimeintervalFormatModel && this.createField(t.getTimeintervalFormatModel(), n),
                t.getBooleanDefaultModel && this.createField(t.getBooleanDefaultModel(), n),
                t.getBooleanRendererModel && this.createField(t.getBooleanRendererModel(), n),
                t.getChoiceDefaultModel && this.createField(t.getChoiceDefaultModel(), n),
                t.getChoiceRendererModel && this.createField(t.getChoiceRendererModel(), n),
                t.getMultiDefaultModel && this.createField(t.getMultiDefaultModel(), n),
                t.getMultiRendererModel && this.createField(t.getMultiRendererModel(), n),
                a && this.components.push(new y(this, t, s)),
                "email" === t.base && (this.createField(t.getEmailDefaultModel(), n), this.createField(t.getEmailSubjectModel(), n), this.createField(t.getEmailBodyModel(), n)),
                t.getHtmlDefaultModel && this.createField(t.getHtmlDefaultModel(), n),
                t.getFileHandlingModel && this.createField(t.getFileHandlingModel(), n),
                t.getBGSizeModel && this.createField(t.getBGSizeModel(), n),
                t.isReference && this.createField(t.getCascadeModel(), n),
                t.getReferenceRendererModel && this.createField(t.getReferenceRendererModel(), n),
                t.getReverseRendererModel && this.createField(t.getReverseRendererModel(), n),
                "chart" === t.base && (this.createField(t.getChartTypeModel(), n), this.createField(t.getChartDatasetsModel(), n), this.createField(t.getChartStackedModel(), n), this.createField(t.getChartLineTensionModel(), n), this.createField(t.getChartLegendModel(), n)),
                t.getDChoiceValuesModel && (h = this.createField(t.getDChoiceValuesModel(), n), h.model.on("update", () => {})),
                t.getDChoiceCaptionModel && (p = this.createField(t.getDChoiceCaptionModel(), n)),
                t.getDChoiceColorModel && (u = this.createField(t.getDChoiceColorModel(), n)),
                t.getDChoiceIconModel && (f = this.createField(t.getDChoiceIconModel(), n));
                var m = $('<div class="button block" style="margin:8px">').appendTo(n),
                    g = $("<div>").hide().appendTo(n),
                    v = $('<div class="i-32-24 i-light-grey i-line-right">').appendTo(m);
                $("<span>").text(locale.showExtendedOptions).appendTo(m),
                m.touch(() => {
                    T = !T,
                    v.toggleClass("i-line-right i-line-down"),
                    g.toggle()
                }),
                T && (v.toggleClass("i-line-right i-line-down"), g.show()),
                t.getTooltipModel && this.createField(t.getTooltipModel(), g),
                t.getOnClickModel && this.createField(t.getOnClickModel(), g),
                t.getReferenceFormatModel && this.createField(t.getReferenceFormatModel(), g),
                t.getVisibilityModel && this.createField(t.getVisibilityModel(), g),
                (t.isReference || t.isField) && ("fn" !== t.base && this.createField(t.getAfterUpdateModel(), g), t.isReference && this.createField(t.getConstraintModel(), g), database.supports.authentication && (this.readRoles = new x.a(this, t.getReadRolesModel(), g), "fn" !== t.base && this.createField(t.getWriteRolesModel(), g)), t.getCanWriteModel && "fn" !== t.base && this.createField(t.getCanWriteModel(), g)),
                database.supports.authentication && t.isReverse && (this.createField(t.reference.getReadRolesModel(), g), this.createField(t.reference.getWriteRolesModel(), g)),
                t.isReverse && t.reference.getCanWriteModel && this.createField(t.reference.getCanWriteModel(), g),
                t.getGlobalSearchModel && this.createField(t.getGlobalSearchModel(), g),
                database.supports.indexes && t.getHasIndexModel && this.createField(t.getHasIndexModel(), g),
                t.getBindingModel && this.createField(t.getBindingModel(), g),
                t.getBeforeShowModel && this.createField(t.getBeforeShowModel(), g),
                t.getAfterHideModel && this.createField(t.getAfterHideModel(), g),
                i && this.caption && setTimeout((function() {
                    o.caption.focus()
                }), 400)
            }
            createField(e, t)
            {
                const i = new x.a(this, e, t);
                return this.components.push(i), i
            }
            destroy()
            {
                for (const e of this.components)
                    e.destroy()
            }
            close()
            {
                var e = this;
                e.$backplane.close((function() {
                    e.destroy()
                }))
            }
        }
    },
    "./src/js/admin/FunctionEditor.js": function(e, t, i) {
        "use strict";
        i.d(t, "b", (function() {
            return a
        })),
        i.d(t, "a", (function() {
            return r
        }));
        i("./node_modules/core-js/modules/es.string.replace.js");
        var o = i("./node_modules/underscore/underscore.js"),
            n = i("./src/react/util/Track.ts");
        const s = !TOUCH;
        function a() {
            s && CodeMirror.defineSimpleMode("nx", {
                start: [{
                    regex: /"(?:[^"]|"")*?"/,
                    token: "string"
                }, {
                    regex: /(function)(\s+)([a-z$][\w$]*)/,
                    token: ["keyword", null, "variable-2"]
                }, {
                    regex: /(?:true|false|null|void|and|or|not|like|select|create|delete|from|where|order|group|by|in|as|of|for|while|if|then|else|end|switch|case|default|do|each|let|this|record)\b/,
                    token: "keyword"
                }, {
                    regex: /true|false|null/,
                    token: "atom"
                }, {
                    regex: /0x[a-f\d]+|[-+]?(?:\.\d+|\d+\.?\d*)(?:e[-+]?\d+)?/i,
                    token: "number"
                }, {
                    regex: /\/\/.*/,
                    token: "comment"
                }, {
                    regex: /\/(?:[^\\]|\\.)*?\//,
                    token: "variable-3"
                }, {
                    regex: /\/\*/,
                    token: "comment",
                    next: "comment"
                }, {
                    regex: /[-+\/*=<>!]+/,
                    token: "operator"
                }, {
                    regex: /[\{\[\(]/,
                    indent: !0
                }, {
                    regex: /[\}\]\)]/,
                    dedent: !0
                }, {
                    regex: /[a-z$][\w$]*/,
                    token: "variable"
                }, {
                    regex: /<</,
                    token: "meta",
                    mode: {
                        spec: "xml",
                        end: />>/
                    }
                }],
                comment: [{
                    regex: /.*?\*\//,
                    token: "comment",
                    next: "start"
                }, {
                    regex: /.*/,
                    token: "comment"
                }],
                meta: {
                    dontIndentStates: ["comment"],
                    lineComment: "//"
                }
            })
        }
        function r(e) {
            this.value = e.value || "",
            this.isHuman = !!e.isHuman,
            this.schema = e.schema,
            this.type = e.type,
            this.variables = e.variables || {},
            this.supportsCommands = e.supportsCommands || !1,
            this.ownerField = e.ownerField,
            this.okay = e.okay,
            this.cancel = e.cancel,
            this.$backplane = $.backplane({
                closable: !1,
                cls: "opaq"
            }),
            "text" === NinoxDocumentInteraction.getUserDefault("ui.functionEditorMode") ? this.openTextEditor() : this.openVisualEditor()
        }
        r.prototype.openVisualEditor = function() {
            NinoxDocumentInteraction.setUserDefault("ui.functionEditorMode", "visual");
            var e = this,
                t = this.schema,
                i = this.type,
                s = this.variables,
                a = this.supportsCommands,
                r = this.ownerField,
                l = {
                    block: ";",
                    add: "+",
                    sub: "&minus;",
                    mul: "&ast;",
                    div: "/",
                    mod: "%",
                    and: locale.op_and,
                    or: locale.op_or,
                    not: locale.op_not,
                    true: locale.op_true,
                    false: locale.op_false,
                    if: locale.op_if,
                    eq: "=    ",
                    ne: "&ne;",
                    gt: "&gt;",
                    lt: "&lt;",
                    ge: "&ge;",
                    le: "&le;",
                    like: locale.op_like,
                    round: locale.op_round,
                    ceil: locale.op_ceil,
                    floor: locale.op_floor,
                    sqrt: "&radic;",
                    sqr: "&sup2;",
                    sign: locale.op_sign,
                    abs: locale.op_abs,
                    sin: "sin",
                    cos: "cos",
                    tan: "tan",
                    asin: "asin",
                    acos: "acos",
                    atan: "atan",
                    atan2: "atan&sup2;",
                    pow: " ^ ",
                    exp: "e ^ ",
                    log: "log<sub>10<sub>",
                    ln: "ln",
                    year: locale.op_year,
                    day: locale.op_day,
                    month: locale.op_month,
                    weekday: locale.op_weekday,
                    age: locale.op_age,
                    format: locale.op_format,
                    today: locale.op_today,
                    now: locale.op_now,
                    yearmonth: locale.op_yearmonth,
                    yearquater: locale.op_yearquater,
                    yearquarter: locale.op_yearquater,
                    start: locale.op_start,
                    endof: locale.op_end,
                    duration: locale.op_duration,
                    text: locale.op_text,
                    trim: locale.op_trim,
                    lower: locale.op_lower,
                    upper: locale.op_upper,
                    lpad: locale.op_lpad,
                    rpad: locale.op_rpad,
                    substr: locale.op_substr,
                    contains: locale.op_contains,
                    index: locale.op_index,
                    date: locale.op_date,
                    number: locale.op_number,
                    yearweek: locale.op_yearweek,
                    week: locale.op_week,
                    days: locale.op_days,
                    workdays: locale.op_workdays
                },
                c = {
                    helper: "clone",
                    opacity: .7,
                    scroll: !1,
                    appendTo: $(document.body),
                    zIndex: 1e3
                },
                d = {
                    helper: "clone",
                    opacity: .7,
                    appendTo: $(document.body),
                    zIndex: 1e3
                },
                h = {
                    accept: ".fn-op, .fn-exp",
                    hoverClass: "drop-hover",
                    greedy: !0,
                    tolerance: "pointer",
                    drop: function(e, t) {
                        var i = $(e.target),
                            o = t.draggable;
                        o.is(".fn-op") ? function(e, t) {
                            var i = e.children();
                            if (i.length > 1)
                                return;
                            0 === i.length && (i = void 0);
                            var o = function(e, t) {
                                var i = e.data("op"),
                                    o = $('<div class="fn-exp fn-exp-op-' + i + '">').data("op", i).draggable(d);
                                switch (i) {
                                case "assign":
                                    var n = e.data("field");
                                    return o.data("field", n), $('<div class="fn-exp-label">').text(n.caption + " :=").appendTo(o), $('<div class="fn-exp-param fn-exp-param0">').droppable(h).appendTo(o).append(t || P()), o;
                                case "if":
                                    return $('<div class="fn-exp-label">').text(locale.op_if_if).appendTo(o), $('<div class="fn-exp-param fn-exp-param0">').droppable(h).appendTo(o).append(t || P()), $('<div class="fn-exp-label">').text(locale.op_if_then).appendTo(o), $('<div class="fn-exp-param fn-exp-param1">').droppable(h).appendTo(o).append(P()), $('<div class="fn-exp-label">').text(locale.op_if_else).appendTo(o), $('<div class="fn-exp-param fn-exp-param2">').droppable(h).appendTo(o).append(P()), o;
                                case "block":
                                    return $('<div class="fn-exp-param fn-exp-param0">').droppable(h).appendTo(o).append(t || P()), $('<div class="fn-exp-label">').html(";<br>").appendTo(o), $('<div class="fn-exp-param fn-exp-param0">').droppable(h).appendTo(o).append(P()), o;
                                case "add":
                                case "sub":
                                case "mul":
                                case "div":
                                case "mod":
                                case "and":
                                case "or":
                                case "eq":
                                case "ne":
                                case "lt":
                                case "le":
                                case "gt":
                                case "ge":
                                case "like":
                                    return $('<div class="fn-exp-param fn-exp-param0">').droppable(h).appendTo(o).append(t || P()), $('<div class="fn-exp-label">').html(l[i] || i).appendTo(o), $('<div class="fn-exp-param fn-exp-param1">').droppable(h).appendTo(o).append(P()), o;
                                case "not":
                                    return $('<div class="fn-exp-label">').html(l[i] || i).appendTo(o), $('<div class="fn-exp-param fn-exp-param0">').droppable(h).appendTo(o).append(t || P()), o;
                                case "true":
                                case "false":
                                    if (t)
                                        return;
                                    return $('<div class="fn-exp-label">').html(l[i] || i).appendTo(o), o;
                                case "fn":
                                    var s = e.data("fn");
                                    switch (o.data("fn", s), s.fn) {
                                    case "sqr":
                                        $('<div class="fn-exp-param fn-exp-param0">').droppable(h).appendTo(o).append(t || P()),
                                        $('<div class="fn-exp-label">').html(l.sqr).appendTo(o);
                                        break;
                                    default:
                                        $('<div class="fn-exp-label">').html(l[s.fn] || s.fn).appendTo(o),
                                        s.params > 0 && $('<div class="fn-exp-param fn-exp-param0">').droppable(h).appendTo(o).append(t || P());
                                        for (var a = 1; a < s.params; a++)
                                            $('<div class="fn-exp-param fn-exp-param' + a + '">').droppable(h).appendTo(o).append(P())
                                    }
                                    return o;
                                case "number":
                                    if (t)
                                        return;
                                    return $('<div class="fn-exp-value">').text("1234").appendTo(o).click(U), o;
                                case "string":
                                    if (t)
                                        return;
                                    return $('<div class="fn-exp-value">').text(locale.op_string).appendTo(o).click(z), o;
                                case "exp":
                                    if (t)
                                        return;
                                    var r = e.data("exp");
                                    return o.data("exp", r).append($('<div class="fn-exp-label">').text(r.toHumanString(0))), o
                                }
                            }(t, i);
                            o && o.appendTo(e);
                            V()
                        }(i, o) : o.is(".fn-exp") && function(e, t) {
                            0 === e.children().length && t.appendTo(e);
                            V()
                        }(i, o);
                        V()
                    }
                },
                p = {
                    accept: ".fn-exp",
                    tolerance: "pointer",
                    drop: function(e, t) {
                        t.draggable.remove(),
                        setTimeout(V, 0)
                    }
                },
                u = this.$backplane,
                f = $('<div class="tab-selected-indicator">'),
                m = $('<div class="fn-function">').appendTo(u),
                g = $('<div class="fn-tabs">').appendTo(u),
                v = $('<div class="fn-operators">').appendTo(u),
                b = $("<div>").appendTo(v),
                y = $('<div class="fn-controls">').appendTo(u),
                w = $('<div class="fn-error-container">').hide().appendTo(u);
            $('<div class="i-32-12 i-red i-warning">').appendTo(w);
            var x = $("<div>").appendTo(w);
            $('<div class="nx-button-text grey">').text(locale.cancel).appendTo(y).touch((function() {
                Object(n.f)("Formula", "Cancel"),
                Y(),
                e.cancel && e.cancel()
            })),
            $('<div class="nx-hspace-flex">').appendTo(y);
            var T,
                C,
                k = $('<div class="fn-mode">').appendTo(y);
            $('<div class="button option first selected">').text(locale.modeVisual).appendTo(k),
            $('<div class="button option last">').text(locale.modeText).appendTo(k).click((function() {
                Object(n.f)("Formula", "Text");
                var t = V();
                !1 !== t && (e.value = t ? t.toString() : "", u.droppable("destroy"), u.empty(), e.openTextEditor())
            }));
            $('<div class="nx-hspace-flex">').appendTo(y),
            $('<div class="nx-button-text blue">').text(locale.okay).appendTo(y).touch((function() {
                Object(n.f)("Formula", "Confirm");
                var t = V();
                if (!1 !== t) {
                    if (t && t.isUpdating() && !a)
                        return $.alert(locale.updateExpressionNotAllowed);
                    var i = t ? t.toString() : "";
                    e.value = i,
                    Y(),
                    e.okay && e.okay(i, t)
                }
            })),
            u.droppable(p),
            m.droppable(h),
            a && (T = $('<div class="fn-operators-pane">').hide().appendTo(b), C = $('<div class="tab">').text(locale.commands).appendTo(g).data("pane", T).click(j), i && o.each(i.sorted, (function(e) {
                e.isField && "fn" !== e.base && $('<div class="fn-op fn-op-assign">').text(e.caption + " :=").data("op", "assign").data("field", e).draggable(c).appendTo(T)
            })), $("<br>").appendTo(T), $('<div class="fn-op fn-op-block">').html(l.block).data("op", "block").draggable(c).appendTo(T));
            var S = $('<div class="fn-operators-pane">').hide().appendTo(b),
                E = $('<div class="tab">').text(locale.fields).appendTo(g).data("pane", S).click(j),
                _ = $('<div class="fn-nav">').appendTo(S),
                D = $('<div class="fn-fields">').appendTo(S),
                M = [{
                    type: i,
                    variables: s
                }],
                N = $('<div class="fn-operators-pane">').hide().appendTo(b);
            $('<div class="fn-op fn-op-bin fn-op-bin-add">').html(l.add).data("op", "add").draggable(c).appendTo(N),
            $('<div class="fn-op fn-op-bin fn-op-bin-sub">').html(l.sub).data("op", "sub").draggable(c).appendTo(N),
            $('<div class="fn-op fn-op-bin fn-op-bin-mul">').html(l.mul).data("op", "mul").draggable(c).appendTo(N),
            $('<div class="fn-op fn-op-bin fn-op-bin-div">').html(l.div).data("op", "div").draggable(c).appendTo(N),
            $('<div class="fn-op fn-op-bin fn-op-bin-mod">').html(l.mod).data("op", "mod").draggable(c).appendTo(N),
            $('<div class="fn-op fn-op-const fn-op-const-number">').html("1234").data("op", "number").draggable(c).appendTo(N),
            $("<br>").appendTo(N),
            o.each([{
                fn: "number",
                params: 1
            }, {
                fn: "sqrt",
                params: 1
            }, {
                fn: "sqr",
                params: 1
            }, {
                fn: "pow",
                params: 2
            }, {
                fn: "exp",
                params: 1
            }, {
                fn: "log",
                params: 1
            }, {
                fn: "ln",
                params: 1
            }, {
                fn: "sin",
                params: 1
            }, {
                fn: "cos",
                params: 1
            }, {
                fn: "tan",
                params: 1
            }, {
                fn: "asin",
                params: 1
            }, {
                fn: "acos",
                params: 1
            }, {
                fn: "atan",
                params: 1
            }, {
                fn: "atan2",
                params: 1
            }, {
                fn: "round",
                params: 1
            }, {
                fn: "ceil",
                params: 1
            }, {
                fn: "floor",
                params: 1
            }, {
                fn: "sign",
                params: 1
            }, {
                fn: "abs",
                params: 1
            }], (function(e) {
                $('<div class="fn-op fn-op-fn">').html(l[e.fn]).data("op", "fn").data("fn", e).draggable(c).appendTo(N)
            }));
            $('<div class="tab">').text(locale.calculate).appendTo(g).data("pane", N).click(j);
            var I = $('<div class="fn-operators-pane">').hide().appendTo(b);
            $('<div class="fn-op fn-op-if">').html(l.if).data("op", "if").draggable(c).appendTo(I),
            $('<div class="fn-op fn-op-bin fn-op-bin-and">').html(l.and).data("op", "and").draggable(c).appendTo(I),
            $('<div class="fn-op fn-op-bin fn-op-bin-or">').html(l.or).data("op", "or").draggable(c).appendTo(I),
            $('<div class="fn-op fn-op-un fn-op-un-not">').html(l.not).data("op", "not").draggable(c).appendTo(I),
            $('<div class="fn-op fn-op-const fn-op-const-true">').html(l.true).data("op", "true").draggable(c).appendTo(I),
            $('<div class="fn-op fn-op-const fn-op-const-false">').html(l.false).data("op", "false").draggable(c).appendTo(I),
            $("<br>").appendTo(I),
            o.each(["eq", "ne", "lt", "le", "ge", "gt", "like"], (function(e) {
                $('<div class="fn-op fn-op-cmp fn-op-cmp-' + e + '">').html(l[e]).data("op", e).draggable(c).appendTo(I)
            }));
            $('<div class="tab">').text(locale.logic).appendTo(g).data("pane", I).click(j);
            var O = $('<div class="fn-operators-pane">').hide().appendTo(b);
            $('<div class="fn-op fn-op-const fn-op-const-string">').html(locale.op_string).data("op", "string").draggable(c).appendTo(O),
            o.each([{
                fn: "text",
                params: 1
            }, {
                fn: "trim",
                params: 1
            }, {
                fn: "lower",
                params: 1
            }, {
                fn: "upper",
                params: 1
            }, {
                fn: "lpad",
                params: 3
            }, {
                fn: "rpad",
                params: 3
            }, {
                fn: "substr",
                params: 3
            }, {
                fn: "contains",
                params: 2
            }, {
                fn: "index",
                params: 2
            }], (function(e) {
                $('<div class="fn-op fn-op-fn">').html(l[e.fn]).data("op", "fn").data("fn", e).draggable(c).appendTo(O)
            })),
            $("<br>").appendTo(O),
            o.each([{
                fn: "year",
                params: 1
            }, {
                fn: "day",
                params: 1
            }, {
                fn: "month",
                params: 1
            }, {
                fn: "weekday",
                params: 1
            }, {
                fn: "week",
                params: 1
            }, {
                fn: "yearmonth",
                params: 1
            }, {
                fn: "yearquarter",
                params: 1
            }, {
                fn: "yearweek",
                params: 1
            }, {
                fn: "start",
                params: 1
            }, {
                fn: "endof",
                params: 1
            }, {
                fn: "duration",
                params: 1
            }, {
                fn: "days",
                params: 2
            }, {
                fn: "workdays",
                params: 2
            }, {
                fn: "age",
                params: 1
            }, {
                fn: "today",
                params: 0
            }, {
                fn: "now",
                params: 0
            }, {
                fn: "date",
                params: 3
            }, {
                fn: "format",
                params: 2
            }], (function(e) {
                $('<div class="fn-op fn-op-fn">').html(l[e.fn]).data("op", "fn").data("fn", e).draggable(c).appendTo(O)
            }));
            var R;
            $('<div class="tab">').text(locale.textAndDate).appendTo(g).data("pane", O).click(j);
            function j(e) {
                R && (R.data("pane").hide(), R.removeClass("selected"), f.detach()),
                (R = $(this)).data("pane").show(),
                R.addClass("selected"),
                f.appendTo(R)
            }
            j.call(C || E),
            A();
            try {
                if (this.value) {
                    var L = this.isHuman ? queries.parseHuman(t, i, this.value, s) : queries.parseSystem(t, i, this.value, s);
                    m.append(function e(t) {
                        if (!t)
                            return;
                        var i,
                            o,
                            n,
                            s,
                            a,
                            r,
                            c,
                            p,
                            u = $('<div class="fn-exp">').draggable(d);
                        switch (t.base) {
                        case "assign":
                            o = "assign",
                            u.data("field", t.field),
                            s = e(t.exp) || P(),
                            $('<div class="fn-exp-label">').text(t.field.caption + " :=").appendTo(u),
                            $('<div class="fn-exp-param fn-exp-param0">').droppable(h).appendTo(u).append(s);
                            break;
                        case "block":
                            for (o = "block", i = 0; i < t.exps.length; i++)
                                n = t.exps[i],
                                s = e(n) || P(),
                                $('<div class="fn-exp-param fn-exp-param0">').droppable(h).appendTo(u).append(s),
                                $('<div class="fn-exp-label">').html(";<br>").appendTo(u);
                            break;
                        case "bin":
                            if (!(o = {
                                "+": "add",
                                "-": "sub",
                                "*": "mul",
                                "/": "div",
                                "%": "mod"
                            }[t.binop.op]))
                                throw new Error("Unknown operator " + t.op);
                            s = e(t.exprA) || P(),
                            a = e(t.exprB) || P(),
                            $('<div class="fn-exp-param fn-exp-param0">').droppable(h).appendTo(u).append(s),
                            $('<div class="fn-exp-label">').html(l[o] || o).appendTo(u),
                            $('<div class="fn-exp-param fn-exp-param1">').droppable(h).appendTo(u).append(a);
                            break;
                        case "comp":
                            if (!(o = {
                                "=": "eq",
                                "!=": "ne",
                                "<": "lt",
                                ">": "gt",
                                "<=": "le",
                                ">=": "ge",
                                like: "like"
                            }[t.cmp]))
                                throw new Error("Unknown comparator " + t.cmp);
                            s = e(t.exprA) || P(),
                            a = e(t.exprB) || P(),
                            $('<div class="fn-exp-param fn-exp-param0">').droppable(h).appendTo(u).append(s),
                            $('<div class="fn-exp-label">').html(l[o] || o).appendTo(u),
                            $('<div class="fn-exp-param fn-exp-param1">').droppable(h).appendTo(u).append(a);
                            break;
                        case "and":
                            o = "and",
                            s = e(t.exprA) || P(),
                            a = e(t.exprB) || P(),
                            $('<div class="fn-exp-param fn-exp-param0">').droppable(h).appendTo(u).append(s),
                            $('<div class="fn-exp-label">').html(l[o] || o).appendTo(u),
                            $('<div class="fn-exp-param fn-exp-param1">').droppable(h).appendTo(u).append(a);
                            break;
                        case "or":
                            o = "or",
                            s = e(t.exprA) || P(),
                            a = e(t.exprB) || P(),
                            $('<div class="fn-exp-param fn-exp-param0">').droppable(h).appendTo(u).append(s),
                            $('<div class="fn-exp-label">').html(l[o] || o).appendTo(u),
                            $('<div class="fn-exp-param fn-exp-param1">').droppable(h).appendTo(u).append(a);
                            break;
                        case "not":
                            o = "not",
                            s = e(t.expr) || P(),
                            $('<div class="fn-exp-label">').html(l[o] || o).appendTo(u),
                            $('<div class="fn-exp-param fn-exp-param0">').droppable(h).appendTo(u).append(s);
                            break;
                        case "const":
                            !0 === (c = t.value) ? (o = "true", $('<div class="fn-exp-label">').html(l[o] || o).appendTo(u)) : !1 === c ? (o = "false", $('<div class="fn-exp-label">').html(l[o] || o).appendTo(u)) : "string" == typeof c ? (o = "string", $('<div class="fn-exp-value">').text(c).appendTo(u).click(z)) : "number" == typeof c ? (o = "number", $('<div class="fn-exp-value">').text(c).appendTo(u).click(U)) : (o = "exp", u.data("exp", t), $('<div class="fn-exp-label">').text(t.caption).appendTo(u));
                            break;
                        case "apply":
                            for (o = "fn", p = t.functor.id, u.data("fn", {
                                fn: p,
                                params: t.functor.argTypes.length
                            }), $('<div class="fn-exp-label">').html(l[p] || p).appendTo(u), i = 0; i < t.exprs.length; i++)
                                s = e(t.exprs[i]) || P(),
                                $('<div class="fn-exp-param fn-exp-param0">').droppable(h).appendTo(u).append(s);
                            break;
                        case "if":
                            o = "if",
                            s = e(t.exprIf) || P(),
                            a = e(t.exprThen) || P(),
                            r = e(t.exprElse) || P(),
                            $('<div class="fn-exp-label">').text(locale.op_if_if).appendTo(u),
                            $('<div class="fn-exp-param fn-exp-param0">').droppable(h).appendTo(u).append(s),
                            $('<div class="fn-exp-label">').text(locale.op_if_then).appendTo(u),
                            $('<div class="fn-exp-param fn-exp-param1">').droppable(h).appendTo(u).append(a),
                            $('<div class="fn-exp-label">').text(locale.op_if_else).appendTo(u),
                            $('<div class="fn-exp-param fn-exp-param2">').droppable(h).appendTo(u).append(r);
                            break;
                        default:
                            o = "exp",
                            u.data("exp", t),
                            $('<div class="fn-exp-label">').text(t.toHumanString().replace(/\s+/g, " ")).appendTo(u)
                        }
                        return u.addClass("fn-exp-op-" + o), u.data("op", o), u
                    }(L))
                }
                V()
            } catch (e) {
                W(e)
            }
            function F(e) {
                if (e.length) {
                    for (var t = e[0], i = t.isVariable ? new queries.Parameter(t.id, t.returnType, !0 === t.isMultiple) : "fn" === t.base ? new queries.Eval(t.type, t) : new queries.Get(t.type, t), o = 1; o < e.length; o++) {
                        var n = e[o],
                            s = n.isVariable ? new queries.Parameter(n.id, t.returnType, !0 === n.isMultiple) : "fn" === n.base ? new queries.Eval(n.type, n) : new queries.Get(n.type, n);
                        i = new queries.Follow(i, s)
                    }
                    return i
                }
            }
            function A() {
                D.empty(),
                _.empty();
                var e = !1,
                    t = [];
                o.each(M, (function(i, o) {
                    i.field ? (i.field.isReverse && (e = !0), t.push(i.field)) : i.variable && t.push(i.variable),
                    i.type ? $('<div class="fn-nav-item">').append($(`<div class="type-symbol i-32-24 ${o === M.length - 1 ? "i-light-grey" : "i-blue"} i-field-${i.field ? i.field.base : "list"}">`)).append($('<div class="type-label">').text(i.field ? i.field.caption : i.type.caption)).appendTo(_).touch((function() {
                        M = M.slice(0, o + 1),
                        A()
                    })) : $('<div class="fn-nav-item">').append($('<div class="i-32-24 i-light-grey i-arrow-solid-right">')).appendTo(_).touch((function() {
                        M = M.slice(0, o + 1),
                        A()
                    }))
                }));
                var i = M[M.length - 1],
                    n = i.field,
                    s = i.type,
                    a = i.variables;
                a && o.each(a, (function(e) {
                    $('<div class="fn-op fn-op-exp fn-op-more">').append($('<div class="type-symbol type-symbol-list">')).append($('<div class="type-label">').text(e.caption)).data("variable", e).touch(H).appendTo(D)
                })),
                s ? o.each([s.field_id].concat(s.sorted), (function(i) {
                    try {
                        if (i !== r)
                            if (i.isField)
                                if (e)
                                    $('<div class="fn-op fn-op-exp fn-op-more">').append($('<div class="type-symbol i-32-24 i-blue i-field-' + i.base + '">')).append($('<div class="type-label">').text(i.caption)).data("field", i).touch(H).appendTo(D);
                                else {
                                    var o = F(t.concat([i]));
                                    $('<div class="fn-op fn-op-exp">').append($('<div class="type-symbol i-32-24 i-light-grey i-field-' + o.returnType.base + '">')).append($('<div class="type-label">').text(i.caption)).data("op", "exp").data("exp", o).draggable(c).appendTo(D)
                                }
                            else
                                i.isReference ? $('<div class="fn-op fn-op-exp fn-op-more">').append($('<div class="type-symbol i-32-24 i-blue i-field-ref">')).append($('<div class="type-label">').text(i.caption)).data("field", i).touch(H).appendTo(D) : i.isReverse && $('<div class="fn-op fn-op-exp fn-op-more">').append($('<div class="type-symbol i-32-24 i-blue i-field-rev">')).append($('<div class="type-label">').text(i.caption)).data("field", i).touch(H).appendTo(D)
                    } catch (e) {
                        console.log(e)
                    }
                })) : n && e && o.each(n.aggregations, (function(e) {
                    var i = F(t);
                    i && (i = new queries.Agg(queries.AGGS[e], [i]), $('<div class="fn-op fn-op-exp">').append($('<div class="symbol symbol-' + e + '">')).append($('<div class="type-label">').text(n.caption)).data("op", "exp").data("exp", i).draggable(c).appendTo(D))
                }))
            }
            function H(e) {
                var t = $(this),
                    i = t.data("field"),
                    o = t.data("variable");
                if (i) {
                    if (i.isField)
                        M.push({
                            field: i
                        });
                    else if (i.isReference || i.isReverse) {
                        var n = i.refType;
                        if (!n)
                            return;
                        M.push({
                            type: n,
                            field: i
                        })
                    }
                } else
                    o && M.push({
                        type: o.returnType,
                        variable: o
                    });
                A()
            }
            function P() {}
            function U() {
                var e = $(this),
                    t = e.text();
                e.empty();
                var i = $('<input type="number" class="fn-exp-input fn-exp-input-number">').val(t).css("width", Math.max(10 * t.length, 50)).appendTo(e).focus().blur((function() {
                    t = i.val(),
                    i.remove(),
                    e.text(t),
                    V()
                }))
            }
            function z() {
                var e = $(this),
                    t = e.text();
                e.empty();
                var i = $('<input type="text" class="fn-exp-input fn-exp-input-string">').val(t).css("width", Math.max(10 * t.length, 50)).appendTo(e).focus().blur((function() {
                    t = i.val(),
                    i.remove(),
                    e.text(t),
                    V()
                }))
            }
            function V() {
                m.find(".error").removeClass("error");
                try {
                    var e = q(),
                        o = e ? e.toString() : "",
                        n = o ? queries.parseSystem(t, i, o, s) : void 0;
                    return W(void 0), n
                } catch (e) {
                    return W(e), !1
                }
            }
            function W(e) {
                if (e) {
                    e.$exp && e.$exp.addClass("error");
                    var t = (e.message ? e.message : String(e)) || locale.fnUnknowError;
                    w.show(),
                    x.text(t)
                } else
                    w.hide(),
                    x.empty()
            }
            function B(e, t, i) {
                var o = e.children(".fn-exp-param")[t];
                if (!o)
                    throw new Error("Parameter dom node not found " + t);
                var n = o.childNodes;
                if (0 === n.length) {
                    if (i)
                        return;
                    throw {
                        message: locale.fnMissingParameter,
                        $exp: e
                    }
                }
                if (n.length > 1)
                    throw {
                        message: locale.fnInvalidParameter,
                        $exp: e
                    };
                if ($(n[0]).is(".exp-param-placeholder")) {
                    if (i)
                        return;
                    throw {
                        message: locale.fnMissingParameter,
                        $exp: e
                    }
                }
                return q($(n[0]))
            }
            function q(e) {
                if (!e) {
                    if (0 === (e = m.children()).length)
                        return;
                    if (e.length > 1)
                        throw {
                            message: locale.fnInvalidExpression
                        }
                }
                var t,
                    i,
                    o,
                    n,
                    s,
                    a,
                    r,
                    l,
                    c,
                    d,
                    h,
                    p,
                    u,
                    f,
                    g = e.data("op");
                switch (g) {
                case "assign":
                    i = e.data("field"),
                    o = B(e, 0);
                    try {
                        return new queries.Assign(i, o)
                    } catch (t) {
                        throw {
                            message: String(t),
                            $exp: e
                        }
                    }
                    break;
                case "block":
                    for (r = e.children(".fn-exp-param"), a = [], t = 0; t < r.length; t++)
                        o = B(e, t),
                        a.push(o);
                    try {
                        return new queries.Block(a)
                    } catch (t) {
                        throw {
                            message: String(t),
                            $exp: e
                        }
                    }
                    break;
                case "exp":
                    return e.data("exp");
                case "add":
                case "sub":
                case "mul":
                case "div":
                case "mod":
                    if (!(l = {
                        add: "+",
                        sub: "-",
                        mul: "*",
                        div: "/",
                        mod: "%"
                    }[g]))
                        throw {
                            message: locale.fnInvalidOperator + ' "' + g + '"',
                            $exp: e
                        };
                    if (o = B(e, 0), n = B(e, 1), !(c = queries.getBinOp(o, l, n)))
                        throw {
                            message: locale.fnInvalidOperator + ' "' + g + '"',
                            $exp: e
                        };
                    try {
                        return new queries.Bin(o, c, n)
                    } catch (t) {
                        throw {
                            message: String(t),
                            $exp: e
                        }
                    }
                    break;
                case "and":
                    o = B(e, 0),
                    n = B(e, 1);
                    try {
                        return new queries.And(o, n)
                    } catch (t) {
                        throw {
                            message: String(t),
                            $exp: e
                        }
                    }
                    break;
                case "or":
                    o = B(e, 0),
                    n = B(e, 1);
                    try {
                        return new queries.Or(o, n)
                    } catch (t) {
                        throw {
                            message: String(t),
                            $exp: e
                        }
                    }
                    break;
                case "not":
                    o = B(e, 0);
                    try {
                        return new queries.Not(o)
                    } catch (t) {
                        throw {
                            message: String(t),
                            $exp: e
                        }
                    }
                    break;
                case "eq":
                case "ne":
                case "lt":
                case "le":
                case "gt":
                case "ge":
                case "like":
                    if (!(d = {
                        eq: "=",
                        ne: "!=",
                        lt: "<",
                        le: "<=",
                        gt: ">",
                        ge: ">=",
                        like: "like"
                    }[g]))
                        throw {
                            message: locale.fnInvalidComparator + ' "' + g + '"',
                            $exp: e
                        };
                    o = B(e, 0),
                    n = B(e, 1);
                    try {
                        return new queries.Comp(o, d, n)
                    } catch (t) {
                        throw {
                            message: String(t),
                            $exp: e
                        }
                    }
                    break;
                case "fn":
                    for (h = e.data("fn"), a = [], t = 0; t < h.params; t++)
                        a.push(B(e, t));
                    if (!(p = queries.getFunctor(h.fn, a)))
                        throw {
                            message: locale.fnUndefinedFunction,
                            $exp: e
                        };
                    try {
                        return new queries.ApplyFunction(p, a)
                    } catch (t) {
                        throw {
                            message: String(t),
                            $exp: e
                        }
                    }
                    break;
                case "if":
                    o = B(e, 0),
                    n = B(e, 1),
                    s = B(e, 2, !0);
                    try {
                        return new queries.If(o, n, s)
                    } catch (t) {
                        throw {
                            message: String(t),
                            $exp: e
                        }
                    }
                    break;
                case "true":
                    try {
                        return new queries.Const(!0)
                    } catch (t) {
                        throw {
                            message: String(t),
                            $exp: e
                        }
                    }
                    break;
                case "false":
                    try {
                        return new queries.Const(!1)
                    } catch (t) {
                        throw {
                            message: String(t),
                            $exp: e
                        }
                    }
                    break;
                case "string":
                    u = e.find(".fn-exp-value").first().text() || "";
                    try {
                        return new queries.Const(u)
                    } catch (t) {
                        throw {
                            message: String(t),
                            $exp: e
                        }
                    }
                    break;
                case "number":
                    if (u = e.find(".fn-exp-value").first().text(), f = Number(u), isNaN(f))
                        throw {
                            message: locale.fnInvalidNumber + ' "' + u + '"',
                            $exp: e
                        };
                    try {
                        return new queries.Const(f)
                    } catch (t) {
                        throw {
                            message: String(t),
                            $exp: e
                        }
                    }
                }
            }
            function Y() {
                u.close()
            }
        },
        r.prototype.openTextEditor = function() {
            NinoxDocumentInteraction.setUserDefault("ui.functionEditorMode", "text");
            var e = this,
                t = this.type,
                i = this.schema,
                a = this.variables,
                r = this.supportsCommands,
                l = {},
                c = this.$backplane,
                d = $('<div class="fn-controls">').appendTo(c),
                h = $('<div class="fn-error-container">').hide().appendTo(c);
            $('<div class="i-32-12 i-red i-warning">').appendTo(h);
            var p = $("<div>").appendTo(h),
                u = $('<div class="fn-suggestions">').appendTo(c),
                f = $('<div class="fn-tools">').appendTo(c).touch((function(e) {
                    var t = $(e.target),
                        i = t.closest(".fn-tools-field").attr("data-id");
                    i && (t.is(".fn-tools-field-expand") ? (l[i] = !l[i], C()) : s ? (y.replaceSelection(i), x()) : (v.replaceSelectedText(i), x()), TOUCH && !s && v.focus())
                }));
            TOUCH || f.on("mousedown", (function(e) {
                e.preventDefault()
            })),
            $('<div class="nx-button-text grey">').text(locale.cancel).appendTo(d).touch((function() {
                Object(n.f)("Formula", "Cancel"),
                k(),
                e.cancel && e.cancel()
            })),
            $('<div class="nx-hspace-flex">').appendTo(d);
            var m = $('<div class="fn-mode">').appendTo(d);
            $('<div class="button option first">').text(locale.modeVisual).appendTo(m).click((function() {
                Object(n.f)("Formula", "Visual");
                var t = T();
                !1 !== t && (e.value = t ? t.toString() : "", c.empty(), e.openVisualEditor())
            })),
            $('<div class="button option last selected">').text(locale.modeText).appendTo(m);
            $('<div class="nx-hspace-flex">').appendTo(d),
            $('<div class="nx-button-text blue">').text(locale.okay).appendTo(d).touch((function(t) {
                Object(n.f)("Formula", "Confirm");
                var i = T();
                if (!1 !== i) {
                    if (t.shiftKey && console.log(i.getSyncJS()), i && i.isUpdating() && !r)
                        return $.alert(locale.updateExpressionNotAllowed);
                    var o = i ? i.toString() : "";
                    k(),
                    e.okay && e.okay(o, i)
                }
            }));
            var g = $('<div class="fn-textpane">').appendTo(c),
                v = $('<textarea class="fn-textarea no-barcode" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">').appendTo(g),
                b = $('<div style="position:absolute;right:0;bottom:0;z-index:1;height:20px;line-height:20px;width:60px;padding:0 4px 0 0;font-size:12px;text-align:right;cursor:default;background-color:rgba(255,255,255,.5);color:#555">').appendTo(g),
                y = null;
            if (s ? ((y = CodeMirror.fromTextArea(v[0], {
                lineNumbers: !0,
                mode: "nx",
                indentUnit: 4,
                tabSize: 4,
                smartIndent: !0,
                indentWithTabs: !0,
                electricChars: !0,
                lineWrapping: !0
            })).on("changes", x), y.on("cursorActivity", (function() {
                var e = y.getCursor();
                b.text(e.line + 1 + " / " + e.ch)
            }))) : v.on("keyup change", x), this.value)
                try {
                    var w = this.isHuman ? queries.parseHuman(i, t, this.value, a) : queries.parseSystem(i, t, this.value, a);
                    w && (s ? y.setValue(w.toHumanString()) : v.val(w.toHumanString()), w.errors && w.errors.length && (h.show(), p.text(w.errors[0].message)))
                } catch (e) {
                    h.show(),
                    p.text(e)
                }
            function x() {
                T()
            }
            function T() {
                u.empty();
                var e = "";
                if (e = s ? y.getValue() : v.val(), !/^\s*$/.test(e))
                    try {
                        var n = queries.parseHuman(i, t, e, a);
                        return n && n.errors && n.errors.length ? (h.show(), p.text(n.errors[0].message), r(n.errors[0]), !1) : (h.hide(), p.text(""), n)
                    } catch (e) {
                        return h.show(), p.text(e), r(e), !1
                    }
                function r(t) {
                    t.suggestions && o.each(t.suggestions, (function(i) {
                        $('<div class="fn-suggestion">').text(i).appendTo(u).on(TOUCH ? EVENT_touchstart : "mousedown", (function() {
                            var o = e.substr(0, t.index),
                                n = e.substr(t.index + t.length);
                            if (e = o + i + n, s) {
                                var a = y.getCursor();
                                y.setValue(e),
                                a && y.setCursor({
                                    line: a.line,
                                    ch: a.ch + i.length
                                })
                            } else
                                v.val(e);
                            return setTimeout(x, 0), !1
                        }))
                    }))
                }
            }
            function C() {
                var e = "";
                function i(t, n) {
                    o.each(t.sorted, (function(t) {
                        var o = n.concat(util.escapeId(t.caption)),
                            s = o.join(".");
                        if (t.isField || t.isReference || t.isReverse) {
                            var a = t.isReference || t.isReverse,
                                r = a && l[s];
                            e += '<div class="fn-tools-field" data-id="' + s + '"><div class="fn-tools-field-icon i-32-24 i-light-grey i-field-' + t.base + '"></div><div class="fn-tools-field-label">' + htmlEscape(t.caption) + "</div>" + (a ? '<div class="fn-tools-field-expand i-32-16 i-grey i-line-up ' + (r ? "expanded" : "collapsed") + '"></div>' : "") + "</div>",
                            r && (e += '<div class="fn-tools-list">', i(t.refType, o), e += "</div>")
                        }
                    }))
                }
                a && a && o.each(a, (function(t) {
                    var o = t.id,
                        n = [o],
                        s = l[o];
                    e += '<div class="fn-tools-field" data-id="' + o + '"><div class="fn-tools-field-label">' + htmlEscape(o + " (" + t.caption + ")") + '</div><div class="fn-tools-field-expand i-32-16 i-grey i-line-down ' + (s ? "expanded" : "collapsed") + '"></div></div>',
                    s && (e += '<div class="fn-tools-list">', i(t.returnType, n), e += "</div>")
                })),
                t && i(t, []),
                f.html(e)
            }
            function k() {
                c.close()
            }
            T(),
            C()
        }
    },
    "./src/js/admin/ViewEditor.js": function(e, t, i) {
        "use strict";
        i.d(t, "a", (function() {
            return s
        }));
        var o = i("./src/js/widgets/Field.js"),
            n = i("./node_modules/underscore/underscore.js");
        function s(e) {
            var t = e.config,
                i = t.cols,
                s = t.type;
            if ("string" == typeof s && (s = database.schema.types[s]), s) {
                var a = s.schema,
                    r = {},
                    l = void 0 !== t.sort ? i[t.sort] : void 0,
                    c = void 0 !== t.sort ? i[t.group] : void 0,
                    d = t.descending,
                    h = !1,
                    p = $.backplane({
                        enter: function(e) {
                            e.preventDefault(),
                            N()
                        }
                    }),
                    u = $('<div class="popupeditor nx-menu-popup vieweditor">').appendTo(p),
                    f = e.hasTop,
                    m = database.supports.authentication;
                if (f) {
                    var g = $('<div class="vieweditor-top">').appendTo(u),
                        v = new util.SimpleModel(new schemas.TString(void 0, void 0, {
                            caption: locale.enterViewName,
                            width: m ? 3 : 4
                        }));
                    v.value = e.caption;
                    var b = new o.a(void 0, v, g);
                    if (m) {
                        var y = new util.SimpleModel(new schemas.TRoles(void 0, void 0, {
                            caption: locale.readRoles,
                            width: 1
                        }));
                        y.value = e.readRoles;
                        var w = new o.a(void 0, y, g)
                    }
                }
                var x = $('<div class="vieweditor-left ' + (f ? "vieweditor-hastop " : "") + 'accordion">').appendTo(u),
                    T = $('<div class="vieweditor-right ' + (f ? "vieweditor-hastop " : "") + 'accordion">').appendTo(u);
                I(),
                $(window).on("resize", I),
                $('<div class="accordion-head">').text(locale.visibleColumns).appendTo(x),
                $('<div class="accordion-head">').text(locale.availableColumns).appendTo(T);
                var C = $('<div class="vieweditor-bottom">').appendTo(u);
                $('<div class="nx-button-bar">').appendTo(C).append($('<div class="nx-button-text grey">').text(locale.cancel).touch(O)).append($('<div class="nx-hspace-flex">')).append($('<div class="nx-button-text blue">').text(locale.okay).touch(N));
                var k = $('<div class="accordion-pane vieweditor-columns">').appendTo(x).mouseup((function(e) {
                        if (h)
                            return;
                        var t = $(e.target).closest(".t-columneditor-column"),
                            n = t.data("col");
                        if (!n)
                            return;
                        var r = $.backplane({
                                close: function() {
                                    t.removeClass("selected"),
                                    _()
                                }
                            }),
                            p = $('<div class="popupeditor nx-menu-popup grey width-4col" style="border-radius:4px">').appendTo(r);
                        (function e() {
                            p.empty();
                            var h = new schemas.ExpressionModel(n, "expression", void 0, s, locale.function);
                            h.on("change", (function() {
                                setTimeout(e, 0)
                            }));
                            var u = void 0;
                            if (n.expression)
                                try {
                                    u = queries.parseSystem(a, s, n.expression, {})
                                } catch (e) {
                                    console.warn(e, e.stack)
                                }
                            t.addClass("selected");
                            var f = $('<div class="component editor editor-string editor-4col">').appendTo(p);
                            $("<label>").text(locale.caption).appendTo(f);
                            var m = $('<input type="text">').appendTo($('<div class="stringeditor">').appendTo(f)).attr("placeholder", u ? u.caption : "").val(n.caption).change((function() {
                                n.caption = m.val() || void 0,
                                D()
                            }));
                            if (new o.a(void 0, h, p), u) {
                                var g = $('<div class="component editor editor-4col">').appendTo(p);
                                $("<label>").text(locale.filter).appendTo(g);
                                var v = tables.createFilterEditor({
                                    updateFilter: function() {
                                        n.filter = v.getFilter(),
                                        D()
                                    }
                                }, g, u.returnType, n.filter);
                                v || g.hide()
                            }
                            var b = $('<div class="component editor editor-4col">').appendTo(p);
                            $("<label>").text(locale.sort).appendTo(b);
                            var y = $('<div class="choiceswitch">').appendTo(b);
                            const w = $('<span class="i-32-16 i-light-grey i-line-up-thick"></span>'),
                                x = $('<div class="choiceswitch-item"></div>').appendTo(y).touch((function() {
                                    l = l !== n || d ? n : void 0,
                                    d = !1,
                                    O(),
                                    D()
                                }));
                            x.append(w),
                            x.append("<span>" + locale.sortAscending + "</span>");
                            const T = $('<span class="i-32-16 i-light-grey i-line-down-thick"></span>'),
                                C = $('<div class="choiceswitch-item">').appendTo(y).touch((function() {
                                    l === n && d ? (l = void 0, d = !1) : (l = n, d = !0),
                                    O(),
                                    D()
                                }));
                            C.append(T),
                            C.append("<span>" + locale.sortDescending + "</span></div>");
                            const k = $('<div class="component editor editor-4col">').appendTo(p);
                            $("<label>").text(locale.grouping).appendTo(k);
                            const S = $("<div>").appendTo(k),
                                E = $('<div class="booleancheck-box"></div>'),
                                _ = $('<div class="booleancheck"></div>').appendTo(S).touch((function() {
                                    c = c === n ? void 0 : n,
                                    O(),
                                    D()
                                }));
                            _.append(E),
                            _.append('<div class="booleancheck-text">' + locale.grouped + "</div>");
                            var N = $('<div class="component editor editor-4col">').appendTo(p);
                            $("<label>").text(locale.aggregation).appendTo(N);
                            var I = $("<div>").appendTo(N);
                            function O() {
                                x.removeClass("selected"),
                                w.removeClass("i-white"),
                                w.addClass("i-light-grey"),
                                C.removeClass("selected"),
                                T.removeClass("i-white"),
                                T.addClass("i-light-grey"),
                                E.attr("class", "booleancheck-box"),
                                l === n && (d ? (T.removeClass("i-light-grey"), T.addClass("i-white"), C.addClass("selected")) : (w.removeClass("i-light-grey"), w.addClass("i-white"), x.addClass("selected"))),
                                c === n && E.attr("class", "booleancheck-box selected i-16-12 i-white i-check")
                            }
                            !function e() {
                                I.empty();
                                let t = I;
                                if (u) {
                                    const i = u.returnType.aggregations.length,
                                        o = i > 4 ? Math.ceil(i / 2) : 4;
                                    for (let s = 0; s < i; s++) {
                                        s % o == 0 && (t = $('<div class="choiceswitch">'), I.append(t));
                                        const i = u.returnType.aggregations[s],
                                            a = $('<span style="margin-right: 4px;">' + ({
                                                sum: "Σ",
                                                first: "⤒",
                                                last: "⤓",
                                                avg: "Ø",
                                                cnt: "#",
                                                min: "⬇",
                                                max: "⬆",
                                                concat: "&middot;&middot;&middot;"
                                            }[i] || "") + "</span>"),
                                            r = $('<div class="choiceswitch-item">').appendTo(t).append(a).append($("<span>").text(locale.agg[i])).touch((function() {
                                                n.agg === i ? n.agg = void 0 : n.agg = i,
                                                D(),
                                                e()
                                            }));
                                        i === n.agg ? (r.addClass("selected"), a.addClass("white")) : a.removeClass("white")
                                    }
                                    i > 4 && (I.children().first().addClass("first"), I.children().last().addClass("last"))
                                }
                            }(),
                            $('<div class="nx-button-bar">').appendTo(p).append($('<div class="nx-button-text grey">').text(locale.hideColumn).touch((function() {
                                r.close(),
                                i.splice(i.indexOf(n), 1),
                                D(),
                                M()
                            }))).append($('<div class="nx-hspace-flex">')).append($('<div class="nx-button-text blue">').text(locale.okay).touch((function() {
                                r.close()
                            }))),
                            O()
                        })(),
                        p.center()
                    })),
                    S = $('<div class="accordion-pane vieweditor-columns">').appendTo(T);
                k.sortable({
                    start: function() {
                        h = !0
                    },
                    stop: function(e) {
                        h = !1
                    },
                    beforeStop: function() {},
                    receive: function(e, t) {
                        var o = t.item;
                        if (!o)
                            return;
                        var n = E,
                            s = o.data("col");
                        if (!s)
                            return;
                        var a = Object.assign({}, s);
                        i.splice(n, 0, a),
                        console.log("A"),
                        t.item.draggable("cancel"),
                        console.log("B"),
                        k.sortable("cancel"),
                        console.log("C"),
                        _()
                    },
                    remove: function(e, t) {},
                    sort: function(e, t) {
                        E = t.placeholder.index()
                    },
                    update: function() {
                        i = [],
                        n.each(k.children(), (function(e) {
                            var t = $(e).data("col");
                            t ? i.push(t) : alert("col no data")
                        }))
                    },
                    axis: "y",
                    handle: TOUCH ? ".t-columneditor-icon, .t-columneditor-label" : void 0
                }),
                _();
                var E = -1
            }
            function _() {
                D(),
                M()
            }
            function D() {
                k.empty();
                var e = 0;
                r = {};
                for (var t = 0; t < i.length; t++) {
                    var o = i[t],
                        n = o.expression,
                        h = null;
                    if (n) {
                        try {
                            h = queries.parseSystem(a, s, n, {})
                        } catch (e) {
                            console.warn(e, e.stack);
                            continue
                        }
                        r[n] = o
                    }
                    var p = $('<div class="t-columneditor-column">').data("col", o).appendTo(k);
                    $('<div class="t-columneditor-icon i-32-24 i-light-grey">').addClass("i-field-" + (h ? h.returnType.base : "fn")).appendTo(p),
                    $('<div class="t-columneditor-label">').text(o.caption || (h ? h.caption : locale.unnamed)).appendTo(p),
                    l === o && (d ? $('<div class="t-columneditor-icon i-24-12 i-light-grey i-line-down-thick">').appendTo(p) : $('<div class="t-columneditor-icon i-24-12 i-light-grey i-line-up-thick">').appendTo(p)),
                    c === o && $('<div class="t-columneditor-icon i-24-16 i-light-grey i-table-group">').appendTo(p),
                    o.filter && $('<div class="t-columneditor-icon i-24-16 i-light-grey i-setting-filter">').appendTo(p),
                    o.agg && $('<div class="t-columneditor-icon symbol symbol-' + o.agg + '">').appendTo(p),
                    e++
                }
                0 === e && k.text(locale.dragColumnsHereToDefineView)
            }
            function M() {
                var e = {
                    connectToSortable: k,
                    helper: "clone",
                    handle: TOUCH ? ".t-columneditor-icon, .t-columneditor-label" : void 0,
                    appendTo: $(document.body),
                    zIndex: 11
                };
                S.empty(),
                $('<div class="t-columneditor-column">').data("col", {
                    expression: "",
                    caption: locale.function
                }).appendTo(S).draggable(e).append($('<div class="t-columneditor-label i-32-24 i-light-grey">').addClass("i-field-fn")).append($('<div class="t-columneditor-label">').text(locale.function)),
                r._id || $('<div class="t-columneditor-column">').data("col", {
                    expression: "_id"
                }).appendTo(S).draggable(e).append($('<div class="t-columneditor-label i-32-24 i-light-grey">').addClass("i-field-string")).append($('<div class="t-columneditor-label">').text(locale.id));
                s.sorted;
                n.each(s.sorted, (function(t) {
                    if (t.isField) {
                        var i = t.id;
                        if (!r[i]) {
                            var o = {
                                expression: i
                            };
                            $('<div class="t-columneditor-column">').data("col", o).appendTo(S).draggable(e).append($('<div class="t-columneditor-label i-32-24 i-light-grey ">').addClass("i-field-" + t.base)).append($('<div class="t-columneditor-label">').text(t.caption))
                        }
                    }
                    if (t.isReference) {
                        var s = $('<div class="t-columneditor-icon i-32-24 i-light-grey i-line-right">'),
                            a = $('<div class="t-columneditor-head">').append(s).append($('<div class="t-columneditor-label">').text(t.caption + " (" + t.refType.caption + ")")).appendTo(S).click(),
                            l = $('<div class="t-columneditor-group">').appendTo(S).hide(),
                            c = t.refType;
                        !function() {
                            var i = c.field_id,
                                o = t.id + "." + i.id;
                            if (!r[o]) {
                                var n = {
                                        expression: o
                                    },
                                    s = $('<div class="t-columneditor-column">').data("col", n).appendTo(l).draggable(e);
                                $('<div class="t-columneditor-label i-32-24 i-light-grey ">').addClass("i-field-" + i.base).appendTo(s),
                                $('<div class="t-columneditor-label">').text(i.caption).appendTo(s)
                            }
                        }(),
                        n.each(c.sorted, (function(i) {
                            if (i.isField) {
                                var o = t.id + "." + i.id;
                                if (!r[o]) {
                                    var n = {
                                            expression: o
                                        },
                                        s = $('<div class="t-columneditor-column">').data("col", n).appendTo(l).draggable(e);
                                    $('<div class="t-columneditor-label  i-32-24 i-light-grey">').addClass("i-field-" + i.base).appendTo(s),
                                    $('<div class="t-columneditor-label">').text(i.caption).appendTo(s)
                                }
                            }
                        })),
                        a.touch((function() {
                            l.toggle(),
                            a.toggleClass("expanded"),
                            s.toggleClass("i-line-right i-line-down")
                        }))
                    } else if (t.isReverse) {
                        s = $('<div class="t-columneditor-icon i-32-24 i-light-grey i-line-right">'),
                        a = $('<div class="t-columneditor-head">').append(s).append($('<div class="t-columneditor-label">').text(t.caption + " (" + t.refType.caption + ")")).appendTo(S),
                        l = $('<div class="t-columneditor-group">').appendTo(S).hide(),
                        c = t.refType;
                        n.each(c.sorted, (function(i) {
                            if (i.isField) {
                                var o = $('<div class="t-columneditor-icon i-32-24 i-light-grey i-line-right">'),
                                    s = $('<div class="t-columneditor-head">').append(o).append($('<div class="t-columneditor-label">').text(i.caption)).appendTo(l),
                                    a = $('<div class="t-columneditor-group">').appendTo(l).hide();
                                n.each(i.aggregations, (function(o) {
                                    var n = o + "(" + t.id + "." + i.id + ")";
                                    if (!r[n]) {
                                        var s = {
                                                expression: n
                                            },
                                            l = $('<div class="t-columneditor-column">').data("col", s).appendTo(a).draggable(e),
                                            c = aggregations.aggType(o, i);
                                        $('<div class="t-columneditor-icon i-32-24 i-light-grey">').addClass("i-field-" + c.base).appendTo(l),
                                        $('<div class="t-columneditor-label">').text(locale.agg[o]).appendTo(l)
                                    }
                                })),
                                s.touch((function() {
                                    a.toggle(),
                                    s.toggleClass("expanded"),
                                    o.toggleClass("i-line-right i-line-down")
                                }))
                            }
                        })),
                        a.touch((function() {
                            l.toggle(),
                            a.toggleClass("expanded"),
                            s.toggleClass("i-line-right i-line-down")
                        }))
                    }
                })),
                database.supports.history && (r._md || $('<div class="t-columneditor-column">').data("col", {
                    expression: "_md"
                }).appendTo(S).draggable(e).append($('<div class="t-columneditor-label i-32-24 i-light-grey">').addClass("i-field-timestamp")).append($('<div class="t-columneditor-label">').text(locale.modifiedDate))),
                database.supports.authentication && (r._mu || $('<div class="t-columneditor-column">').data("col", {
                    expression: "_mu"
                }).appendTo(S).draggable(e).append($('<div class="t-columneditor-label i-32-24 i-light-grey">').addClass("i-field-user")).append($('<div class="t-columneditor-label">').text(locale.modifiedUser)), r._cu || $('<div class="t-columneditor-column">').data("col", {
                    expression: "_cu"
                }).appendTo(S).draggable(e).append($('<div class="t-columneditor-label i-32-24 i-light-grey">').addClass("i-field-user")).append($('<div class="t-columneditor-label">').text(locale.createdUser)))
            }
            function N() {
                O();
                var i = [],
                    o = 0,
                    s = 0,
                    a = void 0;
                n.each(k.children(), (function(e) {
                    var t = $(e).data("col");
                    t && (t === l && (s = o), t === c && (a = o), i.push(t), o++)
                })),
                t.cols = i,
                t.sort = s,
                t.descending = d,
                t.group = a,
                e.save({
                    config: t,
                    caption: f ? v.value : void 0,
                    readRoles: f && m ? y.value : void 0
                })
            }
            function I() {
                window.getWidth() < 640 ? (u.css({
                    left: 0,
                    marginLeft: 0
                }), x.css({
                    left: "3%",
                    width: "45%"
                }), T.css({
                    left: "52%",
                    width: "45%"
                })) : (u.css({
                    left: "50%",
                    marginLeft: -312
                }), x.css({
                    left: 16,
                    width: 292
                }), T.css({
                    left: 316,
                    width: 292
                }))
            }
            function O() {
                b && b.destroy(),
                w && w.destroy(),
                $(window).off("resize", I),
                p.close()
            }
        }
    },
    "./src/js/client/RemoteDB.js": function(e, t, i) {
        "use strict";
        (function(e) {
            i.d(t, "a", (function() {
                return a
            }));
            i("./node_modules/core-js/modules/es.typed-array.uint8-array.js"),
            i("./node_modules/core-js/modules/web.immediate.js"),
            i("./node_modules/core-js/modules/web.url.to-json.js");
            var o = i("./node_modules/underscore/underscore.js");
            const n = schemas.RE_NID,
                s = schemas.RE_FILE_REF;
            function a(e, t, i) {
                this.dbinfo = e,
                this.name = e.name,
                this.id = e.id,
                this.account = t,
                this.server = i,
                this.adminEnabled = !0,
                this.adminMode = !1,
                this.schema = void 0,
                this.views = {},
                this.originalViews = {},
                this.user = void 0,
                this.authorizationOpen = !1,
                this.authorizationPrint = !1,
                this.authorizationExport = !1,
                this.authorizationImport = !1,
                this.authorizationMassDataUpdate = !1,
                this.queryCache = {},
                this.queryQueue = {},
                this._evalCache = {},
                this.memory = {},
                this._cachedValues = {},
                this.selectIsRunning = !1,
                this.nodes = {},
                this.seq = 0,
                this.listeners = {},
                this.loadQueue = {},
                this.loadDeps = {},
                this.loadCallbacks = [],
                this._schedule = [],
                this._loadNodes = o.debounce($.proxy(this._loadNodes, this)),
                this.listenForChanges = $.proxy(this.listenForChanges, this),
                this.runSelect = $.proxy(this.runSelect, this)
            }
            Object.assign(a.prototype, schemas.AbstractDatabase.prototype),
            a.prototype.isSync = !1,
            a.prototype.supports = {
                authentication: !0,
                files: !0,
                comments: !0,
                history: !0,
                chat: !1,
                sync: !0,
                reindex: !0,
                rebuildThumbs: !0,
                reIndexFiles: !0,
                backup: !0,
                backgroundImage: !0,
                root: !0,
                sharing: !0,
                indexes: !0
            },
            a.prototype.getUniqueID = function() {
                return "remote." + this.account.id + "." + this.id
            },
            a.prototype.typeOf = function(e) {
                return this.schema.typeOf(e)
            },
            a.prototype.ridOf = schemas.ridOf,
            a.prototype.ridOfNode = schemas.ridOfNode,
            a.prototype.descriptor = function() {
                return {
                    id: this.id,
                    name: this.name,
                    location: "remote",
                    account: this.account.id,
                    settings: this.settings
                }
            },
            a.prototype.closeDatabase = function(e) {
                e()
            },
            a.prototype.openDatabase = function(e, t) {
                var i = this;
                i.server.loadBootstrap((function(e, n) {
                    if (e)
                        return t(e);
                    i.seq = n.seq,
                    i.name = n.dbname,
                    i.settings = n.settings;
                    var s = dbms.getRemoteConnection().getSessionInfo().getCurrentAccountUser(i.account.id),
                        a = {};
                    o.each(dbms.getRemoteConnection().getSessionInfo().listAccountUsers(i.account.id), (function(e) {
                        a[e.id] = util.enrichUser(e)
                    }));
                    var r = 1;
                    o.each(util.localeSortBy(a, "caption"), (function(e) {
                        e.order = r++
                    })),
                    i.user = s,
                    i.users = a,
                    i.roles = Object.assign({}, dbms.getRemoteConnection().getSessionInfo().getRoles(i.account.id)),
                    i.setSchema(n.schema),
                    i.updateAuthorization(),
                    i.server.loadViews((function(e, o) {
                        if (e)
                            return t(e);
                        if (o) {
                            i.originalViews = {},
                            i.views = {};
                            for (var n = 0; n < o.length; n++) {
                                var s = o[n];
                                i.originalViews[s.id] = s,
                                i.views[s.id] = util.getPersistentView(s)
                            }
                        }
                        setTimeout(i.listenForChanges, 0),
                        t()
                    }))
                }))
            },
            a.prototype.setAdminMode = function(e) {
                this.adminMode = !!e,
                this._trigger("*:admin", ["admin", this.adminMode])
            },
            a.prototype.setSchema = function(e) {
                this.schema && this.schema.off("change", this.schemaChanged, this),
                this.originalSchema = e,
                this.schema = new schemas.Schema(this, e),
                this.schema.on("change", this.schemaChanged, this)
            },
            a.prototype.saveSchema = function(e) {
                this.updateSchema(this.schema, (function(t) {
                    t && $.alert(t),
                    e && e()
                }))
            },
            a.prototype.resetSchema = function(e) {
                this.setSchema(this.originalSchema),
                this._trigger("*:schema", ["schema", !1, !0]),
                e && e()
            },
            a.prototype.schemaChanged = function() {
                this._trigger("*:schema", ["schema", !0, !1])
            },
            a.prototype.updateSchema_OLD = function(e, t) {
                e.protectUpdated();
                var i = e.validate();
                if (i)
                    return t(i);
                var o = e.toJSON();
                o.password = this.schemaPassword,
                this.setDirty(),
                this.server.sendUpdateSchema(o, t)
            },
            a.prototype.updateSchema = function(e, t) {
                e.protectUpdated();
                var i = e.validate();
                if (i)
                    return t(i);
                var o = e.toJSON();
                o.password = this.schemaPassword;
                var n = util.diff(this.originalSchema, o);
                if (console.log("SCHEMAPATCH", n), !n)
                    return t();
                this.setDirty(),
                this.server.sendPatchSchema(n, t)
            },
            a.prototype.loadCalendar = function(e, t, i) {
                this.server.loadCalendar(e, t, i)
            },
            a.prototype.loadHistory = function(e) {
                this.server.loadHistory(e)
            },
            a.prototype.loadNodeHistory = function(e, t) {
                this.server.loadNodeHistory(e, t)
            },
            a.prototype.loadViews = function(e) {
                this.server.loadViews(e)
            },
            a.prototype.removeView = function(e, t) {
                delete this.views[e],
                this.server.removeView(e, t)
            },
            a.prototype.loadComments = function(e, t) {
                this.server.loadComments(e, t)
            },
            a.prototype.postComment = function(e, t, i, o) {
                this.server.postComment(e, t, i, o)
            },
            a.prototype.removeComment = function(e, t, i) {
                this.server.removeComment(e, t, i)
            },
            a.prototype.loadFiles = function(e, t) {
                this.server.loadFiles(e, t)
            },
            a.prototype.removeFile = function(e, t, i) {
                this.server.removeFile(e, t, i)
            },
            a.prototype.reindex = function(e) {
                this.server.reindex(e)
            },
            a.prototype.reIndexFiles = function(e) {
                this.server.reIndexFiles(e)
            },
            a.prototype.rebuildThumbs = function(e) {
                this.server.rebuildThumbs(e)
            },
            a.prototype.clearHistory = function(e) {
                this.server.clearHistory(e)
            },
            a.prototype.thumbURL1 = function(e) {
                return this.server.thumbURL1(e)
            },
            a.prototype.thumbURL2 = function(e, t) {
                return this.server.thumbURL2(e, t)
            },
            a.prototype.thumb2URL1 = function(e) {
                return this.server.thumb2URL1(e)
            },
            a.prototype.thumb2URL2 = function(e, t) {
                return this.server.thumb2URL2(e, t)
            },
            a.prototype.fileURL1 = function(e) {
                return this.server.fileURL1(e)
            },
            a.prototype.serverFileURL1 = a.prototype.fileURL1,
            a.prototype.fileURL2 = function(e, t) {
                return this.server.fileURL2(e, t)
            },
            a.prototype.previewURL1 = function(e) {
                if (e) {
                    var t = s.exec(e);
                    if (t) {
                        var i = t[1] + t[2],
                            o = t[3];
                        return this.server.previewURL(i, o)
                    }
                }
            },
            a.prototype.previewURL = function(e, t) {
                return this.server.previewURL(e, t)
            },
            a.prototype.downloadURL1 = function(e) {
                if (e) {
                    var t = s.exec(e);
                    if (t) {
                        var i = t[1] + t[2],
                            o = t[3];
                        return this.server.downloadURL(i, o)
                    }
                }
            },
            a.prototype.downloadURL = function(e, t) {
                return this.server.downloadURL(e, t)
            },
            a.prototype.uploadURL = function(e) {
                return this.server.uploadURL(e)
            },
            a.prototype.setBackgroundFile = function(e, t) {
                var i = this;
                this.server.uploadBackground({
                    file: e
                }, (function(e, o) {
                    if (e)
                        return t(e);
                    i.settings = o,
                    i.updateAuthorization(),
                    ui.updateBackground(!0),
                    t()
                }))
            },
            a.prototype.userName = function(e) {
                if (void 0 === e)
                    return "";
                var t = this.users[e];
                return t ? t.caption : locale.unknown
            },
            a.prototype.create = function(e, t, i) {
                var o,
                    n = this;
                if ("string" == typeof e) {
                    if (o = e, !(e = n.schema.types[o]))
                        return i("Type not found: " + o)
                } else
                    o = e.id;
                var s = e.fields,
                    a = {};
                for (var r in s)
                    if (s.hasOwnProperty(r)) {
                        var l = s[r];
                        if ((l.isField || l.isReference || l.isReverse) && "fn" !== l.base) {
                            var c = t ? t[r] : void 0;
                            a[r] = void 0 !== c ? l.convert(c) : l.create()
                        }
                    }
                n.setDirty(),
                n.server.sendCreate(o, a, (function(t, s) {
                    if (t)
                        return i(t);
                    if (!n.nodes[s._id]) {
                        n.nodes[s._id] = s;
                        var a = ["create", e.id, s._id];
                        n.schedule("*:create", a),
                        n.schedule(o + ":create", a),
                        n._simulateUpdates(s),
                        n.triggerEvents()
                    }
                    i(void 0, s)
                }))
            },
            a.prototype._simulateUpdates = function(e) {
                var t = e._id,
                    i = n.exec(t);
                if (i) {
                    var s = i[1],
                        a = parseInt(i[2]),
                        r = this.schema.types[s];
                    if (r) {
                        var l = r.fields;
                        for (var c in e)
                            if (e.hasOwnProperty(c)) {
                                var d = e[c],
                                    h = l[c];
                                if (h && h.isReference && d) {
                                    var p = h.refTypeId + d,
                                        u = this.nodes[p];
                                    if (u) {
                                        var f = !1,
                                            m = u[h.refFieldId];
                                        if (m) {
                                            var g = o.sortedIndex(m, a);
                                            m[g] !== a && (m.splice(g, 0, a), f = !0)
                                        } else
                                            u[h.refFieldId] = [a],
                                            f = !0;
                                        f && this.schedule("*:change", ["change", p])
                                    }
                                }
                            }
                    }
                }
            },
            a.prototype.remove = function(e, t) {
                this.setDirty(),
                this.server.sendRemove(e, (function(e) {
                    t(e)
                }))
            },
            a.prototype.removeAll = function(e, t) {
                e && e.length ? (this.setDirty(), this.server.sendRemoveAll(e, (function(e) {
                    t && t()
                }))) : t && t()
            },
            a.prototype.updateSync = function(e, t, i) {
                throw new Error("Not supported")
            },
            a.prototype.update = function(e, t, i, o) {
                var n = this,
                    s = n.nodes[e],
                    a = n.schema.typeOf(e);
                if (!a)
                    return o();
                var r = a.fields[t];
                if (!r)
                    return o();
                if (i = null == i ? null : r.convert(i), "memory-global" === r.binding) {
                    const s = r.type.id + "." + r.id,
                        a = n.memory[s];
                    if (a !== i || null == a != (null == i)) {
                        n.memory[s] = null == i ? void 0 : i,
                        n.setDirty();
                        const a = ["update", e, t, i];
                        n.schedule("*:update", a),
                        n.schedule(e + ":*", a),
                        n.schedule(e + ":update", a),
                        n.schedule(e + ":update:" + t, a),
                        n.schedule(e + ":change", ["change", e]),
                        n.schedule("*:change", ["change", e]),
                        n.executeMemoryTrigger(r.afterUpdateExp, e, () => {
                            n.suppressMemoryTriggers || n.triggerEvents(),
                            o && o()
                        })
                    } else
                        o && o()
                } else if ("memory-record" === r.binding) {
                    const s = e + "." + r.id,
                        a = n.memory[s];
                    if (a !== i || null == a != (null == i)) {
                        n.memory[s] = null == i ? void 0 : i,
                        n.setDirty();
                        const a = ["update", e, t, i];
                        n.schedule("*:update", a),
                        n.schedule(e + ":*", a),
                        n.schedule("*:change", ["change", e]),
                        n.executeMemoryTrigger(r.afterUpdateExp, e, () => {
                            n.suppressMemoryTriggers || n.triggerEvents(),
                            o && o()
                        })
                    } else
                        o && o()
                } else if (s && (s[t] === i || null == s[t] && null == i))
                    o && o();
                else {
                    s[t] = null == i ? void 0 : i,
                    n.setDirty();
                    var l = ["update", e, t, i];
                    n.schedule("*:update", l),
                    n.schedule(e + ":*", l),
                    n.schedule(e + ":update", l),
                    n.schedule(e + ":update:" + t, l),
                    n.schedule(e + ":change", ["change", e]),
                    n.schedule("*:change", ["change", e]),
                    n.triggerEvents(),
                    n.server.sendUpdate(e, t, i, (function(e) {
                        e ? ($.alert(e), o && o(e)) : o && o()
                    }))
                }
            },
            a.prototype.executeMemoryTrigger = function(e, t, i) {
                e ? this.suppressMemoryTriggers ? i() : (this.suppressMemoryTriggers = !0, this.loadNode(t, (t, o) => {
                    t && console.warn(t),
                    e.evaluate(this, o, e => {
                        this.suppressMemoryTriggers = !1,
                        e && console.warn(e),
                        i()
                    })
                })) : i()
            },
            a.prototype.updateNodes = function(e, t) {
                this.setDirty(),
                this.server.sendUpdateNodes(e, t)
            },
            a.prototype.loadNode = function(e, t) {
                var i = this.nodes,
                    o = i[e];
                return null === o ? t(locale.nodeNotFound + " (" + e + ")") : void 0 !== o ? t(void 0, o) : void this.loadNodes([e], (function(o) {
                    if (o)
                        return t(o);
                    var n = i[e];
                    return n ? n._error ? t(n._error) : void t(void 0, n) : t(locale.nodeNotFound + " (" + e + ")")
                }))
            },
            a.prototype.loadNode2 = function(e, t, i) {
                return this.loadNode(e + t, i)
            },
            a.prototype.loadNodeSync = function(e) {
                return this.nodes[e]
            },
            a.prototype.loadNodeSync2 = function(e, t) {
                return this.nodes[e + t]
            },
            a.prototype.loadNodes = function(e, t) {
                if (!e || 0 === e.length)
                    return t();
                if (0 === (e = this.filterUncached(e, {})).length)
                    return t();
                for (var i = 0; i < e.length; i++)
                    this.loadQueue[e[i]] = !0;
                this.loadCallbacks.push(t),
                this._loadNodes()
            },
            a.prototype.loadNodes3 = function(e, t, i) {
                if (!t || 0 === t.length)
                    return i();
                for (var o = this.loadQueue, n = this.nodes, s = 0, a = 0; a < t.length; a++) {
                    var r = e + t[a];
                    n[r] || (o[r] = !0, s++)
                }
                if (0 === s)
                    return i();
                this.loadCallbacks.push(i),
                this._loadNodes()
            },
            a.prototype.loadNodes2 = function(e, t, i) {
                if (!e || 0 === e.length)
                    return i();
                if (0 === (e = this.filterUncached(e, t)).length)
                    return i();
                for (var o = this.loadQueue, n = 0; n < e.length; n++)
                    o[e[n]] = !0;
                this.loadDeps = queries.extendDependencies(this.loadDeps, t),
                this.loadCallbacks.push(i),
                this._loadNodes()
            },
            a.prototype.filterUncached = function(e, t) {
                e = e.slice(0);
                this.schema.types;
                for (var i = this.nodes, n = {}, s = {}, a = 0; a < e.length; a++) {
                    var r = e[a];
                    if (!n[r]) {
                        n[r] = !0;
                        var l = i[r];
                        if (l) {
                            var c = this.typeOf(r);
                            if (c) {
                                var d = t[c.id];
                                if (d)
                                    for (var h = 0; h < d.length; h++) {
                                        var p = d[h],
                                            u = c.fields[p];
                                        if (u)
                                            if (u.isReference) {
                                                if (v = l[p])
                                                    n[g = u.refType.id + v] || e.push(g)
                                            } else if (u.isReverse) {
                                                var f = l[p];
                                                if (f)
                                                    for (var m = 0; m < f.length; m++) {
                                                        var g,
                                                            v = f[m];
                                                        n[g = u.refType.id + v] || e.push(g)
                                                    }
                                            }
                                    }
                            }
                        } else
                            s[r] = !0
                    }
                }
                return o.keys(s).sort()
            },
            a.prototype._loadNodes = function() {
                var e = this.nodes;
                if (o.isEmpty(this.loadQueue)) {
                    var t = this.loadCallbacks;
                    this.loadCallbacks = [];
                    for (var i = 0; i < t.length; i++)
                        t[i]()
                } else {
                    var n = Object.keys(this.loadQueue);
                    this.loadQueue = {};
                    var s = this.loadDeps;
                    this.loadDeps = {};
                    t = this.loadCallbacks;
                    this.loadCallbacks = [],
                    this.server.loadNodes(n, s, (function(i, o) {
                        if (!i)
                            for (var n = 0; n < o.length; n++) {
                                var s = o[n];
                                s._error ? (log("Failed to load node", s._id, s._error), e[s._id] = null) : s._na ? e[s._id] = null : e[s._id] = s
                            }
                        for (n = 0; n < t.length; n++)
                            t[n]()
                    }))
                }
            },
            a.prototype.find = function(e, t, i) {
                this.server.sendFind(e, t, i)
            },
            a.prototype.fastSearch = function(e, t, i) {
                var o = this;
                o.server.sendFind(void 0, t, (function(e, t) {
                    if (e)
                        return i(e);
                    o.loadNodes(t, (function() {
                        for (var e = {}, o = 0; o < t.length; o++) {
                            var s = t[o],
                                a = n.exec(s);
                            if (a) {
                                var r = a[1],
                                    l = parseInt(a[2]),
                                    c = e[r];
                                c || (c = e[r] = []),
                                c.push(l)
                            }
                        }
                        i(void 0, e)
                    }))
                }))
            },
            a.prototype.select = a.prototype.select_optimized = function(e, t) {
                var i = this.queryCache[e];
                if (i)
                    t(void 0, i);
                else {
                    var o = this.queryQueue[e];
                    o ? o.push(t) : o = this.queryQueue[e] = [t],
                    this.runSelect()
                }
            },
            a.prototype.runSelect = function() {
                var t = this;
                if (!t.selectIsRunning) {
                    var i = t.queryQueue,
                        o = t.queryCache,
                        n = [];
                    for (var s in i)
                        if (i.hasOwnProperty(s)) {
                            var a = i[s];
                            a && a.length && n.push(s)
                        }
                    n.length && (t.selectIsRunning = !0, t.server.sendSelects(n, (function(s, a) {
                        if (a)
                            for (var r = 0; r < n.length; r++) {
                                var l = n[r];
                                (c = a[r]) && c.length && t.loadNodes2(c, {}, (function() {})),
                                o[l] = c
                            }
                        for (r = 0; r < n.length; r++) {
                            l = n[r];
                            var c = o[l] || [],
                                d = i[l];
                            if (delete i[l], d && d.length)
                                for (var h = 0; h < d.length; h++)
                                    d[h](void 0, c)
                        }
                        var p = !1;
                        for (var l in i) {
                            if (i.hasOwnProperty(l))
                                if ((d = i[l]) && d.length) {
                                    p = !0;
                                    break
                                }
                        }
                        p && e(t.runSelect, 0),
                        t.selectIsRunning = !1
                    })))
                }
            },
            a.prototype.selectFind = function(e, t, i) {
                this.select(e, i)
            },
            a.prototype.selectFromTypeWhere = function(e, t, i) {
                var o = t ? "select " + e + " where " + t.toString() : "select " + e;
                this.select(o, i)
            },
            a.prototype.selectSyncJS = function() {
                return []
            },
            a.prototype.on = function(e, t, i, o) {
                var n = (t || "*") + ":" + (e || "*"),
                    s = this.listeners[n];
                this.listeners[n] = s ? this.listeners[n].concat([{
                    f: i,
                    c: o
                }]) : [{
                    f: i,
                    c: o
                }]
            },
            a.prototype.onCreate = function(e, t, i) {
                this.on("create", e, t, i)
            },
            a.prototype.onRemove = function(e, t, i) {
                this.on("remove", e, t, i)
            },
            a.prototype.onUpdate = function(e, t, i, o) {
                this.on(t ? "update:" + t : "update", e, i, o)
            },
            a.prototype.onChange = function(e, t, i) {
                this.on("change", e, t, i)
            },
            a.prototype.onComment = function(e, t, i) {
                this.on("comment", e, t, i)
            },
            a.prototype.onFile = function(e, t, i) {
                this.on("file", e, t, i)
            },
            a.prototype.onView = function(e, t) {
                this.on("view", void 0, e, t)
            },
            a.prototype.off = function(e, t, i, o) {
                var n = (t || "*") + ":" + (e || "*"),
                    s = this.listeners[n];
                if (s) {
                    for (var a = [], r = 0; r < s.length; r++) {
                        var l = s[r];
                        (i && l.f !== i || o && l.c !== o) && a.push(l)
                    }
                    this.listeners[n] = a
                } else
                    log("Inconsistent RemoteDB.off")
            },
            a.prototype.offCreate = function(e, t, i) {
                this.off("create", e, t, i)
            },
            a.prototype.offChange = function(e, t, i) {
                this.off("change", e, t, i)
            },
            a.prototype.offRemove = function(e, t, i) {
                this.off("remove", e, t, i)
            },
            a.prototype.offUpdate = function(e, t, i, o) {
                this.off(t ? "update:" + t : "update", e, i, o)
            },
            a.prototype.offComment = function(e, t, i) {
                this.off("comment", e, t, i)
            },
            a.prototype.offFile = function(e, t, i) {
                this.off("file", e, t, i)
            },
            a.prototype.offView = function(e, t) {
                this.off("view", void 0, e, t)
            },
            a.prototype._trigger = function(e, t) {
                var i = this.listeners[e];
                if (i)
                    for (var o = 0; o < i.length; o++)
                        i[o].f.apply(i[o].c, t)
            },
            a.prototype.schedule = function(e, t) {
                this._schedule.push([e, t])
            },
            a.prototype.triggerEvents = function() {
                var e = this._schedule;
                if (this._schedule = [], e && e.length) {
                    this._trigger("*:*", []);
                    for (var t = 0; t < e.length; t++)
                        this._trigger(e[t][0], e[t][1])
                }
            },
            a.prototype.listenForChanges = function() {
                var e = this;
                e.server.loadChanges(e.seq, (function(t, i) {
                    t ? setTimeout(e.listenForChanges, 5e3) : e.applyChanges(i, (function(t) {
                        t && log(t),
                        setTimeout(e.listenForChanges, 0)
                    }))
                }))
            },
            a.prototype.applyChanges = function(e, t) {
                var i = e.results;
                if (i)
                    for (var o = 0; o < i.length; o++) {
                        var n = i[o];
                        this.change(n)
                    }
                else
                    this.resync();
                this.seq !== e.last_seq && (this.seq = e.last_seq, this.schedule("*:history")),
                this.triggerEvents(),
                t()
            },
            a.prototype.resync = function() {
                this.nodes = {},
                this.queryCache = {},
                this._evalCache = {},
                this._trigger("resync", []),
                this._trigger("*:schema", ["schema", null, null])
            };
            var r = {
                "schema-patch": function(e, t, i, o, n) {
                    this.setDirty(),
                    this.setSchema(util.applyChange(this.schema.toJSON(), n));
                    this.schedule("*:schema", ["schema", !1, !0])
                },
                schema: function(e, t, i, o, n) {
                    this.setDirty(),
                    this.setSchema(n);
                    this.schedule("*:schema", ["schema", !1, !0])
                },
                create: function(e, t, i, o, n, s) {
                    var a = this.typeOf(n);
                    if (a) {
                        var r = a.id,
                            l = !this.nodes[n];
                        if (this.nodes[n] = s, this.setDirty(), l) {
                            var c = ["create", r, n];
                            this.schedule("*:create", c),
                            this.schedule(r + ":create", c)
                        }
                    }
                },
                remove: function(e, t, i, o, n) {
                    this.setDirty();
                    var s = ["remove", n];
                    this.schedule("*:remove", s),
                    this.schedule(n + ":*", s),
                    this.schedule(n + ":remove", s),
                    delete this.nodes[n]
                },
                update: function(e, t, i, n, s, a) {
                    this.setDirty();
                    var r = this.nodes[s],
                        l = this.typeOf(s);
                    if (l) {
                        for (var c in a)
                            if (a.hasOwnProperty(c)) {
                                var d = l.fields[c];
                                if (d)
                                    if (d.isField) {
                                        var h = !0;
                                        if (r) {
                                            var p = r[c],
                                                u = a[c];
                                            r[c] = null == u ? void 0 : u,
                                            (p === u || null == p && null == u) && (h = !1)
                                        }
                                        if (h) {
                                            var f = ["update", s, c, a[c]];
                                            this.schedule("*:update", f),
                                            this.schedule(s + ":*", f),
                                            this.schedule(s + ":update", f),
                                            this.schedule(s + ":update:" + c, f)
                                        }
                                    } else if (d.isReference) {
                                        r && (r[c] = null == a[c] ? void 0 : a[c]);
                                        f = ["update", s, c, a[c]];
                                        this.schedule("*:update", f),
                                        this.schedule(s + ":*", f),
                                        this.schedule(s + ":update", f),
                                        this.schedule(s + ":update:" + c, f)
                                    } else if (d.isReverse && r) {
                                        var m = r[c];
                                        m || (m = r[c] = []);
                                        var g = a[c];
                                        for (var v in g) {
                                            if (g.hasOwnProperty(v))
                                                if (!0 === g[v = parseInt(v)])
                                                    m[b = o.sortedIndex(m, v)] !== v && m.splice(b, 0, v);
                                                else if (!1 === g[v]) {
                                                    var b;
                                                    m[b = o.sortedIndex(m, v)] === v && m.splice(b, 1)
                                                }
                                        }
                                    }
                            }
                        r && (r._mu = t, r._md = i)
                    }
                    this.schedule(s + ":change", ["change", s]),
                    this.schedule("*:change", ["change", s])
                },
                view: function(e, t, i, o, n) {
                    n._deleted ? (delete this.originalViews[n.id], delete this.views[n.id], this.schedule("*:view", ["view", n.id, null])) : (this.originalViews[n.id] = n, this.views[n.id] = util.getPersistentView(n), this.schedule("*:view", ["view", n.id, n]))
                },
                comment: function(e, t, i, o, n) {
                    this.schedule(n + ":comment", ["comment"])
                },
                file: function(e, t, i, o, n) {
                    this.schedule(n + ":file", ["file"])
                }
            };
            function l(e, t) {
                if (!t || 0 === t.length)
                    return !0;
                if (e.roles.admin)
                    return !0;
                for (var i = 0; i < t.length; i++)
                    if (e.roles[t[i]])
                        return !0;
                return !1
            }
            a.prototype.change = function(e) {
                var t = r[e[3]];
                t && t.apply(this, e)
            },
            a.prototype.setBackground = function(e, t) {
                var i = this;
                i.server.setBackground(e, (function(e, o) {
                    if (e)
                        return t(e);
                    i.settings = o,
                    i.updateAuthorization(),
                    ui.updateBackground(),
                    t()
                }))
            },
            a.prototype.updateSettings = function(e, t) {
                var i = this;
                i.server.updateSettings(e, (function(e, o) {
                    e ? t && t(e) : (i.settings = o, i.updateAuthorization(), ui.updateBackground(), t && t(void 0, o))
                }))
            },
            a.prototype.backgroundURL = function(e) {
                return this.server.backgroundURL(e)
            },
            a.prototype.updateAuthorization = function() {
                this.authorizationOpen = l(this.user, this.settings.rolesOpen),
                this.authorizationHistory = l(this.user, this.settings.rolesHistory),
                this.authorizationPrint = l(this.user, this.settings.rolesPrint),
                this.authorizationExport = l(this.user, this.settings.rolesExport),
                this.authorizationImport = l(this.user, this.settings.rolesImport),
                this.authorizationMassDataUpdate = l(this.user, this.settings.rolesMassDataUpdate)
            },
            a.prototype.listReports = function(e) {
                this.server.listReports(e)
            },
            a.prototype.updateReport = function(e, t) {
                this.server.updateReport(e, t)
            },
            a.prototype.removeReport = function(e, t) {
                this.server.removeReport(e, t)
            },
            a.prototype.saveReportFile = function(e, t, i, o) {
                o("saveReportFile not implemented.")
            },
            a.prototype.removeReportFile = function(e, t, i) {
                this.server.removeReportFile(e, t, i)
            },
            a.prototype.cleanReportFiles = function(e, t, i) {
                this.server.cleanReportFiles(e, t, i)
            },
            a.prototype.copyReportFiles = function(e, t, i) {
                this.server.copyReportFiles(e, t, i)
            },
            a.prototype.reportFileURL = function(e, t) {
                return this.server.reportFileURL(e, t)
            },
            a.prototype.reportFileServerURL = a.prototype.reportFileURL,
            a.prototype.reportFileURLProxy = function(e, t) {
                return this.reportFileURL(e, t)
            },
            a.prototype.importReportFile = function(e, t, i) {
                this.server.importReportFile(e, t, i)
            },
            a.prototype.loadCalendarFromTo = function(e, t, i) {
                var o = e.getFullYear(),
                    n = t.getFullYear(),
                    s = e.getMonth() + 1,
                    a = t.getMonth() + 1,
                    r = e.getDate(),
                    l = t.getDate(),
                    c = o + "-" + (s < 10 ? "0" : "") + s + "-" + (r < 10 ? "0" : "") + r,
                    d = n + "-" + (a < 10 ? "0" : "") + a + "-" + (l < 10 ? "0" : "") + l;
                this.loadCalendar(c, d, i)
            },
            a.prototype.saveView = function(e, t) {
                if (this.views[e.id] = e, !this.user.roles.admin)
                    return t();
                var i = this.originalViews[e.id],
                    o = util.getPersistentView(e);
                if (util.viewEquals(o, i))
                    return t();
                this.originalViews[e.id] = o,
                this.server.saveView(o, (function(e) {
                    t(e)
                }))
            },
            a.prototype.duplicate = function(e, t) {
                var i = this;
                i.setDirty(),
                i.server.sendDuplicate(e, (function(e, o) {
                    if (e)
                        return t(e);
                    if (!i.nodes[o._id]) {
                        i.nodes[o._id] = o;
                        var n = schemas.tidOf(o._id),
                            s = ["create", n, o._id];
                        i.schedule("*:create", s),
                        i.schedule(n + ":create", s),
                        i._simulateUpdates(o),
                        i.triggerEvents()
                    }
                    t(void 0, o._id)
                }))
            },
            a.prototype.setDirty = function() {
                this.queryCache = {},
                this._evalCache = {}
            },
            a.prototype.previewFile = function(e, t) {
                var i = this.downloadURL(e, t);
                NinoxDocumentInteraction.previewDocument(i, (function() {}))
            },
            a.prototype.importFile = function(e, t, i) {
                this.server.importFile(e, t, i)
            },
            a.prototype.importFileFromURL = function(e, t, i, o) {
                this.server.importFileFromURL(e, t, i, o)
            },
            a.prototype.renameFile = function(e, t, i, o) {
                this.server.renameFile(e, t, i, o)
            },
            a.prototype.saveFileURL = function(e, t, i) {
                return this.server.saveFileURL(e, t, i)
            },
            a.prototype.saveFileBase64 = function(e, t, i, o) {
                o("Not implemented.")
            },
            a.prototype.saveFileDataURL = function(e, t, i, o) {
                var n = t.split(",");
                if (2 !== n.length)
                    return o("Invalid data URL");
                var s = /:(.*?);/.exec(n[0]);
                if (!s)
                    return o("Invalid data URL");
                var a = s[1];
                if (!a)
                    return o("Invalid data URL");
                for (var r = n[1], l = atob(r), c = new ArrayBuffer(l.length), d = new Uint8Array(c), h = 0; h < l.length; h++)
                    d[h] = l.charCodeAt(h);
                var p = new Blob([c], {
                    type: a
                });
                this.server.importFile(e, p, i, o)
            },
            a.prototype.loadFileURL = function(e, t, i, o) {
                return this.server.loadFileURL(e, t, i, o)
            },
            a.prototype.printSimple = function(e, t) {
                this.server.printSimple(e, t)
            },
            a.prototype.printRich = function(e, t) {
                this.server.printRich(e, t)
            },
            a.prototype.evaluateOnServer = function(e, t, i) {
                t.isUpdating() && this.setDirty(),
                this.server.evaluateOnServer(e, t, (function(e, t) {
                    e ? ($.alert(e), i()) : i(t)
                }))
            },
            a.prototype.sendEmail = function(e, t) {
                this.server.sendEmail(e, t)
            },
            a.prototype.shareFile = function(e, t, i) {
                this.server.shareFile(e, t, i)
            },
            a.prototype.unshareFile = function(e, t, i) {
                this.server.unshareFile(e, t, i)
            },
            a.prototype.loadSharedFile = function(e, t, i) {
                this.server.loadSharedFile(e, t, i)
            },
            a.prototype.shareView = function(e, t, i) {
                this.server.shareView(e, t, i)
            },
            a.prototype.unshareView = function(e, t) {
                this.server.unshareView(e, t)
            },
            a.prototype.loadSharedView = function(e, t) {
                this.server.loadSharedView(e, t)
            },
            a.prototype.importSchema = function(e, t) {
                this.server.importSchema(e, t)
            }
        }).call(this, i("./node_modules/node-libs-browser/node_modules/timers-browserify/main.js").setImmediate)
    },
    "./src/js/printer/printNode.js": function(e, t, i) {
        "use strict";
        i.d(t, "a", (function() {
            return n
        }));
        var o = i("./src/js/printer/renderNodeHTML.js");
        function n(e) {
            if (!database.authorizationPrint)
                return $.alert(locale.notAuthorized);
            "HTML" === database.settings.printTableRendering ? function(e) {
                Object(o.a)({
                    nid: e
                }, (async function(t, i) {
                    if (t)
                        return $.alert(t);
                    try {
                        var o = util.escapeFileName(database.typeOf(e).caption + database.ridOf(e)) + ".html",
                            n = await localFileSystem.tempURL(o);
                        await localFileSystem.writeURL(n, i, "utf8"),
                        NinoxDocumentInteraction.previewDocument(n, (function() {
                            0
                        }))
                    } catch (t) {
                        $.alert(t)
                    }
                }))
            }(e) : function(e) {
                if (!database.typeOf(e))
                    return;
                database.ridOf(e);
                $.loading(!0);
                var t = {
                    ready: !1,
                    canceled: !1,
                    nid: e,
                    fontSize: database.settings.printNodeFontSize || "9",
                    printNodeImages: !0
                };
                NinoxPrint.previewPDFDocument_PREPARE && NinoxPrint.previewPDFDocument_PREPARE();
                !function(e, t) {
                    var i = printer.MM,
                        o = parseInt(e.fontSize) || 10,
                        n = e.nid,
                        s = database.ridOf(n),
                        a = database.typeOf(n),
                        r = {
                            name: util.escapeFileName(a.caption + s) + ".pdf",
                            orientation: "portrait",
                            width: 210 * i,
                            height: 297 * i,
                            marginLeft: 10 * i,
                            marginTop: 10 * i,
                            marginRight: 10 * i,
                            marginBottom: 10 * i,
                            headHeight: 2 * o,
                            footHeight: 2 * o,
                            fontSize: o,
                            headLeft: a.caption + " " + s,
                            headRight: database.name,
                            footLeft: util.formatLocaleDateTime(new Date),
                            footRight: "$page"
                        },
                        l = r.content = [];
                    function c(t) {
                        database.loadFiles(n, (function(i, o) {
                            if (i)
                                return t(i);
                            var s = 0;
                            setTimeout((function i() {
                                if (s >= o.length)
                                    return setTimeout(t, 0);
                                !function(t, i) {
                                    if (!e.printNodeImages)
                                        return i();
                                    var o = database.downloadURL(n, t);
                                    o && l.push({
                                        base: "img",
                                        url: o
                                    });
                                    i()
                                }(o[s++].name, (function(e) {
                                    setTimeout(i, 0)
                                }))
                            }), 0)
                        }))
                    }
                    !function(e) {
                        database.loadNode(n, (function(t, i) {
                            if (t)
                                return e(t);
                            l.push({
                                base: "h1",
                                caption: a.caption + " " + s
                            });
                            var o = a.sorted,
                                n = 0;
                            setTimeout((function t() {
                                if (n >= o.length)
                                    return e();
                                var s = o[n++];
                                !function(e, t, i) {
                                    if (t.isField) {
                                        var o = e[t.id];
                                        if ("file" === t.base)
                                            i();
                                        else if ("fn" === t.base)
                                            t.exp.evaluate(database, e, (function(e, o) {
                                                if (!e) {
                                                    var n = t.format(o) || "";
                                                    n && l.push({
                                                        base: "field",
                                                        caption: t.caption,
                                                        value: n
                                                    })
                                                }
                                                i()
                                            }));
                                        else if ("html" === t.base)
                                            o && l.push({
                                                base: "rich",
                                                caption: t.caption,
                                                value: o
                                            }),
                                            i();
                                        else {
                                            var n = t.format(o) || "";
                                            n && l.push({
                                                base: "field",
                                                caption: t.caption,
                                                value: n
                                            }),
                                            i()
                                        }
                                    } else if (t.isReference) {
                                        var s = e[t.id];
                                        if (s) {
                                            var a = t.refTypeId + s;
                                            database.loadNode(a, (function(e, o) {
                                                if (o) {
                                                    var n = t.refType.format(o) || "";
                                                    l.push({
                                                        base: "field",
                                                        caption: t.caption,
                                                        value: n
                                                    })
                                                }
                                                i()
                                            }))
                                        } else
                                            i()
                                    } else
                                        t.isReverse ? function(e, t, i) {
                                            var o = new queries.QueryReverse(database, t, e._id);
                                            o.load((function() {
                                                var e = o.cols,
                                                    n = o.rows,
                                                    s = o.foot.values,
                                                    a = o.models,
                                                    r = o.groups,
                                                    c = o.cidxGroup;
                                                if (!e.length || !n.length)
                                                    return i();
                                                var d = {
                                                    base: "table",
                                                    caption: t.caption
                                                };
                                                l.push(d),
                                                function() {
                                                    for (var t = d.head = [], i = 0; i < e.length; i++) {
                                                        var o = e[i];
                                                        t.push({
                                                            caption: o.caption || o.expression.caption,
                                                            width: o.width,
                                                            align: printer.cellTypeAlign(o.field)
                                                        })
                                                    }
                                                }(),
                                                function() {
                                                    for (var t = d.rows = [], i = 0; i < n.length; i++) {
                                                        var o = n[i],
                                                            s = a[o] || r[o],
                                                            l = !!r[o],
                                                            h = [];
                                                        t.push(h);
                                                        for (var p = 0; p < e.length; p++) {
                                                            var u = e[p],
                                                                f = s.values[p],
                                                                m = l && p !== c ? u.agg ? printer.aggSymbol(u.agg) + u.aggType.format(f) : "" : u.field.format(f);
                                                            h.push(m || "")
                                                        }
                                                    }
                                                }(),
                                                function() {
                                                    for (var t = d.foot = [], i = 0; i < e.length; i++) {
                                                        var o = e[i];
                                                        if (o.agg) {
                                                            var n = s[i],
                                                                a = printer.aggSymbol(o.agg) + o.aggType.format(n) || "";
                                                            t.push(a)
                                                        } else
                                                            t.push("")
                                                    }
                                                }(),
                                                i()
                                            }))
                                        }(e, t, i) : t.isUI && (("tab" === t.base || "head" === t.base) && l.push({
                                            base: "h2",
                                            caption: t.caption || ""
                                        }), i())
                                }(i, s, (function(i) {
                                    if (i)
                                        return e(i);
                                    setTimeout(t, 0)
                                }))
                            }), 0)
                        }))
                    }((function(i) {
                        if (!e.canceled)
                            return i ? t(i) : void c((function(i) {
                                if (!e.canceled)
                                    return i ? t(i) : void t(void 0, r)
                            }))
                    }))
                }(t, (function(e, t) {
                    if ($.loading(!1), e)
                        return $.alert(e);
                    NinoxPrint.previewPDFDocument(t)
                }))
            }(e)
        }
    },
    "./src/js/printer/printTable.js": function(e, t, i) {
        "use strict";
        i.d(t, "a", (function() {
            return n
        }));
        var o = i("./src/js/printer/renderTableHTML.js");
        function n(e) {
            if (!database.authorizationPrint)
                return $.alert(locale.notAuthorized);
            "HTML" === database.settings.printTableRendering ? function(e) {
                var t = Object(o.a)(e);
                NinoxDocumentInteraction.openFileWithServer(s(e.type), "text/html", t, !1, !1)
            }(e) : function(e) {
                var t = function(e) {
                    var t = e.type && e.type.caption || locale.unnamed,
                        i = e.container && e.container.getViewCaption() || void 0;
                    i == locale.all && (i = void 0);
                    var o = t + (i ? " - " + i : ""),
                        n = printer.MM,
                        s = parseInt(database.settings.printTableFontSize) || 10,
                        a = {
                            name: (v = o, util.escapeFileName(v) + ".pdf"),
                            orientation: "landscape",
                            width: 210 * n,
                            height: 297 * n,
                            marginLeft: 10 * n,
                            marginTop: 10 * n,
                            marginRight: 10 * n,
                            marginBottom: 10 * n,
                            headHeight: 2 * s,
                            footHeight: 2 * s,
                            fontSize: s,
                            headLeft: o,
                            headRight: database.name,
                            footLeft: util.formatLocaleDateTime(new Date),
                            footRight: "$page"
                        },
                        r = e.cols,
                        l = e.rows,
                        c = e.models,
                        d = e.groups,
                        h = e.foot,
                        p = e.cidxGroup,
                        u = (e.type, {
                            base: "table"
                        }),
                        f = u.head = [],
                        m = u.rows = [],
                        g = u.foot = [];
                    var v;
                    a.content = [u];
                    for (var b = 0; b < r.length; b++) {
                        var y = r[b];
                        f.push({
                            caption: y.caption || y.expression.caption || locale.unnamed,
                            width: y.width,
                            align: printer.cellTypeAlign(y.field)
                        })
                    }
                    for (b = 0; b < l.length; b++) {
                        var w = l[b],
                            x = d[w],
                            T = [];
                        if (m.push(T), x)
                            for (var $ = 0; $ < r.length; $++) {
                                y = r[$];
                                if ($ === p) {
                                    var C = x.values[$],
                                        k = y.field.format(C) || "";
                                    T.push(k)
                                } else if (y.agg) {
                                    C = x.values[$],
                                    k = printer.aggSymbol(y.agg) + y.aggType.format(C) || "";
                                    T.push(k)
                                } else
                                    T.push("")
                            }
                        else {
                            var S = c[w];
                            for ($ = 0; $ < r.length; $++) {
                                y = r[$],
                                C = S.values[$],
                                k = y.field.format(C) || "";
                                T.push(k)
                            }
                        }
                    }
                    for ($ = 0; $ < r.length; $++) {
                        if ((y = r[$]).agg) {
                            C = h.values[$],
                            k = printer.aggSymbol(y.agg) + y.aggType.format(C) || "";
                            g.push(k)
                        } else
                            g.push("")
                    }
                    return a
                }(e);
                NinoxPrint.previewPDFDocument(t)
            }(e)
        }
        function s(e) {
            return util.escapeFileName(e.caption) + ".html"
        }
    },
    "./src/js/printer/renderNodeHTML.js": function(e, t, i) {
        "use strict";
        function o(e, t) {
            var i = e.nid,
                o = database.ridOf(i),
                n = database.typeOf(i),
                s = '<!DOCTYPE HTML><html><head><meta http-equiv="content-type" content="text/html; charset=UTF-8"/><style type="text/css">body {font-family:Sans-Serif;font-size:10pt}h1 {text-align:center}h2 {font-size:1em;font-weight:bold;border-bottom:solid thin black;text-align:right}table {width:100%}ul {margin:0;list-style:decimal}li {margin:.5em}p.history {text-align:right;xborder-top:solid thin black;padding:.5em 0;font-style:italic}td {padding:.5em}td.caption {text-align:right;font-weight:bold}td.value {text-align:left}td.long-value {border-bottom:solid thin black;border-top:solid thin black}.head {position:fixed;top:0;left:0;width:100%;height:30pt;background-color:red}.foot {position:fixed;bottom:0;left:0;width:100%;height:30pt;background-color:blue}table.bordered {width:100%;empty-cells:show;border-spacing:0;border-collapse:collapse;border:solid thin black}table.bordered td, table.bordered th {padding:.5em;border:solid thin black}table.bordered tfoot tr {border-top:double}td.cell-number {text-align:right}td.cell-date {text-align:center}td.cell-boolean {text-align:center}td.cell-choice {text-align:left}td.cell-fn {text-align:right}</style></head><body>';
            !function(e) {
                database.loadNode(i, (function(t, i) {
                    if (t)
                        return e(t);
                    s += "<h1>" + htmlEscape(n.caption + " " + o) + "</h1>",
                    s += '<table><colgroup><col width="30%"/><col width="70%"/></colgroup><tbody>';
                    var a = n.sorted,
                        r = 0;
                    function l() {
                        s += "</tbody></table>",
                        e()
                    }
                    setTimeout((function t() {
                        if (r >= a.length)
                            return setTimeout(l, 0);
                        var o = a[r++];
                        !function(e, t, i) {
                            if (t.isField) {
                                var o = e[t.id];
                                if ("file" === t.base)
                                    i();
                                else if ("fn" === t.base)
                                    t.exp.evaluate(database, e, (function(e, o) {
                                        if (!e) {
                                            var n = t.format(o);
                                            n && (s += '<tr><td class="caption">' + htmlEscape(t.caption) + '</td><td class="value">' + htmlEscape(n) + "</td></tr>")
                                        }
                                        i()
                                    }));
                                else if ("html" === t.base)
                                    o && (s += '<tr><td class="caption" colspan="2">' + htmlEscape(t.caption) + '</td></tr><tr><td class="long-value" colspan="2">' + o + "</td></tr>"),
                                    i();
                                else {
                                    var n = t.format(o);
                                    n && (s += '<tr><td class="caption">' + htmlEscape(t.caption) + '</td><td class="value">' + htmlEscape(n) + "</td></tr>"),
                                    i()
                                }
                            } else if (t.isReference) {
                                var a = e[t.id];
                                if (a) {
                                    var r = t.refTypeId + a;
                                    database.loadNode(r, (function(e, o) {
                                        if (o) {
                                            var n = t.refType.format(o);
                                            n && (s += '<tr><td class="caption">' + htmlEscape(t.caption) + '</td><td class="value">' + htmlEscape(n) + "</td></tr>")
                                        }
                                        i()
                                    }))
                                } else
                                    i()
                            } else
                                t.isReverse ? function(e, t, i) {
                                    var o = new queries.QueryReverse(database, t, e._id);
                                    o.load((function() {
                                        var e = o.cols,
                                            n = o.rows,
                                            a = o.foot.values,
                                            r = o.models,
                                            l = o.groups,
                                            c = o.cidxGroup;
                                        if (!e.length || !n.length)
                                            return i();
                                        !function() {
                                            s += '<tr><td class="caption" colspan="2">' + htmlEscape(t.caption) + "</td></tr>",
                                            s += '<tr><td class="table-value" colspan="2"><table class="bordered">',
                                            s += "<thead><tr>";
                                            for (var i = 0; i < e.length; i++) {
                                                var o = e[i];
                                                s += "<th>" + htmlEscape(o.caption || o.expression.caption) + "</th>"
                                            }
                                            s += "</tr></thead>"
                                        }(),
                                        function() {
                                            s += "<tbody>";
                                            for (var t = 0; t < n.length; t++) {
                                                s += "<tr>";
                                                for (var i = n[t], o = r[i] || l[i], a = !!l[i], d = 0; d < e.length; d++) {
                                                    var h = e[d],
                                                        p = o.values[d],
                                                        u = a && d !== c ? h.agg ? printer.aggSymbol(h.agg) + h.aggType.format(p) : "" : h.field.format(p);
                                                    s += "<td>" + htmlEscape(u) + "</td>"
                                                }
                                                s += "</tr>"
                                            }
                                            s += "</tbody>"
                                        }(),
                                        function() {
                                            s += "<tfoot><tr>";
                                            for (var t = 0; t < e.length; t++) {
                                                var i = e[t];
                                                if (i.agg) {
                                                    var o = a[t],
                                                        n = printer.aggSymbol(i.agg) + i.aggType.format(o);
                                                    s += "<td>" + htmlEscape(n) + "</td>"
                                                } else
                                                    s += "<td></td>"
                                            }
                                            s += "</tr></tfoot>",
                                            s += "</table></td></tr>"
                                        }(),
                                        i()
                                    }))
                                }(e, t, i) : t.isUI && ("tab" !== t.base && "head" !== t.base || (s += '<tr><td colspan="2"><h2>' + htmlEscape(t.caption) + "</h2></td></tr>"), i())
                        }(i, o, (function(i) {
                            if (i)
                                return e(i);
                            setTimeout(t, 0)
                        }))
                    }), 0)
                }))
            }((function(o) {
                if (!e.canceled)
                    return o ? t(o) : void function(t) {
                        database.loadFiles(i, (function(o, n) {
                            if (o)
                                return t(o);
                            var a = 0;
                            setTimeout((function o() {
                                if (a >= n.length)
                                    return setTimeout(t, 0);
                                !function(t, o) {
                                    if (!e.printNodeImages)
                                        return o();
                                    if (!util.RE_IMAGE_FILE_EXT.test(t))
                                        return o();
                                    var n = database.downloadURL(i, t);
                                    n ? s += '<img src="' + n + '">' : o()
                                }(n[a++].name, (function(e) {
                                    setTimeout(o, 0)
                                }))
                            }), 0)
                        }))
                    }((function(i) {
                        if (!e.canceled) {
                            if (i)
                                return t(i);
                            t(void 0, s += "</body></html>")
                        }
                    }))
            }))
        }
        i.d(t, "a", (function() {
            return o
        }))
    },
    "./src/js/printer/renderTableHTML.js": function(e, t, i) {
        "use strict";
        function o(e) {
            var t = e.cols,
                i = e.rows,
                o = e.models,
                n = e.groups,
                s = e.foot,
                a = e.cidxGroup,
                r = e.type,
                l = "";
            l += '<!DOCTYPE HTML>\r\n<html><head><meta http-equiv="content-type" content="text/html; charset=UTF-8"/><style type="text/css">body {font-family:Sans-Serif;font-size:10pt}h1 {text-align:center}table {width:100%;empty-cells:show;border-spacing:0;border-collapse:collapse;border:solid thin black}td, th {padding:.5em;border:solid thin black;height:1.5em}td.cell-number {text-align:right}td.cell-date {text-align:center}td.cell-boolean {text-align:center}td.cell-choice {text-align:left}td.cell-fn {text-align:right}tfoot tr {border-top:double}</style></head><body>',
            l += "<h1>" + htmlEscape(r.caption) + "</h1>",
            l += "<table>",
            l += "<thead>",
            l += "<tr>";
            for (var c = 0; c < t.length; c++) {
                var d = t[c];
                l += "<th>" + htmlEscape(d.caption || d.expression.caption) + "</th>"
            }
            l += "</tr>",
            l += "</thead>",
            l += "<tbody>";
            for (c = 0; c < i.length; c++) {
                var h = i[c],
                    p = n[h];
                if (p) {
                    l += "<tr>";
                    for (var u = 0; u < t.length; u++) {
                        d = t[u];
                        if (u === a) {
                            var f = p.values[u],
                                m = d.field.format(f);
                            l += '<td class="cell-' + d.field.base + '">' + htmlEscape(m) + "</td>"
                        } else if (d.agg) {
                            f = p.values[u],
                            m = d.aggType.format(f);
                            l += '<td class="cell-' + d.aggType.base + '">',
                            l += "<span>" + htmlEscape(m) + "</span>",
                            l += "</td>"
                        } else
                            l += "<td></td>"
                    }
                    l += "</tr>"
                } else {
                    var g = o[h];
                    l += "<tr>";
                    for (u = 0; u < t.length; u++) {
                        d = t[u],
                        f = g.values[u],
                        m = d.field.format(f);
                        l += '<td class="cell-' + d.field.base + '">' + htmlEscape(m) + "</td>"
                    }
                    l += "</tr>"
                }
            }
            l += "</tbody>",
            l += "<tfoot>",
            l += "<tr>";
            for (u = 0; u < t.length; u++) {
                if ((d = t[u]).agg) {
                    f = s.values[u],
                    m = d.aggType.format(f);
                    l += '<td class="cell-' + d.aggType.base + '">',
                    l += "<span>" + htmlEscape(m) + "</span>",
                    l += "</td>"
                } else
                    l += "<td></td>"
            }
            return l += "</tr>", l += "</tfoot>", l += "</table>", l += "</body></html>"
        }
        i.d(t, "a", (function() {
            return o
        }))
    },
    "./src/js/reports/ActionMenu.js": function(e, t, i) {
        "use strict";
        function o(e) {
            var t = this;
            this.designer = e,
            this.$actions = e.$titleMenuCenter,
            $('<div class="button i-40-24 i-light-grey i-plus" title="' + htmlEscape(locale.add) + '">').appendTo(this.$actions).click((function(t) {
                e.insertObject(t)
            })),
            this.$trash = $('<div class="button i-40-24 i-light-grey i-setting-trash" title="' + htmlEscape(locale.remove) + '">').appendTo(this.$actions).click((function() {
                e.removeSelection()
            })),
            this.$moveToFront = $('<div class="button i-40-24 i-light-grey i-move-to-front" title="' + htmlEscape(locale.moveToFront) + '">').appendTo(this.$actions).click((function() {
                e.moveToFront()
            })),
            this.$moveToBack = $('<div class="button i-40-24 i-light-grey i-move-to-back" title="' + htmlEscape(locale.moveToBack) + '">').appendTo(this.$actions).click((function() {
                e.moveToBack()
            })),
            this.$select = $('<div class="button i-40-24 i-light-grey i-select" title="' + htmlEscape(locale.select) + '">').appendTo(this.$actions).click((function() {
                t.$select.addClass("active"),
                e.startSelect((function() {
                    t.$select.removeClass("active")
                }))
            })),
            this.$duplicate = $('<div class="button i-40-24 i-light-grey i-setting-copy" title="' + htmlEscape(locale.duplicate) + '">').appendTo(this.$actions).click((function() {
                e.duplicate()
            })),
            this.updateUI()
        }
        i.d(t, "a", (function() {
            return o
        })),
        o.prototype.updateUI = function() {
            var e = this.designer,
                t = e.selection,
                i = e.multiSelection;
            t || i ? (this.$trash.css("opacity", "1"), this.$moveToFront.css("opacity", "1"), this.$moveToBack.css("opacity", "1")) : (this.$trash.css("opacity", "0.2"), this.$moveToFront.css("opacity", "0.2"), this.$moveToBack.css("opacity", "0.2")),
            t || i && i.length ? this.$duplicate.css("opacity", "1") : this.$duplicate.css("opacity", "0.2")
        }
    },
    "./src/js/reports/ColorMenu.js": function(e, t, i) {
        "use strict";
        function o(e) {
            var t = this;
            this.designer = e,
            this.$el = $('<div class="rd-menu-bar center">').appendTo(e.$menu),
            this.$bg = $('<div class="rd-menu-button rd-backgroundcolor">').hide().appendTo(this.$el).click((function() {
                new n({
                    offset: t.$bg.offset(),
                    update: function(i) {
                        e.selection && e.selection.setBackgroundColor && e.selection.setBackgroundColor(i),
                        t.updateUI()
                    }
                })
            })),
            this.$bgColor = $('<dic class="rd-backgroundcolor-color">').appendTo(this.$bg),
            this.$border = $('<div class="rd-menu-button rd-bordercolor">').hide().appendTo(this.$el).click((function() {
                t.popupBorder()
            })),
            this.$borderColor = $('<dic class="rd-bordercolor-color">').appendTo(this.$border),
            this.$text = $('<div class="rd-menu-button rd-textcolor">').hide().appendTo(this.$el).click((function() {
                new n({
                    offset: t.$text.offset(),
                    update: function(i) {
                        e.selection && e.selection.setTextColor && e.selection.setTextColor(i),
                        t.updateUI()
                    }
                })
            })),
            this.$textColor = $('<div class="rd-textcolor-color i-32-24 i-light-grey i-field-string">').appendTo(this.$text),
            this.updateUI()
        }
        function n(e) {
            var t = e.update,
                i = $.backplane({
                    autoClose: !0
                }),
                o = $('<div class="colorselector-menu">').appendTo(i),
                n = $('<table class="colorselector-table">').appendTo(o),
                s = $("<tbody>").appendTo(n),
                a = $("<tr>").appendTo(s),
                r = $('<td colspan="12">').appendTo(a);
            $('<div class="colorselector-default">').text(locale.noColor).appendTo(r).touch((function() {
                i.close(),
                t(null)
            }));
            for (var l = 0; l < 144; l++)
                l % 12 == 0 && (a = $("<tr>").appendTo(s)),
                r = $("<td>").appendTo(a),
                $('<div class="color-icon">').css({
                    backgroundColor: util.indexedColorRGBA(l, 12, 12)
                }).data("colorIndex", l).appendTo(r).click((function() {
                    var e = util.indexedColorRGBA($(this).data("colorIndex"), 12, 12);
                    i.close(),
                    t(e)
                }));
            var c = o.outerWidth(),
                d = o.outerHeight(),
                h = e.offset;
            h.top += 32,
            h.left + c > window.getWidth() && (h.left = window.getWidth() - c),
            h.top + d > window.getHeight() && (h.top = window.getHeight() - d),
            o.offset(h)
        }
        i.d(t, "a", (function() {
            return o
        })),
        o.prototype.updateUI = function() {
            var e = this.designer.selection;
            if (e) {
                if (e.setBackgroundColor ? (this.$bgColor[0].style.backgroundColor = e.backgroundColor || "", this.$bg.show()) : this.$bg.hide(), e.setBorder) {
                    var t = this.$border[0],
                        i = this.$borderColor[0];
                    t.style.backgroundColor = e.backgroundColor || "",
                    i.style.borderColor = e.borderColor || "",
                    i.style.borderWidth = e.borderWidth || "",
                    i.style.borderStyle = e.borderStyle || "",
                    i.style.borderRadius = e.borderRadius || "",
                    this.$border.show()
                } else
                    this.$border.hide();
                e.setTextColor ? (this.$text[0].style.backgroundColor = e.backgroundColor || "", this.$textColor[0].style.color = e.textColor || "", this.$text.show()) : this.$text.hide(),
                this.$el.show()
            } else
                this.$el.hide()
        },
        o.prototype.popupBorder = function() {
            var e = this,
                t = $.backplane({
                    autoClose: !0
                }),
                i = $('<div class="nx-menu-popup grey" style="width:200px">').appendTo(t),
                o = $("<div>").appendTo(i);
            $('<div class="rd-menu-label" style="width:100px">').text(locale.border).appendTo(o);
            var s = $('<div class="rd-menu-button rd-backgroundcolor">').appendTo(o).click((function() {
                    new n({
                        offset: s.offset(),
                        update: function(t) {
                            e.designer.setBorder(t, void 0, void 0, void 0),
                            u()
                        }
                    })
                })),
                a = $("<div>").appendTo(i);
            $('<div class="rd-menu-label" style="width:100px">').text(locale.width).appendTo(a);
            var r = $('<input type="number" class="rd-borderwidth">').appendTo(a).change((function() {
                    var t = Number(r.val());
                    (isNaN(t) || t <= 0) && (t = 1),
                    e.designer.setBorder(void 0, void 0, t, void 0),
                    u()
                })),
                l = $("<div>").appendTo(i);
            $('<div class="rd-menu-label" style="width:100px">').text(locale.radius).appendTo(l);
            var c = $('<input type="number" class="rd-borderradius">').appendTo(l).change((function() {
                var t = Number(c.val());
                (isNaN(t) || t <= 0) && (t = 0),
                e.designer.setBorder(void 0, void 0, void 0, t),
                u()
            }));
            u();
            var d = i.outerWidth(),
                h = i.outerHeight(),
                p = e.$border.offset();
            function u() {
                e.updateUI();
                var t = e.designer.selection;
                s[0].style.backgroundColor = t && t.borderColor || "",
                r.val(t && t.borderWidth || ""),
                c.val(t && t.borderRadius || "0"),
                t && t.borderColor ? a.show() : a.hide()
            }
            p.top += 32,
            p.left + d > window.getWidth() && (p.left = window.getWidth() - d),
            p.top + h > window.getHeight() && (p.top = window.getHeight() - h),
            i.offset(p)
        }
    },
    "./src/js/reports/Designer.jsx": function(e, t, i) {
        "use strict";
        (function(e) {
            i.d(t, "a", (function() {
                return x
            }));
            i("./node_modules/core-js/modules/web.immediate.js"),
            i("./node_modules/core-js/modules/web.url.to-json.js");
            var o = i("./src/react/util/FastClickContainer.tsx"),
                n = i("./node_modules/react/index.js"),
                s = i("./node_modules/react-dom/index.js"),
                a = i("./src/react/SimpleTabSelectionRow.tsx"),
                r = i("./src/js/reports/ActionMenu.js"),
                l = i("./src/js/reports/ObjectMenu.js"),
                c = i("./src/js/reports/PaperMenu.js"),
                d = i("./src/js/reports/ColorMenu.js"),
                h = i("./src/js/reports/TextMenu.js"),
                p = i("./src/js/reports/RDHTML.js"),
                u = i("./src/js/reports/RDImage.js"),
                f = i("./src/js/reports/RDImageField.js"),
                m = i("./src/js/reports/RDReverse.js"),
                g = i("./src/js/reports/RDText.js"),
                v = i("./src/js/admin/FunctionEditor.js"),
                b = i("./src/js/widgets/Field.js"),
                y = i("./node_modules/underscore/underscore.js"),
                w = i("./src/react/util/Track.ts");
            function x(e, t) {
                reports.designer && reports.designer.destroy(),
                this.options = t,
                this.nid = t.nid,
                this.nids = t.nids || [];
                var i = t.empty;
                this.invisible = !!(t.printOneAndClose || t.printAllAndClose || t.saveToFileAndClose);
                var o = this;
                if (this.id = e.id || util.createUUID(12), this.tid = e.tid, this.type = database.schema.types[e.tid], this.type) {
                    this.caption = e.caption || this.type.caption,
                    this.isEnabled = database.canSaveReport(),
                    this.isDirty = !1,
                    this.objects = [],
                    this.paperWidth = void 0 !== e.paperWidth ? e.paperWidth : 210,
                    this.paperHeight = void 0 !== e.paperHeight ? e.paperHeight : 297,
                    this.marginL = void 0 !== e.marginL ? e.marginL : 20,
                    this.marginR = void 0 !== e.marginR ? e.marginR : 20,
                    this.marginT = void 0 !== e.marginT ? e.marginT : 10,
                    this.marginB = void 0 !== e.marginB ? e.marginB : 10,
                    this.footHeight = void 0 !== e.footHeight ? e.footHeight : 10,
                    this.headHeight = void 0 !== e.headHeight ? e.headHeight : 10,
                    this.printAttachments = !0 === e.printAttachments,
                    this.footY = this.paperHeight - this.marginB - this.footHeight,
                    this.fontFamily = e.fontFamily || "Helvetica",
                    this.fontSize = e.fontSize || 10,
                    this.reports = [],
                    this.startSelectCallback = null,
                    this.selection = null,
                    this.multiSelection = null,
                    this.multiSelectionX = null,
                    this.multiSelectionY = null,
                    this.mode = null,
                    this.mouseState = null,
                    this.mouseDirection = null,
                    this.mouseDownX = 0,
                    this.mouseDownY = 0,
                    this.mouseObject = null,
                    this.mouseObjectX = 0,
                    this.mouseObjectY = 0,
                    this.mouseObjectW = 0,
                    this.mouseObjectH = 0,
                    this.mouseObjectOldH = 0,
                    this.snapsX = [],
                    this.snapsY = [],
                    this.setupControls(),
                    this.setupViewport(),
                    this.isEnabled && (this.actionMenu = new r.a(this), this.objectMenu = new l.a(this), this.colorMenu = new d.a(this), this.textMenu = new h.a(this), this.paperMenu = new c.a(this)),
                    this.scale = this.paperWidth / this.$paper.width(),
                    this.resize = $.proxy(this.resize, this),
                    this.resize(),
                    $(window).on("resize", this.resize);
                    var n = e.objects;
                    if (n)
                        for (var s = 0; s < n.length; s++)
                            try {
                                this.createObject(n[s])
                            } catch (e) {
                                console.log(e)
                            }
                    else
                        i || this.autoLayout();
                    $.pushInputHandler(this),
                    reports.designer = this,
                    $.loading(!0),
                    o.load((function() {
                        o.init(),
                        t.printOneAndClose ? o.printSingle((function() {
                            $.loading(!1),
                            o.destroy(),
                            "function" == typeof t.printOneAndClose && t.printOneAndClose()
                        })) : t.printAllAndClose ? o.printAll((function() {
                            $.loading(!1),
                            o.destroy(),
                            "function" == typeof t.printAllAndClose && t.printAllAndClose()
                        })) : t.saveToFileAndClose ? o.printSingleToFile((function(e, i) {
                            $.loading(!1),
                            o.destroy(),
                            "function" == typeof t.saveToFileAndClose && t.saveToFileAndClose(e, i)
                        })) : ($.loading(!1), !e.id && database.canSaveReport() ? o.saveReport((function(e) {
                            e && $.alert(e),
                            o.loadReports()
                        })) : o.loadReports())
                    })),
                    this.rightOpen = ui.fullWidth > 680,
                    this.setRight()
                }
            }
            function T(e, t) {
                var i = void 0,
                    o = !0;
                return y.each(e, (function(e) {
                    void 0 === i ? i = e[t] : i !== e[t] && (o = !1)
                })), o ? i : void 0
            }
            x.prototype.setupControls = function() {
                var e = this;
                this.$pane = $('<div class="rd-pane">').css("visibility", this.invisible ? "hidden" : "").appendTo($(document.body));
                var t = $('<div class="rd-title">').appendTo(this.$pane),
                    i = $('<div class="rd-menu">').appendTo(this.$pane);
                this.$menu = i;
                var o = $('<div class="rd-title-menu-center">').appendTo(i);
                this.$titleMenuCenter = o,
                $('<div class="i-32-24 i-white i-line-left-medium">').touch((function() {
                    e.destroyIfSaved((function() {}))
                })).appendTo($('<div style="border-right:solid 1px #FFFFFF22;margin:8px 0 8px 0;padding:0 8px 0 4px;height:32px">').appendTo(t)),
                this.$tabs = $("<div>").appendTo($('<div class="rd-tabs">').appendTo(t));
                var n = $('<div class="rd-title-buttons">').appendTo(t);
                $('<div class="nx-button-text grey" style="display:flex;display:-webkit-flex"><div class="i-32-24 i-light-grey i-setting-print" style="margin:0 4px 0 -8px"/><span>' + locale.print + "</span></div>").appendTo(n).touch(e => this.print(e)),
                n.button2({
                    icon: "i-32-24 i-white i-setting-side-menu-right",
                    click: () => this.toggleRight()
                })
            },
            x.prototype.toggleRight = function() {
                this.rightOpen = !this.rightOpen,
                this.setRight()
            },
            x.prototype.setRight = function() {
                this.rightOpen ? (this.$menu.css("display", ""), this.$viewport.css("right", "256px")) : (this.$menu.css("display", "none"), this.$viewport.css("right", "0"))
            },
            x.prototype.setupViewport = function() {
                this.$viewport = $('<div class="rd-viewport">').appendTo(this.$pane),
                this.isEnabled || (this.$menu.css("display", "none"), this.$viewport.css("right", "0")),
                this.$paper = $('<div class="rd-paper">').css({
                    "font-family": this.fontFamily,
                    "font-size": this.fontSize + "pt"
                }).appendTo(this.$viewport).click($.proxy(this.paperClicked, this)),
                this.$paper.on("mousedown touchstart", $.proxy(this.paperMousedown, this)).on("mouseup touchend", $.proxy(this.paperMouseup, this)).on("mousemove touchmove", $.proxy(this.paperMousemove, this)),
                this.$marginL = $('<div class="rd-paper-margin-l">').appendTo(this.$paper),
                this.$marginR = $('<div class="rd-paper-margin-r">').appendTo(this.$paper),
                this.$marginT = $('<div class="rd-paper-margin-t">').appendTo(this.$paper),
                this.$marginB = $('<div class="rd-paper-margin-b">').appendTo(this.$paper),
                this.$head = $('<div class="rd-paper-head">').appendTo(this.$paper),
                this.$foot = $('<div class="rd-paper-foot">').appendTo(this.$paper),
                this.$snapX = $('<div class="rd-paper-snap-x">').hide().appendTo(this.$paper),
                this.$snapY = $('<div class="rd-paper-snap-y">').hide().appendTo(this.$paper),
                this.$selector = $('<div class="rd-paper-selector">').hide().appendTo(this.$paper)
            },
            x.prototype.load = function(t) {
                var i = this.objects;
                if (!i.length)
                    return e(t);
                for (var o = 0, n = 0; n < i.length; n++)
                    i[n].load((function() {
                        ++o === i.length && e(t)
                    }))
            },
            x.prototype.init = function() {
                for (var e = y.sortBy(this.objects, "y"), t = 0; t < e.length; t++) {
                    var i = e[t];
                    if (i.init(), !i.isHead() && !i.isFoot()) {
                        var o = i.y + i.h;
                        o > this.footY && (this.footY = Math.ceil(o))
                    }
                }
                for (let t = 0; t < e.length; t++)
                    e[t].updateAutoHeight();
                this.updatePaper(),
                this.updateMenus()
            },
            x.prototype.destroy = function() {
                $(window).off("resize", this.resize),
                $.popInputHandler(this),
                this.$pane.remove(),
                this.$tabs && s.unmountComponentAtNode(this.$tabs[0]),
                reports.designer = void 0
            },
            x.prototype.destroyIfSaved = function(e) {
                var t = this;
                t.saveIfUnsaved((function(i) {
                    i && (t.destroy(), e())
                }))
            },
            x.prototype.saveIfUnsaved = function(e) {
                if (!database.canSaveReport())
                    return e(!0);
                var t = this;
                t.isDirty ? $.dialog({
                    closable: !1,
                    caption: locale.saveReport,
                    message: locale.confirmSaveReport,
                    buttons: [{
                        color: "grey float-left",
                        caption: locale.cancel,
                        callback: function() {
                            e(!1)
                        }
                    }, {
                        color: "grey",
                        caption: locale.no,
                        callback: function() {
                            e(!0)
                        }
                    }, {
                        color: "blue",
                        caption: locale.yes,
                        callback: function() {
                            t.saveReport((function(t) {
                                t && $.alert(t),
                                e(!0)
                            }))
                        }
                    }]
                }) : e(!0)
            },
            x.prototype.loadReports = function() {
                var e = this;
                database.listReports((function(t, i) {
                    var o = [];
                    y.each(util.localeSortBy(i, "caption"), (function(t) {
                        t.tid === e.type.id && o.push(t)
                    })),
                    e.reports = o,
                    e.updateUI()
                }))
            },
            x.prototype.updateUI = function() {
                if (!this.$tabs)
                    return;
                const e = this.reports.map((e, t) => ({
                    id: e.id,
                    isSelected: e.id === this.id,
                    text: e.caption
                }));
                s.render(n.createElement(a.a, {
                    popupItemBackground: "OFF_WHITE",
                    onNewItemClick: this.isEnabled ? () => this.createReport() : null,
                    items: e,
                    currentItemId: this.id,
                    onContextMenuClick: (e, t) => this.tabsContextMenu(t, e),
                    onItemSelect: (e, t) => this.tabsClicked(t, e)
                }), this.$tabs[0])
            },
            x.prototype.tabsClicked = function(e, t) {
                t === this.id ? this.popupReportMenu(t, e) : this.destroyIfSaved(() => {
                    reports.openDesigner({
                        nid: this.nid,
                        reportId: t,
                        nids: this.nids
                    })
                })
            },
            x.prototype.tabsContextMenu = function(e, t) {
                TOUCH || (this.popupReportMenu(t, e), e.preventDefault())
            },
            x.prototype.popupReportMenu = function(e, t) {
                if (this.isEnabled) {
                    var i = this,
                        n = $.backplane({
                            autoClose: !0
                        });
                    if (t) {
                        var s = $('<div class="nx-menu-popup" style="white-space:nowrap">').appendTo(n);
                        $('<div class="nx-menu-item">').text(locale.new).appendTo(s).click((function() {
                            n.close(),
                            i.createReport()
                        })),
                        e === i.id && ($('<div class="nx-menu-item">').text(locale.save).appendTo(s).click((function() {
                            n.close(),
                            i.saveReport((function(e) {
                                e && $.alert(e)
                            }))
                        })), $('<div class="nx-menu-item">').text(locale.saveAs + "...").appendTo(s).click((function() {
                            n.close(),
                            i.saveReportAs()
                        })), $('<div class="nx-menu-item">').text(locale.rename + "...").appendTo(s).click((function() {
                            n.close(),
                            i.renameReport()
                        }))),
                        $('<div class="nx-menu-item">').text(locale.remove).appendTo(s).click((function() {
                            n.close(),
                            $.dialog({
                                closable: !0,
                                caption: locale.remove,
                                message: locale.confirmRemoveFile,
                                buttons: [{
                                    color: "red",
                                    caption: locale.remove,
                                    callback: function() {
                                        i.removeReport(e)
                                    }
                                }]
                            })
                        }));
                        var a = s.outerWidth(),
                            r = s.outerHeight();
                        const l = o.b.getPosition(t),
                            c = {
                                left: l.x,
                                top: l.y
                            };
                        c.left + a > window.getWidth() && (c.left = window.getWidth() - a),
                        c.top + r > window.getHeight() && (c.top = window.getHeight() - r),
                        s.offset(c)
                    }
                }
            },
            x.prototype.setPaper = function(e, t, i, o, n, s, a, r) {
                if (e > 0 && t > 0 && r >= 0 && a >= 0 && n >= 0 && s >= 0 && i >= 0 && o >= 0 && e > i + o && t > s + n) {
                    for (var l = this.objects, c = n - this.marginT, d = n + a - (this.marginT + this.headHeight), h = i - this.marginL, p = 0; p < l.length; p++) {
                        var u = l[p];
                        u.isHead() ? u.setRect(u.x + h, u.y + c, void 0, void 0, !0) : u.isFoot() || u.setRect(u.x + h, u.y + d, void 0, void 0, !0)
                    }
                    this.marginT = n,
                    this.marginB = s,
                    this.marginL = i,
                    this.marginR = o,
                    this.paperWidth = e,
                    this.paperHeight = t,
                    this.headHeight = a,
                    this.footHeight = r,
                    this.updatePaper(),
                    this.setDirty()
                }
            },
            x.prototype.autoHeightWillChange = function(e, t, i) {
                if ("resize" !== this.mouseState) {
                    var o = this.marginT,
                        n = this.marginB,
                        s = (this.marginL, this.marginR, this.paperWidth, this.paperHeight),
                        a = this.headHeight,
                        r = this.footHeight,
                        l = this.footY,
                        c = s - n - r,
                        d = y.sortBy(this.objects, "y"),
                        h = e.y,
                        p = e.y + t,
                        u = (e.y, i - t);
                    if (!(h < o + a || h >= l)) {
                        var f = [],
                            m = null,
                            g = 1 / 0,
                            v = Math.ceil(u);
                        if (u < 0)
                            for (var b = 0; b < d.length; b++) {
                                var w = d[b];
                                if (w !== e && !w.isHead() && !w.isFoot()) {
                                    var x = w.y,
                                        T = w.y + w.h;
                                    x < p && T > p && T < g && (m = w, g = T)
                                }
                            }
                        for (let t = 0; t < d.length; t++) {
                            const i = d[t],
                                o = i.y,
                                n = i.y + i.h;
                            if (o < l && n > c && (c = Math.ceil(n)), i !== e && i !== m)
                                if (i.isHead())
                                    ;
                                else if (i.isFoot())
                                    f.push(i);
                                else if (o >= p && o < g) {
                                    var $ = o + v,
                                        C = $ + i.h;
                                    i.setRect(void 0, $, void 0, void 0, !0),
                                    C > c && (c = Math.ceil(C))
                                }
                        }
                        var k = c - l;
                        for (let e = 0; e < f.length; e++) {
                            const t = f[e];
                            t.setRect(void 0, t.y + k, void 0, void 0, !0)
                        }
                        this.footY = c
                    }
                }
            },
            x.prototype.updatePaper = function() {
                for (var e = this.objects, t = this.marginT, i = this.marginB, o = this.marginL, n = this.marginR, s = this.paperWidth, a = this.paperHeight, r = this.headHeight, l = this.footHeight, c = this.footY, d = a - i - l, h = 0; h < e.length; h++) {
                    var p = e[h];
                    if (!p.isHead() && !p.isFoot()) {
                        p.y;
                        var u = p.y + p.h;
                        u > d && (d = Math.ceil(u))
                    }
                }
                var f = d - c;
                for (let t = 0; t < e.length; t++) {
                    const i = e[t];
                    i.isFoot() && i.setRect(void 0, i.y + f)
                }
                this.footY = d,
                this.$paper.css({
                    height: d + i + l + "mm",
                    width: s + "mm"
                }),
                this.$marginL.css({
                    top: t + "mm",
                    bottom: i + "mm",
                    left: o + "mm"
                }),
                this.$marginR.css({
                    top: t + "mm",
                    bottom: i + "mm",
                    right: n + "mm"
                }),
                this.$marginT.css({
                    left: o + "mm",
                    right: n + "mm",
                    top: t + "mm"
                }),
                this.$marginB.css({
                    left: o + "mm",
                    right: n + "mm",
                    bottom: i + "mm"
                }),
                this.$head.css({
                    top: t + r + "mm",
                    left: o + "mm",
                    right: n + "mm"
                }),
                this.$foot.css({
                    bottom: i + l + "mm",
                    left: o + "mm",
                    right: n + "mm"
                })
            },
            x.prototype.autoLayout = function() {
                var e,
                    t,
                    i,
                    o = this.type.sorted,
                    n = 20,
                    s = this.paperWidth - this.marginL - this.marginR,
                    a = this.marginL,
                    r = Math.round(s / 3) - 2,
                    l = a + r + 4,
                    c = this.marginL + s - l;
                console.log("auto layout");
                for (var d = 0; d < o.length; d++)
                    "file" === (e = o[d]).base ? (t = this.createObject({
                        base: "imagefield",
                        position: "page",
                        x: a,
                        y: n,
                        w: s,
                        h: 60,
                        fid: e.id
                    }), n += Math.ceil(Math.max(0, t.h) + 2)) : "html" === e.base ? (i = this.createObject({
                        base: "text",
                        isAutoHeight: !1,
                        position: "page",
                        x: a,
                        y: n,
                        w: r,
                        h: 6,
                        text: e.caption,
                        textAlign: "right",
                        fontWeight: "bold"
                    }), t = this.createObject({
                        base: "html",
                        isAutoHeight: !0,
                        position: "page",
                        x: l,
                        y: n,
                        w: c,
                        h: 6,
                        fn: e.id
                    }), n += Math.ceil(Math.max(0, Math.max(t.h, i.h)) + 2)) : e.isField ? (i = this.createObject({
                        base: "text",
                        isAutoHeight: !1,
                        position: "page",
                        x: a,
                        y: n,
                        w: r,
                        h: 6,
                        text: e.caption,
                        textAlign: "right",
                        fontWeight: "bold"
                    }), t = this.createObject({
                        base: "text",
                        isAutoHeight: !!e.stringMultiline,
                        position: "page",
                        x: l,
                        y: n,
                        w: c,
                        h: 6,
                        text: "{" + e.id + "}"
                    }), n += Math.ceil(Math.max(0, Math.max(t.h, i.h)) + 2)) : e.isReverse ? (i = this.createObject({
                        base: "text",
                        isAutoHeight: !1,
                        position: "page",
                        x: a,
                        y: n,
                        w: s,
                        h: 6,
                        text: e.caption,
                        textAlign: "left",
                        fontWeight: "bold"
                    }), n += Math.ceil(Math.max(0, i.h)), t = this.createObject({
                        base: "rev",
                        position: "page",
                        x: a,
                        y: n,
                        w: s,
                        h: 6,
                        expression: e.id,
                        tableBorderStyle: 5
                    }), n += Math.ceil(Math.max(0, Math.max(t.h, i.h)) + 2)) : "head" !== e.base && "tab" !== e.base || (i = this.createObject({
                        base: "text",
                        isAutoHeight: !1,
                        position: "page",
                        x: a,
                        y: n,
                        w: s,
                        h: 6,
                        text: e.caption,
                        textAlign: "center",
                        fontWeight: "bold"
                    }), n += Math.ceil(Math.max(0, i.h) + 2));
                n > this.footY && (this.footY = Math.ceil(n)),
                this.createObject({
                    base: "text",
                    isAutoHeight: !1,
                    position: "head",
                    x: this.marginL,
                    y: this.marginT,
                    w: s / 3,
                    h: 6,
                    text: this.type.caption + " {_id}",
                    textAlign: "left"
                }),
                this.createObject({
                    base: "text",
                    isAutoHeight: !1,
                    position: "head",
                    x: this.paperWidth - this.marginR - s / 3,
                    y: this.marginT,
                    w: s / 3,
                    h: 6,
                    text: database.name,
                    textAlign: "right"
                }),
                this.createObject({
                    base: "text",
                    isAutoHeight: !1,
                    position: "foot",
                    x: this.marginL,
                    y: this.footY,
                    w: s / 3,
                    h: 6,
                    text: "{now()}",
                    textAlign: "left"
                }),
                this.createObject({
                    base: "text",
                    isAutoHeight: !1,
                    position: "foot",
                    x: this.paperWidth - this.marginR - s / 3,
                    y: this.footY,
                    w: s / 3,
                    h: 6,
                    text: "$page / $pages",
                    textAlign: "right"
                })
            },
            x.prototype.createAndSelectObject = function(e) {
                var t = this,
                    i = t.createObject(e);
                i && ($.loading(!0), i.load((function() {
                    i.init(),
                    i.patchAutoHeight(),
                    t.updatePaper(),
                    t.select(i),
                    t.setDirty(),
                    $.loading(!1)
                })))
            },
            x.prototype.createObject = function(e) {
                var t = null;
                switch (e.base) {
                case "rev":
                    t = new m.a(this, e);
                    break;
                case "image":
                    t = new u.a(this, e);
                    break;
                case "imagefield":
                    t = new f.a(this, e);
                    break;
                case "text":
                    t = new g.a(this, e);
                    break;
                case "html":
                    t = new p.a(this, e)
                }
                return t && this.objects.push(t), t
            },
            x.prototype.resize = function() {
                var e = this.$viewport.width(),
                    t = this.$paper.width(),
                    i = Math.max(0, Math.round((e - t) / 2));
                isNaN(i) && (i = 0),
                this.$paper[0].style.left = i + "px"
            },
            x.prototype.toJSON = function() {
                for (var e = {
                        id: this.id,
                        tid: this.tid,
                        caption: this.caption,
                        paperWidth: this.paperWidth,
                        paperHeight: this.paperHeight,
                        marginL: this.marginL,
                        marginR: this.marginR,
                        marginT: this.marginT,
                        marginB: this.marginB,
                        headHeight: this.headHeight,
                        footHeight: this.footHeight,
                        fontFamily: this.fontFamily,
                        fontSize: this.fontSize,
                        printAttachments: this.printAttachments,
                        objects: []
                    }, t = 0; t < this.objects.length; t++)
                    e.objects.push(this.objects[t].toJSON());
                return e
            },
            x.prototype.paperClicked = function(e) {},
            x.prototype.paperMousedown = function(e) {
                if (this.isEnabled) {
                    if ("edit" !== this.mouseState && this.$menu.find(":focus").blur(), e.touches)
                        if (this.mouseState) {
                            if ("down" === this.mouseState) {
                                if (1 !== e.touches.length)
                                    return this.mouseState = null, this.mouseObject = null, void (this.startSelectCallback && (this.startSelectCallback(), this.startSelectCallback = null))
                            } else if (1 !== e.touches.length)
                                return
                        } else if (1 !== e.touches.length)
                            return;
                    if ("start-select" === this.mouseState) {
                        this.mouseState = "select",
                        this.mouseDownX = e.clientX,
                        this.mouseDownY = e.clientY;
                        var t = this.$selector[0],
                            i = this.$paper.offset();
                        t.style.left = this.mouseDownX - i.left + "px",
                        t.style.top = this.mouseDownY - i.top + "px",
                        t.style.width = "0px",
                        t.style.height = "0px",
                        t.style.display = "block",
                        e.preventDefault()
                    }
                    if (!this.mouseState) {
                        var o = $(e.target),
                            n = o.closest(".rd-object").data("object");
                        this.mouseDownX = e.clientX,
                        this.mouseDownY = e.clientY,
                        n ? (this.mouseObject = n, o.is(".rd-object-resizer") ? (this.mouseState = "resize", this.mouseObjectX = this.mouseObject.x, this.mouseObjectY = this.mouseObject.y, this.mouseObjectW = this.mouseObject.w, this.mouseObjectH = this.mouseObject.h, this.mouseObjectOldH = this.mouseObjectH, this.mouseDirection = o.data("dir"), this.snapBegin()) : this.mouseState = "down", e.preventDefault()) : TOUCH || (this.mouseState = "down", this.mouseObject = null, e.preventDefault())
                    }
                }
            },
            x.prototype.paperMousemove = function(e) {
                if (this.isEnabled && (!e.touches || 1 === e.touches.length)) {
                    var t = e.clientX,
                        i = e.clientY,
                        o = t - this.mouseDownX,
                        n = i - this.mouseDownY;
                    if ("down" === this.mouseState) {
                        if (o * o + n * n > 25)
                            if (this.mouseObject)
                                if (this.multiSelection && -1 !== this.multiSelection.indexOf(this.mouseObject)) {
                                    this.mouseState = "multi-drag";
                                    for (var s = this.multiSelection, a = this.multiSelectionX = [], r = this.multiSelectionY = [], l = 0; l < s.length; l++)
                                        a[l] = s[l].x,
                                        r[l] = s[l].y
                                } else
                                    TOUCH || this.selection === this.mouseObject || this.select(this.mouseObject),
                                    this.selection === this.mouseObject && (this.mouseState = "drag", this.mouseObjectX = this.mouseObject.x, this.mouseObjectY = this.mouseObject.y, this.snapBegin());
                            else if (!TOUCH) {
                                this.mouseState = "select";
                                var c = this.$selector[0],
                                    d = this.$paper.offset();
                                c.style.left = this.mouseDownX - d.left + "px",
                                c.style.top = this.mouseDownY - d.top + "px",
                                c.style.width = "0px",
                                c.style.height = "0px",
                                c.style.display = "block"
                            }
                        e.preventDefault()
                    } else if ("drag" === this.mouseState)
                        this.mouseObject.setRect(this.mouseObjectX + o * this.scale, this.mouseObjectY + n * this.scale),
                        this.snap(),
                        this.updateObjectMenu(),
                        e.preventDefault();
                    else if ("multi-drag" === this.mouseState) {
                        const t = this.multiSelection,
                            i = this.multiSelectionX,
                            s = this.multiSelectionY;
                        for (let e = 0; e < t.length; e++)
                            t[e].setRect(i[e] + o * this.scale, s[e] + n * this.scale);
                        this.updateObjectMenu(),
                        e.preventDefault()
                    } else if ("resize" === this.mouseState) {
                        var h = this.mouseDirection,
                            p = "l" === h || "tl" === h || "bl" === h,
                            u = "r" === h || "tr" === h || "br" === h,
                            f = "t" === h || "tl" === h || "tr" === h,
                            m = "b" === h || "bl" === h || "br" === h,
                            g = p ? this.mouseObjectX + o * this.scale : void 0,
                            v = f ? this.mouseObjectY + n * this.scale : void 0,
                            b = p ? this.mouseObjectW - o * this.scale : u ? this.mouseObjectW + o * this.scale : void 0,
                            y = f ? this.mouseObjectH - n * this.scale : m ? this.mouseObjectH + n * this.scale : void 0;
                        this.rescale(this.mouseObject, g, v, b, y, !0),
                        this.snap(),
                        this.updateObjectMenu(),
                        e.preventDefault()
                    } else if ("select" === this.mouseState) {
                        const s = this.$selector[0],
                            a = this.$paper.offset();
                        var w = (o < 0 ? t : this.mouseDownX) - a.left,
                            x = (n < 0 ? i : this.mouseDownY) - a.top,
                            T = Math.abs(o),
                            $ = Math.abs(n);
                        s.style.left = w + "px",
                        s.style.top = x + "px",
                        s.style.width = T + "px",
                        s.style.height = $ + "px",
                        e.preventDefault()
                    }
                }
            },
            x.prototype.paperMouseup = function(e) {
                if (this.isEnabled && (!e.touches || !(e.touches.length > 0 || 1 !== e.changedTouches.length))) {
                    var t = e.clientX,
                        i = e.clientY,
                        o = t - this.mouseDownX,
                        n = i - this.mouseDownY,
                        s = this.mouseState,
                        a = this.mouseObject;
                    if ("down" === s) {
                        if (e.shiftKey) {
                            var r = this.multiSelection,
                                l = this.selection;
                            if (r) {
                                var c = r.indexOf(a);
                                if (-1 !== c) {
                                    const e = r.slice();
                                    e.splice(c, 1),
                                    this.multiSelect(e)
                                } else {
                                    const e = r.slice();
                                    e.push(a),
                                    this.multiSelect(e)
                                }
                            } else if (l && l !== a) {
                                var d = [l, a];
                                this.multiSelect(d)
                            }
                            this.mouseObject = null,
                            this.mouseState = null
                        } else
                            a ? a !== this.selection ? (this.select(a), this.mouseObject = null, this.mouseState = null) : a.startEdit ? (a.startEdit(), TOUCH ? (this.mouseObject = null, this.mouseState = null) : this.mouseState = "edit") : (this.mouseObject = null, this.mouseState = null) : (this.select(null), this.mouseObject = null, this.mouseState = null);
                        e.preventDefault()
                    } else if ("edit" === s) {
                        $(e.target).closest(".rd-object").data("object") !== a && this.stopEdit()
                    } else if ("drag" === s)
                        "page" === a.position ? a.y < this.marginT + this.headHeight ? a.position = "head" : a.y > this.footY && (a.position = "foot") : "head" === a.position ? a.y >= this.marginT + this.headHeight && (a.position = "page") : "foot" === a.position && a.y < this.footY && (a.position = "page"),
                        this.rescale(a, a.x, a.y, a.w, a.h, !1),
                        this.mouseObject = null,
                        this.mouseState = null,
                        this.snapDone(),
                        this.updatePaper(),
                        this.updateObjectMenu(),
                        this.setDirty(),
                        e.preventDefault();
                    else if ("multi-drag" === s)
                        this.mouseObject = null,
                        this.mouseState = null,
                        this.multiSelectionX = null,
                        this.multiSelectionY = null,
                        this.snapDone(),
                        this.updatePaper(),
                        this.updateObjectMenu(),
                        this.setDirty(),
                        e.preventDefault();
                    else if ("resize" === s)
                        this.rescale(a, a.x, a.y, a.w, a.h, !1),
                        this.mouseObject = null,
                        this.mouseState = null,
                        this.snapDone(),
                        this.updatePaper(),
                        this.updateObjectMenu(),
                        this.setDirty(),
                        e.preventDefault();
                    else if ("select" === s) {
                        this.$selector[0].style.display = "none",
                        this.mouseState = null;
                        var h = this.$paper.offset(),
                            p = (o < 0 ? t : this.mouseDownX) - h.left,
                            u = (n < 0 ? i : this.mouseDownY) - h.top,
                            f = Math.abs(o),
                            m = Math.abs(n),
                            g = p * this.scale,
                            v = u * this.scale,
                            b = (p + f) * this.scale,
                            y = (u + m) * this.scale;
                        const s = [];
                        var w = this.objects;
                        for (let e = 0; e < w.length; e++) {
                            const t = w[e];
                            var x = t.x,
                                T = t.y,
                                C = t.x + t.w,
                                k = t.y + t.h;
                            x > b || C < g || T > y || k < v || s.push(t)
                        }
                        this.multiSelect(s, e.shiftKey),
                        this.startSelectCallback && (this.startSelectCallback(), this.startSelectCallback = null),
                        e.preventDefault()
                    } else
                        this.select(null),
                        e.preventDefault()
                }
            },
            x.prototype.stopEdit = function() {
                "edit" === this.mouseState && (this.mouseObject.stopEdit(), this.mouseObject = null, this.mouseState = null, this.select(null))
            },
            x.prototype.snapBegin = function() {
                for (var e = this.mouseObject, t = this.objects, i = [0, this.marginL, this.paperWidth - this.marginR, this.paperWidth, this.marginL + (this.paperWidth - this.marginR - this.marginL) / 2], o = [0, this.marginT, this.marginT + this.headHeight, this.footY, this.footY + this.footHeight, this.footY + this.footHeight + this.marginB], n = 0; n < t.length; n++) {
                    var s = t[n];
                    e !== s && (i.push(Math.floor(s.x)), i.push(Math.round(s.x + s.w / 2)), i.push(Math.ceil(s.x + s.w)), o.push(Math.floor(s.y)), o.push(Math.round(s.y + s.h / 2)), o.push(Math.ceil(s.y + s.h)))
                }
                i.sort((function(e, t) {
                    return e - t
                })),
                o.sort((function(e, t) {
                    return e - t
                })),
                this.snapsX = i,
                this.snapsY = o
            },
            x.prototype.snapDone = function() {
                this.$snapX.hide(),
                this.$snapY.hide()
            },
            x.prototype.snap = function() {
                for (var e = .5, t = this.mouseObject, i = this.snapsX, o = t.x, n = t.x + t.w, s = t.x + t.w / 2, a = null, r = void 0, l = void 0, c = void 0, d = void 0, h = this.mouseDirection, p = "l" === h || "tl" === h || "bl" === h, u = "r" === h || "tr" === h || "br" === h, f = "t" === h || "tl" === h || "tr" === h, m = "b" === h || "bl" === h || "br" === h, g = 0; g < i.length; g++) {
                    var v = i[g];
                    if (Math.abs(o - v) < e) {
                        if ("drag" === this.mouseState) {
                            a = v,
                            r = v;
                            break
                        }
                        if ("resize" === this.mouseState && p) {
                            a = v,
                            r = v,
                            c = t.w + t.x - v;
                            break
                        }
                    }
                    if (Math.abs(s - v) < e && "drag" === this.mouseState) {
                        a = v,
                        r = v - t.w / 2;
                        break
                    }
                    if (Math.abs(n - v) < e) {
                        if ("drag" === this.mouseState) {
                            a = v,
                            r = v - t.w;
                            break
                        }
                        if ("resize" === this.mouseState && u) {
                            a = v,
                            c = v - t.x;
                            break
                        }
                    }
                }
                null !== a ? (this.$snapX[0].style.left = a + "mm", this.$snapX[0].style.display = "block") : this.$snapX[0].style.display = "none";
                var b = this.snapsY,
                    y = t.y,
                    w = t.y + t.h,
                    x = t.y + t.h / 2,
                    T = null;
                for (let i = 0; i < b.length; i++) {
                    var $ = b[i];
                    if (Math.abs(y - $) < e) {
                        if ("drag" === this.mouseState) {
                            T = $,
                            l = $;
                            break
                        }
                        if ("resize" === this.mouseState && f) {
                            T = $,
                            l = $,
                            d = t.h + t.y - $;
                            break
                        }
                    }
                    if (Math.abs(x - $) < e && "drag" === this.mouseState) {
                        T = $,
                        l = $ - t.h / 2;
                        break
                    }
                    if (Math.abs(w - $) < e) {
                        if ("drag" === this.mouseState) {
                            T = $,
                            l = $ - t.h;
                            break
                        }
                        if ("resize" === this.mouseState && m) {
                            T = $,
                            d = $ - t.y;
                            break
                        }
                    }
                }
                null !== T ? (this.$snapY[0].style.top = T + "mm", this.$snapY[0].style.display = "block") : this.$snapY[0].style.display = "none",
                this.rescale(t, r, l, c, d, !0)
            },
            x.prototype.select = function(e) {
                this.multiUnselect(),
                this.selection && this.selection.unselect(),
                this.selection = e,
                this.selection && this.selection.select(),
                this.updateMenus()
            },
            x.prototype.multiSelect = function(e, t) {
                if (t) {
                    var i = e,
                        o = this.multiSelection;
                    if (e = [], i)
                        for (let t = 0; t < i.length; t++) {
                            const o = i[t];
                            o && -1 === e.indexOf(o) && e.push(o)
                        }
                    if (o)
                        for (let t = 0; t < o.length; t++) {
                            const i = o[t];
                            i && -1 === e.indexOf(i) && e.push(i)
                        }
                }
                if (this.multiUnselect(), e && 0 !== e.length)
                    if (1 === e.length)
                        this.select(e[0]);
                    else {
                        this.select(null),
                        this.multiSelection = e;
                        for (let t = 0; t < e.length; t++)
                            e[t].multiSelect()
                    }
                else
                    this.select(null);
                this.updateMenus()
            },
            x.prototype.multiUnselect = function() {
                var e = this.multiSelection;
                if (e) {
                    for (var t = 0; t < e.length; t++)
                        e[t].multiUnselect();
                    this.multiSelection = null
                }
                this.updateMenus()
            },
            x.prototype.updateObjectMenu = function() {
                this.objectMenu && this.objectMenu.updateUI()
            },
            x.prototype.updateMenus = function() {
                this.actionMenu && this.actionMenu.updateUI(),
                this.objectMenu && this.objectMenu.updateUI(),
                this.colorMenu && this.colorMenu.updateUI(),
                this.textMenu && this.textMenu.updateUI(),
                this.paperMenu && this.paperMenu.updateUI()
            },
            x.prototype.insertObject = function(e) {
                if (this.isEnabled) {
                    var t = this,
                        i = t.marginL,
                        o = t.marginR,
                        n = t.paperWidth,
                        s = n - i - o,
                        a = n / t.$paper.width(),
                        r = (t.$viewport.scrollTop() + t.$viewport.height() / 2) * a,
                        l = Math.round(s / 2) + i,
                        c = $(e.target),
                        d = $.backplane({
                            autoClose: !0
                        }),
                        h = $('<div class="nx-menu-popup" style="max-height:' + (window.getHeight() - 64) + 'px;overflow-y:auto">').appendTo(d);
                    if ($('<div class="nx-menu-item">').append($('<div class="nx-menu-icon i-32-24 i-light-grey i-field-string">')).append($('<div class="nx-menu-label">').text(locale.text)).appendTo(h).click((function() {
                        d.close(),
                        t.createAndSelectObject({
                            base: "text",
                            isAutoHeight: !1,
                            position: "page",
                            x: l - 30,
                            y: r - 20,
                            w: 60,
                            h: 40
                        })
                    })), database.sql)
                        $('<div class="nx-menu-item">').append($('<div class="nx-menu-icon i-32-24 i-light-grey i-field-file">')).append($('<div class="nx-menu-label">').text(locale.staticImage)).appendTo(h),
                        $('<input type="file" style="display:block;margin-top:-32px;z-index:1;opacity:0;height:32px;width:100%">').appendTo(h).change((function(e) {
                            d.close(),
                            t.fileChosen(e)
                        }));
                    else
                        $('<div class="nx-menu-item">').append($('<div class="nx-menu-icon i-32-24 i-light-grey i-field-file">')).append($('<div class="nx-menu-label">').text(locale.staticImage)).appendTo(h).click((function() {
                            d.close(),
                            t.chooseFile()
                        }));
                    $('<div class="nx-menu-item">').append($('<div class="nx-menu-icon i-32-24 i-light-grey i-field-fn">')).append($('<div class="nx-menu-label">').text(locale.function)).appendTo(h).click((function() {
                        d.close(),
                        new v.a({
                            schema: t.type.schema,
                            type: t.type,
                            okay: function(e, i) {
                                if (e && i)
                                    if ("file" !== i.returnType.base || i.isMultiple())
                                        if ("html" === i.returnType.base)
                                            t.createAndSelectObject({
                                                base: "html",
                                                fn: e,
                                                isAutoHeight: !1,
                                                position: "page",
                                                x: l - 30,
                                                y: r - 20,
                                                w: 60,
                                                h: 40
                                            });
                                        else {
                                            var o = "{" + e + "}";
                                            t.createAndSelectObject({
                                                base: "text",
                                                text: o,
                                                isAutoHeight: !1,
                                                position: "page",
                                                x: l - 30,
                                                y: r - 20,
                                                w: 60,
                                                h: 40
                                            })
                                        }
                                    else
                                        t.createAndSelectObject({
                                            base: "imagefield",
                                            fid: i.toString(),
                                            position: "page",
                                            x: l - 20,
                                            y: r - 20,
                                            w: 40,
                                            h: 40
                                        })
                            },
                            cancel: function() {}
                        })
                    })),
                    $("<hr>").appendTo(h),
                    y.each(this.type.sorted, (function(e) {
                        "file" === e.base ? $('<div class="nx-menu-item">').append($('<div class="nx-menu-icon i-32-24 i-light-grey i-field-' + e.base + '">')).append($('<div class="nx-menu-label">').text(e.caption)).appendTo(h).click((function() {
                            d.close(),
                            t.createAndSelectObject({
                                base: "imagefield",
                                fid: e.id,
                                position: "page",
                                x: l - 20,
                                y: r - 20,
                                w: 40,
                                h: 40
                            })
                        })) : "html" === e.base ? $('<div class="nx-menu-item">').append($('<div class="nx-menu-icon i-32-24 i-light-grey i-field-' + e.base + '">')).append($('<div class="nx-menu-label">').text(e.caption)).appendTo(h).click((function() {
                            d.close(),
                            t.createAndSelectObject({
                                base: "html",
                                isAutoHeight: !1,
                                fn: e.id,
                                position: "page",
                                x: l - 30,
                                y: r - 20,
                                w: 60,
                                h: 40
                            })
                        })) : e.isField ? $('<div class="nx-menu-item">').append($('<div class="nx-menu-icon i-32-24 i-light-grey i-field-' + e.base + '">')).append($('<div class="nx-menu-label">').text(e.caption)).appendTo(h).click((function() {
                            d.close(),
                            "fn" === e.base && e.exp && "file" === e.exp.returnType.base && !e.exp.isMultiple() ? t.createAndSelectObject({
                                base: "imagefield",
                                fid: e.id,
                                position: "page",
                                x: l - 20,
                                y: r - 20,
                                w: 40,
                                h: 40
                            }) : t.createAndSelectObject({
                                base: "text",
                                isAutoHeight: !1,
                                text: "{" + e.id + "}",
                                position: "page",
                                x: l - 30,
                                y: r - 20,
                                w: 60,
                                h: 40
                            })
                        })) : e.isReference || e.isReverse && $('<div class="nx-menu-item">').append($('<div class="nx-menu-icon i-32-24 i-light-grey i-field-list">')).append($('<div class="nx-menu-label">').text(e.caption)).appendTo(h).click((function() {
                            d.close(),
                            t.createAndSelectObject({
                                base: "rev",
                                expression: e.id,
                                position: "page",
                                x: i,
                                y: r,
                                w: s,
                                h: 1
                            })
                        }))
                    }));
                    var p = h.outerWidth(),
                        u = h.outerHeight(),
                        f = c.offset();
                    f.top += c.outerHeight(),
                    f.left + p > window.getWidth() && (f.left = window.getWidth() - p),
                    f.top + u > window.getHeight() && (f.top = window.getHeight() - u),
                    h.offset(f)
                }
            },
            x.prototype.insertObject_PHONE = function(e) {
                if (this.isEnabled) {
                    var t = this,
                        i = t.marginL,
                        o = t.marginR,
                        n = t.paperWidth,
                        s = n - i - o,
                        a = n / t.$paper.width(),
                        r = (t.$viewport.scrollTop() + t.$viewport.height() / 2) * a,
                        l = Math.round(s / 2) + i,
                        c = [];
                    c.push({
                        caption: locale.text,
                        click: function() {
                            t.createAndSelectObject({
                                base: "text",
                                isAutoHeight: !1,
                                position: "page",
                                x: l - 30,
                                y: r - 20,
                                w: 60,
                                h: 40
                            })
                        }
                    }),
                    database.sql ? c.push({
                        caption: locale.staticImage,
                        fileChosen: function(e) {
                            t.fileChosen(e)
                        }
                    }) : (c.push({
                        caption: locale.staticImage,
                        click: function(e) {
                            t.chooseFile()
                        }
                    }), c.push({
                        caption: locale.staticImagePhoto,
                        fileChosen: function(e) {
                            t.choosePhoto(e)
                        }
                    })),
                    c.push({
                        caption: locale.function,
                        icon: "type-symbol-fn",
                        click: function() {
                            new Function({
                                schema: t.type.schema,
                                type: t.type,
                                okay: function(e) {
                                    if (e)
                                        if ("file" !== e.returnType.base || e.isMultiple())
                                            if ("html" === e.returnType.base)
                                                t.createAndSelectObject({
                                                    base: "html",
                                                    fn: e.toString(),
                                                    isAutoHeight: !1,
                                                    position: "page",
                                                    x: l - 30,
                                                    y: r - 20,
                                                    w: 60,
                                                    h: 40
                                                });
                                            else {
                                                var i = "{" + e.toString() + "}";
                                                t.createAndSelectObject({
                                                    base: "text",
                                                    text: i,
                                                    isAutoHeight: !1,
                                                    position: "page",
                                                    x: l - 30,
                                                    y: r - 20,
                                                    w: 60,
                                                    h: 40
                                                })
                                            }
                                        else
                                            t.createAndSelectObject({
                                                base: "imagefield",
                                                fid: e.toString(),
                                                position: "page",
                                                x: l - 20,
                                                y: r - 20,
                                                w: 40,
                                                h: 40
                                            })
                                },
                                cancel: function() {}
                            })
                        }
                    }),
                    y.each(this.type.sorted, (function(e) {
                        "file" === e.base ? c.push({
                            caption: e.caption,
                            icon: "type-symbol-" + e.base,
                            click: function() {
                                t.createAndSelectObject({
                                    base: "imagefield",
                                    fid: e.id,
                                    position: "page",
                                    x: l - 20,
                                    y: r - 20,
                                    w: 40,
                                    h: 40
                                })
                            }
                        }) : "html" === e.base ? c.push({
                            caption: e.caption,
                            icon: "type-symbol-" + e.base,
                            click: function() {
                                t.createAndSelectObject({
                                    base: "html",
                                    isAutoHeight: !1,
                                    fn: e.id,
                                    position: "page",
                                    x: l - 30,
                                    y: r - 20,
                                    w: 60,
                                    h: 40
                                })
                            }
                        }) : e.isField ? c.push({
                            caption: e.caption,
                            icon: "type-symbol-" + e.base,
                            click: function() {
                                "fn" === e.base && e.exp && "file" === e.exp.returnType.base && !e.exp.isMultiple() ? t.createAndSelectObject({
                                    base: "imagefield",
                                    fid: e.id,
                                    position: "page",
                                    x: l - 20,
                                    y: r - 20,
                                    w: 40,
                                    h: 40
                                }) : t.createAndSelectObject({
                                    base: "text",
                                    isAutoHeight: !1,
                                    text: "{" + e.id + "}",
                                    position: "page",
                                    x: l - 30,
                                    y: r - 20,
                                    w: 60,
                                    h: 40
                                })
                            }
                        }) : e.isReference || e.isReverse && c.push({
                            caption: e.caption,
                            icon: "type-symbol-list",
                            click: function() {
                                $backplane.close(),
                                t.createAndSelectObject({
                                    base: "rev",
                                    expression: e.id,
                                    position: "page",
                                    x: i,
                                    y: r,
                                    w: s,
                                    h: 1
                                })
                            }
                        })
                    })),
                    new Menu({
                        head: {
                            caption: locale.createUI
                        },
                        items: c
                    })
                }
            },
            x.prototype.choosePhoto = function(e) {
                if (this.isEnabled) {
                    var t = this,
                        i = t.$viewport.scrollLeft() + t.$viewport.width() / 2,
                        o = t.$viewport.scrollTop() + t.$viewport.height() / 2,
                        n = t.paperWidth / t.$paper.width(),
                        s = e.target.files;
                    if (s && 1 === s.length) {
                        var a = s[0].name,
                            r = /\.([a-zA-Z0-9]+)$/.exec(a);
                        if (!r)
                            return;
                        var l = r[1],
                            c = util.createLowerUUID(12) + "." + l;
                        database.saveReportFile(t.id, s[0], c, (function(e) {
                            if (e)
                                return $.alert(e);
                            t.createAndSelectObject({
                                base: "image",
                                file: c,
                                position: "page",
                                x: Math.round(i * n - 30),
                                y: Math.round(o * n - 20),
                                w: 60,
                                h: 40
                            })
                        }))
                    }
                }
            },
            x.prototype.fileChosen = function(e) {
                if (this.isEnabled) {
                    var t = this,
                        i = t.$viewport.scrollLeft() + t.$viewport.width() / 2,
                        o = t.$viewport.scrollTop() + t.$viewport.height() / 2,
                        n = t.paperWidth / t.$paper.width(),
                        s = e.target.files;
                    s && 1 === s.length && database.importReportFile(t.id, s[0], (function(e, s) {
                        if (e)
                            return $.alert(e);
                        t.createAndSelectObject({
                            base: "image",
                            file: s,
                            position: "page",
                            x: Math.round(i * n - 30),
                            y: Math.round(o * n - 20),
                            w: 60,
                            h: 40
                        })
                    }))
                }
            },
            x.prototype.chooseFile = function() {
                if (this.isEnabled) {
                    var e = this,
                        t = e.$viewport.scrollLeft() + e.$viewport.width() / 2,
                        i = e.$viewport.scrollTop() + e.$viewport.height() / 2,
                        o = e.paperWidth / e.$paper.width();
                    NinoxDocumentInteraction.chooseFile((function(n, s) {
                        if (n)
                            return $.alert(n);
                        s && database.importReportFile(e.id, s, (function(n, s) {
                            if (n)
                                return $.alert(n);
                            e.createAndSelectObject({
                                base: "image",
                                file: s,
                                position: "page",
                                x: Math.round(t * o - 30),
                                y: Math.round(i * o - 20),
                                w: 60,
                                h: 40
                            })
                        }))
                    }))
                }
            },
            x.prototype.rescale = function(e, t, i, o, n, s) {
                e.setRect(t, i, o, n, s)
            },
            x.prototype.getPosition = function() {
                var e = this.selection,
                    t = this.multiSelection;
                if (e)
                    return e.isHead() ? "head" : e.isFoot() ? "foot" : "page";
                if (t && t.length > 0) {
                    for (var i = t[0].isHead() ? "head" : t[0].isFoot() ? "foot" : "page", o = 1; o < t.length; o++) {
                        (t[o].isHead() ? "head" : t[o].isFoot() ? "foot" : "page") !== i && (i = "")
                    }
                    return i
                }
                return ""
            },
            x.prototype.setPosition = function(e) {
                var t = this.selection,
                    i = this.multiSelection;
                if (t)
                    t.position = e;
                else if (i && i.length > 0)
                    for (var o = 0; o < i.length; o++)
                        i[o].position = e;
                this.setDirty(),
                this.updatePaper()
            },
            x.prototype.setAutoHeight = function(e) {
                e = !0 === e;
                var t = this.selection,
                    i = this.multiSelection;
                if (t)
                    t.setAutoHeight(e);
                else
                    for (var o = 0; o < i.length; o++)
                        i[o].setAutoHeight(e);
                this.setDirty()
            },
            x.prototype.isAutoHeight = function() {
                var e = this.selection,
                    t = this.multiSelection;
                if (e)
                    return e.isAutoHeight;
                if (t && t.length > 0) {
                    for (var i = t[0].isAutoHeight, o = 1; o < t.length; o++)
                        t[o].isAutoHeight !== i && (i = void 0);
                    return i
                }
                return ""
            },
            x.prototype.getSelectedObjects = function() {
                return this.selection ? [this.selection] : this.multiSelection
            },
            x.prototype.canSetPadding = function() {
                return e = this.getSelectedObjects(), t = !0, y.each(e, (function(e) {
                    t = t && !0
                })), t;
                var e,
                    t
            },
            x.prototype.setPadding = function(e, t, i, o) {
                y.each(this.getSelectedObjects(), (function(n) {
                    n.setPadding && n.setPadding(e, t, i, o)
                })),
                this.setDirty(),
                this.updateObjectMenu()
            },
            x.prototype.getPaddingL = function() {
                return T(this.getSelectedObjects(), "paddingL")
            },
            x.prototype.getPaddingR = function() {
                return T(this.getSelectedObjects(), "paddingR")
            },
            x.prototype.getPaddingT = function() {
                return T(this.getSelectedObjects(), "paddingT")
            },
            x.prototype.getPaddingB = function() {
                return T(this.getSelectedObjects(), "paddingB")
            },
            x.prototype.setX = function(e) {
                if (!(e < 0)) {
                    var t = this.selection,
                        i = this.multiSelection;
                    if (t)
                        t.setRect(e, void 0, void 0, void 0, !0);
                    else if (i && i.length > 0) {
                        for (var o = i[0], n = 1; n < i.length; n++)
                            (t = i[n]).x < o.x && (o = t);
                        var s = e - o.x;
                        for (let e = 0; e < i.length; e++)
                            (t = i[e]).setRect(t.x + s, void 0, void 0, void 0, !0)
                    }
                    this.setDirty(),
                    this.updateObjectMenu()
                }
            },
            x.prototype.getX = function() {
                var e = this.selection,
                    t = this.multiSelection;
                if (e)
                    return e.x;
                if (t && t.length > 0) {
                    for (var i = t[0], o = 1; o < t.length; o++)
                        (e = t[o]).x < i.x && (i = e);
                    return i.x
                }
            },
            x.prototype.setY = function(e) {
                if (!(e < 0)) {
                    var t = this.selection,
                        i = this.multiSelection;
                    if (t)
                        t.setRect(void 0, e, void 0, void 0, !0);
                    else if (i && i.length > 0) {
                        for (var o = i[0], n = 1; n < i.length; n++)
                            (t = i[n]).y < o.y && (o = t);
                        var s = e - o.y;
                        for (let e = 0; e < i.length; e++)
                            (t = i[e]).setRect(void 0, t.y + s, void 0, void 0, !0)
                    }
                    this.setDirty(),
                    this.updateObjectMenu()
                }
            },
            x.prototype.getY = function() {
                let e = this.selection;
                var t = this.multiSelection;
                if (e)
                    return e.y;
                if (t && t.length > 0) {
                    for (var i = t[0], o = 1; o < t.length; o++)
                        e = t[o],
                        e.y < i.y && (i = e);
                    return i.y
                }
            },
            x.prototype.getW = function() {
                var e = this.selection,
                    t = this.multiSelection;
                if (e)
                    return e.w;
                if (t && t.length > 0) {
                    e = t[0];
                    for (var i = 1; i < t.length; i++)
                        if (t[i].w !== e.w)
                            return;
                    return e.w
                }
            },
            x.prototype.setW = function(e) {
                var t = this.selection,
                    i = this.multiSelection;
                if (t)
                    t.setRect(void 0, void 0, e, void 0, !0);
                else if (i && i.length > 0)
                    for (let t = 0; t < i.length; t++) {
                        i[t].setRect(void 0, void 0, e, void 0, !0)
                    }
                this.setDirty(),
                this.updateObjectMenu()
            },
            x.prototype.getH = function() {
                var e = this.selection,
                    t = this.multiSelection;
                if (e)
                    return e.h;
                if (t && t.length > 0) {
                    e = t[0];
                    for (var i = 1; i < t.length; i++)
                        if (t[i].h !== e.h)
                            return;
                    return e.h
                }
            },
            x.prototype.setH = function(e) {
                var t = this.selection,
                    i = this.multiSelection;
                if (t)
                    t.setRect(void 0, void 0, void 0, e, !0);
                else if (i && i.length > 0)
                    for (var o = 0; o < i.length; o++) {
                        i[o].setRect(void 0, void 0, void 0, e, !0)
                    }
                this.setDirty(),
                this.updateObjectMenu()
            },
            x.prototype.endEdit = function() {},
            x.prototype.moveToFront = function() {
                if (this.selection) {
                    var e = this.objects.indexOf(this.selection);
                    if (e < 0)
                        throw new Error("Illegal state");
                    this.objects.splice(e, 1),
                    this.objects.push(this.selection),
                    this.selection.$object.appendTo(this.$paper)
                } else if (this.multiSelection) {
                    var t = this.objects,
                        i = this.multiSelection.slice();
                    i.sort((function(e, i) {
                        return t.indexOf(e) - t.indexOf(i)
                    }));
                    for (var o = 0; o < i.length; o++) {
                        var n = i[o];
                        const e = t.indexOf(n);
                        t.splice(e, 1),
                        t.push(n),
                        n.$object.appendTo(this.$paper)
                    }
                }
                this.setDirty()
            },
            x.prototype.moveToBack = function() {
                var e = this.objects,
                    t = this.selection,
                    i = this.multiSelection;
                if (t) {
                    var o = e.indexOf(t);
                    if (o < 0)
                        throw new Error("Illegal state");
                    o > 0 && (e.splice(o, 1), e.unshift(t), t.$object.insertBefore(e[1].$object))
                } else if (i && i.length < e.length) {
                    (i = i.slice()).sort((function(t, i) {
                        return e.indexOf(i) - e.indexOf(t)
                    }));
                    for (var n = 0; n < i.length; n++) {
                        let t = i[n],
                            o = e.indexOf(t);
                        e.splice(o, 1),
                        e.unshift(t),
                        t.$object.insertBefore(e[1].$object)
                    }
                }
                this.setDirty()
            },
            x.prototype.removeSelection = function() {
                if (this.selection) {
                    var e = this.objects,
                        t = this.selection;
                    this.select(null);
                    var i = e.indexOf(t);
                    if (i < 0)
                        throw new Error("Illegal state");
                    e.splice(i, 1),
                    t.destroy()
                } else if (this.multiSelection) {
                    let e = this.objects;
                    var o = this.multiSelection;
                    this.select(null);
                    for (var n = 0; n < o.length; n++) {
                        let t = o[n],
                            i = e.indexOf(t);
                        if (i < 0)
                            throw new Error("Illegal state");
                        e.splice(i, 1),
                        t.destroy()
                    }
                }
                this.setDirty()
            },
            x.prototype.duplicate = function() {
                var e = this,
                    t = this.selection ? [this.selection] : this.multiSelection;
                if (t && t.length) {
                    var i = [];
                    $.loading(!0),
                    function() {
                        for (var n = 0; n < t.length; n++) {
                            var s = t[n].toJSON();
                            s.x += 5,
                            s.y += 5;
                            var a = e.createObject(s);
                            i.push(a)
                        }
                        !function() {
                            if (!i.length)
                                return o();
                            for (var e = 0, t = 0; t < i.length; t++)
                                i[t].load((function() {
                                    ++e === i.length && o()
                                }))
                        }()
                    }()
                }
                function o() {
                    for (var t = 0; t < i.length; t++)
                        i[t].init();
                    e.updatePaper(),
                    e.multiSelect(i),
                    e.setDirty(),
                    $.loading(!1)
                }
            },
            x.prototype.setBorder = function(e, t, i, o) {
                var n = this.selection ? [this.selection] : this.multiSelection;
                if (n) {
                    for (var s = 0; s < n.length; s++)
                        n[s].setBorder(e, t, i, o);
                    this.setDirty()
                }
            },
            x.prototype.saveReportAs = function(e) {
                var t = this,
                    i = $.popdown({
                        cls: "small"
                    });
                $('<div class="nx-section-head">').text(e ? locale.rename : locale.saveAs).appendTo(i.$pane);
                var o = $('<div class="nx-section-pane">').appendTo(i.$pane),
                    n = $('<div class="component editor editor-string" style="width:100%">').appendTo(o);
                $("<label>").text(locale.name).appendTo(n);
                var s = $('<input type="text">').val(this.caption).appendTo($('<div class="stringeditor">').appendTo(n)).keydown((function(e) {
                    13 === e.which && a(),
                    27 === e.which && r()
                }));
                function a() {
                    var i = s.val().trim();
                    if (i) {
                        r(),
                        $.loading(!0);
                        var o = t.toJSON();
                        o.caption = i,
                        e ? database.updateReport(o, (function(e) {
                            if ($.loading(!1), e)
                                return $.alert(e);
                            t.destroy(),
                            reports.openDesigner({
                                nid: t.nid,
                                reportId: o.id,
                                nids: t.nids
                            })
                        })) : (o.id = util.createUUID(12), database.updateReport(o, (function(e) {
                            if (e)
                                return $.loading(!1), $.alert(e);
                            database.copyReportFiles(t.id, o.id, (function() {
                                if ($.loading(!1), e)
                                    return $.alert(e);
                                t.destroy(),
                                reports.openDesigner({
                                    nid: t.nid,
                                    reportId: o.id,
                                    nids: t.nids
                                })
                            }))
                        })))
                    } else
                        s.focus()
                }
                function r() {
                    i.close()
                }
                $('<div class="nx-button-bar">').appendTo(o).append($('<div class="nx-button-text grey">').text(locale.cancel).touch(r)).append($('<div class="nx-hspace-flex">')).append($('<div class="nx-button-text blue">').text(locale.okay).touch(a)),
                setTimeout((function() {
                    s.focus()
                }), 400)
            },
            x.prototype.renameReport = function() {
                this.saveReportAs(!0)
            },
            x.prototype.getReportFiles = function() {
                for (var e = this.objects, t = {}, i = 0; i < e.length; i++) {
                    var o = e[i];
                    "image" === o.base && (t[o.file] = !0)
                }
                return t
            },
            x.prototype.saveReport = function(e) {
                if (!database.canSaveReport())
                    return e("Not authorized.");
                var t = this;
                $.loading(!0);
                var i = t.toJSON();
                database.cleanReportFiles(t.id, t.getReportFiles(), (function(o) {
                    o && console.log(o),
                    database.updateReport(i, (function(i) {
                        $.loading(!1),
                        t.setSaved(),
                        e(i)
                    }))
                }))
            },
            x.prototype.removeReport = function(e) {
                var t = this;
                $.loading(!0),
                database.removeReport(e, (function(i) {
                    if ($.loading(!1), i)
                        return $.alert(i);
                    e === t.id ? (t.destroy(), reports.openDesigner({
                        nid: t.nid,
                        nids: t.nids
                    })) : t.loadReports()
                }))
            },
            x.prototype.renderPaper = function(e, t) {
                var i = this.type,
                    o = schemas.ridOf(this.nid);
                e || (e = {
                    name: util.escapeFileName(i.caption + o) + ".pdf",
                    orientation: "portrait",
                    paperWidth: this.paperWidth * printer.MM,
                    paperHeight: this.paperHeight * printer.MM,
                    sections: []
                });
                var n = {
                    marginL: this.marginL * printer.MM,
                    marginR: this.marginR * printer.MM,
                    marginT: this.marginT * printer.MM,
                    marginB: this.marginB * printer.MM,
                    headHeight: this.headHeight * printer.MM,
                    footHeight: this.footHeight * printer.MM,
                    objects: []
                };
                e.sections.push(n);
                for (var s = this.objects, a = 0; a < s.length; a++)
                    n.objects.push(s[a].renderPaper());
                if (this.printAttachments) {
                    var r = this.nid,
                        l = Math.ceil(this.footY),
                        c = this.marginL,
                        d = Math.floor((this.paperWidth - this.marginL - this.marginR) / 2),
                        h = d;
                    database.loadNode(r, (function(o, s) {
                        if (o || !s)
                            return t(void 0, e);
                        for (var a = {}, p = i.sorted, u = 0; u < p.length; u++) {
                            var f = p[u];
                            if ("file" === f.base) {
                                var m = s[f.id];
                                m && (a[m] = !0)
                            }
                        }
                        console.log("LOADING FILES!!"),
                        database.loadFiles(r, (function(i, o) {
                            if (o)
                                for (var s = 0, p = l, u = 0; u < o.length; u++) {
                                    var f = o[u].name;
                                    if (!a[f] && util.RE_IMAGE_FILE_EXT.test(f)) {
                                        var m = database.downloadURL(r, f),
                                            g = s % 2 == 0 ? c : c + d;
                                        n.objects.push({
                                            base: "image",
                                            url: m,
                                            x: g * printer.MM,
                                            y: p * printer.MM,
                                            w: d * printer.MM,
                                            h: h * printer.MM,
                                            position: "page",
                                            borderWidth: .25,
                                            borderRadius: 0,
                                            borderColor: "rgb(0,0,0)",
                                            backgroundColor: null
                                        }),
                                        s % 2 == 1 && (p += h),
                                        s++
                                    }
                                }
                            t(void 0, e)
                        }))
                    }))
                } else
                    t(void 0, e);
                return e
            },
            x.prototype.print = function(e) {
                if (Object(w.f)("Form", "PrintConfirm"), this.nids && this.nids.length) {
                    var t = this,
                        i = $(e.target),
                        o = i.offset();
                    if (0 !== o.top || 0 !== o.left) {
                        var n = $.backplane({
                                autoClose: !0
                            }),
                            s = $('<div class="nx-menu-popup">').appendTo(n);
                        $('<div class="nx-menu-item">').append($('<div class="nx-menu-label">').text(locale.printOne)).appendTo(s).touch((function() {
                            m(),
                            t.printSingle()
                        })),
                        $('<div class="nx-menu-item">').append($('<div class="nx-menu-label">').text(locale.printAll + " (" + t.nids.length + ")")).appendTo(s).touch((function() {
                            m(),
                            t.nids && t.nids.length && t.printAll()
                        }));
                        var a,
                            r,
                            l = s.outerWidth(),
                            c = s.outerHeight(),
                            d = i.width(),
                            h = i.height() + 8,
                            p = Math.max(0, Math.min(o.left + Math.round((d - l) / 2), window.getWidth() - l)),
                            u = o.top + h,
                            f = o.left + Math.round(d / 2) - 12;
                        u + c > window.getHeight() ? (a = "down", r = (u = Math.max(0, o.top - c)) + c - .5) : (a = "up", r = u - 23.5),
                        s.offset({
                            left: p,
                            top: u
                        }),
                        $('<div class="marker-' + a + '" style="position:absolute;left:' + f + "px;top:" + r + 'px">').appendTo(n)
                    }
                } else
                    this.printSingle();
                function m() {
                    n.remove()
                }
            },
            x.prototype.printSingle = function(e) {
                Object(w.f)("Form", "PrintConfirmSingle"),
                NinoxPrint.previewPDFDocument_PREPARE && NinoxPrint.previewPDFDocument_PREPARE(),
                $.loading(!0),
                this.renderPaper(void 0, (function(t, i) {
                    if ($.loading(!1), t)
                        return $.alert(t);
                    NinoxPrint.previewPDFDocumentRich(i),
                    e && e()
                }))
            },
            x.prototype.printSingleToFile = function(e) {
                this.renderPaper(void 0, (function(t, i) {
                    if (t)
                        return $.alert(t);
                    NinoxPrint.savePDFDocumentRich(i, e)
                }))
            },
            x.prototype.printAll = function(t) {
                Object(w.f)("Form", "PrintConfirmAll");
                var i = this,
                    o = this.nids;
                if (o && o.length) {
                    NinoxPrint.previewPDFDocument_PREPARE && NinoxPrint.previewPDFDocument_PREPARE();
                    var n = void 0;
                    $.loading(!0),
                    e((function t(a) {
                        if (a >= o.length)
                            return e(s);
                        var r = o[a];
                        i.loadNid(r, (function(o) {
                            if (o)
                                return $.alert(o);
                            i.renderPaper(n, (function(i, o) {
                                if (i)
                                    return $.alert(i);
                                n = o,
                                e(t, a + 1)
                            }))
                        }))
                    }), 0)
                } else
                    t && t();
                function s() {
                    $.loading(!1),
                    n && (NinoxPrint.previewPDFDocumentRich(n), t && t())
                }
            },
            x.prototype.setDirty = function() {
                this.isEnabled && (this.isDirty = !0)
            },
            x.prototype.setSaved = function() {
                this.isDirty = !1
            },
            x.prototype.keydown = function(e) {
                if (this.isEnabled && e.target === document.body)
                    switch (e.which) {
                    case 8:
                        this.removeSelection(),
                        e.preventDefault();
                        break;
                    case 37:
                        this.setX(this.getX() - 1);
                        break;
                    case 38:
                        this.setY(this.getY() - 1);
                        break;
                    case 39:
                        this.setX(this.getX() + 1);
                        break;
                    case 40:
                        this.setY(this.getY() + 1);
                        break;
                    case 27:
                        this.select(null)
                    }
            },
            x.prototype.startSelect = function(e) {
                this.mouseState ? e() : (this.mouseState = "start-select", this.startSelectCallback = e)
            },
            x.prototype.createReport = function() {
                this.createReport_DESKTOP()
            },
            x.prototype.createReport_PHONE = function() {
                var e = this;
                e.saveIfUnsaved((function(t) {
                    t && new Popup({
                        caption: locale.newReport,
                        dismiss: !0,
                        init: function() {
                            var e = this;
                            e.$name = $('<input type="text" class="no-barcode">').attr("placeholder", locale.name),
                            $('<div class="editor-block no-label">').append(e.$name).appendTo(e.$pane),
                            e.autoLayout = "empty";
                            var t = $('<div class="switch-item">').text(locale.emptyLayout).click((function() {
                                    e.autoLayout = "empty",
                                    n()
                                })),
                                i = $('<div class="switch-item">').text(locale.automatic).click((function() {
                                    e.autoLayout = "auto",
                                    n()
                                })),
                                o = $('<div class="switch-item">').text(locale.duplicate).click((function() {
                                    e.autoLayout = "duplicate",
                                    n()
                                }));
                            function n() {
                                t.toggleClass("selected", "empty" === e.autoLayout),
                                i.toggleClass("selected", "auto" === e.autoLayout),
                                o.toggleClass("selected", "duplicate" === e.autoLayout)
                            }
                            $('<div class="editor-block" style="flex-wrap:wrap;-webkit-flex-wrap:wrap">').append($("<label>").text(locale.autoLayout)).append($('<div class="switch">').append(t).append(i).append(o)).appendTo(e.$pane),
                            n()
                        },
                        buttons: [{
                            caption: locale.okay,
                            cls: "blue",
                            click: function() {
                                var t = this,
                                    i = t.$name.val().trim();
                                if (i)
                                    if ("duplicate" === t.autoLayout) {
                                        var o = e.toJSON();
                                        o.caption = i,
                                        o.id = util.createUUID(12),
                                        database.updateReport(o, (function(i) {
                                            if (i)
                                                return $.loading(!1), $.alert(i);
                                            database.copyReportFiles(e.id, o.id, (function() {
                                                if ($.loading(!1), i)
                                                    return $.alert(i);
                                                t.dismiss(),
                                                e.destroy(),
                                                reports.openDesigner({
                                                    nid: e.nid,
                                                    reportId: o.id,
                                                    nids: e.nids
                                                })
                                            }))
                                        }))
                                    } else
                                        t.dismiss(),
                                        e.destroy(),
                                        reports.openDesigner({
                                            nid: e.nid,
                                            reportId: null,
                                            empty: "empty" === t.autoLayout,
                                            caption: i,
                                            nids: e.nids
                                        });
                                else
                                    t.$name.focus();
                                return !1
                            }
                        }]
                    })
                }))
            },
            x.prototype.createReport_DESKTOP = function() {
                var e = this;
                e.saveIfUnsaved((function(t) {
                    if (t) {
                        var i = $.popdown({
                            cls: "small"
                        });
                        $('<div class="nx-section-head">').text(locale.newReport).appendTo(i.$pane);
                        var o = $('<div class="nx-section-pane">').appendTo(i.$pane),
                            n = $('<div class="component editor editor-string" style="width:100%">').appendTo(o);
                        $("<label>").text(locale.name).appendTo(n);
                        var s = $('<input type="text">').appendTo($('<div class="stringeditor">').appendTo(n)).keydown((function(e) {
                                13 === e.which && l(),
                                27 === e.which && c()
                            })),
                            a = new util.SimpleModel(new schemas.TChoice(void 0, void 0, {
                                caption: locale.autoLayout,
                                required: !0,
                                formWidth: 1,
                                choiceRenderer: "switch",
                                values: {
                                    empty: {
                                        id: "empty",
                                        caption: locale.emptyLayout,
                                        order: 1
                                    },
                                    auto: {
                                        id: "auto",
                                        caption: locale.automatic,
                                        order: 2
                                    },
                                    duplicate: {
                                        id: "duplicate",
                                        caption: locale.duplicate,
                                        order: 3
                                    }
                                }
                            }), "auto"),
                            r = new b.a(void 0, a, o);
                        $('<div class="nx-button-bar">').appendTo(o).append($('<div class="nx-button-text grey">').text(locale.cancel).touch(c)).append($('<div class="nx-hspace-flex">')).append($('<div class="nx-button-text blue">').text(locale.okay).touch(l)),
                        setTimeout((function() {
                            s.focus()
                        }), 400)
                    }
                    function l() {
                        var t = s.val().trim();
                        if (t)
                            if ("duplicate" === a.value) {
                                var i = e.toJSON();
                                i.caption = t,
                                i.id = util.createUUID(12),
                                database.updateReport(i, (function(t) {
                                    if (t)
                                        return $.loading(!1), $.alert(t);
                                    database.copyReportFiles(e.id, i.id, (function() {
                                        if ($.loading(!1), t)
                                            return $.alert(t);
                                        c(),
                                        e.destroy(),
                                        reports.openDesigner({
                                            nid: e.nid,
                                            reportId: i.id,
                                            nids: e.nids
                                        })
                                    }))
                                }))
                            } else
                                c(),
                                e.destroy(),
                                reports.openDesigner({
                                    nid: e.nid,
                                    reportId: null,
                                    empty: "empty" === a.value,
                                    caption: t,
                                    nids: e.nids
                                });
                        else
                            s.focus()
                    }
                    function c() {
                        r.destroy(),
                        i.close()
                    }
                }))
            },
            x.prototype.loadNid = function(e, t) {
                this.nid = e;
                for (var i = this.objects, o = -1, n = 0; n < i.length; n++) {
                    i[n].reload(s)
                }
                function s() {
                    ++o === i.length && t()
                }
                s()
            },
            x.prototype.cutEnabled = function() {
                return !!this.selection || !!this.multiSelection && this.multiSelection.length > 0
            },
            x.prototype.cut = function() {
                var e = this.selection,
                    t = this.multiSelection,
                    i = this.objects;
                if (e) {
                    var o = "[" + JSON.stringify(e.toJSON()) + "]";
                    this.select(null);
                    var n = i.indexOf(e);
                    return n >= 0 && i.splice(n, 1), e.destroy(), this.setDirty(), o
                }
                if (t && t.length > 0) {
                    let o = "[";
                    for (var s = 0; s < t.length; s++)
                        e = t[s],
                        o += (s > 0 ? "," : "") + JSON.stringify(e.toJSON());
                    o += "]",
                    this.select(null);
                    for (let e = 0; e < t.length; e++) {
                        let o = t[e],
                            n = i.indexOf(o);
                        n >= 0 && i.splice(n, 1),
                        o.destroy()
                    }
                    return this.setDirty(), o
                }
                return ""
            },
            x.prototype.copyEnabled = function() {
                return !!this.selection || !!this.multiSelection
            },
            x.prototype.copy = function() {
                var e = this.selection,
                    t = this.multiSelection;
                if (e)
                    return "[" + JSON.stringify(e.toJSON()) + "]";
                if (t && t.length > 0) {
                    for (var i = "[", o = 0; o < t.length; o++)
                        e = t[o],
                        i += (o > 0 ? "," : "") + JSON.stringify(e.toJSON());
                    return i += "]"
                }
                return ""
            },
            x.prototype.pasteEnabled = function() {
                return !0
            },
            x.prototype.paste = function(e) {
                var t,
                    i = this;
                try {
                    t = JSON.parse(e)
                } catch (e) {}
                if (Array.isArray(t)) {
                    var o = [];
                    !function() {
                        for (var e = 0; e < t.length; e++) {
                            var s = i.createObject(t[e]);
                            s && (s.x += 5, s.y += 5, o.push(s))
                        }
                        !function() {
                            if (!o.length)
                                return n();
                            for (var e = 0, t = 0; t < o.length; t++)
                                o[t].load((function() {
                                    ++e === o.length && n()
                                }))
                        }()
                    }()
                }
                function n() {
                    for (var e = 0; e < o.length; e++)
                        o[e].init(),
                        o[e].patchAutoHeight();
                    i.updatePaper(),
                    i.multiSelect(o),
                    i.setDirty()
                }
            }
        }).call(this, i("./node_modules/node-libs-browser/node_modules/timers-browserify/main.js").setImmediate)
    },
    "./src/js/reports/ObjectMenu.js": function(e, t, i) {
        "use strict";
        i.d(t, "a", (function() {
            return n
        }));
        var o = i("./src/js/widgets/Field.js");
        function n(e) {
            var t = this;
            this.designer = e,
            this.$metrics = $('<div class="rd-menu-bar center">').hide().appendTo(e.$menu);
            var i = $("<div>").appendTo(this.$metrics);
            this.height = new util.SimpleModel(new schemas.TChoice(void 0, void 0, {
                caption: "",
                required: !0,
                values: {
                    fix: {
                        caption: locale.fixedHeight,
                        order: 1
                    },
                    auto: {
                        caption: locale.autoHeight,
                        order: 2
                    }
                }
            })),
            this.height.withoutLabel = !0,
            this.heightField = new o.a(this, this.height, i),
            this.height.on("update", (function() {
                e.setAutoHeight("auto" === t.height.value),
                t.updateUI()
            })),
            this.heightField.el.css({
                width: 240
            });
            var n = $("<div>").appendTo(this.$metrics);
            this.position = new util.SimpleModel(new schemas.TChoice(void 0, void 0, {
                caption: "",
                required: !0,
                values: {
                    head: {
                        caption: locale.pageHead,
                        order: 1
                    },
                    page: {
                        caption: locale.pageBody,
                        order: 2
                    },
                    foot: {
                        caption: locale.pageFoot,
                        order: 3
                    }
                }
            })),
            this.position.withoutLabel = !0,
            this.positionField = new o.a(this, this.position, n),
            this.position.on("update", (function() {
                e.setPosition(t.position.value),
                t.updateUI()
            })),
            this.positionField.el.css({
                width: 240
            }),
            $('<div class="rd-menu-head">').text(locale.position).appendTo(this.$metrics),
            $('<div class="rd-metrics-label">').text("x").appendTo(this.$metrics);
            var s = this.$x = $('<input type="number" class="rd-metrics">').appendTo(this.$metrics).change((function() {
                e.setX(s.val()),
                t.updateUI()
            }));
            $('<div class="rd-metrics-label">').text("y").appendTo(this.$metrics);
            var a = this.$y = $('<input type="number" class="rd-metrics">').appendTo(this.$metrics).change((function() {
                e.setY(a.val()),
                t.updateUI()
            }));
            $('<div class="rd-metrics-label">').text("↔︎").appendTo(this.$metrics);
            var r = this.$w = $('<input type="number" class="rd-metrics">').appendTo(this.$metrics).change((function() {
                e.setW(r.val()),
                t.updateUI()
            }));
            $('<div class="rd-metrics-label">').text("↕︎").appendTo(this.$metrics);
            var l = this.$h = $('<input type="number" class="rd-metrics">').appendTo(this.$metrics).change((function() {
                e.setH(l.val()),
                t.updateUI()
            }));
            this.$padding = $("<div>").hide().appendTo(this.$metrics),
            $('<div class="rd-menu-head">').text(locale.padding).appendTo(this.$padding),
            $('<div class="rd-metrics-label">').text("↑").appendTo(this.$padding),
            this.$pt = $('<input type="number" class="rd-metrics">').appendTo(this.$padding).change((function() {
                t.updatePaddingT()
            })),
            $('<div class="rd-metrics-label">').text("↓").appendTo(this.$padding),
            this.$pb = $('<input type="number" class="rd-metrics">').appendTo(this.$padding).change((function() {
                t.updatePaddingB()
            })),
            $('<div class="rd-metrics-label">').text("←").appendTo(this.$padding),
            this.$pl = $('<input type="number" class="rd-metrics">').appendTo(this.$padding).change((function() {
                t.updatePaddingL()
            })),
            $('<div class="rd-metrics-label">').text("→").appendTo(this.$padding),
            this.$pr = $('<input type="number" class="rd-metrics">').appendTo(this.$padding).change((function() {
                t.updatePaddingR()
            })),
            this.updateUI()
        }
        function s(e) {
            return null == e || isNaN(e) ? null : Math.round(100 * e) / 100
        }
        function a(e) {
            if (e) {
                var t = Number(e);
                return t > 0 ? t : 0
            }
        }
        n.prototype.updateUI = function() {
            var e = this.designer,
                t = e.selection,
                i = e.multiSelection;
            if (t || i) {
                var o = this.designer.isAutoHeight();
                this.height.value = !0 === o ? "auto" : !1 === o ? "fix" : void 0,
                this.heightField.editor.load(),
                this.position.value = this.designer.getPosition(),
                this.positionField.editor.load(),
                this.$x.val(s(this.designer.getX())),
                this.$y.val(s(this.designer.getY())),
                this.$w.val(s(this.designer.getW())),
                this.$h.val(s(this.designer.getH())),
                this.$metrics.show()
            } else
                this.$metrics.hide();
            e.canSetPadding() ? (this.$pl.val(e.getPaddingL() || ""), this.$pr.val(e.getPaddingR() || ""), this.$pt.val(e.getPaddingT() || ""), this.$pb.val(e.getPaddingB() || ""), this.$padding.show()) : this.$padding.hide()
        },
        n.prototype.updatePaddingL = function() {
            this.designer.setPadding(a(this.$pl.val()))
        },
        n.prototype.updatePaddingR = function() {
            this.designer.setPadding(void 0, a(this.$pr.val()), void 0, void 0)
        },
        n.prototype.updatePaddingT = function() {
            this.designer.setPadding(void 0, void 0, a(this.$pt.val()), void 0)
        },
        n.prototype.updatePaddingB = function() {
            this.designer.setPadding(void 0, void 0, void 0, a(this.$pb.val()))
        }
    },
    "./src/js/reports/PaperMenu.js": function(e, t, i) {
        "use strict";
        i.d(t, "a", (function() {
            return n
        }));
        var o = i("./src/js/widgets/Field.js");
        function n(e) {
            var t = this;
            this.designer = e,
            this.$el = $('<div class="rd-menu-bar center">').hide().appendTo(e.$menu);
            var i = this.format = new util.SimpleModel(new schemas.TChoice(void 0, void 0, {
                caption: locale.paperFormat,
                required: !0,
                values: {
                    custom: {
                        id: "custom",
                        caption: locale.custom,
                        order: 1
                    },
                    "297x420": {
                        id: "297x420",
                        caption: "DIN A3 ↕︎",
                        order: 2
                    },
                    "210x297": {
                        id: "210x297",
                        caption: "DIN A4 ↕︎",
                        order: 3
                    },
                    "148x210": {
                        id: "148x210",
                        caption: "DIN A5 ↕︎",
                        order: 4
                    },
                    "420x297": {
                        id: "420x297",
                        caption: "DIN A3 ↔︎",
                        order: 5
                    },
                    "297x210": {
                        id: "297x210",
                        caption: "DIN A4 ↔︎",
                        order: 6
                    },
                    "210x148": {
                        id: "210x148",
                        caption: "DIN A5 ↔︎",
                        order: 7
                    },
                    "140x216": {
                        id: "140x216",
                        caption: "Invoice",
                        order: 8
                    },
                    "184x267": {
                        id: "184x267",
                        caption: "Executive",
                        order: 9
                    },
                    "216x356": {
                        id: "216x356",
                        caption: "Legal",
                        order: 10
                    },
                    "216x279": {
                        id: "216x279",
                        caption: "Letter",
                        order: 11
                    }
                }
            }));
            i.value = "custom",
            (this.formatField = new o.a(this, i, this.$el)).el.css({
                width: 240,
                margin: "0 0 8px 0",
                "vertical-align": "baseline"
            }),
            i.on("update", (function() {
                var e = i.value;
                if ("custom" !== e) {
                    var o = e.split("x"),
                        n = Number(o[0]),
                        s = Number(o[1]);
                    t.$pw.val(n),
                    t.$ph.val(s),
                    t.updatePaper()
                }
            })),
            $("<br>").appendTo(this.$el),
            $('<div class="rd-metrics-label">︎').text("↔︎").appendTo(this.$el),
            this.$pw = $('<input type="number" class="rd-metrics">').appendTo(this.$el).change((function() {
                t.updatePaper()
            })),
            $('<div class="rd-metrics-label">').text("↕︎").appendTo(this.$el),
            this.$ph = $('<input type="number" class="rd-metrics">').appendTo(this.$el).change((function() {
                t.updatePaper()
            })),
            $('<div class="rd-menu-head">').text(locale.headFoot).appendTo(this.$el),
            $('<div class="rd-metrics-label">').text("↑").appendTo(this.$el),
            this.$head = $('<input type="number" class="rd-metrics">').appendTo(this.$el).change((function() {
                t.updatePaper()
            })),
            $('<div class="rd-metrics-label">').text("↓").appendTo(this.$el),
            this.$foot = $('<input type="number" class="rd-metrics">').appendTo(this.$el).change((function() {
                t.updatePaper()
            })),
            $('<div class="rd-menu-head">').text(locale.margins).appendTo(this.$el),
            $('<div class="rd-metrics-label">').text("↑").appendTo(this.$el),
            this.$mt = $('<input type="number" class="rd-metrics">').appendTo(this.$el).change((function() {
                t.updatePaper()
            })),
            $('<div class="rd-metrics-label">').text("↓").appendTo(this.$el),
            this.$mb = $('<input type="number" class="rd-metrics">').appendTo(this.$el).change((function() {
                t.updatePaper()
            })),
            $('<div class="rd-metrics-label">').text("←").appendTo(this.$el),
            this.$ml = $('<input type="number" class="rd-metrics">').appendTo(this.$el).change((function() {
                t.updatePaper()
            })),
            $('<div class="rd-metrics-label">').text("→").appendTo(this.$el),
            this.$mr = $('<input type="number" class="rd-metrics">').appendTo(this.$el).change((function() {
                t.updatePaper()
            }));
            var n = this.printFiles = new util.SimpleModel(new schemas.TBoolean(void 0, void 0, {
                required: !0,
                caption: locale.printAttachments,
                booleanRenderer: "check"
            }));
            n.value = this.designer.printAttachments,
            n.withoutLabel = !0,
            (this.printAttachmentsField = new o.a(this, n, this.$el)).el.css({
                width: 240,
                margin: "0 0 8px 0",
                "vertical-align": "baseline",
                "text-align": "left"
            }),
            n.on("update", (function() {
                t.designer.printAttachments = n.value
            }))
        }
        n.prototype.updateUI = function() {
            var e = this.designer;
            if (e.selection || e.multiSelection)
                this.$el.hide();
            else {
                var t = e.paperWidth + "x" + e.paperHeight,
                    i = this.format.field.values[t];
                this.format.value = i ? i.id : "custom",
                this.formatField.editor.load(),
                this.$pw.val(e.paperWidth),
                this.$ph.val(e.paperHeight),
                this.$head.val(e.headHeight),
                this.$foot.val(e.footHeight),
                this.$mt.val(e.marginT),
                this.$mb.val(e.marginB),
                this.$ml.val(e.marginL),
                this.$mr.val(e.marginR),
                this.$el.show()
            }
        },
        n.prototype.updatePaper = function() {
            this.designer.setPaper(Number(this.$pw.val()), Number(this.$ph.val()), Number(this.$ml.val()), Number(this.$mr.val()), Number(this.$mt.val()), Number(this.$mb.val()), Number(this.$head.val()), Number(this.$foot.val())),
            this.updateUI()
        }
    },
    "./src/js/reports/RDHTML.js": function(e, t, i) {
        "use strict";
        i.d(t, "a", (function() {
            return a
        }));
        i("./node_modules/core-js/modules/web.url.to-json.js");
        var o = i("./src/js/reports/RDObject.js"),
            n = i("./src/js/admin/FunctionEditor.js"),
            s = i("./node_modules/@ninox/ninox-core/dist/ninox-core.es5.js");
        function a(e, t) {
            o.a.call(this, e, t),
            this.fn = t.fn,
            this.verticalAlign = t.verticalAlign || null,
            this.paddingL = t.paddingL || 0,
            this.paddingR = t.paddingR || 0,
            this.paddingT = t.paddingT || 0,
            this.paddingB = t.paddingB || 0;
            var i = null;
            try {
                i = queries.parseSystem(e.type.schema, e.type, this.fn, {})
            } catch (e) {}
            this.exp = i,
            this.html = "",
            this.$wrap = null,
            this.$text = null
        }
        Object.assign(a.prototype, o.a.prototype),
        a.prototype.base = "html",
        a.prototype.toJSON = function() {
            return Object.assign(o.a.prototype.toJSON.apply(this), {
                base: "html",
                isAutoHeight: this.isAutoHeight || !1,
                fn: this.fn,
                verticalAlign: this.verticalAlign,
                paddingL: this.paddingL,
                paddingR: this.paddingR,
                paddingT: this.paddingT,
                paddingB: this.paddingB
            })
        },
        a.prototype.reload = function(e) {
            var t = this;
            t.load((function() {
                t.$text.html(t.html),
                e()
            }))
        },
        a.prototype.load = function(e) {
            var t = this,
                i = this.exp;
            if (!i)
                return e();
            var o = this.designer.nid;
            if (!o)
                return e();
            var n = database.loadNodeSync(o);
            if (!n)
                return e();
            i.evaluate(database, n, (function(i, o) {
                t.html = o || "",
                i && console.log("RDHTML.load err", i),
                e()
            }))
        },
        a.prototype.init = function() {
            o.a.prototype.init.call(this),
            this.$wrap = $('<div class="rd-object-html-wrap">').css({
                "-webkit-align-items": "middle" === this.verticalAlign ? "center" : "bottom" === this.verticalAlign ? "flex-end" : "flex-start",
                "align-items": "middle" === this.verticalAlign ? "center" : "bottom" === this.verticalAlign ? "flex-end" : "flex-start"
            }).appendTo(this.$object),
            this.$text = $('<div class="rd-object-html-html">').css({
                "padding-left": this.paddingL ? this.paddingL + "mm" : "",
                "padding-right": this.paddingR ? this.paddingR + "mm" : "",
                "padding-top": this.paddingT ? this.paddingT + "mm" : "",
                "padding-bottom": this.paddingB ? this.paddingB + "mm" : ""
            }).appendTo(this.$wrap).html(this.html)
        },
        a.prototype.renderPaper = function() {
            return Object.assign(o.a.prototype.renderPaper.apply(this, arguments), {
                base: "text",
                text: this.html,
                verticalAlign: this.verticalAlign || "top",
                isHTML: !0,
                dynamicHeight: this.isAutoHeight || !1,
                paddingL: (this.paddingL || 0) * printer.MM,
                paddingR: (this.paddingR || 0) * printer.MM,
                paddingT: (this.paddingT || 0) * printer.MM,
                paddingB: (this.paddingB || 0) * printer.MM,
                textDecoration: "",
                fontStyle: "",
                fontWeight: "",
                lineHeight: 1
            })
        },
        a.prototype.setPadding = function(e, t, i, o) {
            void 0 !== e && (this.paddingL = e || 0),
            void 0 !== t && (this.paddingR = t || 0),
            void 0 !== i && (this.paddingT = i || 0),
            void 0 !== o && (this.paddingB = o || 0),
            this.$text.css({
                "padding-left": this.paddingL ? this.paddingL + "mm" : "",
                "padding-right": this.paddingR ? this.paddingR + "mm" : "",
                "padding-top": this.paddingT ? this.paddingT + "mm" : "",
                "padding-bottom": this.paddingB ? this.paddingB + "mm" : ""
            })
        },
        a.prototype.setVerticalAlign = function(e) {
            this.verticalAlign = e || null,
            this.$wrap.css({
                "-webkit-align-items": "middle" === this.verticalAlign ? "center" : "bottom" === this.verticalAlign ? "flex-end" : "flex-start",
                "align-items": "middle" === this.verticalAlign ? "center" : "bottom" === this.verticalAlign ? "flex-end" : "flex-start"
            }),
            this.designer.setDirty()
        },
        a.prototype.startEdit = function() {
            const e = this,
                t = e.designer;
            new n.a({
                value: e.exp.toHumanString(),
                schema: e.designer.type.schema,
                type: e.designer.type,
                okay: function(i, o) {
                    if ("html" === o.returnType.base) {
                        const i = {
                            base: "html",
                            position: e.position,
                            x: e.x,
                            y: e.y,
                            w: e.w,
                            h: e.h,
                            fn: o.toString()
                        };
                        t.removeSelection(),
                        t.createAndSelectObject(i)
                    } else
                        $.alert(Object(s.getLocale)().typeMissmatchHtml);
                    t.mouseState = null
                },
                cancel: function() {
                    t.mouseState = null
                }
            })
        }
    },
    "./src/js/reports/RDImage.js": function(e, t, i) {
        "use strict";
        i.d(t, "a", (function() {
            return n
        }));
        i("./node_modules/core-js/modules/web.url.to-json.js");
        var o = i("./src/js/reports/RDObject.js");
        function n(e, t) {
            t.isAutoHeight = !1,
            o.a.call(this, e, t),
            this.file = t.file || null,
            this.printUrl = this.file ? database.reportFileURL(this.designer.id, this.file) : "",
            this.previewUrl = this.file ? database.reportFileURLProxy(this.designer.id, this.file) : "",
            this.img = null
        }
        Object.assign(n.prototype, o.a.prototype),
        n.prototype.base = "image",
        n.prototype.setAutoHeight = function() {},
        n.prototype.setFontFamily = void 0,
        n.prototype.setFontSize = void 0,
        n.prototype.setTextAlign = void 0,
        n.prototype.setVerticalAlign = void 0,
        n.prototype.setTextColor = void 0,
        n.prototype.toJSON = function() {
            return Object.assign(o.a.prototype.toJSON.apply(this), {
                file: this.file
            })
        },
        n.prototype.load = function(e) {
            var t = this;
            t.img = null;
            var i = new Image;
            i.src = t.previewUrl,
            i.complete ? (t.img = i, e()) : (i.onload = function() {
                t.img = i,
                e()
            }, i.onerror = function() {
                e()
            })
        },
        n.prototype.init = function() {
            console.log("RDImage.init"),
            o.a.prototype.init.call(this),
            this.$img = $('<img style="width:100%">').appendTo(this.$object),
            this.$img[0].src = this.img ? this.img.src : ""
        },
        n.prototype.renderPaper = function() {
            return Object.assign(o.a.prototype.renderPaper.apply(this, arguments), {
                base: "image",
                url: this.printUrl,
                verticalAlign: "top"
            })
        }
    },
    "./src/js/reports/RDImageField.js": function(e, t, i) {
        "use strict";
        i.d(t, "a", (function() {
            return a
        }));
        i("./node_modules/core-js/modules/web.url.to-json.js");
        var o = i("./src/js/reports/RDObject.js"),
            n = i("./src/js/admin/FunctionEditor.js"),
            s = i("./node_modules/@ninox/ninox-core/dist/ninox-core.es5.js");
        i("./src/js/reports/RDImage.js");
        function a(e, t) {
            t.isAutoHeight = !1,
            o.a.call(this, e, t),
            this.fid = t.fid,
            this.exp = void 0;
            var i = e.type;
            try {
                var n = queries.parseSystem(i.schema, i, this.fid, {}, !1);
                n.isMultiple() || n.isUpdating() || "file" !== n.returnType.base || (this.exp = n)
            } catch (e) {}
            this.previewURL = "",
            this.renderURL = "",
            this.img = null,
            this.$img = null
        }
        Object.assign(a.prototype, o.a.prototype),
        a.prototype.base = "imagefield",
        a.prototype.setAutoHeight = function() {},
        a.prototype.setTextAlign = void 0,
        a.prototype.setTextColor = void 0,
        a.prototype.load = function(e) {
            var t = this;
            if (!t.exp)
                return e();
            var i = t.designer.nid;
            if (!i)
                return e();
            database.loadNode(i, (i, o) => {
                if (!o)
                    return e();
                t.img = null,
                t.previewURL = "",
                t.renderURL = "",
                t.exp.evaluate(database, o, (function(i, o) {
                    t.val = o,
                    o && (t.previewURL = database.fileURL1(o), t.renderURL = database.downloadURL1(o));
                    var n = new Image;
                    n.src = t.previewURL,
                    n.complete ? (t.img = n, e()) : (n.onload = function() {
                        t.img = n,
                        e()
                    }, n.onerror = function() {
                        e()
                    })
                }))
            })
        },
        a.prototype.init = function() {
            o.a.prototype.init.call(this),
            this.$img = $('<img style="width:100%">').appendTo(this.$object),
            this.$img[0].src = this.img ? this.img.src : ""
        },
        a.prototype.reload = function(e) {
            var t = this;
            t.load((function() {
                t.$img[0].src = t.img ? t.img.src : "",
                e()
            }))
        },
        a.prototype.toJSON = function() {
            return Object.assign(o.a.prototype.toJSON.apply(this), {
                fid: this.fid
            })
        },
        a.prototype.renderPaper = function() {
            return Object.assign(o.a.prototype.renderPaper.apply(this, arguments), {
                base: "image",
                url: this.renderURL
            })
        },
        a.prototype.startEdit = function() {
            const e = this,
                t = e.designer;
            new n.a({
                value: e.exp.toHumanString(),
                schema: e.designer.type.schema,
                type: e.designer.type,
                okay: function(i, o) {
                    if ("file" === o.returnType.base) {
                        const i = {
                            base: "imagefield",
                            position: e.position,
                            x: e.x,
                            y: e.y,
                            w: e.w,
                            h: e.h,
                            fid: o.toString()
                        };
                        t.removeSelection(),
                        t.createAndSelectObject(i)
                    } else
                        $.alert(Object(s.getLocale)().typeMissmatchImage);
                    t.mouseState = null
                },
                cancel: function() {
                    t.mouseState = null
                }
            })
        }
    },
    "./src/js/reports/RDObject.js": function(e, t, i) {
        "use strict";
        i.d(t, "a", (function() {
            return o
        }));
        i("./node_modules/core-js/modules/web.url.to-json.js");
        function o(e, t) {
            this.designer = e,
            this.isAutoHeight = !0 === t.isAutoHeight,
            this.x = t.x || 0,
            this.y = t.y || 0,
            this.w = t.w || 0,
            this.h = t.h || 0,
            this.position = t.position,
            this.position || (this.y < e.marginT + e.headHeight ? this.position = "head" : this.y >= e.paperHeight - e.footHeight - e.marginB ? this.position = "foot" : this.position = "page"),
            this.backgroundColor = t.backgroundColor || null,
            this.borderColor = t.borderColor || null,
            this.borderWidth = t.borderWidth || null,
            this.borderStyle = t.borderStyle || null,
            this.borderRadius = t.borderRadius || null,
            this.textColor = t.textColor || null,
            this.textAlign = t.textAlign || null,
            this.fontFamily = t.fontFamily || null,
            this.fontSize = t.fontSize || null,
            this.selected = !1,
            this.multiSelected = !1
        }
        o.prototype.isAutoHeight = !1,
        o.prototype.base = "object",
        o.prototype.toJSON = function() {
            return {
                base: this.base,
                x: this.x,
                y: this.y,
                w: this.w,
                h: this.h,
                position: this.position,
                backgroundColor: this.backgroundColor,
                borderColor: this.borderColor,
                borderWidth: this.borderWidth,
                borderStyle: this.borderStyle,
                borderRadius: this.borderRadius,
                textColor: this.textColor,
                textAlign: this.textAlign,
                fontFamily: this.fontFamily,
                fontSize: this.fontSize
            }
        },
        o.prototype.reload = function(e) {
            e()
        },
        o.prototype.isHead = function() {
            return "head" === this.position
        },
        o.prototype.isFoot = function() {
            return "foot" === this.position
        },
        o.prototype.renderPaper = function() {
            var e = this.isHead() || this.isFoot() ? "head" : "page",
                t = this.isFoot() ? this.y - this.designer.footY + this.designer.paperHeight - this.designer.marginB - this.designer.footHeight : this.y;
            return {
                position: e,
                x: this.x * printer.MM,
                y: t * printer.MM,
                w: this.w * printer.MM,
                h: this.h * printer.MM,
                backgroundColor: this.backgroundColor,
                borderColor: this.borderColor,
                borderWidth: this.borderWidth || 0,
                borderStyle: this.borderStyle || 0,
                borderRadius: (this.borderRadius || 0) * printer.MM,
                textColor: this.textColor,
                textAlign: this.textAlign,
                fontFamily: this.getFontFamily(),
                fontSize: this.getFontSize()
            }
        },
        o.prototype.destroy = function() {
            this.$object.remove()
        },
        o.prototype.load = function(e) {
            e()
        },
        o.prototype.init = function() {
            var e = this.designer;
            this.$object = $('<div class="rd-object rd-object-' + this.base + '">').data("object", this).appendTo(e.$paper).css({
                "background-color": this.backgroundColor || "",
                "border-color": this.borderColor || "",
                color: this.textColor || "",
                "text-align": this.textAlign || "",
                "font-family": this.fontFamily || "",
                "font-size": this.fontSize ? this.fontSize + "pt" : ""
            });
            var t = this.$object[0];
            t.style.left = this.x + "mm",
            t.style.top = this.y + "mm",
            t.style.width = this.w + "mm",
            this.isAutoHeight ? (t.style.height = "auto", this.$object.addClass("auto")) : t.style.height = this.h + "mm",
            this.updateBorder()
        },
        o.prototype.setRect = function(e, t, i, o, n) {
            var s = this.$object[0];
            void 0 !== e && (e = Number(e), e = n ? e : Math.round(e), (isNaN(e) || e < 0) && (e = 0), this.x = e, s.style.left = e + "mm"),
            void 0 !== t && (t = Number(t), t = n ? t : Math.round(t), (isNaN(t) || t < 0) && (t = 0), this.y = t, s.style.top = t + "mm"),
            void 0 !== i && (i = Number(i), i = n ? i : Math.round(i), (isNaN(i) || i < 1) && (i = 1), this.w = i, this.widthChanged(n), s.style.width = i + "mm", this.isAutoHeight && this.updateAutoHeight()),
            this.isAutoHeight || void 0 !== o && (o = Number(o), o = n ? o : Math.round(o), (isNaN(o) || o < 1) && (o = 1), this.h = o, s.style.height = o + "mm")
        },
        o.prototype.widthChanged = function(e) {},
        o.prototype.patchAutoHeight = function() {
            if (this.isAutoHeight) {
                var e = this.h,
                    t = this.$object[0].offsetHeight * this.designer.scale;
                e !== t && (this.h = t)
            }
        },
        o.prototype.updateAutoHeight = function() {
            if (this.isAutoHeight) {
                var e = this.h,
                    t = this.$object[0].offsetHeight * this.designer.scale;
                e !== t && (this.designer.autoHeightWillChange(this, e, t), this.h = t, this.designer.updatePaper())
            }
        },
        o.prototype.setAutoHeight = function(e) {
            (e = !0 === e) !== this.isAutoHeight && (e ? (this.$object[0].style.height = "auto", this.$object.addClass("auto")) : (this.$object[0].style.height = this.h + "mm", this.$object.removeClass("auto")), this.isAutoHeight = e, this.updateAutoHeight(), this.designer.setDirty())
        },
        o.prototype.select = function() {
            this.selected || (this.selected = !0, this.$object.addClass("selected"), this.showResizers(), this._select())
        },
        o.prototype._select = function() {},
        o.prototype.unselect = function() {
            this.selected && (this.selected = !1, this.$object.removeClass("selected"), this.hideResizers(), this._unselect())
        },
        o.prototype._unselect = function() {},
        o.prototype.multiSelect = function() {
            this.multiSelected || (this.multiSelected = !0, this.$object.addClass("multi-selected"), this.showResizers())
        },
        o.prototype.multiUnselect = function() {
            this.multiSelected && (this.multiSelected = !1, this.$object.removeClass("multi-selected"), this.hideResizers())
        },
        o.prototype.showResizers = function() {
            $('<div class="rd-object-resizer top">').data("dir", "t").appendTo(this.$object),
            $('<div class="rd-object-resizer bottom">').data("dir", "b").appendTo(this.$object),
            $('<div class="rd-object-resizer left">').data("dir", "l").appendTo(this.$object),
            $('<div class="rd-object-resizer right">').data("dir", "r").appendTo(this.$object),
            $('<div class="rd-object-resizer top-left">').data("dir", "tl").appendTo(this.$object),
            $('<div class="rd-object-resizer top-right">').data("dir", "tr").appendTo(this.$object),
            $('<div class="rd-object-resizer bottom-left">').data("dir", "bl").appendTo(this.$object),
            $('<div class="rd-object-resizer bottom-right">').data("dir", "br").appendTo(this.$object)
        },
        o.prototype.hideResizers = function() {
            this.$object.children(".rd-object-resizer").remove()
        },
        o.prototype.setBackgroundColor = function(e) {
            this.backgroundColor = e,
            this.$object.css("background-color", e || ""),
            this.designer.setDirty()
        },
        o.prototype.setBorderColor = function(e) {
            this.borderColor = e,
            this.updateBorder(),
            this.designer.setDirty()
        },
        o.prototype.setTextColor = function(e) {
            this.textColor = e,
            this.$object.css("color", e || ""),
            this.designer.setDirty()
        },
        o.prototype.setTextAlign = function(e) {
            this.textAlign = e || null,
            this.$object.css("text-align", e || ""),
            this.updateAutoHeight(),
            this.designer.setDirty()
        },
        o.prototype.setFontFamily = function(e) {
            e === this.designer.fontFamily && (e = null),
            this.fontFamily = e || null,
            this.$object.css("font-family", e || ""),
            this.updateAutoHeight(),
            this.designer.setDirty()
        },
        o.prototype.setFontSize = function(e) {
            e === this.designer.fontSize && (e = null),
            this.fontSize = e || null,
            this.$object.css("font-size", e ? e + "pt" : ""),
            this.fontChanged(),
            this.updateAutoHeight(),
            this.designer.setDirty()
        },
        o.prototype.getFontFamily = function() {
            return this.fontFamily || this.designer.fontFamily
        },
        o.prototype.getFontSize = function() {
            return this.fontSize || this.designer.fontSize
        },
        o.prototype.setBorder = function(e, t, i, o) {
            void 0 !== e && (this.borderColor = e),
            void 0 !== t && (this.borderStyle = t),
            void 0 !== i && (this.borderWidth = i),
            void 0 !== o && (this.borderRadius = o),
            this.updateBorder(),
            this.boundsChanged(),
            this.updateAutoHeight(),
            this.designer.setDirty()
        },
        o.prototype.updateBorder = function() {
            this.borderColor ? (this.borderWidth || (this.borderWidth = 1), this.borderStyle || (this.borderStyle = "solid"), this.$object.css({
                "border-color": this.borderColor,
                "border-style": this.borderStyle,
                "border-width": this.borderWidth + "pt"
            })) : (this.borderWidth = null, this.borderStyle = null, this.$object.css({
                "border-color": "",
                "border-style": "",
                "border-width": ""
            })),
            this.$object.css({
                "border-radius": this.borderRadius ? this.borderRadius + "mm" : ""
            })
        },
        o.prototype.boundsChanged = function() {},
        o.prototype.fontChanged = function() {},
        o.prototype.startEdit = function() {},
        o.prototype.stopEdit = function() {}
    },
    "./src/js/reports/RDReverse.js": function(e, t, i) {
        "use strict";
        i.d(t, "a", (function() {
            return s
        }));
        i("./node_modules/core-js/modules/web.url.to-json.js");
        var o = i("./src/js/reports/RDObject.js"),
            n = i("./src/js/admin/ViewEditor.js");
        function s(e, t) {
            if (t.isAutoHeight = !0, this.nid = e.nid, this.expression = t.expression, this.field = e.type.fields[t.expression], !this.field)
                throw new Error("Field not found " + e.type.caption + "." + t.expression);
            this.type = this.field.refType,
            this.showHead = !1 !== t.showHead,
            this.showFoot = !1 !== t.showFoot,
            this.tableBorderStyle = t.tableBorderStyle || 0,
            this.paddingL = void 0 === t.paddingL ? 2 : t.paddingL,
            this.paddingR = void 0 === t.paddingR ? 2 : t.paddingR,
            this.paddingT = void 0 === t.paddingT ? 2 : t.paddingT,
            this.paddingB = void 0 === t.paddingB ? 2 : t.paddingB,
            this.query = new queries.QueryReverse(database, this.field, this.nid, t.viewConfig),
            o.a.call(this, e, t),
            this.mode = null,
            this.selectedColIndex = void 0,
            this.tableMenu = null,
            this.columnMenu = null
        }
        function a(e) {
            var t = this;
            this.reverse = e,
            this.$el = $('<div class="rd-menu-bar">').appendTo(e.designer.$menu);
            var i = $('<div style="padding:8px">').appendTo(this.$el);
            this.$showHead = $('<input type="checkbox">').appendTo(i).change((function() {
                e.showHead = t.$showHead.is(":checked"),
                e.updateUI()
            })),
            $("<label>").text(locale.header).appendTo(i),
            $("<br>").appendTo(i),
            this.$showFoot = $('<input type="checkbox">').appendTo(i).change((function() {
                e.showFoot = t.$showFoot.is(":checked"),
                e.updateUI()
            })),
            $("<label>").text(locale.footer).appendTo(i),
            $('<div style="text-align:center;padding:4px 0">').appendTo(this.$el).button(void 0, locale.editColumns, "grey", $.proxy(this.editColumns, this)),
            $('<div style="text-align:center;padding:4px 0">').appendTo(this.$el).button(void 0, locale.borderStyle + "...", "grey", $.proxy(this.editBorder, this))
        }
        function r(e) {
            this.reverse = e,
            this.$el = $('<div class="rd-menu-bar center">').hide().appendTo(e.designer.$menu),
            $('<div class="rd-metrics-label">').text("↔").appendTo(this.$el),
            this.$width = $('<input type="number" class="rd-metrics">').appendTo(this.$el).change($.proxy(this.widthChanged, this))
        }
        Object.assign(s.prototype, o.a.prototype),
        s.prototype.base = "rev",
        s.prototype.isAutoHeight = !0,
        s.prototype.setAutoHeight = function() {},
        s.prototype.setTextAlign = void 0,
        s.prototype.setVerticalAlign = void 0,
        s.prototype.setBorder = void 0,
        s.prototype.toJSON = function() {
            return Object.assign(o.a.prototype.toJSON.call(this), {
                expression: this.expression,
                viewConfig: this.query.getConfig(),
                showHead: this.showHead,
                showFoot: this.showFoot,
                tableBorderStyle: this.tableBorderStyle,
                paddingL: this.paddingL,
                paddingR: this.paddingR,
                paddingT: this.paddingT,
                paddingB: this.paddingB
            })
        },
        s.prototype.init = function() {
            o.a.prototype.init.call(this),
            this.$wrap = $('<div class="rd-rev">').appendTo(this.$object),
            this.$object.click($.proxy(this.click, this)),
            this.updateTable(),
            this._resize()
        },
        s.prototype.load = function(e) {
            this.query.load((function() {
                e()
            }))
        },
        s.prototype.reload = function(e) {
            var t = this;
            t.nid = t.designer.nid,
            t.query.nid = t.nid,
            t.query.load((function() {
                t.updateTable(),
                t._resize(),
                e()
            }))
        },
        s.prototype.renderPaper = function() {
            for (var e = [], t = [], i = [], n = [], s = this.query.cols, a = this.query.rows, r = this.query.models, l = this.query.groups, c = this.query.foot.values, d = 0; d < s.length; d++) {
                var h = s[d];
                e.push({
                    width: h.width * printer.MM,
                    cellPaddingL: this.paddingL * printer.MM,
                    cellPaddingR: this.paddingR * printer.MM,
                    cellPaddingT: this.paddingT * printer.MM,
                    cellPaddingB: this.paddingB * printer.MM,
                    headAlign: "center",
                    headIsHTML: !1,
                    headFontFamily: this.getFontFamily(),
                    headFontSize: this.getFontSize(),
                    headFontBold: !0,
                    headFontItalic: !1,
                    headFontUnderline: !1,
                    headTextColor: "rgb(0,0,0)",
                    cellAlign: h.expression.returnType.columnAlign,
                    cellIsHTML: "html" === h.expression.returnType.base,
                    cellFontFamily: this.getFontFamily(),
                    cellFontSize: this.getFontSize(),
                    cellFontBold: !1,
                    cellFontItalic: !1,
                    cellFontUnderline: !1,
                    cellTextColor: "rgb(0,0,0)",
                    footAlign: h.aggType ? h.aggType.columnAlign : "left",
                    footIsHTML: !1,
                    footFontFamily: this.getFontFamily(),
                    footFontSize: this.getFontSize(),
                    footFontBold: !1,
                    footFontItalic: !1,
                    footFontUnderline: !1,
                    footTextColor: "rgb(0,0,0)",
                    base: h.expression.returnType.base
                })
            }
            for (d = 0; d < s.length; d++) {
                h = s[d];
                t[d] = h.caption || h.expression.caption || ""
            }
            for (var p = 0; p < a.length; p++) {
                var u = a[p],
                    f = r[u] || l[u],
                    m = f.values,
                    g = [];
                i.push(g);
                for (d = 0; d < s.length; d++) {
                    if ((h = s[d]).isReadable) {
                        var v = m[d],
                            b = h.expression.returnType;
                        "html" === b.base ? g[d] = null != v ? String(v) : "" : "file" === b.base ? g[d] = v && database.downloadURL1(v) || "" : g[d] = b.format(v)
                    } else
                        g[d] = ""
                }
            }
            for (d = 0; d < s.length; d++) {
                (h = s[d]).isReadable ? n[d] = h.agg ? h.aggType.format(c[d]) : "" : n[d] = ""
            }
            return Object.assign(o.a.prototype.renderPaper.apply(this, arguments), {
                base: "table",
                showHead: this.showHead,
                showFoot: this.showFoot,
                borderStyle: this.tableBorderStyle,
                cols: e,
                head: t,
                rows: i,
                foot: n
            })
        },
        s.prototype.setPadding = function(e, t, i, o) {
            void 0 !== e && (this.paddingL = e || 0),
            void 0 !== t && (this.paddingR = t || 0),
            void 0 !== i && (this.paddingT = i || 0),
            void 0 !== o && (this.paddingB = o || 0),
            this.updateUI()
        },
        s.prototype.widthChanged = function(e) {
            this.resize(e)
        },
        s.prototype.updateUI = function() {
            this.updateTable(),
            this.resize()
        },
        s.prototype.updateTable = function() {
            for (var e = this.$wrap, t = this.query.cols || [], i = this.query.rows || [], o = this.query.models || {}, n = this.query.groups || {}, s = this.query.foot.values, a = "padding:" + this.paddingT + "mm " + this.paddingR + "mm " + this.paddingB + "mm " + this.paddingL + "mm", r = '<table class="rd-rev-table rd-table-border-style' + this.tableBorderStyle + '"><colgroup>', l = 0; l < t.length; l++) {
                var c = t[l];
                r += "<col>"
            }
            if (r += "</colgroup>", this.showHead) {
                r += "<thead><tr>";
                for (l = 0; l < t.length; l++) {
                    c = t[l];
                    r += '<th style="' + a + '">' + htmlEscape(c.caption || c.expression.caption) + "</th>"
                }
                r += "</tr></thead>"
            }
            r += "<tbody>";
            for (var d = 0; d < i.length && d < 6; d++) {
                var h = i[d],
                    p = (o[h] || n[h]).values;
                r += "<tr>";
                for (l = 0; l < t.length; l++) {
                    if ((c = t[l]).isReadable) {
                        var u = p[l],
                            f = c.expression.returnType;
                        if ("html" === f.base)
                            r += '<td class="html" style="' + a + '">' + (g = u || "") + "</td>";
                        else if ("file" === f.base) {
                            var m = u ? database.thumbURL1(u) : void 0;
                            r += m ? '<td style="background-image:url(&quot;' + m + '&quot;);background-repeat:no-repeat;background-position:center;background-size:contain"></td>' : "<td></td>"
                        } else {
                            var g = f.format(u);
                            r += '<td style="text-align:' + f.columnAlign + ";" + a + '">' + htmlEscape(g) + "</td>"
                        }
                    } else
                        r += "<td></td>"
                }
                r += "</tr>"
            }
            if (r += "</tbody>", this.showFoot) {
                r += "<tfoot><tr>";
                for (l = 0; l < t.length; l++) {
                    if ((c = t[l]).isReadable) {
                        g = "";
                        if (c.agg) {
                            var v = c.aggType;
                            v.base;
                            g = v.format(s[l]),
                            r += '<td style="text-align:' + v.columnAlign + ";" + a + '">' + htmlEscape(g) + "</td>"
                        } else
                            r += "<td></td>"
                    } else
                        r += "<td></td>"
                }
                r += "</tr></tfoot>"
            }
            e.html(r)
        },
        s.prototype._resize = function(e) {
            var t = this.$wrap,
                i = this.query.cols,
                o = this.w;
            if (i.length > 0) {
                for (var n = 0, s = 0; s < i.length; s++)
                    i[s].width < 1 && (i[s].width = 1),
                    n += i[s].width;
                var a = o / n;
                n = 0;
                for (s = 0; s < i.length - 1; s++) {
                    var r = e ? i[s].width * a : Math.round(i[s].width * a);
                    i[s].width = r,
                    n += r
                }
                i[i.length - 1].width = o - n,
                n = 0;
                var l = t.children("table").children("colgroup").children();
                for (s = 0; s < i.length; s++) {
                    var c = i[s];
                    l[s].style.width = c.width + "mm",
                    n += c.width,
                    c.$resize && (c.$resize[0].style.left = n + "mm")
                }
            }
            t.children()[0].style.width = o + "mm"
        },
        s.prototype.resize = function(e) {
            this._resize(e),
            this.updateAutoHeight(),
            this.tableMenu && this.tableMenu.updateUI(),
            this.columnMenu && this.columnMenu.updateUI()
        },
        s.prototype._select = function() {
            this.tableMenu = new a(this),
            this.tableMenu.updateUI()
        },
        s.prototype._unselect = function() {
            this.tableMenu.destroy(),
            this.tableMenu = null
        },
        s.prototype.startEdit = function() {
            null === this.mode && (this.mode = "edit", this.selected && this.hideResizers(), this.showRulers(), this.columnMenu = new r(this))
        },
        s.prototype.stopEdit = function() {
            "edit" === this.mode && (this.mode = null, this.selected && this.showResizers(), this.hideRulers(), void 0 !== this.selectedColIndex && (this.$col(this.selectedColIndex).removeClass("selected"), this.selectedColIndex = void 0), this.columnMenu.destroy(), this.columnMenu = null)
        },
        s.prototype.$col = function(e) {
            return $(this.$wrap.children("table").children("colgroup").children()[e])
        },
        s.prototype.showRulers = function() {
            for (var e = this, t = this.query.cols, i = 0, o = this.designer, n = 0; n < t.length; n++) {
                var s = t[n];
                i += s.width,
                s.$resize = $('<div class="rd-rev-ctrl-resize">').data("col", s).css({
                    top: "-12px",
                    left: i + "mm"
                }).appendTo(this.$object),
                TOUCH ? s.$resize[0].addEventListener(EVENT_touchstart, a) : s.$resize.mousedown(a)
            }
            function a(t) {
                if (!TOUCH || 1 === t.touches.length) {
                    var i = $(t.target).data("col"),
                        n = TOUCH ? t.touches[0].clientX : t.clientX;
                    return TOUCH ? (document.addEventListener(EVENT_touchmove, s), document.addEventListener(EVENT_touchend, a)) : $(document).on("mousemove", s).on("mouseup", a), t.preventDefault(), !1
                }
                function s(t) {
                    if (!TOUCH || 1 === t.touches.length) {
                        var s = TOUCH ? t.touches[0].clientX : t.clientX,
                            a = (s - n) * o.scale;
                        return i.width + a >= 5 && (i.width = i.width + a, e.w = e.w + a, e.$object[0].style.width = e.w + "mm"), e.resize(!0), n = s, t.preventDefault(), !1
                    }
                }
                function a(t) {
                    if (!TOUCH || 0 === t.touches.length)
                        return TOUCH ? (document.removeEventListener(EVENT_touchmove, s), document.removeEventListener(EVENT_touchend, a)) : $(document).off("mousemove", s).off("mouseup", a), e.w = Math.round(e.w), e.$object[0].style.width = e.w + "mm", e.resize(!1), e.designer.setDirty(), t.preventDefault(), !1
                }
            }
        },
        s.prototype.hideRulers = function() {
            for (var e = this.query.cols, t = 0; t < e.length; t++) {
                var i = e[t];
                i.$resize.remove(),
                i.$resize = void 0
            }
        },
        s.prototype.click = function(e) {
            if ("edit" === this.mode) {
                var t = $(e.target).closest("th,td");
                if (t.length) {
                    void 0 !== this.selectedColIndex && this.$col(this.selectedColIndex).removeClass("selected");
                    var i = t.index();
                    this.query.cols[i];
                    this.$col(i).addClass("selected"),
                    this.selectedColIndex = i,
                    this.columnMenu.updateUI()
                }
            }
        },
        s.prototype.updateAutoHeight = function() {
            o.a.prototype.updateAutoHeight.apply(this, arguments)
        },
        s.prototype.fontChanged = function() {
            this.updateUI()
        },
        a.prototype.updateUI = function() {
            this.$showHead.prop("checked", this.reverse.showHead),
            this.$showFoot.prop("checked", this.reverse.showFoot)
        },
        a.prototype.editColumns = function() {
            var e = this.reverse;
            new n.a({
                config: e.query.getConfig(),
                save: function(t) {
                    var i = t.config,
                        o = "edit" === e.mode;
                    o && e.stopEdit(),
                    e.designer.setDirty(),
                    e.query.setConfig(i),
                    e.query.load((function() {
                        e.updateTable(),
                        e.resize(),
                        o && e.startEdit()
                    }))
                }
            })
        },
        a.prototype.editBorder = function() {
            for (var e = this.reverse, t = $.backplane({
                    autoClose: !0
                }), i = $('<div class="nx-menu-popup grey">').appendTo(t), o = 0; o < 6; o++)
                !function(o) {
                    $('<div class="rd-table-border-option rd-table-border-style' + o + '"><table><thead><tr><th></th><th></th><th></th></tr></thead><tbody><tr><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td></tr></tbody><tfoot><tr><td></td><td></td><td></td></tr></tfoot></div>').appendTo(i).click((function() {
                        e.tableBorderStyle = o,
                        e.updateUI(),
                        e.designer.setDirty(),
                        t.close()
                    })),
                    (o + 1) % 3 == 0 && $("<br>").appendTo(i)
                }(o);
            i.center()
        },
        a.prototype.destroy = function() {
            this.$el.remove()
        },
        r.prototype.updateUI = function() {
            var e = this.reverse.query.cols[this.reverse.selectedColIndex];
            e ? (this.$width.val(e.width), this.$el.show()) : this.$el.hide()
        },
        r.prototype.widthChanged = function() {
            var e = this.reverse.query.cols[this.reverse.selectedColIndex];
            if (e) {
                var t = Math.round(Number(this.$width.val()));
                if (t > 0) {
                    var i = t - e.width;
                    e.width = t,
                    this.reverse.setRect(void 0, void 0, this.reverse.w + i, void 0, !1),
                    this.reverse.designer.setDirty()
                }
            }
        },
        r.prototype.destroy = function() {
            this.$el.remove()
        }
    },
    "./src/js/reports/RDText.js": function(e, t, i) {
        "use strict";
        i.d(t, "a", (function() {
            return a
        }));
        i("./node_modules/core-js/modules/es.string.replace.js"),
        i("./node_modules/core-js/modules/web.url.to-json.js");
        var o = i("./src/js/reports/RDObject.js"),
            n = i("./src/js/admin/FunctionEditor.js");
        function s(e) {
            return e < 1 ? 1.25 : e + .25 / e
        }
        function a(e, t) {
            o.a.call(this, e, t),
            this.text = t.text || "",
            this.verticalAlign = t.verticalAlign || null,
            this.paddingL = t.paddingL || 0,
            this.paddingR = t.paddingR || 0,
            this.paddingT = t.paddingT || 0,
            this.paddingB = t.paddingB || 0,
            this.lineHeight = t.lineHeight || 1,
            this.textDecoration = t.textDecoration || null,
            this.fontStyle = t.fontStyle || null,
            this.fontWeight = t.fontWeight || null,
            this.displayText = "",
            this.printableText = "",
            this.$wrap = null,
            this.$text = null
        }
        Object.assign(a.prototype, o.a.prototype),
        a.prototype.base = "text",
        a.prototype.toJSON = function() {
            return Object.assign(o.a.prototype.toJSON.apply(this), {
                base: "text",
                isAutoHeight: this.isAutoHeight || !1,
                text: this.text,
                verticalAlign: this.verticalAlign,
                paddingL: this.paddingL,
                paddingR: this.paddingR,
                paddingT: this.paddingT,
                paddingB: this.paddingB,
                textDecoration: this.textDecoration,
                fontStyle: this.fontStyle,
                fontWeight: this.fontWeight,
                lineHeight: this.lineHeight
            })
        },
        a.prototype.reload = function(e) {
            var t = this;
            t.load((function() {
                t.$text.text(t.displayText || " "),
                t.updateAutoHeight(),
                e()
            }))
        },
        a.prototype.load = function(e) {
            var t = this,
                i = this.designer.type.schema,
                o = this.designer.type,
                n = this.designer.nid,
                s = t.text.replace(/\$pages/g, "99").replace(/\$page/g, "1"),
                a = t.text,
                r = null;
            try {
                r = queries.parseSystemStringTemplate(i, o, s, {})
            } catch (e) {
                console.warn(e)
            }
            var l = null;
            try {
                l = queries.parseSystemStringTemplate(i, o, a, {})
            } catch (e) {
                console.warn(e)
            }
            var c = database.loadNodeSync(n);
            r && l ? database.canRead(r) ? r.evaluate(database, c, (function(i, o) {
                l.evaluate(database, c, (function(i, n) {
                    t.displayText = o,
                    t.printableText = n,
                    e()
                }))
            })) : (t.displayText = "", t.printableText = "", e()) : (t.displayText = s, t.printableText = a, e())
        },
        a.prototype.init = function() {
            o.a.prototype.init.call(this),
            this.$wrap = $('<div class="rd-object-text-wrap">').css({
                "-webkit-align-items": "middle" === this.verticalAlign ? "center" : "bottom" === this.verticalAlign ? "flex-end" : "flex-start",
                "align-items": "middle" === this.verticalAlign ? "center" : "bottom" === this.verticalAlign ? "flex-end" : "flex-start"
            }).appendTo(this.$object),
            this.$text = $('<div class="rd-object-text-text">').css({
                "padding-left": this.paddingL ? this.paddingL + "mm" : "",
                "padding-right": this.paddingR ? this.paddingR + "mm" : "",
                "padding-top": this.paddingT ? this.paddingT + "mm" : "",
                "padding-bottom": this.paddingB ? this.paddingB + "mm" : "",
                "text-decoration": this.textDecoration || "",
                "font-weight": this.fontWeight || "",
                "font-style": this.fontStyle || "",
                "line-height": s(this.lineHeight)
            }).appendTo(this.$wrap).text(this.displayText || " ")
        },
        a.prototype.renderPaper = function() {
            return Object.assign(o.a.prototype.renderPaper.apply(this, arguments), {
                base: "text",
                text: this.printableText || " ",
                verticalAlign: this.verticalAlign || "top",
                isHTML: !1,
                dynamicHeight: this.isAutoHeight || !1,
                paddingL: (this.paddingL || 0) * printer.MM,
                paddingR: (this.paddingR || 0) * printer.MM,
                paddingT: (this.paddingT || 0) * printer.MM,
                paddingB: (this.paddingB || 0) * printer.MM,
                textDecoration: this.textDecoration,
                fontStyle: this.fontStyle,
                fontWeight: this.fontWeight,
                lineHeight: this.lineHeight
            })
        },
        a.prototype.setPadding = function(e, t, i, o) {
            void 0 !== e && (this.paddingL = e || 0),
            void 0 !== t && (this.paddingR = t || 0),
            void 0 !== i && (this.paddingT = i || 0),
            void 0 !== o && (this.paddingB = o || 0),
            this.$text.css({
                "padding-left": this.paddingL ? this.paddingL + "mm" : "",
                "padding-right": this.paddingR ? this.paddingR + "mm" : "",
                "padding-top": this.paddingT ? this.paddingT + "mm" : "",
                "padding-bottom": this.paddingB ? this.paddingB + "mm" : ""
            }),
            this.updateAutoHeight(),
            this.designer.setDirty()
        },
        a.prototype.startEdit = function() {
            TOUCH ? this.startEdit_TOUCH() : this.startEdit_DESKTOP()
        },
        a.prototype.startEdit_DESKTOP = function() {
            var e = this;
            this.$object.addClass("editing"),
            this.$text.remove(),
            this.$text = $("<textarea>").attr("autocomplete", "off").attr("autocorrect", "off").attr("autocapitalize", "off").attr("spellcheck", "false").css({
                "vertical-align": this.verticalAlign || "",
                "padding-left": this.paddingL ? this.paddingL + "mm" : "",
                "padding-right": this.paddingR ? this.paddingR + "mm" : "",
                "padding-top": this.paddingT ? this.paddingT + "mm" : "",
                "padding-bottom": this.paddingB ? this.paddingB + "mm" : "",
                "text-decoration": this.textDecoration || "",
                "font-weight": this.fontWeight || "",
                "font-style": this.fontStyle || "",
                "line-height": s(this.lineHeight),
                height: this.h + 6 + "mm",
                "background-color": "#fff",
                color: "#000"
            }).val(this.getEditableText() || "").appendTo(this.$wrap).focus();
            var t = this.$text.position();
            t.top -= 32,
            t.left += this.$text.width() - 16,
            this.$button = $('<div class="button blue icon i-32-24 i-white i-setting-settings" style="position:absolute;border-radius:2px;z-index:2">').offset(t).appendTo(this.$object).on(TOUCH ? EVENT_touchstart : "mousedown", (function() {
                var t = e.$text[0].selectionStart;
                (!t || t < 0) && (t = 0);
                var i = e.$text.val(),
                    o = i.substr(0, t),
                    s = i.substr(t),
                    a = /\{([^\}]*)$/.exec(o),
                    r = /^([^\{]*)\}/.exec(s),
                    l = "";
                a && r && (o = o.substr(0, a.index), s = s.substr(r[0].length), l = a[1] + r[1]);
                new n.a({
                    value: l,
                    isHuman: !0,
                    schema: e.designer.type.schema,
                    type: e.designer.type,
                    okay: function(t, i) {
                        t && i ? e.$text.val(o + "{" + i.toHumanString() + "}" + s).focus() : e.$text.val(o + s).focus()
                    },
                    cancel: function() {
                        e.$text.focus()
                    }
                })
            }))
        },
        a.prototype.startEdit_TOUCH = function() {
            var e = this,
                t = $('<div class="nx-backplane nx-backplane-dark">').appendTo($(document.body)),
                i = $('<div class="nx-menu-popup grey" style="left:64px;top:20px;right:64px;bottom:0px">').appendTo(t),
                o = $('<div class="nx-button-bar" style="position:absolute;left:8px;top:-32px;right:8px">').appendTo(i);
            $('<div class="nx-button-text grey">').text(locale.function + "...").appendTo(o).click((function() {
                var t = s[0].selectionStart;
                (!t || t < 0) && (t = 0);
                var i = s.val(),
                    o = i.substr(0, t),
                    a = i.substr(t),
                    r = /\{([^\}]*)$/.exec(o),
                    l = /^([^\{]*)\}/.exec(a),
                    c = "";
                r && l && (o = o.substr(0, r.index), a = a.substr(l[0].length), c = r[1] + l[1]);
                new n.a({
                    value: c,
                    schema: e.designer.type.schema,
                    type: e.designer.type,
                    okay: function(e, t) {
                        e && t ? s.val(o + "{" + t.toHumanString() + "}" + a).focus() : s.val(o + a).focus()
                    },
                    cancel: function() {
                        s.focus()
                    }
                })
            })),
            $('<div class="nx-hspace-flex">').appendTo(o),
            $('<div class="nx-button-text blue">').text(locale.okay).appendTo(o).click((function() {
                var t = e.text,
                    i = queries.formatHumanStringTemplateSystem(s.val(), e.designer.type);
                t !== i ? (e.text = i, $.loading(!0), e.load((function() {
                    $.loading(!1),
                    e.$text.text(e.displayText || " "),
                    e.updateAutoHeight(),
                    e.designer.setDirty(),
                    a()
                }))) : a()
            }));
            var s = $('<textarea style="position:absolute;left:16px;right:16px;bottom:16px;top:64px;height:auto;padding:8px;border:none;border-radius:4px;margin:0;height:auto;font-size:inherit;font-family:inherit">').attr("autocomplete", "off").attr("autocorrect", "off").attr("autocapitalize", "off").attr("spellcheck", "false").val(this.getEditableText() || "").appendTo(i).focus();
            function a() {
                t.remove()
            }
        },
        a.prototype.stopEdit = function() {
            TOUCH ? this.stopEdit_TOUCH() : this.stopEdit_DESKTOP()
        },
        a.prototype.stopEdit_TOUCH = function() {},
        a.prototype.stopEdit_DESKTOP = function() {
            var e = this;
            this.$object.removeClass("editing");
            var t = this.text,
                i = queries.formatHumanStringTemplateSystem(this.$text.val(), this.designer.type);
            this.$text.remove(),
            this.$button && this.$button.remove(),
            this.$text = $('<div class="rd-object-text-text">').css({
                "vertical-align": this.verticalAlign || "",
                "padding-left": this.paddingL ? this.paddingL + "mm" : "",
                "padding-right": this.paddingR ? this.paddingR + "mm" : "",
                "padding-top": this.paddingT ? this.paddingT + "mm" : "",
                "padding-bottom": this.paddingB ? this.paddingB + "mm" : "",
                "text-decoration": this.textDecoration || "",
                "font-weight": this.fontWeight || "",
                "font-style": this.fontStyle || "",
                "line-height": s(this.lineHeight)
            }).text(this.displayText || " ").appendTo(this.$wrap),
            t !== i && (e.text = i, $.loading(!0), e.load((function() {
                $.loading(!1),
                e.$text.text(e.displayText || " "),
                e.updateAutoHeight(),
                e.designer.setDirty()
            })))
        },
        a.prototype.setVerticalAlign = function(e) {
            this.verticalAlign = e || null,
            this.$wrap.css({
                "-webkit-align-items": "middle" === this.verticalAlign ? "center" : "bottom" === this.verticalAlign ? "flex-end" : "flex-start",
                "align-items": "middle" === this.verticalAlign ? "center" : "bottom" === this.verticalAlign ? "flex-end" : "flex-start"
            }),
            this.designer.setDirty()
        },
        a.prototype.setLineHeight = function(e) {
            (e = Number(e)) >= 1 && (this.lineHeight = e, this.$text.css("line-height", s(e)), this.updateAutoHeight(), this.designer.setDirty())
        },
        a.prototype.getEditableText = function() {
            var e = this.text;
            return queries.formatSystemStringTemplateHuman(e, this.designer.type)
        },
        a.prototype.setTextDecoration = function(e) {
            this.textDecoration = e || null,
            this.$text.css("text-decoration", e || ""),
            this.updateAutoHeight(),
            this.designer.setDirty()
        },
        a.prototype.setFontStyle = function(e) {
            this.fontStyle = e || null,
            this.$text.css("font-style", e || ""),
            this.updateAutoHeight(),
            this.designer.setDirty()
        },
        a.prototype.setFontWeight = function(e) {
            this.fontWeight = e || null,
            this.$text.css("font-weight", e || ""),
            this.updateAutoHeight(),
            this.designer.setDirty()
        }
    },
    "./src/js/reports/TextMenu.js": function(e, t, i) {
        "use strict";
        i.d(t, "a", (function() {
            return s
        }));
        var o = i("./src/js/widgets/Field.js"),
            n = i("./node_modules/underscore/underscore.js");
        function s(e) {
            var t = this;
            this.designer = e,
            this.silent = !1,
            this.$el = $('<div class="rd-menu-bar center">').hide().appendTo(e.$menu);
            var i = NinoxDocumentInteraction.availableFontFamilies(),
                s = {};
            n.each(util.localeSort(i), (function(e) {
                s[e] = {
                    id: e,
                    caption: e,
                    font: e
                }
            }));
            var a = this.font = new util.SimpleModel(new schemas.TChoice(void 0, void 0, {
                required: !0,
                values: s
            }));
            a.withoutLabel = !0,
            (this.fontField = new o.a(this, a, this.$el)).el.css({
                width: 140,
                margin: 0,
                "vertical-align": "baseline"
            }),
            a.on("update", (function() {
                e.selection && e.selection.setFontFamily && e.selection.setFontFamily(a.value)
            }));
            for (var r = {}, l = 1; l <= 36; l++) {
                var c = String(l);
                r[c] = {
                    caption: c,
                    id: c,
                    order: l
                }
            }
            this.sizeModel = new util.SimpleModel(new schemas.TNumber(void 0, void 0, {
                required: !0,
                numberMin: 1,
                numberMax: 256
            })),
            this.sizeModel.withoutLabel = !0,
            this.sizeField = new o.a(this, this.sizeModel, this.$el),
            this.sizeField.el.css({
                width: 80,
                margin: 0,
                "vertical-align": "baseline"
            }),
            this.sizeModel.on("update", (function() {
                if (!t.silent && e.selection && e.selection.setFontFamily) {
                    var i = t.sizeModel.value;
                    (isNaN(i) || i < 0) && (i = null),
                    e.selection.setFontSize(i)
                }
            })),
            $("<br>").appendTo(this.$el),
            this.$bold = $('<div class="rd-menu-button">').append($('<div class="i-32-24 i-light-grey i-bold">')).appendTo(this.$el).click((function() {
                e.selection && e.selection.setFontWeight && e.selection.setFontWeight(e.selection.fontWeight ? null : "bold")
            })),
            this.$italic = $('<div class="rd-menu-button">').append($('<div class="i-32-24 i-light-grey i-italic">')).appendTo(this.$el).click((function() {
                e.selection && e.selection.setFontStyle && e.selection.setFontStyle(e.selection.fontStyle ? null : "italic")
            })),
            this.$underline = $('<div class="rd-menu-button">').append($('<div class="i-32-24 i-light-grey i-underline">')).appendTo(this.$el).click((function() {
                e.selection && e.selection.setTextDecoration && e.selection.setTextDecoration(e.selection.textDecoration ? null : "underline")
            })),
            $("<br>").appendTo(this.$el),
            this.$lhPane = $("<div>").appendTo(this.$el),
            $("<span>").text(locale.lineHeight + " ").appendTo(this.$lhPane),
            this.lhModel = new util.SimpleModel(new schemas.TNumber(void 0, void 0, {
                required: !0,
                numberMin: 1
            })),
            this.lhModel.withoutLabel = !0,
            this.lhModel.on("update", (function() {
                !t.silent && e.selection && e.selection.setFontFamily && e.selection && e.selection.setLineHeight && e.selection.setLineHeight(t.lhModel.value || 1)
            })),
            this.lhField = new o.a(this, this.lhModel, this.$lhPane),
            this.lhField.el.css({
                width: 80,
                margin: 0,
                "vertical-align": "baseline"
            }),
            this.$alignLeft = $('<div class="rd-menu-button">').append($('<div class="i-32-24 i-light-grey i-h-align-left">')).appendTo(this.$el).click((function() {
                e.selection && e.selection.setTextAlign && e.selection.setTextAlign("left")
            })),
            this.$alignCenter = $('<div class="rd-menu-button">').append($('<div class="i-32-24 i-light-grey i-h-align-center">')).appendTo(this.$el).click((function() {
                e.selection && e.selection.setTextAlign && e.selection.setTextAlign("center")
            })),
            this.$alignRight = $('<div class="rd-menu-button">').append($('<div class="i-32-24 i-light-grey i-h-align-right">')).appendTo(this.$el).click((function() {
                e.selection && e.selection.setTextAlign && e.selection.setTextAlign("right")
            })),
            this.$alignJustify = $('<div class="rd-menu-button">').append($('<div class="i-32-24 i-light-grey i-h-align-justify">')).appendTo(this.$el).click((function() {
                e.selection && e.selection.setTextAlign && e.selection.setTextAlign("justify")
            })),
            $("<br>").appendTo(this.$el),
            this.$valignTop = $('<div class="button i-32-24 i-light-grey i-v-align-top">').appendTo(this.$el).click((function() {
                e.selection && e.selection.setVerticalAlign && e.selection.setVerticalAlign(null)
            })),
            this.$valignMiddle = $('<div class="button i-32-24 i-light-grey i-v-align-middle">').appendTo(this.$el).click((function() {
                e.selection && e.selection.setVerticalAlign && e.selection.setVerticalAlign("middle")
            })),
            this.$valignBottom = $('<div class="button i-32-24 i-light-grey i-v-align-bottom">').appendTo(this.$el).click((function() {
                e.selection && e.selection.setVerticalAlign && e.selection.setVerticalAlign("bottom")
            }))
        }
        s.prototype.updateUI = function() {
            this.silent = !0;
            var e = this.designer.selection;
            e ? (e.setFontFamily ? (this.font.value = e.getFontFamily(), this.fontField.editor.load(), this.fontField.el.css({
                display: ""
            })) : this.fontField.el.css({
                display: "none"
            }), e.setFontSize ? (this.sizeModel.setValue(e.getFontSize()), this.sizeField.el.css({
                display: ""
            })) : this.sizeField.el.css({
                display: "none"
            }), e.setFontWeight ? this.$bold.show() : this.$bold.hide(), e.setFontStyle ? this.$italic.show() : this.$italic.hide(), e.setTextDecoration ? this.$underline.show() : this.$underline.hide(), e.setLineHeight ? (this.$lhPane.show(), this.lhModel.setValue(e.lineHeight || 1)) : this.$lhPane.hide(), e.setTextAlign ? (this.$alignLeft.show(), this.$alignCenter.show(), this.$alignRight.show(), this.$alignJustify.show()) : (this.$alignLeft.hide(), this.$alignCenter.hide(), this.$alignRight.hide(), this.$alignJustify.hide()), e.setVerticalAlign ? (this.$valignTop.show(), this.$valignMiddle.show(), this.$valignBottom.show()) : (this.$valignTop.hide(), this.$valignMiddle.hide(), this.$valignBottom.hide()), this.$el.show()) : this.$el.hide(),
            this.silent = !1
        }
    },
    "./src/js/ui/ui-util.js": function(e, t, i) {
        "use strict";
        i.d(t, "h", (function() {
            return n
        })),
        i.d(t, "f", (function() {
            return s
        })),
        i.d(t, "c", (function() {
            return a
        })),
        i.d(t, "i", (function() {
            return r
        })),
        i.d(t, "j", (function() {
            return l
        })),
        i.d(t, "b", (function() {
            return c
        })),
        i.d(t, "a", (function() {
            return d
        })),
        i.d(t, "k", (function() {
            return h
        })),
        i.d(t, "d", (function() {
            return p
        })),
        i.d(t, "g", (function() {
            return u
        })),
        i.d(t, "e", (function() {
            return f
        })),
        i.d(t, "l", (function() {
            return m
        }));
        i("./node_modules/@babel/runtime/helpers/defineProperty.js");
        var o = i("./src/js/printer/printNode.js");
        function n(e, t, i) {
            database.loadFiles(e, (function(e, o) {
                var n,
                    s = {};
                if (o)
                    for (var a = 0; a < o.length; a++) {
                        var r = o[a].name,
                            l = /\.[^\.]*$/.exec(r);
                        l && (r = r.substr(0, l.index)),
                        s[r] = !0
                    }
                if (!s[t])
                    return i(void 0, t);
                var c = /\s*([0-9]+)$/.exec(t);
                for (c ? (t = t.substr(0, c.index), n = parseInt(c[1]) + 1) : (t += " ", n = 2); s[t + n];)
                    n++;
                i(void 0, t + n)
            }))
        }
        function s() {
            return !!NinoxDocumentInteraction.getUserDefault("nx.server")
        }
        function a(e, t, i) {
            if (i = i || function() {}, !e)
                return i();
            var o;
            try {
                o = queries.parseSystem(database.schema, database.schema.typeOf(t), e, {})
            } catch (e) {
                return $.alert(e), i()
            }
            return o ? o.hasErrors() ? ($.alert(o.errorMessage()), i()) : void function(e, t) {
                if (!e)
                    return t();
                if ("object" == typeof e)
                    return t(e);
                database.loadNode(e, (function(e, i) {
                    t(i)
                }))
            }(t, (function(e) {
                $.loading(!0),
                database.evaluate ? database.evaluate(o, e, (function(e, t) {
                    return $.loading(!1), i(e, t)
                })) : o.evaluate(database, e, (function(e, t) {
                    return $.loading(!1), i(e, t)
                }))
            })) : i()
        }
        function r(e, t) {
            e && (window.reports ? reports.openDesigner({
                nid: e,
                nids: t
            }) : Object(o.a)(e))
        }
        function l(e) {
            if (e) {
                var t = database.typeOf(e);
                if (t)
                    return database.canDelete(t) ? void $.dialog({
                        closable: !0,
                        caption: locale.remove,
                        message: locale.confirmRemove,
                        buttons: [{
                            color: "red",
                            caption: locale.remove,
                            callback: function() {
                                database.remove(e, (function(e) {
                                    e && $.alert(e)
                                }))
                            }
                        }]
                    }) : $.alert(locale.errorNotAuthorized)
            }
        }
        function c(e, t) {
            if (e) {
                var i = database.typeOf(e);
                if (i)
                    return i.isNew ? $.alert(locale.schemaSaveRequired) : database.canCreate(i) ? void database.duplicate(e, (function(e, i) {
                        if (e)
                            return $.alert(e);
                        t && t(i)
                    })) : $.alert(locale.errorNotAuthorized)
            }
        }
        function d(e, t) {
            return e.isNew ? $.alert(locale.schemaSaveRequired) : database.canCreate(e) ? void database.create(e, {}, (function(e, i) {
                if (e)
                    return $.alert(e);
                i && t && t(i._id)
            })) : $.alert(locale.errorNotAuthorized)
        }
        function h(e) {
            if (window._serverConfig = {}, !s())
                return e();
            dbms.getRemoteConnection().getServerConfig((t, i) => {
                window._serverConfig = i || {},
                e()
            })
        }
        function p(e="") {
            const t = window._serverConfig || {};
            return e ? t[e] : t
        }
        function u() {
            return s() && p("saml")
        }
        function f(e) {
            let t = null;
            const i = p("passwordPolicy") || {};
            function o() {
                NinoxDocumentInteraction.setUserDefault("nx.lastActivityAt", Date.now()),
                clearTimeout(t),
                t = setTimeout(n, e)
            }
            function n() {
                var e = NinoxDocumentInteraction.getUserDefault("nx.lastActivityAt");
                e && (Date.now() - parseInt(e) > 60 * parseInt(i.idleTimeoutInMinutes) * 1e3 && "#NO-USER-ID#" != dbms.getRemoteConnection().getSessionInfo().user.id && dbms.getRemoteConnection().logout((function(e) {
                    e && $.alert(e)
                })))
            }
            o(),
            window.onmousemove = o,
            window.onmousedown = o,
            window.onkeydown = o,
            window.onwheel = o,
            window.ontouchstart = o,
            window.ontouchmove = o,
            window.onclick = o,
            window.onscroll = o
        }
        function m() {
            0
        }
    },
    "./src/js/widgets/Component.js": function(e, t, i) {
        "use strict";
        i.d(t, "a", (function() {
            return n
        }));
        var o = i("./src/js/admin/AdminField.js");
        function n() {}
        n.prototype._isWritable = !1,
        n.prototype.destroy = function() {
            this.el.remove()
        },
        n.prototype.isWidthAdjustable = function() {
            return !0
        },
        n.prototype.updateElementWidth = function() {
            if (this.field) {
                var e = 4 / (this.container && this.container.columns || 4),
                    t = Math.min(1, Math.max(0, e * this.field.formWidth));
                this.el.css("width", 100 * t + "%")
            }
        },
        n.prototype.setWidth = function(e, t) {
            this.field && (this.field.formWidth = t, this.field.width = e),
            this.updateElementWidth(),
            this.widthChanged()
        },
        n.prototype.widthChanged = function() {},
        n.prototype.isHeightAdjustable = function() {
            return !1
        },
        n.prototype.setHeight = function(e) {},
        n.prototype.updateStructure = function() {},
        n.prototype.next = function() {
            return this.el.next(".component").data("component") || this.el.siblings(".component").first().data("component")
        },
        n.prototype.prev = function() {
            return this.el.prev(".component").data("component") || this.el.siblings(".component").last().data("component")
        },
        n.prototype.blur = function() {},
        n.prototype.focus = function() {
            return !1
        },
        n.prototype.focusNext = function() {
            this.blur();
            for (var e = this;;) {
                var t = e.next();
                if (!t)
                    break;
                if (t === this)
                    break;
                if (t.focus())
                    break;
                e = t
            }
        },
        n.prototype.focusPrev = function() {
            this.blur();
            for (var e = this;;) {
                var t = e.prev();
                if (!t)
                    break;
                if (t === this)
                    break;
                if (t.focus())
                    break;
                e = t
            }
        },
        n.prototype.nodeChanged = function() {
            this.updateIsWritable(),
            this.updateVisibility()
        },
        n.prototype.setVisible = function(e) {
            this.visible = e,
            e ? this.el[0].style.display = "" : (this.blur(), this.el[0].style.display = "none")
        },
        n.prototype.updateVisibility = function() {
            if (this.field.visibilityExp) {
                var e = this,
                    t = this._updateVisibilityId = Math.random();
                database.loadNode(e.container.nid, (function(i, o) {
                    o && e.field.visibilityExp.evaluate(database, o, (function(i, o) {
                        t === e._updateVisibilityId && e.setVisible(!(!i && !o))
                    }))
                }))
            } else
                this.visible || this.setVisible(!0)
        },
        n.prototype.isWritable = function() {
            return this._isWritable
        },
        n.prototype.updateIsWritable = function() {
            this._isWritable = this.container.isWritable() && database.canWriteNodeField(this.container.nid, this.field.id)
        },
        n.prototype.bind = function(e) {
            this.updateIsWritable(),
            this.updateVisibility()
        },
        n.prototype.popup = function(e) {
            new o.a(this, this.field, e)
        },
        n.prototype.setError = function(e) {
            (e = e || this.getError()) ? (this.error || (this.error = $('<div class="editor-error">').appendTo(this.el)), this.error.html('<div class="editor-error-text"><div class="editor-error-icon i-red i-16-12 i-warning"></div>' + htmlEscape(e) + "</div>"), this.el.addClass("error")) : (this.error && this.error.remove(), this.error = void 0, this.el.removeClass("error"))
        },
        n.prototype.getError = function() {}
    },
    "./src/js/widgets/Field.js": function(e, t, i) {
        "use strict";
        i.d(t, "a", (function() {
            return s
        }));
        var o = i("./src/js/widgets/Component.js"),
            n = i("./src/js/widgets/widgets.js");
        function s(e, t, i, o) {
            o = o || {},
            this.container = e,
            this.model = t,
            this.visible = !0;
            var s = t.field,
                a = s.getEditorClass();
            this.el = $('<div class="component">').data("component", this).appendTo(i || e.containerEl || e.el),
            o.cls && this.el.addClass(o.cls),
            this.el.toggleClass("label-left", "left" === s.labelPosition),
            this.label = $("<label>").text(t.caption || "").css("display", t.withoutLabel || widgets.DONT_SHOW_LABEL[a] || "placeholder" === s.labelPosition || "none" === s.labelPosition ? "none" : "").appendTo(this.el),
            this.el.addClass(Object(n.d)(t.field)),
            this.el.css("width", 100 * (o.formWidth || t.field.formWidth) + "%"),
            this.editor = Object(n.c)(this, t),
            this.editor.load(!0)
        }
        s.prototype.next = o.a.prototype.next,
        s.prototype.prev = o.a.prototype.prev,
        s.prototype.focusNext = o.a.prototype.focusNext,
        s.prototype.focusPrev = o.a.prototype.focusPrev,
        s.prototype.setError = o.a.prototype.setError,
        s.prototype.getError = o.a.prototype.getError,
        s.prototype.focus = function() {
            if (!this.visible)
                return !1;
            if (!this.isWritable())
                return !1;
            var e = this;
            if (e.editor.focus) {
                var t = e.container && e.container.el || e.el.parent(),
                    i = t.offset().top,
                    o = i + t.height(),
                    n = t.scrollTop(),
                    s = e.el.offset().top,
                    a = e.el.height() + s + 8;
                return s < i ? t.scrollTop(n - (i - s)) : a > o && t.scrollTop(n + (a - o)), setTimeout((function() {
                    e.editor.focus()
                }), 0), !0
            }
            return !1
        },
        s.prototype.blur = function() {
            this.editor.blur && this.editor.blur()
        },
        s.prototype.destroy = function() {
            this.editor.destroy(),
            this.el.remove()
        },
        s.prototype.getModel = function() {
            return this.model
        },
        s.prototype.show = function() {
            this.el.css("display", "")
        },
        s.prototype.hide = function() {
            this.el.css("display", "none")
        },
        s.prototype.editorUp = function() {
            this.container.editorUp && this.container.editorUp()
        },
        s.prototype.editorDown = function() {
            console.log("Field.editorDown"),
            this.container.editorDown && this.container.editorDown()
        },
        s.prototype.widthChanged = function() {
            this.container.widthChanged && this.editor.widthChanged()
        },
        s.prototype.isWritable = function() {
            return !0
        }
    },
    "./src/js/widgets/editors/ChoiceEditor.js": function(e, t, i) {
        "use strict";
        i.d(t, "a", (function() {
            return s
        })),
        i.d(t, "b", (function() {
            return r
        }));
        var o = i("./src/js/widgets/editors/StringEditor.js"),
            n = i("./node_modules/underscore/underscore.js");
        function s(e, t) {
            this.orderedValues = [],
            this.visibleValues = [],
            this.selectedValueId = void 0,
            this.filterString = "",
            this.currentString = "",
            this.index0 = 0,
            this.index1 = 0,
            o.a.apply(this, arguments)
        }
        function a(e, t) {
            const i = Math.min(e.length, t.length);
            for (var o = 0; o < i; o++)
                if (e[o] !== t[o])
                    return o;
            return i
        }
        function r() {
            s.apply(this, arguments)
        }
        function l(e, t) {
            for (var i = 0; i < e.length; i++) {
                if (e[i].id === t)
                    return i
            }
            return -1
        }
        Object.assign(s.prototype, o.a.prototype),
        s.prototype.editorClass = "choice",
        s.prototype.hideButtonOnEmpty = !1,
        s.prototype.createRenderer = function() {
            this.text = $('<div class="choice text-selectable">').appendTo(this.el).touch($.proxy(this.container.focus, this.container)),
            this.button = $('<div class="choice-dropdown">').appendTo(this.el).touch($.proxy(this.container.focus, this.container))
        },
        s.prototype.destroyRenderer = function() {
            this.text && (this.text.remove(), this.text = void 0),
            this.button && (this.button.remove(), this.button = void 0)
        },
        s.prototype.showAux = function() {
            if (this.$aux)
                return;
            var e = this,
                t = this.model.field;
            this.selectedValueId = null == this.value ? "###NULL###" : this.value,
            this.orderedValues = [],
            this.filterString = "",
            this.currentString = this.input.val(),
            this.visibleValues = [];
            let i = !0;
            function o(t) {
                e.updating = !0,
                e.updateModel(t, (function(t) {
                    e.updating = !1,
                    e.stopEdit()
                }))
            }
            this.$view = $('<div style="position:relative;left:0;top:0;height:100%;min-width:' + this.el.outerWidth() + 'px">'),
            this.$items = $('<div style="position:relative;left:0;top:0;min-width:100%">').appendTo(this.$view),
            this.$aux = $('<div class="choice-menu" style="min-width:' + this.el.outerWidth() + 'px;overflow-y:auto;z-index:12">').append(this.$view).appendTo($(document.body)).on("scroll", () => {
                this.updateView()
            }).on(EVENT_touchmove, () => {
                TOUCH && (i = !1)
            }).on(TOUCH ? EVENT_touchend : "mousedown", (function(e) {
                if (!TOUCH || i) {
                    var n = $(e.target).closest(".choice-menu-item").attr("data-id");
                    null != n && o("###NULL###" === n ? null : t.convert(n))
                } else
                    i = !0
            })).on(TOUCH ? EVENT_touchend : "mousedown", (function(e) {
                if (!TOUCH || i) {
                    var t = $(e.target).closest(".choice-menu-item").attr("data-id");
                    null != t && o("###NULL###" === t ? null : t)
                } else
                    i = !0
            })),
            this.reloadValues()
        },
        s.prototype.reloadValues = function() {
            if (!this.$aux)
                return;
            const e = Date.now();
            this.model.field.loadValuesSorted(this.getNid(), t => {
                const i = Date.now();
                console.log("ChoiceEditor.reloadValues", i - e + "ms", JSON.stringify(t)),
                this.orderedValues = t,
                this.updateAux(!0)
            })
        },
        s.prototype.hideAux = function() {
            this.$aux && (this.$aux.remove(), this.$aux = null, this.$view = null, this.$items = null, this.orderedValues = [], this.visibleValues = [], this.selectedValueId = void 0)
        },
        s.prototype.afterLoaded = function() {
            "dchoice" === this.model.field.base && this.reloadValues()
        },
        s.prototype.updateAux = function(e) {
            const t = Date.now();
            var i = this,
                o = this.$aux,
                s = this.model.field;
            if (!o)
                return;
            var a = 0,
                r = this.filterString,
                l = !r,
                c = this.visibleValues = [];
            !s.required && l && (c.push({
                id: "###NULL###"
            }), a++),
            n.each(this.orderedValues, (function(e) {
                (l || 0 === (e.caption || "").toLocaleLowerCase().indexOf(r)) && (c.push(e), a++)
            }));
            const d = Date.now();
            this.$view[0].style.height = 32 * a + "px";
            const h = Date.now();
            console.log("ChoiceEditor.update", d - t + "ms", h - d + "ms"),
            function() {
                var e = i.el.offset(),
                    t = window.getWidth(),
                    n = window.getHeight(),
                    s = e.left,
                    r = e.top + 36,
                    l = o.outerWidth(),
                    c = 32 * a;
                c > n - r && (n - r >= e.top - 4 ? c = n - r : (c = Math.min(e.top - 4, c), r = e.top - 4 - c));
                s + l > t && (s = t - l);
                o.css({
                    left: s,
                    top: r,
                    height: c
                });
                var d = o.children(".selected");
                if (d.length) {
                    var h = d.offset().top,
                        p = h + 32;
                    h < r ? o.scrollTop(o.scrollTop() + h - r) : p > r + c && o.scrollTop(o.scrollTop() + p - r - c)
                }
            }(),
            this.index0 = 0,
            this.index1 = 0,
            this.updateView(),
            e && (this.$items[0].style.width = this.$items.width() + "px")
        },
        s.prototype.updateView = function() {
            if (this.$view) {
                const t = this.$aux[0].scrollTop,
                    i = this.$aux.height(),
                    o = Math.max(0, Math.floor(t / 32)),
                    n = Math.min(this.visibleValues.length, Math.floor((t + i) / 32));
                if (o < this.index0 || n > this.index1) {
                    const t = Math.max(0, o - 16),
                        i = Math.min(this.visibleValues.length, n + 16);
                    this.index0 = t,
                    this.index1 = i;
                    let s = "";
                    for (var e = t; e < i; e++) {
                        const t = this.visibleValues[e];
                        if (t) {
                            const e = t.id === this.selectedValueId;
                            "###NULL###" === t.id ? s += '<div class="choice-menu-item" data-id="###NULL###"><div class="choice-indicator' + (e ? " selected" : "") + '"></div><div class="choice-label">' + htmlEscape(locale.empty) + "</div></div>" : s += '<div data-id="' + t.id + '" class="choice-menu-item" style="' + (t.color ? "background-color:" + t.color + ";color:" + t.textColor : "") + '"><div class="choice-indicator' + (e ? " selected" : "") + '"></div><div class="multicombo-item" style="background-color:transparent;color:' + t.textColor + '">' + (t.icon ? '<div class="choice-symbol ic ic-' + t.icon + '"></div>' : "") + "<span>" + htmlEscape(t.caption || "") + "</span></div></div>"
                        }
                    }
                    this.$items[0].style.top = 32 * t + "px",
                    this.$items[0].innerHTML = s
                }
            }
        },
        s.prototype.keyupCallback = function(e) {
            switch (e.which) {
            case 38:
            case 40:
                return e.preventDefault(), e.stopPropagation(), this.updateAux(), !1;
            default:
                var t = this.input.val();
                return t !== this.currentString && (this.filterString = t.toLocaleLowerCase(), this.currentString = t, this.updateAux()), !0
            }
        },
        s.prototype.keydownCallback = function(e) {
            switch (e.which) {
            case 38:
                if ((i = this.visibleValues) && i.length) {
                    if (-1 === (o = l(i, this.selectedValueId))) {
                        var t = i[i.length - 1];
                        this.selectedValueId = t.id,
                        this.input.val(t.caption)
                    } else if (o > 0) {
                        t = i[o - 1];
                        this.selectedValueId = t.id,
                        this.input.val(t.caption)
                    }
                } else
                    this.selectedValueId = void 0;
                return this.updateAux(), e.preventDefault(), e.stopPropagation(), !1;
            case 40:
                var i,
                    o;
                if ((i = this.visibleValues) && i.length) {
                    if (-1 === (o = l(i, this.selectedValueId))) {
                        t = i[0];
                        this.selectedValueId = t.id,
                        this.input.val(t.caption)
                    } else if (o < i.length - 1) {
                        t = i[o + 1];
                        this.selectedValueId = t.id,
                        this.input.val(t.caption)
                    }
                } else
                    this.selectedValueId = void 0;
                return this.updateAux(), e.preventDefault(), e.stopPropagation(), !1
            }
        },
        s.prototype.parseEditorValue = function(e) {
            if ("dchoice" === this.model.field.base || "ref" === this.model.field.base) {
                const t = e.toLocaleLowerCase();
                let i = 0,
                    o = void 0;
                for (const n of this.orderedValues) {
                    if (e === n.caption)
                        return n.id;
                    let s = a(t, (n.caption || "").toLocaleLowerCase());
                    s > i && (i = s, o = n)
                }
                return o ? o.id : void 0
            }
            return this.model.field.parseEditor(e)
        },
        Object.assign(r.prototype, s.prototype),
        r.prototype.editorClass = "user"
    },
    "./src/js/widgets/editors/ColorSelector.js": function(e, t, i) {
        "use strict";
        i.d(t, "b", (function() {
            return a
        })),
        i.d(t, "a", (function() {
            return r
        }));
        var o = i("./src/js/widgets/editors/Editor.js");
        let n = "presets";
        const s = ["#FF7F66", "#FFB450", "#FADA33", "#52CC74", "#64C1FA", "#6691FF", "#9485F2", "#EC87E2", "#B7C0DB", "#8594C2", "#5E6E9C", "#37405B"];
        function a(e, t) {
            o.a.apply(this, arguments),
            this.el = $('<div class="stringeditor">').appendTo(e.el).touch($.proxy(this.popup, this)),
            this.text = $('<div class="input-text">').appendTo(this.el)
        }
        function r(e) {
            var t = e.value ? util.parseColor(e.value) : [255, 255, 255],
                i = $.backplane({}),
                o = $('<div class="cs-menu">').appendTo(i),
                a = $('<div class="cs-tabs">').appendTo(o).touch((function(e) {
                    var t = $(e.target);
                    t.is(".cs-tab") && (n = t.attr("data-mode"), T())
                })),
                r = $('<div class="cs-tabs-selected-indicator">'),
                c = $('<div class="cs-tab" data-mode="presets">').text(locale.presets).appendTo(a),
                d = $('<div class="cs-tab" data-mode="palette">').text(locale.palette).appendTo(a),
                h = $('<div class="cs-tab" data-mode="custom">').text("RGB").appendTo(a),
                p = $('<div class="cs-pane cs-presets">').appendTo(o).touch(k),
                u = $('<div class="cs-pane cs-palette">').appendTo(o).touch(k),
                f = $('<div class="cs-pane cs-custom">').appendTo(o),
                m = $('<div class="cs-controls">').appendTo(o);
            e.required || $('<div class="nx-button-text-small blue">').text(locale.transparent).appendTo(m).touch((function() {
                S(null)
            }));
            var g = $('<div class="cs-custom-left">').appendTo(f),
                v = $('<div class="cs-custom-right">').appendTo(f),
                b = $('<div class="cs-color">').appendTo(g).touch((function() {
                    S(util.formatColor([y.getVal(), w.getVal(), x.getVal()]))
                })),
                y = new l({
                    $parent: v,
                    min: 0,
                    max: 255,
                    val: t[0],
                    round: !0,
                    label: "R",
                    update: C
                }),
                w = new l({
                    $parent: v,
                    min: 0,
                    max: 255,
                    val: t[1],
                    round: !0,
                    label: "G",
                    update: C
                }),
                x = new l({
                    $parent: v,
                    min: 0,
                    max: 255,
                    val: t[2],
                    round: !0,
                    label: "B",
                    update: C
                });
            function T() {
                r.detach(),
                "presets" === n ? r.appendTo(c) : "palette" === n ? r.appendTo(d) : r.appendTo(h),
                c.toggleClass("selected", "presets" === n),
                d.toggleClass("selected", "palette" === n),
                h.toggleClass("selected", "custom" === n),
                p.css("display", "presets" === n ? "" : "none"),
                u.css("display", "palette" === n ? "" : "none"),
                f.css("display", "custom" === n ? "" : "none");
                var t = o.outerWidth(),
                    i = o.outerHeight(),
                    s = e.$el.offset();
                s.top += 32,
                s.left + t > window.getWidth() && (s.left = window.getWidth() - t),
                s.top + i > window.getHeight() && (s.top = window.getHeight() - i),
                o.offset(s)
            }
            function C() {
                b.css("background-color", util.formatColor([y.getVal(), w.getVal(), x.getVal()]))
            }
            function k(e) {
                var t = $(e.target);
                t.is(".cs-color") && S(t.attr("data-color"))
            }
            function S(t) {
                e.update(t),
                i.close()
            }
            !function() {
                for (var e = 0; e < s.length; e++) {
                    var t = s[e];
                    $('<div class="cs-color' + ("#FFFFFF" === t ? " cs-color-bordered" : "") + '">').css("background-color", t).attr("data-color", t).appendTo(p)
                }
            }(),
            function() {
                for (var e = 0; e < 64; e++) {
                    var t = util.indexedColor(e, 8, 8);
                    $('<div class="cs-color' + ("#FFFFFF" === t ? " cs-color-bordered" : "") + '">').css("background-color", t).attr("data-color", t).appendTo(u)
                }
            }(),
            C(),
            T()
        }
        function l(e) {
            var t = $('<div class="cs-slider">').appendTo(e.$parent),
                i = ($('<div class="cs-slider-label">').text(e.label).appendTo(t), $('<div class="cs-slider-pane">').appendTo(t)),
                o = ($('<div class="cs-slider-bar">').appendTo(i), $('<div class="cs-slider-knob">').appendTo(i)),
                n = $('<div class="cs-slider-text">').appendTo(t),
                s = $('<input type="number">').appendTo(n).change(d).blur(d);
            o[0].addEventListener(TOUCH ? EVENT_touchstart : "mousedown", (function(t) {
                if (TOUCH) {
                    if (1 !== t.touches.length)
                        return;
                    EVENT_target(t).addEventListener(EVENT_touchmove, s, !1),
                    EVENT_target(t).addEventListener(EVENT_touchend, d, !1)
                } else
                    window.addEventListener("mousemove", s, !1),
                    window.addEventListener("mouseup", d, !1);
                var o = TOUCH ? t.touches[0].clientX : t.clientX,
                    n = l;
                function s(t) {
                    if (!TOUCH || 1 === t.touches.length) {
                        var s = TOUCH ? t.touches[0].clientX : t.clientX,
                            d = n + (s - o) / (i.width() - 24) * (r - a);
                        l = Math.max(a, Math.min(r, d)),
                        e.round && (l = Math.round(l)),
                        c(),
                        e.update(l),
                        t.preventDefault()
                    }
                }
                function d(e) {
                    if (TOUCH) {
                        if (0 !== e.touches.length)
                            return;
                        EVENT_target(e).removeEventListener(EVENT_touchmove, s, !1),
                        EVENT_target(e).removeEventListener(EVENT_touchend, d, !1)
                    } else
                        window.removeEventListener("mousemove", s, !1),
                        window.removeEventListener("mouseup", d, !1);
                    e.preventDefault()
                }
                t.preventDefault()
            }));
            var a = e.min,
                r = e.max,
                l = e.val;
            function c() {
                var e = (l - a) / (r - a) * (i.width() - 24);
                o.css("left", e + "px"),
                s.val(l)
            }
            function d() {
                var t = l,
                    i = Number(s.val());
                isNaN(i) || (l = Math.max(a, Math.min(r, i)), e.round && (l = Math.round(l))),
                c(),
                t !== l && e.update && e.update(l)
            }
            c(),
            this.getVal = function() {
                return l
            }
        }
        Object.assign(a.prototype, o.a.prototype),
        a.prototype.editorClass = "color",
        a.prototype.destroy = function() {
            this.el.remove()
        },
        a.prototype.updateUI = function() {
            this.text.css({
                backgroundColor: this.value || "#fff"
            })
        },
        a.prototype.popup = function() {
            var e = this;
            new r({
                value: e.value,
                $el: e.el,
                required: e.model.field.required,
                update: function(t) {
                    e.updateModel(t)
                }
            })
        }
    },
    "./src/js/widgets/editors/Editor.js": function(e, t, i) {
        "use strict";
        function o(e, t) {
            this.container = e,
            this.model = t,
            t.onUpdate(this.onUpdate, this)
        }
        i.d(t, "a", (function() {
            return o
        })),
        o.prototype.destroy = function() {
            this.model.offUpdate(this.updateUI, this)
        },
        o.prototype.isHeightAdjustable = function() {
            return !1
        },
        o.prototype.setHeight = function() {},
        o.prototype.updateStructure = function() {},
        o.prototype.load = function(e) {
            console.log("Editor.load", this.model.field.caption);
            var t = this;
            this.model.getValue((function(i, o) {
                i ? t.setError(i) : (!e && util.equals(t.value, o) || (t.value = o, t.validate(o), t.updateUI()), t.afterLoaded())
            }))
        },
        o.prototype.afterLoaded = function() {},
        o.prototype.onUpdate = function(e, t, i, o) {
            this.load(!1)
        },
        o.prototype.updateUI = function() {},
        o.prototype.updateModel = function(e, t) {
            var i = this;
            i.model.isWritable() ? util.equals(e, i.value) ? t && t() : i.model.setValue(e, (function(e) {
                e ? (i.setError(e), t && t(e)) : t && t()
            })) : t && t()
        },
        o.prototype.validate = function(e) {
            var t = this.model.field.validate(e);
            return t ? (this.setError(t), !1) : (this.setError(void 0), !0)
        },
        o.prototype.setError = function(e) {
            this.container.setError(e)
        },
        o.prototype.createField = function(e) {
            log("Cannot create field")
        },
        o.prototype.editorUp = function() {
            this.container.editorUp && this.container.editorUp()
        },
        o.prototype.editorDown = function() {
            console.log("Editor.editorDown"),
            this.container.editorDown && this.container.editorDown()
        },
        o.prototype.getNid = function() {
            return this.container.getNid ? this.container.getNid() : this.container.nid
        }
    },
    "./src/js/widgets/editors/IconSelector.js": function(e, t, i) {
        "use strict";
        i.d(t, "b", (function() {
            return s
        })),
        i.d(t, "a", (function() {
            return a
        }));
        var o = i("./src/js/widgets/editors/Editor.js");
        const n = {
            ic: {
                prefix: "ic",
                columns: 16,
                width: 24,
                height: 24,
                margin: 4,
                background: "#fff"
            },
            dbicon: {
                prefix: "dbicon",
                columns: 8,
                width: 48,
                height: 48,
                margin: 0,
                background: "#3df"
            }
        };
        function s(e, t) {
            o.a.apply(this, arguments),
            this.el = $('<div class="stringeditor">').appendTo(e.el).touch($.proxy(this.popup, this)),
            this.text = $('<div class="input-text">').appendTo(this.el);
            var i = t.field.iconset || "ic";
            this.iconset = n[i] || n.ic,
            "ic" !== i && (this.text[0].style.height = this.iconset.height + 2 * this.iconset.margin + 4 + "px")
        }
        function a(e) {
            var t = e.iconset || n.ic,
                i = $.backplane({}),
                o = $('<div class="iconselector-menu" style="width:' + (t.width + 2 * t.margin + 8) * t.columns + "px;background-color:" + (e.background || t.background) + '">').appendTo(i).touch((function(t) {
                    var o = $(t.target).closest(".iconselector-item").attr("data-id");
                    if (!o)
                        return;
                    i.close(),
                    e.update("###NULL###" === o ? void 0 : o)
                })),
                s = 'style="width:' + t.width + "px;height:" + t.height + "px;margin:" + t.margin + 'px"',
                a = "";
            a += '<div class="iconselector-item" data-id="###NULL###" ' + s + "></div>";
            for (var r = t.icons, l = 0; l < r.length; l++) {
                var c = r[l];
                a += '<div class="iconselector-item" data-id="' + c + '" ' + s + '><div class="' + t.prefix + " " + t.prefix + "-" + c + '"></div></div>'
            }
            o.html(a);
            var d = o.outerWidth(),
                h = o.outerHeight(),
                p = e.$el.offset();
            p.top += 32,
            p.left + d > window.getWidth() && (p.left = window.getWidth() - d),
            p.top + h > window.getHeight() && (p.top = window.getHeight() - h),
            o.offset(p)
        }
        n.ic.icons = ["check", "x", "question2", "stop", "go", "power", "info", "heart", "location", "idea", "filter", "sun", "star", "forbidden", "reload", "recycle", "option", "gear", "warn2", "percent", "piechart", "barchart", "question3", "dialog", "star2", "pencil", "pencil-ruler", "tools", "hammer", "waterdrop", "goal", "disclosed", "home", "cart", "key", "money", "moneybag", "trash", "world", "lock", "lock2", "key2", "cart2", "add-to-cart", "present", "binoculars", "palette", "camera", "facebook", "linkedin", "twitter", "apple", "paypal", "googleplus", "instagram", "youtube", "dropbox", "playstation", "messenger", "appstore", "google", "photos", "phone", "calendar", "calendar2", "letter", "phone2", "smartphone", "display", "heartbeat", "download", "headset", "printer", "sdcard", "gamepad", "cube", "cardgame", "tentacle", "music", "bell", "books", "book", "clock", "instrument", "speaker", "microphone", "megaphone", "record", "guitar", "sound", "reel", "flap", "movie", "iso", "bookmark", "landscape", "at", "html", "calendar3", "note", "glider", "document", "checklist", "checklist2", "list", "video", "call-accept", "call-end", "battery", "face", "face2", "person-paper", "man", "man2", "woman1", "man3", "person", "people", "graduate", "discussion", "face-idea", "bball", "whistle", "thumb-up", "thumb-down", "point-up", "point-down", "point-left", "calculate", "shake-hands", "get-money", "pay-money", "pay-card", "sign", "creditcard", "banknotes", "qna", "delivery", "plane", "truck", "digger", "car", "light", "rack", "factory", "robot", "forklift", "football", "tennis", "basketball", "bike", "running", "holiday", "burger", "pizza", "grocery", "coffee", "cherry", "raspberry", "banana", "whine-cheese", "plate", "balloon", "highheel", "shoe", "shirt", "tie", "umbrella", "tube", "emergency", "stroke", "brain", "lunges", "shot", "cancer", "male", "female", "dog", "bird", "fish", "horse", "pig", "chicken", "elephant", "fish2", "butterfly", "cat", "plant", "arrow1", "arrow2", "arrow3", "arrow4", "arrow5", "arrow6", "arrow7", "arrow8", "percent0", "percent25", "percent50", "percent75", "percent100", "yinyang", "happy", "unhappy", "loughing", "astounded", "irritated", "cool", "silent", "joking", "sad", "crying", "loving", "evil", "attachment", "linked", "quote", "mailbox", "folder", "folder-documents", "folder-downloads", "folder-pictures", "folder-people", "folder-music", "folder-world", "folder-burning", "folder-heart", "folder-tile", "play", "play2", "pause", "stop2", "rec", "arrow-n", "arrow-ne", "arrow-e", "arrow-se", "arrow-s", "arrow-sw", "arrow-w", "arrow-nw", "ball-0", "ball-25", "ball-50", "ball-75", "ball-100", "warn", "question", "done", "smile-happy", "smile-not-amused", "smile-unhappy", "smile-astonished", "smile-blink"],
        n.dbicon.icons = ["database", "person", "team", "location", "info", "document", "chart", "folder", "clipboard"],
        Object.assign(s.prototype, o.a.prototype),
        s.prototype.editorClass = "icon",
        s.prototype.destroy = function() {
            this.el.remove(),
            o.a.prototype.destroy.apply(this, arguments)
        },
        s.prototype.updateUI = function() {
            var e = this.iconset;
            this.value ? this.text[0].innerHTML = '<div class="choice-icon ' + e.prefix + " " + e.prefix + "-" + this.value + '"></div>' : this.text[0].innerHTML = "",
            this.text[0].style.backgroundColor = this.model.field.background || ""
        },
        s.prototype.popup = function() {
            var e = this;
            new a({
                iconset: e.iconset,
                background: e.model.field.background,
                $el: e.el,
                update: function(t) {
                    e.updateModel(t)
                }
            })
        }
    },
    "./src/js/widgets/editors/StringEditor.js": function(e, t, i) {
        "use strict";
        i.d(t, "a", (function() {
            return n
        }));
        var o = i("./src/js/widgets/editors/Editor.js");
        function n(e, t) {
            o.a.apply(this, arguments),
            this.updating = !1,
            this.editing = !1,
            this.isBarcode = !1,
            this.el = $('<div class="stringeditor">').appendTo(e.el),
            this.originalString = null,
            this.input = null,
            this.$aux = null,
            this.button = null,
            this._showAuxTimer = null,
            this.createRenderer()
        }
        Object.assign(n.prototype, o.a.prototype),
        n.prototype.editorClass = "string",
        n.prototype.hideButtonOnEmpty = !0,
        n.prototype.inputType = "text",
        n.prototype.inputStyle = null,
        n.prototype.destroy = function() {
            this.stopEdit(),
            this.el.remove(),
            o.a.prototype.destroy.apply(this, arguments)
        },
        n.prototype.focus = function() {
            console.log("string editor -> focus"),
            this.startEdit()
        },
        n.prototype.blur = function() {
            if (console.log("string editor -> blur"), this.editing)
                try {
                    this.input.blur()
                } catch (e) {
                    console.log("StringEditor failed to blur", e)
                }
        },
        n.prototype.startEdit = function() {
            if (console.log("string editor -> startEdit"), !this.editing && this.model.isWritable()) {
                var e = this.model.field;
                this.editing = !0,
                this.createEditor(),
                this.updateUI(),
                this.input.focus(),
                e.stringMultiline || TOUCH || this.input.select()
            }
        },
        n.prototype.stopEdit = function() {
            console.log("string editor -> stopEdit"),
            this.editing && (this.editing = !1, this.destroyEditor(), this.updateUI())
        },
        n.prototype.updateStructure = function() {
            var e = this.model.field;
            e.base === this.base && e.stringMultiline === this.stringMultiline || (this.destroyRenderer(), this.createRenderer())
        },
        n.prototype.createRenderer = function() {
            if (!this.text) {
                var e = this.model.field,
                    t = e.base;
                this.base = t,
                this.editorClass = t,
                this.stringMultiline = e.stringMultiline,
                e.stringMultiline ? this.text = $('<div class="input-text text-selectable multiline" style="height:' + (24 * e.height + 8) + 'px">').appendTo(this.el).touch($.proxy(this.container.focus, this.container)) : this.text = $('<div class="input-text text-selectable">').appendTo(this.el).touch($.proxy(this.container.focus, this.container)),
                this.createButton()
            }
        },
        n.prototype.destroyRenderer = function() {
            this.text && (this.text.remove(), this.text = void 0),
            this.destroyButton()
        },
        n.prototype.createButton = function() {},
        n.prototype.destroyButton = function() {
            this.button && (this.button.remove(), this.button = void 0)
        },
        n.prototype.isHeightAdjustable = function() {
            return "string" === this.model.field.base
        },
        n.prototype.setHeight = function(e) {
            var t = this.model.field;
            if ("string" === t.base) {
                var i = t.height,
                    o = t.stringMultiline,
                    n = Math.max(1, Math.round((e - 42) / 24)),
                    s = 1 !== n;
                s !== o ? (t.stringMultiline = s, t.height = n, this.destroyRenderer(), this.createRenderer(), this.updateUI()) : n !== i && (this.text.css("height", 24 * n + 8), t.height = n)
            }
        },
        n.prototype.createEditor = function() {
            var e = this.model.field,
                t = e.base;
            if (this.text.css("display", "none"), e.stringMultiline)
                this.input = $('<textarea rows="' + e.height + '">').insertAfter(this.text).keydown($.proxy(this.keydown, this)).keyup($.proxy(this.keyup, this)).change($.proxy(this.onChange, this)),
                this.input.focusout($.proxy(this.onBlur, this)),
                e.stringAutocorrect || this.input.attr("autocomplete", "off").attr("autocorrect", "off").attr("spellcheck", "false");
            else {
                var i = this.inputType,
                    o = this.inputStyle ? ' style="' + this.inputStyle + '"' : "",
                    n = e.stringAutocorrect && "string" === t ? "" : ' autocomplete="off" autocorrect="off" spellcheck="false"';
                this.input = $('<input type="' + i + '"' + o + n + ">").insertAfter(this.text).keydown($.proxy(this.keydown, this)).keyup($.proxy(this.keyup, this)).change($.proxy(this.onChange, this)),
                this.input.focusin($.proxy(this.onFocus, this)),
                this.input.focusout($.proxy(this.onBlur, this))
            }
            $.pushInputHandler(this)
        },
        n.prototype.keydown = function(e) {
            if (!1 !== this.keydownCallback(e))
                switch (e.which) {
                case 9:
                    e.shiftKey ? this.container.focusPrev() : this.container.focusNext(),
                    e.preventDefault();
                    break;
                case 13:
                    this.stringMultiline || (this.blur(), this.model.onReturn && this.model.onReturn());
                    break;
                case 27:
                    this.stopEdit(),
                    this.model.onReturn && this.model.onEscape();
                    break;
                case 38:
                    this.stringMultiline || (this.editorUp(), e.preventDefault());
                    break;
                case 40:
                    this.stringMultiline || (this.editorDown(), e.preventDefault())
                }
        },
        n.prototype.keydownCallback = function(e) {},
        n.prototype.keyup = function(e) {
            this.keyupCallback(e)
        },
        n.prototype.keyupCallback = function(e) {},
        n.prototype.destroyEditor = function() {
            this.model.field.base;
            this.input && this.input.remove(),
            this.input = null,
            $.popInputHandler(this),
            this.text.css("display", ""),
            this.stopShowAux()
        },
        n.prototype.showAux = function() {},
        n.prototype.startShowAux = function() {
            this.$aux || this.showAux()
        },
        n.prototype.stopShowAux = function() {
            this.$aux && this.hideAux()
        },
        n.prototype.hideAux = function() {},
        n.prototype.updateUI = function() {
            var e = this.model.field,
                t = e.base;
            if (!this.updating)
                if (this.editing)
                    if ("choice" === t || "boolean" === t || "user" === t || "dchoice" === t || "ref" === t)
                        e.loadValue(this.getNid(), this.value, e => {
                            var t = e ? e.caption || String(e.id) : "";
                            this.originalString = t,
                            this.input.val(t),
                            this.button && (this.button[0].style.display = "none"),
                            this.startShowAux()
                        });
                    else {
                        var i = this.formatEditorValue(this.value);
                        this.originalString = i,
                        this.input.val(i),
                        this.button && (this.button[0].style.display = "none"),
                        this.startShowAux()
                    }
                else {
                    var o = this.el[0],
                        n = this.text[0];
                    if ("choice" === t || "boolean" === t || "user" === t || "dchoice" === t || "ref" === t)
                        e.loadValue(this.getNid(), this.value, e => {
                            var t = "",
                                i = "",
                                s = "";
                            void 0 !== e ? (e.icon && (t += '<div class="choice-icon ic ic-' + e.icon + '"></div>'), t += "<span>" + htmlEscape(e.caption) + "</span>", i = e.color || "", s = e.textColor || "") : "placeholder" === this.model.field.labelPosition && (t = htmlEscape(this.model.field.caption), s = "#999"),
                            n.innerHTML = t,
                            o.style.backgroundColor = i,
                            o.style.color = s
                        });
                    else
                        (i = this.model.field.format(this.value)) ? (n.innerHTML = htmlEscape(i), n.style.color = "") : "placeholder" === this.model.field.labelPosition ? (n.innerHTML = htmlEscape(this.model.field.caption), n.style.color = "#999") : (n.innerHTML = "", n.style.color = "");
                    this.button && (this.value || !this.hideButtonOnEmpty ? this.button[0].style.display = "" : this.button[0].style.display = "none")
                }
        },
        n.prototype.onChange = function() {
            this.isBarcode && (this.isBarcode = !1, this._onBlur())
        },
        n.prototype.onFocus = function() {},
        n.prototype.onBlur = async function() {
            await NinoxViewController.isBarcodeScannerActive() ? this.isBarcode = !0 : this._onBlur()
        },
        n.prototype._onBlur = function() {
            if (!this.updating && this.editing) {
                var e = this.input.val();
                if (e === this.originalString)
                    this.stopEdit();
                else {
                    this.updating = !0;
                    var t = this.parseEditorValue(e),
                        i = this;
                    i.updateModel(t, (function(e) {
                        i.updating = !1,
                        i.stopEdit()
                    }))
                }
            }
        },
        n.prototype.save = function() {
            if (!this.updating && this.editing && this.input.is(":focus")) {
                var e = this.input.val();
                if (e !== this.originalString) {
                    var t = this.parseEditorValue(e);
                    this.updateModel(t, (function(e) {}))
                }
            }
        },
        n.prototype.parseEditorValue = function(e) {
            return this.model.field.parseEditor(e)
        },
        n.prototype.formatEditorValue = function(e) {
            return this.model.field.formatEditor(e)
        },
        n.prototype.resizeAux = function() {
            var e = this.$aux;
            if (e) {
                var t = this.el.offset(),
                    i = window.getWidth(),
                    o = window.getHeight(),
                    n = t.left,
                    s = t.top + 36,
                    a = e.outerWidth(),
                    r = e.outerHeight();
                r > o - s && (o - s >= t.top - 4 ? r = o - s : (r = Math.min(t.top - 4, r), s = t.top - 4 - r)),
                n + a > i && (n = i - a),
                e.css({
                    left: n,
                    top: s,
                    height: r
                })
            }
        }
    },
    "./src/js/widgets/widgets.js": function(e, t, i) {
        "use strict";
        i.d(t, "a", (function() {
            return Q
        })),
        i.d(t, "b", (function() {
            return Z
        })),
        i.d(t, "c", (function() {
            return ee
        })),
        i.d(t, "d", (function() {
            return te
        }));
        var o = i("./src/js/widgets/editors/StringEditor.js");
        function n(e, t) {
            o.a.apply(this, arguments)
        }
        function s(e, t) {
            o.a.apply(this, arguments)
        }
        function a(e, t) {
            o.a.apply(this, arguments)
        }
        function r(e, t) {
            o.a.apply(this, arguments)
        }
        Object.assign(n.prototype, o.a.prototype),
        n.prototype.editorClass = "appointment",
        n.prototype.showAux = function() {
            if (!this.$aux) {
                var e = this,
                    t = this.model.field,
                    i = t.base,
                    o = this.input,
                    n = this.$aux = $('<div class="stringeditor-aux appointment-picker">').on(TOUCH ? EVENT_touchstart : "mousedown", (function(e) {
                        e.preventDefault()
                    })).appendTo($(document.body)),
                    s = $('<div class="appointment-picker-start">').appendTo(n).on(TOUCH ? EVENT_touchstart : "mousedown", (function(e) {
                        y = !0,
                        T(),
                        e.preventDefault()
                    })),
                    a = $('<div class="appointment-picker-end">').appendTo(n).on(TOUCH ? EVENT_touchstart : "mousedown", (function(e) {
                        y = !1,
                        T(),
                        e.preventDefault()
                    })),
                    r = $('<div class="appointment-picker-dp dp timestamp">').appendTo(n),
                    l = $('<div class="dp-head">').appendTo(r),
                    c = $('<div class="dp-days">').appendTo(r),
                    d = $('<div class="dp-month">').appendTo(r).on(TOUCH ? EVENT_touchstart : "mousedown", (function(e) {
                        var t = $(e.target).attr("data-date");
                        if (t) {
                            var i = y ? v : b,
                                o = util.parseISODate(t),
                                n = new Date(o),
                                s = i ? new Date(i) : new Date;
                            C(new Date(n.getFullYear(), n.getMonth(), n.getDate(), s.getHours(), s.getMinutes(), s.getSeconds(), s.getMilliseconds())),
                            e.preventDefault()
                        }
                    }));
                $('<div class="i-48-24 i-light-grey i-arrow-solid-left dp-prev">').appendTo(l).on(TOUCH ? EVENT_touchstart : "mousedown", (function(e) {
                    g = new Date(g.getFullYear(), g.getMonth() - 1, g.getDate()),
                    T(),
                    e.preventDefault()
                })),
                $('<div class="i-48-24 i-light-grey i-arrow-solid-right dp-next">').appendTo(l).on(TOUCH ? EVENT_touchstart : "mousedown", (function(e) {
                    g = new Date(g.getFullYear(), g.getMonth() + 1, g.getDate()),
                    T(),
                    e.preventDefault()
                }));
                for (var h = $('<div class="dp-title">Oktober 2015</div>').appendTo(l), p = 0; p < 7; p++) {
                    var u = (locale.firstDayOfWeek + p) % 7;
                    $('<div class="dp-days-day">' + htmlEscape(locale.dayNamesShort[u]) + "</div>").appendTo(c)
                }
                var f = $('<div class="dp-time">').appendTo(r).on(TOUCH ? EVENT_touchstart : "mousedown", (function(e) {
                        var t = y ? v : b,
                            i = $(e.target);
                        if (i.is(".dp-time-am")) {
                            var o = t ? new Date(t) : new Date;
                            (n = o.getHours()) >= 12 && (n -= 12, o.setHours(n)),
                            C(o),
                            e.preventDefault()
                        } else if (i.is(".dp-time-pm")) {
                            o = t ? new Date(t) : new Date;
                            (n = o.getHours()) < 12 && (n += 12, o.setHours(n)),
                            C(o),
                            e.preventDefault()
                        } else if (i.is(".dp-time-cell")) {
                            var n = i.attr("data-h"),
                                s = i.attr("data-m");
                            if (n)
                                (o = t ? new Date(t) : new Date).setHours(Number(n)),
                                C(o);
                            else if (s) {
                                (o = t ? new Date(t) : new Date).setMinutes(Number(s)),
                                C(o)
                            }
                            e.preventDefault()
                        }
                    })),
                    m = new Date,
                    g = new Date,
                    v = null,
                    b = null,
                    y = !0;
                this.resizeAux = w,
                window.addEventListener("resize", this.resizeAux, !1),
                this.$scrollPane = e.el.closest(".object")[0],
                this.$scrollPane && this.$scrollPane.addEventListener("scroll", this.resizeAux, !1),
                w(),
                x(),
                o.keyup(x).change(x)
            }
            function w() {
                var t,
                    i,
                    o = e.el.offset(),
                    s = window.getWidth(),
                    a = window.getHeight(),
                    r = 452;
                o.top + 36 + 372 > a ? o.top - 372 < 20 ? (i = 20, t = o.left - r - 8 >= 0 ? o.left - r - 8 : o.left + e.el.width() + 8) : (i = o.top - 372, t = o.left + r > s ? s - r : o.left) : (i = o.top + 36, t = o.left + r > s ? s - r : o.left),
                n.css({
                    left: t,
                    top: i
                })
            }
            function x() {
                var e = o.val(),
                    i = e ? t.parseEditor(e) : void 0;
                if (v = null, b = null, i) {
                    var n = i.split("/");
                    if (2 === n.length) {
                        var s = Number(n[0]),
                            a = s + Number(n[1]);
                        v = new Date(s),
                        b = new Date(a)
                    }
                }
                T()
            }
            function T() {
                y ? (s.addClass("selected"), a.removeClass("selected")) : (s.removeClass("selected"), a.addClass("selected")),
                s.text(v ? util.formatLocaleDateTime(v) : locale.appointmentBegin),
                a.text(b ? util.formatLocaleDateTime(b) : locale.appointmentEnd),
                function() {
                    var e = y ? v : b,
                        t = g.getFullYear(),
                        o = g.getMonth(),
                        n = (g.getDate(), new Date(t, o, 1)),
                        s = (util.getWeek(n), n.getDay()),
                        a = locale.firstDayOfWeek,
                        r = s > a ? a - s + 1 : a - s - 6,
                        l = new Date(n.getFullYear(), n.getMonth(), r);
                    h.text(locale.monthNames[o] + " " + t);
                    for (var c = "", p = 0; p < 6; p++) {
                        c += '<div class="dp-month-week">';
                        for (var u = 0; u < 7; u++) {
                            var f = new Date(l.getFullYear(), l.getMonth(), l.getDate() + 7 * p + u);
                            c += '<div class="dp-month-week-day' + (f.getMonth() === o ? " current-month" : " other-month") + (f.getFullYear() === m.getFullYear() && f.getMonth() === m.getMonth() && f.getDate() === m.getDate() ? " today" : "") + (e && f.getFullYear() === e.getFullYear() && f.getMonth() === e.getMonth() && f.getDate() === e.getDate() ? " selected" : "") + '" data-date="' + util.formatISODate(f) + '">' + f.getDate() + "</div>"
                        }
                        c += "</div>"
                    }
                    d.html(c),
                    "timestamp" === i && updateTime()
                }(),
                function() {
                    var e = y ? v : b,
                        t = null,
                        i = null;
                    e && (t = e.getHours(), i = e.getMinutes(), e.getSeconds());
                    var o = t < 12,
                        n = null == i ? null : 5 * Math.round(i / 5),
                        s = "";
                    s += '<div class="dp-time-ampm"><div class="dp-time-am' + (o ? " selected" : "") + '">am</div><div class="dp-time-pm' + (o ? "" : " selected") + '">pm</div></div>',
                    s += '<div class="dp-time-hour">';
                    for (var a = 0; a < 6; a++) {
                        var r = 2 * a + (o ? 0 : 12),
                            l = r + 1,
                            c = locale.time24Hours ? r : r % 12 == 0 ? 12 : r % 12,
                            d = locale.time24Hours ? l : l % 12 == 0 ? 12 : l % 12;
                        s += '<div class="dp-time-row"><div class="dp-time-cell' + (r === t ? " selected" : "") + '" data-h="' + r + '">' + (c < 10 ? "0" : "") + c + '</div><div class="dp-time-cell' + (l === t ? " selected" : "") + '" data-h="' + l + '">' + (d < 10 ? "0" : "") + d + "</div></div>"
                    }
                    s += "</div>",
                    s += '<div class="dp-time-minute">';
                    for (a = 0; a < 6; a++) {
                        var h = 10 * a,
                            p = h + 5;
                        s += '<div class="dp-time-row"><div class="dp-time-cell' + (h === n ? " selected" : "") + '" data-m="' + h + '">' + (h < 10 ? "0" : "") + h + '</div><div class="dp-time-cell' + (p === n ? " selected" : "") + '" data-m="' + p + '">' + (p < 10 ? "0" : "") + p + "</div></div>"
                    }
                    s += "</div>",
                    f.html(s)
                }()
            }
            function C(e) {
                if (y) {
                    var i = null != v && null != b ? b.getTime() - v.getTime() : 36e5;
                    (s = (a = e.getTime()) + i) < a && (s = a);
                    var n = a + "/" + (s - a);
                    o.val(t.formatEditor(n)),
                    x()
                } else {
                    var s,
                        a;
                    (s = e.getTime()) < (a = null != v ? v.getTime() : s) && (s = a);
                    n = a + "/" + (s - a);
                    o.val(t.formatEditor(n)),
                    x()
                }
            }
        },
        n.prototype.hideAux = function() {
            this.$aux && (window.removeEventListener("resize", this.resizeAux, !1), this.$scrollPane && this.$scrollPane.removeEventListener("scroll", this.resizeAux, !1), this.$scrollPane = void 0, this.resizeAux = void 0, this.$aux.remove(), this.$aux = null)
        },
        Object.assign(s.prototype, o.a.prototype),
        s.prototype.inputType = "number",
        s.prototype.editorClass = "number",
        s.prototype.parseEditorValue = function(e) {
            return e ? Number(e) : null
        },
        s.prototype.formatEditorValue = function(e) {
            return null != e ? String(e) : ""
        },
        Object.assign(a.prototype, o.a.prototype),
        a.prototype.editorClass = "number",
        Object.assign(r.prototype, o.a.prototype),
        r.prototype.inputType = "email",
        r.prototype.editorClass = "email",
        r.prototype.createButton = function() {
            this.button = $('<div class="stringeditor-button"><div class="i-32-18 i-light-grey i-field-email"></div></div>').css("display", "none").click($.proxy(this.sendMail, this)).appendTo(this.el)
        },
        r.prototype.sendMail = async function() {
            if (this.value) {
                var e = database.loadNodeSync(this.model.container.nid);
                if (e) {
                    var t = this.model.field,
                        i = "",
                        o = "";
                    if (t.emailSubject)
                        try {
                            var n = queries.parseSystemStringTemplate(t.type.schema, t.type, t.emailSubject, {});
                            i = await n.promise(database, e)
                        } catch (e) {
                            return $.alert(e)
                        }
                    if (t.emailBody)
                        try {
                            n = queries.parseSystemStringTemplate(t.type.schema, t.type, t.emailBody, {});
                            o = await n.promise(database, e)
                        } catch (e) {
                            return $.alert(e)
                        }
                    var s = "mailto:" + encodeURIComponent(this.value);
                    (i || o) && (s += "?", i && (s += "subject=" + encodeURIComponent(String(i)), o && (s += "&")), o && (s += "body=" + encodeURIComponent(String(o)))),
                    NinoxDocumentInteraction.openBrowser(s)
                }
            }
        };
        i("./node_modules/core-js/modules/es.string.replace.js");
        function l(e, t) {
            o.a.apply(this, arguments)
        }
        function c(e, t) {
            o.a.apply(this, arguments)
        }
        function d(e, t) {
            o.a.apply(this, arguments)
        }
        Object.assign(l.prototype, o.a.prototype),
        l.prototype.editorClass = "phone",
        l.prototype.inputType = "tel",
        l.prototype.createButton = function() {
            this.button = $('<div class="stringeditor-button"><div class="i-32-18 i-light-grey i-field-phone"></div></div>').css("display", "none").click($.proxy(this.openPhone, this)).appendTo(this.el)
        },
        l.prototype.openPhone = function() {
            if (this.value) {
                var e = String(this.value).replace(/[\/]/g, "-");
                NinoxDocumentInteraction.openBrowser("tel://" + encodeURIComponent(e))
            }
        },
        Object.assign(c.prototype, o.a.prototype),
        c.prototype.editorClass = "date",
        c.prototype.showAux = function() {
            if (!this.$aux) {
                var e = this,
                    t = this.model.field,
                    i = t.base,
                    o = "datx" === i ? "date" : i,
                    n = this.input,
                    s = this.$aux = $('<div class="stringeditor-aux dp ' + o + '">').on(TOUCH ? EVENT_touchstart : "mousedown", (function(e) {
                        e.preventDefault()
                    })).appendTo($(document.body)),
                    a = $('<div class="dp-head">').appendTo(s),
                    r = $('<div class="dp-days">').appendTo(s),
                    l = $('<div class="dp-month">').appendTo(s).on(TOUCH ? EVENT_touchstart : "mousedown", (function(e) {
                        var o = $(e.target).attr("data-date");
                        if (o)
                            if ("datx" === i) {
                                var s = util.parseISODatx(o);
                                n.val(t.formatEditor(s)),
                                n.blur()
                            } else if ("date" === i) {
                                s = util.parseISODate(o);
                                n.val(t.formatEditor(s)),
                                n.blur()
                            } else if ("timestamp" === i) {
                                s = util.parseISODate(o);
                                var a = new Date(s),
                                    r = m ? new Date(m) : new Date,
                                    l = new Date(a.getFullYear(), a.getMonth(), a.getDate(), r.getHours(), r.getMinutes(), r.getSeconds(), r.getMilliseconds());
                                n.val(t.formatEditor(l.getTime())),
                                b(),
                                e.preventDefault()
                            }
                    })),
                    c = $('<div class="dp-foot">').appendTo(s);
                $('<div class="nx-button-text grey">').text(locale.clear).appendTo(c).on(TOUCH ? EVENT_touchstart : "mousedown", (function(e) {
                    n.val(""),
                    n.blur()
                })),
                $('<div class="nx-hspace-flex">').appendTo(c),
                $('<div class="nx-button-text blue">').text("timestamp" === i ? locale.op_now : locale.op_today).appendTo(c).on(TOUCH ? EVENT_touchstart : "mousedown", (function(e) {
                    var o = new Date;
                    if ("datx" === i)
                        n.val(t.formatEditor(Date.UTC(o.getFullYear(), o.getMonth(), o.getDate(), 0, 0, 0, 0)));
                    else {
                        var s = "timestamp" === i ? o : new Date(o.getFullYear(), o.getMonth(), o.getDate());
                        n.val(t.formatEditor(s.getTime()))
                    }
                    n.blur()
                })),
                $('<div class="i-48-24 i-light-grey i-arrow-solid-left dp-prev">').appendTo(a).on(TOUCH ? EVENT_touchstart : "mousedown", (function() {
                    f = new Date(f.getFullYear(), f.getMonth() - 1, f.getDate()),
                    y()
                })),
                $('<div class="i-48-24 i-light-grey i-arrow-solid-right dp-next">').appendTo(a).on(TOUCH ? EVENT_touchstart : "mousedown", (function() {
                    f = new Date(f.getFullYear(), f.getMonth() + 1, f.getDate()),
                    y()
                }));
                for (var d = $('<div class="dp-title">Oktober 2015</div>').appendTo(a), h = 0; h < 7; h++) {
                    var p = (locale.firstDayOfWeek + h) % 7;
                    $('<div class="dp-days-day">' + htmlEscape(locale.dayNamesShort[p]) + "</div>").appendTo(r)
                }
                var u = new Date,
                    f = new Date,
                    m = null,
                    g = null;
                "timestamp" === i && (g = $('<div class="dp-time">').appendTo(s).on(TOUCH ? EVENT_touchstart : "mousedown", (function(e) {
                    var i = $(e.target);
                    if (i.is(".dp-time-am")) {
                        var o = m ? new Date(m) : new Date;
                        (s = o.getHours()) >= 12 && (s -= 12, o.setHours(s)),
                        n.val(t.formatEditor(o.getTime())),
                        b(),
                        e.preventDefault()
                    } else if (i.is(".dp-time-pm")) {
                        o = m ? new Date(m) : new Date;
                        (s = o.getHours()) < 12 && (s += 12, o.setHours(s)),
                        n.val(t.formatEditor(o.getTime())),
                        b(),
                        e.preventDefault()
                    } else if (i.is(".dp-time-cell")) {
                        var s = i.attr("data-h"),
                            a = i.attr("data-m");
                        if (s)
                            (o = m ? new Date(m) : new Date).setHours(Number(s)),
                            n.val(t.formatEditor(o.getTime())),
                            b();
                        else if (a) {
                            (o = m ? new Date(m) : new Date).setMinutes(Number(a)),
                            n.val(t.formatEditor(o.getTime())),
                            b()
                        }
                        e.preventDefault()
                    }
                }))),
                this.resizeAux = v,
                window.addEventListener("resize", this.resizeAux, !1),
                this.$scrollPane = e.el.closest(".object")[0],
                this.$scrollPane && this.$scrollPane.addEventListener("scroll", this.resizeAux, !1),
                v(),
                b(),
                n.keyup(b).change(b)
            }
            function v() {
                const t = "date" === o ? 280 : 452;
                var i,
                    n,
                    a = e.el.offset(),
                    r = window.getWidth(),
                    l = window.getHeight(),
                    c = t;
                a.top + 36 + 372 > l ? a.top - 372 < 20 ? (n = a.top + 372 + 20 > l ? 0 : 20, i = a.left - c - 8 >= 0 ? a.left - c - 8 : a.left + e.el.width() + 8 + c <= r ? a.left + e.el.width() + 8 : a.left) : (n = a.top - 372, i = a.left + c > r ? r - c : a.left) : (n = a.top + 36, i = a.left + c > r ? r - c : a.left),
                s.css({
                    left: i,
                    top: n
                })
            }
            function b() {
                var e = n.val(),
                    o = e ? t.parseEditor(e) : void 0;
                if (null != o) {
                    var s = new Date(o);
                    "datx" === i && (s = new Date(s.getUTCFullYear(), s.getUTCMonth(), s.getUTCDate())),
                    isNaN(s.getTime()) || (f = s, m = s)
                }
                y()
            }
            function y() {
                var e = f.getFullYear(),
                    t = f.getMonth(),
                    o = (f.getDate(), new Date(e, t, 1)),
                    n = (util.getWeek(o), o.getDay()),
                    s = locale.firstDayOfWeek,
                    a = n > s ? s - n + 1 : s - n - 6,
                    r = new Date(o.getFullYear(), o.getMonth(), a);
                d.text(locale.monthNames[t] + " " + e);
                for (var c = "", h = 0; h < 6; h++) {
                    c += '<div class="dp-month-week">';
                    for (var p = 0; p < 7; p++) {
                        var v = new Date(r.getFullYear(), r.getMonth(), r.getDate() + 7 * h + p);
                        c += '<div class="dp-month-week-day' + (v.getMonth() === t ? " current-month" : " other-month") + (v.getFullYear() === u.getFullYear() && v.getMonth() === u.getMonth() && v.getDate() === u.getDate() ? " today" : "") + (m && v.getFullYear() === m.getFullYear() && v.getMonth() === m.getMonth() && v.getDate() === m.getDate() ? " selected" : "") + '" data-date="' + util.formatISODate(v) + '">' + v.getDate() + "</div>"
                    }
                    c += "</div>"
                }
                l.html(c),
                "timestamp" === i && function() {
                    var e = null,
                        t = null;
                    m && (e = m.getHours(), t = m.getMinutes(), m.getSeconds());
                    var i = e < 12,
                        o = null == t ? null : 5 * Math.round(t / 5),
                        n = "";
                    n += '<div class="dp-time-ampm"><div class="dp-time-am' + (i ? " selected" : "") + '">am</div><div class="dp-time-pm' + (i ? "" : " selected") + '">pm</div></div>',
                    n += '<div class="dp-time-hour">';
                    for (var s = 0; s < 6; s++) {
                        var a = 2 * s + (i ? 0 : 12),
                            r = a + 1,
                            l = locale.time24Hours ? a : a % 12 == 0 ? 12 : a % 12,
                            c = locale.time24Hours ? r : r % 12 == 0 ? 12 : r % 12;
                        n += '<div class="dp-time-row"><div class="dp-time-cell' + (a === e ? " selected" : "") + '" data-h="' + a + '">' + (l < 10 ? "0" : "") + l + '</div><div class="dp-time-cell' + (r === e ? " selected" : "") + '" data-h="' + r + '">' + (c < 10 ? "0" : "") + c + "</div></div>"
                    }
                    for (n += "</div>", n += '<div class="dp-time-minute">', s = 0; s < 6; s++) {
                        var d = 10 * s,
                            h = d + 5;
                        n += '<div class="dp-time-row"><div class="dp-time-cell' + (d === o ? " selected" : "") + '" data-m="' + d + '">' + (d < 10 ? "0" : "") + d + '</div><div class="dp-time-cell' + (h === o ? " selected" : "") + '" data-m="' + h + '">' + (h < 10 ? "0" : "") + h + "</div></div>"
                    }
                    n += "</div>",
                    g.html(n)
                }()
            }
        },
        c.prototype.hideAux = function() {
            this.$aux && (window.removeEventListener("resize", this.resizeAux, !1), this.$scrollPane && this.$scrollPane.removeEventListener("scroll", this.resizeAux, !1), this.$scrollPane = void 0, this.resizeAux = void 0, this.$aux.remove(), this.$aux = null)
        },
        Object.assign(d.prototype, o.a.prototype),
        d.prototype.editorClass = "time",
        d.prototype.showAux = function() {
            if (!this.$aux) {
                var e = this,
                    t = this.model.field,
                    i = t.base,
                    o = this.input,
                    n = this.$aux = $('<div class="stringeditor-aux dp ' + i + '">').on(TOUCH ? EVENT_touchstart : "mousedown", (function(e) {
                        e.preventDefault()
                    })).appendTo($(document.body)),
                    s = null,
                    a = $('<div class="dp-time">').appendTo(n).on(TOUCH ? EVENT_touchstart : "mousedown", (function(e) {
                        var t = $(e.target);
                        if (console.log("$target", t), t.is(".dp-time-am")) {
                            var i = null != s ? s : 0,
                                n = Math.floor(i / 36e5),
                                a = Math.floor(s % 36e5 / 6e4);
                            n >= 12 && (n -= 12),
                            r(n, a),
                            e.preventDefault()
                        } else if (t.is(".dp-time-pm")) {
                            i = null != s ? s : 0,
                            n = Math.floor(i / 36e5),
                            a = Math.floor(s % 36e5 / 6e4);
                            n < 12 && (n += 12),
                            r(n, a),
                            e.preventDefault()
                        } else if (t.is(".dp-time-cell")) {
                            i = null != s ? s : 0;
                            var l = Math.floor(i / 36e5),
                                c = Math.floor(s % 36e5 / 6e4),
                                d = t.attr("data-h"),
                                h = t.attr("data-m");
                            d ? r(d, c) : h && r(l, h),
                            e.preventDefault()
                        } else if (t.is("#dp-time-now")) {
                            var p = new Date;
                            r(p.getHours(), p.getMinutes()),
                            o.blur()
                        }
                    }));
                this.resizeAux = l,
                window.addEventListener("resize", this.resizeAux, !1),
                this.$scrollPane = e.el.closest(".object")[0],
                this.$scrollPane && this.$scrollPane.addEventListener("scroll", this.resizeAux, !1),
                l(),
                c(),
                o.keyup(c).change(c)
            }
            function r(e, i) {
                o.val(t.formatEditor(36e5 * e + 6e4 * i)),
                c()
            }
            function l() {
                var t,
                    i,
                    o = e.el.offset(),
                    s = window.getWidth(),
                    a = window.getHeight(),
                    r = 180;
                o.top + 36 + 308 > a ? o.top - 308 < 20 ? (i = 20, t = o.left - r - 8 >= 0 ? o.left - r - 8 : o.left + e.el.width() + 8) : (i = o.top - 308, t = o.left + r > s ? s - r : o.left) : (i = o.top + 36, t = o.left + r > s ? s - r : o.left),
                n.css({
                    left: t,
                    top: i
                })
            }
            function c() {
                var e = o.val(),
                    i = e ? t.parseEditor(e) : void 0;
                s = null != i ? i : null,
                function() {
                    var e = null,
                        t = null;
                    null != s && (e = Math.floor(s / 36e5), t = Math.floor(s % 36e5 / 6e4));
                    var i = e < 12,
                        o = null == t ? null : 5 * Math.round(t / 5),
                        n = "";
                    n += '<div class="dp-time-ampm"><div class="dp-time-am' + (i ? " selected" : "") + '">am</div><div class="dp-time-pm' + (i ? "" : " selected") + '">pm</div></div>',
                    n += '<div class="dp-time-hour">';
                    for (var r = 0; r < 6; r++) {
                        var l = 2 * r + (i ? 0 : 12),
                            c = l + 1,
                            d = locale.time24Hours ? l : l % 12 == 0 ? 12 : l % 12,
                            h = locale.time24Hours ? c : c % 12 == 0 ? 12 : c % 12;
                        n += '<div class="dp-time-row"><div class="dp-time-cell' + (l === e ? " selected" : "") + '" data-h="' + l + '">' + (d < 10 ? "0" : "") + d + '</div><div class="dp-time-cell' + (c === e ? " selected" : "") + '" data-h="' + c + '">' + (h < 10 ? "0" : "") + h + "</div></div>"
                    }
                    for (n += "</div>", n += '<div class="dp-time-minute">', r = 0; r < 6; r++) {
                        var p = 10 * r,
                            u = p + 5;
                        n += '<div class="dp-time-row"><div class="dp-time-cell' + (p === o ? " selected" : "") + '" data-m="' + p + '">' + (p < 10 ? "0" : "") + p + '</div><div class="dp-time-cell' + (u === o ? " selected" : "") + '" data-m="' + u + '">' + (u < 10 ? "0" : "") + u + "</div></div>"
                    }
                    n += "</div>",
                    n += '<div id="dp-time-now" class="dp-time-now"><div id="dp-time-now" class="nx-button-text blue">' + htmlEscape(locale.op_now) + "</div>",
                    a.html(n)
                }()
            }
        },
        d.prototype.hideAux = function() {
            this.$aux && (window.removeEventListener("resize", this.resizeAux, !1), this.$scrollPane && this.$scrollPane.removeEventListener("scroll", this.resizeAux, !1), this.$scrollPane = void 0, this.resizeAux = void 0, this.$aux.remove(), this.$aux = null)
        };
        var h = i("./node_modules/react-dom/index.js"),
            p = i("./node_modules/react/index.js"),
            u = i("./src/react/LightboxComponent.tsx"),
            f = i("./src/react/PdfRenderer.tsx"),
            m = i("./src/js/widgets/editors/Editor.js"),
            g = i("./node_modules/underscore/underscore.js"),
            v = i("./node_modules/@ninox/ninox-core/dist/ninox-core.es5.js"),
            b = i("./src/js/ui/ui-util.js");
        function y(e, t) {
            var i = t.field;
            switch (this.base = i.exp ? i.exp.returnType.base : "string", this.base) {
            case "color":
            case "icon":
                this.el = $('<div class="stringeditor">').appendTo(e.el),
                this.text = $('<div class="input-text">').appendTo(this.el);
                break;
            case "choice":
            case "styled":
                this.el = $('<div class="stringeditor">').appendTo(e.el),
                this.text = $('<div class="choice text-selectable">').appendTo(this.el);
                break;
            case "multi":
                this.el = $('<div class="stringeditor">').appendTo(e.el),
                this.text = $('<div class="input-text multicombo text-selectable">').appendTo(this.el);
                break;
            case "html":
                this.el = $('<div class="stringeditor">').appendTo(e.el),
                this.text = $('<div class="html text-selectable">').appendTo(this.el);
                break;
            case "file":
                var o = e.el.width();
                this.el = $('<div class="editor-file-file" style="text-align:center;display:table-cell;vertical-align:middle;width:' + o + "px;max-width:" + o + 'px">').appendTo(e.el);
                break;
            case "email":
                this.el = $('<div class="stringeditor stringeditor-fn">').appendTo(e.el),
                this.text = $('<div class="input-text text-selectable">').appendTo(this.el),
                this.button = $('<div class="stringeditor-button"><div class="i-32-18 i-light-grey i-field-email"></div></div>').appendTo(this.el).touch($.proxy(this.sendEmail, this));
                break;
            case "phone":
                this.el = $('<div class="stringeditor stringeditor-fn">').appendTo(e.el),
                this.text = $('<div class="input-text text-selectable">').appendTo(this.el),
                this.button = $('<div class="stringeditor-button"><div class="i-32-18 i-light-grey i-field-phone"></div></div>').appendTo(this.el).touch($.proxy(this.openPhone, this));
                break;
            case "link":
                this.el = $('<div class="stringeditor stringeditor-fn">').appendTo(e.el),
                this.text = $('<div class="input-text text-selectable">').appendTo(this.el),
                this.button = $('<div class="stringeditor-button"><div class="i-32-18 i-light-grey i-field-link"></div></div>').appendTo(this.el).touch($.proxy(this.openURL, this));
                break;
            default:
                this.el = $('<div class="stringeditor stringeditor-fn">').appendTo(e.el),
                this.text = $('<div class="input-text text-selectable">').appendTo(this.el)
            }
            this.el.touch($.proxy(this.onClick, this)),
            this.text ? (i.height > 1 ? this.text.addClass("multiline") : this.text.removeClass("multiline"), this.text.css({
                height: 24 * i.height + 8
            })) : this.el.css({
                height: 24 * i.height + 10
            }),
            m.a.apply(this, arguments)
        }
        function w(e, t) {
            o.a.apply(this, arguments)
        }
        Object.assign(y.prototype, m.a.prototype),
        y.prototype.editorClass = "fn",
        y.prototype.destroy = function() {
            this.el && this.el.remove(),
            m.a.prototype.destroy.apply(this, arguments)
        },
        y.prototype.updateUI = function() {
            switch (this.updateUIStyle(), this.base) {
            case "color":
                this.el.css({
                    backgroundColor: this.value || ""
                });
                break;
            case "icon":
                this.value ? this.text.html('<div class="iconselector-icon ic ic-' + htmlEscape(this.value) + '">') : this.text.html("");
                break;
            case "choice":
            case "dchoice":
                this.model.field.exp.returnType.loadValue(this.getNid(), this.value, e => {
                    let t = "",
                        i = "";
                    void 0 !== e && (e.icon && (t += '<div class="choice-icon ic ic-' + e.icon + '"></div>'), t += '<span style="color:' + (e.textColor || "") + '">' + htmlEscape(e.caption) + "</span>", e.color && (i = e.color)),
                    this.el.css({
                        "background-color": i
                    }),
                    this.text.html(t)
                });
                break;
            case "styled":
                {
                    let e = "",
                        t = "";
                    this.value && (this.value.icon && (e += '<div class="choice-icon ic ic-' + this.value.icon + '"></div>'), e += '<span style="color:' + (this.value.color || "") + '">' + htmlEscape(this.value.text) + "</span>", this.value.background && (t = this.value.background)),
                    this.el.css({
                        "background-color": t
                    }),
                    this.text.html(e);
                    break
                }case "multi":
            case "dmulti":
                this.model.field.exp.returnType.loadValuesSorted(this.getNid(), e => {
                    const t = util.multiDecode(this.value);
                    let i = "";
                    for (var o = 0; o < e.length; o++) {
                        const n = e[o],
                            s = -1 !== t.indexOf(parseInt(n.id, 10));
                        s && (i += '<div class="multicombo-item" style="' + (s && n.color ? "background-color:" + n.color + ";color:" + n.textColor : "") + '" data-id="' + n.id + '">' + (n.icon ? '<div class="choice-symbol ic ic-' + n.icon + '"></div>' : "") + "<span>" + htmlEscape(n.caption || "") + "</span></div>")
                    }
                    this.text.html(i)
                });
                break;
            case "html":
                try {
                    this.text.html(this.value || "")
                } catch (e) {
                    this.text.html("INVALID HTML: " + htmlEscape(this.value))
                }
                break;
            case "file":
                {
                    if (this.value) {
                        const e = database.thumb2URL1(this.value);
                        e ? this.el.html('<img src="' + e + '">') : this.el.html("")
                    } else
                        this.el.html("");
                    const e = this.container.el.width();
                    this.el.css({
                        width: e,
                        "max-width": e
                    });
                    break
                }default:
                this.text.text(this.model.field.format(this.value))
            }
        },
        y.prototype.updateUIStyle = function() {
            var e = this.model.field.style && JSON.parse(this.model.field.style);
            this.text && this.text.css({
                "text-align": e && e.textAlign || "",
                "font-size": e && e.fontSize || "",
                "font-weight": e && util.multiHasOne(e.fontStyle, [1]) ? "bold" : "",
                "font-style": e && util.multiHasOne(e.fontStyle, [2]) ? "italic" : "",
                color: e && e.color || "",
                "background-color": e && e.backgroundColor || ""
            }),
            this.el && this.el.css({
                "background-color": e && e.backgroundColor || "",
                "border-width": e && e.borderWidth || "",
                "border-color": e && e.borderColor || "",
                "border-left-style": e && (util.multiHasOne(e.borderSides, [1]) ? e.borderStyle : "none") || "",
                "border-top-style": e && (util.multiHasOne(e.borderSides, [2]) ? e.borderStyle : "none") || "",
                "border-bottom-style": e && (util.multiHasOne(e.borderSides, [3]) ? e.borderStyle : "none") || "",
                "border-right-style": e && (util.multiHasOne(e.borderSides, [4]) ? e.borderStyle : "none") || ""
            })
        },
        y.prototype.isHeightAdjustable = function() {
            return !0
        },
        y.prototype.setHeight = function(e) {
            var t = this.model.field,
                i = t.height,
                o = Math.max(1, Math.round((e - 42) / 24));
            o !== i ? (this.text && (o > 1 ? this.text.addClass("multiline") : this.text.removeClass("multiline"), this.text.css({
                height: 24 * o + 8
            }), this.el.css({
                height: ""
            })), t.height = o) : this.el.css({
                height: 24 * t.height + 10
            })
        },
        y.prototype.widthChanged = function() {
            this.updateUI()
        },
        y.prototype.openURL = function() {
            this.value && NinoxDocumentInteraction.previewDocument(this.value, (function() {}))
        },
        y.prototype.sendEmail = function() {
            if (this.value) {
                var e = "mailto:" + encodeURIComponent(this.value);
                NinoxDocumentInteraction.openBrowser(e)
            }
        },
        y.prototype.openPhone = function() {
            if (this.value) {
                var e = String(this.value).replace(/[\/]/g, "-");
                NinoxDocumentInteraction.openBrowser("tel://" + encodeURIComponent(e))
            }
        },
        y.prototype.openFile = function() {
            if (this.value) {
                var e = database.fileURL1(this.value);
                if (!e)
                    return;
                const n = v.schemas.RE_FILE_REF.exec(this.value);
                if (!n)
                    return;
                const s = n[1] + n[2],
                    a = n[3];
                function t() {
                    database.previewFile(s, a)
                }
                if (/\.(png|jpg|jpeg|gif)$/i.test(this.value) || (/\.(png|jpg|jpeg|gif)$/i.test(this.value), 0)) {
                    var i = $("<div>").appendTo(document.body);
                    h.render(p.createElement(u.a, {
                        images: [{
                            file: e,
                            name: a
                        }],
                        initialImageIndex: 0,
                        closeLightBox: () => {
                            h.unmountComponentAtNode(i[0]),
                            i.remove()
                        },
                        downloadUrl: t
                    }), i[0])
                } else if (/\.(pdf)$/i.test(this.value)) {
                    var o = $.backplane({
                        cls: "nx-backplane-lightbox",
                        beforeClose: () => h.unmountComponentAtNode(o[0])
                    });
                    h.render(p.createElement(f.a, {
                        pdfUrl: e,
                        fileName: a,
                        onDownloadClick: t,
                        onCloseClick: () => o.close()
                    }), o[0])
                } else
                    t()
            }
        },
        y.prototype.onClick = function(e) {
            var t = this.model.field;
            if (t.onClick) {
                var i = this.container.getNid();
                this.el.addClass("clicked"),
                Object(b.c)(t.onClick, i, e => {
                    this.el.removeClass("clicked"),
                    e && $.alert(e)
                })
            } else
                "file" === this.base && this.openFile(e)
        },
        Object.assign(w.prototype, o.a.prototype),
        w.prototype.inputType = "url",
        w.prototype.editorClass = "link",
        w.prototype.createButton = function() {
            this.button = $('<div class="stringeditor-button"><div class="i-32-18 i-light-grey i-field-link"></div></div>').css("display", "none").click($.proxy(this.openURL, this)).appendTo(this.el)
        },
        w.prototype.openURL = function() {
            this.value && NinoxDocumentInteraction.previewDocument(this.value, (function() {}))
        };
        var x = i("./src/js/widgets/editors/ChoiceEditor.js");
        function T(e, t) {
            m.a.apply(this, arguments),
            this.el = $('<div class="stringeditor">').appendTo(e.el).touch($.proxy(this.popup, this)),
            this.text = $('<div class="choice">').appendTo(this.el),
            this.button = $('<div class="choice-dropdown">').appendTo(this.el)
        }
        function C() {
            T.apply(this, arguments)
        }
        function k(e, t) {
            m.a.apply(this, arguments),
            this.el = $('<div class="choiceswitch">').appendTo(e.el).touch($.proxy(this.clicked, this))
        }
        function S() {
            k.apply(this, arguments)
        }
        function E(e, t) {
            m.a.apply(this, arguments),
            this.el = $('<div class="choiceradio">').appendTo(e.el).touch($.proxy(this.clicked, this)),
            this.updateHeight()
        }
        function _() {
            E.apply(this, arguments)
        }
        function D(e, t) {
            m.a.apply(this, arguments),
            this.el = $('<div class="stringeditor">').appendTo(e.el),
            this.text = $('<div class="input-text multicombo">').appendTo(this.el).click($.proxy(e.focus, e)),
            this.button = $('<div class="choice-dropdown">').appendTo(this.el).touch($.proxy(this.container.focus, this.container)),
            this.$backplane = null
        }
        function M(e, t) {
            m.a.apply(this, arguments),
            this.el = $('<div class="multiradio">').appendTo(e.el).touch($.proxy(this.clicked, this)),
            this.updateHeight()
        }
        function N(e, t) {
            m.a.apply(this, arguments),
            this.el = $('<div class="choiceswitch">').appendTo(e.el).touch($.proxy(this.clicked, this))
        }
        function I(e, t) {
            m.a.apply(this, arguments),
            this.el = $('<div class="choiceswitch">').appendTo(e.el).touch($.proxy(this.clicked, this))
        }
        function O(e, t) {
            m.a.apply(this, arguments),
            this.el = $('<div class="booleancheck">').appendTo(e.el).touch($.proxy(this.clicked, this))
        }
        function R(e, t) {
            m.a.apply(this, arguments),
            this.el = $('<div class="booleanslide"><div class="booleanslide-text"></div><div class="booleanslide-slide"><div class="booleanslide-knob"></div></div></div>').appendTo(e.el).touch($.proxy(this.clicked, this))
        }
        Object.assign(T.prototype, m.a.prototype),
        T.prototype.editorClass = "choice",
        T.prototype.destroy = function() {
            this.el.remove(),
            m.a.prototype.destroy.apply(this, arguments)
        },
        T.prototype.updateUI = function() {
            this.model.field.loadValue(this.getNid(), this.value, e => {
                void 0 !== e ? (this.text[0].innerHTML = (e.icon ? '<div class="choice-icon ic ic-' + e.icon + '"></div>' : "") + '<span style="color:' + e.textColor + '">' + htmlEscape(e.caption) + "</span>", this.el[0].style.backgroundColor = e.color || "") : (this.text[0].innerHTML = "", this.el[0].style.backgroundColor = "")
            })
        },
        T.prototype.popup = function() {
            var e = this,
                t = this.model;
            t.field.loadValuesSorted(this.getNid(), i => {
                var o = $.backplane({}),
                    n = $('<div class="choice-menu" style="min-width:' + this.el.outerWidth() + "px;max-height:" + (window.getHeight() - 64) + 'px;overflow:auto">').appendTo(o).touch((function(t) {
                        var i = $(t.target).closest(".choice-menu-item").attr("data-id");
                        i && ("###NULL###" === i ? (e.updateModel(null), o.close()) : (e.updateModel(i), o.close()))
                    })),
                    s = "";
                if (!t.field.required) {
                    var a = null == this.value;
                    s += '<div class="choice-menu-item" data-id="###NULL###"><div class="choice-indicator' + (a ? " selected" : "") + '"></div><div class="choice-label">' + htmlEscape(locale.empty) + "</div></div>"
                }
                g.each(i, (function(t) {
                    var i = t.id === e.value;
                    s += '<div data-id="' + t.id + '" class="choice-menu-item" style="' + (t.color ? "background-color:" + t.color + ";color:" + t.textColor : "") + '"><div class="choice-indicator' + (i ? " selected" : "") + '"></div><div class="multicombo-item" style="background-color:transparent;color:' + t.textColor + '">' + (t.icon ? '<div class="choice-symbol ic ic-' + t.icon + '"></div>' : "") + "<span>" + htmlEscape(t.caption || "") + "</span></div></div>"
                })),
                n.html(s);
                var r = n.outerWidth(),
                    l = n.outerHeight(),
                    c = this.el.offset();
                c.top += 32,
                c.left + r > window.getWidth() && (c.left = window.getWidth() - r),
                c.top + l > window.getHeight() - 32 && (c.top = window.getHeight() - l - 32),
                n.offset(c)
            })
        },
        Object.assign(C.prototype, T.prototype),
        C.prototype.editorClass = "user",
        Object.assign(k.prototype, m.a.prototype),
        k.prototype.editorClass = "choice-switch",
        k.prototype.destroy = function() {
            this.el && this.el.remove(),
            m.a.prototype.destroy.apply(this, arguments)
        },
        k.prototype.updateUI = function() {
            var e = this.value;
            this.model.field.loadValuesSorted(this.getNid(), t => {
                for (var i = "", o = 0; o < t.length; o++) {
                    var n = t[o],
                        s = e === n.id;
                    i += '<div class="choiceswitch-item' + (s ? " selected" : "") + '" style="' + (s && n.color ? "background-color:" + n.color + ";color:" + n.textColor : "") + '" data-id="' + n.id + '">' + (n.icon ? '<div class="choice-symbol ic ic-' + n.icon + '"></div>' : "") + "<span>" + htmlEscape(n.caption || "") + "</span></div>"
                }
                this.el.html(i)
            })
        },
        k.prototype.clicked = function(e) {
            var t = $(e.target).closest(".choiceswitch-item").attr("data-id");
            if (t) {
                var i = this.model.field;
                t === this.value ? i.required || this.updateModel(null) : this.updateModel(t)
            }
        },
        k.prototype.afterLoaded = function() {
            "dchoice" === this.model.field.base && this.updateUI()
        },
        Object.assign(S.prototype, k.prototype),
        S.prototype.editorClass = "user-switch",
        Object.assign(E.prototype, m.a.prototype),
        E.prototype.editorClass = "choice-radio",
        E.prototype.destroy = function() {
            this.el && this.el.remove(),
            m.a.prototype.destroy.apply(this, arguments)
        },
        E.prototype.updateStructure = function() {
            this.updateHeight()
        },
        E.prototype.updateUI = function() {
            var e = this.value;
            this.model.field.loadValuesSorted(this.getNid(), t => {
                for (var i = "", o = 0; o < t.length; o++) {
                    var n = t[o],
                        s = e === n.id;
                    i += `<div \n                    class="choiceradio-item ${s ? "selected" : ""}"\n                    style="${s && n.color ? "background-color:" + n.color + ";color:" + n.textColor : ""}" \n                    data-id="${n.id}"\n                >\n                <div class="choiceradio-item-radio-container">\n                    <div class="choiceradio-item-radio"/>\n                </div>\n                ${n.icon ? `<div class="choice-symbol ic ic-${n.icon}"></div>` : ""}\n                <div class="choiceradio-item-text">\n                    ${htmlEscape(n.caption || "")}\n                </div>\n                </div>`
                }
                this.el.html(i),
                this.updateHeightWithCount(t.length)
            })
        },
        E.prototype.clicked = function(e) {
            var t = $(e.target);
            if (t.closest(".choiceradio-item-radio-container").length) {
                var i = t.closest(".choiceradio-item").attr("data-id");
                if (i) {
                    var o = this.model.field;
                    i === this.value ? o.required || this.updateModel(null) : this.updateModel(i)
                }
            }
        },
        E.prototype.isHeightAdjustable = function() {
            return !0
        },
        E.prototype.setHeight = function(e) {
            const t = this.model.field;
            t.loadValuesSorted(this.getNid(), i => {
                const o = i.length,
                    n = Math.ceil(o / 4),
                    s = o,
                    a = t.height,
                    r = Math.min(s, Math.max(n, Math.round((e - 42) / 24)));
                a !== r && (t.height = r === o ? void 0 : r),
                this.updateHeightWithCount(i.length)
            })
        },
        E.prototype.updateHeight = function() {
            this.model.field.loadValuesSorted(this.getNid(), e => {
                this.updateHeightWithCount(e.length)
            })
        },
        E.prototype.updateHeightWithCount = function(e) {
            const t = this.model.field,
                i = Math.ceil(e / 4),
                o = e,
                n = t.height,
                s = null == n ? e : Math.min(o, Math.max(i, n)),
                a = Math.ceil(e / s);
            this.el.css({
                "column-count": a,
                height: 24 * s + "px"
            })
        },
        E.prototype.afterLoaded = function() {
            "dchoice" === this.model.field.base && this.updateUI()
        },
        Object.assign(_.prototype, E.prototype),
        _.prototype.editorClass = "user-radio",
        Object.assign(D.prototype, m.a.prototype),
        D.prototype.editorClass = "multi-combo",
        D.prototype.destroy = function() {
            this.el && (this.el.remove(), this.el = null),
            this.$backplane && (this.$backplane.remove(), this.$backplane = null),
            m.a.prototype.destroy.apply(this, arguments)
        },
        D.prototype.updateUI = function() {
            var e = util.multiDecode(this.value);
            this.model.field.loadValuesSorted(this.getNid(), t => {
                for (var i = "", o = 0; o < t.length; o++) {
                    var n = t[o],
                        s = -1 !== e.indexOf(parseInt(n.id));
                    s && (i += '<div class="multicombo-item" style="' + (s && n.color ? "background-color:" + n.color + ";color:" + n.textColor : "") + '" data-id="' + n.id + '">' + (n.icon ? '<div class="choice-symbol ic ic-' + n.icon + '"></div>' : "") + "<span>" + htmlEscape(n.caption || "") + "</span></div>")
                }
                this.text.html(i)
            })
        },
        D.prototype.focus = function() {
            if (!this.$backplane) {
                this.$backplane = $.backplane({
                    close: () => {
                        this.$backplane = null
                    }
                });
                var e = this;
                this.model.field.loadValuesSorted(this.getNid(), t => {
                    if (this.$backplane) {
                        var i = $('<div class="choice-menu" style="min-width:' + this.el.outerWidth() + 'px;overflow:auto;z-index:12">').appendTo(this.$backplane).touch((function(i) {
                            var n = util.multiDecode(e.value),
                                s = $(i.target).closest(".choice-menu-item").attr("data-id");
                            if (!s)
                                return;
                            if ("#all" === s) {
                                n = [];
                                for (var a = 0; a < t.length; a++)
                                    n.push(t[a].id)
                            } else if ("#none" === s)
                                n = [];
                            else {
                                var r = parseInt(s),
                                    l = n.indexOf(r);
                                -1 === l ? n.push(r) : n.splice(l, 1)
                            }
                            e.updateModel(util.multiEncode(n) || null, (function() {
                                o()
                            }))
                        }));
                        o(),
                        function() {
                            var o = e.el.offset(),
                                n = window.getWidth(),
                                s = window.getHeight(),
                                a = o.left,
                                r = o.top + 36,
                                l = i.outerWidth(),
                                c = 32 * (t.length + 1);
                            c > s - r && (s - r >= o.top - 4 ? c = s - r : (c = Math.min(o.top - 4, c), r = o.top - 4 - c));
                            a + l > n && (a = n - l);
                            i.css({
                                left: a,
                                top: r,
                                height: c
                            })
                        }()
                    }
                    function o() {
                        for (var o = util.multiDecode(e.value), n = '<div class="choice-menu-head"><div data-id="#all" class="choice-menu-item"><div class="choice-label">' + htmlEscape(locale.all) + '</div></div><div data-id="#none" class="choice-menu-item"><div class="choice-label">' + htmlEscape(locale.none) + "</div></div></div>", s = 0; s < t.length; s++) {
                            var a = t[s],
                                r = -1 !== o.indexOf(parseInt(a.id));
                            n += '<div data-id="' + a.id + '" class="choice-menu-item"><div class="choice-indicator' + (r ? " selected" : "") + '"></div><div class="multicombo-item" style="' + (a.color ? "background-color:" + a.color + ";color:" + a.textColor : "") + '" data-id="' + a.id + '">' + (a.icon ? '<div class="choice-symbol ic ic-' + a.icon + '"></div>' : "") + "<span>" + htmlEscape(a.caption || "") + "</span></div></div>"
                        }
                        i.html(n)
                    }
                })
            }
        },
        Object.assign(M.prototype, m.a.prototype),
        M.prototype.editorClass = "multi-radio",
        M.prototype.destroy = function() {
            this.el && this.el.remove(),
            m.a.prototype.destroy.apply(this, arguments)
        },
        M.prototype.updateStructure = function() {
            this.updateHeight()
        },
        M.prototype.updateUI = function() {
            var e = util.multiDecode(this.value);
            this.model.field.loadValuesSorted(this.getNid(), t => {
                for (var i = "", o = 0; o < t.length; o++) {
                    var n = t[o],
                        s = -1 !== e.indexOf(parseInt(n.id));
                    i += `\n                <div \n                    class="multiradio-item ${s ? "selected" : ""}"\n                    style="${s && n.color ? "background-color:" + n.color : ""}" \n                    data-id="${n.id}"\n                >\n                    <div class="multiradio-item-box ${s ? "selected i-16-12 i-white i-check" : ""}"></div>\n                    ${n.icon ? `<div class="choice-symbol ic ic-${n.icon}"></div>` : ""}\n                    <div class="multiradio-item-text" style="color:${s ? n.textColor : ""}">\n                        ${htmlEscape(n.caption || "")}\n                    </div>\n            </div>`
                }
                this.el.html(i),
                this.updateHeightWithCount(t.length)
            })
        },
        M.prototype.clicked = function(e) {
            var t = util.multiDecode(this.value),
                i = $(e.target).closest(".multiradio-item").attr("data-id");
            if (i) {
                var o = parseInt(i),
                    n = (this.model.field, t.indexOf(o));
                -1 === n ? t.push(o) : t.splice(n, 1),
                this.updateModel(util.multiEncode(t) || null)
            }
        },
        M.prototype.isHeightAdjustable = function() {
            return !0
        },
        M.prototype.setHeight = function(e) {
            const t = this.model.field;
            t.loadValuesSorted(this.getNid(), i => {
                const o = i.length,
                    n = Math.ceil(o / 4),
                    s = o,
                    a = t.height,
                    r = Math.min(s, Math.max(n, Math.round((e - 42) / 24)));
                a !== r && (t.height = r === o ? void 0 : r),
                this.updateHeightWithCount(i.length)
            })
        },
        M.prototype.updateHeight = function() {
            this.model.field.loadValuesSorted(this.getNid(), e => {
                this.updateHeightWithCount(e.length)
            })
        },
        M.prototype.updateHeightWithCount = function(e) {
            const t = this.model.field,
                i = Math.ceil(e / 4),
                o = e,
                n = t.height,
                s = null == n ? e : Math.min(o, Math.max(i, n)),
                a = Math.ceil(e / s);
            this.el.css({
                "column-count": a,
                height: 24 * s + "px"
            })
        },
        Object.assign(N.prototype, m.a.prototype),
        N.prototype.editorClass = "multi-switch",
        N.prototype.destroy = function() {
            this.el && this.el.remove(),
            m.a.prototype.destroy.apply(this, arguments)
        },
        N.prototype.updateUI = function() {
            var e = util.multiDecode(this.value);
            this.model.field.loadValuesSorted(this.getNid(), t => {
                for (var i = "", o = 0; o < t.length; o++) {
                    var n = t[o],
                        s = -1 !== e.indexOf(parseInt(n.id));
                    i += '<div class="choiceswitch-item' + (s ? " selected" : "") + '" style="' + (s && n.color ? "background-color:" + n.color + ";color:" + n.textColor : "") + '" data-id="' + n.id + '">' + (n.icon ? '<div class="choice-symbol ic ic-' + n.icon + '"></div>' : "") + "<span>" + htmlEscape(n.caption || "") + "</span></div>"
                }
                this.el.html(i)
            })
        },
        N.prototype.clicked = function(e) {
            var t = util.multiDecode(this.value),
                i = $(e.target).closest(".choiceswitch-item").attr("data-id");
            if (i) {
                var o = parseInt(i),
                    n = t.indexOf(o);
                -1 === n ? t.push(o) : t.splice(n, 1),
                this.updateModel(util.multiEncode(t) || null)
            }
        },
        Object.assign(I.prototype, m.a.prototype),
        I.prototype.editorClass = "boolean-switch",
        I.prototype.destroy = function() {
            this.el && this.el.remove(),
            m.a.prototype.destroy.apply(this, arguments)
        },
        I.prototype.updateUI = function() {
            var e = this.value,
                t = (this.model.field, '<div class="choiceswitch-item' + (!1 === e ? " selected" : "") + '" style="width:50%" data-id="false">' + htmlEscape(locale.no) + '</div><div class="choiceswitch-item' + (!0 === e ? " selected" : "") + '" style="width:50%" data-id="true">' + htmlEscape(locale.yes) + "</div>");
            this.el.html(t)
        },
        I.prototype.clicked = function(e) {
            var t = $(e.target).closest(".choiceswitch-item").attr("data-id");
            if (t) {
                var i = "false" !== t && ("true" === t || null),
                    o = this.model.field;
                i === this.value ? o.required || this.updateModel(null) : this.updateModel(i)
            }
        },
        Object.assign(O.prototype, m.a.prototype),
        O.prototype.editorClass = "boolean-check",
        O.prototype.destroy = function() {
            this.el && this.el.remove(),
            m.a.prototype.destroy.apply(this, arguments)
        },
        O.prototype.updateUI = function() {
            var e = this.value,
                t = this.model.field,
                i = '<div class="booleancheck-box' + (e ? " selected i-16-12 i-white i-check" : "") + '"></div><div class="booleancheck-text" style="display:' + ("none" === this.model.field.labelPosition ? "none" : "") + '">' + htmlEscape(t.caption) + "</div>";
            this.el.html(i)
        },
        O.prototype.clicked = function(e) {
            var t = !this.value;
            this.updateModel(t)
        },
        Object.assign(R.prototype, m.a.prototype),
        R.prototype.editorClass = "boolean-slide",
        R.prototype.destroy = function() {
            this.el && this.el.remove(),
            m.a.prototype.destroy.apply(this, arguments)
        },
        R.prototype.updateUI = function() {
            this.el.toggleClass("active", !!this.value),
            this.el.find(".booleanslide-text").text(this.model.field.caption).css("display", "none" === this.model.field.labelPosition ? "none" : "")
        },
        R.prototype.clicked = function(e) {
            $(e.target).closest(".booleanslide-slide").length && this.updateModel(!this.value)
        };
        var j = i("./src/js/widgets/editors/IconSelector.js"),
            L = i("./src/js/widgets/editors/ColorSelector.js");
        function F(e) {
            return util.localeSortBy(g.map(e, (function(e) {
                return {
                    id: e.id,
                    caption: e.caption
                }
            })), "caption")
        }
        function A(e, t) {
            m.a.apply(this, arguments),
            this.el = $('<div class="stringeditor">').appendTo(e.el).click($.proxy(this.popup, this)),
            this.text = $('<div class="input-text">').appendTo(this.el),
            this.button = $('<div class="choice-dropdown">').appendTo(this.el)
        }
        function H(e, t) {
            this.editing = !1,
            this.el = $('<div class="html">').appendTo(e.containerEl || e.el).click($.proxy(this.startEdit, this)),
            this.el.css({
                height: 24 * t.field.height
            }),
            m.a.apply(this, arguments)
        }
        Object.assign(A.prototype, m.a.prototype),
        A.prototype.editorClass = "roles",
        A.prototype.destroy = function() {
            this.el.remove(),
            m.a.prototype.destroy.apply(this, arguments)
        },
        A.prototype.updateUI = function() {
            var e = F(this.model.roles || database.roles),
                t = this.value || [],
                i = [];
            g.each(e, (function(e) {
                -1 !== t.indexOf(e.id) && i.push(e.caption)
            }));
            var o = 0 === i.length ? locale.everybody : i.join(", ");
            this.text.text(o)
        },
        A.prototype.popup = function() {
            var e = this,
                t = (this.model, {});
            $.pushInputHandler(t);
            var i = $('<div class="nx-backplane nx-backplane-dark">').appendTo($(document.body)).touch((function(o) {
                    $(o.target).is(".nx-backplane") && (n = [], g.each(s, (function(e) {
                        e.selected && n.push(e.id)
                    })), e.updateModel(0 === n.length ? void 0 : n), e.updateUI(), i.remove(), $.popInputHandler(t))
                })),
                o = $('<div class="choice-menu">').css({
                    "min-width": this.el.width()
                }).appendTo(i),
                n = this.value || [],
                s = F(this.model.roles || database.roles);
            g.each(s, (function(e) {
                e.selected = -1 !== n.indexOf(e.id);
                var t = $('<div class="choice-menu-item">').data("role", e).appendTo(o),
                    i = $('<div class="placeholder">').appendTo(t),
                    s = $('<div class="type-symbol">').appendTo(i);
                function a() {
                    e.selected ? s.attr("class", "booleancheck-box selected i-16-12 i-white i-check") : s.attr("class", "booleancheck-box")
                }
                $('<div class="booleancheck-text">').text(e.caption).appendTo(t),
                t.click((function() {
                    e.selected = !e.selected,
                    a()
                })),
                a()
            }));
            var a = o.outerWidth(),
                r = o.outerHeight(),
                l = this.el.offset();
            l.top += 32,
            l.left + a > window.getWidth() && (l.left = window.getWidth() - a),
            l.top + r > window.getHeight() && (l.top = window.getHeight() - r),
            o.offset(l)
        },
        Object.assign(H.prototype, m.a.prototype),
        H.prototype.editorClass = "html",
        H.prototype.isHeightAdjustable = function() {
            return !0
        },
        H.prototype.setHeight = function(e) {
            var t = this.model.field,
                i = t.height,
                o = Math.max(1, Math.round((e - 40) / 24));
            i !== o && (t.height = o, this.el.css({
                height: 24 * o
            }))
        },
        H.prototype.updateStructur = function() {
            this.model.field;
            this.el.css({
                height: 24 * newHeight
            })
        },
        H.prototype.destroy = function() {
            this.el.remove(),
            m.a.prototype.destroy.apply(this, arguments)
        },
        H.prototype.updateUI = function() {
            this.el[0].innerHTML = this.value || ""
        },
        H.prototype.startEdit = function() {
            if (this.editing)
                return;
            if (!this.model.isWritable())
                return;
            this.editing = !0;
            var e = this;
            window.registerSaveListener(r);
            var t = {
                keydown: c
            };
            $.pushInputHandler(t);
            var i = $('<div class="nx-backplane nx-backplane-dark">').appendTo($(document.body)).click((function(e) {
                    $(e.target).is(".nx-backplane") && l()
                })),
                o = $('<div class="html-pane">').appendTo(i);
            $('<div class="html-caption nx-section-head">').text(e.model.field.caption).appendTo(o);
            var n = $('<div class="html-controls">').appendTo(o);
            $('<div class="button i-32-18 i-light-grey i-head-1">').appendTo(n).on(TOUCH ? EVENT_touchstart : "mousedown", (function() {
                return document.execCommand("formatBlock", !1, NINOX_IE ? "<H1>" : "H1"), !1
            })),
            $('<div class="button i-32-18 i-light-grey i-head-2">').appendTo(n).on(TOUCH ? EVENT_touchstart : "mousedown", (function() {
                return document.execCommand("formatBlock", !1, NINOX_IE ? "<H2>" : "H2"), !1
            })),
            $('<div class="button i-32-18 i-light-grey i-head-3">').appendTo(n).on(TOUCH ? EVENT_touchstart : "mousedown", (function() {
                return document.execCommand("formatBlock", !1, NINOX_IE ? "<H3>" : "H3"), !1
            })),
            $('<div class="button i-32-18 i-light-grey i-ul">').appendTo(n).on(TOUCH ? EVENT_touchstart : "mousedown", (function() {
                return document.execCommand("insertUnorderedList", !1, null), !1
            })),
            $('<div class="button i-32-18 i-light-grey i-one-two-three">').appendTo(n).on(TOUCH ? EVENT_touchstart : "mousedown", (function() {
                return document.execCommand("insertOrderedList", !1, null), !1
            })),
            $('<div class="button i-32-18 i-light-grey i-field-br">').appendTo(n).on(TOUCH ? EVENT_touchstart : "mousedown", (function() {
                return document.execCommand("formatBlock", !1, NINOX_IE ? "<P>" : "P"), !1
            })),
            $('<div class="button i-32-18 i-light-grey i-bold">').appendTo(n).on(TOUCH ? EVENT_touchstart : "mousedown", (function() {
                return document.execCommand("bold", !1, null), !1
            })),
            $('<div class="button i-32-18 i-light-grey i-italic">').appendTo(n).on(TOUCH ? EVENT_touchstart : "mousedown", (function() {
                return document.execCommand("italic", !1, null), !1
            })),
            $('<div class="button i-32-18 i-light-grey i-underline">').appendTo(n).on(TOUCH ? EVENT_touchstart : "mousedown", (function() {
                return document.execCommand("underline", !1, null), !1
            }));
            var s = $('<div class="contenteditable html-editor no-richtexteditor needsfocus" contenteditable="true">').appendTo(o);
            const a = $('<div class="nx-button-bar html-button-bar">').appendTo(o);
            function r() {
                e.updateModel(s.html())
            }
            function l() {
                r(),
                d()
            }
            function c(e) {
                if (27 === e.which)
                    return l(), !1
            }
            function d() {
                $.popInputHandler(t),
                window.unregisterSaveListener(r),
                e.editing = !1,
                i.remove()
            }
            $('<div class="nx-button-text grey" style="float:right"><span>' + htmlEscape(locale.cancel) + "</span></div>").appendTo(a).click(d),
            $('<div class="nx-hspace-flex">').appendTo(a),
            $('<div class="nx-button-text blue" style="float:right"><span>' + htmlEscape(locale.okay) + "</span></div>").appendTo(a).click(l),
            s.keydown(c),
            s.html(e.value),
            s.focus()
        },
        H.prototype.endEdit = function() {};
        var P = i("./src/js/widgets/Field.js");
        function U(e, t) {
            this.el = $('<div class="stringeditor">').appendTo(e.el).click($.proxy(this.popup, this)),
            this.text = $('<div class="input-text">').appendTo(this.el),
            m.a.apply(this, arguments)
        }
        Object.assign(U.prototype, m.a.prototype),
        U.prototype.editorClass = "numberformat",
        U.prototype.destroy = function() {
            this.model.off("update", this.update, this),
            this.el.remove()
        },
        U.prototype.updateUI = function() {
            this.text.text(this.value || "")
        },
        U.prototype.focus = function() {
            this.popup()
        },
        U.prototype.popup = function() {
            var e = this,
                t = {};
            $.pushInputHandler(t);
            var i = $('<div class="nx-backplane nx-backplane-dark">').touch((function(e) {
                    $(e.target).is(".nx-backplane") && S()
                })),
                o = $('<div class="nx-menu-popup grey width-3col" style="padding:16px;">').appendTo(i),
                n = util.parseNumberFormat(this.value),
                s = new util.SimpleModel(new schemas.TChoice(void 0, void 0, {
                    caption: locale.numberFormatDigits,
                    required: !1,
                    formWidth: 2 / 3,
                    choiceRenderer: "switch",
                    values: {
                        0: {
                            caption: "0",
                            order: 0
                        },
                        1: {
                            caption: "1",
                            order: 1
                        },
                        2: {
                            caption: "2",
                            order: 2
                        },
                        3: {
                            caption: "3",
                            order: 3
                        },
                        4: {
                            caption: "4",
                            order: 4
                        },
                        5: {
                            caption: "5",
                            order: 5
                        },
                        6: {
                            caption: "6",
                            order: 6
                        },
                        7: {
                            caption: "7",
                            order: 7
                        },
                        8: {
                            caption: "8",
                            order: 8
                        }
                    }
                }), n.allDigits ? void 0 : String(n.trailingZeros)),
                a = new util.SimpleModel(new schemas.TBoolean(void 0, void 0, {
                    caption: locale.numberFormatGroup,
                    required: !0,
                    booleanDefault: !1,
                    formWidth: 1 / 3,
                    booleanRenderer: "switch"
                }), n.group),
                r = new util.SimpleModel(new schemas.TString(void 0, void 0, {
                    caption: locale.numberFormatPrefix,
                    required: !1,
                    formWidth: .5
                }), n.prefix),
                l = new util.SimpleModel(new schemas.TString(void 0, void 0, {
                    caption: locale.numberFormatUnit,
                    required: !1,
                    formWidth: .5
                }), n.suffix);
            function c(e, t) {
                if (t)
                    return "a";
                const i = {
                    '"': "q",
                    " ": "w"
                }[e];
                return void 0 === i ? e : i
            }
            var d = new util.SimpleModel(new schemas.TChoice(void 0, void 0, {
                    caption: locale.decimalSeparatorLabel,
                    required: !0,
                    formWidth: .5,
                    choiceRenderer: "switch",
                    values: {
                        a: {
                            caption: "auto",
                            order: 1
                        },
                        ".": {
                            caption: ".",
                            order: 2
                        },
                        ",": {
                            caption: ",",
                            order: 3
                        },
                        "'": {
                            caption: "'",
                            order: 4
                        },
                        q: {
                            caption: '"',
                            order: 5
                        }
                    }
                }), c(n.decimalSeparator, n.decimalSeparatorAuto)),
                h = new util.SimpleModel(new schemas.TChoice(void 0, void 0, {
                    caption: locale.groupingSeparatorLabel,
                    required: !0,
                    formWidth: .5,
                    choiceRenderer: "switch",
                    values: {
                        a: {
                            caption: "auto",
                            order: 1
                        },
                        ".": {
                            caption: ".",
                            order: 2
                        },
                        ",": {
                            caption: ",",
                            order: 3
                        },
                        "'": {
                            caption: "'",
                            order: 4
                        },
                        q: {
                            caption: '"',
                            order: 5
                        },
                        w: {
                            caption: "␣",
                            order: 6
                        }
                    }
                }), c(n.groupingSeparator, n.groupingSeparatorAuto));
            a.on("update", k),
            s.on("update", k),
            r.on("update", k),
            l.on("update", k),
            d.on("update", k),
            h.on("update", k);
            var p = new P.a(this, s, o),
                u = new P.a(this, a, o),
                f = new P.a(this, r, o),
                m = new P.a(this, l, o),
                v = new P.a(this, d, o),
                b = new P.a(this, h, o),
                y = $('<div class="component editor">').appendTo(o);
            $("<label>Group separator</label>").appendTo(y);
            var w = $('<div style="margin: -4px">').appendTo(y);
            g.each([{
                fmt: void 0,
                caption: locale.empty
            }, {
                fmt: "0",
                caption: util.formatNumber("0", 1023.42)
            }, {
                fmt: "0.00",
                caption: util.formatNumber("0.00", 1023.42)
            }, {
                fmt: "#,##0.00",
                caption: util.formatNumber("#,##0.00", 1023.42)
            }, {
                fmt: "0 %",
                caption: util.formatNumber("0 %", 23.42)
            }, {
                fmt: "0.00 %",
                caption: util.formatNumber("0.00 %", 23.42)
            }, {
                fmt: "$#,##0.00",
                caption: util.formatNumber("$#,##0.00", 1023.42)
            }, {
                fmt: "#,##0.00 €",
                caption: util.formatNumber("#,##0.00 €", 1023.42)
            }, {
                fmt: "¥#,##0.00",
                caption: util.formatNumber("¥#,##0.00", 1023.42)
            }, {
                fmt: "£#,##0.00",
                caption: util.formatNumber("£#,##0.00", 1023.42)
            }], (function(t) {
                $('<div class="button text grey" style="width:73px;margin:4px">').text(t.caption).appendTo(w).click((function() {
                    S(),
                    e.updateModel(t.fmt)
                }))
            })),
            i.appendTo($(document.body));
            var x = o.outerWidth(),
                T = o.outerHeight(),
                C = this.el.offset();
            function k() {
                function t(e) {
                    const t = {
                        q: '"',
                        w: " ",
                        a: ""
                    }[e];
                    return void 0 === t ? e : t
                }
                var i = {
                    group: !!a.value,
                    groupLength: 3,
                    leadingZeros: 1,
                    trailingZeros: s.value ? parseInt(s.value, 10) : 0,
                    allDigits: !s.value,
                    prefix: r.value || "",
                    suffix: l.value || "",
                    decimalSeparator: t(d.value),
                    groupingSeparator: t(h.value)
                };
                e.updateModel(util.formatNumberFormat(i))
            }
            function S() {
                k(),
                u.destroy(),
                p.destroy(),
                f.destroy(),
                m.destroy(),
                v.destroy(),
                b.destroy(),
                i.remove(),
                $.popInputHandler(t)
            }
            C.top += this.el.outerHeight(),
            C.left + x > window.getWidth() && (C.left = window.getWidth() - x),
            C.top + T > window.getHeight() && (C.top = window.getHeight() - T),
            o.offset(C)
        };
        var z = i("./src/js/admin/FunctionEditor.js");
        function V(e, t) {
            m.a.apply(this, arguments),
            this.el = $('<div class="stringeditor">').appendTo(e.el).touch($.proxy(this.startEdit, this)),
            this.text = $('<div class="input-text">').appendTo(this.el),
            this.createButton()
        }
        function W(e, t) {
            var i,
                o = this;
            (i = t.field.stringMultiline ? this.input = $('<textarea rows="4">') : this.input = $('<input type="text">')).appendTo($('<div class="stringeditor">').appendTo(e.el)).attr("autocomplete", "off").attr("autocorrect", "off").attr("autocapitalize", "off").attr("spellcheck", "false").focus(r).change(a).blur(l);
            var n = !1;
            function s() {
                n = !0;
                var e = i[0].selectionStart;
                (!e || e < 0) && (e = 0);
                var s = i.val(),
                    a = s.substr(0, e),
                    r = s.substr(e),
                    l = /\{([^\}]*)$/.exec(a),
                    c = /^([^\{]*)\}/.exec(r),
                    d = "";
                l && c && (a = a.substr(0, l.index), r = r.substr(c[0].length), d = l[1] + c[1]),
                new z.a({
                    value: d,
                    schema: t.type.schema,
                    type: t.type,
                    okay: function(e, t) {
                        var s;
                        n = !1,
                        s = t ? a + "{" + t.toHumanString() + "}" + r : a + r,
                        o.updateModel(s, (function(e) {
                            i.focus()
                        }))
                    },
                    cancel: function() {
                        i.focus(),
                        n = !1
                    }
                })
            }
            function a() {
                if (!n) {
                    n = !0;
                    var e = i.val();
                    o.updateModel(e, (function(e) {
                        n = !1
                    }))
                }
            }
            function r() {
                if (!o.$button) {
                    var t = i.position();
                    t.top -= 32,
                    t.left += i.width() - 32,
                    o.$button = $('<div class="button icon i-32-24 i-grey i-setting-settings" style="position:absolute">').offset(t).appendTo(e.el).on(TOUCH ? EVENT_touchstart : "mousedown", s)
                }
            }
            function l() {
                o.$button && (o.$button.remove(), o.$button = void 0)
            }
            m.a.apply(this, arguments)
        }
        function B(e, t) {
            this.el = $('<div class="stringeditor">').appendTo(e.el),
            this.text = $('<div class="input-text">').click($.proxy(this.openMap, this)).appendTo(this.el),
            this.button = $('<div class="stringeditor-button"><div class="i-32-18 i-light-grey i-field-location"></div></div>').click($.proxy(this.openMap, this)).appendTo(this.el),
            this.mapLoadErrors = !1,
            this.editing = !1,
            this.updating = !1,
            this.updateEditor = null,
            this.saveEditor = null,
            this.applyEditor = null,
            this.destroyEditor = null,
            m.a.apply(this, arguments)
        }
        function q(e, t) {
            m.a.apply(this, arguments),
            this.el = $('<div class="stringeditor">').appendTo(e.el),
            this.text = $('<div class="input-text multicombo">').appendTo(this.el).click($.proxy(e.focus, e)),
            this.button = $('<div class="choice-dropdown">').appendTo(this.el).touch($.proxy(this.container.focus, this.container))
        }
        function Y(e, t) {
            m.a.apply(this, arguments),
            this.el = $('<div class="stringeditor">').appendTo(e.el).touch($.proxy(this.popup, this)),
            this.text = $('<div class="input-text">').appendTo(this.el)
        }
        Object.assign(V.prototype, m.a.prototype),
        V.prototype.editorClass = "exp",
        V.prototype.destroy = function() {
            this.el.remove(),
            m.a.prototype.destroy.apply(this, arguments)
        },
        V.prototype.updateUI = function() {
            this.text.text(this.model.field.format(this.value))
        },
        V.prototype.startEdit = function() {
            var e = this;
            new z.a({
                schema: e.model.schema,
                type: e.model.type,
                variables: e.model.field.getVariables ? e.model.field.getVariables() : {},
                supportsCommands: e.model.field.supportsCommands,
                ownerField: e.model.field,
                value: e.value,
                okay: function(t) {
                    e.updateModel(t)
                },
                cancel: function() {}
            })
        },
        V.prototype.createButton = function() {
            this.button = $('<div class="stringeditor-button"><div class="i-32-18 i-light-grey i-field-fn"></div></div>').click($.proxy(this.openURL, this)).appendTo(this.el)
        },
        Object.assign(W.prototype, m.a.prototype),
        W.prototype.editorClass = "stringtemplate",
        W.prototype.destroy = function() {
            this.input && this.input.remove(),
            this.$button && this.$button.remove(),
            m.a.prototype.destroy.apply(this, arguments)
        },
        W.prototype.updateUI = function() {
            var e = this.model,
                t = this.value,
                i = queries.formatSystemStringTemplateHuman(t, e.type);
            this.input.val(i)
        },
        W.prototype.updateModel = function(e, t) {
            var i = this.model,
                o = queries.formatHumanStringTemplateSystem(e, i.type);
            m.a.prototype.updateModel.call(this, o, t)
        },
        Object.assign(B.prototype, m.a.prototype),
        B.prototype.editorClass = "location",
        B.prototype.destroy = function() {
            this.el.remove(),
            this.editing && this.destroyEditor(),
            m.a.prototype.destroy.apply(this, arguments)
        },
        B.prototype.save = function() {
            this.editing && this.saveEditor()
        },
        B.prototype.updateUI = function() {
            this.value ? (this.text.text(this.model.field.format(this.value)), this.text[0].style.color = "") : "placeholder" === this.model.field.labelPosition ? (this.text.text(this.model.field.caption), this.text[0].style.color = "#999") : (this.text.text(""), this.text[0].style.color = ""),
            this.editing && this.updateEditor()
        },
        B.prototype.focus = function() {
            var e = this;
            if (!e.editing && !e.updating) {
                e.editing = !0,
                e.updateEditor = f,
                e.saveEditor = v,
                e.applyEditor = g,
                e.destroyEditor = b;
                var t = "",
                    i = "",
                    o = "",
                    n = {};
                $.pushInputHandler(n);
                var s = $('<div class="nx-backplane">').appendTo($(document.body)).touch((function(e) {
                    $(e.target).is(".nx-backplane") && g()
                }));
                e.$focusedBackPlane = s;
                var a = $('<div class="nx-menu-popup grey" style="width:432px">').appendTo(s),
                    r = e.text.offset(),
                    l = e.el.width(),
                    c = $('<input type="text" class="input-location" style="z-index: 0;position:absolute;left:' + r.left + "px;top:" + r.top + "px;width:" + l + 'px">').appendTo(s).keydown(m);
                this.$title = c;
                var d = $('<div class="editor" style="width:180px;display:inline-block">').appendTo(a);
                $("<label>").text(locale.latitude).appendTo(d);
                var h = $('<input type="text" class= "lat" >').appendTo(d).keydown(m);
                this.$latitude = h;
                var p = $('<div class="editor" style="width:180px;display:inline-block">').appendTo(a);
                $("<label>").text(locale.longitude).appendTo(p);
                var u = $('<input type="text" class="lng">').appendTo(p).keydown(m);
                this.$longitude = u,
                $('<div class="icon-big-grey icon-big-search" style="position:absolute;left:368px;top:26px">').appendTo(a).on(TOUCH ? EVENT_touchstart : "mousedown", (function(e) {
                    e.preventDefault(),
                    function(e) {
                        if (!c.val())
                            return u.val(""), h.val(""), e();
                        $.loading(!0),
                        NinoxDocumentInteraction.coordinatesForAddress(c.val(), (function(t, i) {
                            $.loading(!1),
                            i && (c.val(i.title || c.val() || ""), u.val(util.formatNumber(null, i.longitude)), h.val(util.formatNumber(null, i.latitude))),
                            e()
                        }))
                    }((function() {}))
                })),
                $('<div class="icon-big-grey icon-big-location" style="position:absolute;left:400px;top:26px">').appendTo(a).touch((function() {
                    g((function() {
                        e.openMap()
                    }))
                })),
                c.focus(),
                c.select(),
                f(),
                function() {
                    var t = e.el.offset(),
                        i = window.getWidth(),
                        o = window.getHeight(),
                        n = a.outerWidth(),
                        s = a.outerHeight(),
                        r = t.left + n > i ? i - n : t.left,
                        l = t.top + 36 + s > o ? t.top - s - 4 : t.top + 36;
                    a.css({
                        left: r,
                        top: l
                    })
                }()
            }
            function f() {
                var n = util.parseLocation(e.value);
                t = n ? n.title : "",
                i = n ? util.formatNumber(null, n.longitude) : "",
                o = n ? util.formatNumber(null, n.latitude) : "",
                c.val(t),
                u.val(i),
                h.val(o)
            }
            function m(t) {
                9 === t.which ? t.shiftKey ? t.target === c[0] && (t.preventDefault(), g((function() {
                    setTimeout((function() {
                        e.container.focusPrev()
                    }), 0)
                }))) : t.target === c[0] && (t.preventDefault(), g((function() {
                    setTimeout((function() {
                        e.container.focusNext()
                    }), 0)
                }))) : 13 === t.which ? (t.preventDefault(), g()) : 27 === t.which && (t.preventDefault(), b())
            }
            function g(e) {
                b(),
                v(e)
            }
            function v(n) {
                var s = c.val(),
                    a = u.val(),
                    r = h.val();
                if (s != t || a != i || r != o) {
                    var l = util.formatLocation({
                        title: s,
                        longitude: util.parseNumber(a),
                        latitude: util.parseNumber(r)
                    });
                    e.updating = !0,
                    e.updateModel(l, (function(t) {
                        e.updating = !1,
                        n && n()
                    }))
                } else
                    n && n()
            }
            function b() {
                s.remove(),
                $.popInputHandler(n),
                e.editing = !1,
                e.updateEditor = null,
                e.saveEditor = null,
                e.applyEditor = null,
                e.destroyEditor = null,
                e.$focusedBackPlane = null
            }
        },
        B.prototype.blur = function() {
            this.editing && this.applyEditor()
        },
        B.prototype.openMap = function() {
            var e = this,
                t = util.parseLocation(this.value);
            NinoxDocumentInteraction.openMap(t, (function(t, i) {
                var o = util.formatLocation(i);
                e.updateModel(o)
            }))
        },
        Object.assign(q.prototype, m.a.prototype),
        q.prototype.editorClass = "choice",
        q.prototype.destroy = function() {
            this.el.remove(),
            m.a.prototype.destroy.apply(this, arguments)
        },
        q.prototype.updateUI = function() {
            for (var e = this.model.field, t = g.sortBy(e.getValues(), "order"), i = "", o = 0; o < t.length; o++) {
                var n = t[o],
                    s = this.value && this.value[n.id];
                s && (i += '<div class="multicombo-item" style="' + (s && n.color ? "background-color:" + n.color + ";color:" + n.textColor : "") + '" data-id="' + n.id + '">' + (n.icon ? '<div class="choice-symbol ic ic-' + n.icon + '"></div>' : "") + "<span>" + htmlEscape(n.caption || "") + "</span></div>")
            }
            this.text.html(i)
        },
        q.prototype.focus = function() {
            var e = this,
                t = g.sortBy(e.model.field.getValues(), "order"),
                i = $.backplane({}),
                o = $('<div class="choice-menu" style="min-width:' + this.el.outerWidth() + 'px;overflow:auto;z-index:12">').appendTo(i).touch((function(o) {
                    $(o.target);
                    var s,
                        a = $(o.target).closest(".choice-menu-item").attr("data-id");
                    if (!a)
                        return;
                    "#new" === a && (e.addValue(), i.close());
                    if ("#all" === a) {
                        s = {};
                        for (var r = 0; r < t.length; r++)
                            s[t[r].id] = !0
                    } else
                        "#none" === a ? s = {} : (s = Object.assign({}, e.value))[a] ? delete s[a] : s[a] = !0;
                    e.updateModel(s),
                    n()
                }));
            function n() {
                for (var i = '<div class="choice-menu-head"><div data-id="#all" class="choice-menu-item"><div class="choice-label">' + htmlEscape(locale.all) + '</div></div><div data-id="#none" class="choice-menu-item"><div class="choice-label">' + htmlEscape(locale.none) + '</div></div><div data-id="#new" class="choice-menu-item"><div class="choice-label">' + htmlEscape(locale.addRole) + "</div></div></div>", n = 0; n < t.length; n++) {
                    var s = t[n],
                        a = e.value && e.value[s.id];
                    i += '<div data-id="' + s.id + '" class="choice-menu-item"><div class="choice-indicator' + (a ? " selected" : "") + '"></div><div class="multicombo-item" style="' + (s.color ? "background-color:" + s.color + ";color:" + s.textColor : "") + '" data-id="' + s.id + '">' + (s.icon ? '<div class="choice-symbol ic ic-' + s.icon + '"></div>' : "") + "<span>" + htmlEscape(s.caption || "") + "</span></div></div>"
                }
                o.html(i)
            }
            n(),
            function() {
                var i = e.el.offset(),
                    n = window.getWidth(),
                    s = window.getHeight(),
                    a = i.left,
                    r = i.top + 36,
                    l = o.outerWidth(),
                    c = 32 * (t.length + 1);
                c > s - r && (s - r >= i.top - 4 ? c = s - r : (c = Math.min(i.top - 4, c), r = i.top - 4 - c));
                a + l > n && (a = n - l);
                o.css({
                    left: a,
                    top: r,
                    height: c
                })
            }()
        },
        q.prototype.addValue = function() {
            var e = this,
                t = this.model,
                i = $.popdown({
                    cls: "small",
                    head: locale.addRole,
                    buttons: ["cancel", "-", {
                        caption: locale.okay,
                        cls: "blue",
                        click: function() {
                            var n = o.val().trim();
                            if (!n)
                                return;
                            t.field.createValue(n, (function(t, o) {
                                if (t)
                                    return $.alert(t);
                                var n = {};
                                n[o.id] = !0,
                                e.updateModel(n),
                                e.updateUI(),
                                i.close()
                            }))
                        }
                    }]
                }),
                o = $.input({
                    caption: locale.roleCaption,
                    $container: i.$content,
                    focus: !0
                })
        },
        Object.assign(Y.prototype, m.a.prototype),
        Y.prototype.editorClass = "color",
        Y.prototype.destroy = function() {
            this.el.remove()
        },
        Y.prototype.updateUI = function() {
            var e;
            try {
                this.value && (e = JSON.parse(this.value))
            } catch (e) {}
            this.el.css({
                color: e && e.color || "",
                "background-color": e && e.backgroundColor || "",
                "text-align": e && e.textAlign || "",
                "font-size": e && e.fontSize || "",
                "font-weight": e && util.multiHasOne(e.fontStyle, [1]) ? "bold" : "",
                "font-style": e && util.multiHasOne(e.fontStyle, [2]) ? "italic" : ""
            }),
            this.text.text(e ? locale.text : locale.none)
        },
        Y.prototype.popup = function() {
            var e = this,
                t = {};
            try {
                this.value && (t = JSON.parse(this.value))
            } catch (e) {}
            var i = $.backplane({}),
                o = $('<div class="styleeditor-menu">').appendTo(i),
                n = o,
                s = new util.SimpleModel(new schemas.TColor(void 0, void 0, {
                    caption: locale.color,
                    width: 2
                }), t.color);
            s.on("update", m);
            var a = new util.SimpleModel(new schemas.TColor(void 0, void 0, {
                caption: locale.backgroundColor,
                width: 2
            }), t.backgroundColor);
            a.on("update", m);
            var r = new util.SimpleModel(new schemas.TChoice(void 0, void 0, {
                caption: locale.printFontSize,
                required: !0,
                choiceDefault: "1em",
                width: 2,
                values: {
                    ".9em": {
                        id: ".9em",
                        caption: locale.fontSmall,
                        order: 1
                    },
                    "1em": {
                        id: "1em",
                        caption: locale.fontNormal,
                        order: 2
                    },
                    "1.2em": {
                        id: "1.2em",
                        caption: locale.fontLarge,
                        order: 3
                    },
                    "1.5em": {
                        id: "1.5em",
                        caption: locale.fontVeryLarge,
                        order: 4
                    }
                }
            }), t.fontSize || "1em");
            r.on("update", m);
            var l = new util.SimpleModel(new schemas.TMulti(void 0, void 0, {
                caption: locale.fontStyle,
                width: 2,
                values: {
                    1: {
                        id: "1",
                        caption: locale.bold,
                        order: 1
                    },
                    2: {
                        id: "2",
                        caption: locale.italic,
                        order: 2
                    }
                }
            }), t.fontStyle);
            l.on("update", m);
            var c = new util.SimpleModel(new schemas.TChoice(void 0, void 0, {
                caption: locale.textAlign,
                required: !0,
                choiceDefault: "left",
                choiceRenderer: "switch",
                width: 4,
                values: {
                    left: {
                        id: "left",
                        caption: locale.left,
                        order: 1
                    },
                    center: {
                        id: "center",
                        caption: locale.center,
                        order: 2
                    },
                    right: {
                        id: "right",
                        caption: locale.right,
                        order: 3
                    }
                }
            }), t.textAlign || "left");
            c.on("update", m);
            var d = new util.SimpleModel(new schemas.TChoice(void 0, void 0, {
                caption: locale.borderStyle,
                required: !0,
                choiceDefault: "none",
                formWidth: .35,
                values: {
                    none: {
                        id: "none",
                        caption: locale.none,
                        order: 1
                    },
                    solid: {
                        id: "solid",
                        caption: locale.solid,
                        order: 2
                    },
                    double: {
                        id: "double",
                        caption: locale.double,
                        order: 3
                    },
                    dotted: {
                        id: "dotted",
                        caption: locale.dotted,
                        order: 4
                    },
                    dashed: {
                        id: "dashed",
                        caption: locale.dashed,
                        order: 5
                    }
                }
            }), t.borderStyle || "none");
            d.on("update", m);
            var h = new util.SimpleModel(new schemas.TChoice(void 0, void 0, {
                caption: locale.borderWidth,
                required: !0,
                choiceDefault: "none",
                formWidth: .35,
                values: {
                    thin: {
                        id: "thin",
                        caption: locale.thin,
                        order: 1
                    },
                    medium: {
                        id: "medium",
                        caption: locale.medium,
                        order: 2
                    },
                    thick: {
                        id: "thick",
                        caption: locale.thick,
                        order: 3
                    }
                }
            }), t.borderWidth || "thin");
            h.on("update", m);
            var p = new util.SimpleModel(new schemas.TColor(void 0, void 0, {
                caption: locale.borderColor,
                formWidth: .3
            }), t.borderColor || "#000");
            p.on("update", m);
            var u = new util.SimpleModel(new schemas.TMulti(void 0, void 0, {
                caption: locale.borderSides,
                width: 4,
                values: {
                    1: {
                        id: "1",
                        caption: locale.left,
                        order: 1
                    },
                    2: {
                        id: "2",
                        caption: locale.top,
                        order: 2
                    },
                    3: {
                        id: "3",
                        caption: locale.bottom,
                        order: 3
                    },
                    4: {
                        id: "4",
                        caption: locale.right,
                        order: 4
                    }
                }
            }), t.borderSides || util.multiEncode([1, 2, 3, 4]));
            u.on("update", m);
            new P.a(void 0, s, n),
            new P.a(void 0, a, n),
            new P.a(void 0, r, n),
            new P.a(void 0, l, n),
            new P.a(void 0, c, n),
            new P.a(void 0, d, n),
            new P.a(void 0, h, n),
            new P.a(void 0, p, n),
            new P.a(void 0, u, n);
            var f = $('<div class="styleeditor-controls">').appendTo(n);
            function m() {
                e.updateModel(JSON.stringify({
                    color: s.value,
                    backgroundColor: a.value,
                    fontSize: r.value,
                    fontStyle: l.value,
                    textAlign: c.value,
                    borderStyle: d.value,
                    borderWidth: h.value,
                    borderColor: p.value,
                    borderSides: u.value
                }))
            }
            function g() {
                i.close()
            }
            $('<div class="nx-button-text grey">').text(locale.clear).appendTo(f).touch((function() {
                e.updateModel(null),
                g()
            })),
            $('<div class="nx-hspace-flex">').appendTo(f),
            $('<div class="nx-button-text blue">').text(locale.okay).appendTo(f).touch((function() {
                m(),
                g()
            })),
            function() {
                var t = o.outerWidth(),
                    i = o.outerHeight(),
                    n = e.el.offset();
                n.top += 32,
                n.left + t > window.getWidth() && (n.left = window.getWidth() - t);
                n.top + i > window.getHeight() && (n.top = window.getHeight() - i);
                o.offset(n)
            }()
        };
        const X = window.NINOX_IOS || window.NINOX_ANDROID ? T : x.a,
            G = window.NINOX_IOS || window.NINOX_ANDROID ? s : a,
            J = window.NINOX_IOS || window.NINOX_ANDROID ? C : x.b,
            K = {
                choice: X,
                "choice-combo": X,
                boolean: X,
                "boolean-combo": X,
                appointment: n,
                string: o.a,
                timeinterval: o.a,
                email: r,
                phone: l,
                link: w,
                fn: y,
                date: c,
                datx: c,
                time: d,
                timestamp: c,
                dchoice: X,
                "dchoice-combo": X,
                "choice-switch": k,
                "dchoice-switch": k,
                "user-switch": S,
                "choice-radio": E,
                "dchoice-radio": E,
                "user-radio": _,
                dmulti: D,
                "multi-combo": D,
                "dmulti-combo": D,
                "multi-radio": M,
                "multi-switch": N,
                "dmulti-switch": N,
                "dmulti-radio": M,
                "boolean-switch": I,
                "boolean-check": O,
                "boolean-slide": R,
                icon: j.b,
                color: L.b,
                roles: A,
                html: H,
                number: G,
                numberformat: U,
                exp: V,
                stringtemplate: W,
                location: B,
                extchoice: q,
                style: Y,
                user: J,
                "user-combo": J
            };
        function Q() {
            const e = {
                popupEditorStack: [],
                DONT_SHOW_LABEL: {
                    "boolean-check": !0,
                    "boolean-slide": !0
                }
            };
            return e
        }
        function Z() {
            return database.adminMode && database.isAdminEnabled()
        }
        function ee(e, t) {
            var i = t.field;
            return new (K[i.getEditorClass()] || K.string)(e, t)
        }
        function te(e) {
            return "editor editor-" + ("fn" === e.base ? e.exp ? e.exp.returnType.base : "fn" : e.base)
        }
    },
    "./src/lib/excel/jszip.js": function(e, t, i) {
        "use strict";
        (function(e, t) {
            i("./node_modules/core-js/modules/es.string.replace.js"),
            i("./node_modules/core-js/modules/es.typed-array.int32-array.js"),
            i("./node_modules/core-js/modules/es.typed-array.uint8-array.js"),
            i("./node_modules/core-js/modules/es.typed-array.uint16-array.js"),
            i("./node_modules/core-js/modules/es.typed-array.uint32-array.js"),
            i("./node_modules/core-js/modules/web.immediate.js");
            !function(o) {
                if ("object" == typeof exports && void 0 !== e)
                    e.exports = o();
                else if ("function" == typeof define && i("./node_modules/webpack/buildin/amd-options.js"))
                    define([], o);
                else {
                    var n;
                    "undefined" != typeof window ? n = window : void 0 !== t ? n = t : "undefined" != typeof self && (n = self),
                    n.JSZip = o()
                }
            }((function() {
                return function e(t, i, o) {
                    function n(a, r) {
                        if (!i[a]) {
                            if (!t[a]) {
                                if (s)
                                    return s(a, !0);
                                throw new Error("Cannot find module '" + a + "'")
                            }
                            var l = i[a] = {
                                exports: {}
                            };
                            t[a][0].call(l.exports, (function(e) {
                                var i = t[a][1][e];
                                return n(i || e)
                            }), l, l.exports, e, t, i, o)
                        }
                        return i[a].exports
                    }
                    for (var s = !1, a = 0; a < o.length; a++)
                        n(o[a]);
                    return n
                }({
                    1: [function(e, t, i) {
                        var o = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
                        i.encode = function(e, t) {
                            for (var i, n, s, a, r, l, c, d = "", h = 0; h < e.length;)
                                a = (i = e.charCodeAt(h++)) >> 2,
                                r = (3 & i) << 4 | (n = e.charCodeAt(h++)) >> 4,
                                l = (15 & n) << 2 | (s = e.charCodeAt(h++)) >> 6,
                                c = 63 & s,
                                isNaN(n) ? l = c = 64 : isNaN(s) && (c = 64),
                                d = d + o.charAt(a) + o.charAt(r) + o.charAt(l) + o.charAt(c);
                            return d
                        },
                        i.decode = function(e, t) {
                            var i,
                                n,
                                s,
                                a,
                                r,
                                l,
                                c = "",
                                d = 0;
                            for (e = e.replace(/[^A-Za-z0-9\+\/\=]/g, ""); d < e.length;)
                                i = o.indexOf(e.charAt(d++)) << 2 | (a = o.indexOf(e.charAt(d++))) >> 4,
                                n = (15 & a) << 4 | (r = o.indexOf(e.charAt(d++))) >> 2,
                                s = (3 & r) << 6 | (l = o.indexOf(e.charAt(d++))),
                                c += String.fromCharCode(i),
                                64 != r && (c += String.fromCharCode(n)),
                                64 != l && (c += String.fromCharCode(s));
                            return c
                        }
                    }, {}],
                    2: [function(e, t, i) {
                        function o() {
                            this.compressedSize = 0,
                            this.uncompressedSize = 0,
                            this.crc32 = 0,
                            this.compressionMethod = null,
                            this.compressedContent = null
                        }
                        o.prototype = {
                            getContent: function() {
                                return null
                            },
                            getCompressedContent: function() {
                                return null
                            }
                        },
                        t.exports = o
                    }, {}],
                    3: [function(e, t, i) {
                        i.STORE = {
                            magic: "\0\0",
                            compress: function(e) {
                                return e
                            },
                            uncompress: function(e) {
                                return e
                            },
                            compressInputType: null,
                            uncompressInputType: null
                        },
                        i.DEFLATE = e("./flate")
                    }, {
                        "./flate": 8
                    }],
                    4: [function(e, t, i) {
                        var o = e("./utils"),
                            n = [0, 1996959894, 3993919788, 2567524794, 124634137, 1886057615, 3915621685, 2657392035, 249268274, 2044508324, 3772115230, 2547177864, 162941995, 2125561021, 3887607047, 2428444049, 498536548, 1789927666, 4089016648, 2227061214, 450548861, 1843258603, 4107580753, 2211677639, 325883990, 1684777152, 4251122042, 2321926636, 335633487, 1661365465, 4195302755, 2366115317, 997073096, 1281953886, 3579855332, 2724688242, 1006888145, 1258607687, 3524101629, 2768942443, 901097722, 1119000684, 3686517206, 2898065728, 853044451, 1172266101, 3705015759, 2882616665, 651767980, 1373503546, 3369554304, 3218104598, 565507253, 1454621731, 3485111705, 3099436303, 671266974, 1594198024, 3322730930, 2970347812, 795835527, 1483230225, 3244367275, 3060149565, 1994146192, 31158534, 2563907772, 4023717930, 1907459465, 112637215, 2680153253, 3904427059, 2013776290, 251722036, 2517215374, 3775830040, 2137656763, 141376813, 2439277719, 3865271297, 1802195444, 476864866, 2238001368, 4066508878, 1812370925, 453092731, 2181625025, 4111451223, 1706088902, 314042704, 2344532202, 4240017532, 1658658271, 366619977, 2362670323, 4224994405, 1303535960, 984961486, 2747007092, 3569037538, 1256170817, 1037604311, 2765210733, 3554079995, 1131014506, 879679996, 2909243462, 3663771856, 1141124467, 855842277, 2852801631, 3708648649, 1342533948, 654459306, 3188396048, 3373015174, 1466479909, 544179635, 3110523913, 3462522015, 1591671054, 702138776, 2966460450, 3352799412, 1504918807, 783551873, 3082640443, 3233442989, 3988292384, 2596254646, 62317068, 1957810842, 3939845945, 2647816111, 81470997, 1943803523, 3814918930, 2489596804, 225274430, 2053790376, 3826175755, 2466906013, 167816743, 2097651377, 4027552580, 2265490386, 503444072, 1762050814, 4150417245, 2154129355, 426522225, 1852507879, 4275313526, 2312317920, 282753626, 1742555852, 4189708143, 2394877945, 397917763, 1622183637, 3604390888, 2714866558, 953729732, 1340076626, 3518719985, 2797360999, 1068828381, 1219638859, 3624741850, 2936675148, 906185462, 1090812512, 3747672003, 2825379669, 829329135, 1181335161, 3412177804, 3160834842, 628085408, 1382605366, 3423369109, 3138078467, 570562233, 1426400815, 3317316542, 2998733608, 733239954, 1555261956, 3268935591, 3050360625, 752459403, 1541320221, 2607071920, 3965973030, 1969922972, 40735498, 2617837225, 3943577151, 1913087877, 83908371, 2512341634, 3803740692, 2075208622, 213261112, 2463272603, 3855990285, 2094854071, 198958881, 2262029012, 4057260610, 1759359992, 534414190, 2176718541, 4139329115, 1873836001, 414664567, 2282248934, 4279200368, 1711684554, 285281116, 2405801727, 4167216745, 1634467795, 376229701, 2685067896, 3608007406, 1308918612, 956543938, 2808555105, 3495958263, 1231636301, 1047427035, 2932959818, 3654703836, 1088359270, 936918e3, 2847714899, 3736837829, 1202900863, 817233897, 3183342108, 3401237130, 1404277552, 615818150, 3134207493, 3453421203, 1423857449, 601450431, 3009837614, 3294710456, 1567103746, 711928724, 3020668471, 3272380065, 1510334235, 755167117];
                        t.exports = function(e, t) {
                            if (void 0 === e || !e.length)
                                return 0;
                            var i = "string" !== o.getTypeOf(e);
                            void 0 === t && (t = 0);
                            var s = 0;
                            t ^= -1;
                            for (var a = 0, r = e.length; a < r; a++)
                                s = i ? e[a] : e.charCodeAt(a),
                                t = t >>> 8 ^ n[255 & (t ^ s)];
                            return -1 ^ t
                        }
                    }, {
                        "./utils": 19
                    }],
                    5: [function(e, t, i) {
                        var o = e("./utils");
                        function n(e) {
                            this.data = null,
                            this.length = 0,
                            this.index = 0
                        }
                        n.prototype = {
                            checkOffset: function(e) {
                                this.checkIndex(this.index + e)
                            },
                            checkIndex: function(e) {
                                if (this.length < e || e < 0)
                                    throw new Error("End of data reached (data length = " + this.length + ", asked index = " + e + "). Corrupted zip ?")
                            },
                            setIndex: function(e) {
                                this.checkIndex(e),
                                this.index = e
                            },
                            skip: function(e) {
                                this.setIndex(this.index + e)
                            },
                            byteAt: function(e) {},
                            readInt: function(e) {
                                var t,
                                    i = 0;
                                for (this.checkOffset(e), t = this.index + e - 1; t >= this.index; t--)
                                    i = (i << 8) + this.byteAt(t);
                                return this.index += e, i
                            },
                            readString: function(e) {
                                return o.transformTo("string", this.readData(e))
                            },
                            readData: function(e) {},
                            lastIndexOfSignature: function(e) {},
                            readDate: function() {
                                var e = this.readInt(4);
                                return new Date(1980 + (e >> 25 & 127), (e >> 21 & 15) - 1, e >> 16 & 31, e >> 11 & 31, e >> 5 & 63, (31 & e) << 1)
                            }
                        },
                        t.exports = n
                    }, {
                        "./utils": 19
                    }],
                    6: [function(e, t, i) {
                        i.base64 = !1,
                        i.binary = !1,
                        i.dir = !1,
                        i.date = null,
                        i.compression = null,
                        i.comment = null
                    }, {}],
                    7: [function(e, t, i) {
                        var o = e("./utils");
                        i.string2binary = function(e) {
                            return o.string2binary(e)
                        },
                        i.string2Uint8Array = function(e) {
                            return o.transformTo("uint8array", e)
                        },
                        i.uint8Array2String = function(e) {
                            return o.transformTo("string", e)
                        },
                        i.string2Blob = function(e) {
                            var t = o.transformTo("arraybuffer", e);
                            return o.arrayBuffer2Blob(t)
                        },
                        i.arrayBuffer2Blob = function(e) {
                            return o.arrayBuffer2Blob(e)
                        },
                        i.transformTo = function(e, t) {
                            return o.transformTo(e, t)
                        },
                        i.getTypeOf = function(e) {
                            return o.getTypeOf(e)
                        },
                        i.checkSupport = function(e) {
                            return o.checkSupport(e)
                        },
                        i.MAX_VALUE_16BITS = o.MAX_VALUE_16BITS,
                        i.MAX_VALUE_32BITS = o.MAX_VALUE_32BITS,
                        i.pretty = function(e) {
                            return o.pretty(e)
                        },
                        i.findCompression = function(e) {
                            return o.findCompression(e)
                        },
                        i.isRegExp = function(e) {
                            return o.isRegExp(e)
                        }
                    }, {
                        "./utils": 19
                    }],
                    8: [function(e, t, i) {
                        var o = "undefined" != typeof Uint8Array && "undefined" != typeof Uint16Array && "undefined" != typeof Uint32Array,
                            n = e("pako");
                        i.uncompressInputType = o ? "uint8array" : "array",
                        i.compressInputType = o ? "uint8array" : "array",
                        i.magic = "\b\0",
                        i.compress = function(e) {
                            return n.deflateRaw(e)
                        },
                        i.uncompress = function(e) {
                            return n.inflateRaw(e)
                        }
                    }, {
                        pako: 24
                    }],
                    9: [function(e, t, i) {
                        var o = e("./base64");
                        function n(e, t) {
                            if (!(this instanceof n))
                                return new n(e, t);
                            this.files = {},
                            this.comment = null,
                            this.root = "",
                            e && this.load(e, t),
                            this.clone = function() {
                                var e = new n;
                                for (var t in this)
                                    "function" != typeof this[t] && (e[t] = this[t]);
                                return e
                            }
                        }
                        n.prototype = e("./object"),
                        n.prototype.load = e("./load"),
                        n.support = e("./support"),
                        n.defaults = e("./defaults"),
                        n.utils = e("./deprecatedPublicUtils"),
                        n.base64 = {
                            encode: function(e) {
                                return o.encode(e)
                            },
                            decode: function(e) {
                                return o.decode(e)
                            }
                        },
                        n.compressions = e("./compressions"),
                        t.exports = n
                    }, {
                        "./base64": 1,
                        "./compressions": 3,
                        "./defaults": 6,
                        "./deprecatedPublicUtils": 7,
                        "./load": 10,
                        "./object": 11,
                        "./support": 15
                    }],
                    10: [function(e, t, i) {
                        var o = e("./base64"),
                            n = e("./zipEntries");
                        t.exports = function(e, t) {
                            var i,
                                s,
                                a,
                                r;
                            for ((t = t || {}).base64 && (e = o.decode(e)), i = (s = new n(e, t)).files, a = 0; a < i.length; a++)
                                r = i[a],
                                this.file(r.fileName, r.decompressed, {
                                    binary: !0,
                                    optimizedBinaryString: !0,
                                    date: r.date,
                                    dir: r.dir,
                                    comment: r.fileComment.length ? r.fileComment : null
                                });
                            return s.zipComment.length && (this.comment = s.zipComment), this
                        }
                    }, {
                        "./base64": 1,
                        "./zipEntries": 20
                    }],
                    11: [function(e, t, i) {
                        var o,
                            n = e("./support"),
                            s = e("./utils"),
                            a = e("./crc32"),
                            r = e("./signature"),
                            l = e("./defaults"),
                            c = e("./base64"),
                            d = e("./compressions"),
                            h = e("./compressedObject"),
                            p = e("./nodeBuffer"),
                            u = e("./utf8"),
                            f = e("./stringWriter"),
                            m = e("./uint8ArrayWriter");
                        n.uint8array && "function" == typeof TextEncoder && (o = new TextEncoder("utf-8"));
                        var g = function(e) {
                                if (e._data instanceof h && (e._data = e._data.getContent(), e.options.binary = !0, e.options.base64 = !1, "uint8array" === s.getTypeOf(e._data))) {
                                    var t = e._data;
                                    e._data = new Uint8Array(t.length),
                                    0 !== t.length && e._data.set(t, 0)
                                }
                                return e._data
                            },
                            v = function(e) {
                                var t = g(e);
                                if ("string" === s.getTypeOf(t)) {
                                    if (!e.options.binary) {
                                        if (o)
                                            return o.encode(t);
                                        if (n.nodebuffer)
                                            return p(t, "utf-8")
                                    }
                                    return e.asBinary()
                                }
                                return t
                            },
                            b = function(e) {
                                var t = g(this);
                                return null == t ? "" : (this.options.base64 && (t = c.decode(t)), t = e && this.options.binary ? S.utf8decode(t) : s.transformTo("string", t), e || this.options.binary || (t = s.transformTo("string", S.utf8encode(t))), t)
                            },
                            y = function(e, t, i) {
                                this.name = e,
                                this.dir = i.dir,
                                this.date = i.date,
                                this.comment = i.comment,
                                this._data = t,
                                this.options = i,
                                this._initialMetadata = {
                                    dir: i.dir,
                                    date: i.date
                                }
                            };
                        y.prototype = {
                            asText: function() {
                                return b.call(this, !0)
                            },
                            asBinary: function() {
                                return b.call(this, !1)
                            },
                            asNodeBuffer: function() {
                                var e = v(this);
                                return s.transformTo("nodebuffer", e)
                            },
                            asUint8Array: function() {
                                var e = v(this);
                                return s.transformTo("uint8array", e)
                            },
                            asArrayBuffer: function() {
                                return this.asUint8Array().buffer
                            }
                        };
                        var w = function(e, t) {
                                var i,
                                    o = "";
                                for (i = 0; i < t; i++)
                                    o += String.fromCharCode(255 & e),
                                    e >>>= 8;
                                return o
                            },
                            x = function() {
                                var e,
                                    t,
                                    i = {};
                                for (e = 0; e < arguments.length; e++)
                                    for (t in arguments[e])
                                        arguments[e].hasOwnProperty(t) && void 0 === i[t] && (i[t] = arguments[e][t]);
                                return i
                            },
                            T = function(e, t, i) {
                                var o = s.getTypeOf(t);
                                if ((i = function(e) {
                                    return !0 !== (e = e || {}).base64 || null !== e.binary && void 0 !== e.binary || (e.binary = !0), (e = x(e, l)).date = e.date || new Date, null !== e.compression && (e.compression = e.compression.toUpperCase()), e
                                }(i)).dir || null == t)
                                    i.base64 = !1,
                                    i.binary = !1,
                                    t = null;
                                else if ("string" === o)
                                    i.binary && !i.base64 && !0 !== i.optimizedBinaryString && (t = s.string2binary(t));
                                else {
                                    if (i.base64 = !1, i.binary = !0, !(o || t instanceof h))
                                        throw new Error("The data of '" + e + "' is in an unsupported format !");
                                    "arraybuffer" === o && (t = s.transformTo("uint8array", t))
                                }
                                var n = new y(e, t, i);
                                return this.files[e] = n, n
                            },
                            $ = function(e) {
                                return "/" != e.slice(-1) && (e += "/"), this.files[e] || T.call(this, e, null, {
                                    dir: !0
                                }), this.files[e]
                            },
                            C = function(e, t) {
                                var i,
                                    o = new h;
                                return e._data instanceof h ? (o.uncompressedSize = e._data.uncompressedSize, o.crc32 = e._data.crc32, 0 === o.uncompressedSize || e.dir ? (t = d.STORE, o.compressedContent = "", o.crc32 = 0) : e._data.compressionMethod === t.magic ? o.compressedContent = e._data.getCompressedContent() : (i = e._data.getContent(), o.compressedContent = t.compress(s.transformTo(t.compressInputType, i)))) : ((i = v(e)) && 0 !== i.length && !e.dir || (t = d.STORE, i = ""), o.uncompressedSize = i.length, o.crc32 = a(i), o.compressedContent = t.compress(s.transformTo(t.compressInputType, i))), o.compressedSize = o.compressedContent.length, o.compressionMethod = t.magic, o
                            },
                            k = function(e, t, i, o) {
                                i.compressedContent;
                                var n,
                                    l,
                                    c,
                                    d,
                                    h = s.transformTo("string", u.utf8encode(t.name)),
                                    p = t.comment || "",
                                    f = s.transformTo("string", u.utf8encode(p)),
                                    m = h.length !== t.name.length,
                                    g = f.length !== p.length,
                                    v = t.options,
                                    b = "",
                                    y = "",
                                    x = "";
                                c = t._initialMetadata.dir !== t.dir ? t.dir : v.dir,
                                n = (d = t._initialMetadata.date !== t.date ? t.date : v.date).getHours(),
                                n <<= 6,
                                n |= d.getMinutes(),
                                n <<= 5,
                                n |= d.getSeconds() / 2,
                                l = d.getFullYear() - 1980,
                                l <<= 4,
                                l |= d.getMonth() + 1,
                                l <<= 5,
                                l |= d.getDate(),
                                m && (y = w(1, 1) + w(a(h), 4) + h, b += "up" + w(y.length, 2) + y),
                                g && (x = w(1, 1) + w(this.crc32(f), 4) + f, b += "uc" + w(x.length, 2) + x);
                                var T = "";
                                return T += "\n\0", T += m || g ? "\0\b" : "\0\0", T += i.compressionMethod, T += w(n, 2), T += w(l, 2), T += w(i.crc32, 4), T += w(i.compressedSize, 4), T += w(i.uncompressedSize, 4), T += w(h.length, 2), T += w(b.length, 2), {
                                    fileRecord: r.LOCAL_FILE_HEADER + T + h + b,
                                    dirRecord: r.CENTRAL_FILE_HEADER + "\0" + T + w(f.length, 2) + "\0\0\0\0" + (!0 === c ? "\0\0\0" : "\0\0\0\0") + w(o, 4) + h + b + f,
                                    compressedObject: i
                                }
                            },
                            S = {
                                load: function(e, t) {
                                    throw new Error("Load method is not defined. Is the file jszip-load.js included ?")
                                },
                                filter: function(e) {
                                    var t,
                                        i,
                                        o,
                                        n,
                                        s = [];
                                    for (t in this.files)
                                        this.files.hasOwnProperty(t) && (o = this.files[t], n = new y(o.name, o._data, x(o.options)), i = t.slice(this.root.length, t.length), t.slice(0, this.root.length) === this.root && e(i, n) && s.push(n));
                                    return s
                                },
                                file: function(e, t, i) {
                                    if (1 === arguments.length) {
                                        if (s.isRegExp(e)) {
                                            var o = e;
                                            return this.filter((function(e, t) {
                                                return !t.dir && o.test(e)
                                            }))
                                        }
                                        return this.filter((function(t, i) {
                                                return !i.dir && t === e
                                            }))[0] || null
                                    }
                                    return e = this.root + e, T.call(this, e, t, i), this
                                },
                                folder: function(e) {
                                    if (!e)
                                        return this;
                                    if (s.isRegExp(e))
                                        return this.filter((function(t, i) {
                                            return i.dir && e.test(t)
                                        }));
                                    var t = this.root + e,
                                        i = $.call(this, t),
                                        o = this.clone();
                                    return o.root = i.name, o
                                },
                                remove: function(e) {
                                    e = this.root + e;
                                    var t = this.files[e];
                                    if (t || ("/" != e.slice(-1) && (e += "/"), t = this.files[e]), t && !t.dir)
                                        delete this.files[e];
                                    else
                                        for (var i = this.filter((function(t, i) {
                                                return i.name.slice(0, e.length) === e
                                            })), o = 0; o < i.length; o++)
                                            delete this.files[i[o].name];
                                    return this
                                },
                                generate: function(e) {
                                    e = x(e || {}, {
                                        base64: !0,
                                        compression: "STORE",
                                        type: "base64",
                                        comment: null
                                    }),
                                    s.checkSupport(e.type);
                                    var t,
                                        i,
                                        o = [],
                                        n = 0,
                                        a = 0,
                                        l = s.transformTo("string", this.utf8encode(e.comment || this.comment || ""));
                                    for (var h in this.files)
                                        if (this.files.hasOwnProperty(h)) {
                                            var p = this.files[h],
                                                u = p.options.compression || e.compression.toUpperCase(),
                                                g = d[u];
                                            if (!g)
                                                throw new Error(u + " is not a valid compression method !");
                                            var v = C.call(this, p, g),
                                                b = k.call(this, h, p, v, n);
                                            n += b.fileRecord.length + v.compressedSize,
                                            a += b.dirRecord.length,
                                            o.push(b)
                                        }
                                    var y;
                                    y = r.CENTRAL_DIRECTORY_END + "\0\0\0\0" + w(o.length, 2) + w(o.length, 2) + w(a, 4) + w(n, 4) + w(l.length, 2) + l;
                                    var T = e.type.toLowerCase();
                                    for (t = "uint8array" === T || "arraybuffer" === T || "blob" === T || "nodebuffer" === T ? new m(n + a + y.length) : new f(n + a + y.length), i = 0; i < o.length; i++)
                                        t.append(o[i].fileRecord),
                                        t.append(o[i].compressedObject.compressedContent);
                                    for (i = 0; i < o.length; i++)
                                        t.append(o[i].dirRecord);
                                    t.append(y);
                                    var $ = t.finalize();
                                    switch (e.type.toLowerCase()) {
                                    case "uint8array":
                                    case "arraybuffer":
                                    case "nodebuffer":
                                        return s.transformTo(e.type.toLowerCase(), $);
                                    case "blob":
                                        return s.arrayBuffer2Blob(s.transformTo("arraybuffer", $));
                                    case "base64":
                                        return e.base64 ? c.encode($) : $;
                                    default:
                                        return $
                                    }
                                },
                                crc32: function(e, t) {
                                    return a(e, t)
                                },
                                utf8encode: function(e) {
                                    return s.transformTo("string", u.utf8encode(e))
                                },
                                utf8decode: function(e) {
                                    return u.utf8decode(e)
                                }
                            };
                        t.exports = S
                    }, {
                        "./base64": 1,
                        "./compressedObject": 2,
                        "./compressions": 3,
                        "./crc32": 4,
                        "./defaults": 6,
                        "./nodeBuffer": 22,
                        "./signature": 12,
                        "./stringWriter": 14,
                        "./support": 15,
                        "./uint8ArrayWriter": 17,
                        "./utf8": 18,
                        "./utils": 19
                    }],
                    12: [function(e, t, i) {
                        i.LOCAL_FILE_HEADER = "PK",
                        i.CENTRAL_FILE_HEADER = "PK",
                        i.CENTRAL_DIRECTORY_END = "PK",
                        i.ZIP64_CENTRAL_DIRECTORY_LOCATOR = "PK",
                        i.ZIP64_CENTRAL_DIRECTORY_END = "PK",
                        i.DATA_DESCRIPTOR = "PK\b"
                    }, {}],
                    13: [function(e, t, i) {
                        var o = e("./dataReader"),
                            n = e("./utils");
                        function s(e, t) {
                            this.data = e,
                            t || (this.data = n.string2binary(this.data)),
                            this.length = this.data.length,
                            this.index = 0
                        }
                        s.prototype = new o,
                        s.prototype.byteAt = function(e) {
                            return this.data.charCodeAt(e)
                        },
                        s.prototype.lastIndexOfSignature = function(e) {
                            return this.data.lastIndexOf(e)
                        },
                        s.prototype.readData = function(e) {
                            this.checkOffset(e);
                            var t = this.data.slice(this.index, this.index + e);
                            return this.index += e, t
                        },
                        t.exports = s
                    }, {
                        "./dataReader": 5,
                        "./utils": 19
                    }],
                    14: [function(e, t, i) {
                        var o = e("./utils"),
                            n = function() {
                                this.data = []
                            };
                        n.prototype = {
                            append: function(e) {
                                e = o.transformTo("string", e),
                                this.data.push(e)
                            },
                            finalize: function() {
                                return this.data.join("")
                            }
                        },
                        t.exports = n
                    }, {
                        "./utils": 19
                    }],
                    15: [function(e, t, i) {
                        (function(e) {
                            if (i.base64 = !0, i.array = !0, i.string = !0, i.arraybuffer = "undefined" != typeof ArrayBuffer && "undefined" != typeof Uint8Array, i.nodebuffer = !e.browser, i.uint8array = "undefined" != typeof Uint8Array, "undefined" == typeof ArrayBuffer)
                                i.blob = !1;
                            else {
                                var t = new ArrayBuffer(0);
                                try {
                                    i.blob = 0 === new Blob([t], {
                                        type: "application/zip"
                                    }).size
                                } catch (e) {
                                    try {
                                        var o = new (window.BlobBuilder || window.WebKitBlobBuilder || window.MozBlobBuilder || window.MSBlobBuilder);
                                        o.append(t),
                                        i.blob = 0 === o.getBlob("application/zip").size
                                    } catch (e) {
                                        i.blob = !1
                                    }
                                }
                            }
                        }).call(this, e("FWaASH"))
                    }, {
                        FWaASH: 23
                    }],
                    16: [function(e, t, i) {
                        var o = e("./dataReader");
                        function n(e) {
                            e && (this.data = e, this.length = this.data.length, this.index = 0)
                        }
                        n.prototype = new o,
                        n.prototype.byteAt = function(e) {
                            return this.data[e]
                        },
                        n.prototype.lastIndexOfSignature = function(e) {
                            for (var t = e.charCodeAt(0), i = e.charCodeAt(1), o = e.charCodeAt(2), n = e.charCodeAt(3), s = this.length - 4; s >= 0; --s)
                                if (this.data[s] === t && this.data[s + 1] === i && this.data[s + 2] === o && this.data[s + 3] === n)
                                    return s;
                            return -1
                        },
                        n.prototype.readData = function(e) {
                            if (this.checkOffset(e), 0 === e)
                                return new Uint8Array(0);
                            var t = this.data.subarray(this.index, this.index + e);
                            return this.index += e, t
                        },
                        t.exports = n
                    }, {
                        "./dataReader": 5
                    }],
                    17: [function(e, t, i) {
                        var o = e("./utils"),
                            n = function(e) {
                                this.data = new Uint8Array(e),
                                this.index = 0
                            };
                        n.prototype = {
                            append: function(e) {
                                0 !== e.length && (e = o.transformTo("uint8array", e), this.data.set(e, this.index), this.index += e.length)
                            },
                            finalize: function() {
                                return this.data
                            }
                        },
                        t.exports = n
                    }, {
                        "./utils": 19
                    }],
                    18: [function(e, t, i) {
                        var o,
                            n,
                            s = e("./utils"),
                            a = e("./support"),
                            r = e("./nodeBuffer");
                        a.uint8array && "function" == typeof TextEncoder && "function" == typeof TextDecoder && (o = new TextEncoder("utf-8"), n = new TextDecoder("utf-8"));
                        for (var l = new Array(256), c = 0; c < 256; c++)
                            l[c] = c >= 252 ? 6 : c >= 248 ? 5 : c >= 240 ? 4 : c >= 224 ? 3 : c >= 192 ? 2 : 1;
                        l[254] = l[254] = 1;
                        var d = function(e, t) {
                                var i;
                                for ((t = t || e.length) > e.length && (t = e.length), i = t - 1; i >= 0 && 128 == (192 & e[i]);)
                                    i--;
                                return i < 0 || 0 === i ? t : i + l[e[i]] > t ? i : t
                            },
                            h = function(e) {
                                var t,
                                    i,
                                    o,
                                    n,
                                    a = e.length,
                                    r = new Array(2 * a);
                                for (i = 0, t = 0; t < a;)
                                    if ((o = e[t++]) < 128)
                                        r[i++] = o;
                                    else if ((n = l[o]) > 4)
                                        r[i++] = 65533,
                                        t += n - 1;
                                    else {
                                        for (o &= 2 === n ? 31 : 3 === n ? 15 : 7; n > 1 && t < a;)
                                            o = o << 6 | 63 & e[t++],
                                            n--;
                                        n > 1 ? r[i++] = 65533 : o < 65536 ? r[i++] = o : (o -= 65536, r[i++] = 55296 | o >> 10 & 1023, r[i++] = 56320 | 1023 & o)
                                    }
                                return r.length !== i && (r.subarray ? r = r.subarray(0, i) : r.length = i), s.applyFromCharCode(r)
                            };
                        i.utf8encode = function(e) {
                            return o ? o.encode(e) : a.nodebuffer ? r(e, "utf-8") : function(e) {
                                var t,
                                    i,
                                    o,
                                    n,
                                    s,
                                    r = e.length,
                                    l = 0;
                                for (n = 0; n < r; n++)
                                    55296 == (64512 & (i = e.charCodeAt(n))) && n + 1 < r && 56320 == (64512 & (o = e.charCodeAt(n + 1))) && (i = 65536 + (i - 55296 << 10) + (o - 56320), n++),
                                    l += i < 128 ? 1 : i < 2048 ? 2 : i < 65536 ? 3 : 4;
                                for (t = a.uint8array ? new Uint8Array(l) : new Array(l), s = 0, n = 0; s < l; n++)
                                    55296 == (64512 & (i = e.charCodeAt(n))) && n + 1 < r && 56320 == (64512 & (o = e.charCodeAt(n + 1))) && (i = 65536 + (i - 55296 << 10) + (o - 56320), n++),
                                    i < 128 ? t[s++] = i : i < 2048 ? (t[s++] = 192 | i >>> 6, t[s++] = 128 | 63 & i) : i < 65536 ? (t[s++] = 224 | i >>> 12, t[s++] = 128 | i >>> 6 & 63, t[s++] = 128 | 63 & i) : (t[s++] = 240 | i >>> 18, t[s++] = 128 | i >>> 12 & 63, t[s++] = 128 | i >>> 6 & 63, t[s++] = 128 | 63 & i);
                                return t
                            }(e)
                        },
                        i.utf8decode = function(e) {
                            if (n)
                                return n.decode(s.transformTo("uint8array", e));
                            if (a.nodebuffer)
                                return s.transformTo("nodebuffer", e).toString("utf-8");
                            for (var t = [], i = 0, o = (e = s.transformTo(a.uint8array ? "uint8array" : "array", e)).length; i < o;) {
                                var r = d(e, Math.min(i + 65536, o));
                                a.uint8array ? t.push(h(e.subarray(i, r))) : t.push(h(e.slice(i, r))),
                                i = r
                            }
                            return t.join("")
                        }
                    }, {
                        "./nodeBuffer": 22,
                        "./support": 15,
                        "./utils": 19
                    }],
                    19: [function(e, t, i) {
                        var o = e("./support"),
                            n = e("./compressions"),
                            s = e("./nodeBuffer");
                        function a(e) {
                            return e
                        }
                        function r(e, t) {
                            for (var i = 0; i < e.length; ++i)
                                t[i] = 255 & e.charCodeAt(i);
                            return t
                        }
                        function l(e) {
                            var t = 65536,
                                o = [],
                                n = e.length,
                                a = i.getTypeOf(e),
                                r = 0,
                                l = !0;
                            try {
                                switch (a) {
                                case "uint8array":
                                    String.fromCharCode.apply(null, new Uint8Array(0));
                                    break;
                                case "nodebuffer":
                                    String.fromCharCode.apply(null, s(0))
                                }
                            } catch (e) {
                                l = !1
                            }
                            if (!l) {
                                for (var c = "", d = 0; d < e.length; d++)
                                    c += String.fromCharCode(e[d]);
                                return c
                            }
                            for (; r < n && t > 1;)
                                try {
                                    "array" === a || "nodebuffer" === a ? o.push(String.fromCharCode.apply(null, e.slice(r, Math.min(r + t, n)))) : o.push(String.fromCharCode.apply(null, e.subarray(r, Math.min(r + t, n)))),
                                    r += t
                                } catch (e) {
                                    t = Math.floor(t / 2)
                                }
                            return o.join("")
                        }
                        function c(e, t) {
                            for (var i = 0; i < e.length; i++)
                                t[i] = e[i];
                            return t
                        }
                        i.string2binary = function(e) {
                            for (var t = "", i = 0; i < e.length; i++)
                                t += String.fromCharCode(255 & e.charCodeAt(i));
                            return t
                        },
                        i.arrayBuffer2Blob = function(e) {
                            i.checkSupport("blob");
                            try {
                                return new Blob([e], {
                                    type: "application/zip"
                                })
                            } catch (i) {
                                try {
                                    var t = new (window.BlobBuilder || window.WebKitBlobBuilder || window.MozBlobBuilder || window.MSBlobBuilder);
                                    return t.append(e), t.getBlob("application/zip")
                                } catch (e) {
                                    throw new Error("Bug : can't construct the Blob.")
                                }
                            }
                        },
                        i.applyFromCharCode = l;
                        var d = {};
                        d.string = {
                            string: a,
                            array: function(e) {
                                return r(e, new Array(e.length))
                            },
                            arraybuffer: function(e) {
                                return d.string.uint8array(e).buffer
                            },
                            uint8array: function(e) {
                                return r(e, new Uint8Array(e.length))
                            },
                            nodebuffer: function(e) {
                                return r(e, s(e.length))
                            }
                        },
                        d.array = {
                            string: l,
                            array: a,
                            arraybuffer: function(e) {
                                return new Uint8Array(e).buffer
                            },
                            uint8array: function(e) {
                                return new Uint8Array(e)
                            },
                            nodebuffer: function(e) {
                                return s(e)
                            }
                        },
                        d.arraybuffer = {
                            string: function(e) {
                                return l(new Uint8Array(e))
                            },
                            array: function(e) {
                                return c(new Uint8Array(e), new Array(e.byteLength))
                            },
                            arraybuffer: a,
                            uint8array: function(e) {
                                return new Uint8Array(e)
                            },
                            nodebuffer: function(e) {
                                return s(new Uint8Array(e))
                            }
                        },
                        d.uint8array = {
                            string: l,
                            array: function(e) {
                                return c(e, new Array(e.length))
                            },
                            arraybuffer: function(e) {
                                return e.buffer
                            },
                            uint8array: a,
                            nodebuffer: function(e) {
                                return s(e)
                            }
                        },
                        d.nodebuffer = {
                            string: l,
                            array: function(e) {
                                return c(e, new Array(e.length))
                            },
                            arraybuffer: function(e) {
                                return d.nodebuffer.uint8array(e).buffer
                            },
                            uint8array: function(e) {
                                return c(e, new Uint8Array(e.length))
                            },
                            nodebuffer: a
                        },
                        i.transformTo = function(e, t) {
                            if (t || (t = ""), !e)
                                return t;
                            i.checkSupport(e);
                            var o = i.getTypeOf(t);
                            return d[o][e](t)
                        },
                        i.getTypeOf = function(e) {
                            return "string" == typeof e ? "string" : "[object Array]" === Object.prototype.toString.call(e) ? "array" : o.nodebuffer && s.test(e) ? "nodebuffer" : o.uint8array && e instanceof Uint8Array ? "uint8array" : o.arraybuffer && e instanceof ArrayBuffer ? "arraybuffer" : void 0
                        },
                        i.checkSupport = function(e) {
                            if (!o[e.toLowerCase()])
                                throw new Error(e + " is not supported by this browser")
                        },
                        i.MAX_VALUE_16BITS = 65535,
                        i.MAX_VALUE_32BITS = -1,
                        i.pretty = function(e) {
                            var t,
                                i,
                                o = "";
                            for (i = 0; i < (e || "").length; i++)
                                o += "\\x" + ((t = e.charCodeAt(i)) < 16 ? "0" : "") + t.toString(16).toUpperCase();
                            return o
                        },
                        i.findCompression = function(e) {
                            for (var t in n)
                                if (n.hasOwnProperty(t) && n[t].magic === e)
                                    return n[t];
                            return null
                        },
                        i.isRegExp = function(e) {
                            return "[object RegExp]" === Object.prototype.toString.call(e)
                        }
                    }, {
                        "./compressions": 3,
                        "./nodeBuffer": 22,
                        "./support": 15
                    }],
                    20: [function(e, t, i) {
                        var o = e("./stringReader"),
                            n = e("./nodeBufferReader"),
                            s = e("./uint8ArrayReader"),
                            a = e("./utils"),
                            r = e("./signature"),
                            l = e("./zipEntry"),
                            c = e("./support"),
                            d = e("./object");
                        function h(e, t) {
                            this.files = [],
                            this.loadOptions = t,
                            e && this.load(e)
                        }
                        h.prototype = {
                            checkSignature: function(e) {
                                var t = this.reader.readString(4);
                                if (t !== e)
                                    throw new Error("Corrupted zip or bug : unexpected signature (" + a.pretty(t) + ", expected " + a.pretty(e) + ")")
                            },
                            readBlockEndOfCentral: function() {
                                this.diskNumber = this.reader.readInt(2),
                                this.diskWithCentralDirStart = this.reader.readInt(2),
                                this.centralDirRecordsOnThisDisk = this.reader.readInt(2),
                                this.centralDirRecords = this.reader.readInt(2),
                                this.centralDirSize = this.reader.readInt(4),
                                this.centralDirOffset = this.reader.readInt(4),
                                this.zipCommentLength = this.reader.readInt(2),
                                this.zipComment = this.reader.readString(this.zipCommentLength),
                                this.zipComment = d.utf8decode(this.zipComment)
                            },
                            readBlockZip64EndOfCentral: function() {
                                this.zip64EndOfCentralSize = this.reader.readInt(8),
                                this.versionMadeBy = this.reader.readString(2),
                                this.versionNeeded = this.reader.readInt(2),
                                this.diskNumber = this.reader.readInt(4),
                                this.diskWithCentralDirStart = this.reader.readInt(4),
                                this.centralDirRecordsOnThisDisk = this.reader.readInt(8),
                                this.centralDirRecords = this.reader.readInt(8),
                                this.centralDirSize = this.reader.readInt(8),
                                this.centralDirOffset = this.reader.readInt(8),
                                this.zip64ExtensibleData = {};
                                for (var e, t, i, o = this.zip64EndOfCentralSize - 44; 0 < o;)
                                    e = this.reader.readInt(2),
                                    t = this.reader.readInt(4),
                                    i = this.reader.readString(t),
                                    this.zip64ExtensibleData[e] = {
                                        id: e,
                                        length: t,
                                        value: i
                                    }
                            },
                            readBlockZip64EndOfCentralLocator: function() {
                                if (this.diskWithZip64CentralDirStart = this.reader.readInt(4), this.relativeOffsetEndOfZip64CentralDir = this.reader.readInt(8), this.disksCount = this.reader.readInt(4), this.disksCount > 1)
                                    throw new Error("Multi-volumes zip are not supported")
                            },
                            readLocalFiles: function() {
                                var e,
                                    t;
                                for (e = 0; e < this.files.length; e++)
                                    t = this.files[e],
                                    this.reader.setIndex(t.localHeaderOffset),
                                    this.checkSignature(r.LOCAL_FILE_HEADER),
                                    t.readLocalPart(this.reader),
                                    t.handleUTF8()
                            },
                            readCentralDir: function() {
                                var e;
                                for (this.reader.setIndex(this.centralDirOffset); this.reader.readString(4) === r.CENTRAL_FILE_HEADER;)
                                    (e = new l({
                                        zip64: this.zip64
                                    }, this.loadOptions)).readCentralPart(this.reader),
                                    this.files.push(e)
                            },
                            readEndOfCentral: function() {
                                var e = this.reader.lastIndexOfSignature(r.CENTRAL_DIRECTORY_END);
                                if (-1 === e)
                                    throw new Error("Corrupted zip : can't find end of central directory");
                                if (this.reader.setIndex(e), this.checkSignature(r.CENTRAL_DIRECTORY_END), this.readBlockEndOfCentral(), this.diskNumber === a.MAX_VALUE_16BITS || this.diskWithCentralDirStart === a.MAX_VALUE_16BITS || this.centralDirRecordsOnThisDisk === a.MAX_VALUE_16BITS || this.centralDirRecords === a.MAX_VALUE_16BITS || this.centralDirSize === a.MAX_VALUE_32BITS || this.centralDirOffset === a.MAX_VALUE_32BITS) {
                                    if (this.zip64 = !0, -1 === (e = this.reader.lastIndexOfSignature(r.ZIP64_CENTRAL_DIRECTORY_LOCATOR)))
                                        throw new Error("Corrupted zip : can't find the ZIP64 end of central directory locator");
                                    this.reader.setIndex(e),
                                    this.checkSignature(r.ZIP64_CENTRAL_DIRECTORY_LOCATOR),
                                    this.readBlockZip64EndOfCentralLocator(),
                                    this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),
                                    this.checkSignature(r.ZIP64_CENTRAL_DIRECTORY_END),
                                    this.readBlockZip64EndOfCentral()
                                }
                            },
                            prepareReader: function(e) {
                                var t = a.getTypeOf(e);
                                "string" !== t || c.uint8array ? this.reader = "nodebuffer" === t ? new n(e) : new s(a.transformTo("uint8array", e)) : this.reader = new o(e, this.loadOptions.optimizedBinaryString)
                            },
                            load: function(e) {
                                this.prepareReader(e),
                                this.readEndOfCentral(),
                                this.readCentralDir(),
                                this.readLocalFiles()
                            }
                        },
                        t.exports = h
                    }, {
                        "./nodeBufferReader": 22,
                        "./object": 11,
                        "./signature": 12,
                        "./stringReader": 13,
                        "./support": 15,
                        "./uint8ArrayReader": 16,
                        "./utils": 19,
                        "./zipEntry": 21
                    }],
                    21: [function(e, t, i) {
                        var o = e("./stringReader"),
                            n = e("./utils"),
                            s = e("./compressedObject"),
                            a = e("./object");
                        function r(e, t) {
                            this.options = e,
                            this.loadOptions = t
                        }
                        r.prototype = {
                            isEncrypted: function() {
                                return 1 == (1 & this.bitFlag)
                            },
                            useUTF8: function() {
                                return 2048 == (2048 & this.bitFlag)
                            },
                            prepareCompressedContent: function(e, t, i) {
                                return function() {
                                    var o = e.index;
                                    e.setIndex(t);
                                    var n = e.readData(i);
                                    return e.setIndex(o), n
                                }
                            },
                            prepareContent: function(e, t, i, o, s) {
                                return function() {
                                    var e = n.transformTo(o.uncompressInputType, this.getCompressedContent()),
                                        t = o.uncompress(e);
                                    if (t.length !== s)
                                        throw new Error("Bug : uncompressed data size mismatch");
                                    return t
                                }
                            },
                            readLocalPart: function(e) {
                                var t,
                                    i;
                                if (e.skip(22), this.fileNameLength = e.readInt(2), i = e.readInt(2), this.fileName = e.readString(this.fileNameLength), e.skip(i), -1 == this.compressedSize || -1 == this.uncompressedSize)
                                    throw new Error("Bug or corrupted zip : didn't get enough informations from the central directory (compressedSize == -1 || uncompressedSize == -1)");
                                if (null === (t = n.findCompression(this.compressionMethod)))
                                    throw new Error("Corrupted zip : compression " + n.pretty(this.compressionMethod) + " unknown (inner file : " + this.fileName + ")");
                                if (this.decompressed = new s, this.decompressed.compressedSize = this.compressedSize, this.decompressed.uncompressedSize = this.uncompressedSize, this.decompressed.crc32 = this.crc32, this.decompressed.compressionMethod = this.compressionMethod, this.decompressed.getCompressedContent = this.prepareCompressedContent(e, e.index, this.compressedSize, t), this.decompressed.getContent = this.prepareContent(e, e.index, this.compressedSize, t, this.uncompressedSize), this.loadOptions.checkCRC32 && (this.decompressed = n.transformTo("string", this.decompressed.getContent()), a.crc32(this.decompressed) !== this.crc32))
                                    throw new Error("Corrupted zip : CRC32 mismatch")
                            },
                            readCentralPart: function(e) {
                                if (this.versionMadeBy = e.readString(2), this.versionNeeded = e.readInt(2), this.bitFlag = e.readInt(2), this.compressionMethod = e.readString(2), this.date = e.readDate(), this.crc32 = e.readInt(4), this.compressedSize = e.readInt(4), this.uncompressedSize = e.readInt(4), this.fileNameLength = e.readInt(2), this.extraFieldsLength = e.readInt(2), this.fileCommentLength = e.readInt(2), this.diskNumberStart = e.readInt(2), this.internalFileAttributes = e.readInt(2), this.externalFileAttributes = e.readInt(4), this.localHeaderOffset = e.readInt(4), this.isEncrypted())
                                    throw new Error("Encrypted zip are not supported");
                                this.fileName = e.readString(this.fileNameLength),
                                this.readExtraFields(e),
                                this.parseZIP64ExtraField(e),
                                this.fileComment = e.readString(this.fileCommentLength),
                                this.dir = !!(16 & this.externalFileAttributes)
                            },
                            parseZIP64ExtraField: function(e) {
                                if (this.extraFields[1]) {
                                    var t = new o(this.extraFields[1].value);
                                    this.uncompressedSize === n.MAX_VALUE_32BITS && (this.uncompressedSize = t.readInt(8)),
                                    this.compressedSize === n.MAX_VALUE_32BITS && (this.compressedSize = t.readInt(8)),
                                    this.localHeaderOffset === n.MAX_VALUE_32BITS && (this.localHeaderOffset = t.readInt(8)),
                                    this.diskNumberStart === n.MAX_VALUE_32BITS && (this.diskNumberStart = t.readInt(4))
                                }
                            },
                            readExtraFields: function(e) {
                                var t,
                                    i,
                                    o,
                                    n = e.index;
                                for (this.extraFields = this.extraFields || {}; e.index < n + this.extraFieldsLength;)
                                    t = e.readInt(2),
                                    i = e.readInt(2),
                                    o = e.readString(i),
                                    this.extraFields[t] = {
                                        id: t,
                                        length: i,
                                        value: o
                                    }
                            },
                            handleUTF8: function() {
                                if (this.useUTF8())
                                    this.fileName = a.utf8decode(this.fileName),
                                    this.fileComment = a.utf8decode(this.fileComment);
                                else {
                                    var e = this.findExtraFieldUnicodePath();
                                    null !== e && (this.fileName = e);
                                    var t = this.findExtraFieldUnicodeComment();
                                    null !== t && (this.fileComment = t)
                                }
                            },
                            findExtraFieldUnicodePath: function() {
                                var e = this.extraFields[28789];
                                if (e) {
                                    var t = new o(e.value);
                                    return 1 !== t.readInt(1) || a.crc32(this.fileName) !== t.readInt(4) ? null : a.utf8decode(t.readString(e.length - 5))
                                }
                                return null
                            },
                            findExtraFieldUnicodeComment: function() {
                                var e = this.extraFields[25461];
                                if (e) {
                                    var t = new o(e.value);
                                    return 1 !== t.readInt(1) || a.crc32(this.fileComment) !== t.readInt(4) ? null : a.utf8decode(t.readString(e.length - 5))
                                }
                                return null
                            }
                        },
                        t.exports = r
                    }, {
                        "./compressedObject": 2,
                        "./object": 11,
                        "./stringReader": 13,
                        "./utils": 19
                    }],
                    22: [function(e, t, i) {}, {}],
                    23: [function(e, t, i) {
                        var o = t.exports = {};
                        function n() {}
                        o.nextTick = function() {
                            var e = "undefined" != typeof window && window.setImmediate,
                                t = "undefined" != typeof window && window.postMessage && window.addEventListener;
                            if (e)
                                return function(e) {
                                    return window.setImmediate(e)
                                };
                            if (t) {
                                var i = [];
                                return window.addEventListener("message", (function(e) {
                                    var t = e.source;
                                    t !== window && null !== t || "process-tick" !== e.data || (e.stopPropagation(), i.length > 0 && i.shift()())
                                }), !0), function(e) {
                                    i.push(e),
                                    window.postMessage("process-tick", "*")
                                }
                            }
                            return function(e) {
                                setTimeout(e, 0)
                            }
                        }(),
                        o.title = "browser",
                        o.browser = !0,
                        o.env = {},
                        o.argv = [],
                        o.on = n,
                        o.addListener = n,
                        o.once = n,
                        o.off = n,
                        o.removeListener = n,
                        o.removeAllListeners = n,
                        o.emit = n,
                        o.binding = function(e) {
                            throw new Error("process.binding is not supported")
                        },
                        o.cwd = function() {
                            return "/"
                        },
                        o.chdir = function(e) {
                            throw new Error("process.chdir is not supported")
                        }
                    }, {}],
                    24: [function(e, t, i) {
                        var o = {};
                        (0, e("./lib/utils/common").assign)(o, e("./lib/deflate"), e("./lib/inflate"), e("./lib/zlib/constants")),
                        t.exports = o
                    }, {
                        "./lib/deflate": 25,
                        "./lib/inflate": 26,
                        "./lib/utils/common": 27,
                        "./lib/zlib/constants": 30
                    }],
                    25: [function(e, t, i) {
                        var o = e("./zlib/deflate.js"),
                            n = e("./utils/common"),
                            s = e("./utils/strings"),
                            a = e("./zlib/messages"),
                            r = e("./zlib/zstream"),
                            l = function(e) {
                                this.options = n.assign({
                                    level: -1,
                                    method: 8,
                                    chunkSize: 16384,
                                    windowBits: 15,
                                    memLevel: 8,
                                    strategy: 0,
                                    to: ""
                                }, e || {});
                                var t = this.options;
                                t.raw && t.windowBits > 0 ? t.windowBits = -t.windowBits : t.gzip && t.windowBits > 0 && t.windowBits < 16 && (t.windowBits += 16),
                                this.err = 0,
                                this.msg = "",
                                this.ended = !1,
                                this.chunks = [],
                                this.strm = new r,
                                this.strm.avail_out = 0;
                                var i = o.deflateInit2(this.strm, t.level, t.method, t.windowBits, t.memLevel, t.strategy);
                                if (0 !== i)
                                    throw new Error(a[i]);
                                t.header && o.deflateSetHeader(this.strm, t.header)
                            };
                        function c(e, t) {
                            var i = new l(t);
                            if (i.push(e, !0), i.err)
                                throw i.msg;
                            return i.result
                        }
                        l.prototype.push = function(e, t) {
                            var i,
                                a,
                                r = this.strm,
                                l = this.options.chunkSize;
                            if (this.ended)
                                return !1;
                            a = t === ~~t ? t : !0 === t ? 4 : 0,
                            r.input = "string" == typeof e ? s.string2buf(e) : e,
                            r.next_in = 0,
                            r.avail_in = r.input.length;
                            do {
                                if (0 === r.avail_out && (r.output = new n.Buf8(l), r.next_out = 0, r.avail_out = l), 1 !== (i = o.deflate(r, a)) && 0 !== i)
                                    return this.onEnd(i), this.ended = !0, !1;
                                (0 === r.avail_out || 0 === r.avail_in && 4 === a) && ("string" === this.options.to ? this.onData(s.buf2binstring(n.shrinkBuf(r.output, r.next_out))) : this.onData(n.shrinkBuf(r.output, r.next_out)))
                            } while ((r.avail_in > 0 || 0 === r.avail_out) && 1 !== i);
                            return 4 !== a || (i = o.deflateEnd(this.strm), this.onEnd(i), this.ended = !0, 0 === i)
                        },
                        l.prototype.onData = function(e) {
                            this.chunks.push(e)
                        },
                        l.prototype.onEnd = function(e) {
                            0 === e && ("string" === this.options.to ? this.result = this.chunks.join("") : this.result = n.flattenChunks(this.chunks)),
                            this.chunks = [],
                            this.err = e,
                            this.msg = this.strm.msg
                        },
                        i.Deflate = l,
                        i.deflate = c,
                        i.deflateRaw = function(e, t) {
                            return (t = t || {}).raw = !0, c(e, t)
                        },
                        i.gzip = function(e, t) {
                            return (t = t || {}).gzip = !0, c(e, t)
                        }
                    }, {
                        "./utils/common": 27,
                        "./utils/strings": 28,
                        "./zlib/deflate.js": 32,
                        "./zlib/messages": 37,
                        "./zlib/zstream": 39
                    }],
                    26: [function(e, t, i) {
                        var o = e("./zlib/inflate.js"),
                            n = e("./utils/common"),
                            s = e("./utils/strings"),
                            a = e("./zlib/constants"),
                            r = e("./zlib/messages"),
                            l = e("./zlib/zstream"),
                            c = e("./zlib/gzheader"),
                            d = function(e) {
                                this.options = n.assign({
                                    chunkSize: 16384,
                                    windowBits: 0,
                                    to: ""
                                }, e || {});
                                var t = this.options;
                                t.raw && t.windowBits >= 0 && t.windowBits < 16 && (t.windowBits = -t.windowBits, 0 === t.windowBits && (t.windowBits = -15)),
                                !(t.windowBits >= 0 && t.windowBits < 16) || e && e.windowBits || (t.windowBits += 32),
                                t.windowBits > 15 && t.windowBits < 48 && 0 == (15 & t.windowBits) && (t.windowBits |= 15),
                                this.err = 0,
                                this.msg = "",
                                this.ended = !1,
                                this.chunks = [],
                                this.strm = new l,
                                this.strm.avail_out = 0;
                                var i = o.inflateInit2(this.strm, t.windowBits);
                                if (i !== a.Z_OK)
                                    throw new Error(r[i]);
                                this.header = new c,
                                o.inflateGetHeader(this.strm, this.header)
                            };
                        function h(e, t) {
                            var i = new d(t);
                            if (i.push(e, !0), i.err)
                                throw i.msg;
                            return i.result
                        }
                        d.prototype.push = function(e, t) {
                            var i,
                                r,
                                l,
                                c,
                                d,
                                h = this.strm,
                                p = this.options.chunkSize;
                            if (this.ended)
                                return !1;
                            r = t === ~~t ? t : !0 === t ? a.Z_FINISH : a.Z_NO_FLUSH,
                            h.input = "string" == typeof e ? s.binstring2buf(e) : e,
                            h.next_in = 0,
                            h.avail_in = h.input.length;
                            do {
                                if (0 === h.avail_out && (h.output = new n.Buf8(p), h.next_out = 0, h.avail_out = p), (i = o.inflate(h, a.Z_NO_FLUSH)) !== a.Z_STREAM_END && i !== a.Z_OK)
                                    return this.onEnd(i), this.ended = !0, !1;
                                h.next_out && (0 === h.avail_out || i === a.Z_STREAM_END || 0 === h.avail_in && r === a.Z_FINISH) && ("string" === this.options.to ? (l = s.utf8border(h.output, h.next_out), c = h.next_out - l, d = s.buf2string(h.output, l), h.next_out = c, h.avail_out = p - c, c && n.arraySet(h.output, h.output, l, c, 0), this.onData(d)) : this.onData(n.shrinkBuf(h.output, h.next_out)))
                            } while ((h.avail_in > 0 || 0 === h.avail_out) && i !== a.Z_STREAM_END);
                            return i === a.Z_STREAM_END && (r = a.Z_FINISH), r !== a.Z_FINISH || (i = o.inflateEnd(this.strm), this.onEnd(i), this.ended = !0, i === a.Z_OK)
                        },
                        d.prototype.onData = function(e) {
                            this.chunks.push(e)
                        },
                        d.prototype.onEnd = function(e) {
                            e === a.Z_OK && ("string" === this.options.to ? this.result = this.chunks.join("") : this.result = n.flattenChunks(this.chunks)),
                            this.chunks = [],
                            this.err = e,
                            this.msg = this.strm.msg
                        },
                        i.Inflate = d,
                        i.inflate = h,
                        i.inflateRaw = function(e, t) {
                            return (t = t || {}).raw = !0, h(e, t)
                        },
                        i.ungzip = h
                    }, {
                        "./utils/common": 27,
                        "./utils/strings": 28,
                        "./zlib/constants": 30,
                        "./zlib/gzheader": 33,
                        "./zlib/inflate.js": 35,
                        "./zlib/messages": 37,
                        "./zlib/zstream": 39
                    }],
                    27: [function(e, t, i) {
                        var o = "undefined" != typeof Uint8Array && "undefined" != typeof Uint16Array && "undefined" != typeof Int32Array;
                        i.assign = function(e) {
                            for (var t = Array.prototype.slice.call(arguments, 1); t.length;) {
                                var i = t.shift();
                                if (i) {
                                    if ("object" != typeof i)
                                        throw new TypeError(i + "must be non-object");
                                    for (var o in i)
                                        i.hasOwnProperty(o) && (e[o] = i[o])
                                }
                            }
                            return e
                        },
                        i.shrinkBuf = function(e, t) {
                            return e.length === t ? e : e.subarray ? e.subarray(0, t) : (e.length = t, e)
                        };
                        var n = {
                                arraySet: function(e, t, i, o, n) {
                                    if (t.subarray && e.subarray)
                                        e.set(t.subarray(i, i + o), n);
                                    else
                                        for (var s = 0; s < o; s++)
                                            e[n + s] = t[i + s]
                                },
                                flattenChunks: function(e) {
                                    var t,
                                        i,
                                        o,
                                        n,
                                        s,
                                        a;
                                    for (o = 0, t = 0, i = e.length; t < i; t++)
                                        o += e[t].length;
                                    for (a = new Uint8Array(o), n = 0, t = 0, i = e.length; t < i; t++)
                                        s = e[t],
                                        a.set(s, n),
                                        n += s.length;
                                    return a
                                }
                            },
                            s = {
                                arraySet: function(e, t, i, o, n) {
                                    for (var s = 0; s < o; s++)
                                        e[n + s] = t[i + s]
                                },
                                flattenChunks: function(e) {
                                    return [].concat.apply([], e)
                                }
                            };
                        i.setTyped = function(e) {
                            e ? (i.Buf8 = Uint8Array, i.Buf16 = Uint16Array, i.Buf32 = Int32Array, i.assign(i, n)) : (i.Buf8 = Array, i.Buf16 = Array, i.Buf32 = Array, i.assign(i, s))
                        },
                        i.setTyped(o)
                    }, {}],
                    28: [function(e, t, i) {
                        var o = e("./common"),
                            n = !0,
                            s = !0;
                        try {
                            String.fromCharCode.apply(null, [0])
                        } catch (e) {
                            n = !1
                        }
                        try {
                            String.fromCharCode.apply(null, new Uint8Array(1))
                        } catch (e) {
                            s = !1
                        }
                        for (var a = new o.Buf8(256), r = 0; r < 256; r++)
                            a[r] = r >= 252 ? 6 : r >= 248 ? 5 : r >= 240 ? 4 : r >= 224 ? 3 : r >= 192 ? 2 : 1;
                        function l(e, t) {
                            if (t < 65537 && (e.subarray && s || !e.subarray && n))
                                return String.fromCharCode.apply(null, o.shrinkBuf(e, t));
                            for (var i = "", a = 0; a < t; a++)
                                i += String.fromCharCode(e[a]);
                            return i
                        }
                        a[254] = a[254] = 1,
                        i.string2buf = function(e) {
                            var t,
                                i,
                                n,
                                s,
                                a,
                                r = e.length,
                                l = 0;
                            for (s = 0; s < r; s++)
                                55296 == (64512 & (i = e.charCodeAt(s))) && s + 1 < r && 56320 == (64512 & (n = e.charCodeAt(s + 1))) && (i = 65536 + (i - 55296 << 10) + (n - 56320), s++),
                                l += i < 128 ? 1 : i < 2048 ? 2 : i < 65536 ? 3 : 4;
                            for (t = new o.Buf8(l), a = 0, s = 0; a < l; s++)
                                55296 == (64512 & (i = e.charCodeAt(s))) && s + 1 < r && 56320 == (64512 & (n = e.charCodeAt(s + 1))) && (i = 65536 + (i - 55296 << 10) + (n - 56320), s++),
                                i < 128 ? t[a++] = i : i < 2048 ? (t[a++] = 192 | i >>> 6, t[a++] = 128 | 63 & i) : i < 65536 ? (t[a++] = 224 | i >>> 12, t[a++] = 128 | i >>> 6 & 63, t[a++] = 128 | 63 & i) : (t[a++] = 240 | i >>> 18, t[a++] = 128 | i >>> 12 & 63, t[a++] = 128 | i >>> 6 & 63, t[a++] = 128 | 63 & i);
                            return t
                        },
                        i.buf2binstring = function(e) {
                            return l(e, e.length)
                        },
                        i.binstring2buf = function(e) {
                            for (var t = new o.Buf8(e.length), i = 0, n = t.length; i < n; i++)
                                t[i] = e.charCodeAt(i);
                            return t
                        },
                        i.buf2string = function(e, t) {
                            var i,
                                o,
                                n,
                                s,
                                r = t || e.length,
                                c = new Array(2 * r);
                            for (o = 0, i = 0; i < r;)
                                if ((n = e[i++]) < 128)
                                    c[o++] = n;
                                else if ((s = a[n]) > 4)
                                    c[o++] = 65533,
                                    i += s - 1;
                                else {
                                    for (n &= 2 === s ? 31 : 3 === s ? 15 : 7; s > 1 && i < r;)
                                        n = n << 6 | 63 & e[i++],
                                        s--;
                                    s > 1 ? c[o++] = 65533 : n < 65536 ? c[o++] = n : (n -= 65536, c[o++] = 55296 | n >> 10 & 1023, c[o++] = 56320 | 1023 & n)
                                }
                            return l(c, o)
                        },
                        i.utf8border = function(e, t) {
                            var i;
                            for ((t = t || e.length) > e.length && (t = e.length), i = t - 1; i >= 0 && 128 == (192 & e[i]);)
                                i--;
                            return i < 0 || 0 === i ? t : i + a[e[i]] > t ? i : t
                        }
                    }, {
                        "./common": 27
                    }],
                    29: [function(e, t, i) {
                        t.exports = function(e, t, i, o) {
                            for (var n = 65535 & e | 0, s = e >>> 16 & 65535 | 0, a = 0; 0 !== i;) {
                                i -= a = i > 2e3 ? 2e3 : i;
                                do {
                                    s = s + (n = n + t[o++] | 0) | 0
                                } while (--a);
                                n %= 65521,
                                s %= 65521
                            }
                            return n | s << 16 | 0
                        }
                    }, {}],
                    30: [function(e, t, i) {
                        t.exports = {
                            Z_NO_FLUSH: 0,
                            Z_PARTIAL_FLUSH: 1,
                            Z_SYNC_FLUSH: 2,
                            Z_FULL_FLUSH: 3,
                            Z_FINISH: 4,
                            Z_BLOCK: 5,
                            Z_TREES: 6,
                            Z_OK: 0,
                            Z_STREAM_END: 1,
                            Z_NEED_DICT: 2,
                            Z_ERRNO: -1,
                            Z_STREAM_ERROR: -2,
                            Z_DATA_ERROR: -3,
                            Z_BUF_ERROR: -5,
                            Z_NO_COMPRESSION: 0,
                            Z_BEST_SPEED: 1,
                            Z_BEST_COMPRESSION: 9,
                            Z_DEFAULT_COMPRESSION: -1,
                            Z_FILTERED: 1,
                            Z_HUFFMAN_ONLY: 2,
                            Z_RLE: 3,
                            Z_FIXED: 4,
                            Z_DEFAULT_STRATEGY: 0,
                            Z_BINARY: 0,
                            Z_TEXT: 1,
                            Z_UNKNOWN: 2,
                            Z_DEFLATED: 8
                        }
                    }, {}],
                    31: [function(e, t, i) {
                        var o = function() {
                            for (var e, t = [], i = 0; i < 256; i++) {
                                e = i;
                                for (var o = 0; o < 8; o++)
                                    e = 1 & e ? 3988292384 ^ e >>> 1 : e >>> 1;
                                t[i] = e
                            }
                            return t
                        }();
                        t.exports = function(e, t, i, n) {
                            var s = o,
                                a = n + i;
                            e ^= -1;
                            for (var r = n; r < a; r++)
                                e = e >>> 8 ^ s[255 & (e ^ t[r])];
                            return -1 ^ e
                        }
                    }, {}],
                    32: [function(e, t, i) {
                        var o = e("../utils/common"),
                            n = e("./trees"),
                            s = e("./adler32"),
                            a = e("./crc32"),
                            r = e("./messages");
                        function l(e, t) {
                            return e.msg = r[t], t
                        }
                        function c(e) {
                            return (e << 1) - (e > 4 ? 9 : 0)
                        }
                        function d(e) {
                            for (var t = e.length; --t >= 0;)
                                e[t] = 0
                        }
                        function h(e) {
                            var t = e.state,
                                i = t.pending;
                            i > e.avail_out && (i = e.avail_out),
                            0 !== i && (o.arraySet(e.output, t.pending_buf, t.pending_out, i, e.next_out), e.next_out += i, t.pending_out += i, e.total_out += i, e.avail_out -= i, t.pending -= i, 0 === t.pending && (t.pending_out = 0))
                        }
                        function p(e, t) {
                            n._tr_flush_block(e, e.block_start >= 0 ? e.block_start : -1, e.strstart - e.block_start, t),
                            e.block_start = e.strstart,
                            h(e.strm)
                        }
                        function u(e, t) {
                            e.pending_buf[e.pending++] = t
                        }
                        function f(e, t) {
                            e.pending_buf[e.pending++] = t >>> 8 & 255,
                            e.pending_buf[e.pending++] = 255 & t
                        }
                        function m(e, t) {
                            var i,
                                o,
                                n = e.max_chain_length,
                                s = e.strstart,
                                a = e.prev_length,
                                r = e.nice_match,
                                l = e.strstart > e.w_size - 262 ? e.strstart - (e.w_size - 262) : 0,
                                c = e.window,
                                d = e.w_mask,
                                h = e.prev,
                                p = e.strstart + 258,
                                u = c[s + a - 1],
                                f = c[s + a];
                            e.prev_length >= e.good_match && (n >>= 2),
                            r > e.lookahead && (r = e.lookahead);
                            do {
                                if (c[(i = t) + a] === f && c[i + a - 1] === u && c[i] === c[s] && c[++i] === c[s + 1]) {
                                    s += 2,
                                    i++;
                                    do {} while (c[++s] === c[++i] && c[++s] === c[++i] && c[++s] === c[++i] && c[++s] === c[++i] && c[++s] === c[++i] && c[++s] === c[++i] && c[++s] === c[++i] && c[++s] === c[++i] && s < p);
                                    if (o = 258 - (p - s), s = p - 258, o > a) {
                                        if (e.match_start = t, a = o, o >= r)
                                            break;
                                        u = c[s + a - 1],
                                        f = c[s + a]
                                    }
                                }
                            } while ((t = h[t & d]) > l && 0 != --n);
                            return a <= e.lookahead ? a : e.lookahead
                        }
                        function g(e) {
                            var t,
                                i,
                                n,
                                r,
                                l,
                                c,
                                d,
                                h,
                                p,
                                u,
                                f = e.w_size;
                            do {
                                if (r = e.window_size - e.lookahead - e.strstart, e.strstart >= f + (f - 262)) {
                                    o.arraySet(e.window, e.window, f, f, 0),
                                    e.match_start -= f,
                                    e.strstart -= f,
                                    e.block_start -= f,
                                    t = i = e.hash_size;
                                    do {
                                        n = e.head[--t],
                                        e.head[t] = n >= f ? n - f : 0
                                    } while (--i);
                                    t = i = f;
                                    do {
                                        n = e.prev[--t],
                                        e.prev[t] = n >= f ? n - f : 0
                                    } while (--i);
                                    r += f
                                }
                                if (0 === e.strm.avail_in)
                                    break;
                                if (c = e.strm, d = e.window, h = e.strstart + e.lookahead, p = r, u = void 0, (u = c.avail_in) > p && (u = p), i = 0 === u ? 0 : (c.avail_in -= u, o.arraySet(d, c.input, c.next_in, u, h), 1 === c.state.wrap ? c.adler = s(c.adler, d, u, h) : 2 === c.state.wrap && (c.adler = a(c.adler, d, u, h)), c.next_in += u, c.total_in += u, u), e.lookahead += i, e.lookahead + e.insert >= 3)
                                    for (l = e.strstart - e.insert, e.ins_h = e.window[l], e.ins_h = (e.ins_h << e.hash_shift ^ e.window[l + 1]) & e.hash_mask; e.insert && (e.ins_h = (e.ins_h << e.hash_shift ^ e.window[l + 3 - 1]) & e.hash_mask, e.prev[l & e.w_mask] = e.head[e.ins_h], e.head[e.ins_h] = l, l++, e.insert--, !(e.lookahead + e.insert < 3));)
                                        ;
                            } while (e.lookahead < 262 && 0 !== e.strm.avail_in)
                        }
                        function v(e, t) {
                            for (var i, o;;) {
                                if (e.lookahead < 262) {
                                    if (g(e), e.lookahead < 262 && 0 === t)
                                        return 1;
                                    if (0 === e.lookahead)
                                        break
                                }
                                if (i = 0, e.lookahead >= 3 && (e.ins_h = (e.ins_h << e.hash_shift ^ e.window[e.strstart + 3 - 1]) & e.hash_mask, i = e.prev[e.strstart & e.w_mask] = e.head[e.ins_h], e.head[e.ins_h] = e.strstart), 0 !== i && e.strstart - i <= e.w_size - 262 && (e.match_length = m(e, i)), e.match_length >= 3)
                                    if (o = n._tr_tally(e, e.strstart - e.match_start, e.match_length - 3), e.lookahead -= e.match_length, e.match_length <= e.max_lazy_match && e.lookahead >= 3) {
                                        e.match_length--;
                                        do {
                                            e.strstart++,
                                            e.ins_h = (e.ins_h << e.hash_shift ^ e.window[e.strstart + 3 - 1]) & e.hash_mask,
                                            i = e.prev[e.strstart & e.w_mask] = e.head[e.ins_h],
                                            e.head[e.ins_h] = e.strstart
                                        } while (0 != --e.match_length);
                                        e.strstart++
                                    } else
                                        e.strstart += e.match_length,
                                        e.match_length = 0,
                                        e.ins_h = e.window[e.strstart],
                                        e.ins_h = (e.ins_h << e.hash_shift ^ e.window[e.strstart + 1]) & e.hash_mask;
                                else
                                    o = n._tr_tally(e, 0, e.window[e.strstart]),
                                    e.lookahead--,
                                    e.strstart++;
                                if (o && (p(e, !1), 0 === e.strm.avail_out))
                                    return 1
                            }
                            return e.insert = e.strstart < 2 ? e.strstart : 2, 4 === t ? (p(e, !0), 0 === e.strm.avail_out ? 3 : 4) : e.last_lit && (p(e, !1), 0 === e.strm.avail_out) ? 1 : 2
                        }
                        function b(e, t) {
                            for (var i, o, s;;) {
                                if (e.lookahead < 262) {
                                    if (g(e), e.lookahead < 262 && 0 === t)
                                        return 1;
                                    if (0 === e.lookahead)
                                        break
                                }
                                if (i = 0, e.lookahead >= 3 && (e.ins_h = (e.ins_h << e.hash_shift ^ e.window[e.strstart + 3 - 1]) & e.hash_mask, i = e.prev[e.strstart & e.w_mask] = e.head[e.ins_h], e.head[e.ins_h] = e.strstart), e.prev_length = e.match_length, e.prev_match = e.match_start, e.match_length = 2, 0 !== i && e.prev_length < e.max_lazy_match && e.strstart - i <= e.w_size - 262 && (e.match_length = m(e, i), e.match_length <= 5 && (1 === e.strategy || 3 === e.match_length && e.strstart - e.match_start > 4096) && (e.match_length = 2)), e.prev_length >= 3 && e.match_length <= e.prev_length) {
                                    s = e.strstart + e.lookahead - 3,
                                    o = n._tr_tally(e, e.strstart - 1 - e.prev_match, e.prev_length - 3),
                                    e.lookahead -= e.prev_length - 1,
                                    e.prev_length -= 2;
                                    do {
                                        ++e.strstart <= s && (e.ins_h = (e.ins_h << e.hash_shift ^ e.window[e.strstart + 3 - 1]) & e.hash_mask, i = e.prev[e.strstart & e.w_mask] = e.head[e.ins_h], e.head[e.ins_h] = e.strstart)
                                    } while (0 != --e.prev_length);
                                    if (e.match_available = 0, e.match_length = 2, e.strstart++, o && (p(e, !1), 0 === e.strm.avail_out))
                                        return 1
                                } else if (e.match_available) {
                                    if ((o = n._tr_tally(e, 0, e.window[e.strstart - 1])) && p(e, !1), e.strstart++, e.lookahead--, 0 === e.strm.avail_out)
                                        return 1
                                } else
                                    e.match_available = 1,
                                    e.strstart++,
                                    e.lookahead--
                            }
                            return e.match_available && (o = n._tr_tally(e, 0, e.window[e.strstart - 1]), e.match_available = 0), e.insert = e.strstart < 2 ? e.strstart : 2, 4 === t ? (p(e, !0), 0 === e.strm.avail_out ? 3 : 4) : e.last_lit && (p(e, !1), 0 === e.strm.avail_out) ? 1 : 2
                        }
                        var y,
                            w = function(e, t, i, o, n) {
                                this.good_length = e,
                                this.max_lazy = t,
                                this.nice_length = i,
                                this.max_chain = o,
                                this.func = n
                            };
                        function x() {
                            this.strm = null,
                            this.status = 0,
                            this.pending_buf = null,
                            this.pending_buf_size = 0,
                            this.pending_out = 0,
                            this.pending = 0,
                            this.wrap = 0,
                            this.gzhead = null,
                            this.gzindex = 0,
                            this.method = 8,
                            this.last_flush = -1,
                            this.w_size = 0,
                            this.w_bits = 0,
                            this.w_mask = 0,
                            this.window = null,
                            this.window_size = 0,
                            this.prev = null,
                            this.head = null,
                            this.ins_h = 0,
                            this.hash_size = 0,
                            this.hash_bits = 0,
                            this.hash_mask = 0,
                            this.hash_shift = 0,
                            this.block_start = 0,
                            this.match_length = 0,
                            this.prev_match = 0,
                            this.match_available = 0,
                            this.strstart = 0,
                            this.match_start = 0,
                            this.lookahead = 0,
                            this.prev_length = 0,
                            this.max_chain_length = 0,
                            this.max_lazy_match = 0,
                            this.level = 0,
                            this.strategy = 0,
                            this.good_match = 0,
                            this.nice_match = 0,
                            this.dyn_ltree = new o.Buf16(1146),
                            this.dyn_dtree = new o.Buf16(122),
                            this.bl_tree = new o.Buf16(78),
                            d(this.dyn_ltree),
                            d(this.dyn_dtree),
                            d(this.bl_tree),
                            this.l_desc = null,
                            this.d_desc = null,
                            this.bl_desc = null,
                            this.bl_count = new o.Buf16(16),
                            this.heap = new o.Buf16(573),
                            d(this.heap),
                            this.heap_len = 0,
                            this.heap_max = 0,
                            this.depth = new o.Buf16(573),
                            d(this.depth),
                            this.l_buf = 0,
                            this.lit_bufsize = 0,
                            this.last_lit = 0,
                            this.d_buf = 0,
                            this.opt_len = 0,
                            this.static_len = 0,
                            this.matches = 0,
                            this.insert = 0,
                            this.bi_buf = 0,
                            this.bi_valid = 0
                        }
                        function T(e) {
                            var t;
                            return e && e.state ? (e.total_in = e.total_out = 0, e.data_type = 2, (t = e.state).pending = 0, t.pending_out = 0, t.wrap < 0 && (t.wrap = -t.wrap), t.status = t.wrap ? 42 : 113, e.adler = 2 === t.wrap ? 0 : 1, t.last_flush = 0, n._tr_init(t), 0) : l(e, -2)
                        }
                        function $(e) {
                            var t,
                                i = T(e);
                            return 0 === i && ((t = e.state).window_size = 2 * t.w_size, d(t.head), t.max_lazy_match = y[t.level].max_lazy, t.good_match = y[t.level].good_length, t.nice_match = y[t.level].nice_length, t.max_chain_length = y[t.level].max_chain, t.strstart = 0, t.block_start = 0, t.lookahead = 0, t.insert = 0, t.match_length = t.prev_length = 2, t.match_available = 0, t.ins_h = 0), i
                        }
                        function C(e, t, i, n, s, a) {
                            if (!e)
                                return -2;
                            var r = 1;
                            if (-1 === t && (t = 6), n < 0 ? (r = 0, n = -n) : n > 15 && (r = 2, n -= 16), s < 1 || s > 9 || 8 !== i || n < 8 || n > 15 || t < 0 || t > 9 || a < 0 || a > 4)
                                return l(e, -2);
                            8 === n && (n = 9);
                            var c = new x;
                            return e.state = c, c.strm = e, c.wrap = r, c.gzhead = null, c.w_bits = n, c.w_size = 1 << c.w_bits, c.w_mask = c.w_size - 1, c.hash_bits = s + 7, c.hash_size = 1 << c.hash_bits, c.hash_mask = c.hash_size - 1, c.hash_shift = ~~((c.hash_bits + 3 - 1) / 3), c.window = new o.Buf8(2 * c.w_size), c.head = new o.Buf16(c.hash_size), c.prev = new o.Buf16(c.w_size), c.lit_bufsize = 1 << s + 6, c.pending_buf_size = 4 * c.lit_bufsize, c.pending_buf = new o.Buf8(c.pending_buf_size), c.d_buf = c.lit_bufsize >> 1, c.l_buf = 3 * c.lit_bufsize, c.level = t, c.strategy = a, c.method = i, $(e)
                        }
                        y = [new w(0, 0, 0, 0, (function(e, t) {
                            var i = 65535;
                            for (i > e.pending_buf_size - 5 && (i = e.pending_buf_size - 5);;) {
                                if (e.lookahead <= 1) {
                                    if (g(e), 0 === e.lookahead && 0 === t)
                                        return 1;
                                    if (0 === e.lookahead)
                                        break
                                }
                                e.strstart += e.lookahead,
                                e.lookahead = 0;
                                var o = e.block_start + i;
                                if ((0 === e.strstart || e.strstart >= o) && (e.lookahead = e.strstart - o, e.strstart = o, p(e, !1), 0 === e.strm.avail_out))
                                    return 1;
                                if (e.strstart - e.block_start >= e.w_size - 262 && (p(e, !1), 0 === e.strm.avail_out))
                                    return 1
                            }
                            return e.insert = 0, 4 === t ? (p(e, !0), 0 === e.strm.avail_out ? 3 : 4) : (e.strstart > e.block_start && (p(e, !1), e.strm.avail_out), 1)
                        })), new w(4, 4, 8, 4, v), new w(4, 5, 16, 8, v), new w(4, 6, 32, 32, v), new w(4, 4, 16, 16, b), new w(8, 16, 32, 32, b), new w(8, 16, 128, 128, b), new w(8, 32, 128, 256, b), new w(32, 128, 258, 1024, b), new w(32, 258, 258, 4096, b)],
                        i.deflateInit = function(e, t) {
                            return C(e, t, 8, 15, 8, 0)
                        },
                        i.deflateInit2 = C,
                        i.deflateReset = $,
                        i.deflateResetKeep = T,
                        i.deflateSetHeader = function(e, t) {
                            return e && e.state ? 2 !== e.state.wrap ? -2 : (e.state.gzhead = t, 0) : -2
                        },
                        i.deflate = function(e, t) {
                            var i,
                                o,
                                s,
                                r;
                            if (!e || !e.state || t > 5 || t < 0)
                                return e ? l(e, -2) : -2;
                            if (o = e.state, !e.output || !e.input && 0 !== e.avail_in || 666 === o.status && 4 !== t)
                                return l(e, 0 === e.avail_out ? -5 : -2);
                            if (o.strm = e, i = o.last_flush, o.last_flush = t, 42 === o.status)
                                if (2 === o.wrap)
                                    e.adler = 0,
                                    u(o, 31),
                                    u(o, 139),
                                    u(o, 8),
                                    o.gzhead ? (u(o, (o.gzhead.text ? 1 : 0) + (o.gzhead.hcrc ? 2 : 0) + (o.gzhead.extra ? 4 : 0) + (o.gzhead.name ? 8 : 0) + (o.gzhead.comment ? 16 : 0)), u(o, 255 & o.gzhead.time), u(o, o.gzhead.time >> 8 & 255), u(o, o.gzhead.time >> 16 & 255), u(o, o.gzhead.time >> 24 & 255), u(o, 9 === o.level ? 2 : o.strategy >= 2 || o.level < 2 ? 4 : 0), u(o, 255 & o.gzhead.os), o.gzhead.extra && o.gzhead.extra.length && (u(o, 255 & o.gzhead.extra.length), u(o, o.gzhead.extra.length >> 8 & 255)), o.gzhead.hcrc && (e.adler = a(e.adler, o.pending_buf, o.pending, 0)), o.gzindex = 0, o.status = 69) : (u(o, 0), u(o, 0), u(o, 0), u(o, 0), u(o, 0), u(o, 9 === o.level ? 2 : o.strategy >= 2 || o.level < 2 ? 4 : 0), u(o, 3), o.status = 113);
                                else {
                                    var m = 8 + (o.w_bits - 8 << 4) << 8;
                                    m |= (o.strategy >= 2 || o.level < 2 ? 0 : o.level < 6 ? 1 : 6 === o.level ? 2 : 3) << 6,
                                    0 !== o.strstart && (m |= 32),
                                    m += 31 - m % 31,
                                    o.status = 113,
                                    f(o, m),
                                    0 !== o.strstart && (f(o, e.adler >>> 16), f(o, 65535 & e.adler)),
                                    e.adler = 1
                                }
                            if (69 === o.status)
                                if (o.gzhead.extra) {
                                    for (s = o.pending; o.gzindex < (65535 & o.gzhead.extra.length) && (o.pending !== o.pending_buf_size || (o.gzhead.hcrc && o.pending > s && (e.adler = a(e.adler, o.pending_buf, o.pending - s, s)), h(e), s = o.pending, o.pending !== o.pending_buf_size));)
                                        u(o, 255 & o.gzhead.extra[o.gzindex]),
                                        o.gzindex++;
                                    o.gzhead.hcrc && o.pending > s && (e.adler = a(e.adler, o.pending_buf, o.pending - s, s)),
                                    o.gzindex === o.gzhead.extra.length && (o.gzindex = 0, o.status = 73)
                                } else
                                    o.status = 73;
                            if (73 === o.status)
                                if (o.gzhead.name) {
                                    s = o.pending;
                                    do {
                                        if (o.pending === o.pending_buf_size && (o.gzhead.hcrc && o.pending > s && (e.adler = a(e.adler, o.pending_buf, o.pending - s, s)), h(e), s = o.pending, o.pending === o.pending_buf_size)) {
                                            r = 1;
                                            break
                                        }
                                        r = o.gzindex < o.gzhead.name.length ? 255 & o.gzhead.name.charCodeAt(o.gzindex++) : 0,
                                        u(o, r)
                                    } while (0 !== r);
                                    o.gzhead.hcrc && o.pending > s && (e.adler = a(e.adler, o.pending_buf, o.pending - s, s)),
                                    0 === r && (o.gzindex = 0, o.status = 91)
                                } else
                                    o.status = 91;
                            if (91 === o.status)
                                if (o.gzhead.comment) {
                                    s = o.pending;
                                    do {
                                        if (o.pending === o.pending_buf_size && (o.gzhead.hcrc && o.pending > s && (e.adler = a(e.adler, o.pending_buf, o.pending - s, s)), h(e), s = o.pending, o.pending === o.pending_buf_size)) {
                                            r = 1;
                                            break
                                        }
                                        r = o.gzindex < o.gzhead.comment.length ? 255 & o.gzhead.comment.charCodeAt(o.gzindex++) : 0,
                                        u(o, r)
                                    } while (0 !== r);
                                    o.gzhead.hcrc && o.pending > s && (e.adler = a(e.adler, o.pending_buf, o.pending - s, s)),
                                    0 === r && (o.status = 103)
                                } else
                                    o.status = 103;
                            if (103 === o.status && (o.gzhead.hcrc ? (o.pending + 2 > o.pending_buf_size && h(e), o.pending + 2 <= o.pending_buf_size && (u(o, 255 & e.adler), u(o, e.adler >> 8 & 255), e.adler = 0, o.status = 113)) : o.status = 113), 0 !== o.pending) {
                                if (h(e), 0 === e.avail_out)
                                    return o.last_flush = -1, 0
                            } else if (0 === e.avail_in && c(t) <= c(i) && 4 !== t)
                                return l(e, -5);
                            if (666 === o.status && 0 !== e.avail_in)
                                return l(e, -5);
                            if (0 !== e.avail_in || 0 !== o.lookahead || 0 !== t && 666 !== o.status) {
                                var v = 2 === o.strategy ? function(e, t) {
                                    for (var i;;) {
                                        if (0 === e.lookahead && (g(e), 0 === e.lookahead)) {
                                            if (0 === t)
                                                return 1;
                                            break
                                        }
                                        if (e.match_length = 0, i = n._tr_tally(e, 0, e.window[e.strstart]), e.lookahead--, e.strstart++, i && (p(e, !1), 0 === e.strm.avail_out))
                                            return 1
                                    }
                                    return e.insert = 0, 4 === t ? (p(e, !0), 0 === e.strm.avail_out ? 3 : 4) : e.last_lit && (p(e, !1), 0 === e.strm.avail_out) ? 1 : 2
                                }(o, t) : 3 === o.strategy ? function(e, t) {
                                    for (var i, o, s, a, r = e.window;;) {
                                        if (e.lookahead <= 258) {
                                            if (g(e), e.lookahead <= 258 && 0 === t)
                                                return 1;
                                            if (0 === e.lookahead)
                                                break
                                        }
                                        if (e.match_length = 0, e.lookahead >= 3 && e.strstart > 0 && (o = r[s = e.strstart - 1]) === r[++s] && o === r[++s] && o === r[++s]) {
                                            a = e.strstart + 258;
                                            do {} while (o === r[++s] && o === r[++s] && o === r[++s] && o === r[++s] && o === r[++s] && o === r[++s] && o === r[++s] && o === r[++s] && s < a);
                                            e.match_length = 258 - (a - s),
                                            e.match_length > e.lookahead && (e.match_length = e.lookahead)
                                        }
                                        if (e.match_length >= 3 ? (i = n._tr_tally(e, 1, e.match_length - 3), e.lookahead -= e.match_length, e.strstart += e.match_length, e.match_length = 0) : (i = n._tr_tally(e, 0, e.window[e.strstart]), e.lookahead--, e.strstart++), i && (p(e, !1), 0 === e.strm.avail_out))
                                            return 1
                                    }
                                    return e.insert = 0, 4 === t ? (p(e, !0), 0 === e.strm.avail_out ? 3 : 4) : e.last_lit && (p(e, !1), 0 === e.strm.avail_out) ? 1 : 2
                                }(o, t) : y[o.level].func(o, t);
                                if (3 !== v && 4 !== v || (o.status = 666), 1 === v || 3 === v)
                                    return 0 === e.avail_out && (o.last_flush = -1), 0;
                                if (2 === v && (1 === t ? n._tr_align(o) : 5 !== t && (n._tr_stored_block(o, 0, 0, !1), 3 === t && (d(o.head), 0 === o.lookahead && (o.strstart = 0, o.block_start = 0, o.insert = 0))), h(e), 0 === e.avail_out))
                                    return o.last_flush = -1, 0
                            }
                            return 4 !== t ? 0 : o.wrap <= 0 ? 1 : (2 === o.wrap ? (u(o, 255 & e.adler), u(o, e.adler >> 8 & 255), u(o, e.adler >> 16 & 255), u(o, e.adler >> 24 & 255), u(o, 255 & e.total_in), u(o, e.total_in >> 8 & 255), u(o, e.total_in >> 16 & 255), u(o, e.total_in >> 24 & 255)) : (f(o, e.adler >>> 16), f(o, 65535 & e.adler)), h(e), o.wrap > 0 && (o.wrap = -o.wrap), 0 !== o.pending ? 0 : 1)
                        },
                        i.deflateEnd = function(e) {
                            var t;
                            return e && e.state ? 42 !== (t = e.state.status) && 69 !== t && 73 !== t && 91 !== t && 103 !== t && 113 !== t && 666 !== t ? l(e, -2) : (e.state = null, 113 === t ? l(e, -3) : 0) : -2
                        },
                        i.deflateInfo = "pako deflate (from Nodeca project)"
                    }, {
                        "../utils/common": 27,
                        "./adler32": 29,
                        "./crc32": 31,
                        "./messages": 37,
                        "./trees": 38
                    }],
                    33: [function(e, t, i) {
                        t.exports = function() {
                            this.text = 0,
                            this.time = 0,
                            this.xflags = 0,
                            this.os = 0,
                            this.extra = null,
                            this.extra_len = 0,
                            this.name = "",
                            this.comment = "",
                            this.hcrc = 0,
                            this.done = !1
                        }
                    }, {}],
                    34: [function(e, t, i) {
                        t.exports = function(e, t) {
                            var i,
                                o,
                                n,
                                s,
                                a,
                                r,
                                l,
                                c,
                                d,
                                h,
                                p,
                                u,
                                f,
                                m,
                                g,
                                v,
                                b,
                                y,
                                w,
                                x,
                                T,
                                $,
                                C,
                                k,
                                S;
                            i = e.state,
                            o = e.next_in,
                            k = e.input,
                            n = o + (e.avail_in - 5),
                            s = e.next_out,
                            S = e.output,
                            a = s - (t - e.avail_out),
                            r = s + (e.avail_out - 257),
                            l = i.dmax,
                            c = i.wsize,
                            d = i.whave,
                            h = i.wnext,
                            p = i.window,
                            u = i.hold,
                            f = i.bits,
                            m = i.lencode,
                            g = i.distcode,
                            v = (1 << i.lenbits) - 1,
                            b = (1 << i.distbits) - 1;
                            e:
                            do {
                                f < 15 && (u += k[o++] << f, f += 8, u += k[o++] << f, f += 8),
                                y = m[u & v];
                                t:
                                for (;;) {
                                    if (u >>>= w = y >>> 24, f -= w, 0 === (w = y >>> 16 & 255))
                                        S[s++] = 65535 & y;
                                    else {
                                        if (!(16 & w)) {
                                            if (0 == (64 & w)) {
                                                y = m[(65535 & y) + (u & (1 << w) - 1)];
                                                continue t
                                            }
                                            if (32 & w) {
                                                i.mode = 12;
                                                break e
                                            }
                                            e.msg = "invalid literal/length code",
                                            i.mode = 30;
                                            break e
                                        }
                                        x = 65535 & y,
                                        (w &= 15) && (f < w && (u += k[o++] << f, f += 8), x += u & (1 << w) - 1, u >>>= w, f -= w),
                                        f < 15 && (u += k[o++] << f, f += 8, u += k[o++] << f, f += 8),
                                        y = g[u & b];
                                        i:
                                        for (;;) {
                                            if (u >>>= w = y >>> 24, f -= w, !(16 & (w = y >>> 16 & 255))) {
                                                if (0 == (64 & w)) {
                                                    y = g[(65535 & y) + (u & (1 << w) - 1)];
                                                    continue i
                                                }
                                                e.msg = "invalid distance code",
                                                i.mode = 30;
                                                break e
                                            }
                                            if (T = 65535 & y, f < (w &= 15) && (u += k[o++] << f, (f += 8) < w && (u += k[o++] << f, f += 8)), (T += u & (1 << w) - 1) > l) {
                                                e.msg = "invalid distance too far back",
                                                i.mode = 30;
                                                break e
                                            }
                                            if (u >>>= w, f -= w, T > (w = s - a)) {
                                                if ((w = T - w) > d && i.sane) {
                                                    e.msg = "invalid distance too far back",
                                                    i.mode = 30;
                                                    break e
                                                }
                                                if ($ = 0, C = p, 0 === h) {
                                                    if ($ += c - w, w < x) {
                                                        x -= w;
                                                        do {
                                                            S[s++] = p[$++]
                                                        } while (--w);
                                                        $ = s - T,
                                                        C = S
                                                    }
                                                } else if (h < w) {
                                                    if ($ += c + h - w, (w -= h) < x) {
                                                        x -= w;
                                                        do {
                                                            S[s++] = p[$++]
                                                        } while (--w);
                                                        if ($ = 0, h < x) {
                                                            x -= w = h;
                                                            do {
                                                                S[s++] = p[$++]
                                                            } while (--w);
                                                            $ = s - T,
                                                            C = S
                                                        }
                                                    }
                                                } else if ($ += h - w, w < x) {
                                                    x -= w;
                                                    do {
                                                        S[s++] = p[$++]
                                                    } while (--w);
                                                    $ = s - T,
                                                    C = S
                                                }
                                                for (; x > 2;)
                                                    S[s++] = C[$++],
                                                    S[s++] = C[$++],
                                                    S[s++] = C[$++],
                                                    x -= 3;
                                                x && (S[s++] = C[$++], x > 1 && (S[s++] = C[$++]))
                                            } else {
                                                $ = s - T;
                                                do {
                                                    S[s++] = S[$++],
                                                    S[s++] = S[$++],
                                                    S[s++] = S[$++],
                                                    x -= 3
                                                } while (x > 2);
                                                x && (S[s++] = S[$++], x > 1 && (S[s++] = S[$++]))
                                            }
                                            break
                                        }
                                    }
                                    break
                                }
                            } while (o < n && s < r);
                            o -= x = f >> 3,
                            u &= (1 << (f -= x << 3)) - 1,
                            e.next_in = o,
                            e.next_out = s,
                            e.avail_in = o < n ? n - o + 5 : 5 - (o - n),
                            e.avail_out = s < r ? r - s + 257 : 257 - (s - r),
                            i.hold = u,
                            i.bits = f
                        }
                    }, {}],
                    35: [function(e, t, i) {
                        var o = e("../utils/common"),
                            n = e("./adler32"),
                            s = e("./crc32"),
                            a = e("./inffast"),
                            r = e("./inftrees");
                        function l(e) {
                            return (e >>> 24 & 255) + (e >>> 8 & 65280) + ((65280 & e) << 8) + ((255 & e) << 24)
                        }
                        function c() {
                            this.mode = 0,
                            this.last = !1,
                            this.wrap = 0,
                            this.havedict = !1,
                            this.flags = 0,
                            this.dmax = 0,
                            this.check = 0,
                            this.total = 0,
                            this.head = null,
                            this.wbits = 0,
                            this.wsize = 0,
                            this.whave = 0,
                            this.wnext = 0,
                            this.window = null,
                            this.hold = 0,
                            this.bits = 0,
                            this.length = 0,
                            this.offset = 0,
                            this.extra = 0,
                            this.lencode = null,
                            this.distcode = null,
                            this.lenbits = 0,
                            this.distbits = 0,
                            this.ncode = 0,
                            this.nlen = 0,
                            this.ndist = 0,
                            this.have = 0,
                            this.next = null,
                            this.lens = new o.Buf16(320),
                            this.work = new o.Buf16(288),
                            this.lendyn = null,
                            this.distdyn = null,
                            this.sane = 0,
                            this.back = 0,
                            this.was = 0
                        }
                        function d(e) {
                            var t;
                            return e && e.state ? (t = e.state, e.total_in = e.total_out = t.total = 0, e.msg = "", t.wrap && (e.adler = 1 & t.wrap), t.mode = 1, t.last = 0, t.havedict = 0, t.dmax = 32768, t.head = null, t.hold = 0, t.bits = 0, t.lencode = t.lendyn = new o.Buf32(852), t.distcode = t.distdyn = new o.Buf32(592), t.sane = 1, t.back = -1, 0) : -2
                        }
                        function h(e) {
                            var t;
                            return e && e.state ? ((t = e.state).wsize = 0, t.whave = 0, t.wnext = 0, d(e)) : -2
                        }
                        function p(e, t) {
                            var i,
                                o;
                            return e && e.state ? (o = e.state, t < 0 ? (i = 0, t = -t) : (i = 1 + (t >> 4), t < 48 && (t &= 15)), t && (t < 8 || t > 15) ? -2 : (null !== o.window && o.wbits !== t && (o.window = null), o.wrap = i, o.wbits = t, h(e))) : -2
                        }
                        function u(e, t) {
                            var i,
                                o;
                            return e ? (o = new c, e.state = o, o.window = null, 0 !== (i = p(e, t)) && (e.state = null), i) : -2
                        }
                        var f,
                            m,
                            g = !0;
                        function v(e) {
                            if (g) {
                                var t;
                                for (f = new o.Buf32(512), m = new o.Buf32(32), t = 0; t < 144;)
                                    e.lens[t++] = 8;
                                for (; t < 256;)
                                    e.lens[t++] = 9;
                                for (; t < 280;)
                                    e.lens[t++] = 7;
                                for (; t < 288;)
                                    e.lens[t++] = 8;
                                for (r(1, e.lens, 0, 288, f, 0, e.work, {
                                    bits: 9
                                }), t = 0; t < 32;)
                                    e.lens[t++] = 5;
                                r(2, e.lens, 0, 32, m, 0, e.work, {
                                    bits: 5
                                }),
                                g = !1
                            }
                            e.lencode = f,
                            e.lenbits = 9,
                            e.distcode = m,
                            e.distbits = 5
                        }
                        i.inflateReset = h,
                        i.inflateReset2 = p,
                        i.inflateResetKeep = d,
                        i.inflateInit = function(e) {
                            return u(e, 15)
                        },
                        i.inflateInit2 = u,
                        i.inflate = function(e, t) {
                            var i,
                                c,
                                d,
                                h,
                                p,
                                u,
                                f,
                                m,
                                g,
                                b,
                                y,
                                w,
                                x,
                                T,
                                $,
                                C,
                                k,
                                S,
                                E,
                                _,
                                D,
                                M,
                                N,
                                I,
                                O = 0,
                                R = new o.Buf8(4),
                                j = [16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15];
                            if (!e || !e.state || !e.output || !e.input && 0 !== e.avail_in)
                                return -2;
                            12 === (i = e.state).mode && (i.mode = 13),
                            p = e.next_out,
                            d = e.output,
                            f = e.avail_out,
                            h = e.next_in,
                            c = e.input,
                            u = e.avail_in,
                            m = i.hold,
                            g = i.bits,
                            b = u,
                            y = f,
                            M = 0;
                            e:
                            for (;;)
                                switch (i.mode) {
                                case 1:
                                    if (0 === i.wrap) {
                                        i.mode = 13;
                                        break
                                    }
                                    for (; g < 16;) {
                                        if (0 === u)
                                            break e;
                                        u--,
                                        m += c[h++] << g,
                                        g += 8
                                    }
                                    if (2 & i.wrap && 35615 === m) {
                                        i.check = 0,
                                        R[0] = 255 & m,
                                        R[1] = m >>> 8 & 255,
                                        i.check = s(i.check, R, 2, 0),
                                        m = 0,
                                        g = 0,
                                        i.mode = 2;
                                        break
                                    }
                                    if (i.flags = 0, i.head && (i.head.done = !1), !(1 & i.wrap) || (((255 & m) << 8) + (m >> 8)) % 31) {
                                        e.msg = "incorrect header check",
                                        i.mode = 30;
                                        break
                                    }
                                    if (8 != (15 & m)) {
                                        e.msg = "unknown compression method",
                                        i.mode = 30;
                                        break
                                    }
                                    if (g -= 4, D = 8 + (15 & (m >>>= 4)), 0 === i.wbits)
                                        i.wbits = D;
                                    else if (D > i.wbits) {
                                        e.msg = "invalid window size",
                                        i.mode = 30;
                                        break
                                    }
                                    i.dmax = 1 << D,
                                    e.adler = i.check = 1,
                                    i.mode = 512 & m ? 10 : 12,
                                    m = 0,
                                    g = 0;
                                    break;
                                case 2:
                                    for (; g < 16;) {
                                        if (0 === u)
                                            break e;
                                        u--,
                                        m += c[h++] << g,
                                        g += 8
                                    }
                                    if (i.flags = m, 8 != (255 & i.flags)) {
                                        e.msg = "unknown compression method",
                                        i.mode = 30;
                                        break
                                    }
                                    if (57344 & i.flags) {
                                        e.msg = "unknown header flags set",
                                        i.mode = 30;
                                        break
                                    }
                                    i.head && (i.head.text = m >> 8 & 1),
                                    512 & i.flags && (R[0] = 255 & m, R[1] = m >>> 8 & 255, i.check = s(i.check, R, 2, 0)),
                                    m = 0,
                                    g = 0,
                                    i.mode = 3;
                                case 3:
                                    for (; g < 32;) {
                                        if (0 === u)
                                            break e;
                                        u--,
                                        m += c[h++] << g,
                                        g += 8
                                    }
                                    i.head && (i.head.time = m),
                                    512 & i.flags && (R[0] = 255 & m, R[1] = m >>> 8 & 255, R[2] = m >>> 16 & 255, R[3] = m >>> 24 & 255, i.check = s(i.check, R, 4, 0)),
                                    m = 0,
                                    g = 0,
                                    i.mode = 4;
                                case 4:
                                    for (; g < 16;) {
                                        if (0 === u)
                                            break e;
                                        u--,
                                        m += c[h++] << g,
                                        g += 8
                                    }
                                    i.head && (i.head.xflags = 255 & m, i.head.os = m >> 8),
                                    512 & i.flags && (R[0] = 255 & m, R[1] = m >>> 8 & 255, i.check = s(i.check, R, 2, 0)),
                                    m = 0,
                                    g = 0,
                                    i.mode = 5;
                                case 5:
                                    if (1024 & i.flags) {
                                        for (; g < 16;) {
                                            if (0 === u)
                                                break e;
                                            u--,
                                            m += c[h++] << g,
                                            g += 8
                                        }
                                        i.length = m,
                                        i.head && (i.head.extra_len = m),
                                        512 & i.flags && (R[0] = 255 & m, R[1] = m >>> 8 & 255, i.check = s(i.check, R, 2, 0)),
                                        m = 0,
                                        g = 0
                                    } else
                                        i.head && (i.head.extra = null);
                                    i.mode = 6;
                                case 6:
                                    if (1024 & i.flags && ((w = i.length) > u && (w = u), w && (i.head && (D = i.head.extra_len - i.length, i.head.extra || (i.head.extra = new Array(i.head.extra_len)), o.arraySet(i.head.extra, c, h, w, D)), 512 & i.flags && (i.check = s(i.check, c, w, h)), u -= w, h += w, i.length -= w), i.length))
                                        break e;
                                    i.length = 0,
                                    i.mode = 7;
                                case 7:
                                    if (2048 & i.flags) {
                                        if (0 === u)
                                            break e;
                                        w = 0;
                                        do {
                                            D = c[h + w++],
                                            i.head && D && i.length < 65536 && (i.head.name += String.fromCharCode(D))
                                        } while (D && w < u);
                                        if (512 & i.flags && (i.check = s(i.check, c, w, h)), u -= w, h += w, D)
                                            break e
                                    } else
                                        i.head && (i.head.name = null);
                                    i.length = 0,
                                    i.mode = 8;
                                case 8:
                                    if (4096 & i.flags) {
                                        if (0 === u)
                                            break e;
                                        w = 0;
                                        do {
                                            D = c[h + w++],
                                            i.head && D && i.length < 65536 && (i.head.comment += String.fromCharCode(D))
                                        } while (D && w < u);
                                        if (512 & i.flags && (i.check = s(i.check, c, w, h)), u -= w, h += w, D)
                                            break e
                                    } else
                                        i.head && (i.head.comment = null);
                                    i.mode = 9;
                                case 9:
                                    if (512 & i.flags) {
                                        for (; g < 16;) {
                                            if (0 === u)
                                                break e;
                                            u--,
                                            m += c[h++] << g,
                                            g += 8
                                        }
                                        if (m !== (65535 & i.check)) {
                                            e.msg = "header crc mismatch",
                                            i.mode = 30;
                                            break
                                        }
                                        m = 0,
                                        g = 0
                                    }
                                    i.head && (i.head.hcrc = i.flags >> 9 & 1, i.head.done = !0),
                                    e.adler = i.check = 0,
                                    i.mode = 12;
                                    break;
                                case 10:
                                    for (; g < 32;) {
                                        if (0 === u)
                                            break e;
                                        u--,
                                        m += c[h++] << g,
                                        g += 8
                                    }
                                    e.adler = i.check = l(m),
                                    m = 0,
                                    g = 0,
                                    i.mode = 11;
                                case 11:
                                    if (0 === i.havedict)
                                        return e.next_out = p, e.avail_out = f, e.next_in = h, e.avail_in = u, i.hold = m, i.bits = g, 2;
                                    e.adler = i.check = 1,
                                    i.mode = 12;
                                case 12:
                                    if (5 === t || 6 === t)
                                        break e;
                                case 13:
                                    if (i.last) {
                                        m >>>= 7 & g,
                                        g -= 7 & g,
                                        i.mode = 27;
                                        break
                                    }
                                    for (; g < 3;) {
                                        if (0 === u)
                                            break e;
                                        u--,
                                        m += c[h++] << g,
                                        g += 8
                                    }
                                    switch (i.last = 1 & m, g -= 1, 3 & (m >>>= 1)) {
                                    case 0:
                                        i.mode = 14;
                                        break;
                                    case 1:
                                        if (v(i), i.mode = 20, 6 === t) {
                                            m >>>= 2,
                                            g -= 2;
                                            break e
                                        }
                                        break;
                                    case 2:
                                        i.mode = 17;
                                        break;
                                    case 3:
                                        e.msg = "invalid block type",
                                        i.mode = 30
                                    }
                                    m >>>= 2,
                                    g -= 2;
                                    break;
                                case 14:
                                    for (m >>>= 7 & g, g -= 7 & g; g < 32;) {
                                        if (0 === u)
                                            break e;
                                        u--,
                                        m += c[h++] << g,
                                        g += 8
                                    }
                                    if ((65535 & m) != (m >>> 16 ^ 65535)) {
                                        e.msg = "invalid stored block lengths",
                                        i.mode = 30;
                                        break
                                    }
                                    if (i.length = 65535 & m, m = 0, g = 0, i.mode = 15, 6 === t)
                                        break e;
                                case 15:
                                    i.mode = 16;
                                case 16:
                                    if (w = i.length) {
                                        if (w > u && (w = u), w > f && (w = f), 0 === w)
                                            break e;
                                        o.arraySet(d, c, h, w, p),
                                        u -= w,
                                        h += w,
                                        f -= w,
                                        p += w,
                                        i.length -= w;
                                        break
                                    }
                                    i.mode = 12;
                                    break;
                                case 17:
                                    for (; g < 14;) {
                                        if (0 === u)
                                            break e;
                                        u--,
                                        m += c[h++] << g,
                                        g += 8
                                    }
                                    if (i.nlen = 257 + (31 & m), m >>>= 5, g -= 5, i.ndist = 1 + (31 & m), m >>>= 5, g -= 5, i.ncode = 4 + (15 & m), m >>>= 4, g -= 4, i.nlen > 286 || i.ndist > 30) {
                                        e.msg = "too many length or distance symbols",
                                        i.mode = 30;
                                        break
                                    }
                                    i.have = 0,
                                    i.mode = 18;
                                case 18:
                                    for (; i.have < i.ncode;) {
                                        for (; g < 3;) {
                                            if (0 === u)
                                                break e;
                                            u--,
                                            m += c[h++] << g,
                                            g += 8
                                        }
                                        i.lens[j[i.have++]] = 7 & m,
                                        m >>>= 3,
                                        g -= 3
                                    }
                                    for (; i.have < 19;)
                                        i.lens[j[i.have++]] = 0;
                                    if (i.lencode = i.lendyn, i.lenbits = 7, N = {
                                        bits: i.lenbits
                                    }, M = r(0, i.lens, 0, 19, i.lencode, 0, i.work, N), i.lenbits = N.bits, M) {
                                        e.msg = "invalid code lengths set",
                                        i.mode = 30;
                                        break
                                    }
                                    i.have = 0,
                                    i.mode = 19;
                                case 19:
                                    for (; i.have < i.nlen + i.ndist;) {
                                        for (; C = (O = i.lencode[m & (1 << i.lenbits) - 1]) >>> 16 & 255, k = 65535 & O, !(($ = O >>> 24) <= g);) {
                                            if (0 === u)
                                                break e;
                                            u--,
                                            m += c[h++] << g,
                                            g += 8
                                        }
                                        if (k < 16)
                                            m >>>= $,
                                            g -= $,
                                            i.lens[i.have++] = k;
                                        else {
                                            if (16 === k) {
                                                for (I = $ + 2; g < I;) {
                                                    if (0 === u)
                                                        break e;
                                                    u--,
                                                    m += c[h++] << g,
                                                    g += 8
                                                }
                                                if (m >>>= $, g -= $, 0 === i.have) {
                                                    e.msg = "invalid bit length repeat",
                                                    i.mode = 30;
                                                    break
                                                }
                                                D = i.lens[i.have - 1],
                                                w = 3 + (3 & m),
                                                m >>>= 2,
                                                g -= 2
                                            } else if (17 === k) {
                                                for (I = $ + 3; g < I;) {
                                                    if (0 === u)
                                                        break e;
                                                    u--,
                                                    m += c[h++] << g,
                                                    g += 8
                                                }
                                                g -= $,
                                                D = 0,
                                                w = 3 + (7 & (m >>>= $)),
                                                m >>>= 3,
                                                g -= 3
                                            } else {
                                                for (I = $ + 7; g < I;) {
                                                    if (0 === u)
                                                        break e;
                                                    u--,
                                                    m += c[h++] << g,
                                                    g += 8
                                                }
                                                g -= $,
                                                D = 0,
                                                w = 11 + (127 & (m >>>= $)),
                                                m >>>= 7,
                                                g -= 7
                                            }
                                            if (i.have + w > i.nlen + i.ndist) {
                                                e.msg = "invalid bit length repeat",
                                                i.mode = 30;
                                                break
                                            }
                                            for (; w--;)
                                                i.lens[i.have++] = D
                                        }
                                    }
                                    if (30 === i.mode)
                                        break;
                                    if (0 === i.lens[256]) {
                                        e.msg = "invalid code -- missing end-of-block",
                                        i.mode = 30;
                                        break
                                    }
                                    if (i.lenbits = 9, N = {
                                        bits: i.lenbits
                                    }, M = r(1, i.lens, 0, i.nlen, i.lencode, 0, i.work, N), i.lenbits = N.bits, M) {
                                        e.msg = "invalid literal/lengths set",
                                        i.mode = 30;
                                        break
                                    }
                                    if (i.distbits = 6, i.distcode = i.distdyn, N = {
                                        bits: i.distbits
                                    }, M = r(2, i.lens, i.nlen, i.ndist, i.distcode, 0, i.work, N), i.distbits = N.bits, M) {
                                        e.msg = "invalid distances set",
                                        i.mode = 30;
                                        break
                                    }
                                    if (i.mode = 20, 6 === t)
                                        break e;
                                case 20:
                                    i.mode = 21;
                                case 21:
                                    if (u >= 6 && f >= 258) {
                                        e.next_out = p,
                                        e.avail_out = f,
                                        e.next_in = h,
                                        e.avail_in = u,
                                        i.hold = m,
                                        i.bits = g,
                                        a(e, y),
                                        p = e.next_out,
                                        d = e.output,
                                        f = e.avail_out,
                                        h = e.next_in,
                                        c = e.input,
                                        u = e.avail_in,
                                        m = i.hold,
                                        g = i.bits,
                                        12 === i.mode && (i.back = -1);
                                        break
                                    }
                                    for (i.back = 0; C = (O = i.lencode[m & (1 << i.lenbits) - 1]) >>> 16 & 255, k = 65535 & O, !(($ = O >>> 24) <= g);) {
                                        if (0 === u)
                                            break e;
                                        u--,
                                        m += c[h++] << g,
                                        g += 8
                                    }
                                    if (C && 0 == (240 & C)) {
                                        for (S = $, E = C, _ = k; C = (O = i.lencode[_ + ((m & (1 << S + E) - 1) >> S)]) >>> 16 & 255, k = 65535 & O, !(S + ($ = O >>> 24) <= g);) {
                                            if (0 === u)
                                                break e;
                                            u--,
                                            m += c[h++] << g,
                                            g += 8
                                        }
                                        m >>>= S,
                                        g -= S,
                                        i.back += S
                                    }
                                    if (m >>>= $, g -= $, i.back += $, i.length = k, 0 === C) {
                                        i.mode = 26;
                                        break
                                    }
                                    if (32 & C) {
                                        i.back = -1,
                                        i.mode = 12;
                                        break
                                    }
                                    if (64 & C) {
                                        e.msg = "invalid literal/length code",
                                        i.mode = 30;
                                        break
                                    }
                                    i.extra = 15 & C,
                                    i.mode = 22;
                                case 22:
                                    if (i.extra) {
                                        for (I = i.extra; g < I;) {
                                            if (0 === u)
                                                break e;
                                            u--,
                                            m += c[h++] << g,
                                            g += 8
                                        }
                                        i.length += m & (1 << i.extra) - 1,
                                        m >>>= i.extra,
                                        g -= i.extra,
                                        i.back += i.extra
                                    }
                                    i.was = i.length,
                                    i.mode = 23;
                                case 23:
                                    for (; C = (O = i.distcode[m & (1 << i.distbits) - 1]) >>> 16 & 255, k = 65535 & O, !(($ = O >>> 24) <= g);) {
                                        if (0 === u)
                                            break e;
                                        u--,
                                        m += c[h++] << g,
                                        g += 8
                                    }
                                    if (0 == (240 & C)) {
                                        for (S = $, E = C, _ = k; C = (O = i.distcode[_ + ((m & (1 << S + E) - 1) >> S)]) >>> 16 & 255, k = 65535 & O, !(S + ($ = O >>> 24) <= g);) {
                                            if (0 === u)
                                                break e;
                                            u--,
                                            m += c[h++] << g,
                                            g += 8
                                        }
                                        m >>>= S,
                                        g -= S,
                                        i.back += S
                                    }
                                    if (m >>>= $, g -= $, i.back += $, 64 & C) {
                                        e.msg = "invalid distance code",
                                        i.mode = 30;
                                        break
                                    }
                                    i.offset = k,
                                    i.extra = 15 & C,
                                    i.mode = 24;
                                case 24:
                                    if (i.extra) {
                                        for (I = i.extra; g < I;) {
                                            if (0 === u)
                                                break e;
                                            u--,
                                            m += c[h++] << g,
                                            g += 8
                                        }
                                        i.offset += m & (1 << i.extra) - 1,
                                        m >>>= i.extra,
                                        g -= i.extra,
                                        i.back += i.extra
                                    }
                                    if (i.offset > i.dmax) {
                                        e.msg = "invalid distance too far back",
                                        i.mode = 30;
                                        break
                                    }
                                    i.mode = 25;
                                case 25:
                                    if (0 === f)
                                        break e;
                                    if (w = y - f, i.offset > w) {
                                        if ((w = i.offset - w) > i.whave && i.sane) {
                                            e.msg = "invalid distance too far back",
                                            i.mode = 30;
                                            break
                                        }
                                        w > i.wnext ? (w -= i.wnext, x = i.wsize - w) : x = i.wnext - w,
                                        w > i.length && (w = i.length),
                                        T = i.window
                                    } else
                                        T = d,
                                        x = p - i.offset,
                                        w = i.length;
                                    w > f && (w = f),
                                    f -= w,
                                    i.length -= w;
                                    do {
                                        d[p++] = T[x++]
                                    } while (--w);
                                    0 === i.length && (i.mode = 21);
                                    break;
                                case 26:
                                    if (0 === f)
                                        break e;
                                    d[p++] = i.length,
                                    f--,
                                    i.mode = 21;
                                    break;
                                case 27:
                                    if (i.wrap) {
                                        for (; g < 32;) {
                                            if (0 === u)
                                                break e;
                                            u--,
                                            m |= c[h++] << g,
                                            g += 8
                                        }
                                        if (y -= f, e.total_out += y, i.total += y, y && (e.adler = i.check = i.flags ? s(i.check, d, y, p - y) : n(i.check, d, y, p - y)), y = f, (i.flags ? m : l(m)) !== i.check) {
                                            e.msg = "incorrect data check",
                                            i.mode = 30;
                                            break
                                        }
                                        m = 0,
                                        g = 0
                                    }
                                    i.mode = 28;
                                case 28:
                                    if (i.wrap && i.flags) {
                                        for (; g < 32;) {
                                            if (0 === u)
                                                break e;
                                            u--,
                                            m += c[h++] << g,
                                            g += 8
                                        }
                                        if (m !== (4294967295 & i.total)) {
                                            e.msg = "incorrect length check",
                                            i.mode = 30;
                                            break
                                        }
                                        m = 0,
                                        g = 0
                                    }
                                    i.mode = 29;
                                case 29:
                                    M = 1;
                                    break e;
                                case 30:
                                    M = -3;
                                    break e;
                                case 31:
                                    return -4;
                                case 32:
                                default:
                                    return -2
                                }
                            return e.next_out = p, e.avail_out = f, e.next_in = h, e.avail_in = u, i.hold = m, i.bits = g, (i.wsize || y !== e.avail_out && i.mode < 30 && (i.mode < 27 || 4 !== t)) && function(e, t, i, n) {
                                var s,
                                    a = e.state;
                                return null === a.window && (a.wsize = 1 << a.wbits, a.wnext = 0, a.whave = 0, a.window = new o.Buf8(a.wsize)), n >= a.wsize ? (o.arraySet(a.window, t, i - a.wsize, a.wsize, 0), a.wnext = 0, a.whave = a.wsize) : ((s = a.wsize - a.wnext) > n && (s = n), o.arraySet(a.window, t, i - n, s, a.wnext), (n -= s) ? (o.arraySet(a.window, t, i - n, n, 0), a.wnext = n, a.whave = a.wsize) : (a.wnext += s, a.wnext === a.wsize && (a.wnext = 0), a.whave < a.wsize && (a.whave += s))), 0
                            }(e, e.output, e.next_out, y - e.avail_out) ? (i.mode = 31, -4) : (b -= e.avail_in, y -= e.avail_out, e.total_in += b, e.total_out += y, i.total += y, i.wrap && y && (e.adler = i.check = i.flags ? s(i.check, d, y, e.next_out - y) : n(i.check, d, y, e.next_out - y)), e.data_type = i.bits + (i.last ? 64 : 0) + (12 === i.mode ? 128 : 0) + (20 === i.mode || 15 === i.mode ? 256 : 0), (0 === b && 0 === y || 4 === t) && 0 === M && (M = -5), M)
                        },
                        i.inflateEnd = function(e) {
                            if (!e || !e.state)
                                return -2;
                            var t = e.state;
                            return t.window && (t.window = null), e.state = null, 0
                        },
                        i.inflateGetHeader = function(e, t) {
                            var i;
                            return e && e.state ? 0 == (2 & (i = e.state).wrap) ? -2 : (i.head = t, t.done = !1, 0) : -2
                        },
                        i.inflateInfo = "pako inflate (from Nodeca project)"
                    }, {
                        "../utils/common": 27,
                        "./adler32": 29,
                        "./crc32": 31,
                        "./inffast": 34,
                        "./inftrees": 36
                    }],
                    36: [function(e, t, i) {
                        var o = e("../utils/common"),
                            n = [3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 15, 17, 19, 23, 27, 31, 35, 43, 51, 59, 67, 83, 99, 115, 131, 163, 195, 227, 258, 0, 0],
                            s = [16, 16, 16, 16, 16, 16, 16, 16, 17, 17, 17, 17, 18, 18, 18, 18, 19, 19, 19, 19, 20, 20, 20, 20, 21, 21, 21, 21, 16, 72, 78],
                            a = [1, 2, 3, 4, 5, 7, 9, 13, 17, 25, 33, 49, 65, 97, 129, 193, 257, 385, 513, 769, 1025, 1537, 2049, 3073, 4097, 6145, 8193, 12289, 16385, 24577, 0, 0],
                            r = [16, 16, 16, 16, 17, 17, 18, 18, 19, 19, 20, 20, 21, 21, 22, 22, 23, 23, 24, 24, 25, 25, 26, 26, 27, 27, 28, 28, 29, 29, 64, 64];
                        t.exports = function(e, t, i, l, c, d, h, p) {
                            var u,
                                f,
                                m,
                                g,
                                v,
                                b,
                                y,
                                w,
                                x,
                                T = p.bits,
                                $ = 0,
                                C = 0,
                                k = 0,
                                S = 0,
                                E = 0,
                                _ = 0,
                                D = 0,
                                M = 0,
                                N = 0,
                                I = 0,
                                O = null,
                                R = 0,
                                j = new o.Buf16(16),
                                L = new o.Buf16(16),
                                F = null,
                                A = 0;
                            for ($ = 0; $ <= 15; $++)
                                j[$] = 0;
                            for (C = 0; C < l; C++)
                                j[t[i + C]]++;
                            for (E = T, S = 15; S >= 1 && 0 === j[S]; S--)
                                ;
                            if (E > S && (E = S), 0 === S)
                                return c[d++] = 20971520, c[d++] = 20971520, p.bits = 1, 0;
                            for (k = 1; k < S && 0 === j[k]; k++)
                                ;
                            for (E < k && (E = k), M = 1, $ = 1; $ <= 15; $++)
                                if (M <<= 1, (M -= j[$]) < 0)
                                    return -1;
                            if (M > 0 && (0 === e || 1 !== S))
                                return -1;
                            for (L[1] = 0, $ = 1; $ < 15; $++)
                                L[$ + 1] = L[$] + j[$];
                            for (C = 0; C < l; C++)
                                0 !== t[i + C] && (h[L[t[i + C]]++] = C);
                            switch (e) {
                            case 0:
                                O = F = h,
                                b = 19;
                                break;
                            case 1:
                                O = n,
                                R -= 257,
                                F = s,
                                A -= 257,
                                b = 256;
                                break;
                            default:
                                O = a,
                                F = r,
                                b = -1
                            }
                            if (I = 0, C = 0, $ = k, v = d, _ = E, D = 0, m = -1, g = (N = 1 << E) - 1, 1 === e && N > 852 || 2 === e && N > 592)
                                return 1;
                            for (;;) {
                                y = $ - D,
                                h[C] < b ? (w = 0, x = h[C]) : h[C] > b ? (w = F[A + h[C]], x = O[R + h[C]]) : (w = 96, x = 0),
                                u = 1 << $ - D,
                                k = f = 1 << _;
                                do {
                                    c[v + (I >> D) + (f -= u)] = y << 24 | w << 16 | x | 0
                                } while (0 !== f);
                                for (u = 1 << $ - 1; I & u;)
                                    u >>= 1;
                                if (0 !== u ? (I &= u - 1, I += u) : I = 0, C++, 0 == --j[$]) {
                                    if ($ === S)
                                        break;
                                    $ = t[i + h[C]]
                                }
                                if ($ > E && (I & g) !== m) {
                                    for (0 === D && (D = E), v += k, M = 1 << (_ = $ - D); _ + D < S && !((M -= j[_ + D]) <= 0);)
                                        _++,
                                        M <<= 1;
                                    if (N += 1 << _, 1 === e && N > 852 || 2 === e && N > 592)
                                        return 1;
                                    c[m = I & g] = E << 24 | _ << 16 | v - d | 0
                                }
                            }
                            return 0 !== I && (c[v + I] = $ - D << 24 | 64 << 16 | 0), p.bits = E, 0
                        }
                    }, {
                        "../utils/common": 27
                    }],
                    37: [function(e, t, i) {
                        t.exports = {
                            2: "need dictionary",
                            1: "stream end",
                            0: "",
                            "-1": "file error",
                            "-2": "stream error",
                            "-3": "data error",
                            "-4": "insufficient memory",
                            "-5": "buffer error",
                            "-6": "incompatible version"
                        }
                    }, {}],
                    38: [function(e, t, i) {
                        var o = e("../utils/common");
                        function n(e) {
                            for (var t = e.length; --t >= 0;)
                                e[t] = 0
                        }
                        var s = [0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 0],
                            a = [0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13],
                            r = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 3, 7],
                            l = [16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15],
                            c = new Array(576);
                        n(c);
                        var d = new Array(60);
                        n(d);
                        var h = new Array(512);
                        n(h);
                        var p = new Array(256);
                        n(p);
                        var u = new Array(29);
                        n(u);
                        var f = new Array(30);
                        n(f);
                        var m,
                            g,
                            v,
                            b = function(e, t, i, o, n) {
                                this.static_tree = e,
                                this.extra_bits = t,
                                this.extra_base = i,
                                this.elems = o,
                                this.max_length = n,
                                this.has_stree = e && e.length
                            },
                            y = function(e, t) {
                                this.dyn_tree = e,
                                this.max_code = 0,
                                this.stat_desc = t
                            };
                        function w(e) {
                            return e < 256 ? h[e] : h[256 + (e >>> 7)]
                        }
                        function x(e, t) {
                            e.pending_buf[e.pending++] = 255 & t,
                            e.pending_buf[e.pending++] = t >>> 8 & 255
                        }
                        function T(e, t, i) {
                            e.bi_valid > 16 - i ? (e.bi_buf |= t << e.bi_valid & 65535, x(e, e.bi_buf), e.bi_buf = t >> 16 - e.bi_valid, e.bi_valid += i - 16) : (e.bi_buf |= t << e.bi_valid & 65535, e.bi_valid += i)
                        }
                        function $(e, t, i) {
                            T(e, i[2 * t], i[2 * t + 1])
                        }
                        function C(e, t) {
                            var i = 0;
                            do {
                                i |= 1 & e,
                                e >>>= 1,
                                i <<= 1
                            } while (--t > 0);
                            return i >>> 1
                        }
                        function k(e, t, i) {
                            var o,
                                n,
                                s = new Array(16),
                                a = 0;
                            for (o = 1; o <= 15; o++)
                                s[o] = a = a + i[o - 1] << 1;
                            for (n = 0; n <= t; n++) {
                                var r = e[2 * n + 1];
                                0 !== r && (e[2 * n] = C(s[r]++, r))
                            }
                        }
                        function S(e) {
                            var t;
                            for (t = 0; t < 286; t++)
                                e.dyn_ltree[2 * t] = 0;
                            for (t = 0; t < 30; t++)
                                e.dyn_dtree[2 * t] = 0;
                            for (t = 0; t < 19; t++)
                                e.bl_tree[2 * t] = 0;
                            e.dyn_ltree[512] = 1,
                            e.opt_len = e.static_len = 0,
                            e.last_lit = e.matches = 0
                        }
                        function E(e) {
                            e.bi_valid > 8 ? x(e, e.bi_buf) : e.bi_valid > 0 && (e.pending_buf[e.pending++] = e.bi_buf),
                            e.bi_buf = 0,
                            e.bi_valid = 0
                        }
                        function _(e, t, i, o) {
                            var n = 2 * t,
                                s = 2 * i;
                            return e[n] < e[s] || e[n] === e[s] && o[t] <= o[i]
                        }
                        function D(e, t, i) {
                            for (var o = e.heap[i], n = i << 1; n <= e.heap_len && (n < e.heap_len && _(t, e.heap[n + 1], e.heap[n], e.depth) && n++, !_(t, o, e.heap[n], e.depth));)
                                e.heap[i] = e.heap[n],
                                i = n,
                                n <<= 1;
                            e.heap[i] = o
                        }
                        function M(e, t, i) {
                            var o,
                                n,
                                r,
                                l,
                                c = 0;
                            if (0 !== e.last_lit)
                                do {
                                    o = e.pending_buf[e.d_buf + 2 * c] << 8 | e.pending_buf[e.d_buf + 2 * c + 1],
                                    n = e.pending_buf[e.l_buf + c],
                                    c++,
                                    0 === o ? $(e, n, t) : ($(e, (r = p[n]) + 256 + 1, t), 0 !== (l = s[r]) && T(e, n -= u[r], l), $(e, r = w(--o), i), 0 !== (l = a[r]) && T(e, o -= f[r], l))
                                } while (c < e.last_lit);
                            $(e, 256, t)
                        }
                        function N(e, t) {
                            var i,
                                o,
                                n,
                                s = t.dyn_tree,
                                a = t.stat_desc.static_tree,
                                r = t.stat_desc.has_stree,
                                l = t.stat_desc.elems,
                                c = -1;
                            for (e.heap_len = 0, e.heap_max = 573, i = 0; i < l; i++)
                                0 !== s[2 * i] ? (e.heap[++e.heap_len] = c = i, e.depth[i] = 0) : s[2 * i + 1] = 0;
                            for (; e.heap_len < 2;)
                                s[2 * (n = e.heap[++e.heap_len] = c < 2 ? ++c : 0)] = 1,
                                e.depth[n] = 0,
                                e.opt_len--,
                                r && (e.static_len -= a[2 * n + 1]);
                            for (t.max_code = c, i = e.heap_len >> 1; i >= 1; i--)
                                D(e, s, i);
                            n = l;
                            do {
                                i = e.heap[1],
                                e.heap[1] = e.heap[e.heap_len--],
                                D(e, s, 1),
                                o = e.heap[1],
                                e.heap[--e.heap_max] = i,
                                e.heap[--e.heap_max] = o,
                                s[2 * n] = s[2 * i] + s[2 * o],
                                e.depth[n] = (e.depth[i] >= e.depth[o] ? e.depth[i] : e.depth[o]) + 1,
                                s[2 * i + 1] = s[2 * o + 1] = n,
                                e.heap[1] = n++,
                                D(e, s, 1)
                            } while (e.heap_len >= 2);
                            e.heap[--e.heap_max] = e.heap[1],
                            function(e, t) {
                                var i,
                                    o,
                                    n,
                                    s,
                                    a,
                                    r,
                                    l = t.dyn_tree,
                                    c = t.max_code,
                                    d = t.stat_desc.static_tree,
                                    h = t.stat_desc.has_stree,
                                    p = t.stat_desc.extra_bits,
                                    u = t.stat_desc.extra_base,
                                    f = t.stat_desc.max_length,
                                    m = 0;
                                for (s = 0; s <= 15; s++)
                                    e.bl_count[s] = 0;
                                for (l[2 * e.heap[e.heap_max] + 1] = 0, i = e.heap_max + 1; i < 573; i++)
                                    (s = l[2 * l[2 * (o = e.heap[i]) + 1] + 1] + 1) > f && (s = f, m++),
                                    l[2 * o + 1] = s,
                                    o > c || (e.bl_count[s]++, a = 0, o >= u && (a = p[o - u]), r = l[2 * o], e.opt_len += r * (s + a), h && (e.static_len += r * (d[2 * o + 1] + a)));
                                if (0 !== m) {
                                    do {
                                        for (s = f - 1; 0 === e.bl_count[s];)
                                            s--;
                                        e.bl_count[s]--,
                                        e.bl_count[s + 1] += 2,
                                        e.bl_count[f]--,
                                        m -= 2
                                    } while (m > 0);
                                    for (s = f; 0 !== s; s--)
                                        for (o = e.bl_count[s]; 0 !== o;)
                                            (n = e.heap[--i]) > c || (l[2 * n + 1] !== s && (e.opt_len += (s - l[2 * n + 1]) * l[2 * n], l[2 * n + 1] = s), o--)
                                }
                            }(e, t),
                            k(s, c, e.bl_count)
                        }
                        function I(e, t, i) {
                            var o,
                                n,
                                s = -1,
                                a = t[1],
                                r = 0,
                                l = 7,
                                c = 4;
                            for (0 === a && (l = 138, c = 3), t[2 * (i + 1) + 1] = 65535, o = 0; o <= i; o++)
                                n = a,
                                a = t[2 * (o + 1) + 1],
                                ++r < l && n === a || (r < c ? e.bl_tree[2 * n] += r : 0 !== n ? (n !== s && e.bl_tree[2 * n]++, e.bl_tree[32]++) : r <= 10 ? e.bl_tree[34]++ : e.bl_tree[36]++, r = 0, s = n, 0 === a ? (l = 138, c = 3) : n === a ? (l = 6, c = 3) : (l = 7, c = 4))
                        }
                        function O(e, t, i) {
                            var o,
                                n,
                                s = -1,
                                a = t[1],
                                r = 0,
                                l = 7,
                                c = 4;
                            for (0 === a && (l = 138, c = 3), o = 0; o <= i; o++)
                                if (n = a, a = t[2 * (o + 1) + 1], !(++r < l && n === a)) {
                                    if (r < c)
                                        do {
                                            $(e, n, e.bl_tree)
                                        } while (0 != --r);
                                    else
                                        0 !== n ? (n !== s && ($(e, n, e.bl_tree), r--), $(e, 16, e.bl_tree), T(e, r - 3, 2)) : r <= 10 ? ($(e, 17, e.bl_tree), T(e, r - 3, 3)) : ($(e, 18, e.bl_tree), T(e, r - 11, 7));
                                    r = 0,
                                    s = n,
                                    0 === a ? (l = 138, c = 3) : n === a ? (l = 6, c = 3) : (l = 7, c = 4)
                                }
                        }
                        var R = !1;
                        function j(e, t, i, n) {
                            T(e, 0 + (n ? 1 : 0), 3),
                            function(e, t, i, n) {
                                E(e),
                                n && (x(e, i), x(e, ~i)),
                                o.arraySet(e.pending_buf, e.window, t, i, e.pending),
                                e.pending += i
                            }(e, t, i, !0)
                        }
                        i._tr_init = function(e) {
                            R || (!function() {
                                var e,
                                    t,
                                    i,
                                    o,
                                    n,
                                    l = new Array(16);
                                for (i = 0, o = 0; o < 28; o++)
                                    for (u[o] = i, e = 0; e < 1 << s[o]; e++)
                                        p[i++] = o;
                                for (p[i - 1] = o, n = 0, o = 0; o < 16; o++)
                                    for (f[o] = n, e = 0; e < 1 << a[o]; e++)
                                        h[n++] = o;
                                for (n >>= 7; o < 30; o++)
                                    for (f[o] = n << 7, e = 0; e < 1 << a[o] - 7; e++)
                                        h[256 + n++] = o;
                                for (t = 0; t <= 15; t++)
                                    l[t] = 0;
                                for (e = 0; e <= 143;)
                                    c[2 * e + 1] = 8,
                                    e++,
                                    l[8]++;
                                for (; e <= 255;)
                                    c[2 * e + 1] = 9,
                                    e++,
                                    l[9]++;
                                for (; e <= 279;)
                                    c[2 * e + 1] = 7,
                                    e++,
                                    l[7]++;
                                for (; e <= 287;)
                                    c[2 * e + 1] = 8,
                                    e++,
                                    l[8]++;
                                for (k(c, 287, l), e = 0; e < 30; e++)
                                    d[2 * e + 1] = 5,
                                    d[2 * e] = C(e, 5);
                                m = new b(c, s, 257, 286, 15),
                                g = new b(d, a, 0, 30, 15),
                                v = new b(new Array(0), r, 0, 19, 7)
                            }(), R = !0),
                            e.l_desc = new y(e.dyn_ltree, m),
                            e.d_desc = new y(e.dyn_dtree, g),
                            e.bl_desc = new y(e.bl_tree, v),
                            e.bi_buf = 0,
                            e.bi_valid = 0,
                            S(e)
                        },
                        i._tr_stored_block = j,
                        i._tr_flush_block = function(e, t, i, o) {
                            var n,
                                s,
                                a = 0;
                            e.level > 0 ? (2 === e.strm.data_type && (e.strm.data_type = function(e) {
                                var t,
                                    i = 4093624447;
                                for (t = 0; t <= 31; t++, i >>>= 1)
                                    if (1 & i && 0 !== e.dyn_ltree[2 * t])
                                        return 0;
                                if (0 !== e.dyn_ltree[18] || 0 !== e.dyn_ltree[20] || 0 !== e.dyn_ltree[26])
                                    return 1;
                                for (t = 32; t < 256; t++)
                                    if (0 !== e.dyn_ltree[2 * t])
                                        return 1;
                                return 0
                            }(e)), N(e, e.l_desc), N(e, e.d_desc), a = function(e) {
                                var t;
                                for (I(e, e.dyn_ltree, e.l_desc.max_code), I(e, e.dyn_dtree, e.d_desc.max_code), N(e, e.bl_desc), t = 18; t >= 3 && 0 === e.bl_tree[2 * l[t] + 1]; t--)
                                    ;
                                return e.opt_len += 3 * (t + 1) + 5 + 5 + 4, t
                            }(e), n = e.opt_len + 3 + 7 >>> 3, (s = e.static_len + 3 + 7 >>> 3) <= n && (n = s)) : n = s = i + 5,
                            i + 4 <= n && -1 !== t ? j(e, t, i, o) : 4 === e.strategy || s === n ? (T(e, 2 + (o ? 1 : 0), 3), M(e, c, d)) : (T(e, 4 + (o ? 1 : 0), 3), function(e, t, i, o) {
                                var n;
                                for (T(e, t - 257, 5), T(e, i - 1, 5), T(e, o - 4, 4), n = 0; n < o; n++)
                                    T(e, e.bl_tree[2 * l[n] + 1], 3);
                                O(e, e.dyn_ltree, t - 1),
                                O(e, e.dyn_dtree, i - 1)
                            }(e, e.l_desc.max_code + 1, e.d_desc.max_code + 1, a + 1), M(e, e.dyn_ltree, e.dyn_dtree)),
                            S(e),
                            o && E(e)
                        },
                        i._tr_tally = function(e, t, i) {
                            return e.pending_buf[e.d_buf + 2 * e.last_lit] = t >>> 8 & 255, e.pending_buf[e.d_buf + 2 * e.last_lit + 1] = 255 & t, e.pending_buf[e.l_buf + e.last_lit] = 255 & i, e.last_lit++, 0 === t ? e.dyn_ltree[2 * i]++ : (e.matches++, t--, e.dyn_ltree[2 * (p[i] + 256 + 1)]++, e.dyn_dtree[2 * w(t)]++), e.last_lit === e.lit_bufsize - 1
                        },
                        i._tr_align = function(e) {
                            T(e, 2, 3),
                            $(e, 256, c),
                            function(e) {
                                16 === e.bi_valid ? (x(e, e.bi_buf), e.bi_buf = 0, e.bi_valid = 0) : e.bi_valid >= 8 && (e.pending_buf[e.pending++] = 255 & e.bi_buf, e.bi_buf >>= 8, e.bi_valid -= 8)
                            }(e)
                        }
                    }, {
                        "../utils/common": 27
                    }],
                    39: [function(e, t, i) {
                        t.exports = function() {
                            this.input = null,
                            this.next_in = 0,
                            this.avail_in = 0,
                            this.total_in = 0,
                            this.output = null,
                            this.next_out = 0,
                            this.avail_out = 0,
                            this.total_out = 0,
                            this.msg = "",
                            this.state = null,
                            this.data_type = 2,
                            this.adler = 0
                        }
                    }, {}]
                }, {}, [9])(9)
            }))
        }).call(this, i("./node_modules/webpack/buildin/harmony-module.js")(e), i("./node_modules/webpack/buildin/global.js"))
    },
    "./src/lib/jqueryui/ui-lightness/jquery-ui-1.10.4.custom.min.css": function(e, t, i) {},
    "./src/react/LightboxComponent.tsx": function(e, t, i) {
        "use strict";
        i.d(t, "a", (function() {
            return l
        }));
        var o = i("./node_modules/@ninox/ninox-core/dist/ninox-core.es5.js"),
            n = i("./node_modules/@zhyabs1314/react-image-lightbox/dist/main.js"),
            s = i.n(n),
            a = i("./node_modules/react/index.js"),
            r = (i("./src/react/LightboxComponent.css"), i("./src/react/util/FastClickContainer.tsx"));
        class l extends a.Component {
            constructor(e)
            {
                super(e),
                this.state = {
                    photoIndex: this.props.initialImageIndex,
                    className: "LightboxComponent_initial"
                }
            }
            render()
            {
                const e = this.state.photoIndex;
                let t,
                    i;
                return this.props.images.length > 1 && (t = this.props.images[(e + 1) % this.props.images.length].file, i = this.props.images[(e + this.props.images.length - 1) % this.props.images.length].file), a.createElement(s.a, {
                    wrapperClassName: this.state.className,
                    onImageLoad: () => this.setState({
                        className: void 0
                    }),
                    mainSrc: this.props.images[e].file,
                    nextSrc: t,
                    prevSrc: i,
                    imageTitle: this.props.images[e].name,
                    onCloseRequest: this.props.closeLightBox,
                    toolbarButtons: [a.createElement(r.a, {
                        key: e,
                        className: "lightbox-download",
                        onFastClick: () => this.props.downloadUrl(this.props.images[e])
                    }, Object(o.getLocale)().download)],
                    onMovePrevRequest: () => this.setState({
                        photoIndex: (e + this.props.images.length - 1) % this.props.images.length
                    }),
                    onMoveNextRequest: () => this.setState({
                        photoIndex: (e + 1) % this.props.images.length
                    })
                })
            }
        }
    },
    "./src/react/PdfRenderer.tsx": function(e, t, i) {
        "use strict";
        i.d(t, "a", (function() {
            return u
        }));
        var o = i("./node_modules/@babel/runtime/helpers/defineProperty.js"),
            n = i.n(o),
            s = i("./node_modules/@ninox/ninox-core/dist/ninox-core.es5.js"),
            a = i("./node_modules/react/index.js"),
            r = i("./node_modules/react-pdf/dist/entry.js"),
            l = (i("./src/react/PdfRenderer.css"), i("./src/react/util/FastClickContainer.tsx"));
        const c = new class {
            constructor()
            {
                n()(this, "dummy", void 0)
            }
        }
        ;
        function d(e) {
            return e === c
        }
        function h(e, t) {
            var i = Object.keys(e);
            if (Object.getOwnPropertySymbols) {
                var o = Object.getOwnPropertySymbols(e);
                t && (o = o.filter((function(t) {
                    return Object.getOwnPropertyDescriptor(e, t).enumerable
                }))),
                i.push.apply(i, o)
            }
            return i
        }
        function p(e) {
            for (var t = 1; t < arguments.length; t++) {
                var i = null != arguments[t] ? arguments[t] : {};
                t % 2 ? h(Object(i), !0).forEach((function(t) {
                    n()(e, t, i[t])
                })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(i)) : h(Object(i)).forEach((function(t) {
                    Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(i, t))
                }))
            }
            return e
        }
        r.pdfjs.GlobalWorkerOptions.workerSrc = `//cdnjs.cloudflare.com/ajax/libs/pdf.js/${r.pdfjs.version}/pdf.worker.js`;
        class u extends a.Component {
            constructor(e)
            {
                super(e),
                n()(this, "HEADER_HEIGHT", 50),
                n()(this, "ZOOM_STEP", .3),
                n()(this, "MAX_ZOOM", 2.8),
                n()(this, "MIN_ZOOM", .7),
                n()(this, "resize", () => {
                    this.setState({
                        width: .9 * window.getWidth(),
                        height: window.getHeight()
                    })
                }),
                n()(this, "onZoomInClick", () => {
                    this.setState(e => p({}, e, {
                        scale: Math.min(e.scale + this.ZOOM_STEP, this.MAX_ZOOM)
                    }))
                }),
                n()(this, "onZoomOutClick", () => {
                    this.setState(e => p({}, e, {
                        scale: Math.max(e.scale - this.ZOOM_STEP, this.MIN_ZOOM)
                    }))
                }),
                n()(this, "onDocumentLoad", ({numPages: e}) => {
                    this.setState({
                        numPages: e
                    })
                }),
                this.state = {
                    numLoadedPages: 0,
                    numPages: c,
                    height: 0,
                    width: 0,
                    scale: 1
                }
            }
            componentWillMount()
            {
                window.addEventListener("resize", this.resize),
                this.resize()
            }
            componentWillUnmount()
            {
                window.removeEventListener("resize", this.resize)
            }
            render()
            {
                return a.createElement("div", {
                    className: d(this.state.numPages) ? "PdfRenderer_rootLoading" : ""
                }, a.createElement(r.Document, {
                    className: "PdfRenderer_document",
                    file: this.props.pdfUrl,
                    loading: "Loading...",
                    onLoadSuccess: this.onDocumentLoad
                }, d(this.state.numPages) ? "Loading..." : this.renderPages(this.state.numPages)), a.createElement("div", {
                    className: "PdfRenderer_header",
                    style: {
                        height: this.HEADER_HEIGHT
                    }
                }, a.createElement("div", {
                    className: "PdfRenderer_headerNameContainer"
                }, a.createElement("div", {
                    className: "PdfRenderer_headerItem"
                }, this.props.fileName)), a.createElement("div", {
                    className: "PdfRenderer_headerButtonContainer"
                }, a.createElement(l.a, {
                    onFastClick: this.props.onDownloadClick,
                    className: "PdfRenderer_headerItem PdfRenderer_headerButton"
                }, Object(s.getLocale)().download), a.createElement(l.a, {
                    className: "ril__zoomInButton ril__builtinButton" + (this.state.scale === this.MAX_ZOOM ? " ril__builtinButtonDisabled" : ""),
                    onFastClick: this.onZoomInClick
                }), a.createElement(l.a, {
                    className: "ril__zoomOutButton ril__builtinButton" + (this.state.scale === this.MIN_ZOOM ? " ril__builtinButtonDisabled" : ""),
                    onFastClick: this.onZoomOutClick
                }), a.createElement(l.a, {
                    className: "ril__closeButton ril__builtinButton",
                    onFastClick: this.props.onCloseClick
                }))))
            }
            renderPages(e)
            {
                const t = [];
                for (let i = 0; i <= this.state.numLoadedPages; i++)
                    t.push(a.createElement("div", {
                        className: "PdfRenderer_page",
                        style: {
                            paddingTop: 0 === i ? this.HEADER_HEIGHT + 10 : 10,
                            alignItems: this.state.scale <= 1 ? "center" : "flex-start"
                        },
                        key: i
                    }, a.createElement("div", {
                        style: {
                            width: this.state.width * this.state.scale,
                            fontSize: 16 * this.state.scale
                        }
                    }, i + 1, " / ", e), a.createElement(r.Page, {
                        scale: this.state.scale,
                        height: this.state.height,
                        renderTextLayer: !1,
                        pageNumber: i + 1,
                        width: this.state.width,
                        loading: "Loading...",
                        onRenderSuccess: () => {
                            this.state.numLoadedPages < e - 1 && this.setState(e => ({
                                numLoadedPages: e.numLoadedPages + 1
                            }))
                        }
                    })));
                return a.createElement("div", {
                    style: {
                        height: this.state.height,
                        overflow: "auto"
                    }
                }, t.map(e => e))
            }
        }
    },
    "./src/react/SimpleTabSelectionRow.tsx": function(e, t, i) {
        "use strict";
        i.d(t, "a", (function() {
            return p
        }));
        var o = i("./node_modules/@babel/runtime/helpers/defineProperty.js"),
            n = i.n(o),
            s = i("./node_modules/@ninox/ninox-core/dist/ninox-core.es5.js"),
            a = i("./node_modules/react/index.js"),
            r = (i("./src/react/SimpleTablSelectionRow.css"), i("./src/react/tableView/PopupMenu.tsx")),
            l = i("./src/react/util/FastClickContainer.tsx"),
            c = i("./src/react/util/general.ts"),
            d = i("./src/react/util/HorizontalScrollContainer/HorizontalScrollContainer.tsx"),
            h = i("./src/react/util/HorizontalScrollContainer/HorizontalScrollItem.tsx");
        class p extends a.Component {
            constructor(e)
            {
                super(e),
                n()(this, "handleScrollStateChange", e => {
                    this.setState({
                        isScrollable: e,
                        isOpen: !1
                    })
                }),
                n()(this, "handleShowAllItems", e => {
                    this.setState({
                        isOpen: !0,
                        clickTarget: l.b.getTarget(e)
                    })
                }),
                this.state = {
                    isScrollable: !1,
                    isOpen: !1,
                    clickTarget: null
                }
            }
            render()
            {
                return a.createElement("div", {
                    className: "SimpleTablSelectionRow_root"
                }, a.createElement(d.a, {
                    controlsConfig: {
                        left: {
                            visibility: window.TOUCH ? "NONE" : "AUTO",
                            innerElement: this.getElementBeforeControls()
                        },
                        right: {
                            visibility: window.TOUCH ? "NONE" : "AUTO"
                        },
                        position: "AFTER_CHILD"
                    },
                    selectedItemId: this.props.currentItemId,
                    onScrollStateChange: this.handleScrollStateChange
                }, this.props.items.map((e, t) => a.createElement(h.a, {
                    className: "SimpleTabSelectionRow_itemContainer",
                    id: "" + e.id,
                    key: e.id
                }, a.createElement(l.a, {
                    className: Object(c.a)("SimpleTabSelectionRow_view ", this.props.currentItemId === e.id ? "SimpleTabSelectionRow_viewSelected" : ""),
                    onFastClick: t => this.props.onItemSelect(e.id, t),
                    onFastContextMenu: t => {
                        this.props.onContextMenuClick(e.id, t)
                    }
                }, this.props.currentItemId === e.id ? a.createElement("div", {
                    className: "SimpleTabSelectionRow_selectionIndicator"
                }) : null, this.getItemName(e)))), this.props.onNewItemClick && !this.state.isScrollable ? this.newItemButton() : null), this.state.isScrollable ? a.createElement(a.Fragment, null, a.createElement("div", {
                    className: "SimpleTabSelectionRow_showAllButtonContainer"
                }, a.createElement(l.a, {
                    className: "i-32-16 i-white i-items",
                    onFastClick: this.handleShowAllItems
                })), a.createElement(r.a, {
                    itemBackground: this.props.popupItemBackground,
                    show: this.state.isOpen,
                    clickTarget: this.state.clickTarget,
                    items: this.props.items,
                    onClick: (e, t) => {
                        null !== e && this.props.onItemSelect(this.props.items[e].id, t),
                        this.setState({
                            isOpen: !1
                        })
                    }
                })) : null)
            }
            getItemName(e)
            {
                return "" === e.text ? Object(s.getLocale)().unknown : e.text
            }
            getElementBeforeControls()
            {
                return this.props.onNewItemClick && this.state.isScrollable ? this.newItemButton() : null
            }
            newItemButton()
            {
                return null === this.props.onNewItemClick ? null : this.props.newButtonText ? a.createElement(l.a, {
                    className: "secondary-tab",
                    onFastClick: this.props.onNewItemClick
                }, this.props.newButtonText) : a.createElement(l.a, {
                    onFastClick: this.props.onNewItemClick,
                    className: "SimpleTabSelectionRow_newItemButton"
                }, a.createElement("div", {
                    className: "i-32-16 i-light-grey i-plus"
                }))
            }
        }
    },
    "./src/react/credentials/Credentials.scss": function(e, t, i) {},
    "./src/react/tableView/PopupMenu.tsx": function(e, t, i) {
        "use strict";
        i.d(t, "a", (function() {
            return y
        }));
        var o = i("./node_modules/@babel/runtime/helpers/defineProperty.js"),
            n = i.n(o),
            s = i("./node_modules/@ninox/ninox-core/dist/ninox-core.es5.js"),
            a = i("./node_modules/react/index.js"),
            r = i("./node_modules/react-sortable-hoc/dist/react-sortable-hoc.umd.js"),
            l = i("./src/react/util/commons.ts");
        var c = i("./src/react/util/PositionedBackplane.tsx"),
            d = i("./src/react/util/FastClickContainer.tsx"),
            h = i("./src/react/util/general.ts");
        i("./src/react/util/SearchBarWithX.css");
        class p extends a.Component {
            constructor(e)
            {
                super(e),
                this.state = {
                    filterBy: void 0 === e.defaultFilter ? "" : e.defaultFilter,
                    isSelected: !1
                }
            }
            onInputChange(e)
            {
                this.setState({
                    filterBy: e
                }),
                this.props.onFilterChange(e.trim())
            }
            render()
            {
                return a.createElement("div", {
                    className: "SearchBarWithX_root " + this.props.className
                }, a.createElement("input", {
                    type: "text",
                    value: this.state.filterBy,
                    onChange: e => this.onInputChange(e.target.value),
                    placeholder: this.props.placeholder,
                    onFocus: () => this.setState({
                        isSelected: !0
                    }),
                    onBlur: () => this.setState({
                        isSelected: !1
                    }),
                    autoFocus: !window.TOUCH,
                    className: Object(h.a)("SearchBarWithX_input", this.state.isSelected ? "SearchBarWithX_inputSelected" : "")
                }), "" !== this.state.filterBy ? a.createElement(d.a, {
                    onFastClick: () => this.onInputChange(""),
                    className: "i-32-16 i-light-grey i-close SearchWithX_resetSearch"
                }) : null)
            }
        }
        i("./src/react/tableView/PopupMenu.css"),
        i("./src/react/tableView/PopupMenuTab.css");
        function u(e) {
            return a.createElement(d.a, {
                className: Object(h.a)("PopupMenuTab", {
                    PopupMenuTab_Selected: !!e.item.isSelected,
                    PopupMenuTab_Sorting: e.isSorting,
                    PopupMenuTab_small: e.isSmall,
                    PopupMenuTab_sortable: void 0 !== e.onReorder || "OFF_WHITE" === e.background
                }),
                onFastClick: t => e.handleClick(t)
            }, a.createElement("div", {
                className: "PopupMenuTab_container"
            }, e.item.iconClass ? a.createElement("div", {
                className: "PopupMenuTab_iconContainer"
            }, a.createElement("div", {
                className: e.item.iconClass
            })) : null, a.createElement("div", {
                className: "PopupMenuTab_Text"
            }, e.item.text ? e.item.text : Object(s.getLocale)().unnamed)), void 0 !== e.onReorder ? a.createElement(f, null) : null)
        }
        const f = Object(r.SortableHandle)(() => a.createElement("span", {
            className: "PopupMenuTab_sortingHandleContainer"
        }, a.createElement("span", {
            className: "i-32-24 i-lighter-grey i-drag-handle"
        })));
        function m(e, t) {
            var i = Object.keys(e);
            if (Object.getOwnPropertySymbols) {
                var o = Object.getOwnPropertySymbols(e);
                t && (o = o.filter((function(t) {
                    return Object.getOwnPropertyDescriptor(e, t).enumerable
                }))),
                i.push.apply(i, o)
            }
            return i
        }
        function g(e) {
            for (var t = 1; t < arguments.length; t++) {
                var i = null != arguments[t] ? arguments[t] : {};
                t % 2 ? m(Object(i), !0).forEach((function(t) {
                    n()(e, t, i[t])
                })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(i)) : m(Object(i)).forEach((function(t) {
                    Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(i, t))
                }))
            }
            return e
        }
        const v = Object(r.SortableElement)(({children: e}) => e),
            b = Object(r.SortableContainer)(({style: e, className: t, children: i}) => a.createElement("div", {
                style: e,
                className: t
            }, i));
        function y(e) {
            const [t, i] = a.useState({
                    isSorting: !1,
                    filterBy: "",
                    didShow: !1
                }),
                [o, n] = function(e=!0) {
                    let t;
                    const [i, o] = Object(a.useState)([window.getWidth(), window.getHeight()]),
                        n = Object(a.useRef)(!1);
                    return Object(a.useLayoutEffect)(() => {
                        function i() {
                            clearTimeout(t),
                            t = setTimeout(() => {
                                o([window.getWidth(), window.getHeight()])
                            }, 50)
                        }
                        return e && !n.current && (window.addEventListener("resize", i), i(), n.current = e), () => {
                            n.current && (window.removeEventListener("resize", i), n.current = !1)
                        }
                    }, [e]), i
                }(t.didShow),
                r = o <= 640,
                d = r ? 100 : 164,
                h = r ? 4 : 16;
            return a.createElement(c.a, {
                clickTarget: e.clickTarget,
                show: e.show,
                settings: {
                    style: "tooltip",
                    arrowColor: "white"
                },
                onDidShow: () => i(g({}, t, {
                    didShow: !1,
                    filterBy: ""
                })),
                onDidHide: () => i(g({}, t, {
                    didShow: !0
                })),
                onClick: t => e.onClick(null, t)
            }, a.createElement("div", {
                className: "PopupMenu_root"
            }, !1 !== e.renderSearch ? a.createElement(p, {
                onFilterChange: e => {
                    i(g({}, t, {
                        filterBy: e
                    }))
                },
                placeholder: Object(s.getLocale)().search,
                className: "PopupMenu_searchBar"
            }) : null, a.createElement(b, {
                style: {
                    maxHeight: n - 140,
                    width: (() => {
                        const t = Math.max(1, Math.floor((o - h) / d));
                        let i;
                        i = void 0 !== e.maxColumns ? Math.min(e.maxColumns, t) : t;
                        const n = Math.ceil(Math.sqrt(e.items.length));
                        return Math.min(n, i) * d
                    })()
                },
                onSortStart: () => i(g({}, t, {
                    isSorting: !0
                })),
                onSortEnd: o => {
                    i(g({}, t, {
                        isSorting: !1
                    })),
                    Object(l.a)(e.onReorder),
                    e.onReorder(o.oldIndex, o.newIndex)
                },
                axis: "xy",
                useDragHandle: !0,
                className: "PopupMenu_body",
                helperClass: "PopupMenu_helperClass"
            }, e.items.reduce((i, o, n) => (("" === t.filterBy || (o.text || "").toLowerCase().includes(t.filterBy.toLowerCase())) && i.push(a.createElement(v, {
                index: n,
                key: o.id
            }, a.createElement(u, {
                background: e.itemBackground,
                isSmall: r,
                item: o,
                handleClick: t => e.onClick(n, t),
                isSorting: t.isSorting,
                onReorder: e.onReorder
            }))), i), []))))
        }
    },
    "./src/react/util/FastClickContainer.tsx": function(e, t, i) {
        "use strict";
        i.d(t, "b", (function() {
            return u
        })),
        i.d(t, "a", (function() {
            return m
        }));
        var o = i("./node_modules/@babel/runtime/helpers/extends.js"),
            n = i.n(o),
            s = i("./node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),
            a = i.n(s),
            r = i("./node_modules/@babel/runtime/helpers/defineProperty.js"),
            l = i.n(r),
            c = i("./node_modules/assert-never/index.js"),
            d = i.n(c),
            h = i("./node_modules/react/index.js");
        i("./src/react/util/FastClickContainer.css");
        function p(e, t) {
            var i = Object.keys(e);
            if (Object.getOwnPropertySymbols) {
                var o = Object.getOwnPropertySymbols(e);
                t && (o = o.filter((function(t) {
                    return Object.getOwnPropertyDescriptor(e, t).enumerable
                }))),
                i.push.apply(i, o)
            }
            return i
        }
        let u;
        var f;
        (f = u || (u = {})).getPosition = function(e) {
            switch (e.kind) {
            case "MouseDown":
            case "MouseUp":
                return {
                    x: e.event.clientX,
                    y: e.event.clientY
                };
            case "TouchEnd":
                return {
                    x: e.event.changedTouches[0].clientX,
                    y: e.event.changedTouches[0].clientY
                };
            case "TouchStart":
                return {
                    x: e.event.touches[0].clientX,
                    y: e.event.touches[0].clientY
                };
            default:
                return d()(e)
            }
        },
        f.getTarget = function(e) {
            switch (e.kind) {
            case "MouseDown":
            case "MouseUp":
                return e.event.target;
            case "TouchEnd":
                return e.event.changedTouches[0].target;
            case "TouchStart":
                return e.event.touches[0].target;
            default:
                return d()(e)
            }
        };
        class m extends h.Component {
            constructor(e)
            {
                super(e),
                l()(this, "shouldCountAsClick", void 0),
                l()(this, "rippleTimeoutId", void 0),
                l()(this, "longPressTimeoutId", void 0),
                l()(this, "initialCoords", void 0),
                l()(this, "longPressOccurred", !1),
                l()(this, "handleContextMenu", e => {
                    void 0 !== this.props.onFastContextMenu && (e.preventDefault(), e.stopPropagation(), this.props.onFastContextMenu({
                        event: e,
                        kind: "MouseDown"
                    })),
                    this.shouldCountAsClick = !1
                }),
                l()(this, "handleTouchEnd", e => {
                    clearTimeout(this.longPressTimeoutId),
                    this.longPressOccurred ? this.handleLongPressOccurred(e) : this.shouldCountAsClick && 0 === e.touches.length && 1 === e.changedTouches.length && (e.stopPropagation(), e.preventDefault(), this.props.onFastClick({
                        kind: "TouchEnd",
                        event: e
                    })),
                    this.shouldCountAsClick = !1
                }),
                l()(this, "handleMouseUp", e => {
                    clearTimeout(this.longPressTimeoutId),
                    this.longPressOccurred ? this.handleLongPressOccurred(e) : this.shouldCountAsClick && (e.stopPropagation(), e.preventDefault(), this.props.onFastClick({
                        kind: "MouseUp",
                        event: e
                    })),
                    this.shouldCountAsClick = !1
                }),
                l()(this, "handleTouchMove", e => {
                    if (!this.shouldCountAsClick)
                        return;
                    const t = e.touches[0].clientX,
                        i = e.touches[0].clientY,
                        o = t - this.initialCoords.x,
                        n = i - this.initialCoords.y;
                    o * o + n * n > 100 && (this.cleanUp(), this.shouldCountAsClick = !1)
                }),
                l()(this, "handleMouseLeave", () => {
                    this.shouldCountAsClick && (this.cleanUp(), this.shouldCountAsClick = !1)
                }),
                l()(this, "handleTouchStart", e => {
                    if (e.touches.length > 1)
                        return;
                    const t = {
                        event: e,
                        kind: "TouchStart"
                    };
                    this.setInitialCoords(t),
                    this.startClick(t),
                    "PREVENT_RIPPLE" !== this.props.behaviour && this.showRipple(t),
                    void 0 !== this.props.onTouchStart && this.props.onTouchStart(e)
                }),
                l()(this, "handleMouseDown", e => {
                    if (0 !== e.button)
                        return;
                    const t = {
                        event: e,
                        kind: "MouseDown"
                    };
                    this.startClick(t),
                    "FORCE_RIPPLE" === this.props.behaviour && this.showRipple(t),
                    void 0 !== this.props.onMouseDown && this.props.onMouseDown(e)
                }),
                l()(this, "showRipple", e => {
                    this.callCleanUp(500);
                    const t = e.event.currentTarget,
                        i = t.offsetWidth,
                        o = t.getBoundingClientRect();
                    let {x: n, y: s} = u.getPosition(e);
                    s = s - o.y - i / 2,
                    n = n - o.x - i / 2;
                    const a = {
                        top: s + "px",
                        left: n + "px",
                        height: i + "px",
                        width: i + "px"
                    };
                    this.setState({
                        spanStyles: this.state.spanStyles.concat(a)
                    })
                }),
                l()(this, "renderRippleSpan", () => this.state.spanStyles.length > 0 ? this.state.spanStyles.map((e, t) => h.createElement("span", {
                    key: "spanCount_" + t,
                    style: e,
                    className: "FastClickContainer_ripple " + ("LIGHT" === this.props.rippleStyle ? "FastClickContainer_rippleLight" : "FastClickContainer_rippleDark")
                })) : null),
                l()(this, "cleanUp", () => {
                    this.setState({
                        spanStyles: []
                    })
                }),
                l()(this, "callCleanUp", e => {
                    "PREVENT_RIPPLE" !== this.props.behaviour && (clearTimeout(this.rippleTimeoutId), this.rippleTimeoutId = window.setTimeout(this.cleanUp, e))
                }),
                this.shouldCountAsClick = !1,
                this.initialCoords = {
                    x: 0,
                    y: 0
                },
                this.state = {
                    spanStyles: []
                }
            }
            componentWillUnmount()
            {
                clearTimeout(this.rippleTimeoutId),
                clearTimeout(this.longPressTimeoutId)
            }
            render()
            {
                const e = function(e) {
                        for (var t = 1; t < arguments.length; t++) {
                            var i = null != arguments[t] ? arguments[t] : {};
                            t % 2 ? p(Object(i), !0).forEach((function(t) {
                                l()(e, t, i[t])
                            })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(i)) : p(Object(i)).forEach((function(t) {
                                Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(i, t))
                            }))
                        }
                        return e
                    }({}, this.props),
                    {onFastClick: t, innerRef: i, rippleStyle: o, behaviour: s, preventLongPress: r, onFastContextMenu: c} = e,
                    d = a()(e, ["onFastClick", "innerRef", "rippleStyle", "behaviour", "preventLongPress", "onFastContextMenu"]),
                    u = void 0 !== this.props.className ? this.props.className + " FastClickContainer_root" : "FastClickContainer_root";
                return h.createElement("div", n()({}, d, {
                    className: u,
                    ref: this.props.innerRef,
                    onTouchStart: this.handleTouchStart,
                    onContextMenu: this.handleContextMenu,
                    onTouchEnd: this.handleTouchEnd,
                    onTouchMove: this.handleTouchMove,
                    onMouseDown: this.handleMouseDown,
                    onMouseLeave: this.handleMouseLeave,
                    onMouseUp: this.handleMouseUp
                }), h.createElement("div", {
                    className: "FastClickContainer_rippleContainer"
                }, this.renderRippleSpan()), this.props.children)
            }
            setInitialCoords(e)
            {
                const t = u.getPosition(e);
                this.initialCoords = {
                    x: t.x,
                    y: t.y
                }
            }
            startClick(e)
            {
                this.shouldCountAsClick = !0,
                e.event.persist(),
                this.longPressTimer(e),
                e.event.stopPropagation()
            }
            longPressTimer(e)
            {
                clearTimeout(this.longPressTimeoutId),
                this.longPressTimeoutId = window.setTimeout(() => {
                    this.shouldCountAsClick && void 0 !== this.props.onFastContextMenu && !0 !== this.props.preventLongPress && (e.event.cancelable ? e.event.preventDefault() : this.longPressOccurred = !0, e.event.stopPropagation(), this.props.onFastContextMenu(e), this.shouldCountAsClick = !1)
                }, 200)
            }
            handleLongPressOccurred(e)
            {
                e.stopPropagation(),
                e.preventDefault(),
                this.longPressOccurred = !1
            }
        }
    },
    "./src/react/util/HorizontalScrollContainer/HorizontalScrollContainer.tsx": function(e, t, i) {
        "use strict";
        i.d(t, "a", (function() {
            return m
        }));
        var o = i("./node_modules/@babel/runtime/helpers/extends.js"),
            n = i.n(o),
            s = i("./node_modules/@babel/runtime/helpers/defineProperty.js"),
            a = i.n(s),
            r = i("./node_modules/assert-never/index.js"),
            l = i.n(r),
            c = i("./node_modules/react/index.js"),
            d = i("./node_modules/seamless-scroll-polyfill/dist/es5/seamless.js"),
            h = i("./src/react/util/commons.ts"),
            p = (i("./src/react/util/HorizontalScrollContainer/HorizontalScrollContainer.css"), i("./src/react/util/HorizontalScrollContainer/HorizontalScrollItem.tsx"));
        function u(e, t) {
            var i = Object.keys(e);
            if (Object.getOwnPropertySymbols) {
                var o = Object.getOwnPropertySymbols(e);
                t && (o = o.filter((function(t) {
                    return Object.getOwnPropertyDescriptor(e, t).enumerable
                }))),
                i.push.apply(i, o)
            }
            return i
        }
        function f(e) {
            for (var t = 1; t < arguments.length; t++) {
                var i = null != arguments[t] ? arguments[t] : {};
                t % 2 ? u(Object(i), !0).forEach((function(t) {
                    a()(e, t, i[t])
                })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(i)) : u(Object(i)).forEach((function(t) {
                    Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(i, t))
                }))
            }
            return e
        }
        class m extends c.Component {
            constructor(e)
            {
                super(e),
                a()(this, "SCROLL_TIMEOUT_INTO_VIEW", 50),
                a()(this, "SCROLL_TIMEOUT_WHEEL", 100),
                a()(this, "SCROLL_TIMEOUT_ARROWS", 30),
                a()(this, "scrollableContainer", c.createRef()),
                a()(this, "selectedItem", c.createRef()),
                a()(this, "wasScrollable", void 0),
                a()(this, "scrollTimeoutId", void 0),
                a()(this, "resizeTimeoutId", void 0),
                a()(this, "scrollTimeoutTimer", void 0),
                a()(this, "isScrolling", void 0),
                a()(this, "lastSelectedItemId", void 0),
                a()(this, "handleWheel", e => {
                    if (0 === e.deltaY || 0 !== e.deltaX || !0 === this.props.removeMouseWheelOverride)
                        return;
                    const t = this.scrollableContainer.current,
                        i = e.deltaY > 0 ? "RIGHT" : "LEFT";
                    this.canScrollToSide(t, i) && (this.scrollTimeoutTimer = this.SCROLL_TIMEOUT_WHEEL, d.elementScrollBy(t, {
                        top: 0,
                        left: e.deltaY
                    }))
                }),
                a()(this, "handleScrollEnd", () => {
                    if (this.isScrolling = !1, void 0 === this.props.onScrollEnd)
                        return;
                    const e = this.scrollableContainer.current;
                    let t = null;
                    this.canScrollToSide(e, "LEFT") ? this.canScrollToSide(e, "RIGHT") || (t = "RIGHT") : t = "LEFT",
                    this.props.onScrollEnd(t)
                }),
                a()(this, "handleScroll", () => {
                    clearTimeout(this.scrollTimeoutId),
                    this.scrollStart(),
                    this.scrollTimeoutId = window.setTimeout(this.handleScrollEnd, this.scrollTimeoutTimer)
                }),
                a()(this, "resize", () => {
                    clearTimeout(this.resizeTimeoutId),
                    this.resizeTimeoutId = window.setTimeout(this.resizeListener, 50)
                }),
                a()(this, "resizeListener", () => {
                    const e = this.scrollableContainer.current;
                    if (null === e)
                        return;
                    const t = Math.floor(e.scrollWidth) > Math.ceil(e.getBoundingClientRect().width) + 1;
                    this.wasScrollable !== t && (this.wasScrollable = t, this.setState({
                        isScrollable: t
                    }), this.handleScrollStateChange(t)),
                    this.scrollIntoViewIfNeeded()
                }),
                this.isScrolling = !1,
                this.scrollTimeoutTimer = this.SCROLL_TIMEOUT_INTO_VIEW,
                this.state = {
                    shaking: null,
                    isScrollable: !1
                }
            }
            componentDidMount()
            {
                !0 !== this.props.useExternalResizeListener && window.addEventListener("resize", this.resize),
                this.resize()
            }
            componentWillUnmount()
            {
                window.removeEventListener("resize", this.resize)
            }
            componentDidUpdate(e, t)
            {
                this.resize()
            }
            render()
            {
                const e = "BEFORE_CHILD" === this.props.controlsConfig.position || "SEPARATED" === this.props.controlsConfig.position,
                    t = "AFTER_CHILD" === this.props.controlsConfig.position || "SEPARATED" === this.props.controlsConfig.position;
                return c.createElement("div", {
                    onWheel: this.handleWheel,
                    onScroll: this.handleScroll,
                    className: "HorizontalScrollContainer_root"
                }, this.state.isScrollable && e ? this.renderControls("BEFORE_CHILD") : null, c.createElement("div", {
                    className: this.getChildrenContainerClass(),
                    ref: this.scrollableContainer,
                    onAnimationEnd: () => this.setState({
                        shaking: null
                    })
                }, !this.state.isScrollable && e ? this.renderControls("BEFORE_CHILD") : null, this.renderChildren(), !this.state.isScrollable && t ? this.renderControls("AFTER_CHILD") : null), this.state.isScrollable && t ? this.renderControls("AFTER_CHILD") : null)
            }
            renderControls(e)
            {
                if (!this.isControlVisible())
                    return null;
                let t = null;
                const i = f({}, this.props.controlsConfig.right, {
                        direction: "RIGHT"
                    }),
                    o = f({}, this.props.controlsConfig.left, {
                        direction: "LEFT"
                    });
                switch (this.props.controlsConfig.position) {
                case "BEFORE_CHILD":
                    "BEFORE_CHILD" === e && (t = c.createElement(c.Fragment, null, this.isMovementControlsVisible(o) ? this.renderMovementControl(o) : null, o.innerElement, this.isMovementControlsVisible(i) ? this.renderMovementControl(i) : null, i.innerElement));
                    break;
                case "AFTER_CHILD":
                    "AFTER_CHILD" === e && (t = c.createElement(c.Fragment, null, o.innerElement, this.isMovementControlsVisible(o) ? this.renderMovementControl(o) : null, i.innerElement, this.isMovementControlsVisible(i) ? this.renderMovementControl(i) : null));
                    break;
                case "SEPARATED":
                    "BEFORE_CHILD" === e && (t = c.createElement(c.Fragment, null, this.isMovementControlsVisible(o) ? this.renderMovementControl(o) : null, i.innerElement)),
                    "AFTER_CHILD" === e && (t = c.createElement(c.Fragment, null, o.innerElement, this.isMovementControlsVisible(i) ? this.renderMovementControl(i) : null));
                    break;
                default:
                    l()(this.props.controlsConfig.position)
                }
                return c.createElement("div", {
                    className: "HorizontalScrollContainer_buttonsContainer" + (null !== this.state.shaking ? " HorizontalScrollContainer_buttonsContainerShaking" : "")
                }, t)
            }
            scrollIntoViewIfNeeded()
            {
                null !== this.selectedItem.current && this.lastSelectedItemId !== this.props.selectedItemId && (this.lastSelectedItemId = this.props.selectedItemId, this.scrollTimeoutTimer = this.SCROLL_TIMEOUT_INTO_VIEW, d.elementScrollIntoView(this.selectedItem.current, {
                    behavior: "smooth"
                }))
            }
            scrollStart()
            {
                this.isScrolling || (this.isScrolling = !0, void 0 !== this.props.onScrollStart && this.props.onScrollStart())
            }
            renderMovementControl(e)
            {
                const t = void 0 !== e.iconClassName ? e.iconClassName : "LEFT" === e.direction ? "i-32-16 i-white i-line-left-medium" : "i-32-16 i-white i-line-right-medium";
                return c.createElement("div", {
                    onClick: () => this.scrollStep(e.direction),
                    className: e.containerClassName
                }, c.createElement("div", {
                    className: t
                }))
            }
            renderChildren()
            {
                let e = this.props.children;
                return void 0 !== this.props.selectedItemId && (e = this.getChildren(e)), e
            }
            getChildren(e)
            {
                return c.Children.map(e, e => Object(h.b)(e, p.a) ? c.createElement("div", n()({}, e.props, {
                    ref: this.props.selectedItemId === e.props.id ? this.selectedItem : null
                })) : c.isValidElement(e) ? c.cloneElement(e, {
                    children: this.getChildren(e.props.children)
                }) : e)
            }
            isControlVisible()
            {
                const e = this.props.controlsConfig.right,
                    t = this.props.controlsConfig.left;
                return void 0 === t || void 0 === e || this.isMovementControlsVisible(e) || this.isMovementControlsVisible(t) || t.innerElement || e.innerElement
            }
            isMovementControlsVisible(e)
            {
                return void 0 === e || "ALWAYS" === e.visibility || this.state.isScrollable && "NONE" !== e.visibility
            }
            handleScrollStateChange(e)
            {
                void 0 !== this.props.onScrollStateChange && this.props.onScrollStateChange(e)
            }
            getChildrenContainerClass()
            {
                let e = "HorizontalScrollContainer_itemsContainer";
                return this.state.isScrollable && (e += " HorizontalScrollContainer_tabsContainerIESupportWhenScrolling"), "LEFT" === this.state.shaking ? e += " HorizontalScrollContainer_shakeLeft" : "RIGHT" === this.state.shaking && (e += " HorizontalScrollContainer_shakeRight"), e
            }
            canScrollToSide(e, t)
            {
                return "LEFT" === t ? e.scrollLeft > 0 : Math.ceil(e.scrollLeft) < Math.floor(e.scrollWidth - e.clientWidth)
            }
            getScrollBy(e, t)
            {
                const i = "LEFT" === t ? -1 : 1;
                if (void 0 !== this.props.customScrollBy)
                    return i * this.props.customScrollBy(e.clientWidth);
                {
                    const t = 208;
                    return i * Math.max(e.clientWidth / 2, t)
                }
            }
            scrollStep(e)
            {
                const t = this.scrollableContainer.current;
                !this.state.isScrollable || !this.canScrollToSide(t, e) && null === this.state.shaking ? this.setState({
                    shaking: e
                }) : this.isScrolling || (this.scrollTimeoutTimer = this.SCROLL_TIMEOUT_ARROWS, d.elementScrollBy(t, {
                    top: 0,
                    left: this.getScrollBy(t, e),
                    behavior: "smooth"
                }))
            }
        }
    },
    "./src/react/util/HorizontalScrollContainer/HorizontalScrollItem.tsx": function(e, t, i) {
        "use strict";
        i.d(t, "a", (function() {
            return a
        }));
        var o = i("./node_modules/@babel/runtime/helpers/defineProperty.js"),
            n = i.n(o),
            s = i("./node_modules/react/index.js");
        class a extends s.PureComponent {
            constructor(e)
            {
                super(e)
            }
            render()
            {
                return s.createElement("div", this.props)
            }
        }
        n()(a, "displayName", "NinoxHorizontalScrollItem")
    },
    "./src/react/util/PositionedBackplane.tsx": function(e, t, i) {
        "use strict";
        i.d(t, "a", (function() {
            return b
        }));
        var o = i("./node_modules/@babel/runtime/helpers/defineProperty.js"),
            n = i.n(o),
            s = i("./node_modules/assert-never/index.js"),
            a = i.n(s),
            r = i("./node_modules/react/index.js"),
            l = i("./node_modules/seamless-scroll-polyfill/dist/es5/seamless.js"),
            c = i("./node_modules/react-dom/index.js"),
            d = (i("./src/react/util/Backplane.css"), i("./src/react/util/FastClickContainer.tsx"));
        class h extends r.Component {
            constructor(e)
            {
                super(e),
                n()(this, "backplane", void 0),
                n()(this, "modalRoot", document.body),
                n()(this, "handleClick", e => {
                    void 0 !== this.props.onClick && this.props.onClick(e)
                }),
                n()(this, "unmount", () => {
                    this.props.show || (this.setState({
                        shouldRenderChildren: !1
                    }), this.modalRoot.removeChild(this.backplane), void 0 !== this.props.onDidHide && this.props.onDidHide())
                }),
                this.backplane = document.createElement("div"),
                this.state = {
                    shouldRenderChildren: !1
                }
            }
            componentDidUpdate(e, t, i)
            {
                this.props.show && !e.show && (this.modalRoot.appendChild(this.backplane), this.setState({
                    shouldRenderChildren: !0
                }, this.props.onDidShow))
            }
            componentDidMount()
            {
                this.props.show && (this.modalRoot.appendChild(this.backplane), this.setState({
                    shouldRenderChildren: !0
                }, this.props.onDidShow))
            }
            componentWillUnmount()
            {
                null !== this.backplane.parentElement && (this.modalRoot.removeChild(this.backplane), void 0 !== this.props.onDidHide && this.props.onDidHide())
            }
            render()
            {
                if (!this.state.shouldRenderChildren)
                    return null;
                const e = r.createElement("div", {
                    ref: this.props.innerRef,
                    className: "Backplane_root " + (void 0 === this.props.className ? "" : this.props.className) + (this.props.show ? "" : " Backplane_rootFadeOut"),
                    onAnimationEnd: this.unmount
                }, r.createElement(d.a, {
                    onFastClick: () => {},
                    onMouseDown: this.handleClick,
                    onTouchStart: this.handleClick,
                    onFastContextMenu: () => {},
                    behaviour: "PREVENT_RIPPLE",
                    className: "Backplane_clickable"
                }), this.props.children);
                return c.createPortal(e, this.backplane)
            }
        }
        i("./src/react/util/PositionedBackplane.css");
        var p = i("./node_modules/react-popper/lib/esm/Popper.js");
        function u(e, t) {
            var i = Object.keys(e);
            if (Object.getOwnPropertySymbols) {
                var o = Object.getOwnPropertySymbols(e);
                t && (o = o.filter((function(t) {
                    return Object.getOwnPropertyDescriptor(e, t).enumerable
                }))),
                i.push.apply(i, o)
            }
            return i
        }
        function f(e) {
            for (var t = 1; t < arguments.length; t++) {
                var i = null != arguments[t] ? arguments[t] : {};
                t % 2 ? u(Object(i), !0).forEach((function(t) {
                    n()(e, t, i[t])
                })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(i)) : u(Object(i)).forEach((function(t) {
                    Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(i, t))
                }))
            }
            return e
        }
        class m extends r.Component {
            render()
            {
                return r.createElement(p.a, {
                    placement: this.props.customPlacement,
                    referenceElement: this.props.target,
                    modifiers: {
                        computeStyle: {
                            gpuAcceleration: !1
                        },
                        preventOverflow: {
                            boundariesElement: null === this.props.boundariesElement ? "scrollParent" : this.props.boundariesElement,
                            escapeWithReference: !1
                        }
                    }
                }, ({ref: e, style: {top: t, left: i, position: o}, placement: n, arrowProps: s}) => {
                    const a = this.getCustomStyle(i, t, n),
                        l = f({
                            position: o
                        }, void 0 === this.props.positionAdjustment ? {
                            top: 0,
                            left: 0
                        } : this.props.positionAdjustment, {
                            transform: `translate3d(${a.wrapperStyle.left}px, ${a.wrapperStyle.top}px, 0)`,
                            WebkitTransform: `translate3d(${a.wrapperStyle.left}px, ${a.wrapperStyle.top}px, 0)`
                        });
                    return r.createElement("div", {
                        ref: e,
                        style: l,
                        "data-placement": n,
                        className: this.props.className
                    }, this.props.children, r.createElement("div", {
                        ref: s.ref,
                        style: f({}, s.style, {}, a.arrow.style),
                        className: "PositionedBackplane_arrow " + a.arrow.className
                    }))
                })
            }
            getCustomStyle(e, t, i)
            {
                const o = m.ARROW_HEIGHT,
                    n = {
                        borderWidth: o,
                        borderColor: void 0 === this.props.arrowColor ? "#ddd" : this.props.arrowColor
                    };
                switch (i) {
                case "top-start":
                case "top":
                case "top-end":
                    return {
                        wrapperStyle: {
                            left: e,
                            top: t - o
                        },
                        arrow: {
                            style: n,
                            className: "PositionedBackplane_arrowTop"
                        }
                    };
                case "right-start":
                case "right":
                case "right-end":
                    return {
                        wrapperStyle: {
                            left: e - o,
                            top: t
                        },
                        arrow: {
                            style: f({
                                left: -o
                            }, n),
                            className: "PositionedBackplane_arrowRight"
                        }
                    };
                case "bottom-end":
                case "bottom":
                case "bottom-start":
                    return {
                        wrapperStyle: {
                            left: e,
                            top: t + o
                        },
                        arrow: {
                            style: f({
                                top: -o
                            }, n),
                            className: "PositionedBackplane_arrowBottom"
                        }
                    };
                case "left-end":
                case "left":
                case "left-start":
                    return {
                        wrapperStyle: {
                            left: e + o,
                            top: t
                        },
                        arrow: {
                            style: n,
                            className: "PositionedBackplane_arrowLeft"
                        }
                    };
                case "auto-start":
                case "auto":
                case "auto-end":
                case void 0:
                    return {
                        wrapperStyle: {
                            left: 0,
                            top: 0
                        },
                        arrow: {
                            style: {},
                            className: ""
                        }
                    };
                default:
                    return a()(i)
                }
            }
        }
        function g(e, t) {
            var i = Object.keys(e);
            if (Object.getOwnPropertySymbols) {
                var o = Object.getOwnPropertySymbols(e);
                t && (o = o.filter((function(t) {
                    return Object.getOwnPropertyDescriptor(e, t).enumerable
                }))),
                i.push.apply(i, o)
            }
            return i
        }
        n()(m, "ARROW_HEIGHT", 15);
        class v extends r.Component {
            render()
            {
                return r.createElement(p.a, {
                    referenceElement: this.props.target,
                    modifiers: {
                        computeStyle: {
                            gpuAcceleration: !1
                        },
                        preventOverflow: {
                            boundariesElement: "window",
                            escapeWithReference: !1
                        },
                        flip: {
                            enabled: !1
                        }
                    }
                }, ({ref: e, style: {top: t, left: i, position: o}}) => {
                    const s = this.props.target.getBoundingClientRect(),
                        a = void 0 === this.props.positionAdjustment ? {
                            top: 0,
                            left: 0
                        } : this.props.positionAdjustment,
                        l = function(e) {
                            for (var t = 1; t < arguments.length; t++) {
                                var i = null != arguments[t] ? arguments[t] : {};
                                t % 2 ? g(Object(i), !0).forEach((function(t) {
                                    n()(e, t, i[t])
                                })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(i)) : g(Object(i)).forEach((function(t) {
                                    Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(i, t))
                                }))
                            }
                            return e
                        }({
                            position: o,
                            width: s.width,
                            height: s.height
                        }, a, {
                            transform: `translate3d(${i}px, ${t - s.height}px, 0)`,
                            WebkitTransform: `translate3d(${i}px, ${t - s.height}px, 0)`
                        });
                    return r.createElement("div", {
                        ref: e,
                        style: l
                    }, this.props.children)
                })
            }
        }
        class b extends r.Component {
            constructor(e)
            {
                super(e),
                n()(this, "resizeTimeout", void 0),
                n()(this, "containerElement", r.createRef()),
                n()(this, "target", null),
                n()(this, "currentSettings", void 0),
                n()(this, "onParentMount", () => {
                    this.setState({
                        didParentShow: !0
                    }),
                    this.props.onDidShow && this.props.onDidShow()
                }),
                n()(this, "resize", () => {
                    null !== this.target && this.props.show && l.elementScrollIntoView(this.target, {
                        block: "nearest",
                        behavior: "auto"
                    })
                }),
                n()(this, "resizeDebounce", () => {
                    clearTimeout(this.resizeTimeout),
                    this.resizeTimeout = setTimeout(this.resize, 50)
                }),
                this.currentSettings = e.settings,
                this.state = {
                    didParentShow: !1
                }
            }
            componentDidMount()
            {
                window.addEventListener("resize", this.resizeDebounce)
            }
            componentWillUnmount()
            {
                window.removeEventListener("resize", this.resizeDebounce)
            }
            render()
            {
                return this.props.show ? (this.currentSettings = this.props.settings, this.target = this.props.clickTarget) : !0 === this.props.killWhenTargetIsNull && (this.target = this.props.clickTarget), r.createElement(h, {
                    innerRef: this.containerElement,
                    onDidShow: this.onParentMount,
                    onDidHide: this.props.onDidHide,
                    show: this.props.show,
                    onClick: this.props.onClick
                }, this.state.didParentShow && null !== this.target ? this.renderPositionedChildren(this.target) : null)
            }
            renderPositionedChildren(e)
            {
                switch (this.currentSettings.style) {
                case "overlay":
                    return r.createElement(v, {
                        positionAdjustment: this.props.positionAdjustment,
                        target: e
                    }, this.props.children);
                case "tooltip":
                    return r.createElement(m, {
                        positionAdjustment: this.props.positionAdjustment,
                        boundariesElement: this.containerElement.current,
                        arrowColor: this.currentSettings.arrowColor,
                        target: e,
                        className: this.props.className,
                        customPlacement: this.currentSettings.customPlacement
                    }, this.props.children);
                default:
                    return Object(s.assertNever)(this.currentSettings)
                }
            }
        }
    },
    "./src/react/util/Track.ts": function(e, t, i) {
        "use strict";
        i.d(t, "d", (function() {
            return c
        })),
        i.d(t, "c", (function() {
            return d
        })),
        i.d(t, "a", (function() {
            return h
        })),
        i.d(t, "e", (function() {
            return u
        })),
        i.d(t, "f", (function() {
            return f
        })),
        i.d(t, "b", (function() {
            return m
        }));
        var o = i("./node_modules/mixpanel-browser/build/mixpanel.cjs.js"),
            n = i("./src/js/ui/ui-util.js");
        let s = !1,
            a = null,
            r = "qs" === window.NINOX_ENV;
        function l(e) {
            if (!s && function(e) {
                return g() && e.experimentT
            }(e))
                try {
                    a = i("./node_modules/logrocket/dist/build.umd.js"),
                    a.init("mgvpst/ninox"),
                    s = !0
                } catch (e) {
                    console.warn("Failed to init LogRocket", e)
                }
            return s
        }
        function c() {
            if (g())
                try {
                    "prod" === window.NINOX_ENV ? o.init("6a0067315a2bfdbf3b1c30dc02b72bc0") : o.init("8eff22a6476c6715d6e44be8d9e81e70")
                } catch (e) {
                    console.warn(e)
                }
        }
        function d(e) {
            p(e);
            try {
                (window.NinoxTracking || {}).trackLogin && window.NinoxTracking.trackLogin(e.id, e.email)
            } catch (e) {
                console.warn(e)
            }
            if (g()) {
                try {
                    o.identify(e.id),
                    o.people.set({
                        userId: e.id,
                        userCreatedAt: new Date(e.createdAt),
                        userVerified: e.verified,
                        userPlanName: e.plan && e.plan.name ? e.plan.name : "null",
                        userLanguage: e.language
                    }),
                    l(e) && a.identify(e.id, e)
                } catch (e) {
                    console.warn(e)
                }
                try {
                    window.Appcues && window.Appcues.identify(e.id, {})
                } catch (e) {
                    console.warn(e)
                }
                try {
                    window.Userlane && window.Userlane("user", e.id)
                } catch (e) {
                    console.warn(e)
                }
            }
        }
        function h(e) {
            p(e);
            try {
                (window.NinoxTracking || {}).trackSignup && window.NinoxTracking.trackSignup(e.id, e.email)
            } catch (e) {
                console.warn(e)
            }
            if (g()) {
                try {
                    o.alias(e.id),
                    l(e) && a.identify(e.id, e)
                } catch (e) {
                    console.warn(e)
                }
                try {
                    window.Appcues && window.Appcues.identify(e.id, {})
                } catch (e) {
                    console.warn(e)
                }
                try {
                    window.Userlane && window.Userlane("user", e.id)
                } catch (e) {
                    console.warn(e)
                }
            }
        }
        function p(e) {
            if (function(e) {
                return !r && e.journey.showUserLane && "en" === window.LOCALE && window.Userlane && window.NINOX_WEB
            }(e) && window.Userlane) {
                r = !0;
                const t = window.Userlane;
                t("init", "m6we5"),
                t("lang", window.LOCALE),
                t("identify", e.id, {
                    email: e.email
                }),
                t("onStart", e => {
                    switch (e) {
                    case "36630":
                    case "36627":
                        window.ui.isInitialized && window.ui.backToRoot()
                    }
                })
            }
        }
        function u(e) {
            if (g())
                try {
                    o.register(e)
                } catch (e) {
                    console.warn(e)
                }
        }
        function f(e, t, i) {
            if (g())
                try {
                    o.track("App " + e + " " + t, i)
                } catch (e) {
                    console.warn(e)
                }
        }
        function m(e) {
            if (!(window.NinoxTracking || {}).getIadAttributionDetails)
                return e("", null);
            window.NinoxTracking.getIadAttributionDetails(e)
        }
        function g() {
            return !Object(n.f)()
        }
    },
    "./src/react/util/commons.ts": function(e, t, i) {
        "use strict";
        i.d(t, "b", (function() {
            return n
        })),
        i.d(t, "c", (function() {
            return s
        })),
        i.d(t, "d", (function() {
            return a
        })),
        i.d(t, "a", (function() {
            return r
        }));
        var o = i("./node_modules/assert/assert.js");
        function n(e, t) {
            return null != e && null != e.type && null != e.type.displayName && e.type.displayName === t.displayName
        }
        function s(e, t) {
            const i = e.nextElementSibling;
            return null === i ? null : i.id === t ? i : s(i, t)
        }
        function a(e, t) {
            const i = e.previousElementSibling;
            return null === i ? null : i.id === t ? i : a(i, t)
        }
        function r(e) {
            !function(e, t) {
                if (!e)
                    throw new o.AssertionError({
                        message: t
                    })
            }(null != e, `Expected 'val' to be defined, but received ${e}`)
        }
    },
    "./src/react/util/general.ts": function(e, t, i) {
        "use strict";
        function o(...e) {
            const t = [];
            for (const i of e)
                if ("string" == typeof i)
                    t.push(i);
                else if ("object" == typeof i)
                    for (const e in i)
                        i[e] && t.push(e);
            return t.join(" ")
        }
        i.d(t, "a", (function() {
            return o
        }))
    },
    "./src/react/verification/ResendButton.scss": function(e, t, i) {},
    "./src/react/views/BrowserNotSupportedView.scss": function(e, t, i) {},
    0: function(e, t, i) {
        i("./src/init_styles.js"),
        e.exports = i("./src/init_lib.js")
    },
    1: function(e, t) {},
    2: function(e, t) {},
    3: function(e, t) {},
    4: function(e, t) {},
    5: function(e, t) {},
    6: function(e, t) {},
    7: function(e, t) {},
    8: function(e, t) {}
});

